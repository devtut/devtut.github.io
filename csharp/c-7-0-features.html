<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C# | C# 7.0 Features</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Language support for Tuples, Local functions, out var declaration, Pattern Matching, Digit separators, Binary literals, throw expressions, Extended expression bodied members list, ref return and ref local, ValueTask<T>">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="C# | C# 7.0 Features">
    <meta property="og:description" content="Language support for Tuples, Local functions, out var declaration, Pattern Matching, Digit separators, Binary literals, throw expressions, Extended expression bodied members list, ref return and ref local, ValueTask<T>">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/csharp/c-7-0-features.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="C# | C# 7.0 Features">
    <meta name="twitter:description" content="Language support for Tuples, Local functions, out var declaration, Pattern Matching, Digit separators, Binary literals, throw expressions, Extended expression bodied members list, ref return and ref local, ValueTask<T>">
    <meta name="twitter:url" content="/csharp/c-7-0-features.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/782.61c4f7f9.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>C#</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/csharp/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/csharp/getting-started-with-c-language.html" class="sidebar-link">Getting started with C# Language</a></li><li><a href="/csharp/literals.html" class="sidebar-link">Literals</a></li><li><a href="/csharp/operators.html" class="sidebar-link">Operators</a></li><li><a href="/csharp/conditional-statements.html" class="sidebar-link">Conditional Statements</a></li><li><a href="/csharp/equality-operator.html" class="sidebar-link">Equality Operator</a></li><li><a href="/csharp/equals-and-gethashcode.html" class="sidebar-link">Equals and GetHashCode</a></li><li><a href="/csharp/null-coalescing-operator.html" class="sidebar-link">Null-Coalescing Operator</a></li><li><a href="/csharp/null-conditional-operators.html" class="sidebar-link">Null-conditional Operators</a></li><li><a href="/csharp/nameof-operator.html" class="sidebar-link">nameof Operator</a></li><li><a href="/csharp/verbatim-strings.html" class="sidebar-link">Verbatim Strings</a></li><li><a href="/csharp/common-string-operations.html" class="sidebar-link">Common String Operations</a></li><li><a href="/csharp/string-format.html" class="sidebar-link">String.Format</a></li><li><a href="/csharp/string-concatenate.html" class="sidebar-link">String Concatenate</a></li><li><a href="/csharp/string-manipulation.html" class="sidebar-link">String Manipulation</a></li><li><a href="/csharp/string-interpolation.html" class="sidebar-link">String Interpolation</a></li><li><a href="/csharp/string-escape-sequences.html" class="sidebar-link">String Escape Sequences</a></li><li><a href="/csharp/stringbuilder.html" class="sidebar-link">StringBuilder</a></li><li><a href="/csharp/regex-parsing.html" class="sidebar-link">Regex Parsing</a></li><li><a href="/csharp/datetime-methods.html" class="sidebar-link">DateTime Methods</a></li><li><a href="/csharp/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/csharp/o-n-algorithm-for-circular-rotation-of-an-array.html" class="sidebar-link">O(n) Algorithm for circular rotation of an array</a></li><li><a href="/csharp/enum.html" class="sidebar-link">Enum</a></li><li><a href="/csharp/tuples.html" class="sidebar-link">Tuples</a></li><li><a href="/csharp/guid.html" class="sidebar-link">Guid</a></li><li><a href="/csharp/biginteger.html" class="sidebar-link">BigInteger</a></li><li><a href="/csharp/collection-initializers.html" class="sidebar-link">Collection Initializers</a></li><li><a href="/csharp/an-overview-of-c-collections.html" class="sidebar-link">An overview of c# collections</a></li><li><a href="/csharp/looping.html" class="sidebar-link">Looping</a></li><li><a href="/csharp/iterators.html" class="sidebar-link">Iterators</a></li><li><a href="/csharp/ienumerable.html" class="sidebar-link">IEnumerable</a></li><li><a href="/csharp/value-type-vs-reference-type.html" class="sidebar-link">Value type vs Reference type</a></li><li><a href="/csharp/built-in-types.html" class="sidebar-link">Built-in Types</a></li><li><a href="/csharp/aliases-of-built-in-types.html" class="sidebar-link">Aliases of built-in types</a></li><li><a href="/csharp/anonymous-types.html" class="sidebar-link">Anonymous types</a></li><li><a href="/csharp/dynamic-type.html" class="sidebar-link">Dynamic type</a></li><li><a href="/csharp/type-conversion.html" class="sidebar-link">Type Conversion</a></li><li><a href="/csharp/casting.html" class="sidebar-link">Casting</a></li><li><a href="/csharp/nullable-types.html" class="sidebar-link">Nullable types</a></li><li><a href="/csharp/constructors-and-finalizers.html" class="sidebar-link">Constructors and Finalizers</a></li><li><a href="/csharp/access-modifiers.html" class="sidebar-link">Access Modifiers</a></li><li><a href="/csharp/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/csharp/static-classes.html" class="sidebar-link">Static Classes</a></li><li><a href="/csharp/singleton-implementation.html" class="sidebar-link">Singleton Implementation</a></li><li><a href="/csharp/dependency-injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/csharp/partial-class-and-methods.html" class="sidebar-link">Partial class and methods</a></li><li><a href="/csharp/object-initializers.html" class="sidebar-link">Object initializers</a></li><li><a href="/csharp/methods.html" class="sidebar-link">Methods</a></li><li><a href="/csharp/extension-methods.html" class="sidebar-link">Extension Methods</a></li><li><a href="/csharp/named-arguments.html" class="sidebar-link">Named Arguments</a></li><li><a href="/csharp/named-and-optional-arguments.html" class="sidebar-link">Named and Optional Arguments</a></li><li><a href="/csharp/data-annotation.html" class="sidebar-link">Data Annotation</a></li><li><a href="/csharp/keywords.html" class="sidebar-link">Keywords</a></li><li><a href="/csharp/object-oriented-programming-in-c.html" class="sidebar-link">Object Oriented Programming In C#</a></li><li><a href="/csharp/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/csharp/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/csharp/xml-documentation-comments.html" class="sidebar-link">XML Documentation Comments</a></li><li><a href="/csharp/comments-and-regions.html" class="sidebar-link">Comments and regions</a></li><li><a href="/csharp/inheritance.html" class="sidebar-link">Inheritance</a></li><li><a href="/csharp/generics.html" class="sidebar-link">Generics</a></li><li><a href="/csharp/using-statement.html" class="sidebar-link">Using Statement</a></li><li><a href="/csharp/using-directive.html" class="sidebar-link">Using Directive</a></li><li><a href="/csharp/idisposable-interface.html" class="sidebar-link">IDisposable interface</a></li><li><a href="/csharp/reflection.html" class="sidebar-link">Reflection</a></li><li><a href="/csharp/iqueryable-interface.html" class="sidebar-link">IQueryable interface</a></li><li><a href="/csharp/linq-to-objects.html" class="sidebar-link">Linq to Objects</a></li><li><a href="/csharp/linq-queries.html" class="sidebar-link">LINQ Queries</a></li><li><a href="/csharp/linq-to-xml.html" class="sidebar-link">LINQ to XML</a></li><li><a href="/csharp/parallel-linq-plinq.html" class="sidebar-link">Parallel LINQ (PLINQ)</a></li><li><a href="/csharp/xmldocument-and-the-system-xml-namespace.html" class="sidebar-link">XmlDocument and the System.Xml namespace</a></li><li><a href="/csharp/xdocument-and-the-system-xml-linq-namespace.html" class="sidebar-link">XDocument and the System.Xml.Linq namespace</a></li><li><a href="/csharp/c-7-0-features.html" aria-current="page" class="active sidebar-link">C# 7.0 Features</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/csharp/c-7-0-features.html#language-support-for-tuples" class="sidebar-link">Language support for Tuples</a></li><li class="sidebar-sub-header"><a href="/csharp/c-7-0-features.html#local-functions" class="sidebar-link">Local functions</a></li><li class="sidebar-sub-header"><a href="/csharp/c-7-0-features.html#out-var-declaration" class="sidebar-link">out var declaration</a></li><li class="sidebar-sub-header"><a href="/csharp/c-7-0-features.html#pattern-matching" class="sidebar-link">Pattern Matching</a></li><li class="sidebar-sub-header"><a href="/csharp/c-7-0-features.html#digit-separators" class="sidebar-link">Digit separators</a></li><li class="sidebar-sub-header"><a href="/csharp/c-7-0-features.html#binary-literals" class="sidebar-link">Binary literals</a></li><li class="sidebar-sub-header"><a href="/csharp/c-7-0-features.html#throw-expressions" class="sidebar-link">throw expressions</a></li><li class="sidebar-sub-header"><a href="/csharp/c-7-0-features.html#extended-expression-bodied-members-list" class="sidebar-link">Extended expression bodied members list</a></li><li class="sidebar-sub-header"><a href="/csharp/c-7-0-features.html#ref-return-and-ref-local" class="sidebar-link">ref return and ref local</a></li><li class="sidebar-sub-header"><a href="/csharp/c-7-0-features.html#valuetask" class="sidebar-link">ValueTask</a></li></ul></li><li><a href="/csharp/c-6-0-features.html" class="sidebar-link">C# 6.0 Features</a></li><li><a href="/csharp/c-5-0-features.html" class="sidebar-link">C# 5.0 Features</a></li><li><a href="/csharp/c-4-0-features.html" class="sidebar-link">C# 4.0 Features</a></li><li><a href="/csharp/c-3-0-features.html" class="sidebar-link">C# 3.0 Features</a></li><li><a href="/csharp/exception-handling.html" class="sidebar-link">Exception Handling</a></li><li><a href="/csharp/nullreferenceexception.html" class="sidebar-link">NullReferenceException</a></li><li><a href="/csharp/handling-formatexception-when-converting-string-to-other-types.html" class="sidebar-link">Handling FormatException when converting string to other types</a></li><li><a href="/csharp/read-understand-stacktraces.html" class="sidebar-link">Read &amp; Understand Stacktraces</a></li><li><a href="/csharp/diagnostics.html" class="sidebar-link">Diagnostics</a></li><li><a href="/csharp/overflow.html" class="sidebar-link">Overflow</a></li><li><a href="/csharp/getting-started-json-with-c.html" class="sidebar-link">Getting Started: Json with C#</a></li><li><a href="/csharp/using-json-net.html" class="sidebar-link">Using json.net</a></li><li><a href="/csharp/lambda-expressions.html" class="sidebar-link">Lambda Expressions</a></li><li><a href="/csharp/generic-lambda-query-builder.html" class="sidebar-link">Generic Lambda Query Builder</a></li><li><a href="/csharp/properties.html" class="sidebar-link">Properties</a></li><li><a href="/csharp/initializing-properties.html" class="sidebar-link">Initializing Properties</a></li><li><a href="/csharp/inotifypropertychanged-interface.html" class="sidebar-link">INotifyPropertyChanged interface</a></li><li><a href="/csharp/events.html" class="sidebar-link">Events</a></li><li><a href="/csharp/expression-trees.html" class="sidebar-link">Expression Trees</a></li><li><a href="/csharp/overload-resolution.html" class="sidebar-link">Overload Resolution</a></li><li><a href="/csharp/bindinglist-t.html" class="sidebar-link">BindingList</a></li><li><a href="/csharp/preprocessor-directives.html" class="sidebar-link">Preprocessor directives</a></li><li><a href="/csharp/structs.html" class="sidebar-link">Structs</a></li><li><a href="/csharp/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/csharp/delegates.html" class="sidebar-link">Delegates</a></li><li><a href="/csharp/file-and-stream-i-o.html" class="sidebar-link">File and Stream I/O</a></li><li><a href="/csharp/networking.html" class="sidebar-link">Networking</a></li><li><a href="/csharp/performing-http-requests.html" class="sidebar-link">Performing HTTP requests</a></li><li><a href="/csharp/reading-and-writing-zip-files.html" class="sidebar-link">Reading and writing .zip files</a></li><li><a href="/csharp/filesystemwatcher.html" class="sidebar-link">FileSystemWatcher</a></li><li><a href="/csharp/access-network-shared-folder-with-username-and-password.html" class="sidebar-link">Access network shared folder with username and password</a></li><li><a href="/csharp/asynchronous-socket.html" class="sidebar-link">Asynchronous Socket</a></li><li><a href="/csharp/action-filters.html" class="sidebar-link">Action Filters</a></li><li><a href="/csharp/polymorphism.html" class="sidebar-link">Polymorphism</a></li><li><a href="/csharp/immutability.html" class="sidebar-link">Immutability</a></li><li><a href="/csharp/indexer.html" class="sidebar-link">Indexer</a></li><li><a href="/csharp/checked-and-unchecked.html" class="sidebar-link">Checked and Unchecked</a></li><li><a href="/csharp/stream.html" class="sidebar-link">Stream</a></li><li><a href="/csharp/timers.html" class="sidebar-link">Timers</a></li><li><a href="/csharp/stopwatches.html" class="sidebar-link">Stopwatches</a></li><li><a href="/csharp/threading.html" class="sidebar-link">Threading</a></li><li><a href="/csharp/async-await-backgroundworker-task-and-thread-examples.html" class="sidebar-link">Async/await, Backgroundworker, Task and Thread Examples</a></li><li><a href="/csharp/async-await.html" class="sidebar-link">Async-Await</a></li><li><a href="/csharp/synchronization-context-in-async-await.html" class="sidebar-link">Synchronization Context in Async-Await</a></li><li><a href="/csharp/backgroundworker.html" class="sidebar-link">BackgroundWorker</a></li><li><a href="/csharp/task-parallel-library.html" class="sidebar-link">Task Parallel Library</a></li><li><a href="/csharp/making-a-variable-thread-safe.html" class="sidebar-link">Making a variable thread safe</a></li><li><a href="/csharp/lock-statement.html" class="sidebar-link">Lock Statement</a></li><li><a href="/csharp/yield-keyword.html" class="sidebar-link">Yield Keyword</a></li><li><a href="/csharp/task-parallel-library-tpl-dataflow-constructs.html" class="sidebar-link">Task Parallel Library (TPL) Dataflow Constructs</a></li><li><a href="/csharp/functional-programming.html" class="sidebar-link">Functional Programming</a></li><li><a href="/csharp/func-delegates.html" class="sidebar-link">Func delegates</a></li><li><a href="/csharp/function-with-multiple-return-values.html" class="sidebar-link">Function with multiple return values</a></li><li><a href="/csharp/binary-serialization.html" class="sidebar-link">Binary Serialization</a></li><li><a href="/csharp/icloneable.html" class="sidebar-link">ICloneable</a></li><li><a href="/csharp/icomparable.html" class="sidebar-link">IComparable</a></li><li><a href="/csharp/accessing-databases.html" class="sidebar-link">Accessing Databases</a></li><li><a href="/csharp/using-sqlite-in-c.html" class="sidebar-link">Using SQLite in C#</a></li><li><a href="/csharp/caching.html" class="sidebar-link">Caching</a></li><li><a href="/csharp/code-contracts.html" class="sidebar-link">Code Contracts</a></li><li><a href="/csharp/code-contracts-and-assertions.html" class="sidebar-link">Code Contracts and Assertions</a></li><li><a href="/csharp/structural-design-patterns.html" class="sidebar-link">Structural Design Patterns</a></li><li><a href="/csharp/creational-design-patterns.html" class="sidebar-link">Creational Design Patterns</a></li><li><a href="/csharp/implementing-decorator-design-pattern.html" class="sidebar-link">Implementing Decorator Design Pattern</a></li><li><a href="/csharp/implementing-flyweight-design-pattern.html" class="sidebar-link">Implementing Flyweight Design Pattern</a></li><li><a href="/csharp/system-management-automation.html" class="sidebar-link">System.Management.Automation</a></li><li><a href="/csharp/system-directoryservices-protocols-ldapconnection.html" class="sidebar-link">System.DirectoryServices.Protocols.LdapConnection</a></li><li><a href="/csharp/c-authentication-handler.html" class="sidebar-link">C# Authentication handler</a></li><li><a href="/csharp/pointers.html" class="sidebar-link">Pointers</a></li><li><a href="/csharp/pointers-unsafe-code.html" class="sidebar-link">Pointers &amp; Unsafe Code</a></li><li><a href="/csharp/how-to-use-c-structs-to-create-a-union-type-similar-to-c-unions.html" class="sidebar-link">How to use C# Structs to create a Union type  (Similar to C Unions)</a></li><li><a href="/csharp/reactive-extensions-rx.html" class="sidebar-link">Reactive Extensions (Rx)</a></li><li><a href="/csharp/assemblyinfo-cs-examples.html" class="sidebar-link">AssemblyInfo.cs Examples</a></li><li><a href="/csharp/creating-a-console-application-using-a-plain-text-editor-and-the-c-compiler-csc-exe.html" class="sidebar-link">Creating a Console Application using a Plain-Text Editor and the C# Compiler (csc.exe)</a></li><li><a href="/csharp/clscompliantattribute.html" class="sidebar-link">CLSCompliantAttribute</a></li><li><a href="/csharp/observablecollection-t.html" class="sidebar-link">ObservableCollection</a></li><li><a href="/csharp/hash-functions.html" class="sidebar-link">Hash Functions</a></li><li><a href="/csharp/generating-random-numbers-in-c.html" class="sidebar-link">Generating Random Numbers in C#</a></li><li><a href="/csharp/cryptography-system-security-cryptography.html" class="sidebar-link">Cryptography (System.Security.Cryptography)</a></li><li><a href="/csharp/asp-net-identity.html" class="sidebar-link">ASP.NET Identity</a></li><li><a href="/csharp/unsafe-code-in-net.html" class="sidebar-link">Unsafe Code in .NET</a></li><li><a href="/csharp/c-script.html" class="sidebar-link">C# Script</a></li><li><a href="/csharp/runtime-compile.html" class="sidebar-link">Runtime Compile</a></li><li><a href="/csharp/interoperability.html" class="sidebar-link">Interoperability</a></li><li><a href="/csharp/net-compiler-platform-roslyn.html" class="sidebar-link">.NET Compiler Platform (Roslyn)</a></li><li><a href="/csharp/ilgenerator.html" class="sidebar-link">ILGenerator</a></li><li><a href="/csharp/t4-code-generation.html" class="sidebar-link">T4 Code Generation</a></li><li><a href="/csharp/creating-own-messagebox-in-windows-form-application.html" class="sidebar-link">Creating Own MessageBox in Windows Form Application</a></li><li><a href="/csharp/including-font-resources.html" class="sidebar-link">Including Font Resources</a></li><li><a href="/csharp/import-google-contacts.html" class="sidebar-link">Import Google Contacts</a></li><li><a href="/csharp/garbage-collector-in-net.html" class="sidebar-link">Garbage Collector in .Net</a></li><li><a href="/csharp/microsoft-exchange-webservices.html" class="sidebar-link">Microsoft.Exchange.WebServices</a></li><li><a href="/csharp/windows-communication-foundation.html" class="sidebar-link">Windows Communication Foundation</a></li><li><a href="/csharp/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="c-7-0-features"><a href="#c-7-0-features" class="header-anchor">#</a> C# 7.0 Features</h1> <p>C# 7.0 is the seventh version of C#. This version contains some new features: language support for Tuples, local functions, <code>out var</code> declarations, digit separators, binary literals, pattern matching, throw expressions, <code>ref return</code> and <code>ref local</code> and extended expression bodied members list.</p> <p>Official reference: <a href="https://docs.microsoft.com/en-us/dotnet/articles/csharp/csharp-7" target="_blank" rel="noopener noreferrer">What's new in C# 7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="language-support-for-tuples"><a href="#language-support-for-tuples" class="header-anchor">#</a> Language support for Tuples</h2> <h3 id="basics"><a href="#basics" class="header-anchor">#</a> Basics</h3> <p>A <strong>tuple</strong> is an ordered, finite list of elements.  Tuples are commonly used in programming as a means to work with one single entity collectively instead of individually working with each of the tuple's elements, and to represent individual rows (ie. &quot;records&quot;) in a relational database.</p> <p>In C# 7.0, methods can have multiple return values. Behind the scenes, the compiler will use the new <a href="https://github.com/dotnet/corefx/blob/master/src/System.ValueTuple/src/System/ValueTuple/ValueTuple.cs" target="_blank" rel="noopener noreferrer">ValueTuple<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> struct.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token punctuation">(</span><span class="token keyword">int</span> sum<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">)</span></span> <span class="token function">GetTallies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Side note</strong>: for this to work in Visual Studio 2017, you need to get the <code>System.ValueTuple</code> package.</p> <p>If a tuple-returning method result is assigned to a single variable you can access the members by their defined names on the method signature:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> <span class="token function">GetTallies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// &gt; result.sum</span>
<span class="token comment">// 1</span>
<span class="token comment">// &gt; result.count</span>
<span class="token comment">// 2</span>

</code></pre></div><h3 id="tuple-deconstruction"><a href="#tuple-deconstruction" class="header-anchor">#</a> Tuple Deconstruction</h3> <p>Tuple deconstruction separates a tuple into its parts.</p> <p>For example, invoking <code>GetTallies</code> and assigning the return value to two separate variables deconstructs the tuple into those two variables:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> tallyOne<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> tallyTwo<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">GetTallies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><code>var</code> also works:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> s<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">var</span></span> c<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">GetTallies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>You can also use shorter syntax, with <code>var</code> outside of <code>()</code>:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">var</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">GetTallies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>You can also deconstruct into existing variables:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span></span> s<span class="token punctuation">,</span> c<span class="token punctuation">;</span>
<span class="token punctuation">(</span>s<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">GetTallies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Swapping is now much simpler (no temp variable needed):</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Interestingly, any object can be deconstructed by defining a <code>Deconstruct</code> method in the class:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Deconstruct</span><span class="token punctuation">(</span><span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> firstName<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> lastName<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        firstName <span class="token operator">=</span> FirstName<span class="token punctuation">;</span>
        lastName <span class="token operator">=</span> LastName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name"><span class="token keyword">var</span></span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> LastName <span class="token operator">=</span> <span class="token string">&quot;Smith&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token punctuation">(</span>localFirstName<span class="token punctuation">,</span> localLastName<span class="token punctuation">)</span> <span class="token operator">=</span> person<span class="token punctuation">;</span>

</code></pre></div><p>In this case, the <code>(localFirstName, localLastName) = person</code> syntax is invoking <code>Deconstruct</code> on the <code>person</code>.</p> <p>Deconstruction can even be defined in an extension method. This is equivalent to the above:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">PersonExtensions</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Deconstruct</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">Person</span> person<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> firstName<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">string</span></span> lastName<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        firstName <span class="token operator">=</span> person<span class="token punctuation">.</span>FirstName<span class="token punctuation">;</span>
        lastName <span class="token operator">=</span> person<span class="token punctuation">.</span>LastName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token punctuation">(</span>localFirstName<span class="token punctuation">,</span> localLastName<span class="token punctuation">)</span> <span class="token operator">=</span> person<span class="token punctuation">;</span>

</code></pre></div><p>An alternative approach for the <code>Person</code> class is to define the <code>Name</code> itself as a <code>Tuple</code>. Consider the following:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token punctuation">(</span><span class="token keyword">string</span> First<span class="token punctuation">,</span> <span class="token keyword">string</span> Last<span class="token punctuation">)</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> FirstName<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> LastName<span class="token punctuation">)</span> name<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Then you can instantiate a person like so (where we can take a tuple as an argument):</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;Jane&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> firstName <span class="token operator">=</span> person<span class="token punctuation">.</span>Name<span class="token punctuation">.</span>First<span class="token punctuation">;</span> <span class="token comment">// &quot;Jane&quot;</span>
<span class="token class-name"><span class="token keyword">var</span></span> lastName <span class="token operator">=</span> person<span class="token punctuation">.</span>Name<span class="token punctuation">.</span>Last<span class="token punctuation">;</span>   <span class="token comment">// &quot;Smith&quot;</span>

</code></pre></div><h3 id="tuple-initialization"><a href="#tuple-initialization" class="header-anchor">#</a> Tuple Initialization</h3> <p>You can also arbitrarily create tuples in code:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> name <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span>Item1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Outputs John</span>

Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span>Item2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Outputs Smith</span>

</code></pre></div><h3 id=""><a href="#" class="header-anchor">#</a></h3> <p>When creating a tuple, you can assign ad-hoc item names to the members of the tuple:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> name <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token named-parameter punctuation">first</span><span class="token punctuation">:</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">middle</span><span class="token punctuation">:</span> <span class="token string">&quot;Q&quot;</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">last</span><span class="token punctuation">:</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Outputs John</span>

</code></pre></div><h3 id="type-inference"><a href="#type-inference" class="header-anchor">#</a> Type inference</h3> <p>Multiple tuples defined with the same signature (matching types and count) will be inferred as matching types. For example:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token punctuation">(</span><span class="token keyword">int</span> sum<span class="token punctuation">,</span> <span class="token keyword">double</span> average<span class="token punctuation">)</span></span> <span class="token function">Measure</span><span class="token punctuation">(</span><span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> items<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token named-parameter punctuation">sum</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">average</span><span class="token punctuation">:</span> <span class="token number">0d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stats<span class="token punctuation">.</span>sum <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stats<span class="token punctuation">.</span>average <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">Average</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> stats<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><code>stats</code> can be returned since the declaration of the <code>stats</code> variable and the method's return signature are a match.</p> <h3 id="reflection-and-tuple-field-names"><a href="#reflection-and-tuple-field-names" class="header-anchor">#</a> Reflection and Tuple Field Names</h3> <p>Member names do not exist at runtime. Reflection will consider tuples with the same number and types of members the same even if member names do not match. Converting a tuple to an <code>object</code> and then to a tuple with the same member types, but different names, will not cause an exception either.</p> <p>While the ValueTuple class itself does not preserve information for member names the information is available through reflection in a TupleElementNamesAttribute. This attribute is not applied to the tuple itself but to method parameters, return values, properties and fields. This allows tuple item names to be preserved across assemblies i.e. if a method returns (string name, int count) the names name and count will be available to callers of the method in another assembly because the return value will be marked with TupleElementNameAttribute containing the values &quot;name&quot; and &quot;count&quot;.</p> <h3 id="use-with-generics-and-async"><a href="#use-with-generics-and-async" class="header-anchor">#</a> Use with generics and <code>async</code></h3> <p>The new tuple features (using the underlying <code>ValueTuple</code> type) fully support generics and can be used as generic type parameter. That makes it possible to use them with the <code>async</code>/<code>await</code> pattern:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token punctuation">(</span><span class="token keyword">string</span> <span class="token keyword">value</span><span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">)</span><span class="token punctuation">&gt;</span></span> <span class="token function">GetValueAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">string</span></span> fooBar <span class="token operator">=</span> <span class="token keyword">await</span> _stackoverflow<span class="token punctuation">.</span><span class="token function">GetStringAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">int</span></span> num <span class="token operator">=</span> <span class="token keyword">await</span> _stackoverflow<span class="token punctuation">.</span><span class="token function">GetIntAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>fooBar<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="use-with-collections"><a href="#use-with-collections" class="header-anchor">#</a> Use with collections</h3> <p>It may become beneficial to have a collection of tuples in (as an example) a scenario where you're attempting to find a matching tuple based on conditions to avoid code branching.</p> <p>Example:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Tuple<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> labels <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Tuple<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Tuple<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;test1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Tuple<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;test1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Value2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Tuple<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;test2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Value3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">FindMatchingValue</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> firstElement<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> secondElement<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> labels
        <span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>w <span class="token operator">=&gt;</span> w<span class="token punctuation">.</span>Item1 <span class="token operator">==</span> firstElement <span class="token operator">&amp;&amp;</span> w<span class="token punctuation">.</span>Item2 <span class="token operator">==</span> secondElement<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;combo not found&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> result<span class="token punctuation">.</span>Item3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>With the new tuples can become:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token punctuation">(</span><span class="token keyword">string</span> firstThingy<span class="token punctuation">,</span> <span class="token keyword">string</span> secondThingyLabel<span class="token punctuation">,</span> <span class="token keyword">string</span> foundValue<span class="token punctuation">)</span><span class="token punctuation">&gt;</span></span> labels <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token punctuation">(</span><span class="token keyword">string</span> firstThingy<span class="token punctuation">,</span> <span class="token keyword">string</span> secondThingyLabel<span class="token punctuation">,</span> <span class="token keyword">string</span> foundValue<span class="token punctuation">)</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token string">&quot;test1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">&quot;test1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Value2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">&quot;test2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Value3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">FindMatchingValue</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> firstElement<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> secondElement<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> labels
        <span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>w <span class="token operator">=&gt;</span> w<span class="token punctuation">.</span>firstThingy <span class="token operator">==</span> firstElement <span class="token operator">&amp;&amp;</span> w<span class="token punctuation">.</span>secondThingyLabel <span class="token operator">==</span> secondElement<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;combo not found&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> result<span class="token punctuation">.</span>foundValue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Though the naming on the example tuple above is pretty generic, the idea of relevant labels allows for a deeper understanding of what is being attempted in the code over referencing &quot;item1&quot;, &quot;item2&quot;, and &quot;item3&quot;.</p> <h3 id="differences-between-valuetuple-and-tuple"><a href="#differences-between-valuetuple-and-tuple" class="header-anchor">#</a> Differences between ValueTuple and Tuple</h3> <p>The primary reason for introduction of <code>ValueTuple</code> is performance.</p> <table><thead><tr><th>Type name</th> <th><code>ValueTuple</code></th> <th><code>Tuple</code></th></tr></thead> <tbody><tr><td>Class or structure</td> <td><code>struct</code></td> <td><code>class</code></td></tr> <tr><td>Mutability (changing values after creation)</td> <td>mutable</td> <td>immutable</td></tr> <tr><td>Naming members and other language support</td> <td>yes</td> <td>no (<a href="https://github.com/dotnet/roslyn/issues/11031" target="_blank" rel="noopener noreferrer">TBD<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</td></tr></tbody></table> <h3 id="references"><a href="#references" class="header-anchor">#</a> References</h3> <ul><li><a href="https://github.com/dotnet/roslyn/issues/347" target="_blank" rel="noopener noreferrer">Original Tuples language feature proposal on GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://code.msdn.microsoft.com/Introduce-new-C-70-features-c639ed88" target="_blank" rel="noopener noreferrer">A runnable VS 15 solution for C# 7.0 features<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.nuget.org/packages/System.ValueTuple/" target="_blank" rel="noopener noreferrer">NuGet Tuple Package<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="local-functions"><a href="#local-functions" class="header-anchor">#</a> Local functions</h2> <p>Local functions are defined within a method and aren't available outside of it. They have access to all local variables and support iterators, <code>async</code>/<code>await</code> and lambda syntax. This way, repetitions specific to a function can be functionalized without crowding the class. As a side effect, this improves intellisense suggestion performance.</p> <h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">GetCylinderVolume</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> radius<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> height<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">getVolume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">getVolume</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// You can declare inner-local functions in a local function </span>
        <span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">GetCircleArea</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> r<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> r <span class="token operator">*</span> r<span class="token punctuation">;</span>

        <span class="token comment">// ALL parents' variables are accessible even though parent doesn't have any input. </span>
        <span class="token keyword">return</span> <span class="token function">GetCircleArea</span><span class="token punctuation">(</span>radius<span class="token punctuation">)</span> <span class="token operator">*</span> height<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Local functions considerably simplify code for LINQ operators, where you usually have to separate argument checks from actual logic to make argument checks instant, not delayed until after iteration started.</p> <h3 id="example-2"><a href="#example-2" class="header-anchor">#</a> Example</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">Where</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token keyword">this</span> <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span> source<span class="token punctuation">,</span> 
    <span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> predicate<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>source <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ArgumentNullException</span><span class="token punctuation">(</span><span class="token keyword">nameof</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>predicate <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ArgumentNullException</span><span class="token punctuation">(</span><span class="token keyword">nameof</span><span class="token punctuation">(</span>predicate<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">TSource</span> element <span class="token keyword">in</span> source<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">predicate</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">yield</span> <span class="token keyword">return</span> element<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Local functions also support the <code>async</code> and <code>await</code> keywords.</p> <h3 id="example-3"><a href="#example-3" class="header-anchor">#</a> Example</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">WriteEmailsAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> emailRegex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Regex</span><span class="token punctuation">(</span><span class="token string">@&quot;(?i)[a-z0-9_.+-]+@[a-z0-9-]+\.[a-z0-9-.]+&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> emails1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getEmailsFromFileAsync</span><span class="token punctuation">(</span><span class="token string">&quot;input1.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> emails2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getEmailsFromFileAsync</span><span class="token punctuation">(</span><span class="token string">&quot;input2.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">writeLinesToFileAsync</span><span class="token punctuation">(</span>emails1<span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>emails2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;output.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getEmailsFromFileAsync</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> fileName<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">string</span></span> text<span class="token punctuation">;</span>

        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">StreamReader</span> reader <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">OpenText</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            text <span class="token operator">=</span> <span class="token keyword">await</span> reader<span class="token punctuation">.</span><span class="token function">ReadToEndAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token keyword">from</span> <span class="token class-name">Match</span> emailMatch <span class="token keyword">in</span> emailRegex<span class="token punctuation">.</span><span class="token function">Matches</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token keyword">select</span> emailMatch<span class="token punctuation">.</span>Value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">writeLinesToFileAsync</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> lines<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> fileName<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">StreamWriter</span> writer <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">CreateText</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> line <span class="token keyword">in</span> lines<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">await</span> writer<span class="token punctuation">.</span><span class="token function">WriteLineAsync</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>One important thing that you may have noticed is that local functions can be defined under the <code>return</code> statement, they do <strong>not</strong> need to be defined above it. Additionally, local functions typically follow the &quot;lowerCamelCase&quot; naming convention as to more easily differentiate themselves from class scope functions.</p> <h2 id="out-var-declaration"><a href="#out-var-declaration" class="header-anchor">#</a> out var declaration</h2> <p>A common pattern in C# is using <code>bool TryParse(object input, out object value)</code> to safely parse objects.</p> <p>The <code>out var</code> declaration is a simple feature to improve readability. It allows a variable to be declared at the same time that is it passed as an out parameter.</p> <p>A variable declared this way is scoped to the remainder of the body at the point in which it is declared.</p> <h3 id="example-4"><a href="#example-4" class="header-anchor">#</a> Example</h3> <p>Using <code>TryParse</code> prior to C# 7.0, you must declare a variable to receive the value before calling the function:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span></span> <span class="token keyword">value</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span>
<span class="token punctuation">{</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// value is zero</span>
<span class="token punctuation">}</span>

<span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>

</code></pre></div><p>In C# 7.0, you can inline the declaration of the variable passed to the <code>out</code> parameter, eliminating the need for a separate variable declaration:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">var</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span>
<span class="token punctuation">{</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// value is zero</span>
<span class="token punctuation">}</span>

<span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// still ok, the value in scope within the remainder of the body</span>

</code></pre></div><p>If some of the parameters that a function returns in <code>out</code> is not needed you can use the <strong>discard</strong> operator <code>_</code>.</p> <div class="language-cs extra-class"><pre class="language-cs"><code>p<span class="token punctuation">.</span><span class="token function">GetCoordinates</span><span class="token punctuation">(</span><span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">var</span></span> x<span class="token punctuation">,</span> <span class="token keyword">out</span> _<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// I only care about x</span>

</code></pre></div><p>An <code>out var</code> declaration can be used with any existing function which already has <code>out</code> parameters. The function declaration syntax remains the same, and no additional requirements are needed to make the function compatible with an <code>out var</code> declaration. This feature is simply syntactic sugar.</p> <p>Another feature of <code>out var</code> declaration is that it can be used with anonymous types.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> a <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> groupedByMod2 <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token keyword">new</span>
                                  <span class="token punctuation">{</span>
                                      Source <span class="token operator">=</span> x<span class="token punctuation">,</span>
                                      Mod2 <span class="token operator">=</span> x <span class="token operator">%</span> <span class="token number">2</span>
                                  <span class="token punctuation">}</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Mod2<span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">ToDictionary</span><span class="token punctuation">(</span>g <span class="token operator">=&gt;</span> g<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> g <span class="token operator">=&gt;</span> g<span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>groupedByMod2<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">var</span></span> oddElements<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>oddElements<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>In this code we create a <code>Dictionary</code> with <code>int</code> key and array of anonymous type value. In the previous version of C# it was impossible to use <code>TryGetValue</code> method here since it required you to declare the <code>out</code> variable (which is of anonymous type!). However, with <code>out var</code> we do not need to explicitly specify the type of the <code>out</code> variable.</p> <h3 id="limitations"><a href="#limitations" class="header-anchor">#</a> Limitations</h3> <p>Note that out var declarations are of limited use in LINQ queries as expressions are interpreted as expression lambda bodies, so the scope of the introduced variables is limited to these lambdas. For example, the following code will not work:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> nums <span class="token operator">=</span> 
    <span class="token keyword">from</span> item <span class="token keyword">in</span> seq
    <span class="token keyword">let</span> success <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name"><span class="token keyword">var</span></span> tmp<span class="token punctuation">)</span>
    <span class="token keyword">select</span> <span class="token class-name">success <span class="token punctuation">?</span></span> tmp <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// Error: The name 'tmp' does not exist in the current context</span>

</code></pre></div><h3 id="references-2"><a href="#references-2" class="header-anchor">#</a> References</h3> <ul><li><a href="https://github.com/dotnet/roslyn/issues/6183" target="_blank" rel="noopener noreferrer">Original out var declaration proposal on GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="pattern-matching"><a href="#pattern-matching" class="header-anchor">#</a> Pattern Matching</h2> <p>Pattern matching extensions for C# enable many of the benefits of pattern matching from functional languages, but in a way that smoothly integrates with the feel of the underlying language</p> <h3 id="switch-expression"><a href="#switch-expression" class="header-anchor">#</a> <strong><code>switch</code> expression</strong></h3> <p>Pattern matching extends the <code>switch</code> statement to switch on types:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">Geometry</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> 

<span class="token keyword">class</span> <span class="token class-name">Triangle</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Geometry</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Width <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Height <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Base <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Geometry</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Width <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Height <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Square</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Geometry</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Width <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PatternMatching</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">Geometry</span> g <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Square</span> <span class="token punctuation">{</span> Width <span class="token operator">=</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 
    
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>g<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token class-name">Triangle</span> t<span class="token punctuation">:</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">t<span class="token punctuation">.</span>Width</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">t<span class="token punctuation">.</span>Height</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">t<span class="token punctuation">.</span>Base</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token class-name">Rectangle</span> sq <span class="token keyword">when</span> sq<span class="token punctuation">.</span>Width <span class="token operator">==</span> sq<span class="token punctuation">.</span>Height<span class="token punctuation">:</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Square rectangle: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">sq<span class="token punctuation">.</span>Width</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">sq<span class="token punctuation">.</span>Height</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token class-name">Rectangle</span> r<span class="token punctuation">:</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">r<span class="token punctuation">.</span>Width</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">r<span class="token punctuation">.</span>Height</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token class-name">Square</span> s<span class="token punctuation">:</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s<span class="token punctuation">.</span>Width</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;other&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="is-expression"><a href="#is-expression" class="header-anchor">#</a> <strong><code>is</code> expression</strong></h3> <p>Pattern matching extends the <code>is</code> operator to check for a type and declare a new variable at the same time.</p> <h3 id="example-5"><a href="#example-5" class="header-anchor">#</a> Example</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">string</span></span> s <span class="token operator">=</span> o <span class="token keyword">as</span> <span class="token class-name"><span class="token keyword">string</span></span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>s <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// do something with s</span>
<span class="token punctuation">}</span>

</code></pre></div><p>can be rewritten as:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">if</span><span class="token punctuation">(</span>o <span class="token keyword">is</span> <span class="token class-name"><span class="token keyword">string</span></span> s<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//Do something with s</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>Also note that the scope of the pattern variable <code>s</code> is extended to outside the <code>if</code> block reaching the end of the enclosing scope, example:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">if</span><span class="token punctuation">(</span>someCondition<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>o <span class="token keyword">is</span> <span class="token class-name"><span class="token keyword">string</span></span> s<span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token comment">//Do something with s</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">else</span>
   <span class="token punctuation">{</span>
     <span class="token comment">// s is unassigned here, but accessible </span>
   <span class="token punctuation">}</span>

   <span class="token comment">// s is unassigned here, but accessible </span>
<span class="token punctuation">}</span>
<span class="token comment">// s is not accessible here</span>

</code></pre></div><h2 id="digit-separators"><a href="#digit-separators" class="header-anchor">#</a> Digit separators</h2> <p>The underscore <code>_</code> may be used as a digit separator. Being able to group digits in large numeric literals has a significant impact on readability.</p> <p>The underscore may occur anywhere in a numeric literal except as noted below. Different groupings may make sense in different scenarios or with different numeric bases.</p> <p>Any sequence of digits may be separated by one or more underscores. The <code>_</code> is allowed in decimals as well as exponents. The separators have no semantic impact - they are simply ignored.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span></span> bin <span class="token operator">=</span> <span class="token number">0b1001_1010_0001_0100</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">int</span></span> hex <span class="token operator">=</span> <span class="token number">0x1b_a0_44_fe</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">int</span></span> dec <span class="token operator">=</span> <span class="token number">33_554_432</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">int</span></span> weird <span class="token operator">=</span> <span class="token number">1_2__3___4____5_____6______7_______8________9</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">double</span></span> real <span class="token operator">=</span> <span class="token number">1_000.111_1e-1_000</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Where the <code>_</code> digit separator may not be used:</strong></p> <ul><li>at the beginning of the value (<code>_121</code>)</li> <li>at the end of the value (<code>121_</code> or <code>121.05_</code>)</li> <li>next to the decimal (<code>10_.0</code>)</li> <li>next to the exponent character (<code>1.1e_1</code>)</li> <li>next to the type specifier (<code>10_f</code>)</li> <li>immediately following the <code>0x</code> or <code>0b</code> in binary and hexadecimal literals (<a href="https://github.com/dotnet/roslyn/issues/12680" target="_blank" rel="noopener noreferrer">might be changed to allow e.g. 0b_1001_1000<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</li></ul> <h2 id="binary-literals"><a href="#binary-literals" class="header-anchor">#</a> Binary literals</h2> <p>The <strong>0b</strong> prefix can be used to represent Binary literals.</p> <p>Binary literals allow constructing numbers from zeroes and ones, which makes seeing which bits are set in the binary representation of a number much easier. This can be useful for working with binary flags.</p> <p>The following are equivalent ways of specifying an <code>int</code> with value <code>34</code> (=2<sup>5</sup> + 2<sup>1</sup>):</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Using a binary literal:</span>
<span class="token comment">//   bits: 76543210</span>
<span class="token class-name"><span class="token keyword">int</span></span> a1 <span class="token operator">=</span> <span class="token number">0b00100010</span><span class="token punctuation">;</span>          <span class="token comment">// binary: explicitly specify bits</span>

<span class="token comment">// Existing methods:</span>
<span class="token class-name"><span class="token keyword">int</span></span> a2 <span class="token operator">=</span> <span class="token number">0x22</span><span class="token punctuation">;</span>                <span class="token comment">// hexadecimal: every digit corresponds to 4 bits</span>
<span class="token class-name"><span class="token keyword">int</span></span> a3 <span class="token operator">=</span> <span class="token number">34</span><span class="token punctuation">;</span>                  <span class="token comment">// decimal: hard to visualise which bits are set</span>
<span class="token class-name"><span class="token keyword">int</span></span> a4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bitwise arithmetic: combining non-zero bits</span>

</code></pre></div><h3 id="flags-enumerations"><a href="#flags-enumerations" class="header-anchor">#</a> Flags enumerations</h3> <p>Before, specifying flag values for an <code>enum</code> could only be done using one of the three methods in this example:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Flags</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">DaysOfWeek</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Previously available methods:</span>
    <span class="token comment">//          decimal        hex       bit shifting</span>
    Monday    <span class="token operator">=</span>  <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token comment">//    = 0x01    = 1 &lt;&lt; 0</span>
    Tuesday   <span class="token operator">=</span>  <span class="token number">2</span><span class="token punctuation">,</span>    <span class="token comment">//    = 0x02    = 1 &lt;&lt; 1</span>
    Wednesday <span class="token operator">=</span>  <span class="token number">4</span><span class="token punctuation">,</span>    <span class="token comment">//    = 0x04    = 1 &lt;&lt; 2</span>
    Thursday  <span class="token operator">=</span>  <span class="token number">8</span><span class="token punctuation">,</span>    <span class="token comment">//    = 0x08    = 1 &lt;&lt; 3</span>
    Friday    <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">,</span>    <span class="token comment">//    = 0x10    = 1 &lt;&lt; 4</span>
    Saturday  <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">,</span>    <span class="token comment">//    = 0x20    = 1 &lt;&lt; 5</span>
    Sunday    <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">,</span>    <span class="token comment">//    = 0x40    = 1 &lt;&lt; 6</span>

    Weekdays <span class="token operator">=</span> Monday <span class="token operator">|</span> Tuesday <span class="token operator">|</span> Wednesday <span class="token operator">|</span> Thursday <span class="token operator">|</span> Friday<span class="token punctuation">,</span>
    Weekends <span class="token operator">=</span> Saturday <span class="token operator">|</span> Sunday
<span class="token punctuation">}</span>

</code></pre></div><p>With binary literals it is more obvious which bits are set, and using them does not require understanding hexadecimal numbers and bitwise arithmetic:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Flags</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">DaysOfWeek</span>
<span class="token punctuation">{</span>
    Monday    <span class="token operator">=</span> <span class="token number">0b00000001</span><span class="token punctuation">,</span>
    Tuesday   <span class="token operator">=</span> <span class="token number">0b00000010</span><span class="token punctuation">,</span>
    Wednesday <span class="token operator">=</span> <span class="token number">0b00000100</span><span class="token punctuation">,</span>
    Thursday  <span class="token operator">=</span> <span class="token number">0b00001000</span><span class="token punctuation">,</span>
    Friday    <span class="token operator">=</span> <span class="token number">0b00010000</span><span class="token punctuation">,</span>
    Saturday  <span class="token operator">=</span> <span class="token number">0b00100000</span><span class="token punctuation">,</span>
    Sunday    <span class="token operator">=</span> <span class="token number">0b01000000</span><span class="token punctuation">,</span>

    Weekdays <span class="token operator">=</span> Monday <span class="token operator">|</span> Tuesday <span class="token operator">|</span> Wednesday <span class="token operator">|</span> Thursday <span class="token operator">|</span> Friday<span class="token punctuation">,</span>
    Weekends <span class="token operator">=</span> Saturday <span class="token operator">|</span> Sunday
<span class="token punctuation">}</span>

</code></pre></div><h2 id="throw-expressions"><a href="#throw-expressions" class="header-anchor">#</a> throw expressions</h2> <p>C# 7.0 allows throwing as an expression in certain places:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Name <span class="token operator">=</span> name <span class="token operator">??</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ArgumentNullException</span><span class="token punctuation">(</span><span class="token keyword">nameof</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetFirstName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> parts <span class="token operator">=</span> Name<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token string character">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>parts<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">InvalidOperationException</span><span class="token punctuation">(</span><span class="token string">&quot;No name!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetLastName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">NotImplementedException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Prior to C# 7.0, if you wanted to throw an exception from an expression body you would have to:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> spoons <span class="token operator">=</span> <span class="token string">&quot;dinner,desert,soup&quot;</span><span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token string character">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> spoonsArray <span class="token operator">=</span> spoons<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">?</span> spoons <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>spoonsArray <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token string">&quot;There are no spoons&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Or</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> spoonsArray <span class="token operator">=</span> spoons<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span> 
    <span class="token punctuation">?</span> spoons 
    <span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> 
      <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token string">&quot;There are no spoons&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>In C# 7.0 the above is now simplified to:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> spoonsArray <span class="token operator">=</span> spoons<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">?</span> spoons <span class="token punctuation">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token string">&quot;There are no spoons&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="extended-expression-bodied-members-list"><a href="#extended-expression-bodied-members-list" class="header-anchor">#</a> Extended expression bodied members list</h2> <p>C# 7.0 adds accessors, constructors and finalizers to the list of things that can have expression bodies:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ConcurrentDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> names <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ConcurrentDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">int</span></span> id <span class="token operator">=</span> <span class="token function">GetId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> names<span class="token punctuation">.</span><span class="token function">TryAdd</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// constructors</span>

    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> names<span class="token punctuation">.</span><span class="token function">TryRemove</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token keyword">out</span> _<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// finalizers</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name
    <span class="token punctuation">{</span>
        <span class="token keyword">get</span> <span class="token operator">=&gt;</span> names<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>                                 <span class="token comment">// getters</span>
        <span class="token keyword">set</span> <span class="token operator">=&gt;</span> names<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>                         <span class="token comment">// setters</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Also see the <a href="http://stackoverflow.com/documentation/c%23/1936/c-sharp-7-0-features/6326/out-var-declaration" target="_blank" rel="noopener noreferrer">out var declaration<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> section for the discard operator.</p> <h2 id="ref-return-and-ref-local"><a href="#ref-return-and-ref-local" class="header-anchor">#</a> ref return and ref local</h2> <p>Ref returns and ref locals are useful for manipulating and returning references to blocks of memory instead of copying memory without resorting to unsafe pointers.</p> <h3 id="ref-return"><a href="#ref-return" class="header-anchor">#</a> Ref Return</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">ref</span> <span class="token return-type class-name">TValue</span> <span class="token generic-method"><span class="token function">Choose</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TValue<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> condition<span class="token punctuation">,</span> <span class="token keyword">ref</span> <span class="token class-name">TValue</span> left<span class="token punctuation">,</span> <span class="token keyword">ref</span> <span class="token class-name">TValue</span> right<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">condition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> <span class="token keyword">ref</span> left <span class="token punctuation">:</span> <span class="token keyword">ref</span> right<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>With this you can pass two values by reference with one of them being returned based on some condition:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">Matrix3D</span> left <span class="token operator">=</span> …<span class="token punctuation">,</span> right <span class="token operator">=</span> …<span class="token punctuation">;</span>
<span class="token function">Choose</span><span class="token punctuation">(</span>chooser<span class="token punctuation">,</span> <span class="token keyword">ref</span> left<span class="token punctuation">,</span> <span class="token keyword">ref</span> right<span class="token punctuation">)</span><span class="token punctuation">.</span>M20 <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="ref-local"><a href="#ref-local" class="header-anchor">#</a> Ref Local</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">ref</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">int</span></span> first<span class="token punctuation">,</span> <span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">int</span></span> second<span class="token punctuation">,</span> <span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">int</span></span> third<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">int</span></span> max <span class="token operator">=</span> first <span class="token operator">&gt;</span> second <span class="token punctuation">?</span> <span class="token keyword">ref</span> first <span class="token punctuation">:</span> <span class="token keyword">ref</span> second<span class="token punctuation">;</span>
    <span class="token keyword">return</span> max <span class="token operator">&gt;</span> third <span class="token punctuation">?</span> <span class="token keyword">ref</span> max <span class="token punctuation">:</span> <span class="token keyword">ref</span> third<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
…
<span class="token class-name"><span class="token keyword">int</span></span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token function">Max</span><span class="token punctuation">(</span><span class="token keyword">ref</span> a<span class="token punctuation">,</span> <span class="token keyword">ref</span> b<span class="token punctuation">,</span> <span class="token keyword">ref</span> c<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
Debug<span class="token punctuation">.</span><span class="token function">Assert</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Debug<span class="token punctuation">.</span><span class="token function">Assert</span><span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Debug<span class="token punctuation">.</span><span class="token function">Assert</span><span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

</code></pre></div><h3 id="unsafe-ref-operations"><a href="#unsafe-ref-operations" class="header-anchor">#</a> Unsafe Ref Operations</h3> <p>In <code>System.Runtime.CompilerServices.Unsafe</code> a set of unsafe operations have been defined that allow you to manipulate <code>ref</code> values as if they were pointers, basically.</p> <p>For example, reinterpreting a memory address (<code>ref</code>) as a different type:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">byte</span></span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x42</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">int</span></span> r <span class="token operator">=</span> <span class="token keyword">ref</span> Unsafe<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">As</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">byte</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">ref</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span><span class="token number">0x42424242</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">0x0EF00EF0</span><span class="token punctuation">;</span>
Assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span><span class="token number">0xFE</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">|</span> b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">|</span> b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">|</span> b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Beware of <a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener noreferrer">endianness<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> when doing this, though, e.g. check <code>BitConverter.IsLittleEndian</code> if needed and handle accordingly.</p> <p>Or iterate over an array in an unsafe manner:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token number">0x123</span><span class="token punctuation">,</span> <span class="token number">0x234</span><span class="token punctuation">,</span> <span class="token number">0x345</span><span class="token punctuation">,</span> <span class="token number">0x456</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">int</span></span> r1 <span class="token operator">=</span> <span class="token keyword">ref</span> Unsafe<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">ref</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span><span class="token number">0x234</span><span class="token punctuation">,</span> r1<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">int</span></span> r2 <span class="token operator">=</span> <span class="token keyword">ref</span> Unsafe<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">ref</span> r1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span><span class="token number">0x456</span><span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">int</span></span> r3 <span class="token operator">=</span> <span class="token keyword">ref</span> Unsafe<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">ref</span> r2<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span><span class="token number">0x123</span><span class="token punctuation">,</span> r3<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Or the similar <code>Subtract</code>:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;def&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ghi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jkl&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">string</span></span> r1 <span class="token operator">=</span> <span class="token keyword">ref</span> Unsafe<span class="token punctuation">.</span><span class="token function">Subtract</span><span class="token punctuation">(</span><span class="token keyword">ref</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span><span class="token string">&quot;ghi&quot;</span><span class="token punctuation">,</span> r1<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">string</span></span> r2 <span class="token operator">=</span> <span class="token keyword">ref</span> Unsafe<span class="token punctuation">.</span><span class="token function">Subtract</span><span class="token punctuation">(</span><span class="token keyword">ref</span> r1<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span><span class="token string">&quot;jkl&quot;</span><span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">string</span></span> r3 <span class="token operator">=</span> <span class="token keyword">ref</span> Unsafe<span class="token punctuation">.</span><span class="token function">Subtract</span><span class="token punctuation">(</span><span class="token keyword">ref</span> r2<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span> r3<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Additionally, one can check if two <code>ref</code> values are the same i.e. same address:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">long</span></span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

Assert<span class="token punctuation">.</span><span class="token function">True</span><span class="token punctuation">(</span>Unsafe<span class="token punctuation">.</span><span class="token function">AreSame</span><span class="token punctuation">(</span><span class="token keyword">ref</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">ref</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Assert<span class="token punctuation">.</span><span class="token function">False</span><span class="token punctuation">(</span>Unsafe<span class="token punctuation">.</span><span class="token function">AreSame</span><span class="token punctuation">(</span><span class="token keyword">ref</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">ref</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="links"><a href="#links" class="header-anchor">#</a> Links</h3> <p><a href="https://github.com/dotnet/roslyn/issues/118" target="_blank" rel="noopener noreferrer">Roslyn Github Issue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://github.com/dotnet/corefx/tree/master/src/System.Runtime.CompilerServices.Unsafe" target="_blank" rel="noopener noreferrer">System.Runtime.CompilerServices.Unsafe on github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="valuetask"><a href="#valuetask" class="header-anchor">#</a> ValueTask<T></T></h2> <p><code>Task&lt;T&gt;</code> is a <strong>class</strong> and causes the unnecessary overhead of its allocation when the result is immediately available.</p> <p><code>ValueTask&lt;T&gt;</code> is a <strong>structure</strong> and has been introduced to prevent the allocation of a <code>Task</code> object in case the result of the <strong>async</strong> operation is already available at the time of awaiting.</p> <p>So <code>ValueTask&lt;T&gt;</code> provides two benefits:</p> <h3 id="_1-performance-increase"><a href="#_1-performance-increase" class="header-anchor">#</a> 1. Performance increase</h3> <p>Here's a <code>Task&lt;T&gt;</code> example:</p> <ul><li>Requires heap allocation</li> <li>Takes 120ns with JIT</li></ul> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token function">TestTask</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> d<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Here's the analog <code>ValueTask&lt;T&gt;</code> example:</p> <ul><li>No heap allocation if the result is known synchronously (which it is not in this case because of the <code>Task.Delay</code>, but often is in many real-world <code>async</code>/<code>await</code> scenarios)</li> <li>Takes 65ns with JIT</li></ul> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">async</span> <span class="token return-type class-name">ValueTask<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token function">TestValueTask</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> d<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="_2-increased-implementation-flexibility"><a href="#_2-increased-implementation-flexibility" class="header-anchor">#</a> 2. Increased implementation flexibility</h3> <p>Implementations of an async interface wishing to be synchronous would otherwise be forced to use either <code>Task.Run</code> or <code>Task.FromResult</code> (resulting in the performance penalty discussed above). Thus there's some pressure against synchronous implementations.</p> <p>But with <code>ValueTask&lt;T&gt;</code>, implementations are more free to choose between being synchronous or asynchronous without impacting callers.</p> <p>For example, here's an interface with an asynchronous method:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">interface</span> <span class="token class-name">IFoo<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token return-type class-name">ValueTask<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token function">BarAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>...and here's how that method might be called:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">IFoo<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> thing <span class="token operator">=</span> <span class="token function">getThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> x <span class="token operator">=</span> <span class="token keyword">await</span> thing<span class="token punctuation">.</span><span class="token function">BarAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>With <code>ValueTask</code>, the above code will work with <strong>either synchronous or asynchronous implementations</strong>:</p> <h3 id="synchronous-implementation"><a href="#synchronous-implementation" class="header-anchor">#</a> Synchronous implementation:</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">SynchronousFoo<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IFoo<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">ValueTask<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token function">BarAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> <span class="token keyword">value</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">(</span><span class="token type-expression class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ValueTask<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="asynchronous-implementation"><a href="#asynchronous-implementation" class="header-anchor">#</a> Asynchronous implementation</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">AsynchronousFoo<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IFoo<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">ValueTask<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token function">BarAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> <span class="token keyword">value</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">(</span><span class="token type-expression class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="notes"><a href="#notes" class="header-anchor">#</a> Notes</h3> <p>Although <code>ValueTask</code> struct was being planned to be added to <a href="https://blogs.msdn.microsoft.com/dotnet/2016/08/24/whats-new-in-csharp-7-0/" target="_blank" rel="noopener noreferrer">C# 7.0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, it has been kept as another library for the time being.
<a href="http://stackoverflow.com/documentation/c%23/1936/c-sharp-7-0-features/28612/valuetaskt#" target="_blank" rel="noopener noreferrer">ValueTask<T><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></T></a> <code>System.Threading.Tasks.Extensions</code> package can be downloaded from <a href="https://www.nuget.org/packages/System.Threading.Tasks.Extensions/" target="_blank" rel="noopener noreferrer">Nuget Gallery<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/csharp/c-7-0-features.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/csharp/xdocument-and-the-system-xml-linq-namespace.html" class="prev">
        XDocument and the System.Xml.Linq namespace
      </a></span> <span class="next"><a href="/csharp/c-6-0-features.html">
        C# 6.0 Features
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/782.61c4f7f9.js" defer></script>
  </body>
</html>
