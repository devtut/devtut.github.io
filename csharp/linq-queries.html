<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C# | LINQ Queries</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Chaining methods, First, FirstOrDefault, Last, LastOrDefault, Single, and SingleOrDefault, Except, SelectMany, Any, JOINS, Skip and Take, Defining a variable inside a Linq query (let keyword), Zip, Range and Repeat, All, Basics, Aggregate, SelectMany: Flattening a sequence of sequences, Distinct, Query collection by type / cast elements to type, GroupBy, Enumerating the Enumerable, Where, Using Range with various Linq methods, Using SelectMany instead of nested loops, Contains, GroupBy one or multiple fields, Query Ordering - OrderBy() ThenBy() OrderByDescending() ThenByDescending(), ToDictionary, SkipWhile, DefaultIfEmpty, SequenceEqual, ElementAt and ElementAtOrDefault, Joining multiple sequences, Joining on multiple keys, Sum, ToLookup, Any and First(OrDefault) - best practice, GroupBy Sum and Count, OrderBy, Select - Transforming elements, Union, Count and LongCount, Incrementally building a query, GroupJoin with outer range variable, Linq  Quantifiers, TakeWhile, Build your own Linq operators for IEnumerable<T>, Reverse, OrderByDescending, Concat, Select with Func<TSource, int, TResult> selector - Use to get ranking of elements">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="C# | LINQ Queries">
    <meta property="og:description" content="Chaining methods, First, FirstOrDefault, Last, LastOrDefault, Single, and SingleOrDefault, Except, SelectMany, Any, JOINS, Skip and Take, Defining a variable inside a Linq query (let keyword), Zip, Range and Repeat, All, Basics, Aggregate, SelectMany: Flattening a sequence of sequences, Distinct, Query collection by type / cast elements to type, GroupBy, Enumerating the Enumerable, Where, Using Range with various Linq methods, Using SelectMany instead of nested loops, Contains, GroupBy one or multiple fields, Query Ordering - OrderBy() ThenBy() OrderByDescending() ThenByDescending(), ToDictionary, SkipWhile, DefaultIfEmpty, SequenceEqual, ElementAt and ElementAtOrDefault, Joining multiple sequences, Joining on multiple keys, Sum, ToLookup, Any and First(OrDefault) - best practice, GroupBy Sum and Count, OrderBy, Select - Transforming elements, Union, Count and LongCount, Incrementally building a query, GroupJoin with outer range variable, Linq  Quantifiers, TakeWhile, Build your own Linq operators for IEnumerable<T>, Reverse, OrderByDescending, Concat, Select with Func<TSource, int, TResult> selector - Use to get ranking of elements">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/csharp/linq-queries.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="C# | LINQ Queries">
    <meta name="twitter:description" content="Chaining methods, First, FirstOrDefault, Last, LastOrDefault, Single, and SingleOrDefault, Except, SelectMany, Any, JOINS, Skip and Take, Defining a variable inside a Linq query (let keyword), Zip, Range and Repeat, All, Basics, Aggregate, SelectMany: Flattening a sequence of sequences, Distinct, Query collection by type / cast elements to type, GroupBy, Enumerating the Enumerable, Where, Using Range with various Linq methods, Using SelectMany instead of nested loops, Contains, GroupBy one or multiple fields, Query Ordering - OrderBy() ThenBy() OrderByDescending() ThenByDescending(), ToDictionary, SkipWhile, DefaultIfEmpty, SequenceEqual, ElementAt and ElementAtOrDefault, Joining multiple sequences, Joining on multiple keys, Sum, ToLookup, Any and First(OrDefault) - best practice, GroupBy Sum and Count, OrderBy, Select - Transforming elements, Union, Count and LongCount, Incrementally building a query, GroupJoin with outer range variable, Linq  Quantifiers, TakeWhile, Build your own Linq operators for IEnumerable<T>, Reverse, OrderByDescending, Concat, Select with Func<TSource, int, TResult> selector - Use to get ranking of elements">
    <meta name="twitter:url" content="/csharp/linq-queries.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/849.e4911896.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>C#</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/csharp/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/csharp/getting-started-with-c-language.html" class="sidebar-link">Getting started with C# Language</a></li><li><a href="/csharp/literals.html" class="sidebar-link">Literals</a></li><li><a href="/csharp/operators.html" class="sidebar-link">Operators</a></li><li><a href="/csharp/conditional-statements.html" class="sidebar-link">Conditional Statements</a></li><li><a href="/csharp/equality-operator.html" class="sidebar-link">Equality Operator</a></li><li><a href="/csharp/equals-and-gethashcode.html" class="sidebar-link">Equals and GetHashCode</a></li><li><a href="/csharp/null-coalescing-operator.html" class="sidebar-link">Null-Coalescing Operator</a></li><li><a href="/csharp/null-conditional-operators.html" class="sidebar-link">Null-conditional Operators</a></li><li><a href="/csharp/nameof-operator.html" class="sidebar-link">nameof Operator</a></li><li><a href="/csharp/verbatim-strings.html" class="sidebar-link">Verbatim Strings</a></li><li><a href="/csharp/common-string-operations.html" class="sidebar-link">Common String Operations</a></li><li><a href="/csharp/string-format.html" class="sidebar-link">String.Format</a></li><li><a href="/csharp/string-concatenate.html" class="sidebar-link">String Concatenate</a></li><li><a href="/csharp/string-manipulation.html" class="sidebar-link">String Manipulation</a></li><li><a href="/csharp/string-interpolation.html" class="sidebar-link">String Interpolation</a></li><li><a href="/csharp/string-escape-sequences.html" class="sidebar-link">String Escape Sequences</a></li><li><a href="/csharp/stringbuilder.html" class="sidebar-link">StringBuilder</a></li><li><a href="/csharp/regex-parsing.html" class="sidebar-link">Regex Parsing</a></li><li><a href="/csharp/datetime-methods.html" class="sidebar-link">DateTime Methods</a></li><li><a href="/csharp/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/csharp/o-n-algorithm-for-circular-rotation-of-an-array.html" class="sidebar-link">O(n) Algorithm for circular rotation of an array</a></li><li><a href="/csharp/enum.html" class="sidebar-link">Enum</a></li><li><a href="/csharp/tuples.html" class="sidebar-link">Tuples</a></li><li><a href="/csharp/guid.html" class="sidebar-link">Guid</a></li><li><a href="/csharp/biginteger.html" class="sidebar-link">BigInteger</a></li><li><a href="/csharp/collection-initializers.html" class="sidebar-link">Collection Initializers</a></li><li><a href="/csharp/an-overview-of-c-collections.html" class="sidebar-link">An overview of c# collections</a></li><li><a href="/csharp/looping.html" class="sidebar-link">Looping</a></li><li><a href="/csharp/iterators.html" class="sidebar-link">Iterators</a></li><li><a href="/csharp/ienumerable.html" class="sidebar-link">IEnumerable</a></li><li><a href="/csharp/value-type-vs-reference-type.html" class="sidebar-link">Value type vs Reference type</a></li><li><a href="/csharp/built-in-types.html" class="sidebar-link">Built-in Types</a></li><li><a href="/csharp/aliases-of-built-in-types.html" class="sidebar-link">Aliases of built-in types</a></li><li><a href="/csharp/anonymous-types.html" class="sidebar-link">Anonymous types</a></li><li><a href="/csharp/dynamic-type.html" class="sidebar-link">Dynamic type</a></li><li><a href="/csharp/type-conversion.html" class="sidebar-link">Type Conversion</a></li><li><a href="/csharp/casting.html" class="sidebar-link">Casting</a></li><li><a href="/csharp/nullable-types.html" class="sidebar-link">Nullable types</a></li><li><a href="/csharp/constructors-and-finalizers.html" class="sidebar-link">Constructors and Finalizers</a></li><li><a href="/csharp/access-modifiers.html" class="sidebar-link">Access Modifiers</a></li><li><a href="/csharp/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/csharp/static-classes.html" class="sidebar-link">Static Classes</a></li><li><a href="/csharp/singleton-implementation.html" class="sidebar-link">Singleton Implementation</a></li><li><a href="/csharp/dependency-injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/csharp/partial-class-and-methods.html" class="sidebar-link">Partial class and methods</a></li><li><a href="/csharp/object-initializers.html" class="sidebar-link">Object initializers</a></li><li><a href="/csharp/methods.html" class="sidebar-link">Methods</a></li><li><a href="/csharp/extension-methods.html" class="sidebar-link">Extension Methods</a></li><li><a href="/csharp/named-arguments.html" class="sidebar-link">Named Arguments</a></li><li><a href="/csharp/named-and-optional-arguments.html" class="sidebar-link">Named and Optional Arguments</a></li><li><a href="/csharp/data-annotation.html" class="sidebar-link">Data Annotation</a></li><li><a href="/csharp/keywords.html" class="sidebar-link">Keywords</a></li><li><a href="/csharp/object-oriented-programming-in-c.html" class="sidebar-link">Object Oriented Programming In C#</a></li><li><a href="/csharp/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/csharp/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/csharp/xml-documentation-comments.html" class="sidebar-link">XML Documentation Comments</a></li><li><a href="/csharp/comments-and-regions.html" class="sidebar-link">Comments and regions</a></li><li><a href="/csharp/inheritance.html" class="sidebar-link">Inheritance</a></li><li><a href="/csharp/generics.html" class="sidebar-link">Generics</a></li><li><a href="/csharp/using-statement.html" class="sidebar-link">Using Statement</a></li><li><a href="/csharp/using-directive.html" class="sidebar-link">Using Directive</a></li><li><a href="/csharp/idisposable-interface.html" class="sidebar-link">IDisposable interface</a></li><li><a href="/csharp/reflection.html" class="sidebar-link">Reflection</a></li><li><a href="/csharp/iqueryable-interface.html" class="sidebar-link">IQueryable interface</a></li><li><a href="/csharp/linq-to-objects.html" class="sidebar-link">Linq to Objects</a></li><li><a href="/csharp/linq-queries.html" aria-current="page" class="active sidebar-link">LINQ Queries</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#chaining-methods" class="sidebar-link">Chaining methods</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#first-firstordefault-last-lastordefault-single-and-singleordefault" class="sidebar-link">First, FirstOrDefault, Last, LastOrDefault, Single, and SingleOrDefault</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#except" class="sidebar-link">Except</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#selectmany" class="sidebar-link">SelectMany</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#any" class="sidebar-link">Any</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#joins" class="sidebar-link">JOINS</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#skip-and-take" class="sidebar-link">Skip and Take</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#defining-a-variable-inside-a-linq-query-let-keyword" class="sidebar-link">Defining a variable inside a Linq query (let keyword)</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#zip" class="sidebar-link">Zip</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#range-and-repeat" class="sidebar-link">Range and Repeat</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#all" class="sidebar-link">All</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#basics" class="sidebar-link">Basics</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#aggregate" class="sidebar-link">Aggregate</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#selectmany-flattening-a-sequence-of-sequences" class="sidebar-link">SelectMany: Flattening a sequence of sequences</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#distinct" class="sidebar-link">Distinct</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#query-collection-by-type-cast-elements-to-type" class="sidebar-link">Query collection by type / cast elements to type</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#groupby" class="sidebar-link">GroupBy</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#enumerating-the-enumerable" class="sidebar-link">Enumerating the Enumerable</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#where" class="sidebar-link">Where</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#using-range-with-various-linq-methods" class="sidebar-link">Using Range with various Linq methods</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#using-selectmany-instead-of-nested-loops" class="sidebar-link">Using SelectMany instead of nested loops</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#contains" class="sidebar-link">Contains</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#groupby-one-or-multiple-fields" class="sidebar-link">GroupBy one or multiple fields</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#query-ordering-orderby-thenby-orderbydescending-thenbydescending" class="sidebar-link">Query Ordering - OrderBy() ThenBy() OrderByDescending() ThenByDescending()</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#todictionary" class="sidebar-link">ToDictionary</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#skipwhile" class="sidebar-link">SkipWhile</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#defaultifempty" class="sidebar-link">DefaultIfEmpty</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#sequenceequal" class="sidebar-link">SequenceEqual</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#elementat-and-elementatordefault" class="sidebar-link">ElementAt and ElementAtOrDefault</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#joining-multiple-sequences" class="sidebar-link">Joining multiple sequences</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#joining-on-multiple-keys" class="sidebar-link">Joining on multiple keys</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#sum" class="sidebar-link">Sum</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#tolookup" class="sidebar-link">ToLookup</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#any-and-first-ordefault-best-practice" class="sidebar-link">Any and First(OrDefault) - best practice</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#groupby-sum-and-count" class="sidebar-link">GroupBy Sum and Count</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#orderby" class="sidebar-link">OrderBy</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#select-transforming-elements" class="sidebar-link">Select - Transforming elements</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#union" class="sidebar-link">Union</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#count-and-longcount" class="sidebar-link">Count and LongCount</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#incrementally-building-a-query" class="sidebar-link">Incrementally building a query</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#groupjoin-with-outer-range-variable" class="sidebar-link">GroupJoin with outer range variable</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#linq-quantifiers" class="sidebar-link">Linq  Quantifiers</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#takewhile" class="sidebar-link">TakeWhile</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#build-your-own-linq-operators-for-ienumerable" class="sidebar-link">Build your own Linq operators for IEnumerable</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#reverse" class="sidebar-link">Reverse</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#orderbydescending" class="sidebar-link">OrderByDescending</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#concat" class="sidebar-link">Concat</a></li><li class="sidebar-sub-header"><a href="/csharp/linq-queries.html#select-with-func-tsource-int-tresult-selector-use-to-get-ranking-of-elements" class="sidebar-link">Select with Func selector - Use to get ranking of elements</a></li></ul></li><li><a href="/csharp/linq-to-xml.html" class="sidebar-link">LINQ to XML</a></li><li><a href="/csharp/parallel-linq-plinq.html" class="sidebar-link">Parallel LINQ (PLINQ)</a></li><li><a href="/csharp/xmldocument-and-the-system-xml-namespace.html" class="sidebar-link">XmlDocument and the System.Xml namespace</a></li><li><a href="/csharp/xdocument-and-the-system-xml-linq-namespace.html" class="sidebar-link">XDocument and the System.Xml.Linq namespace</a></li><li><a href="/csharp/c-7-0-features.html" class="sidebar-link">C# 7.0 Features</a></li><li><a href="/csharp/c-6-0-features.html" class="sidebar-link">C# 6.0 Features</a></li><li><a href="/csharp/c-5-0-features.html" class="sidebar-link">C# 5.0 Features</a></li><li><a href="/csharp/c-4-0-features.html" class="sidebar-link">C# 4.0 Features</a></li><li><a href="/csharp/c-3-0-features.html" class="sidebar-link">C# 3.0 Features</a></li><li><a href="/csharp/exception-handling.html" class="sidebar-link">Exception Handling</a></li><li><a href="/csharp/nullreferenceexception.html" class="sidebar-link">NullReferenceException</a></li><li><a href="/csharp/handling-formatexception-when-converting-string-to-other-types.html" class="sidebar-link">Handling FormatException when converting string to other types</a></li><li><a href="/csharp/read-understand-stacktraces.html" class="sidebar-link">Read &amp; Understand Stacktraces</a></li><li><a href="/csharp/diagnostics.html" class="sidebar-link">Diagnostics</a></li><li><a href="/csharp/overflow.html" class="sidebar-link">Overflow</a></li><li><a href="/csharp/getting-started-json-with-c.html" class="sidebar-link">Getting Started: Json with C#</a></li><li><a href="/csharp/using-json-net.html" class="sidebar-link">Using json.net</a></li><li><a href="/csharp/lambda-expressions.html" class="sidebar-link">Lambda Expressions</a></li><li><a href="/csharp/generic-lambda-query-builder.html" class="sidebar-link">Generic Lambda Query Builder</a></li><li><a href="/csharp/properties.html" class="sidebar-link">Properties</a></li><li><a href="/csharp/initializing-properties.html" class="sidebar-link">Initializing Properties</a></li><li><a href="/csharp/inotifypropertychanged-interface.html" class="sidebar-link">INotifyPropertyChanged interface</a></li><li><a href="/csharp/events.html" class="sidebar-link">Events</a></li><li><a href="/csharp/expression-trees.html" class="sidebar-link">Expression Trees</a></li><li><a href="/csharp/overload-resolution.html" class="sidebar-link">Overload Resolution</a></li><li><a href="/csharp/bindinglist-t.html" class="sidebar-link">BindingList</a></li><li><a href="/csharp/preprocessor-directives.html" class="sidebar-link">Preprocessor directives</a></li><li><a href="/csharp/structs.html" class="sidebar-link">Structs</a></li><li><a href="/csharp/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/csharp/delegates.html" class="sidebar-link">Delegates</a></li><li><a href="/csharp/file-and-stream-i-o.html" class="sidebar-link">File and Stream I/O</a></li><li><a href="/csharp/networking.html" class="sidebar-link">Networking</a></li><li><a href="/csharp/performing-http-requests.html" class="sidebar-link">Performing HTTP requests</a></li><li><a href="/csharp/reading-and-writing-zip-files.html" class="sidebar-link">Reading and writing .zip files</a></li><li><a href="/csharp/filesystemwatcher.html" class="sidebar-link">FileSystemWatcher</a></li><li><a href="/csharp/access-network-shared-folder-with-username-and-password.html" class="sidebar-link">Access network shared folder with username and password</a></li><li><a href="/csharp/asynchronous-socket.html" class="sidebar-link">Asynchronous Socket</a></li><li><a href="/csharp/action-filters.html" class="sidebar-link">Action Filters</a></li><li><a href="/csharp/polymorphism.html" class="sidebar-link">Polymorphism</a></li><li><a href="/csharp/immutability.html" class="sidebar-link">Immutability</a></li><li><a href="/csharp/indexer.html" class="sidebar-link">Indexer</a></li><li><a href="/csharp/checked-and-unchecked.html" class="sidebar-link">Checked and Unchecked</a></li><li><a href="/csharp/stream.html" class="sidebar-link">Stream</a></li><li><a href="/csharp/timers.html" class="sidebar-link">Timers</a></li><li><a href="/csharp/stopwatches.html" class="sidebar-link">Stopwatches</a></li><li><a href="/csharp/threading.html" class="sidebar-link">Threading</a></li><li><a href="/csharp/async-await-backgroundworker-task-and-thread-examples.html" class="sidebar-link">Async/await, Backgroundworker, Task and Thread Examples</a></li><li><a href="/csharp/async-await.html" class="sidebar-link">Async-Await</a></li><li><a href="/csharp/synchronization-context-in-async-await.html" class="sidebar-link">Synchronization Context in Async-Await</a></li><li><a href="/csharp/backgroundworker.html" class="sidebar-link">BackgroundWorker</a></li><li><a href="/csharp/task-parallel-library.html" class="sidebar-link">Task Parallel Library</a></li><li><a href="/csharp/making-a-variable-thread-safe.html" class="sidebar-link">Making a variable thread safe</a></li><li><a href="/csharp/lock-statement.html" class="sidebar-link">Lock Statement</a></li><li><a href="/csharp/yield-keyword.html" class="sidebar-link">Yield Keyword</a></li><li><a href="/csharp/task-parallel-library-tpl-dataflow-constructs.html" class="sidebar-link">Task Parallel Library (TPL) Dataflow Constructs</a></li><li><a href="/csharp/functional-programming.html" class="sidebar-link">Functional Programming</a></li><li><a href="/csharp/func-delegates.html" class="sidebar-link">Func delegates</a></li><li><a href="/csharp/function-with-multiple-return-values.html" class="sidebar-link">Function with multiple return values</a></li><li><a href="/csharp/binary-serialization.html" class="sidebar-link">Binary Serialization</a></li><li><a href="/csharp/icloneable.html" class="sidebar-link">ICloneable</a></li><li><a href="/csharp/icomparable.html" class="sidebar-link">IComparable</a></li><li><a href="/csharp/accessing-databases.html" class="sidebar-link">Accessing Databases</a></li><li><a href="/csharp/using-sqlite-in-c.html" class="sidebar-link">Using SQLite in C#</a></li><li><a href="/csharp/caching.html" class="sidebar-link">Caching</a></li><li><a href="/csharp/code-contracts.html" class="sidebar-link">Code Contracts</a></li><li><a href="/csharp/code-contracts-and-assertions.html" class="sidebar-link">Code Contracts and Assertions</a></li><li><a href="/csharp/structural-design-patterns.html" class="sidebar-link">Structural Design Patterns</a></li><li><a href="/csharp/creational-design-patterns.html" class="sidebar-link">Creational Design Patterns</a></li><li><a href="/csharp/implementing-decorator-design-pattern.html" class="sidebar-link">Implementing Decorator Design Pattern</a></li><li><a href="/csharp/implementing-flyweight-design-pattern.html" class="sidebar-link">Implementing Flyweight Design Pattern</a></li><li><a href="/csharp/system-management-automation.html" class="sidebar-link">System.Management.Automation</a></li><li><a href="/csharp/system-directoryservices-protocols-ldapconnection.html" class="sidebar-link">System.DirectoryServices.Protocols.LdapConnection</a></li><li><a href="/csharp/c-authentication-handler.html" class="sidebar-link">C# Authentication handler</a></li><li><a href="/csharp/pointers.html" class="sidebar-link">Pointers</a></li><li><a href="/csharp/pointers-unsafe-code.html" class="sidebar-link">Pointers &amp; Unsafe Code</a></li><li><a href="/csharp/how-to-use-c-structs-to-create-a-union-type-similar-to-c-unions.html" class="sidebar-link">How to use C# Structs to create a Union type  (Similar to C Unions)</a></li><li><a href="/csharp/reactive-extensions-rx.html" class="sidebar-link">Reactive Extensions (Rx)</a></li><li><a href="/csharp/assemblyinfo-cs-examples.html" class="sidebar-link">AssemblyInfo.cs Examples</a></li><li><a href="/csharp/creating-a-console-application-using-a-plain-text-editor-and-the-c-compiler-csc-exe.html" class="sidebar-link">Creating a Console Application using a Plain-Text Editor and the C# Compiler (csc.exe)</a></li><li><a href="/csharp/clscompliantattribute.html" class="sidebar-link">CLSCompliantAttribute</a></li><li><a href="/csharp/observablecollection-t.html" class="sidebar-link">ObservableCollection</a></li><li><a href="/csharp/hash-functions.html" class="sidebar-link">Hash Functions</a></li><li><a href="/csharp/generating-random-numbers-in-c.html" class="sidebar-link">Generating Random Numbers in C#</a></li><li><a href="/csharp/cryptography-system-security-cryptography.html" class="sidebar-link">Cryptography (System.Security.Cryptography)</a></li><li><a href="/csharp/asp-net-identity.html" class="sidebar-link">ASP.NET Identity</a></li><li><a href="/csharp/unsafe-code-in-net.html" class="sidebar-link">Unsafe Code in .NET</a></li><li><a href="/csharp/c-script.html" class="sidebar-link">C# Script</a></li><li><a href="/csharp/runtime-compile.html" class="sidebar-link">Runtime Compile</a></li><li><a href="/csharp/interoperability.html" class="sidebar-link">Interoperability</a></li><li><a href="/csharp/net-compiler-platform-roslyn.html" class="sidebar-link">.NET Compiler Platform (Roslyn)</a></li><li><a href="/csharp/ilgenerator.html" class="sidebar-link">ILGenerator</a></li><li><a href="/csharp/t4-code-generation.html" class="sidebar-link">T4 Code Generation</a></li><li><a href="/csharp/creating-own-messagebox-in-windows-form-application.html" class="sidebar-link">Creating Own MessageBox in Windows Form Application</a></li><li><a href="/csharp/including-font-resources.html" class="sidebar-link">Including Font Resources</a></li><li><a href="/csharp/import-google-contacts.html" class="sidebar-link">Import Google Contacts</a></li><li><a href="/csharp/garbage-collector-in-net.html" class="sidebar-link">Garbage Collector in .Net</a></li><li><a href="/csharp/microsoft-exchange-webservices.html" class="sidebar-link">Microsoft.Exchange.WebServices</a></li><li><a href="/csharp/windows-communication-foundation.html" class="sidebar-link">Windows Communication Foundation</a></li><li><a href="/csharp/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="linq-queries"><a href="#linq-queries" class="header-anchor">#</a> LINQ Queries</h1> <p>LINQ is an acronym which stands for <strong>L</strong>anguage <strong>IN</strong>tegrated <strong>Q</strong>uery. It is a concept which integrates a query language by offering a consistent model for working with data across various kinds of data sources and formats; you use the same basic coding patterns to query and transform data in XML documents, SQL databases, ADO.NET Datasets, .NET collections, and any other format for which a LINQ provider is available.</p> <h2 id="chaining-methods"><a href="#chaining-methods" class="header-anchor">#</a> Chaining methods</h2> <p><a href="https://msdn.microsoft.com/en-us/library/system.linq.enumerable(v=vs.110).aspx" target="_blank" rel="noopener noreferrer">Many LINQ functions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> both operate on an <code>IEnumerable&lt;TSource&gt;</code> and also return an <code>IEnumerable&lt;TResult&gt;</code>. The type parameters <code>TSource</code> and <code>TResult</code> may or may not refer to the same type, depending on the method in question and any functions passed to it.</p> <p>A few examples of this are</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>TResult<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">Select</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span> TResult<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token keyword">this</span> <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span> source<span class="token punctuation">,</span>
    <span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span> TResult<span class="token punctuation">&gt;</span></span> selector
<span class="token punctuation">)</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">Where</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token keyword">this</span> <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span> source<span class="token punctuation">,</span>
    <span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> predicate
<span class="token punctuation">)</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IOrderedEnumerable<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">OrderBy</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span> TKey<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token keyword">this</span> <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span> source<span class="token punctuation">,</span>
    <span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span> TKey<span class="token punctuation">&gt;</span></span> keySelector
<span class="token punctuation">)</span>

</code></pre></div><p>While some method chaining may require an entire set to be worked prior to moving on, LINQ takes advantage of <a href="http://stackoverflow.com/documentation/c%23/68/linq-queries/8001/deferred-execution" target="_blank" rel="noopener noreferrer">deferred execution<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> by using <a href="https://blogs.msdn.microsoft.com/oldnewthing/20080812-00/?p=21273/" target="_blank" rel="noopener noreferrer">yield return <sup><strong>MSDN</strong></sup><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> which creates an Enumerable and an Enumerator behind the scenes. The process of chaining in LINQ is essentially building an enumerable (iterator) for the original set -- which is deferred -- until materialized by <a href="http://stackoverflow.com/documentation/c%23/68/linq-queries/17356/enumerating-the-enumerable" target="_blank" rel="noopener noreferrer">enumerating the enumerable<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>This allows these functions to be <a href="https://en.wikipedia.org/wiki/Fluent_interface" target="_blank" rel="noopener noreferrer">fluently chained <sup><strong>wiki</strong></sup><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, where one function can act directly on the result of another. This style of code can be used to perform many sequence based operations in a single statement.</p> <p>For example, it's possible to combine <code>Select</code>, <code>Where</code> and <code>OrderBy</code> to transform, filter and sort a sequence in a single statement.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> someNumbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> processed <span class="token operator">=</span> someNumbers
        <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>n <span class="token operator">=&gt;</span> n <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment">// Multiply each number by 2</span>
        <span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>n <span class="token operator">=&gt;</span> n <span class="token operator">!=</span> <span class="token number">6</span><span class="token punctuation">)</span>   <span class="token comment">// Keep all the results, except for 6</span>
        <span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>n <span class="token operator">=&gt;</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Sort in ascending order</span>

</code></pre></div><p><strong>Output:</strong></p> <blockquote></blockquote> <p>2<br>
4<br>
8</p> <p><a href="https://dotnetfiddle.net/3Gta8X" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Any functions that both extend and return the generic <code>IEnumerable&lt;T&gt;</code> type can be used as chained clauses in a single statement. This style of fluent programming is powerful, and should be considered when creating your own <a href="http://stackoverflow.com/documentation/c%23/20/extension-methods#t=201607220826369208865" target="_blank" rel="noopener noreferrer">extension methods<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="first-firstordefault-last-lastordefault-single-and-singleordefault"><a href="#first-firstordefault-last-lastordefault-single-and-singleordefault" class="header-anchor">#</a> First, FirstOrDefault, Last, LastOrDefault, Single, and SingleOrDefault</h2> <p>All six methods return a single value of the sequence type, and can be called with or without a predicate.</p> <p>Depending on the number of elements that match the <code>predicate</code> or, if no <code>predicate</code> is supplied, the number of elements in the source sequence, they behave as follows:</p> <h3 id="first"><a href="#first" class="header-anchor">#</a> First()</h3> <ul><li>Returns the first element of a sequence, or the first element matching the provided <code>predicate</code>.</li> <li>If the sequence contains no elements, an <code>InvalidOperationException</code> is thrown with the message: &quot;Sequence contains no elements&quot;.</li> <li>If the sequence contains no elements matching the provided <code>predicate</code>, an <code>InvalidOperationException</code> is thrown with the message &quot;Sequence contains no matching element&quot;.</li></ul> <p><strong>Example</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Returns &quot;a&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;a&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;b&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;ba&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;ba&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;be&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws InvalidOperationException:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;ca&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ce&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws InvalidOperationException:</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><a href="https://dotnetfiddle.net/ESYLcU" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="firstordefault"><a href="#firstordefault" class="header-anchor">#</a> FirstOrDefault()</h3> <ul><li>Returns the first element of a sequence, or the first element matching the provided <code>predicate</code>.</li> <li>If the sequence contains no elements, or no elements matching the provided <code>predicate</code>, returns the default value of the sequence type using <a href="http://stackoverflow.com/documentation/c%23/26/keywords/109/default#t=201702071640321629621" target="_blank" rel="noopener noreferrer"><code>default(T)</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li></ul> <p><strong>Example</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Returns &quot;a&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;a&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;b&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;ba&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;ba&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;be&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns null:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;ca&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ce&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns null:</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><a href="https://dotnetfiddle.net/XJ93lr" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="last"><a href="#last" class="header-anchor">#</a> Last()</h3> <ul><li>Returns the last element of a sequence, or the last element matching the provided <code>predicate</code>.</li> <li>If the sequence contains no elements, an <code>InvalidOperationException</code> is thrown with the message &quot;Sequence contains no elements.&quot;</li> <li>If the sequence contains no elements matching the provided <code>predicate</code>, an <code>InvalidOperationException</code> is thrown with the message &quot;Sequence contains no matching element&quot;.</li></ul> <p><strong>Example</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Returns &quot;a&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;b&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;a&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Last</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;be&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;ba&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;be&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Last</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws InvalidOperationException:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;ca&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ce&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Last</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws InvalidOperationException:</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">Last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

</code></pre></div><h3 id="lastordefault"><a href="#lastordefault" class="header-anchor">#</a> LastOrDefault()</h3> <ul><li>Returns the last element of a sequence, or the last element matching the provided <code>predicate</code>.</li> <li>If the sequence contains no elements, or no elements matching the provided <code>predicate</code>, returns the default value of the sequence type using <code>default(T)</code>.</li></ul> <p><strong>Example</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Returns &quot;a&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">LastOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;b&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">LastOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;a&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">LastOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment">// Returns &quot;be&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;ba&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;be&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">LastOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns null:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;ca&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ce&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">LastOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// Returns null:</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">LastOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="single"><a href="#single" class="header-anchor">#</a> Single()</h3> <ul><li>If the sequence contains exactly one element, or exactly one element matching the provided <code>predicate</code>, that element is returned.</li> <li>If the sequence contains no elements, or no elements matching the provided <code>predicate</code>, an <code>InvalidOperationException</code> is thrown with the message &quot;Sequence contains no elements&quot;.</li> <li>If the sequence contains more than one element, or more than one element matching the provided <code>predicate</code>, an <code>InvalidOperationException</code> is thrown with the message &quot;Sequence contains more than one element&quot;.</li> <li><strong>Note:</strong> in order to evaluate whether the sequence contains exactly one element, at most two elements has to be enumerated.</li></ul> <p><strong>Example</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Returns &quot;a&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Single</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws InvalidOperationException because sequence contains more than one element:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Single</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns &quot;b&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Single</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws InvalidOperationException:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Single</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws InvalidOperationException:</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">Single</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// Throws InvalidOperationException because sequence contains more than one element:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Single</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="singleordefault"><a href="#singleordefault" class="header-anchor">#</a> SingleOrDefault()</h3> <ul><li>If the sequence contains exactly one element, or exactly one element matching the provided <code>predicate</code>, that element is returned.</li> <li>If the sequence contains no elements, or no elements matching the provided <code>predicate</code>, <code>default(T)</code> is returned.</li> <li>If the sequence contains more than one element, or more than one element matching the provided <code>predicate</code>, an <code>InvalidOperationException</code> is thrown with the message &quot;Sequence contains more than one element&quot;.</li> <li>If the sequence contains no elements matching the provided <code>predicate</code>, returns the default value of the sequence type using <code>default(T)</code>.</li> <li><strong>Note:</strong> in order to evaluate whether the sequence contains exactly one element, at most two elements has to be enumerated.</li></ul> <p><strong>Example</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Returns &quot;a&quot;:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// returns &quot;a&quot;</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token operator">==</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// Returns null:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token operator">==</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws InvalidOperationException:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token operator">==</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws InvalidOperationException:</span>
<span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns null:</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="recommendations"><a href="#recommendations" class="header-anchor">#</a> Recommendations</h3> <li>
Although you can use `FirstOrDefault`, `LastOrDefault` or `SingleOrDefault` to check whether a sequence contains any items, `Any` or `Count` are more reliable. This is because a return value of `default(T)` from one of these three methods doesn't prove that the sequence is empty, as the value of the first / last / single element of the sequence could equally be `default(T)`
</li> <li>
Decide on which methods fits your code's purpose the most. For instance, use `Single` only if you must ensure that there is a single item in the collection matching your predicate  otherwise use `First`; as `Single` throw an exception if the sequence has more than one matching element. This of course applies to the &quot;*OrDefault&quot;-counterparts as well.
</li> <li>
Regarding efficiency: Although it's often appropriate to ensure that there is only one item (`Single`) or, either only one or zero (`SingleOrDefault`) items, returned by a query, both of these methods require more, and often the entirety, of the collection to be examined to ensure there in no second match to the query. This is unlike the behavior of, for example, the `First` method, which can be satisfied after finding the first match.
</li> <h2 id="except"><a href="#except" class="header-anchor">#</a> Except</h2> <p>The Except method returns the set of items which are contained in the first collection but are not contained in the second. The default <a href="https://msdn.microsoft.com/en-us/library/ms132151(v=vs.110).aspx" target="_blank" rel="noopener noreferrer"><code>IEqualityComparer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is used to compare the items within the two sets. There is an overload which accepts an <a href="https://msdn.microsoft.com/en-us/library/ms132151(v=vs.110).aspx" target="_blank" rel="noopener noreferrer"><code>IEqualityComparer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> as an argument.</p> <p><strong>Example:</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> first <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> second <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> inFirstButNotInSecond <span class="token operator">=</span> first<span class="token punctuation">.</span><span class="token function">Except</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// inFirstButNotInSecond = { 1, 4 }</span>

</code></pre></div><p><strong>Output:</strong></p> <blockquote></blockquote> <p>1<br>
4</p> <p><a href="https://dotnetfiddle.net/m3EqTQ" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>In this case <code>.Except(second)</code> excludes elements contained in the array <code>second</code>, namely 2 and 3 (0 and 5 are not contained in the <code>first</code> array and are skipped).</p> <p>Note that <code>Except</code> implies <code>Distinct</code> (i.e., it removes repeated elements). For example:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> third <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> inThirdButNotInSecond <span class="token operator">=</span> third<span class="token punctuation">.</span><span class="token function">Except</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// inThirdButNotInSecond = { 1, 4 }</span>

</code></pre></div><p><strong>Output:</strong></p> <blockquote></blockquote> <p>1<br>
4</p> <p><a href="https://dotnetfiddle.net/VlXBUp" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>In this case, the elements 1 and 4 are returned only once.</p> <p>Implementing <a href="https://msdn.microsoft.com/en-us/library/ms131187(v=vs.110).aspx" target="_blank" rel="noopener noreferrer"><code>IEquatable</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or providing the function an <a href="https://msdn.microsoft.com/en-us/library/ms132151(v=vs.110).aspx" target="_blank" rel="noopener noreferrer"><code>IEqualityComparer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> will allow using a different method to compare the elements.
Note that the <a href="https://msdn.microsoft.com/en-us/library/system.object.gethashcode(v=vs.110).aspx" target="_blank" rel="noopener noreferrer"><code>GetHashCode</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> method should also be overridden so that it will return an identical hash code for <code>object</code> that are identical according to the <a href="https://msdn.microsoft.com/en-us/library/ms131187(v=vs.110).aspx" target="_blank" rel="noopener noreferrer"><code>IEquatable</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> implementation.</p> <p><strong><strong>Example With IEquatable:</strong></strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">Holiday</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IEquatable<span class="token punctuation">&lt;</span>Holiday<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Equals</span><span class="token punctuation">(</span><span class="token class-name">Holiday</span> other<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Name <span class="token operator">==</span> other<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// GetHashCode must return true whenever Equals returns true.</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">GetHashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//Get hash code for the Name field if it is not null.</span>
        <span class="token keyword">return</span> Name<span class="token punctuation">?.</span><span class="token function">GetHashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">List<span class="token punctuation">&lt;</span>Holiday<span class="token punctuation">&gt;</span></span> holidayDifference <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Holiday<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List<span class="token punctuation">&lt;</span>Holiday<span class="token punctuation">&gt;</span></span> remoteHolidays <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Holiday<span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Holiday</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Xmas&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Holiday</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Hanukkah&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Holiday</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Ramadan&quot;</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token class-name">List<span class="token punctuation">&lt;</span>Holiday<span class="token punctuation">&gt;</span></span> localHolidays <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Holiday<span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Holiday</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Xmas&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Holiday</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Ramadan&quot;</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        holidayDifference <span class="token operator">=</span> remoteHolidays
            <span class="token punctuation">.</span><span class="token function">Except</span><span class="token punctuation">(</span>localHolidays<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        holidayDifference<span class="token punctuation">.</span><span class="token function">ForEach</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Output:</p> <blockquote></blockquote> <p>Hanukkah</p> <p><a href="https://dotnetfiddle.net/9ilGqy" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="selectmany"><a href="#selectmany" class="header-anchor">#</a> SelectMany</h2> <p>The SelectMany linq method 'flattens' an <code>IEnumerable&lt;IEnumerable&lt;T&gt;&gt;</code> into an <code>IEnumerable&lt;T&gt;</code>. All of the T elements within the <code>IEnumerable</code> instances contained in the source <code>IEnumerable</code> will be combined into a single <code>IEnumerable</code>.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> words <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;a,b,c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;d,e&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;f&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> splitAndCombine <span class="token operator">=</span> words<span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token string character">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// returns { &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot; }</span>

</code></pre></div><p>If you use a selector function which turns input elements into sequences, the result will be the elements of those sequences returned one by one.</p> <p>Note that, unlike <code>Select()</code>, the number of elements in the output doesn't need to be the same as were in the input.</p> <p><strong>More real-world example</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">School</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">Student<span class="token punctuation">[</span><span class="token punctuation">]</span></span> Students <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Student</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>    
  
<span class="token class-name"><span class="token keyword">var</span></span> schools <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">School</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Students <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name<span class="token operator">=</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name<span class="token operator">=</span><span class="token string">&quot;Jack&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">School</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Students <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name<span class="token operator">=</span><span class="token string">&quot;Jim&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name<span class="token operator">=</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
               
<span class="token class-name"><span class="token keyword">var</span></span> allStudents <span class="token operator">=</span> schools<span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>Students<span class="token punctuation">)</span><span class="token punctuation">;</span>
             
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> student <span class="token keyword">in</span> allStudents<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Output:</p> <blockquote></blockquote> <p>Bob<br>
Jack<br>
Jim<br>
John</p> <p><a href="https://dotnetfiddle.net/LNyymI" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="any"><a href="#any" class="header-anchor">#</a> Any</h2> <p><code>Any</code> is used to check if <strong>any</strong> element of a collection matches a condition or not.
<br><strong>see also: <a href="https://stackoverflow.com/documentation/c%23/68/linq-queries/2773/all#t=201707041340119289445" target="_blank" rel="noopener noreferrer">.All<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://stackoverflow.com/documentation/c%23/68/linq-queries/16731/any-and-firstordefault-best-practice#t=201707041441456087738" target="_blank" rel="noopener noreferrer">Any and FirstOrDefault: best practice<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <h3 id="_1-empty-parameter"><a href="#_1-empty-parameter" class="header-anchor">#</a> 1. Empty parameter</h3> <p><strong>Any</strong>: Returns <code>true</code> if the collection has any elements and <code>false</code> if the collection is empty:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">bool</span></span> result <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token class-name"><span class="token keyword">var</span></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">bool</span></span> result <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>

</code></pre></div><h3 id="_2-lambda-expression-as-parameter"><a href="#_2-lambda-expression-as-parameter" class="header-anchor">#</a> 2. Lambda expression as parameter</h3> <p><strong>Any</strong>: Returns <code>true</code> if the collection has one or more elements that meet the condition in the lambda expression:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> arrayOfStrings <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
arrayOfStrings<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item <span class="token operator">==</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// true</span>
arrayOfStrings<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item <span class="token operator">==</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// false</span>

</code></pre></div><h3 id="_3-empty-collection"><a href="#_3-empty-collection" class="header-anchor">#</a> 3. Empty collection</h3> <p><strong>Any</strong>: Returns <code>false</code> if the collection is empty and a lambda expression is supplied:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">bool</span></span> result <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

</code></pre></div><p><strong>Note:</strong> <code>Any</code> will stop iteration of the collection as soon as it finds an element matching the condition. This means that the collection will not necessarily be fully enumerated; it will only be enumerated far enough to find the first item matching the condition.</p> <p><a href="https://dotnetfiddle.net/IQ4wG4" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="joins"><a href="#joins" class="header-anchor">#</a> JOINS</h2> <p>Joins are used to combine different lists or tables holding data via a common key.</p> <p>Like in SQL, the following kinds of Joins are supported in LINQ: <br> <strong>Inner, Left, Right, Cross</strong> and <strong>Full Outer</strong> Joins.</p> <p>The following two lists are used in the examples below:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> first <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// Left data</span>
<span class="token class-name"><span class="token keyword">var</span></span> second <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// Right data</span>

</code></pre></div><h3 id="inner-join"><a href="#inner-join" class="header-anchor">#</a> (Inner) Join</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> <span class="token keyword">from</span> f <span class="token keyword">in</span> first
             <span class="token keyword">join</span> s <span class="token keyword">in</span> second <span class="token keyword">on</span> f equals s
             <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> f<span class="token punctuation">,</span> s <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> first<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>second<span class="token punctuation">,</span> 
                        f <span class="token operator">=&gt;</span> f<span class="token punctuation">,</span> 
                        s <span class="token operator">=&gt;</span> s<span class="token punctuation">,</span>
                        <span class="token punctuation">(</span>f<span class="token punctuation">,</span> s<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> f<span class="token punctuation">,</span> s <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Result: {&quot;a&quot;,&quot;a&quot;}</span>
<span class="token comment">//         {&quot;c&quot;,&quot;c&quot;}</span>

</code></pre></div><h3 id="left-outer-join"><a href="#left-outer-join" class="header-anchor">#</a> Left outer join</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> leftOuterJoin <span class="token operator">=</span> <span class="token keyword">from</span> f <span class="token keyword">in</span> first
                    <span class="token keyword">join</span> s <span class="token keyword">in</span> second <span class="token keyword">on</span> f equals s <span class="token keyword">into</span> temp
                    <span class="token keyword">from</span> t <span class="token keyword">in</span> temp<span class="token punctuation">.</span><span class="token function">DefaultIfEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> First <span class="token operator">=</span> f<span class="token punctuation">,</span> Second <span class="token operator">=</span> t<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Or can also do:</span>
<span class="token class-name"><span class="token keyword">var</span></span> leftOuterJoin <span class="token operator">=</span> <span class="token keyword">from</span> f <span class="token keyword">in</span> first
                    <span class="token keyword">from</span> s <span class="token keyword">in</span> second<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token operator">==</span> f<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">DefaultIfEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> First <span class="token operator">=</span> f<span class="token punctuation">,</span> Second <span class="token operator">=</span> s<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Result: {&quot;a&quot;,&quot;a&quot;}</span>
<span class="token comment">//         {&quot;b&quot;, null}  </span>
<span class="token comment">//         {&quot;c&quot;,&quot;c&quot;}  </span>


<span class="token comment">// Left outer join method syntax</span>
<span class="token class-name"><span class="token keyword">var</span></span> leftOuterJoinFluentSyntax <span class="token operator">=</span> first<span class="token punctuation">.</span><span class="token function">GroupJoin</span><span class="token punctuation">(</span>second<span class="token punctuation">,</span>
                                      f <span class="token operator">=&gt;</span> f<span class="token punctuation">,</span>
                                      s <span class="token operator">=&gt;</span> s<span class="token punctuation">,</span>
                                      <span class="token punctuation">(</span>f<span class="token punctuation">,</span> s<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> First <span class="token operator">=</span> f<span class="token punctuation">,</span> Second <span class="token operator">=</span> s <span class="token punctuation">}</span><span class="token punctuation">)</span>
                                   <span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>temp <span class="token operator">=&gt;</span> temp<span class="token punctuation">.</span>Second<span class="token punctuation">.</span><span class="token function">DefaultIfEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                      <span class="token punctuation">(</span>f<span class="token punctuation">,</span> s<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> First <span class="token operator">=</span> f<span class="token punctuation">.</span>First<span class="token punctuation">,</span> Second <span class="token operator">=</span> s <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="right-outer-join"><a href="#right-outer-join" class="header-anchor">#</a> Right Outer Join</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> rightOuterJoin <span class="token operator">=</span> <span class="token keyword">from</span> s <span class="token keyword">in</span> second
                     <span class="token keyword">join</span> f <span class="token keyword">in</span> first <span class="token keyword">on</span> s equals f <span class="token keyword">into</span> temp
                     <span class="token keyword">from</span> t <span class="token keyword">in</span> temp<span class="token punctuation">.</span><span class="token function">DefaultIfEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                     <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span>First<span class="token operator">=</span>t<span class="token punctuation">,</span>Second<span class="token operator">=</span>s<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Result: {&quot;a&quot;,&quot;a&quot;}</span>
<span class="token comment">//         {&quot;c&quot;,&quot;c&quot;}  </span>
<span class="token comment">//         {null,&quot;d&quot;}  </span>

</code></pre></div><h3 id="cross-join"><a href="#cross-join" class="header-anchor">#</a> Cross Join</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> CrossJoin <span class="token operator">=</span> <span class="token keyword">from</span> f <span class="token keyword">in</span> first
                <span class="token keyword">from</span> s <span class="token keyword">in</span> second
                <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> f<span class="token punctuation">,</span> s <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Result: {&quot;a&quot;,&quot;a&quot;}</span>
<span class="token comment">//         {&quot;a&quot;,&quot;c&quot;}  </span>
<span class="token comment">//         {&quot;a&quot;,&quot;d&quot;}  </span>
<span class="token comment">//         {&quot;b&quot;,&quot;a&quot;}</span>
<span class="token comment">//         {&quot;b&quot;,&quot;c&quot;}  </span>
<span class="token comment">//         {&quot;b&quot;,&quot;d&quot;}  </span>
<span class="token comment">//         {&quot;c&quot;,&quot;a&quot;}</span>
<span class="token comment">//         {&quot;c&quot;,&quot;c&quot;}  </span>
<span class="token comment">//         {&quot;c&quot;,&quot;d&quot;}</span>

</code></pre></div><h3 id="full-outer-join"><a href="#full-outer-join" class="header-anchor">#</a> Full Outer Join</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> fullOuterjoin <span class="token operator">=</span> leftOuterJoin<span class="token punctuation">.</span><span class="token function">Union</span><span class="token punctuation">(</span>rightOuterJoin<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Result: {&quot;a&quot;,&quot;a&quot;}</span>
<span class="token comment">//         {&quot;b&quot;, null}  </span>
<span class="token comment">//         {&quot;c&quot;,&quot;c&quot;}  </span>
<span class="token comment">//         {null,&quot;d&quot;}</span>

</code></pre></div><h3 id="practical-example"><a href="#practical-example" class="header-anchor">#</a> <strong>Practical example</strong></h3> <p>The examples above have a simple data structure so you can focus on understanding the different LINQ joins technically, but in the real world you would have tables with columns you need to join.</p> <p>In the following example, there is just one class <code>Region</code> used, in reality you would join two or more different tables which hold the same key (in this example <code>first</code> and <code>second</code> are joined via the common key <code>ID</code>).</p> <p><strong>Example:</strong> Consider the following data structure:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Region</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Int32</span> ID<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">string</span></span> RegionDescription<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token function">Region</span><span class="token punctuation">(</span><span class="token class-name">Int32</span> pRegionID<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> pRegionDescription<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ID <span class="token operator">=</span> pRegionID<span class="token punctuation">;</span> RegionDescription <span class="token operator">=</span> pRegionDescription<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Now prepare the data (i.e. populate with data):</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Left data</span>
<span class="token class-name"><span class="token keyword">var</span></span> first <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Region<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
                 <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Region</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Region</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Region</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token comment">// Right data</span>
<span class="token class-name"><span class="token keyword">var</span></span> second <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Region<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
                 <span class="token punctuation">{</span> 
                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Region</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;Eastern&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Region</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;Western&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Region</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;Northern&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Region</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;Southern&quot;</span><span class="token punctuation">)</span>
                 <span class="token punctuation">}</span><span class="token punctuation">;</span> 

</code></pre></div><p>You can see that in this example <code>first</code> doesn't contain any region descriptions so you want to join them from <code>second</code>. Then the inner join would look like:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// do the inner join</span>
<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> <span class="token keyword">from</span> f <span class="token keyword">in</span> first
             <span class="token keyword">join</span> s <span class="token keyword">in</span> second <span class="token keyword">on</span> f<span class="token punctuation">.</span>ID equals s<span class="token punctuation">.</span>ID
             <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> f<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> s<span class="token punctuation">.</span>RegionDescription <span class="token punctuation">}</span><span class="token punctuation">;</span>


 <span class="token comment">// Result: {1,&quot;Eastern&quot;}</span>
 <span class="token comment">//         {3, Northern}  </span>
 <span class="token comment">//         {4,&quot;Southern&quot;}  </span>

</code></pre></div><p>This result has created anonymous objects on the fly, which is fine, but we have already created a proper class - so we can specify it: Instead of  <code>select new { f.ID, s.RegionDescription };</code> we can say <code>select new Region(f.ID, s.RegionDescription);</code>, which will return the same data but will create objects of type <code>Region</code> - that will maintain compatibility with the other objects.</p> <p><a href="https://dotnetfiddle.net/pP6enP" target="_blank" rel="noopener noreferrer">Live demo on .NET fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="skip-and-take"><a href="#skip-and-take" class="header-anchor">#</a> Skip and Take</h2> <p>The Skip method returns a collection excluding a number of items from the beginning of the source collection. The number of items excluded is the number given as an argument. If there are less items in the collection than specified in the argument then an empty collection is returned.</p> <p>The Take method returns a collection containing a number of elements from the beginning of the source collection. The number of items included is the number given as an argument. If there are less items in the collection than specified in the argument then the collection returned will contain the same elements as the source collection.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> skipTwo        <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">Skip</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// { 3, 2, 1 }</span>
<span class="token class-name"><span class="token keyword">var</span></span> takeThree      <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// { 5, 4, 3 }</span>
<span class="token class-name"><span class="token keyword">var</span></span> skipOneTakeTwo <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">Skip</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { 4, 3 }</span>
<span class="token class-name"><span class="token keyword">var</span></span> takeZero       <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// An IEnumerable&lt;int&gt; with 0 items</span>

</code></pre></div><p><a href="https://dotnetfiddle.net/U2b76y" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>Skip and Take</strong> are commonly used together to paginate results, for instance:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">GetPage</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> collection<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> pageNumber<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> resultsPerPage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">int</span></span> startIndex <span class="token operator">=</span> <span class="token punctuation">(</span>pageNumber <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> resultsPerPage<span class="token punctuation">;</span>
    <span class="token keyword">return</span> collection<span class="token punctuation">.</span><span class="token function">Skip</span><span class="token punctuation">(</span>startIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span>resultsPerPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><blockquote></blockquote> <p><strong>Warning:</strong> LINQ to Entities only supports Skip on <a href="http://stackoverflow.com/documentation/c%23/68/linq-queries/4389/query-ordering#t=201607261110520529272" target="_blank" rel="noopener noreferrer">ordered queries<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. If you try to use Skip without ordering you will get a <strong>NotSupportedException</strong> with the message &quot;The method 'Skip' is only supported for sorted input in LINQ to Entities. The method 'OrderBy' must be called before the method 'Skip'.&quot;</p> <h2 id="defining-a-variable-inside-a-linq-query-let-keyword"><a href="#defining-a-variable-inside-a-linq-query-let-keyword" class="header-anchor">#</a> Defining a variable inside a Linq query (let keyword)</h2> <p>In order to define a variable inside a linq expression, you can use the <strong>let</strong> keyword. This is usually done in order to store the results of intermediate sub-queries, for example:</p> <div class="language- extra-class"><pre class="language-text"><code>
int[] numbers = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };

 var aboveAverages = from number in numbers
                     let average = numbers.Average()
                     let nSquared = Math.Pow(number,2)
                     where nSquared &gt; average
                     select number;

 Console.WriteLine(&quot;The average of the numbers is {0}.&quot;, numbers.Average());

 foreach (int n in aboveAverages)
 {
   Console.WriteLine(&quot;Query result includes number {0} with square of {1}.&quot;, n, Math.Pow(n,2));
 }

</code></pre></div><p><strong>Output:</strong></p> <blockquote></blockquote> <p>The average of the numbers is 4.5.<br>
Query result includes number 3 with square of 9.<br>
Query result includes number 4 with square of 16.<br>
Query result includes number 5 with square of 25.<br>
Query result includes number 6 with square of 36.<br>
Query result includes number 7 with square of 49.<br>
Query result includes number 8 with square of 64.<br>
Query result includes number 9 with square of 81.</p> <p><a href="https://dotnetfiddle.net/zbjrHZ" target="_blank" rel="noopener noreferrer">View Demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="zip"><a href="#zip" class="header-anchor">#</a> Zip</h2> <p>The <code>Zip</code> extension method acts upon two collections. It pairs each element in the two series together based on position. With a <code>Func</code> instance, we use <code>Zip</code> to handle elements from the two C# collections in pairs. If the series differ in size, the extra elements of the larger series will be ignored.</p> <p>To take an example from the book &quot;C# in a Nutshell&quot;,</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> words <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;five&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;seven&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ignored&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> zip <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Zip</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> w<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> n <span class="token operator">+</span> <span class="token string">&quot;=&quot;</span> <span class="token operator">+</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Output:</strong></p> <blockquote></blockquote> <p>3=three<br>
5=five<br>
7=seven</p> <p><a href="https://dotnetfiddle.net/nIA5E9" target="_blank" rel="noopener noreferrer">View Demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="range-and-repeat"><a href="#range-and-repeat" class="header-anchor">#</a> Range and Repeat</h2> <p>The <code>Range</code> and <code>Repeat</code> static methods on <code>Enumerable</code> can be used to generate simple sequences.</p> <h3 id="range"><a href="#range" class="header-anchor">#</a> <strong>Range</strong></h3> <p><code>Enumerable.Range()</code> generates a sequence of integers given a starting value and a count.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Generate a collection containing the numbers 1-100 ([1, 2, 3, ..., 98, 99, 100])</span>
<span class="token class-name"><span class="token keyword">var</span></span> range <span class="token operator">=</span> Enumerable<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><a href="https://dotnetfiddle.net/jA0VB1" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="repeat"><a href="#repeat" class="header-anchor">#</a> <strong>Repeat</strong></h3> <p><code>Enumerable.Repeat()</code> generates a sequence of repeating elements given an element and the number of repetitions required.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Generate a collection containing &quot;a&quot;, three times ([&quot;a&quot;,&quot;a&quot;,&quot;a&quot;])</span>
<span class="token class-name"><span class="token keyword">var</span></span> repeatedValues <span class="token operator">=</span> Enumerable<span class="token punctuation">.</span><span class="token function">Repeat</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><a href="https://dotnetfiddle.net/KpZfpt" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="all"><a href="#all" class="header-anchor">#</a> All</h2> <p><code>All</code> is used to check, if all elements of a collection match a condition or not.
<br><strong>see also: <a href="https://stackoverflow.com/documentation/c%23/68/linq-queries/5098/any#t=201707041342119744775" target="_blank" rel="noopener noreferrer">.Any<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <h3 id="_1-empty-parameter-2"><a href="#_1-empty-parameter-2" class="header-anchor">#</a> 1. Empty parameter</h3> <p><strong>All</strong>: is not allowed to be used with empty parameter.</p> <h3 id="_2-lambda-expression-as-parameter-2"><a href="#_2-lambda-expression-as-parameter-2" class="header-anchor">#</a> 2. Lambda expression as parameter</h3> <p><strong>All</strong>: Returns <code>true</code> if all elements of collection satisfies the lambda expression and <code>false</code> otherwise:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">bool</span></span> result <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token class-name"><span class="token keyword">bool</span></span> result <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

</code></pre></div><h3 id="_3-empty-collection-2"><a href="#_3-empty-collection-2" class="header-anchor">#</a> 3. Empty collection</h3> <p><strong>All</strong>: Returns <code>true</code>  if the collection is empty and a lambda expression is supplied:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">bool</span></span> result <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

</code></pre></div><p><strong>Note:</strong> <code>All</code> will stop iteration of the collection as soon as it finds an element <strong>not</strong> matching the condition. This means that the collection will not necessarily be fully enumerated; it will only be enumerated far enough to find the first item <strong>not matching</strong> the condition.</p> <h2 id="basics"><a href="#basics" class="header-anchor">#</a> Basics</h2> <p>LINQ is largely beneficial for querying collections (or arrays).</p> <p>For example, given the following sample data:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> classroom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Classroom</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Alice&quot;</span><span class="token punctuation">,</span> Grade <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> HasSnack <span class="token operator">=</span> <span class="token boolean">true</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span>   Grade <span class="token operator">=</span> <span class="token number">82</span><span class="token punctuation">,</span> HasSnack <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Jimmy&quot;</span><span class="token punctuation">,</span> Grade <span class="token operator">=</span> <span class="token number">71</span><span class="token punctuation">,</span> HasSnack <span class="token operator">=</span> <span class="token boolean">true</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Greg&quot;</span><span class="token punctuation">,</span>  Grade <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">,</span> HasSnack <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Joe&quot;</span><span class="token punctuation">,</span>   Grade <span class="token operator">=</span> <span class="token number">59</span><span class="token punctuation">,</span> HasSnack <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>We can &quot;query&quot; on this data using LINQ syntax. For example, to retrieve all students who have a snack today:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> studentsWithSnacks <span class="token operator">=</span> <span class="token keyword">from</span> s <span class="token keyword">in</span> classroom<span class="token punctuation">.</span>Students
                         <span class="token keyword">where</span> <span class="token class-name">s</span><span class="token punctuation">.</span>HasSnack
                         <span class="token keyword">select</span> s<span class="token punctuation">;</span>

</code></pre></div><p>Or, to retrieve students with a grade of 90 or above, and only return their names, not the full <code>Student</code> object:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> topStudentNames <span class="token operator">=</span> <span class="token keyword">from</span> s <span class="token keyword">in</span> classroom<span class="token punctuation">.</span>Students
                      <span class="token keyword">where</span> <span class="token class-name">s</span><span class="token punctuation">.</span>Grade <span class="token operator">&gt;=</span> <span class="token number">90</span>
                      <span class="token keyword">select</span> s<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>

</code></pre></div><p>The LINQ feature is comprised of two syntaxes that perform the same functions, have nearly identical performance, but are written very differently. The syntax in the example above is called <strong>query syntax</strong>. The following example, however, illustrates <strong>method syntax</strong>. The same data will be returned as in the example above, but the way the query is written is different.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> topStudentNames <span class="token operator">=</span> classroom<span class="token punctuation">.</span>Students
                               <span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>s <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>Grade <span class="token operator">&gt;=</span> <span class="token number">90</span><span class="token punctuation">)</span>
                               <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>s <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="aggregate"><a href="#aggregate" class="header-anchor">#</a> Aggregate</h2> <p><code>Aggregate</code> Applies an accumulator function over a sequence.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> intList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">int</span></span> sum <span class="token operator">=</span> intList<span class="token punctuation">.</span><span class="token function">Aggregate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prevSum<span class="token punctuation">,</span> current<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> prevSum <span class="token operator">+</span> current<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// sum = 55</span>

</code></pre></div><ul><li>At the first step <code>prevSum = 1</code></li> <li>At the second <code>prevSum = prevSum(at the first step) + 2</code></li> <li>At the i-th step <code>prevSum = prevSum(at the (i-1) step) + i-th element of the array</code></li></ul> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> stringList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;!&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">string</span></span> joinedString <span class="token operator">=</span> stringList<span class="token punctuation">.</span><span class="token function">Aggregate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> current<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> prev <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> current<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// joinedString = &quot;Hello World !&quot;</span>

</code></pre></div><p>A second overload of <code>Aggregate</code> also receives an <code>seed</code> parameter which is the initial accumulator value. This can be used to calculate multiple conditions on a collection without iterating it more than once.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> items <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>For the collection of <code>items</code> we want to calculate</p> <ol><li>The total <code>.Count</code></li> <li>The amount of even numbers</li> <li>Collect each forth item</li></ol> <p>Using <code>Aggregate</code> it can be done like this:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">Aggregate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token punctuation">{</span> Total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> Even <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> FourthItems <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span>accumelative<span class="token punctuation">,</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                <span class="token keyword">new</span> <span class="token punctuation">{</span>
                    Total <span class="token operator">=</span> accumelative<span class="token punctuation">.</span>Total <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    Even <span class="token operator">=</span> accumelative<span class="token punctuation">.</span>Even <span class="token operator">+</span> <span class="token punctuation">(</span>item <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    FourthItems <span class="token operator">=</span> <span class="token punctuation">(</span>accumelative<span class="token punctuation">.</span>Total <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">?</span> 
                        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>accumelative<span class="token punctuation">.</span>FourthItems<span class="token punctuation">)</span> <span class="token punctuation">{</span> item <span class="token punctuation">}</span> <span class="token punctuation">:</span> 
                        accumelative<span class="token punctuation">.</span>FourthItems 
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Result:</span>
<span class="token comment">// Total = 12</span>
<span class="token comment">// Even = 6</span>
<span class="token comment">// FourthItems = [4, 8, 12]</span>

</code></pre></div><p><strong>Note that using an anonymous type as the seed one has to instantiate a new object each item because the properties are read only. Using a custom class one can simply assign the information and no <code>new</code> is needed (only when giving the initial <code>seed</code> parameter</strong></p> <h2 id="selectmany-flattening-a-sequence-of-sequences"><a href="#selectmany-flattening-a-sequence-of-sequences" class="header-anchor">#</a> SelectMany: Flattening a sequence of sequences</h2> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> sequenceOfSequences <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">6</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> sequence <span class="token operator">=</span> sequenceOfSequences<span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// returns { 1, 2, 3, 4, 5, 6 }</span>

</code></pre></div><p>Use <code>SelectMany()</code> if you have, or you are creating a sequence of sequences, but you want the result as one long sequence.</p> <p>In LINQ Query Syntax:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> sequence <span class="token operator">=</span> <span class="token keyword">from</span> subSequence <span class="token keyword">in</span> sequenceOfSequences
               <span class="token keyword">from</span> item <span class="token keyword">in</span> subSequence
               <span class="token keyword">select</span> item<span class="token punctuation">;</span>

</code></pre></div><p>If you have a collection of collections and would like to be able to work on data from parent and child collection at the same time, it is also possible with <code>SelectMany</code>.</p> <p>Let's define simple classes</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlogPost</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Content <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span>Comment<span class="token punctuation">&gt;</span></span> Comments <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Comment</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Content <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Let's assume we have following collection.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">List<span class="token punctuation">&lt;</span>BlogPost<span class="token punctuation">&gt;</span></span> posts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>BlogPost<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">BlogPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        Comments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Comment<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Comment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
                Content <span class="token operator">=</span> <span class="token string">&quot;It's really great!&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Comment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
                Content <span class="token operator">=</span> <span class="token string">&quot;Cool post!&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">BlogPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
        Comments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Comment<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Comment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
                Content <span class="token operator">=</span> <span class="token string">&quot;I don't think you're right&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Comment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Id <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
                Content <span class="token operator">=</span> <span class="token string">&quot;This post is a complete nonsense&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>Now we want to select comments <code>Content</code> along with <code>Id</code> of <code>BlogPost</code> associated with this comment. In order to do so, we can use appropriate <code>SelectMany</code> overload.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> commentsWithIds <span class="token operator">=</span> posts<span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>p <span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>Comments<span class="token punctuation">,</span> <span class="token punctuation">(</span>post<span class="token punctuation">,</span> comment<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> PostId <span class="token operator">=</span> post<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> CommentContent <span class="token operator">=</span> comment<span class="token punctuation">.</span>Content <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Our <code>commentsWithIds</code> looks like this</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token punctuation">{</span>
    PostId <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
    CommentContent <span class="token operator">=</span> <span class="token string">&quot;It's really great!&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    PostId <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
    CommentContent <span class="token operator">=</span> <span class="token string">&quot;Cool post!&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    PostId <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
    CommentContent <span class="token operator">=</span> <span class="token string">&quot;I don't think you're right&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    PostId <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
    CommentContent <span class="token operator">=</span> <span class="token string">&quot;This post is a complete nonsense&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="distinct"><a href="#distinct" class="header-anchor">#</a> Distinct</h2> <p>Returns unique values from an <code>IEnumerable</code>. Uniqueness is determined using the default equality comparer.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> array <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> distinct <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">Distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// distinct = { 1, 2, 3, 4, 5 }</span>

</code></pre></div><p>To compare a custom data type, we need to implement the <code>IEquatable&lt;T&gt;</code> interface and provide <code>GetHashCode</code> and <code>Equals</code> methods for the type. Or the equality comparer may be overridden:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">SSNEqualityComparer</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IEqualityComparer<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Equals</span><span class="token punctuation">(</span><span class="token class-name">Person</span> a<span class="token punctuation">,</span> <span class="token class-name">Person</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>SSN <span class="token operator">==</span> b<span class="token punctuation">.</span>SSN<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">GetHashCode</span><span class="token punctuation">(</span><span class="token class-name">Person</span> p<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>SSN<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> people<span class="token punctuation">;</span>

distinct <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Distinct</span><span class="token punctuation">(</span>SSNEqualityComparer<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="query-collection-by-type-cast-elements-to-type"><a href="#query-collection-by-type-cast-elements-to-type" class="header-anchor">#</a> Query collection by type / cast elements to type</h2> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">interface</span> <span class="token class-name">IFoo</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IFoo</span></span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Bar</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IFoo</span></span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

</code></pre></div><div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> item0 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> item1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> item2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> item3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> collection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">IFoo<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> item0<span class="token punctuation">,</span> item1<span class="token punctuation">,</span> item2<span class="token punctuation">,</span> item3 <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>Using <code>OfType</code></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> foos <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">OfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Foo<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// result: IEnumerable&lt;Foo&gt; with item0 and item1</span>
<span class="token class-name"><span class="token keyword">var</span></span> bars <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">OfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Bar<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// result: IEnumerable&lt;Bar&gt; item item2 and item3</span>
<span class="token class-name"><span class="token keyword">var</span></span> foosAndBars <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">OfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IFoo<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// result: IEnumerable&lt;IFoo&gt; with all four items</span>

</code></pre></div><p>Using <code>Where</code></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> foos <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item <span class="token keyword">is</span> <span class="token class-name">Foo</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// result: IEnumerable&lt;IFoo&gt; with item0 and item1</span>
<span class="token class-name"><span class="token keyword">var</span></span> bars <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item <span class="token keyword">is</span> <span class="token class-name">Bar</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// result: IEnumerable&lt;IFoo&gt; with item2 and item3</span>

</code></pre></div><p>Using <code>Cast</code></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> bars <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Cast</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Bar<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// throws InvalidCastException on the 1st item</span>
<span class="token class-name"><span class="token keyword">var</span></span> foos <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Cast</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Foo<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// throws InvalidCastException on the 3rd item</span>
<span class="token class-name"><span class="token keyword">var</span></span> foosAndBars <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Cast</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IFoo<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// OK </span>

</code></pre></div><h2 id="groupby"><a href="#groupby" class="header-anchor">#</a> GroupBy</h2> <p>GroupBy is an easy way to sort a <code>IEnumerable&lt;T&gt;</code> collection of items into distinct groups.</p> <h3 id="simple-example"><a href="#simple-example" class="header-anchor">#</a> Simple Example</h3> <p>In this first example, we end up with two groups, odd and even items.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> iList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> grouped <span class="token operator">=</span> iList<span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Groups iList into odd [13579] and even[2468] items </span>
       
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> <span class="token keyword">group</span> <span class="token keyword">in</span> grouped<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> item <span class="token keyword">in</span> <span class="token keyword">group</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 135792468  (first odd then even)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="more-complex-example"><a href="#more-complex-example" class="header-anchor">#</a> More Complex Example</h3> <p>Let's take grouping a list of people by age as an example.
First, we'll create a Person object which has two properties, Name and Age.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Age <span class="token punctuation">{</span><span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span><span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Then we create our sample list of people with various names and ages.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> people <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
people<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">{</span>Age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;Mouse&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
people<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">{</span>Age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;Neo&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
people<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">{</span>Age <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;Morpheus&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
people<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">{</span>Age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;Trinity&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
people<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">{</span>Age <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;Dozer&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
people<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">{</span>Age <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Then we create a LINQ query to group our list of people by age.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> query <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Age<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Doing so, we can see the Age for each group, and have a list of each person in the group.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> result <span class="token keyword">in</span> query<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> person <span class="token keyword">in</span> result<span class="token punctuation">)</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>This results in the following output:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token number">20</span>
Mouse
<span class="token number">30</span>
Neo
Trinity
<span class="token number">40</span>
Morpheus
Dozer
Smith

</code></pre></div><p>You can play with the <a href="https://dotnetfiddle.net/VFOZ1x" target="_blank" rel="noopener noreferrer">live demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="enumerating-the-enumerable"><a href="#enumerating-the-enumerable" class="header-anchor">#</a> Enumerating the Enumerable</h2> <p>The IEnumerable<T> interface is the base interface for all generic enumerators and is a quintessential part of understanding LINQ. At its core, it represents the sequence.</T></p> <p>This underlying interface is inherited by all of the generic collections, such as <a href="https://msdn.microsoft.com/en-us/library/ms132397(v=vs.110).aspx" target="_blank" rel="noopener noreferrer">Collection<T><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></T></a>, <a href="https://msdn.microsoft.com/en-us/library/system.array(v=vs.110).aspx" target="_blank" rel="noopener noreferrer">Array<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx" target="_blank" rel="noopener noreferrer">List<T><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></T></a>, <a href="https://msdn.microsoft.com/en-us/library/xfhwa508(v=vs.110).aspx" target="_blank" rel="noopener noreferrer">Dictionary&lt;TKey,TValue&gt; Class<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, and <a href="https://msdn.microsoft.com/en-us/library/bb359438(v=vs.110).aspx" target="_blank" rel="noopener noreferrer">HashSet<T><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></T></a>.</p> <p>In addition to representing the sequence, any class that inherits from IEnumerable<T> must provide an IEnumerator<T>. The enumerator exposes the iterator for the enumerable, and these two interconnected interfaces and ideas are the source of the saying &quot;enumerate the enumerable&quot;.</T></T></p> <p>&quot;Enumerating the enumerable&quot; is an important phrase. The enumerable is simply a structure for how to iterate, it does not hold any materialized objects. For example, when sorting, an enumerable may hold the criteria of the field to sort, but using <code>.OrderBy()</code> in itself will return an IEnumerable<T> which only knows <strong>how</strong> to sort. Using a call which will materialize the objects, as in iterate the set, is known as enumerating (for example <code>.ToList()</code>). The enumeration process will use the the enumerable definition of <strong>how</strong> in order to move through the series and return the relevant objects (in order, filtered, projected, etc.).</T></p> <p>Only once the enumerable has been enumerated does it cause the materialization of the objects, which is when metrics like <a href="https://en.wikipedia.org/wiki/Time_complexity" target="_blank" rel="noopener noreferrer">time complexity<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (how long it should take related to series size) and spacial complexity (how much space it should use related to series size) can be measured.</p> <p>Creating your own class that inherits from IEnumerable<T> can be a little complicated depending on the underlying series that needs to be enumerable. In general it is best to use one of the existing generic collections. That said, it is also possible to inherit from the IEnumerable<T> interface without having a defined array as the underlying structure.</T></T></p> <p>For example, using the Fibonacci series as the underlying sequence. Note that the call to <code>Where</code> simply builds an <code>IEnumerable</code>, and it is not until a call to enumerate that enumerable is made that any of the values are materialized.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">Fibonacci</span> Fibo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Fibonacci</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">long</span><span class="token punctuation">&gt;</span></span> quadrillionplus <span class="token operator">=</span> Fibo<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">&gt;</span> <span class="token number">1000000000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Enumerable built&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>quadrillionplus<span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>quadrillionplus<span class="token punctuation">.</span><span class="token function">Skip</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">long</span><span class="token punctuation">&gt;</span></span> fibMod612 <span class="token operator">=</span> Fibo<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">%</span> <span class="token number">612</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Enumerable built&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>fibMod612<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//smallest divisible by 612</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Fibonacci</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">long</span><span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">int</span></span> max <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>

    <span class="token comment">//Enumerator called typically from foreach</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">IEnumerator</span> <span class="token function">GetEnumerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">long</span></span> n0 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">long</span></span> n1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Enumerating the Enumerable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> max<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">yield</span> <span class="token keyword">return</span> n0<span class="token operator">+</span>n1<span class="token punctuation">;</span>
            n1 <span class="token operator">+=</span> n0<span class="token punctuation">;</span>
            n0 <span class="token operator">=</span> n1<span class="token operator">-</span>n0<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//Enumerable called typically from linq</span>
    <span class="token return-type class-name">IEnumerator<span class="token punctuation">&lt;</span><span class="token keyword">long</span><span class="token punctuation">&gt;</span></span> IEnumerable<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">GetEnumerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">long</span></span> n0 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">long</span></span> n1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Enumerating the Enumerable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> max<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">yield</span> <span class="token keyword">return</span> n0<span class="token operator">+</span>n1<span class="token punctuation">;</span>
            n1 <span class="token operator">+=</span> n0<span class="token punctuation">;</span>
            n0 <span class="token operator">=</span> n1<span class="token operator">-</span>n0<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Output</p> <div class="language-cs extra-class"><pre class="language-cs"><code>Enumerable built
Enumerating the Enumerable
<span class="token number">4052739537881</span>
Enumerating the Enumerable
<span class="token number">4052739537881</span>
Enumerable built
Enumerating the Enumerable
<span class="token number">14930352</span>

</code></pre></div><p>The strength in the second set (the fibMod612) is that even though we made the call to order our entire set of Fibonacci numbers, since only one value was taken using <code>.First()</code> the time complexity was O(n) as only 1 value needed to be compared during the ordering algorithm's execution. This is because our enumerator only asked for 1 value, and so the entire enumerable did not have to be materialized. Had we used <code>.Take(5)</code> instead of <code>.First()</code> the enumerator would have asked for 5 values, and at most 5 values would need to be materialized. Compared to needing to order an entire set <strong>and then</strong> take the first 5 values, the principle of saves a lot of execution time and space.</p> <h2 id="where"><a href="#where" class="header-anchor">#</a> Where</h2> <p>Returns a subset of items which the specified predicate is true for them.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> trees <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span> <span class="token string">&quot;Oak&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Birch&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Beech&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Elm&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hazel&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Maple&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="method-syntax"><a href="#method-syntax" class="header-anchor">#</a> Method syntax</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Select all trees with name of length 3</span>
<span class="token class-name"><span class="token keyword">var</span></span> shortTrees <span class="token operator">=</span> trees<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>tree <span class="token operator">=&gt;</span> tree<span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Oak, Elm</span>

</code></pre></div><h3 id="query-syntax"><a href="#query-syntax" class="header-anchor">#</a> Query syntax</h3> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> shortTrees <span class="token operator">=</span> <span class="token keyword">from</span> tree <span class="token keyword">in</span> trees
                 <span class="token keyword">where</span> <span class="token class-name">tree</span><span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">3</span>
                 <span class="token keyword">select</span> tree<span class="token punctuation">;</span> <span class="token comment">// Oak, Elm</span>

</code></pre></div><h2 id="using-range-with-various-linq-methods"><a href="#using-range-with-various-linq-methods" class="header-anchor">#</a> Using Range with various Linq methods</h2> <p>You can use the Enumerable class alongside Linq queries to convert for loops into Linq one liners.</p> <p><strong>Select Example</strong></p> <p>Opposed to doing this:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> asciiCharacters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">char</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    asciiCharacters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>You can do this:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> asciiCharacters <span class="token operator">=</span> Enumerable<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Where Example</strong></p> <p>In this example, 100 numbers will be generated and even ones will be extracted</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> evenNumbers <span class="token operator">=</span> Enumerable<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> a <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="using-selectmany-instead-of-nested-loops"><a href="#using-selectmany-instead-of-nested-loops" class="header-anchor">#</a> Using SelectMany instead of nested loops</h2> <p>Given 2 lists</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> list1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> list2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>if you want to output all permutations you could use nested loops like</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> s1 <span class="token keyword">in</span> list1<span class="token punctuation">)</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> s2 <span class="token keyword">in</span> list2<span class="token punctuation">)</span>
        result<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s1</span><span class="token punctuation">}</span></span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s2</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Using SelectMany you can do the same operation as</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> list1<span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> list2<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>y <span class="token operator">=&gt;</span> <span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">x</span><span class="token punctuation">}</span></span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">y</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="contains"><a href="#contains" class="header-anchor">#</a> Contains</h2> <p>MSDN:</p> <blockquote></blockquote> <p>Determines whether a sequence contains a specified element by using a
specified `IEqualityComparer<T>`</T></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> result1 <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token class-name"><span class="token keyword">var</span></span> result2 <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> secondNumberCollection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// Note that can use the Intersect method in this case</span>
<span class="token class-name"><span class="token keyword">var</span></span> result3 <span class="token operator">=</span> secondNumberCollection<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> numbers<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// will be true only for 4,5</span>

</code></pre></div><p>Using a user defined object:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> objects <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Nikki&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Gilad&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Phil&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//Using the Person's Equals method - override Equals() and GetHashCode() - otherwise it</span>
<span class="token comment">//will compare by reference and result will be false</span>
<span class="token class-name"><span class="token keyword">var</span></span> result4 <span class="token operator">=</span> objects<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Phil&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

</code></pre></div><p>Using the <code>Enumerable.Contains(value, comparer)</code> overload:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Compare</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IEqualityComparer<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Equals</span><span class="token punctuation">(</span><span class="token class-name">Person</span> x<span class="token punctuation">,</span> <span class="token class-name">Person</span> y<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> x<span class="token punctuation">.</span>Name <span class="token operator">==</span> y<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">GetHashCode</span><span class="token punctuation">(</span><span class="token class-name">Person</span> codeh<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> codeh<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">GetHashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name"><span class="token keyword">var</span></span> result5 <span class="token operator">=</span> objects<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Phil&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Compare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

</code></pre></div><p><strong>A smart usage of <code>Contains</code> would be to replace multiple <code>if</code> clauses to a <code>Contains</code> call.</strong></p> <p>So instead of doing this:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">if</span><span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> status <span class="token operator">==</span> <span class="token number">3</span> <span class="token operator">||</span> status <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//Do some business operation</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span>
<span class="token punctuation">{</span>
    <span class="token comment">//Do something else</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Do this:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//Do some business operaion</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> 
<span class="token punctuation">{</span>
    <span class="token comment">//Do something else</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="groupby-one-or-multiple-fields"><a href="#groupby-one-or-multiple-fields" class="header-anchor">#</a> GroupBy one or multiple fields</h2> <p>Lets assume we have some Film model:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Film</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Title <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Category <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Year <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Group by Category property:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> grp <span class="token keyword">in</span> films<span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>f <span class="token operator">=&gt;</span> f<span class="token punctuation">.</span>Category<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> groupCategory <span class="token operator">=</span> grp<span class="token punctuation">.</span>Key<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> numberOfFilmsInCategory <span class="token operator">=</span> grp<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Group by Category and Year:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> grp <span class="token keyword">in</span> films<span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>f <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Category <span class="token operator">=</span> f<span class="token punctuation">.</span>Category<span class="token punctuation">,</span> Year <span class="token operator">=</span> f<span class="token punctuation">.</span>Year <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> groupCategory <span class="token operator">=</span> grp<span class="token punctuation">.</span>Key<span class="token punctuation">.</span>Category<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> groupYear <span class="token operator">=</span> grp<span class="token punctuation">.</span>Key<span class="token punctuation">.</span>Year<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> numberOfFilmsInCategory <span class="token operator">=</span> grp<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="query-ordering-orderby-thenby-orderbydescending-thenbydescending"><a href="#query-ordering-orderby-thenby-orderbydescending-thenbydescending" class="header-anchor">#</a> Query Ordering - OrderBy() ThenBy() OrderByDescending() ThenByDescending()</h2> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> names<span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;mark&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;steve&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;adam&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Ascending:</strong></p> <p><strong>Query Syntax</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> sortedNames <span class="token operator">=</span>
    <span class="token keyword">from</span> name <span class="token keyword">in</span> names
    <span class="token keyword">orderby</span> name
    <span class="token keyword">select</span> name<span class="token punctuation">;</span>

</code></pre></div><p><strong>Method Syntax</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> sortedNames <span class="token operator">=</span> names<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>name <span class="token operator">=&gt;</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>sortedNames contains the names in following order:
&quot;adam&quot;,&quot;mark&quot;,&quot;steve&quot;</p> <p><strong>Descending:</strong></p> <p><strong>Query Syntax</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> sortedNames <span class="token operator">=</span>
    <span class="token keyword">from</span> name <span class="token keyword">in</span> names
    <span class="token keyword">orderby</span> name <span class="token keyword">descending</span>
    <span class="token keyword">select</span> name<span class="token punctuation">;</span>

</code></pre></div><p><strong>Method Syntax</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> sortedNames <span class="token operator">=</span> names<span class="token punctuation">.</span><span class="token function">OrderByDescending</span><span class="token punctuation">(</span>name <span class="token operator">=&gt;</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>sortedNames contains the names in following order:
&quot;steve&quot;,&quot;mark&quot;,&quot;adam&quot;</p> <p><strong>Order by several fields</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;Steve&quot;</span><span class="token punctuation">,</span> LastName <span class="token operator">=</span> <span class="token string">&quot;Collins&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;Phil&quot;</span> <span class="token punctuation">,</span> LastName <span class="token operator">=</span> <span class="token string">&quot;Collins&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;Adam&quot;</span> <span class="token punctuation">,</span> LastName <span class="token operator">=</span> <span class="token string">&quot;Ackerman&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">29</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;Adam&quot;</span> <span class="token punctuation">,</span> LastName <span class="token operator">=</span> <span class="token string">&quot;Ackerman&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Query Syntax</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> sortedPeople <span class="token operator">=</span> <span class="token keyword">from</span> person <span class="token keyword">in</span> people
                   <span class="token keyword">orderby</span> person<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> person<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> person<span class="token punctuation">.</span>Age <span class="token keyword">descending</span>
                   <span class="token keyword">select</span> person<span class="token punctuation">;</span>

</code></pre></div><p><strong>Method Syntax</strong></p> <div class="language- extra-class"><pre class="language-text"><code>
sortedPeople = people.OrderBy(person =&gt; person.LastName)
                      .ThenBy(person =&gt; person.FirstName)
                      .ThenByDescending(person =&gt; person.Age);

</code></pre></div><p><strong>Result</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token number">1</span><span class="token punctuation">.</span> Adam Ackerman <span class="token number">29</span>
<span class="token number">2</span><span class="token punctuation">.</span> Adam Ackerman <span class="token number">15</span>
<span class="token number">3</span><span class="token punctuation">.</span> Phil Collins  <span class="token number">28</span>
<span class="token number">4</span><span class="token punctuation">.</span> Steve Collins <span class="token number">30</span>

</code></pre></div><h2 id="todictionary"><a href="#todictionary" class="header-anchor">#</a> ToDictionary</h2> <p>The <code>ToDictionary()</code> LINQ method can be used to generate a <code>Dictionary&lt;TKey, TElement&gt;</code> collection based on a given <code>IEnumerable&lt;T&gt;</code> source.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>User<span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token function">GetUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> User<span class="token punctuation">&gt;</span></span> usersById <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">ToDictionary</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>In this example, the single argument passed to <code>ToDictionary</code> is of type <code>Func&lt;TSource, TKey&gt;</code>, which returns the key for each element.</p> <p>This is a concise way to perform the following operation:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> User<span class="token punctuation">&gt;</span></span> usersById <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span> User<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">User</span> u <span class="token keyword">in</span> users<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
  usersById<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>You can also pass a second parameter to the <code>ToDictionary</code> method, which is of type <code>Func&lt;TSource,TElement&gt;</code> and returns the <code>Value</code> to be added for each entry.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>User<span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token function">GetUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> userNamesById <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">ToDictionary</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>It is also possible to specify the <code>IComparer</code> that is used to compare key values. This can be useful when the key is a string and you want it to match case-insensitive.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>User<span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token function">GetUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> User<span class="token punctuation">&gt;</span></span> usersByCaseInsenstiveName <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">ToDictionary</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> StringComparer<span class="token punctuation">.</span>InvariantCultureIgnoreCase<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> user1 <span class="token operator">=</span> usersByCaseInsenstiveName<span class="token punctuation">[</span><span class="token string">&quot;john&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> user2 <span class="token operator">=</span> usersByCaseInsenstiveName<span class="token punctuation">[</span><span class="token string">&quot;JOHN&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
user1 <span class="token operator">==</span> user2<span class="token punctuation">;</span> <span class="token comment">// Returns true</span>

</code></pre></div><p>Note: the <code>ToDictionary</code> method requires all keys to be unique, there must be no duplicate keys. If there are, then an exception is thrown: <code>ArgumentException: An item with the same key has already been added.</code> If you have a scenario where you know that you will have multiple elements with the same key, then you are better off using <a href="http://stackoverflow.com/documentation/c%23/68/linq-queries/14871/tolookup" target="_blank" rel="noopener noreferrer"><code>ToLookup</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> instead.</p> <h2 id="skipwhile"><a href="#skipwhile" class="header-anchor">#</a> SkipWhile</h2> <p><code>SkipWhile()</code> is used to exclude elements until first non-match (this might be counter intuitive to most)</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> list <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">42</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">SkipWhile</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">==</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// Result: 6, 6, 6, 42</span>

</code></pre></div><h2 id="defaultifempty"><a href="#defaultifempty" class="header-anchor">#</a> DefaultIfEmpty</h2> <p>DefaultIfEmpty is used to return a Default Element if the Sequence contains no elements. This Element can be the Default of the Type or a user defined instance of that Type. Example:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> chars <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;d&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

chars<span class="token punctuation">.</span><span class="token function">DefaultIfEmpty</span><span class="token punctuation">(</span><span class="token string">&quot;N/A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns &quot;a&quot;;</span>

chars<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>str <span class="token operator">=&gt;</span> str<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">DefaultIfEmpty</span><span class="token punctuation">(</span><span class="token string">&quot;N/A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// return &quot;N/A&quot;</span>

chars<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>str <span class="token operator">=&gt;</span> str<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">DefaultIfEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns null;</span>

</code></pre></div><h3 id="usage-in-left-joins"><a href="#usage-in-left-joins" class="header-anchor">#</a> <strong>Usage in Left Joins</strong>:</h3> <p>With <code>DefaultIfEmpty</code> the traditional Linq Join can return a default object if no match was found. Thus acting as a SQL's Left Join. Example:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> leftSequence <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">105</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> rightSequence <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">char</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token string character">'a'</span><span class="token punctuation">,</span> <span class="token string character">'b'</span><span class="token punctuation">,</span> <span class="token string character">'c'</span><span class="token punctuation">,</span> <span class="token string character">'i'</span><span class="token punctuation">,</span> <span class="token string character">'d'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> numbersAsChars <span class="token operator">=</span> <span class="token keyword">from</span> l <span class="token keyword">in</span> leftSequence
                     <span class="token keyword">join</span> r <span class="token keyword">in</span> rightSequence
                     <span class="token keyword">on</span> <span class="token return-type class-name">l</span> equals <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>r <span class="token keyword">into</span> leftJoin
                     <span class="token keyword">from</span> result <span class="token keyword">in</span> leftJoin<span class="token punctuation">.</span><span class="token function">DefaultIfEmpty</span><span class="token punctuation">(</span><span class="token string character">'?'</span><span class="token punctuation">)</span>
                     <span class="token keyword">select</span> <span class="token keyword">new</span>
                     <span class="token punctuation">{</span>
                         Number <span class="token operator">=</span> l<span class="token punctuation">,</span>
                         Character <span class="token operator">=</span> result
                     <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> item <span class="token keyword">in</span> numbersAsChars<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Num = {0} ** Char = {1}&quot;</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>Number<span class="token punctuation">,</span> item<span class="token punctuation">.</span>Character<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ouput<span class="token punctuation">:</span> 

Num <span class="token operator">=</span> <span class="token number">99</span>         Char <span class="token operator">=</span> <span class="token class-name">c</span>
Num <span class="token operator">=</span> <span class="token number">100</span>        Char <span class="token operator">=</span> <span class="token class-name">d</span>
Num <span class="token operator">=</span> <span class="token number">5</span>          Char <span class="token operator">=</span> <span class="token punctuation">?</span>
Num <span class="token operator">=</span> <span class="token number">20</span>         Char <span class="token operator">=</span> <span class="token punctuation">?</span>
Num <span class="token operator">=</span> <span class="token number">102</span>        Char <span class="token operator">=</span> <span class="token punctuation">?</span>
Num <span class="token operator">=</span> <span class="token number">105</span>        Char <span class="token operator">=</span> i

</code></pre></div><p>In the case where a <code>DefaultIfEmpty</code> is used (without specifying a default value) and that will result will no matching items on the right sequence one must make sure that the object is not <code>null</code> before accessing its properties. Otherwise it will result in a <code>NullReferenceException</code>. Example:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> leftSequence <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> rightSequence <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token punctuation">{</span> Value <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token punctuation">{</span> Value <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token punctuation">{</span> Value <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token punctuation">{</span> Value <span class="token operator">=</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> numbersAsChars <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">from</span> l <span class="token keyword">in</span> leftSequence
                        <span class="token keyword">join</span> r <span class="token keyword">in</span> rightSequence
                        <span class="token keyword">on</span> l equals r<span class="token punctuation">.</span>Value <span class="token keyword">into</span> leftJoin
                        <span class="token keyword">from</span> result <span class="token keyword">in</span> leftJoin<span class="token punctuation">.</span><span class="token function">DefaultIfEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token keyword">select</span> <span class="token keyword">new</span>
                        <span class="token punctuation">{</span>
                            Left <span class="token operator">=</span> l<span class="token punctuation">,</span>
                            <span class="token comment">// 5 will not have a matching object in the right so result </span>
                            <span class="token comment">// will be equal to null. </span>
                            <span class="token comment">// To avoid an error use:</span>
                            <span class="token comment">//    -  C# 6.0 or above - ?. </span>
                            <span class="token comment">//    -  Under           - result == null ? 0 : result.Value</span>
                            Right <span class="token operator">=</span> result<span class="token punctuation">?.</span>Value
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="sequenceequal"><a href="#sequenceequal" class="header-anchor">#</a> SequenceEqual</h2> <p><code>SequenceEqual</code> is used to compare two <code>IEnumerable&lt;T&gt;</code> sequences with each other.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">bool</span></span> returnsTrue <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">SequenceEqual</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">bool</span></span> returnsFalse <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">SequenceEqual</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="elementat-and-elementatordefault"><a href="#elementat-and-elementatordefault" class="header-anchor">#</a> ElementAt and ElementAtOrDefault</h2> <p><code>ElementAt</code> will return the item at index <code>n</code>. If <code>n</code> is not within the range of the enumerable, throws an <code>ArgumentOutOfRangeException</code>.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers  <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
numbers<span class="token punctuation">.</span><span class="token function">ElementAt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 3</span>
numbers<span class="token punctuation">.</span><span class="token function">ElementAt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws ArgumentOutOfRangeException</span>

</code></pre></div><p><code>ElementAtOrDefault</code> will return the item at index <code>n</code>. If <code>n</code> is not within the range of the enumerable, returns a <code>default(T)</code>.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers  <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
numbers<span class="token punctuation">.</span><span class="token function">ElementAtOrDefault</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 3</span>
numbers<span class="token punctuation">.</span><span class="token function">ElementAtOrDefault</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0 = default(int)</span>

</code></pre></div><p>Both <code>ElementAt</code> and <code>ElementAtOrDefault</code> are optimized for when the source is an <code>IList&lt;T&gt;</code> and normal indexing will be used in those cases.</p> <p>Note that for <code>ElementAt</code>, if the provided index is greater than the size of the <code>IList&lt;T&gt;</code>, the list should (but is technically not guaranteed to) throw an <code>ArgumentOutOfRangeException</code>.</p> <h2 id="joining-multiple-sequences"><a href="#joining-multiple-sequences" class="header-anchor">#</a> Joining multiple sequences</h2> <p>Consider entities <code>Customer</code>, <code>Purchase</code> and <code>PurchaseItem</code> as follows:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer</span>
<span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span> <span class="token punctuation">}</span> <span class="token comment">// A unique Id that identifies customer    </span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name  <span class="token punctuation">{</span><span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Purchase</span>
<span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> CustomerId <span class="token punctuation">{</span><span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Description <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PurchaseItem</span>
<span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> PurchaseId <span class="token punctuation">{</span><span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Detail <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Consider following sample data for above entities:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> customers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>             
 <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        Name <span class="token operator">=</span> <span class="token string">&quot;Customer1&quot;</span>            
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
            
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        Name <span class="token operator">=</span> <span class="token string">&quot;Customer2&quot;</span>            
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>        
    
 <span class="token class-name"><span class="token keyword">var</span></span> purchases <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Purchase<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
 <span class="token punctuation">{</span>
     <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Purchase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                
         Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         CustomerId <span class="token operator">=</span> customers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
         Description <span class="token operator">=</span> <span class="token string">&quot;Customer1-Purchase1&quot;</span>            
     <span class="token punctuation">}</span><span class="token punctuation">,</span>

     <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Purchase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         CustomerId <span class="token operator">=</span> customers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
         Description <span class="token operator">=</span> <span class="token string">&quot;Customer1-Purchase2&quot;</span>            
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     
     <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Purchase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         CustomerId <span class="token operator">=</span> customers<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
         Description <span class="token operator">=</span> <span class="token string">&quot;Customer2-Purchase1&quot;</span>            
     <span class="token punctuation">}</span><span class="token punctuation">,</span>

     <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Purchase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         CustomerId <span class="token operator">=</span> customers<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
         Description <span class="token operator">=</span> <span class="token string">&quot;Customer2-Purchase2&quot;</span>            
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
 <span class="token class-name"><span class="token keyword">var</span></span> purchaseItems <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>PurchaseItem<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
 <span class="token punctuation">{</span>
     <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PurchaseItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                
         Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         PurchaseId<span class="token operator">=</span> purchases<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
         Detail <span class="token operator">=</span> <span class="token string">&quot;Purchase1-PurchaseItem1&quot;</span>            
     <span class="token punctuation">}</span><span class="token punctuation">,</span>

     <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PurchaseItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                
         Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         PurchaseId<span class="token operator">=</span> purchases<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
         Detail <span class="token operator">=</span> <span class="token string">&quot;Purchase2-PurchaseItem1&quot;</span>            
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     
     <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PurchaseItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                
         Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         PurchaseId<span class="token operator">=</span> purchases<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
         Detail <span class="token operator">=</span> <span class="token string">&quot;Purchase2-PurchaseItem2&quot;</span>            
     <span class="token punctuation">}</span><span class="token punctuation">,</span>

     <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PurchaseItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                
         Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         PurchaseId<span class="token operator">=</span> purchases<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
         Detail <span class="token operator">=</span> <span class="token string">&quot;Purchase3-PurchaseItem1&quot;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>Now, consider below linq query:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> <span class="token keyword">from</span> c <span class="token keyword">in</span> customers
            <span class="token keyword">join</span> p <span class="token keyword">in</span> purchases <span class="token keyword">on</span> c<span class="token punctuation">.</span>Id equals p<span class="token punctuation">.</span>CustomerId           <span class="token comment">// first join</span>
            <span class="token keyword">join</span> pi <span class="token keyword">in</span> purchaseItems <span class="token keyword">on</span> p<span class="token punctuation">.</span>Id equals pi<span class="token punctuation">.</span>PurchaseId     <span class="token comment">// second join</span>
            <span class="token keyword">select</span> <span class="token keyword">new</span>
            <span class="token punctuation">{</span>
               c<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> p<span class="token punctuation">.</span>Description<span class="token punctuation">,</span> pi<span class="token punctuation">.</span>Detail
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>To output the result of above query:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> resultItem <span class="token keyword">in</span> result<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">resultItem<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">resultItem<span class="token punctuation">.</span>Description</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">resultItem<span class="token punctuation">.</span>Detail</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>The output of the query would be:</p> <blockquote></blockquote> <p>Customer1, Customer1-Purchase1, Purchase1-PurchaseItem1
Customer1, Customer1-Purchase2, Purchase2-PurchaseItem1
Customer1, Customer1-Purchase2, Purchase2-PurchaseItem2
Customer2, Customer2-Purchase2, Purchase3-PurchaseItem1</p> <p><a href="https://dotnetfiddle.net/Db8uqp" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="joining-on-multiple-keys"><a href="#joining-on-multiple-keys" class="header-anchor">#</a> Joining on multiple keys</h2> <div class="language-cs extra-class"><pre class="language-cs"><code>
 <span class="token class-name">PropertyInfo<span class="token punctuation">[</span><span class="token punctuation">]</span></span> stringProps <span class="token operator">=</span> <span class="token keyword">typeof</span> <span class="token punctuation">(</span><span class="token type-expression class-name"><span class="token keyword">string</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//string properties</span>
  <span class="token class-name">PropertyInfo<span class="token punctuation">[</span><span class="token punctuation">]</span></span> builderProps <span class="token operator">=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">StringBuilder</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//stringbuilder properties</span>
    
    <span class="token class-name"><span class="token keyword">var</span></span> query <span class="token operator">=</span>
        <span class="token keyword">from</span> s <span class="token keyword">in</span> stringProps
        <span class="token keyword">join</span> b <span class="token keyword">in</span> builderProps
            <span class="token keyword">on</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> s<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>PropertyType <span class="token punctuation">}</span> equals <span class="token keyword">new</span> <span class="token punctuation">{</span> b<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> b<span class="token punctuation">.</span>PropertyType <span class="token punctuation">}</span>
        <span class="token keyword">select</span> <span class="token keyword">new</span>
        <span class="token punctuation">{</span>
            s<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
            s<span class="token punctuation">.</span>PropertyType<span class="token punctuation">,</span>
            StringToken <span class="token operator">=</span> s<span class="token punctuation">.</span>MetadataToken<span class="token punctuation">,</span>
            StringBuilderToken <span class="token operator">=</span> b<span class="token punctuation">.</span>MetadataToken
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>Note that anonymous types in above <code>join</code> must contain same properties since objects are considered equal only if all their properties are equal. Otherwise query won't compile.</p> <h2 id="sum"><a href="#sum" class="header-anchor">#</a> Sum</h2> <p>The <code>Enumerable.Sum</code> extension method calculates the sum of numeric values.</p> <p>In case the collection's elements are themselves numbers, you can calculate the sum directly.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span> numbers<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//outputs 11</span>

</code></pre></div><p>In case the type of the elements is a complex type, you can use a lambda expression to specify the value that should be calculated:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> totalMonthlySalary <span class="token operator">=</span> employees<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span> employee <span class="token operator">=&gt;</span> employee<span class="token punctuation">.</span>MonthlySalary <span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Sum extension method can calculate with the following types:</p> <ul><li>Int32</li> <li>Int64</li> <li>Single</li> <li>Double</li> <li>Decimal</li></ul> <p>In case your collection contains nullable types, you can use the null-coalescing operator to set a default value for null elements:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span> numbers<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span> number <span class="token operator">=&gt;</span> number <span class="token operator">??</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//outputs 7</span>

</code></pre></div><h2 id="tolookup"><a href="#tolookup" class="header-anchor">#</a> ToLookup</h2> <blockquote></blockquote> <p>ToLookup returns a data structure that allows indexing. It is an
extension method. It produces an ILookup instance that can be indexed
or enumerated using a foreach-loop. The entries are combined into
groupings at each key. - dotnetperls</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> array <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;three&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//create lookup using string length as key</span>
<span class="token class-name"><span class="token keyword">var</span></span> lookup <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">ToLookup</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//join the values whose lengths are 3</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>lookup<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//output: one,two</span>

</code></pre></div><p>Another Example:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> array <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//generate lookup for odd even numbers (keys will be 0 and 1)</span>
<span class="token class-name"><span class="token keyword">var</span></span> lookup <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">ToLookup</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//print even numbers after joining</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>lookup<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//output: 2,4,6,8</span>

<span class="token comment">//print odd numbers after joining</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>lookup<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//output: 1,3,5,7</span>

</code></pre></div><h2 id="any-and-first-ordefault-best-practice"><a href="#any-and-first-ordefault-best-practice" class="header-anchor">#</a> Any and First(OrDefault) - best practice</h2> <p>I won't explain what <code>Any</code> and <code>FirstOrDefault</code> does because there are already two good example about them. See <a href="https://stackoverflow.com/documentation/c%23/68/linq-queries/5098/any#t=201707200324548979636" target="_blank" rel="noopener noreferrer">Any<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://stackoverflow.com/documentation/c%23/68/linq-queries/329/first-firstordefault-last-lastordefault-single-and-singleordefault#t=201707200328069088515" target="_blank" rel="noopener noreferrer">First, FirstOrDefault, Last, LastOrDefault, Single, and SingleOrDefault<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for more information.</p> <p>A pattern I often see in code which <strong>should be avoided</strong> is</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>myEnumerable<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span>t<span class="token operator">=&gt;</span>t<span class="token punctuation">.</span>Foo <span class="token operator">==</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> myFoo <span class="token operator">=</span> myEnumerable<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span>t<span class="token operator">=&gt;</span>t<span class="token punctuation">.</span>Foo <span class="token operator">==</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//Do stuff</span>
<span class="token punctuation">}</span>

</code></pre></div><p>It could be written more efficiently like this</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> myFoo <span class="token operator">=</span> myEnumerable<span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>t<span class="token operator">=&gt;</span>t<span class="token punctuation">.</span>Foo <span class="token operator">==</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>myFoo <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//Do stuff</span>
<span class="token punctuation">}</span>

</code></pre></div><p>By using the second example, the collection is searched only once and give the same result as the first one. The same idea can be applied to <code>Single</code>.</p> <h2 id="groupby-sum-and-count"><a href="#groupby-sum-and-count" class="header-anchor">#</a> GroupBy Sum and Count</h2> <p>Let's take a sample class:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Transaction</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Category <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">DateTime</span> Date <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">decimal</span></span> Amount <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Now, let us consider a list of transactions:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> transactions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Transaction<span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
   <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Transaction</span> <span class="token punctuation">{</span> Category <span class="token operator">=</span> <span class="token string">&quot;Saving Account&quot;</span><span class="token punctuation">,</span> Amount <span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">,</span> Date <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Today<span class="token punctuation">.</span><span class="token function">AddDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Transaction</span> <span class="token punctuation">{</span> Category <span class="token operator">=</span> <span class="token string">&quot;Saving Account&quot;</span><span class="token punctuation">,</span> Amount <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> Date <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Today<span class="token punctuation">.</span><span class="token function">AddDays</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Transaction</span> <span class="token punctuation">{</span> Category <span class="token operator">=</span> <span class="token string">&quot;Credit Card&quot;</span><span class="token punctuation">,</span> Amount <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">,</span> Date <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Today<span class="token punctuation">.</span><span class="token function">AddDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Transaction</span> <span class="token punctuation">{</span> Category <span class="token operator">=</span> <span class="token string">&quot;Credit Card&quot;</span><span class="token punctuation">,</span> Amount <span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">,</span> Date <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Today <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Transaction</span> <span class="token punctuation">{</span> Category <span class="token operator">=</span> <span class="token string">&quot;Current Account&quot;</span><span class="token punctuation">,</span> Amount <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> Date <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Today<span class="token punctuation">.</span><span class="token function">AddDays</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>If you want to calculate category wise sum of amount and count, you can use GroupBy as follows:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> summaryApproach1 <span class="token operator">=</span> transactions<span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>t <span class="token operator">=&gt;</span> t<span class="token punctuation">.</span>Category<span class="token punctuation">)</span>
                           <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>t <span class="token operator">=&gt;</span> <span class="token keyword">new</span>
                           <span class="token punctuation">{</span>
                               Category <span class="token operator">=</span> t<span class="token punctuation">.</span>Key<span class="token punctuation">,</span>
                               Count <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                               Amount <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span>ta <span class="token operator">=&gt;</span> ta<span class="token punctuation">.</span>Amount<span class="token punctuation">)</span><span class="token punctuation">,</span>
                           <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;-- Summary: Approach 1 --&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
summaryApproach1<span class="token punctuation">.</span><span class="token function">ForEach</span><span class="token punctuation">(</span>
            row <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Category: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">row<span class="token punctuation">.</span>Category</span><span class="token punctuation">}</span></span><span class="token string">, Amount: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">row<span class="token punctuation">.</span>Amount</span><span class="token punctuation">}</span></span><span class="token string">, Count: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">row<span class="token punctuation">.</span>Count</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Alternatively, you can do this in one step:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> summaryApproach2 <span class="token operator">=</span> transactions<span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>t <span class="token operator">=&gt;</span> t<span class="token punctuation">.</span>Category<span class="token punctuation">,</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> t<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
<span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> transactionArray <span class="token operator">=</span> t <span class="token keyword">as</span> <span class="token class-name">Transaction<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">?</span></span><span class="token punctuation">?</span> t<span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span>
        <span class="token punctuation">{</span>
            Category <span class="token operator">=</span> key<span class="token punctuation">,</span>
            Count <span class="token operator">=</span> transactionArray<span class="token punctuation">.</span>Length<span class="token punctuation">,</span>
            Amount <span class="token operator">=</span> transactionArray<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span>ta <span class="token operator">=&gt;</span> ta<span class="token punctuation">.</span>Amount<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;-- Summary: Approach 2 --&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
summaryApproach2<span class="token punctuation">.</span><span class="token function">ForEach</span><span class="token punctuation">(</span>
row <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Category: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">row<span class="token punctuation">.</span>Category</span><span class="token punctuation">}</span></span><span class="token string">, Amount: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">row<span class="token punctuation">.</span>Amount</span><span class="token punctuation">}</span></span><span class="token string">, Count: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">row<span class="token punctuation">.</span>Count</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Output for both the above queries would be same:</p> <blockquote></blockquote> <p>Category: Saving Account, Amount: 66, Count: 2
Category: Credit Card, Amount: 71, Count: 2
Category: Current Account, Amount: 100, Count: 1</p> <p><a href="https://dotnetfiddle.net/1PfLGq#" target="_blank" rel="noopener noreferrer">Live Demo in .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="orderby"><a href="#orderby" class="header-anchor">#</a> OrderBy</h2> <blockquote></blockquote> <p>Orders a collection by a specified value.</p> <p>When the value is an <strong>integer</strong>, <strong>double</strong> or <strong>float</strong> it starts with the <strong>minimum value</strong>, which means that you get first the negative values, than zero and afterwords the positive values (see Example 1).</p> <p>When you order by a <strong>char</strong> the method compares the <strong>ascii values</strong> of the chars to sort the collection (see Example 2).</p> <p>When you sort <strong>strings</strong> the OrderBy method compares them by taking a look at their <a href="https://msdn.microsoft.com/en-us/library/xk2wykcz(VS.71).aspx" target="_blank" rel="noopener noreferrer">CultureInfo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> but normaly starting with the <strong>first letter</strong> in the alphabet (a,b,c...).</p> <p>This kind of order is called ascending, if you want it the other way round you need descending (see OrderByDescending).</p> <p><strong>Example 1:</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">ascending</span> <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// returns {-2, -1, 0, 1, 2}</span>

</code></pre></div><p><strong>Example 2:</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code>
<span class="token class-name"><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> letters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string character">' '</span><span class="token punctuation">,</span> <span class="token string character">'!'</span><span class="token punctuation">,</span> <span class="token string character">'?'</span><span class="token punctuation">,</span> <span class="token string character">'['</span><span class="token punctuation">,</span> <span class="token string character">'{'</span><span class="token punctuation">,</span> <span class="token string character">'+'</span><span class="token punctuation">,</span> <span class="token string character">'1'</span><span class="token punctuation">,</span> <span class="token string character">'9'</span><span class="token punctuation">,</span> <span class="token string character">'a'</span><span class="token punctuation">,</span> <span class="token string character">'A'</span><span class="token punctuation">,</span> <span class="token string character">'b'</span><span class="token punctuation">,</span> <span class="token string character">'B'</span><span class="token punctuation">,</span> <span class="token string character">'y'</span><span class="token punctuation">,</span> <span class="token string character">'Y'</span><span class="token punctuation">,</span> <span class="token string character">'z'</span><span class="token punctuation">,</span> <span class="token string character">'Z'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">char</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">ascending</span> <span class="token operator">=</span> letters<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// returns { ' ', '!', '+', '1', '9', '?', 'A', 'B', 'Y', 'Z', '[', 'a', 'b', 'y', 'z', '{' }</span>

</code></pre></div><p><strong>Example:</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name"><span class="token keyword">var</span></span> people <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span>Name <span class="token operator">=</span> <span class="token string">&quot;Alice&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span>Name <span class="token operator">=</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span>Name <span class="token operator">=</span> <span class="token string">&quot;Carol&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">43</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> youngestPerson <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Age<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> name <span class="token operator">=</span> youngestPerson<span class="token punctuation">.</span>Name<span class="token punctuation">;</span> <span class="token comment">// Bob</span>

</code></pre></div><h2 id="select-transforming-elements"><a href="#select-transforming-elements" class="header-anchor">#</a> Select - Transforming elements</h2> <p>Select allows you to apply a transformation to every element in any data structure implementing IEnumerable.</p> <p>Getting the first character of each string in the following list:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">List<span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> trees <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span> <span class="token string">&quot;Oak&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Birch&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Beech&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Elm&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hazel&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Maple&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>Using regular (lambda) syntax</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">//The below select stament transforms each element in tree into its first character.</span>
<span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> initials <span class="token operator">=</span> trees<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>tree <span class="token operator">=&gt;</span> tree<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">String</span> initial <span class="token keyword">in</span> initials<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    System<span class="token punctuation">.</span>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>initial<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Output:</strong></p> <blockquote></blockquote> <p>O<br>
B<br>
B<br>
E<br>
H<br>
M</p> <p><a href="https://dotnetfiddle.net/yYLT0K" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Using LINQ Query Syntax</p> <div class="language-cs extra-class"><pre class="language-cs"><code>initials <span class="token operator">=</span> <span class="token keyword">from</span> tree <span class="token keyword">in</span> trees
           <span class="token keyword">select</span> tree<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="union"><a href="#union" class="header-anchor">#</a> Union</h2> <p>Merges two collections to create a distinct collection using the  default equality comparer</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> allElement <span class="token operator">=</span> numbers1<span class="token punctuation">.</span><span class="token function">Union</span><span class="token punctuation">(</span>numbers2<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// AllElement now contains 1,2,3,4,5</span>

</code></pre></div><p><a href="https://dotnetfiddle.net/oet2Uq" target="_blank" rel="noopener noreferrer">Live Demo on .NET Fiddle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="count-and-longcount"><a href="#count-and-longcount" class="header-anchor">#</a> Count and LongCount</h2> <p><code>Count</code> returns the number of elements in an <code>IEnumerable&lt;T&gt;</code>. <code>Count</code> also exposes an optional predicate parameter that allows you to filter the elements you want to count.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> array <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns the number of elements in the array</span>
<span class="token class-name"><span class="token keyword">int</span></span> x <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns the number of elements in the array greater than 2</span>

</code></pre></div><p><code>LongCount</code> works the same way as <code>Count</code> but has a return type of <code>long</code> and is used for counting <code>IEnumerable&lt;T&gt;</code> sequences that are longer than <code>int.MaxValue</code></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> array <span class="token operator">=</span> <span class="token function">GetLargeArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">long</span></span> n <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">LongCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns the number of elements in the array</span>
<span class="token class-name"><span class="token keyword">long</span></span> x <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">LongCount</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns the number of elements in the array greater than 100</span>

</code></pre></div><h2 id="incrementally-building-a-query"><a href="#incrementally-building-a-query" class="header-anchor">#</a> Incrementally building a query</h2> <p>Because LINQ uses <strong>deferred execution</strong>, we can have a query object that doesn't actually contain the values, but will return the values when evaluated. We can thus dynamically build the query based on our control flow, and evaluate it once we are finished:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>VehicleModel<span class="token punctuation">&gt;</span></span> <span class="token function">BuildQuery</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> vehicleType<span class="token punctuation">,</span> <span class="token class-name">SearchModel</span> search<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> start <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> count <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>VehicleModel<span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> _entities<span class="token punctuation">.</span>Vehicles
        <span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Active <span class="token operator">&amp;&amp;</span> x<span class="token punctuation">.</span>Type <span class="token operator">==</span> vehicleType<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">VehicleModel</span> <span class="token punctuation">{</span>
            Id <span class="token operator">=</span> v<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
            Year <span class="token operator">=</span> v<span class="token punctuation">.</span>Year<span class="token punctuation">,</span>
            Class <span class="token operator">=</span> v<span class="token punctuation">.</span>Class<span class="token punctuation">,</span>
            Make <span class="token operator">=</span> v<span class="token punctuation">.</span>Make<span class="token punctuation">,</span>
            Model <span class="token operator">=</span> v<span class="token punctuation">.</span>Model<span class="token punctuation">,</span>
            Cylinders <span class="token operator">=</span> v<span class="token punctuation">.</span>Cylinders <span class="token operator">??</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>We can conditionally apply filters:</p> <div class="language-cs extra-class"><pre class="language-cs"><code>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>search<span class="token punctuation">.</span>Years<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> StringComparer<span class="token punctuation">.</span>OrdinalIgnoreCase<span class="token punctuation">)</span><span class="token punctuation">)</span>
        query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> search<span class="token punctuation">.</span>Years<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>Year<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>search<span class="token punctuation">.</span>Makes<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> StringComparer<span class="token punctuation">.</span>OrdinalIgnoreCase<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> search<span class="token punctuation">.</span>Makes<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>Make<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>search<span class="token punctuation">.</span>Models<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> StringComparer<span class="token punctuation">.</span>OrdinalIgnoreCase<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> search<span class="token punctuation">.</span>Models<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>search<span class="token punctuation">.</span>Cylinders<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> StringComparer<span class="token punctuation">.</span>OrdinalIgnoreCase<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">decimal</span></span> minCylinders <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">decimal</span></span> maxCylinders <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>search<span class="token punctuation">.</span>Cylinders<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token string">&quot;2-4&quot;</span><span class="token punctuation">:</span>
                maxCylinders <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">&quot;5-6&quot;</span><span class="token punctuation">:</span>
                minCylinders <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
                maxCylinders <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">&quot;8&quot;</span><span class="token punctuation">:</span>
                minCylinders <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
                maxCylinders <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">&quot;10+&quot;</span><span class="token punctuation">:</span>
                minCylinders <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>minCylinders <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>Cylinders <span class="token operator">&gt;=</span> minCylinders<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>maxCylinders <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>Cylinders <span class="token operator">&lt;=</span> maxCylinders<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre></div><p>We can add a sort order to the query based on a condition:</p> <div class="language-cs extra-class"><pre class="language-cs"><code>
   <span class="token keyword">switch</span> <span class="token punctuation">(</span>search<span class="token punctuation">.</span>SortingColumn<span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&quot;make_model&quot;</span><span class="token punctuation">:</span>
            query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>Make<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ThenBy</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">&quot;year&quot;</span><span class="token punctuation">:</span>
            query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>Year<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">&quot;engine_size&quot;</span><span class="token punctuation">:</span>
            query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>EngineSize<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ThenBy</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>Cylinders<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span>
            query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>Year<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//The default sorting.</span>
    <span class="token punctuation">}</span>

</code></pre></div><p>Our query can be defined to start from a given point:</p> <div class="language-cs extra-class"><pre class="language-cs"><code>
   query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">Skip</span><span class="token punctuation">(</span>start <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>and defined to return a specific number of records:</p> <div class="language-cs extra-class"><pre class="language-cs"><code>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> query<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Once we have the query object, we can evaluate the results with a <code>foreach</code> loop, or one of the LINQ methods that returns a set of values, such as <code>ToList</code> or <code>ToArray</code>:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">SearchModel</span> sm<span class="token punctuation">;</span>

<span class="token comment">// populate the search model here</span>
<span class="token comment">// ...</span>

<span class="token class-name">List<span class="token punctuation">&lt;</span>VehicleModel<span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token function">BuildQuery</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> sm<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="groupjoin-with-outer-range-variable"><a href="#groupjoin-with-outer-range-variable" class="header-anchor">#</a> GroupJoin with outer range variable</h2> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">Customer<span class="token punctuation">[</span><span class="token punctuation">]</span></span> customers <span class="token operator">=</span> Customers<span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Purchase<span class="token punctuation">[</span><span class="token punctuation">]</span></span> purchases <span class="token operator">=</span> Purchases<span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> groupJoinQuery <span class="token operator">=</span>
    <span class="token keyword">from</span> c <span class="token keyword">in</span> customers
    <span class="token keyword">join</span> p <span class="token keyword">in</span> purchases <span class="token keyword">on</span> c<span class="token punctuation">.</span>ID equals p<span class="token punctuation">.</span>CustomerID
    <span class="token keyword">into</span> custPurchases
    <span class="token keyword">select</span> <span class="token keyword">new</span>
    <span class="token punctuation">{</span>
        CustName <span class="token operator">=</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
        custPurchases
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="linq-quantifiers"><a href="#linq-quantifiers" class="header-anchor">#</a> Linq  Quantifiers</h2> <p>Quantifier operations return a Boolean value if some or all of the elements in a sequence satisfy a condition. In this article, we will see some common LINQ to Objects scenarios where we can use these operators.
There are 3 Quantifiers operations that can be used in LINQ:</p> <p><code>All</code>  used to determine whether all the elements in a sequence satisfy a condition.
Eg:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> array <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 
   
<span class="token comment">// Are all elements &gt;= 10? YES</span>
array<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span>element <span class="token operator">=&gt;</span> element <span class="token operator">&gt;=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   
<span class="token comment">// Are all elements &gt;= 20? NO</span>
array<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span>element <span class="token operator">=&gt;</span> element <span class="token operator">&gt;=</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token comment">// Are all elements &lt; 40? YES</span>
array<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span>element <span class="token operator">=&gt;</span> element <span class="token operator">&lt;</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><code>Any</code> - used to determine whether any elements in a sequence satisfy a condition.
Eg:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> query<span class="token operator">=</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span>
query<span class="token punctuation">.</span>Any <span class="token punctuation">(</span>n <span class="token operator">=&gt;</span> n <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><code>Contains</code> - used to determine whether a sequence contains a specified element.
Eg:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">//for int array</span>
<span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> query <span class="token operator">=</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//for string array</span>
<span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> query<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;grey&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;Tom&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//for a string</span>
<span class="token class-name"><span class="token keyword">var</span></span> stringValue<span class="token operator">=</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
stringValue<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;h&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="takewhile"><a href="#takewhile" class="header-anchor">#</a> TakeWhile</h2> <p><code>TakeWhile</code> returns elements from a sequence as long as the condition is true</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> list <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">TakeWhile</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item <span class="token operator">&lt;</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// result = { 1, 10, 40 }</span>

</code></pre></div><h2 id="build-your-own-linq-operators-for-ienumerable"><a href="#build-your-own-linq-operators-for-ienumerable" class="header-anchor">#</a> Build your own Linq operators for IEnumerable<T></T></h2> <p>One of the great things about Linq is that it is so easy to extend.  You just need to create an <a href="http://stackoverflow.com/documentation/c%23/20/extension-methods/33/using-an-extension-method#t=201607280952261411896" target="_blank" rel="noopener noreferrer">extension method<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> whose argument is <code>IEnumerable&lt;T&gt;</code>.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">namespace</span> <span class="token namespace">MyNamespace</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">LinqExtensions</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>List<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">Batch</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> source<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> batchSize<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> batch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">T</span> item <span class="token keyword">in</span> source<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                batch<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>batch<span class="token punctuation">.</span>Count <span class="token operator">==</span> batchSize<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">yield</span> <span class="token keyword">return</span> batch<span class="token punctuation">;</span>
                    batch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>batch<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">yield</span> <span class="token keyword">return</span> batch<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>This example splits the items in an <code>IEnumerable&lt;T&gt;</code> into lists of a fixed size, the last list containing the remainder of the items. Notice how the object to which the extension method is applied is passed in (argument <code>source</code>) as the initial argument using the <code>this</code> keyword. Then the <code>yield</code> keyword is used to output the next item in the output <code>IEnumerable&lt;T&gt;</code> before continuing with execution from that point (see <a href="http://stackoverflow.com/documentation/c%23/61/yield-keyword#t=201607281004094832778" target="_blank" rel="noopener noreferrer">yield keyword<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</p> <p>This example would be used in your code like this:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">//using MyNamespace;</span>
<span class="token class-name"><span class="token keyword">var</span></span> items <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> sublist <span class="token keyword">in</span> items<span class="token punctuation">.</span><span class="token function">Batch</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// do something</span>
<span class="token punctuation">}</span>

</code></pre></div><p>On the first loop, sublist would be <code>{2, 3, 4}</code> and on the second <code>{5, 6}</code>.</p> <p>Custom LinQ methods can be combined with standard LinQ methods too. e.g.:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">//using MyNamespace;</span>
<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> Enumerable<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span>         <span class="token comment">// generate a list</span>
                       <span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// filter the list or do something other</span>
                       <span class="token punctuation">.</span><span class="token function">Batch</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>             <span class="token comment">// call our extension method</span>
                       <span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>             <span class="token comment">// call other standard methods</span>

</code></pre></div><p>This query will return even numbers grouped in batches with a size of 3: <code>{0, 2, 4}, {6, 8, 10}, {12}</code></p> <p>Remember you need a <code>using MyNamespace;</code> line in order to be able to access the extension method.</p> <h2 id="reverse"><a href="#reverse" class="header-anchor">#</a> Reverse</h2> <ul><li>Inverts the order of the elements in a sequence.</li> <li>If there is no items throws a <code>ArgumentNullException: source is null.</code></li></ul> <p><strong><strong>Example:</strong></strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token comment">// Create an array.</span>
<span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> array <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>                         <span class="token comment">//Output:</span>
<span class="token comment">// Call reverse extension method on the array.        //4</span>
<span class="token class-name"><span class="token keyword">var</span></span> reverse <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">Reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">//3</span>
<span class="token comment">// Write contents of array to screen.                 //2</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> <span class="token keyword">value</span> <span class="token keyword">in</span> reverse<span class="token punctuation">)</span>                        <span class="token comment">//1</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><a href="https://dotnetfiddle.net/ckrWUo" target="_blank" rel="noopener noreferrer">Live code example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Remeber that <code>Reverse()</code> may work diffrent depending on the chain order of your LINQ statements.</p> <div class="language-cs extra-class"><pre class="language-cs"><code>
       <span class="token comment">//Create List of chars</span>
        <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> integerlist <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">//Reversing the list then taking the two first elements</span>
        <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> reverseFirst <span class="token operator">=</span> integerlist<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Reverse</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//Taking 2 elements and then reversing only thos two</span>
        <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> reverseLast <span class="token operator">=</span> integerlist<span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//reverseFirst output: 6, 5</span>
        <span class="token comment">//reverseLast output:  2, 1</span>

</code></pre></div><p><a href="https://dotnetfiddle.net/ckrWUo" target="_blank" rel="noopener noreferrer">Live code example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>Reverse()</strong> works by buffering everything then walk through it backwards, whitch is not very efficient, but neither is OrderBy from that perspective.</p> <p>In LINQ-to-Objects, there are buffering operations (Reverse, OrderBy, GroupBy, etc) and non-buffering operations (Where, Take, Skip, etc).</p> <p><strong><strong>Example: Non-buffering Reverse extention</strong></strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">Reverse</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IList<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> list<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> 
        <span class="token keyword">yield</span> <span class="token keyword">return</span> list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><a href="https://dotnetfiddle.net/ckrWUo" target="_blank" rel="noopener noreferrer">Live code example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>This method can encounter problems if u mutate the list while iterating.</p> <h2 id="orderbydescending"><a href="#orderbydescending" class="header-anchor">#</a> OrderByDescending</h2> <blockquote></blockquote> <p>Orders a collection by a specified value.</p> <p>When the value is an <strong>integer</strong>, <strong>double</strong> or <strong>float</strong> it starts with the <strong>maximal value</strong>, which means that you get first the positive values, than zero and afterwords the negative values (see Example 1).</p> <p>When you order by a <strong>char</strong> the method compares the <strong>ascii values</strong> of the chars to sort the collection (see Example 2).</p> <p>When you sort <strong>strings</strong> the OrderBy method compares them by taking a look at their <a href="https://msdn.microsoft.com/en-us/library/xk2wykcz(VS.71).aspx" target="_blank" rel="noopener noreferrer">CultureInfo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> but normaly starting with the <strong>last letter</strong> in the alphabet (z,y,x,...).</p> <p>This kind of order is called descending, if you want it the other way round you need ascending (see OrderBy).</p> <p><strong>Example 1:</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">descending</span> <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">OrderByDescending</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// returns {2, 1, 0, -1, -2}</span>

</code></pre></div><p><strong>Example 2:</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> letters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string character">' '</span><span class="token punctuation">,</span> <span class="token string character">'!'</span><span class="token punctuation">,</span> <span class="token string character">'?'</span><span class="token punctuation">,</span> <span class="token string character">'['</span><span class="token punctuation">,</span> <span class="token string character">'{'</span><span class="token punctuation">,</span> <span class="token string character">'+'</span><span class="token punctuation">,</span> <span class="token string character">'1'</span><span class="token punctuation">,</span> <span class="token string character">'9'</span><span class="token punctuation">,</span> <span class="token string character">'a'</span><span class="token punctuation">,</span> <span class="token string character">'A'</span><span class="token punctuation">,</span> <span class="token string character">'b'</span><span class="token punctuation">,</span> <span class="token string character">'B'</span><span class="token punctuation">,</span> <span class="token string character">'y'</span><span class="token punctuation">,</span> <span class="token string character">'Y'</span><span class="token punctuation">,</span> <span class="token string character">'z'</span><span class="token punctuation">,</span> <span class="token string character">'Z'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">char</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">descending</span> <span class="token operator">=</span> letters<span class="token punctuation">.</span><span class="token function">OrderByDescending</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// returns { '{', 'z', 'y', 'b', 'a', '[', 'Z', 'Y', 'B', 'A', '?', '9', '1', '+', '!', ' ' }</span>

</code></pre></div><p><strong>Example 3:</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
   <span class="token keyword">public</span>  <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">public</span>  <span class="token return-type class-name"><span class="token keyword">int</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name"><span class="token keyword">var</span></span> people <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span>Name <span class="token operator">=</span> <span class="token string">&quot;Alice&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span>Name <span class="token operator">=</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span>Name <span class="token operator">=</span> <span class="token string">&quot;Carol&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">43</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> oldestPerson <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">OrderByDescending</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Age<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> name <span class="token operator">=</span> oldestPerson<span class="token punctuation">.</span>Name<span class="token punctuation">;</span> <span class="token comment">// Carol</span>

</code></pre></div><h2 id="concat"><a href="#concat" class="header-anchor">#</a> Concat</h2> <p>Merges two collections (without removing duplicates)</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> bar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Through Enumerable static class</span>
<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> Enumerable<span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> bar<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1,2,3,3,4,5</span>

<span class="token comment">// Through extension method</span>
<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> foo<span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1,2,3,3,4,5</span>

</code></pre></div><h2 id="select-with-func-tsource-int-tresult-selector-use-to-get-ranking-of-elements"><a href="#select-with-func-tsource-int-tresult-selector-use-to-get-ranking-of-elements" class="header-anchor">#</a> Select with Func&lt;TSource, int, TResult&gt; selector - Use to get ranking of elements</h2> <p>On of the overloads of the <code>Select</code> extension methods also passes the <code>index</code> of the current item in the collection being <code>select</code>ed. These are a few uses of it.</p> <p><strong>Get the &quot;row number&quot; of the items</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> rowNumbers <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>Property1<span class="token punctuation">)</span>
                           <span class="token punctuation">.</span><span class="token function">ThenBy</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>Property2<span class="token punctuation">)</span>
                           <span class="token punctuation">.</span><span class="token function">ThenByDescending</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>Property3<span class="token punctuation">)</span>
                           <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Item <span class="token operator">=</span> item<span class="token punctuation">,</span> RowNumber <span class="token operator">=</span> index <span class="token punctuation">}</span><span class="token punctuation">)</span>
                           <span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Get the rank of an item <strong>within</strong> its group</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> rankInGroup <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>Property1<span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span><span class="token keyword">group</span> <span class="token operator">=&gt;</span> <span class="token keyword">group</span><span class="token punctuation">.</span>Key<span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span><span class="token keyword">group</span> <span class="token operator">=&gt;</span> <span class="token keyword">group</span><span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>Property2<span class="token punctuation">)</span>
                                                   <span class="token punctuation">.</span><span class="token function">ThenByDescending</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>Property3<span class="token punctuation">)</span>
                                                   <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> 
                                                   <span class="token punctuation">{</span> 
                                                       Item <span class="token operator">=</span> item<span class="token punctuation">,</span> 
                                                       RankInGroup <span class="token operator">=</span> index 
                                                   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Get the ranking of groups (also known in Oracle as dense_rank)</strong></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name"><span class="token keyword">var</span></span> rankOfBelongingGroup <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>Property1<span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span><span class="token keyword">group</span> <span class="token operator">=&gt;</span> <span class="token keyword">group</span><span class="token punctuation">.</span>Key<span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">group</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span>
                            <span class="token punctuation">{</span>
                                Items <span class="token operator">=</span> <span class="token keyword">group</span><span class="token punctuation">,</span>
                                Rank <span class="token operator">=</span> index
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>Items<span class="token punctuation">,</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span>
                            <span class="token punctuation">{</span>
                                Item <span class="token operator">=</span> i<span class="token punctuation">,</span>
                                DenseRank <span class="token operator">=</span> s<span class="token punctuation">.</span>Rank
                            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>For testing this you can use:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SomeObject</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Property1 <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Property2 <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Property3 <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">,</span> Property1<span class="token punctuation">,</span> Property2<span class="token punctuation">,</span> Property3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>And data:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token class-name">List<span class="token punctuation">&lt;</span>SomeObject<span class="token punctuation">&gt;</span></span> collection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>SomeObject<span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SomeObject</span> <span class="token punctuation">{</span> Property1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Property2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Property3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SomeObject</span> <span class="token punctuation">{</span> Property1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Property2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Property3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SomeObject</span> <span class="token punctuation">{</span> Property1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Property2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Property3 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SomeObject</span> <span class="token punctuation">{</span> Property1 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Property2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Property3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SomeObject</span> <span class="token punctuation">{</span> Property1 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Property2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Property3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SomeObject</span> <span class="token punctuation">{</span> Property1 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Property2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Property3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SomeObject</span> <span class="token punctuation">{</span> Property1 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Property2 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> Property3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <li>
Query syntax :
<ul>
- from <range variable=""> in <collection>
- [from <range variable=""> in <collection>, ...]
- <filter ,="" joining,="" grouping,="" aggregate="" operators,="" ...=""><lambda expression="">
- <select or="" groupBy="" operator=""><formulate the="" result=""><p>Method syntax :</p> <ul><li>Enumerable.Aggregate(func)</li> <li>Enumerable.Aggregate(seed, func)</li> <li>Enumerable.Aggregate(seed, func, resultSelector)</li> <li>Enumerable.All(predicate)</li> <li>Enumerable.Any()</li> <li>Enumerable.Any(predicate)</li> <li>Enumerable.AsEnumerable()</li> <li>Enumerable.Average()</li> <li>Enumerable.Average(selector)</li> <li>Enumerable.Cast<Result>()</Result></li> <li>Enumerable.Concat(second)</li> <li>Enumerable.Contains(value)</li> <li>Enumerable.Contains(value, comparer)</li> <li>Enumerable.Count()</li> <li>Enumerable.Count(predicate)</li> <li>Enumerable.DefaultIfEmpty()</li> <li>Enumerable.DefaultIfEmpty(defaultValue)</li> <li>Enumerable.Distinct()</li> <li>Enumerable.Distinct(comparer)</li> <li>Enumerable.ElementAt(index)</li> <li>Enumerable.ElementAtOrDefault(index)</li> <li>Enumerable.Empty()</li> <li>Enumerable.Except(second)</li> <li>Enumerable.Except(second, comparer)</li> <li>Enumerable.First()</li> <li>Enumerable.First(predicate)</li> <li>Enumerable.FirstOrDefault()</li> <li>Enumerable.FirstOrDefault(predicate)</li> <li>Enumerable.GroupBy(keySelector)</li> <li>Enumerable.GroupBy(keySelector, resultSelector)</li> <li>Enumerable.GroupBy(keySelector, elementSelector)</li> <li>Enumerable.GroupBy(keySelector, comparer)</li> <li>Enumerable.GroupBy(keySelector, resultSelector, comparer)</li> <li>Enumerable.GroupBy(keySelector, elementSelector, resultSelector)</li> <li>Enumerable.GroupBy(keySelector, elementSelector, comparer)</li> <li>Enumerable.GroupBy(keySelector, elementSelector, resultSelector, comparer)</li> <li>Enumerable.Intersect(second)</li> <li>Enumerable.Intersect(second, comparer)</li> <li>Enumerable.Join(inner, outerKeySelector, innerKeySelector, resultSelector)</li> <li>Enumerable.Join(inner, outerKeySelector, innerKeySelector, resultSelector, comparer)</li> <li>Enumerable.Last()</li> <li>Enumerable.Last(predicate)</li> <li>Enumerable.LastOrDefault()</li> <li>Enumerable.LastOrDefault(predicate)</li> <li>Enumerable.LongCount()</li> <li>Enumerable.LongCount(predicate)</li> <li>Enumerable.Max()</li> <li>Enumerable.Max(selector)</li> <li>Enumerable.Min()</li> <li>Enumerable.Min(selector)</li> <li>Enumerable.OfType<TResult>()</TResult></li> <li>Enumerable.OrderBy(keySelector)</li> <li>Enumerable.OrderBy(keySelector, comparer)</li> <li>Enumerable.OrderByDescending(keySelector)</li> <li>Enumerable.OrderByDescending(keySelector, comparer)</li> <li>Enumerable.Range(start, count)</li> <li>Enumerable.Repeat(element, count)</li> <li>Enumerable.Reverse()</li> <li>Enumerable.Select(selector)</li> <li>Enumerable.SelectMany(selector)</li> <li>Enumerable.SelectMany(collectionSelector, resultSelector)</li> <li>Enumerable.SequenceEqual(second)</li> <li>Enumerable.SequenceEqual(second, comparer)</li> <li>Enumerable.Single()</li> <li>Enumerable.Single(predicate)</li> <li>Enumerable.SingleOrDefault()</li> <li>Enumerable.SingleOrDefault(predicate)</li> <li>Enumerable.Skip(count)</li> <li>Enumerable.SkipWhile(predicate)</li> <li>Enumerable.Sum()</li> <li>Enumerable.Sum(selector)</li> <li>Enumerable.Take(count)</li> <li>Enumerable.TakeWhile(predicate)</li> <li>orderedEnumerable.ThenBy(keySelector)</li> <li>orderedEnumerable.ThenBy(keySelector, comparer)</li> <li>orderedEnumerable.ThenByDescending(keySelector)</li> <li>orderedEnumerable.ThenByDescending(keySelector, comparer)</li> <li>Enumerable.ToArray()</li> <li>Enumerable.ToDictionary(keySelector)</li> <li>Enumerable.ToDictionary(keySelector, elementSelector)</li> <li>Enumerable.ToDictionary(keySelector, comparer)</li> <li>Enumerable.ToDictionary(keySelector, elementSelector, comparer)</li> <li>Enumerable.ToList()</li> <li>Enumerable.ToLookup(keySelector)</li> <li>Enumerable.ToLookup(keySelector, elementSelector)</li> <li>Enumerable.ToLookup(keySelector, comparer)</li> <li>Enumerable.ToLookup(keySelector, elementSelector, comparer)</li> <li>Enumerable.Union(second)</li> <li>Enumerable.Union(second, comparer)</li> <li>Enumerable.Where(predicate)</li> <li>Enumerable.Zip(second, resultSelector)</li></ul> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>To use LINQ queries you need to import <code>System.Linq</code>.</p> <p>The Method Syntax is more powerful and flexible, but the Query Syntax may be simpler and more familiar. All queries written in Query syntax are translated into the functional syntax by the compiler, so performance is the same.</p> <p>Query objects are not evaluated until they are used, so they can be changed or added to without a performance penalty.</p></formulate></select></lambda></filter></collection></range></collection></range></ul></li></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/csharp/linq-queries.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/csharp/linq-to-objects.html" class="prev">
        Linq to Objects
      </a></span> <span class="next"><a href="/csharp/linq-to-xml.html">
        LINQ to XML
      </a>
      
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/849.e4911896.js" defer></script>
  </body>
</html>
