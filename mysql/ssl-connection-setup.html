<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL - SSL Connection Setup</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Setup for Debian-based systems, Setup for CentOS7 / RHEL7">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="MySQL - SSL Connection Setup">
    <meta property="og:description" content="Setup for Debian-based systems, Setup for CentOS7 / RHEL7">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/mysql/ssl-connection-setup.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="MySQL - SSL Connection Setup">
    <meta name="twitter:description" content="Setup for Debian-based systems, Setup for CentOS7 / RHEL7">
    <meta name="twitter:url" content="/mysql/ssl-connection-setup.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2149.4f3a83af.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MySQL</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mysql/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/mysql/getting-started-with-mysql.html" class="sidebar-link">Getting started with MySQL</a></li><li><a href="/mysql/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/mysql/select.html" class="sidebar-link">SELECT</a></li><li><a href="/mysql/backticks.html" class="sidebar-link">Backticks</a></li><li><a href="/mysql/null.html" class="sidebar-link">NULL</a></li><li><a href="/mysql/limit-and-offset.html" class="sidebar-link">Limit and Offset</a></li><li><a href="/mysql/creating-databases.html" class="sidebar-link">Creating databases</a></li><li><a href="/mysql/using-variables.html" class="sidebar-link">Using Variables</a></li><li><a href="/mysql/comment-mysql.html" class="sidebar-link">Comment Mysql</a></li><li><a href="/mysql/insert.html" class="sidebar-link">INSERT</a></li><li><a href="/mysql/delete.html" class="sidebar-link">DELETE</a></li><li><a href="/mysql/update.html" class="sidebar-link">UPDATE</a></li><li><a href="/mysql/order-by.html" class="sidebar-link">ORDER BY</a></li><li><a href="/mysql/group-by.html" class="sidebar-link">Group By</a></li><li><a href="/mysql/error-1055-only-full-group-by-something-is-not-in-group-by-clause.html" class="sidebar-link">Error 1055: ONLYFULLGROUP_BY: something  is not in GROUP BY clause ...</a></li><li><a href="/mysql/joins.html" class="sidebar-link">Joins</a></li><li><a href="/mysql/joins-join-3-table-with-the-same-name-of-id.html" class="sidebar-link">JOINS: Join 3 table with the same name of id.</a></li><li><a href="/mysql/union.html" class="sidebar-link">UNION</a></li><li><a href="/mysql/arithmetic.html" class="sidebar-link">Arithmetic</a></li><li><a href="/mysql/string-operations.html" class="sidebar-link">String operations</a></li><li><a href="/mysql/date-and-time-operations.html" class="sidebar-link">Date and Time Operations</a></li><li><a href="/mysql/handling-time-zones.html" class="sidebar-link">Handling Time Zones</a></li><li><a href="/mysql/regular-expressions.html" class="sidebar-link">Regular Expressions</a></li><li><a href="/mysql/view.html" class="sidebar-link">VIEW</a></li><li><a href="/mysql/table-creation.html" class="sidebar-link">Table Creation</a></li><li><a href="/mysql/alter-table.html" class="sidebar-link">ALTER TABLE</a></li><li><a href="/mysql/drop-table.html" class="sidebar-link">Drop Table</a></li><li><a href="/mysql/mysql-lock-table.html" class="sidebar-link">MySQL LOCK TABLE</a></li><li><a href="/mysql/error-codes.html" class="sidebar-link">Error codes</a></li><li><a href="/mysql/stored-routines-procedures-and-functions.html" class="sidebar-link">Stored routines (procedures and functions)</a></li><li><a href="/mysql/indexes-and-keys.html" class="sidebar-link">Indexes and Keys</a></li><li><a href="/mysql/full-text-search.html" class="sidebar-link">Full-Text search</a></li><li><a href="/mysql/prepare-statements.html" class="sidebar-link">PREPARE Statements</a></li><li><a href="/mysql/json.html" class="sidebar-link">JSON</a></li><li><a href="/mysql/extract-values-from-json-type.html" class="sidebar-link">Extract values from JSON type</a></li><li><a href="/mysql/mysql-admin.html" class="sidebar-link">MySQL Admin</a></li><li><a href="/mysql/triggers.html" class="sidebar-link">TRIGGERS</a></li><li><a href="/mysql/configuration-and-tuning.html" class="sidebar-link">Configuration and tuning</a></li><li><a href="/mysql/events.html" class="sidebar-link">Events</a></li><li><a href="/mysql/enum.html" class="sidebar-link">ENUM</a></li><li><a href="/mysql/install-mysql-container-with-docker-compose.html" class="sidebar-link">Install Mysql container with Docker-Compose</a></li><li><a href="/mysql/character-sets-and-collations.html" class="sidebar-link">Character Sets and Collations</a></li><li><a href="/mysql/myisam-engine.html" class="sidebar-link">MyISAM Engine</a></li><li><a href="/mysql/converting-from-myisam-to-innodb.html" class="sidebar-link">Converting from MyISAM to InnoDB</a></li><li><a href="/mysql/transaction.html" class="sidebar-link">Transaction</a></li><li><a href="/mysql/log-files.html" class="sidebar-link">Log files</a></li><li><a href="/mysql/clustering.html" class="sidebar-link">Clustering</a></li><li><a href="/mysql/partitioning.html" class="sidebar-link">Partitioning</a></li><li><a href="/mysql/replication.html" class="sidebar-link">Replication</a></li><li><a href="/mysql/backup-using-mysqldump.html" class="sidebar-link">Backup using mysqldump</a></li><li><a href="/mysql/mysqlimport.html" class="sidebar-link">mysqlimport</a></li><li><a href="/mysql/load-data-infile.html" class="sidebar-link">LOAD DATA INFILE</a></li><li><a href="/mysql/mysql-unions.html" class="sidebar-link">MySQL Unions</a></li><li><a href="/mysql/mysql-client.html" class="sidebar-link">MySQL client</a></li><li><a href="/mysql/temporary-tables.html" class="sidebar-link">Temporary Tables</a></li><li><a href="/mysql/customize-ps1.html" class="sidebar-link">Customize PS1</a></li><li><a href="/mysql/dealing-with-sparse-or-missing-data.html" class="sidebar-link">Dealing with sparse or missing data</a></li><li><a href="/mysql/connecting-with-utf-8-using-various-programming-language.html" class="sidebar-link">Connecting with UTF-8 Using Various Programming language.</a></li><li><a href="/mysql/time-with-subsecond-precision.html" class="sidebar-link">Time with subsecond precision</a></li><li><a href="/mysql/one-to-many.html" class="sidebar-link">One to Many</a></li><li><a href="/mysql/many-to-many-mapping-table.html" class="sidebar-link">Many-to-many Mapping table</a></li><li><a href="/mysql/pivot-queries.html" class="sidebar-link">Pivot queries</a></li><li><a href="/mysql/dynamic-un-pivot-table-using-prepared-statement.html" class="sidebar-link">Dynamic Un-Pivot Table using Prepared Statement</a></li><li><a href="/mysql/server-information.html" class="sidebar-link">Server Information</a></li><li><a href="/mysql/ssl-connection-setup.html" aria-current="page" class="active sidebar-link">SSL Connection Setup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mysql/ssl-connection-setup.html#setup-for-debian-based-systems" class="sidebar-link">Setup for Debian-based systems</a></li><li class="sidebar-sub-header"><a href="/mysql/ssl-connection-setup.html#setup-for-centos7-rhel7" class="sidebar-link">Setup for CentOS7 / RHEL7</a></li></ul></li><li><a href="/mysql/create-new-user.html" class="sidebar-link">Create New User</a></li><li><a href="/mysql/security-via-grants.html" class="sidebar-link">Security via GRANTs</a></li><li><a href="/mysql/change-password.html" class="sidebar-link">Change Password</a></li><li><a href="/mysql/recover-and-reset-the-default-root-password-for-mysql-5-7.html" class="sidebar-link">Recover and reset the default root password for MySQL 5.7+</a></li><li><a href="/mysql/recover-from-lost-root-password.html" class="sidebar-link">Recover from lost root password</a></li><li><a href="/mysql/mysql-performance-tips.html" class="sidebar-link">Mysql Performance Tips</a></li><li><a href="/mysql/performance-tuning.html" class="sidebar-link">Performance Tuning</a></li><li><a href="/mysql/reserved-words.html" class="sidebar-link">Reserved Words</a></li><li><a href="/mysql/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ssl-connection-setup"><a href="#ssl-connection-setup" class="header-anchor">#</a> SSL Connection Setup</h1> <h2 id="setup-for-debian-based-systems"><a href="#setup-for-debian-based-systems" class="header-anchor">#</a> Setup for Debian-based systems</h2> <p>(This assumes MySQL has been installed and that <code>sudo</code> is being used.)</p> <h3 id="generating-a-ca-and-ssl-keys"><a href="#generating-a-ca-and-ssl-keys" class="header-anchor">#</a> Generating a CA and SSL keys</h3> <p>Make sure OpenSSL and libraries are installed:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>apt<span class="token operator">-</span>get <span class="token operator">-</span>y install openssl
apt<span class="token operator">-</span>get <span class="token operator">-</span>y install libssl<span class="token operator">-</span>dev

</code></pre></div><p>Next make and enter a directory for the SSL files:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mkdir <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts
cd <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts

</code></pre></div><p>To generate keys, create a certificate authority (CA) to sign the keys (self-signed):</p> <div class="language-sql extra-class"><pre class="language-sql"><code>openssl genrsa <span class="token number">2048</span> <span class="token operator">&gt;</span> ca<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem
openssl req <span class="token operator">-</span>new <span class="token operator">-</span>x509 <span class="token operator">-</span>nodes <span class="token operator">-</span>days <span class="token number">3600</span> <span class="token operator">-</span><span class="token keyword">key</span> ca<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span><span class="token keyword">out</span> ca<span class="token punctuation">.</span>pem

</code></pre></div><p>The values entered at each prompt won't affect the configuration. Next create a key for the server, and sign using the CA from before:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>openssl req <span class="token operator">-</span>newkey rsa:<span class="token number">2048</span> <span class="token operator">-</span>days <span class="token number">3600</span> <span class="token operator">-</span>nodes <span class="token operator">-</span>keyout server<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span><span class="token keyword">out</span> server<span class="token operator">-</span>req<span class="token punctuation">.</span>pem
openssl rsa <span class="token operator">-</span><span class="token operator">in</span> server<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span><span class="token keyword">out</span> server<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem

openssl x509 <span class="token operator">-</span>req <span class="token operator">-</span><span class="token operator">in</span> server<span class="token operator">-</span>req<span class="token punctuation">.</span>pem <span class="token operator">-</span>days <span class="token number">3600</span> <span class="token operator">-</span>CA ca<span class="token punctuation">.</span>pem <span class="token operator">-</span>CAkey ca<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span>set_serial <span class="token number">01</span> <span class="token operator">-</span><span class="token keyword">out</span> server<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem

</code></pre></div><p>Then create a key for a client:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>openssl req <span class="token operator">-</span>newkey rsa:<span class="token number">2048</span> <span class="token operator">-</span>days <span class="token number">3600</span> <span class="token operator">-</span>nodes <span class="token operator">-</span>keyout client<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span><span class="token keyword">out</span> client<span class="token operator">-</span>req<span class="token punctuation">.</span>pem
openssl rsa <span class="token operator">-</span><span class="token operator">in</span> client<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span><span class="token keyword">out</span> client<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem
openssl x509 <span class="token operator">-</span>req <span class="token operator">-</span><span class="token operator">in</span> client<span class="token operator">-</span>req<span class="token punctuation">.</span>pem <span class="token operator">-</span>days <span class="token number">3600</span> <span class="token operator">-</span>CA ca<span class="token punctuation">.</span>pem <span class="token operator">-</span>CAkey ca<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span>set_serial <span class="token number">01</span> <span class="token operator">-</span><span class="token keyword">out</span> client<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem

</code></pre></div><p>To make sure everything was set up correctly, verify the keys:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>openssl verify <span class="token operator">-</span>CAfile ca<span class="token punctuation">.</span>pem server<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem client<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem

</code></pre></div><h3 id="adding-the-keys-to-mysql"><a href="#adding-the-keys-to-mysql" class="header-anchor">#</a> Adding the keys to MySQL</h3> <p>Open the <a href="http://stackoverflow.com/documentation/mysql/3134/configuration-and-tuning/25294/minimal-innodb-configuration#t=201611070613476171669" target="_blank" rel="noopener noreferrer">MySQL configuration file<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. For example:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>vim <span class="token operator">/</span>etc<span class="token operator">/</span>mysql<span class="token operator">/</span>mysql<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>cnf

</code></pre></div><p>Under the <code>[mysqld]</code> section, add the following options:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>ssl<span class="token operator">-</span>ca <span class="token operator">=</span> <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts<span class="token operator">/</span>ca<span class="token punctuation">.</span>pem
ssl<span class="token operator">-</span>cert <span class="token operator">=</span> <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts<span class="token operator">/</span>server<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem
ssl<span class="token operator">-</span><span class="token keyword">key</span> <span class="token operator">=</span> <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts<span class="token operator">/</span>server<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem

</code></pre></div><p>Restart MySQL. For example:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>service mysql restart

</code></pre></div><h3 id="test-the-ssl-connection"><a href="#test-the-ssl-connection" class="header-anchor">#</a> Test the SSL connection</h3> <p>Connect in the same way, passing in the extra options <code>ssl-ca</code>, <code>ssl-cert</code>, and <code>ssl-key</code>, using the generated client key. For example, assuming <code>cd /home/ubuntu/mysqlcerts</code>:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql <span class="token comment">--ssl-ca=ca.pem --ssl-cert=client-cert.pem --ssl-key=client-key.pem -h 127.0.0.1 -u superman -p</span>

</code></pre></div><p>After logging in, verify the connection is indeed secure:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>superman<span class="token variable">@127.0.0.1</span> <span class="token punctuation">[</span>None<span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%ssl%'</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------+-----------------------------------------+</span>
<span class="token operator">|</span> Variable_name <span class="token operator">|</span> <span class="token keyword">Value</span>                                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------+-----------------------------------------+</span>
<span class="token operator">|</span> have_openssl  <span class="token operator">|</span> YES                                     <span class="token operator">|</span>
<span class="token operator">|</span> have_ssl      <span class="token operator">|</span> YES                                     <span class="token operator">|</span>
<span class="token operator">|</span> ssl_ca        <span class="token operator">|</span> <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts<span class="token operator">/</span>ca<span class="token punctuation">.</span>pem          <span class="token operator">|</span>
<span class="token operator">|</span> ssl_capath    <span class="token operator">|</span>                                         <span class="token operator">|</span>
<span class="token operator">|</span> ssl_cert      <span class="token operator">|</span> <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts<span class="token operator">/</span>server<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem <span class="token operator">|</span>
<span class="token operator">|</span> ssl_cipher    <span class="token operator">|</span>                                         <span class="token operator">|</span>
<span class="token operator">|</span> ssl_crl       <span class="token operator">|</span>                                         <span class="token operator">|</span>
<span class="token operator">|</span> ssl_crlpath   <span class="token operator">|</span>                                         <span class="token operator">|</span>
<span class="token operator">|</span> ssl_key       <span class="token operator">|</span> <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts<span class="token operator">/</span>server<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------+-----------------------------------------+</span>

</code></pre></div><p>You could also check:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>superman<span class="token variable">@127.0.0.1</span> <span class="token punctuation">[</span>None<span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token keyword">STATUS</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
SSL:                    Cipher <span class="token operator">in</span> <span class="token keyword">use</span> <span class="token operator">is</span> DHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES256<span class="token operator">-</span>SHA
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

</code></pre></div><h3 id="enforcing-ssl"><a href="#enforcing-ssl" class="header-anchor">#</a> Enforcing SSL</h3> <p>This is via <code>GRANT</code>, using <code>REQUIRE SSL</code>:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'superman'</span><span class="token variable">@'127.0.0.1'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'pass'</span> <span class="token keyword">REQUIRE</span> SSL<span class="token punctuation">;</span>
FLUSH <span class="token keyword">PRIVILEGES</span><span class="token punctuation">;</span>

</code></pre></div><p>Now, <code>superman</code> <strong>must</strong> connect via SSL.</p> <p>If you don't want to manage client keys, use the client key from earlier and automatically use that for all clients. Open <a href="http://stackoverflow.com/documentation/mysql/3134/configuration-and-tuning/25294/minimal-innodb-configuration#t=201611070613476171669" target="_blank" rel="noopener noreferrer">MySQL configuration file<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, for example:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>vim <span class="token operator">/</span>etc<span class="token operator">/</span>mysql<span class="token operator">/</span>mysql<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>cnf

</code></pre></div><p>Under the <code>[client]</code> section, add the following options:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>ssl<span class="token operator">-</span>ca <span class="token operator">=</span> <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts<span class="token operator">/</span>ca<span class="token punctuation">.</span>pem
ssl<span class="token operator">-</span>cert <span class="token operator">=</span> <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts<span class="token operator">/</span>client<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem
ssl<span class="token operator">-</span><span class="token keyword">key</span> <span class="token operator">=</span> <span class="token operator">/</span>home<span class="token operator">/</span>ubuntu<span class="token operator">/</span>mysqlcerts<span class="token operator">/</span>client<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem

</code></pre></div><p>Now <code>superman</code> only has to type the following to login via SSL:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql <span class="token operator">-</span>h <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">-</span>u superman <span class="token operator">-</span>p

</code></pre></div><p>Connecting from another program, for example in Python, typically only requires an additional parameter to the connect function. A Python example:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">import</span> MySQLdb
ssl <span class="token operator">=</span> {<span class="token string">'cert'</span>: <span class="token string">'/home/ubuntu/mysqlcerts/client-cert.pem'</span><span class="token punctuation">,</span> <span class="token string">'key'</span>: <span class="token string">'/home/ubuntu/mysqlcerts/client-key.pem'</span>}
conn <span class="token operator">=</span> MySQLdb<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'superman'</span><span class="token punctuation">,</span> passwd<span class="token operator">=</span><span class="token string">'imsoawesome'</span><span class="token punctuation">,</span> ssl<span class="token operator">=</span>ssl<span class="token punctuation">)</span>

</code></pre></div><h3 id="references-and-further-reading"><a href="#references-and-further-reading" class="header-anchor">#</a> References and further reading:</h3> <ul><li><a href="https://www.percona.com/blog/2013/06/22/setting-up-mysql-ssl-and-secure-connections/" target="_blank" rel="noopener noreferrer">https://www.percona.com/blog/2013/06/22/setting-up-mysql-ssl-and-secure-connections/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://lowendbox.com/blog/getting-started-with-mysql-over-ssl/" target="_blank" rel="noopener noreferrer">https://lowendbox.com/blog/getting-started-with-mysql-over-ssl/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://xmodulo.com/enable-ssl-mysql-server-client.html" target="_blank" rel="noopener noreferrer">http://xmodulo.com/enable-ssl-mysql-server-client.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://ubuntuforums.org/showthread.php?t=1121458" target="_blank" rel="noopener noreferrer">https://ubuntuforums.org/showthread.php?t=1121458<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="setup-for-centos7-rhel7"><a href="#setup-for-centos7-rhel7" class="header-anchor">#</a> Setup for CentOS7 / RHEL7</h2> <p>This example assumes two servers:</p> <ol><li>dbserver  (where our database lives)</li> <li>appclient    (where our applications live)</li></ol> <p><strong>FWIW, both servers are SELinux enforcing.</strong></p> <h3 id="first-log-on-to-dbserver"><a href="#first-log-on-to-dbserver" class="header-anchor">#</a> First, log on to dbserver</h3> <p>Create a temporary directory for creating the certificates.</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mkdir <span class="token operator">/</span>root<span class="token operator">/</span>certs<span class="token operator">/</span>mysql<span class="token operator">/</span> <span class="token operator">&amp;&amp;</span> cd <span class="token operator">/</span>root<span class="token operator">/</span>certs<span class="token operator">/</span>mysql<span class="token operator">/</span>

</code></pre></div><p>Create the server certificates</p> <div class="language-sql extra-class"><pre class="language-sql"><code>openssl genrsa <span class="token number">2048</span> <span class="token operator">&gt;</span> ca<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem
openssl req <span class="token operator">-</span>sha1 <span class="token operator">-</span>new <span class="token operator">-</span>x509 <span class="token operator">-</span>nodes <span class="token operator">-</span>days <span class="token number">3650</span> <span class="token operator">-</span><span class="token keyword">key</span> ca<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">&gt;</span> ca<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem
openssl req <span class="token operator">-</span>sha1 <span class="token operator">-</span>newkey rsa:<span class="token number">2048</span> <span class="token operator">-</span>days <span class="token number">730</span> <span class="token operator">-</span>nodes <span class="token operator">-</span>keyout server<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">&gt;</span> server<span class="token operator">-</span>req<span class="token punctuation">.</span>pem
openssl rsa <span class="token operator">-</span><span class="token operator">in</span> server<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span><span class="token keyword">out</span> server<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem
openssl x509 <span class="token operator">-</span>sha1 <span class="token operator">-</span>req <span class="token operator">-</span><span class="token operator">in</span> server<span class="token operator">-</span>req<span class="token punctuation">.</span>pem <span class="token operator">-</span>days <span class="token number">730</span>  <span class="token operator">-</span>CA ca<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem <span class="token operator">-</span>CAkey ca<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span>set_serial <span class="token number">01</span> <span class="token operator">&gt;</span> server<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem

</code></pre></div><p>Move server certificates to /etc/pki/tls/certs/mysql/</p> <p>Directory path assumes CentOS or RHEL (adjust as needed for other distros):</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mkdir <span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql<span class="token operator">/</span>

</code></pre></div><p>Be sure to set permissions on the folder and files.  mysql needs full ownership and access.</p> <div class="language-sql extra-class"><pre class="language-sql"><code>chown <span class="token operator">-</span>R mysql:mysql <span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql

</code></pre></div><p>Now configure MySQL/MariaDB</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># vi /etc/my.cnf</span>
<span class="token comment"># i</span>
<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
bind<span class="token operator">-</span>address<span class="token operator">=</span><span class="token operator">*</span>
ssl<span class="token operator">-</span>ca<span class="token operator">=</span><span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>ca<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem
ssl<span class="token operator">-</span>cert<span class="token operator">=</span><span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>server<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem
ssl<span class="token operator">-</span><span class="token keyword">key</span><span class="token operator">=</span><span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>server<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem
<span class="token comment"># :wq </span>

</code></pre></div><p>Then</p> <div class="language-sql extra-class"><pre class="language-sql"><code>systemctl restart mariadb

</code></pre></div><p>Don't forget to open your firewall to allow connections from appclient (using IP 1.2.3.4)</p> <div class="language-sql extra-class"><pre class="language-sql"><code>firewall<span class="token operator">-</span>cmd <span class="token comment">--zone=drop --permanent --add-rich-rule 'rule family=&quot;ipv4&quot; source address=&quot;1.2.3.4&quot; service name=&quot;mysql&quot; accept'</span>
<span class="token comment"># I force everything to the drop zone.  Season the above command to taste.</span>

</code></pre></div><p>Now restart firewalld</p> <div class="language-sql extra-class"><pre class="language-sql"><code>service firewalld restart

</code></pre></div><p>Next, log in to dbserver's mysql server:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p 

</code></pre></div><p>Issue the following to create a user for the client.  note REQUIRE SSL in GRANT statement.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> ‘iamsecure’@’appclient’ IDENTIFIED <span class="token keyword">BY</span> ‘dingdingding’ <span class="token keyword">REQUIRE</span> SSL<span class="token punctuation">;</span>
FLUSH <span class="token keyword">PRIVILEGES</span><span class="token punctuation">;</span> 
<span class="token comment"># quit mysql</span>

</code></pre></div><p>You should still be in /root/certs/mysql from the first step. If not, cd back to it for one of the commands below.</p> <p>Create the client certificates</p> <div class="language-sql extra-class"><pre class="language-sql"><code>openssl req <span class="token operator">-</span>sha1 <span class="token operator">-</span>newkey rsa:<span class="token number">2048</span> <span class="token operator">-</span>days <span class="token number">730</span> <span class="token operator">-</span>nodes <span class="token operator">-</span>keyout client<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">&gt;</span> client<span class="token operator">-</span>req<span class="token punctuation">.</span>pem
openssl rsa <span class="token operator">-</span><span class="token operator">in</span> client<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span><span class="token keyword">out</span> client<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem
openssl x509 <span class="token operator">-</span>sha1 <span class="token operator">-</span>req <span class="token operator">-</span><span class="token operator">in</span> client<span class="token operator">-</span>req<span class="token punctuation">.</span>pem <span class="token operator">-</span>days <span class="token number">730</span> <span class="token operator">-</span>CA ca<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem <span class="token operator">-</span>CAkey ca<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem <span class="token operator">-</span>set_serial <span class="token number">01</span> <span class="token operator">&gt;</span> client<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem

</code></pre></div><p><strong>Note</strong>: I used the same common name for both server and client certificates. YMMV.</p> <p><strong>Be sure you're still /root/certs/mysql/ for this next command</strong></p> <p>Combine server and client CA certificate into a single file:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>cat server<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem client<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem <span class="token operator">&gt;</span> ca<span class="token punctuation">.</span>pem

</code></pre></div><p>Make sure you see two certificates:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>cat ca<span class="token punctuation">.</span>pem 

</code></pre></div><h3 id="end-of-server-side-work-for-now"><a href="#end-of-server-side-work-for-now" class="header-anchor">#</a> END OF SERVER SIDE WORK FOR NOW.</h3> <p>Open another terminal and</p> <div class="language-sql extra-class"><pre class="language-sql"><code>ssh appclient

</code></pre></div><p>As before, create a permanent home for the client certificates</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mkdir <span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql<span class="token operator">/</span>

</code></pre></div><p>Now, place the client certificates (created on dbserver) on appclient.
You can either scp them over, or just copy and paste the files one by one.</p> <div class="language-sql extra-class"><pre class="language-sql"><code>scp dbserver
<span class="token comment"># copy files from dbserver to appclient</span>
<span class="token comment"># exit scp</span>

</code></pre></div><p>Again, be sure to set permissions on the folder and files.  mysql needs full ownership and access.</p> <div class="language-sql extra-class"><pre class="language-sql"><code>chown <span class="token operator">-</span>R mysql:mysql <span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql

</code></pre></div><p>You should have three files, each owned by user mysql:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql<span class="token operator">/</span>ca<span class="token punctuation">.</span>pem
<span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql<span class="token operator">/</span>client<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem
<span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql<span class="token operator">/</span>client<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem

</code></pre></div><p>Now edit appclient's MariaDB/MySQL config in the <code>[client]</code> section.</p> <div class="language-sql extra-class"><pre class="language-sql"><code>vi <span class="token operator">/</span>etc<span class="token operator">/</span>my<span class="token punctuation">.</span>cnf
<span class="token comment"># i</span>
<span class="token punctuation">[</span>client<span class="token punctuation">]</span>
ssl<span class="token operator">-</span>ca<span class="token operator">=</span><span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql<span class="token operator">/</span>ca<span class="token punctuation">.</span>pem
ssl<span class="token operator">-</span>cert<span class="token operator">=</span><span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql<span class="token operator">/</span>client<span class="token operator">-</span>cert<span class="token punctuation">.</span>pem
ssl<span class="token operator">-</span><span class="token keyword">key</span><span class="token operator">=</span><span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql<span class="token operator">/</span>client<span class="token operator">-</span><span class="token keyword">key</span><span class="token punctuation">.</span>pem
<span class="token comment"># :wq </span>

</code></pre></div><p>Restart appclient's mariadb service:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>systemctl restart mariadb

</code></pre></div><h3 id="still-on-the-client-here"><a href="#still-on-the-client-here" class="header-anchor">#</a> still on the client here</h3> <p>This should return: ssl TRUE</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql <span class="token comment">--ssl --help</span>

</code></pre></div><p>Now, log in to appclient's mysql instance</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p

</code></pre></div><p>Should see YES to both variables below</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">show</span> variables <span class="token operator">LIKE</span> <span class="token string">'%ssl'</span><span class="token punctuation">;</span>
    have_openssl    YES
    have_ssl              YES

</code></pre></div><p>Initially I saw</p> <div class="language- extra-class"><pre class="language-text"><code>
have_openssl NO

</code></pre></div><p>A quick look into mariadb.log revealed:</p> <blockquote></blockquote> <p>SSL error: Unable to get certificate from
'/etc/pki/tls/certs/mysql/client-cert.pem'</p> <p>The problem was that root owned client-cert.pem and the containing folder.
The solution was to set ownership of /etc/pki/tls/certs/mysql/ to mysql.</p> <div class="language-sql extra-class"><pre class="language-sql"><code>chown <span class="token operator">-</span>R mysql:mysql <span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>tls<span class="token operator">/</span>certs<span class="token operator">/</span>mysql

</code></pre></div><p>Restart mariadb if needed from the step immediately above</p> <h3 id="now-we-are-ready-to-test-the-secure-connection"><a href="#now-we-are-ready-to-test-the-secure-connection" class="header-anchor">#</a> NOW WE ARE READY TO TEST THE SECURE CONNECTION</h3> <h3 id="we-re-still-on-appclient-here"><a href="#we-re-still-on-appclient-here" class="header-anchor">#</a> We're still on appclient here</h3> <p>Attempt to connect to dbserver's mysql instance using the account created above.</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql <span class="token operator">-</span>h dbserver <span class="token operator">-</span>u iamsecure <span class="token operator">-</span>p
<span class="token comment"># enter password dingdingding (hopefully you changed that to something else)</span>

</code></pre></div><p>With a little luck you should be logged in without error.</p> <p>To confirm you are connected with SSL enabled, issue the following command from the MariaDB/MySQL prompt:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>\s 

</code></pre></div><p><strong>That's a backslash s, aka status</strong></p> <p>That will show the status of your connection, which should look something like this:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>Connection id:        <span class="token number">4</span>
<span class="token keyword">Current</span> <span class="token keyword">database</span>:    
<span class="token keyword">Current</span> <span class="token keyword">user</span>:        iamsecure<span class="token variable">@appclient</span>
SSL:            Cipher <span class="token operator">in</span> <span class="token keyword">use</span> <span class="token operator">is</span> DHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES256<span class="token operator">-</span>GCM<span class="token operator">-</span>SHA384
<span class="token keyword">Current</span> pager:        stdout
<span class="token keyword">Using</span> <span class="token keyword">outfile</span>:        <span class="token string">''</span>
<span class="token keyword">Using</span> <span class="token keyword">delimiter</span>:    <span class="token punctuation">;</span>
Server:            MariaDB
Server version:        <span class="token number">5.</span>X<span class="token punctuation">.</span>X<span class="token operator">-</span>MariaDB MariaDB Server
Protocol version:    <span class="token number">10</span>
Connection:        dbserver via TCP<span class="token operator">/</span>IP
Server characterset:    latin1
Db     characterset:    latin1
Client characterset:    utf8
Conn<span class="token punctuation">.</span>  characterset:    utf8
TCP port:        <span class="token number">3306</span>
Uptime:            <span class="token number">42</span> min <span class="token number">13</span> sec

</code></pre></div><p>If you get permission denied errors on your connection attempt, check your GRANT statement above to make sure there aren't any stray characters or ' marks.</p> <p>If you have SSL errors, go back through this guide to make sure the steps are orderly.</p> <p>This worked on RHEL7 and will likely work on CentOS7, too.  Cannot confirm whether these exact steps will work elsewhere.</p> <p>Hope this saves someone else a little time and aggravation.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/mysql/ssl-connection-setup.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mysql/server-information.html" class="prev">
        Server Information
      </a></span> <span class="next"><a href="/mysql/create-new-user.html">
        Create New User
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2149.4f3a83af.js" defer></script>
  </body>
</html>
