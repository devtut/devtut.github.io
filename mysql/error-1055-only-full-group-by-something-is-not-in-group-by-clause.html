<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL - Error 1055: ONLY_FULL_GROUP_BY: something  is not in GROUP BY clause ...</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Misusing GROUP BY to return unpredictable results: Murphy's Law, Misusing GROUP BY with SELECT *, and how to fix it., Using and misusing GROUP BY, ANY_VALUE()">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="MySQL - Error 1055: ONLY_FULL_GROUP_BY: something  is not in GROUP BY clause ...">
    <meta property="og:description" content="Misusing GROUP BY to return unpredictable results: Murphy's Law, Misusing GROUP BY with SELECT *, and how to fix it., Using and misusing GROUP BY, ANY_VALUE()">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/mysql/error-1055-only-full-group-by-something-is-not-in-group-by-clause.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="MySQL - Error 1055: ONLY_FULL_GROUP_BY: something  is not in GROUP BY clause ...">
    <meta name="twitter:description" content="Misusing GROUP BY to return unpredictable results: Murphy's Law, Misusing GROUP BY with SELECT *, and how to fix it., Using and misusing GROUP BY, ANY_VALUE()">
    <meta name="twitter:url" content="/mysql/error-1055-only-full-group-by-something-is-not-in-group-by-clause.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2109.6dc17839.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MySQL</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mysql/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/mysql/getting-started-with-mysql.html" class="sidebar-link">Getting started with MySQL</a></li><li><a href="/mysql/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/mysql/select.html" class="sidebar-link">SELECT</a></li><li><a href="/mysql/backticks.html" class="sidebar-link">Backticks</a></li><li><a href="/mysql/null.html" class="sidebar-link">NULL</a></li><li><a href="/mysql/limit-and-offset.html" class="sidebar-link">Limit and Offset</a></li><li><a href="/mysql/creating-databases.html" class="sidebar-link">Creating databases</a></li><li><a href="/mysql/using-variables.html" class="sidebar-link">Using Variables</a></li><li><a href="/mysql/comment-mysql.html" class="sidebar-link">Comment Mysql</a></li><li><a href="/mysql/insert.html" class="sidebar-link">INSERT</a></li><li><a href="/mysql/delete.html" class="sidebar-link">DELETE</a></li><li><a href="/mysql/update.html" class="sidebar-link">UPDATE</a></li><li><a href="/mysql/order-by.html" class="sidebar-link">ORDER BY</a></li><li><a href="/mysql/group-by.html" class="sidebar-link">Group By</a></li><li><a href="/mysql/error-1055-only-full-group-by-something-is-not-in-group-by-clause.html" aria-current="page" class="active sidebar-link">Error 1055: ONLYFULLGROUP_BY: something  is not in GROUP BY clause ...</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mysql/error-1055-only-full-group-by-something-is-not-in-group-by-clause.html#misusing-group-by-to-return-unpredictable-results-murphy-s-law" class="sidebar-link">Misusing GROUP BY to return unpredictable results: Murphy's Law</a></li><li class="sidebar-sub-header"><a href="/mysql/error-1055-only-full-group-by-something-is-not-in-group-by-clause.html#misusing-group-by-with-select-and-how-to-fix-it" class="sidebar-link">Misusing GROUP BY with SELECT *, and how to fix it.</a></li><li class="sidebar-sub-header"><a href="/mysql/error-1055-only-full-group-by-something-is-not-in-group-by-clause.html#using-and-misusing-group-by" class="sidebar-link">Using and misusing GROUP BY</a></li><li class="sidebar-sub-header"><a href="/mysql/error-1055-only-full-group-by-something-is-not-in-group-by-clause.html#any-value" class="sidebar-link">ANY_VALUE()</a></li></ul></li><li><a href="/mysql/joins.html" class="sidebar-link">Joins</a></li><li><a href="/mysql/joins-join-3-table-with-the-same-name-of-id.html" class="sidebar-link">JOINS: Join 3 table with the same name of id.</a></li><li><a href="/mysql/union.html" class="sidebar-link">UNION</a></li><li><a href="/mysql/arithmetic.html" class="sidebar-link">Arithmetic</a></li><li><a href="/mysql/string-operations.html" class="sidebar-link">String operations</a></li><li><a href="/mysql/date-and-time-operations.html" class="sidebar-link">Date and Time Operations</a></li><li><a href="/mysql/handling-time-zones.html" class="sidebar-link">Handling Time Zones</a></li><li><a href="/mysql/regular-expressions.html" class="sidebar-link">Regular Expressions</a></li><li><a href="/mysql/view.html" class="sidebar-link">VIEW</a></li><li><a href="/mysql/table-creation.html" class="sidebar-link">Table Creation</a></li><li><a href="/mysql/alter-table.html" class="sidebar-link">ALTER TABLE</a></li><li><a href="/mysql/drop-table.html" class="sidebar-link">Drop Table</a></li><li><a href="/mysql/mysql-lock-table.html" class="sidebar-link">MySQL LOCK TABLE</a></li><li><a href="/mysql/error-codes.html" class="sidebar-link">Error codes</a></li><li><a href="/mysql/stored-routines-procedures-and-functions.html" class="sidebar-link">Stored routines (procedures and functions)</a></li><li><a href="/mysql/indexes-and-keys.html" class="sidebar-link">Indexes and Keys</a></li><li><a href="/mysql/full-text-search.html" class="sidebar-link">Full-Text search</a></li><li><a href="/mysql/prepare-statements.html" class="sidebar-link">PREPARE Statements</a></li><li><a href="/mysql/json.html" class="sidebar-link">JSON</a></li><li><a href="/mysql/extract-values-from-json-type.html" class="sidebar-link">Extract values from JSON type</a></li><li><a href="/mysql/mysql-admin.html" class="sidebar-link">MySQL Admin</a></li><li><a href="/mysql/triggers.html" class="sidebar-link">TRIGGERS</a></li><li><a href="/mysql/configuration-and-tuning.html" class="sidebar-link">Configuration and tuning</a></li><li><a href="/mysql/events.html" class="sidebar-link">Events</a></li><li><a href="/mysql/enum.html" class="sidebar-link">ENUM</a></li><li><a href="/mysql/install-mysql-container-with-docker-compose.html" class="sidebar-link">Install Mysql container with Docker-Compose</a></li><li><a href="/mysql/character-sets-and-collations.html" class="sidebar-link">Character Sets and Collations</a></li><li><a href="/mysql/myisam-engine.html" class="sidebar-link">MyISAM Engine</a></li><li><a href="/mysql/converting-from-myisam-to-innodb.html" class="sidebar-link">Converting from MyISAM to InnoDB</a></li><li><a href="/mysql/transaction.html" class="sidebar-link">Transaction</a></li><li><a href="/mysql/log-files.html" class="sidebar-link">Log files</a></li><li><a href="/mysql/clustering.html" class="sidebar-link">Clustering</a></li><li><a href="/mysql/partitioning.html" class="sidebar-link">Partitioning</a></li><li><a href="/mysql/replication.html" class="sidebar-link">Replication</a></li><li><a href="/mysql/backup-using-mysqldump.html" class="sidebar-link">Backup using mysqldump</a></li><li><a href="/mysql/mysqlimport.html" class="sidebar-link">mysqlimport</a></li><li><a href="/mysql/load-data-infile.html" class="sidebar-link">LOAD DATA INFILE</a></li><li><a href="/mysql/mysql-unions.html" class="sidebar-link">MySQL Unions</a></li><li><a href="/mysql/mysql-client.html" class="sidebar-link">MySQL client</a></li><li><a href="/mysql/temporary-tables.html" class="sidebar-link">Temporary Tables</a></li><li><a href="/mysql/customize-ps1.html" class="sidebar-link">Customize PS1</a></li><li><a href="/mysql/dealing-with-sparse-or-missing-data.html" class="sidebar-link">Dealing with sparse or missing data</a></li><li><a href="/mysql/connecting-with-utf-8-using-various-programming-language.html" class="sidebar-link">Connecting with UTF-8 Using Various Programming language.</a></li><li><a href="/mysql/time-with-subsecond-precision.html" class="sidebar-link">Time with subsecond precision</a></li><li><a href="/mysql/one-to-many.html" class="sidebar-link">One to Many</a></li><li><a href="/mysql/many-to-many-mapping-table.html" class="sidebar-link">Many-to-many Mapping table</a></li><li><a href="/mysql/pivot-queries.html" class="sidebar-link">Pivot queries</a></li><li><a href="/mysql/dynamic-un-pivot-table-using-prepared-statement.html" class="sidebar-link">Dynamic Un-Pivot Table using Prepared Statement</a></li><li><a href="/mysql/server-information.html" class="sidebar-link">Server Information</a></li><li><a href="/mysql/ssl-connection-setup.html" class="sidebar-link">SSL Connection Setup</a></li><li><a href="/mysql/create-new-user.html" class="sidebar-link">Create New User</a></li><li><a href="/mysql/security-via-grants.html" class="sidebar-link">Security via GRANTs</a></li><li><a href="/mysql/change-password.html" class="sidebar-link">Change Password</a></li><li><a href="/mysql/recover-and-reset-the-default-root-password-for-mysql-5-7.html" class="sidebar-link">Recover and reset the default root password for MySQL 5.7+</a></li><li><a href="/mysql/recover-from-lost-root-password.html" class="sidebar-link">Recover from lost root password</a></li><li><a href="/mysql/mysql-performance-tips.html" class="sidebar-link">Mysql Performance Tips</a></li><li><a href="/mysql/performance-tuning.html" class="sidebar-link">Performance Tuning</a></li><li><a href="/mysql/reserved-words.html" class="sidebar-link">Reserved Words</a></li><li><a href="/mysql/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="error-1055-only-full-group-by-something-is-not-in-group-by-clause"><a href="#error-1055-only-full-group-by-something-is-not-in-group-by-clause" class="header-anchor">#</a> Error 1055: ONLY_FULL_GROUP_BY: something  is not in GROUP BY clause ...</h1> <h2 id="misusing-group-by-to-return-unpredictable-results-murphy-s-law"><a href="#misusing-group-by-to-return-unpredictable-results-murphy-s-law" class="header-anchor">#</a> Misusing GROUP BY to return unpredictable results: Murphy's Law</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> item<span class="token punctuation">.</span>item_id<span class="token punctuation">,</span> uses<span class="token punctuation">.</span>category<span class="token punctuation">,</span>   <span class="token comment">/* nonstandard */</span> 
       <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> number_of_uses 
  <span class="token keyword">FROM</span> item 
  <span class="token keyword">JOIN</span> uses <span class="token keyword">ON</span> item<span class="token punctuation">.</span>item_id<span class="token punctuation">,</span> uses<span class="token punctuation">.</span>item_id
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> item<span class="token punctuation">.</span>item_id

</code></pre></div><p>will show the rows in a table called item, and show the count of related rows in a table called uses. It will also show the value of a column called <code>uses.category</code>.</p> <p>This query works in MySQL (before the <code>ONLY_FULL_GROUP_BY</code> flag appeared). It uses <a href="https://dev.mysql.com/doc/refman/5.7/en/group-by-handling.html" target="_blank" rel="noopener noreferrer">MySQL's nonstandard extension to <code>GROUP BY</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>But the query has a problem:  if several rows in the <code>uses</code> table match the <code>ON</code> condition in the <code>JOIN</code> clause, MySQL returns the <code>category</code> column from just one of those rows. Which row? The writer of the query, and the user of the application, doesn't get to know that in advance. Formally speaking, it's <strong>unpredictable</strong>: MySQL can return any value it wants.</p> <p><strong>Unpredictable</strong> is like <strong>random,</strong> with one significant difference. One might expect a <strong>random</strong> choice to change from time to time.  Therefore, if a choice were random, you might detect it during debugging or testing.  The <strong>unpredictable</strong> result is worse: MySQL returns the same result each time you use the query, <strong>until it doesn't.</strong>  Sometimes it's a new version of the MySQL server that causes a different result. Sometimes it's a growing table causing the problem. What can go wrong, will go wrong, and when you don't expect it. That's called <a href="https://en.wikipedia.org/wiki/Murphy%27s_law" target="_blank" rel="noopener noreferrer">Murphy's Law<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>The MySQL team has been working to make it harder for developers to make this mistake. Newer versions of MySQL in the 5.7 sequence have a <code>sql_mode</code> flag called <code>ONLY_FULL_GROUP_BY</code>. When that flag is set, the MySQL server returns the 1055 error and refuses to run this kind of query.</p> <h2 id="misusing-group-by-with-select-and-how-to-fix-it"><a href="#misusing-group-by-with-select-and-how-to-fix-it" class="header-anchor">#</a> Misusing GROUP BY with SELECT *, and how to fix it.</h2> <p>Sometimes a query looks like this, with a <code>*</code> in the <code>SELECT</code> clause.</p> <div class="language- extra-class"><pre class="language-text"><code>
SELECT item.*,     /* nonstandard */ 
        COUNT(*) number_of_uses
  FROM item 
  JOIN uses ON item.item_id, uses.item_id
 GROUP BY item.item_id

</code></pre></div><p>Such a query needs to be refactored to comply with the <code>ONLY_FULL_GROUP_BY</code> standard.</p> <p>To do this, we need a subquery that uses <code>GROUP BY</code> correctly to return the <code>number_of_uses</code> value for each <code>item_id</code>.  This subquery is short and sweet, because it only needs to look at the <code>uses</code> table.</p> <div class="language- extra-class"><pre class="language-text"><code>
                             SELECT item_id, COUNT(*) number_of_uses
                                FROM  uses 
                               GROUP BY item_id

</code></pre></div><p>Then, we can join that subquery with the <code>item</code> table.</p> <div class="language- extra-class"><pre class="language-text"><code>
SELECT item.*, usecount.number_of_uses
   FROM item
   JOIN (
                              SELECT item_id, COUNT(*) number_of_uses
                                FROM  uses 
                               GROUP BY item_id
        ) usecount ON item.item_id = usecount.item_id

</code></pre></div><p>This allows the <code>GROUP BY</code> clause to be simple and correct, and also allows us to use the <code>*</code> specifier.</p> <p>Note: nevertheless, wise developers avoid using the <code>*</code> specifier in any case. It's usually better to list the columns you want in a query.</p> <h2 id="using-and-misusing-group-by"><a href="#using-and-misusing-group-by" class="header-anchor">#</a> Using and misusing GROUP BY</h2> <div class="language- extra-class"><pre class="language-text"><code>
SELECT item.item_id, item.name,     /* not SQL-92 */ 
        COUNT(*) number_of_uses
  FROM item 
  JOIN uses ON item.item_id, uses.item_id
 GROUP BY item.item_id

</code></pre></div><p>will show the rows in a table called <code>item</code>, and show the count of related rows in a table called <code>uses</code>.  This works well, but unfortunately it's not standard SQL-92.</p> <p>Why not? because the <code>SELECT</code> clause (and the <code>ORDER BY</code> clause) in <code>GROUP BY</code> queries must contain columns that are</p> <ol><li>mentioned in the <code>GROUP BY</code> clause, or</li> <li>aggregate functions such as <code>COUNT()</code>, <code>MIN()</code>, and the like.</li></ol> <p>This example's <code>SELECT</code> clause mentions <code>item.name</code>, a column that does not meet either of those criteria. MySQL 5.6 and earlier will reject this query if the SQL mode contains <code>ONLY_FULL_GROUP_BY</code>.</p> <p>This example query can be made to comply with the SQL-92 standard by changing the <code>GROUP BY</code> clause, like this.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> item<span class="token punctuation">.</span>item_id<span class="token punctuation">,</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span> 
       <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> number_of_uses
  <span class="token keyword">FROM</span> item 
  <span class="token keyword">JOIN</span> uses <span class="token keyword">ON</span> item<span class="token punctuation">.</span>item_id<span class="token punctuation">,</span> uses<span class="token punctuation">.</span>item_id
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> item<span class="token punctuation">.</span>item_id<span class="token punctuation">,</span> item<span class="token punctuation">.</span>name

</code></pre></div><p>The later SQL-99 standard allows a <code>SELECT</code> statement to omit unaggregated columns from the group key if the DBMS can prove a functional dependence between them and the group key columns. Because <code>item.name</code> is functionally dependent on <code>item.item_id</code>, the initial example is valid SQL-99. MySQL gained a <a href="https://dev.mysql.com/doc/refman/5.7/en/group-by-functional-dependence.html" target="_blank" rel="noopener noreferrer">functional dependence prover<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in version 5.7. The original example works under <code>ONLY_FULL_GROUP_BY</code>.</p> <h2 id="any-value"><a href="#any-value" class="header-anchor">#</a> ANY_VALUE()</h2> <div class="language- extra-class"><pre class="language-text"><code>
SELECT item.item_id, ANY_VALUE(uses.tag) tag,   
        COUNT(*) number_of_uses
  FROM item 
  JOIN uses ON item.item_id, uses.item_id
 GROUP BY item.item_id

</code></pre></div><p>shows the rows in a table called <code>item</code>, the count of related rows, and one of the values in the related table called <code>uses</code>.</p> <p>You can think of <a href="http://dev.mysql.com/doc/refman/5.7/en/miscellaneous-functions.html#function_any-value" target="_blank" rel="noopener noreferrer">this <code>ANY_VALUE()</code> function<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> as a strange a kind of aggregate function. Instead of returning a count, sum, or maximum, it instructs the MySQL server to choose, arbitrarily, one value from the group in question. It's a way of working around Error 1055.</p> <p>Be careful when using <code>ANY_VALUE()</code> in queries in production applications.</p> <p>It really should be called <code>SURPRISE_ME()</code>. It returns the value of some row in the GROUP BY group. Which row it returns is indeterminate. That means it's entirely up to the MySQL server. Formally, it returns an unpredictable value.</p> <p>The server doesn't choose a random value, it's worse than that. It returns the same value every time you run the query, until it doesn't. It can change, or not, when a table grows or shrinks, or when the server has more or less RAM, or when the server version changes, or when Mars is in retrograde (whatever that means), or for no reason at all.</p> <p>You have been warned.</p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>For a long time now, MySQL has contained a notorious nonstandard extension to <code>GROUP BY</code>, which allows oddball behavior in the name of efficiency. This extension has allowed countless developers around the world to use <code>GROUP BY</code> in production code without completely understanding what they were doing.</p> <p>In particular, it's a bad idea to use <code>SELECT *</code> in a <code>GROUP BY</code> query, because a standard <code>GROUP BY</code> clause requires enumerating the columns. Many developers have, unfortunately, done that.</p> <p>Read this. <a href="https://dev.mysql.com/doc/refman/5.7/en/group-by-handling.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/5.7/en/group-by-handling.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>The MySQL team has been trying to fix this misfeature without messing up production code. They added a <code>sql_mode</code> flag in 5.7.5 named <a href="http://dev.mysql.com/doc/refman/5.7/en/sql-mode.html" target="_blank" rel="noopener noreferrer"><code>ONLY_FULL_GROUP_BY</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to compel standard behavior.  In a recent release, they turned on that flag by default. When you upgraded your local MySQL to 5.7.14, the flag got switched on and your production code, dependent on the old extension, stopped working.</p> <p>If you've recently started getting 1055 errors, what are your choices?</p> <ol><li>fix the offending SQL queries, or get their authors to do that.</li> <li>roll back to a version of MySQL compatible out-of-the-box with the application software you use.</li> <li>change your server's <a href="http://dev.mysql.com/doc/refman/5.7/en/sql-mode.html" target="_blank" rel="noopener noreferrer"><code>sql_mode</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to get rid of the newly set <code>ONLY_FULL_GROUP_BY</code> mode.</li></ol> <p>You can change the mode by doing a <code>SET</code> command.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SET</span>  sql_mode <span class="token operator">=</span> <span class="token string">'STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'</span>

</code></pre></div><p>should do the trick if you do it right after your application connects to MySQL.</p> <p>Or, you can find <a href="http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html" target="_blank" rel="noopener noreferrer">the init file in your MySQL installation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, locate the <code>sql_mode=</code> line, and change it to omit <code>ONLY_FULL_GROUP_BY</code>, and restart your server.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/mysql/error-1055-only-full-group-by-something-is-not-in-group-by-clause.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mysql/group-by.html" class="prev">
        Group By
      </a></span> <span class="next"><a href="/mysql/joins.html">
        Joins
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2109.6dc17839.js" defer></script>
  </body>
</html>
