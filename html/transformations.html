<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTML - Transformations</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Drawing many translated, scaled, and rotated  images quickly, Rotate an Image or Path around it's centerpoint, Introduction to Transformations, A Transformation Matrix to track translated, rotated & scaled shape(s)">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="HTML - Transformations">
    <meta property="og:description" content="Drawing many translated, scaled, and rotated  images quickly, Rotate an Image or Path around it's centerpoint, Introduction to Transformations, A Transformation Matrix to track translated, rotated & scaled shape(s)">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/html/transformations.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="HTML - Transformations">
    <meta name="twitter:description" content="Drawing many translated, scaled, and rotated  images quickly, Rotate an Image or Path around it's centerpoint, Introduction to Transformations, A Transformation Matrix to track translated, rotated & scaled shape(s)">
    <meta name="twitter:url" content="/html/transformations.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/1298.493094ca.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>HTML</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/html/" class="sidebar-link">Disclaimer</a></li><li><a href="/html/getting-started-with-html.html" class="sidebar-link">Getting started with HTML</a></li><li><a href="/html/doctypes.html" class="sidebar-link">Doctypes</a></li><li><a href="/html/headings.html" class="sidebar-link">Headings</a></li><li><a href="/html/paragraphs.html" class="sidebar-link">Paragraphs</a></li><li><a href="/html/text-formatting.html" class="sidebar-link">Text Formatting</a></li><li><a href="/html/anchors-and-hyperlinks.html" class="sidebar-link">Anchors and Hyperlinks</a></li><li><a href="/html/lists.html" class="sidebar-link">Lists</a></li><li><a href="/html/tables.html" class="sidebar-link">Tables</a></li><li><a href="/html/comments.html" class="sidebar-link">Comments</a></li><li><a href="/html/classes-and-ids.html" class="sidebar-link">Classes and IDs</a></li><li><a href="/html/data-attributes.html" class="sidebar-link">Data Attributes</a></li><li><a href="/html/linking-resources.html" class="sidebar-link">Linking Resources</a></li><li><a href="/html/include-javascript-code-in-html.html" class="sidebar-link">Include JavaScript Code in HTML</a></li><li><a href="/html/using-html-with-css.html" class="sidebar-link">Using HTML with CSS</a></li><li><a href="/html/images.html" class="sidebar-link">Images</a></li><li><a href="/html/image-maps.html" class="sidebar-link">Image Maps</a></li><li><a href="/html/input-control-elements.html" class="sidebar-link">Input Control Elements</a></li><li><a href="/html/forms.html" class="sidebar-link">Forms</a></li><li><a href="/html/div-element.html" class="sidebar-link">Div Element</a></li><li><a href="/html/sectioning-elements.html" class="sidebar-link">Sectioning Elements</a></li><li><a href="/html/navigation-bars.html" class="sidebar-link">Navigation Bars</a></li><li><a href="/html/label-element.html" class="sidebar-link">Label Element</a></li><li><a href="/html/output-element.html" class="sidebar-link">Output Element</a></li><li><a href="/html/void-elements.html" class="sidebar-link">Void Elements</a></li><li><a href="/html/media-elements.html" class="sidebar-link">Media Elements</a></li><li><a href="/html/progress-element.html" class="sidebar-link">Progress Element</a></li><li><a href="/html/selection-menu-controls.html" class="sidebar-link">Selection Menu Controls</a></li><li><a href="/html/embed.html" class="sidebar-link">Embed</a></li><li><a href="/html/iframes.html" class="sidebar-link">IFrames</a></li><li><a href="/html/content-languages.html" class="sidebar-link">Content Languages</a></li><li><a href="/html/svg.html" class="sidebar-link">SVG</a></li><li><a href="/html/canvas.html" class="sidebar-link">Canvas</a></li><li><a href="/html/meta-information.html" class="sidebar-link">Meta Information</a></li><li><a href="/html/marking-up-computer-code.html" class="sidebar-link">Marking up computer code</a></li><li><a href="/html/marking-up-quotes.html" class="sidebar-link">Marking-up Quotes</a></li><li><a href="/html/tabindex.html" class="sidebar-link">Tabindex</a></li><li><a href="/html/global-attributes.html" class="sidebar-link">Global Attributes</a></li><li><a href="/html/html-5-cache.html" class="sidebar-link">HTML 5 Cache</a></li><li><a href="/html/html-event-attributes.html" class="sidebar-link">HTML Event Attributes</a></li><li><a href="/html/character-entities.html" class="sidebar-link">Character Entities</a></li><li><a href="/html/aria.html" class="sidebar-link">ARIA</a></li><li><a href="/html/getting-started-with-html5-canvas.html" class="sidebar-link">Getting started with html5-canvas</a></li><li><a href="/html/text.html" class="sidebar-link">Text</a></li><li><a href="/html/polygons.html" class="sidebar-link">Polygons</a></li><li><a href="/html/images.html" class="sidebar-link">Images</a></li><li><a href="/html/path-syntax-only.html" class="sidebar-link">Path (Syntax only)</a></li><li><a href="/html/paths.html" class="sidebar-link">Paths</a></li><li><a href="/html/navigating-along-a-path.html" class="sidebar-link">Navigating along a Path</a></li><li><a href="/html/dragging-path-shapes-images-on-canvas.html" class="sidebar-link">Dragging Path Shapes &amp; Images on Canvas</a></li><li><a href="/html/media-types-and-the-canvas.html" class="sidebar-link">Media types and the canvas</a></li><li><a href="/html/animation.html" class="sidebar-link">Animation</a></li><li><a href="/html/collisions-and-intersections.html" class="sidebar-link">Collisions and Intersections</a></li><li><a href="/html/clearing-the-screen.html" class="sidebar-link">Clearing the screen</a></li><li><a href="/html/responsive-design.html" class="sidebar-link">Responsive Design</a></li><li><a href="/html/shadows.html" class="sidebar-link">Shadows</a></li><li><a href="/html/charts-diagrams.html" class="sidebar-link">Charts &amp; Diagrams</a></li><li><a href="/html/transformations.html" class="active sidebar-link">Transformations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/html/transformations.html#drawing-many-translated-scaled-and-rotated-images-quickly" class="sidebar-link">Drawing many translated, scaled, and rotated  images quickly</a></li><li class="sidebar-sub-header"><a href="/html/transformations.html#rotate-an-image-or-path-around-it-s-centerpoint" class="sidebar-link">Rotate an Image or Path around it's centerpoint</a></li><li class="sidebar-sub-header"><a href="/html/transformations.html#introduction-to-transformations" class="sidebar-link">Introduction to Transformations</a></li><li class="sidebar-sub-header"><a href="/html/transformations.html#a-transformation-matrix-to-track-translated-rotated-scaled-shape-s" class="sidebar-link">A Transformation Matrix to track translated, rotated &amp; scaled shape(s)</a></li></ul></li><li><a href="/html/compositing.html" class="sidebar-link">Compositing</a></li><li><a href="/html/pixel-manipulation-with-getimagedata-and-putimagedata.html" class="sidebar-link">Pixel Manipulation with &quot;getImageData&quot; and &quot;putImageData&quot;</a></li><li><a href="/html/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="transformations"><a href="#transformations" class="header-anchor">#</a> Transformations</h1> <h2 id="drawing-many-translated-scaled-and-rotated-images-quickly"><a href="#drawing-many-translated-scaled-and-rotated-images-quickly" class="header-anchor">#</a> Drawing many translated, scaled, and rotated  images quickly</h2> <p>There are many situation where you want to draw an image that is rotated, scaled, and translated. The rotation should occur around the center of the image. This is the quickest way to do so on the 2D canvas. These functions a well suited to 2D games where the expectation is to render a few hundred even up to a 1000+ images every 60th of a second. (dependent on the hardware)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// assumes that the canvas context is in ctx and in scope</span>
<span class="token keyword">function</span> <span class="token function">drawImageRST</span><span class="token punctuation">(</span><span class="token parameter">image<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> scale<span class="token punctuation">,</span> rotation</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span>scale<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> scale<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// set the scale and translation</span>
    ctx<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment">// add the rotation</span>
    ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token operator">-</span>image<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span>image<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// draw the image offset by half its width and height</span>
<span class="token punctuation">}</span>

</code></pre></div><p>A variant can also include the alpha value which is useful for particle systems.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">drawImageRST_Alpha</span><span class="token punctuation">(</span><span class="token parameter">image<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> scale<span class="token punctuation">,</span> rotation<span class="token punctuation">,</span> alpha</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span>scale<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> scale<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// set the scale and translation</span>
    ctx<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment">// add the rotation</span>
    ctx<span class="token punctuation">.</span>globalAlpha <span class="token operator">=</span> alpha<span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token operator">-</span>image<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span>image<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// draw the image offset by half its width and height</span>
<span class="token punctuation">}</span>

</code></pre></div><p>It is important to note that both functions leave the canvas context in a random state. Though the functions will not be affected other rendering my be. When you are done rendering images you may need to restore the default transform</p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// set the context transform back to the default </span>

</code></pre></div><p>If you use the alpha version (second example) and then the standard version you will have to ensure that the global alpha state is restored</p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>globalAlpha <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

</code></pre></div><p>An example of using the above functions to render some particles and the a few images</p> <div class="language-html extra-class"><pre class="language-html"><code>// assume particles to contain an array of particles
for(var i = 0; i &lt; particles.length; i++){
    var p = particles[i];
    drawImageRST_Alpha(p.image, p.x, p.y, p.scale, p.rot, p.alpha);
    // no need to rest the alpha in the loop
}
// you need to reset the alpha as it can be any value 
ctx.globalAlpha = 1;

drawImageRST(myImage, 100, 100, 1, 0.5);  // draw an image at 100,100
// no need to reset the transform 
drawImageRST(myImage, 200, 200, 1, -0.5); // draw an image at 200,200 
ctx.setTransform(1,0,0,1,0,0);            // reset the transform

</code></pre></div><h2 id="rotate-an-image-or-path-around-it-s-centerpoint"><a href="#rotate-an-image-or-path-around-it-s-centerpoint" class="header-anchor">#</a> Rotate an Image or Path around it's centerpoint</h2> <p><a href="http://i.stack.imgur.com/nBLvb.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/nBLvb.png" alt="enter image description here"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Steps#1-5 below allow any image or path-shape to be both moved anywhere on the canvas and rotated to any angle without changing any of the image/path-shape's original point coordinates.</p> <li>
Move the canvas [0,0] origin to the shape's center point
<div class="language-html extra-class"><pre class="language-html"><code>context.translate( shapeCenterX, shapeCenterY );

</code></pre></div></li> <li>
Rotate the canvas by the desired angle (in radians)
<div class="language-html extra-class"><pre class="language-html"><code>context.rotate( radianAngle );

</code></pre></div></li> <li>
Move the canvas origin back to the top-left corner
<div class="language-html extra-class"><pre class="language-html"><code> context.translate( -shapeCenterX, -shapeCenterY );

</code></pre></div></li> <li>
Draw the image or path-shape using it's original coordinates.
<div class="language-html extra-class"><pre class="language-html"><code> context.fillRect( shapeX, shapeY, shapeWidth, shapeHeight );

</code></pre></div></li> <li>
Always clean up! Set the transformation state back to where it was before #1
</li> <li>
**Step#5, Option#1:** Undo every transformation in the reverse order
<div class="language-html extra-class"><pre class="language-html"><code>   // undo #3
   context.translate( shapeCenterX, shapeCenterY );
   // undo #2
   context.rotate( -radianAngle );
   // undo #1
   context.translate( -shapeCenterX, shapeCenterY );

</code></pre></div></li> <li>
**Step#5, Option#2:** If the canvas was in an untransformed state (the default) before beginning step#1, you can undo the effects of steps#1-3 by resetting all transformations to their default state
<div class="language-html extra-class"><pre class="language-html"><code>   // set transformation to the default state (==no transformation applied)
   context.setTransform(1,0,0,1,0,0)

</code></pre></div></li> <p><strong>Example code demo:</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// canvas references &amp; canvas styling</span>
<span class="token keyword">var</span> canvas<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span>style<span class="token punctuation">.</span>border<span class="token operator">=</span><span class="token string">'1px solid red'</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span>width<span class="token operator">=</span><span class="token number">378</span><span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span>height<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx<span class="token operator">=</span>canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>globalAlpha<span class="token operator">=</span><span class="token number">0.35</span><span class="token punctuation">;</span>        

<span class="token comment">// define a rectangle to rotate</span>
<span class="token keyword">var</span> rect<span class="token operator">=</span><span class="token punctuation">{</span> x<span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> width<span class="token operator">:</span><span class="token number">175</span><span class="token punctuation">,</span> height<span class="token operator">:</span><span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// draw the rectangle unrotated</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span> rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>width<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>height <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// draw the rectangle rotated by 45 degrees (==PI/4 radians)</span>
ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span> rect<span class="token punctuation">.</span>x<span class="token operator">+</span>rect<span class="token punctuation">.</span>width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token operator">+</span>rect<span class="token punctuation">.</span>height<span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">/</span><span class="token number">4</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span> <span class="token operator">-</span>rect<span class="token punctuation">.</span>x<span class="token operator">-</span>rect<span class="token punctuation">.</span>width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span>rect<span class="token punctuation">.</span>y<span class="token operator">-</span>rect<span class="token punctuation">.</span>height<span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span> rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>width<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>height <span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="introduction-to-transformations"><a href="#introduction-to-transformations" class="header-anchor">#</a> Introduction to Transformations</h2> <p>Transformations alter a given point's starting position by moving, rotating &amp; scaling that point.</p> <ul><li><strong>Translation:</strong> Moves a point by a <code>distanceX</code> and <code>distanceY</code>.</li> <li><strong>Rotation:</strong> Rotates a point by a <code>radian angle</code> around it's rotation point. The default rotation point in Html Canvas is the top-left origin [x=0,y=0] of the Canvas. But you can reposition the rotation point using translations.</li> <li><strong>Scaling:</strong> Scales a point's position by a <code>scalingFactorX</code> and <code>scalingFactorY</code>  from it's scaling point. The default scaling point in Html Canvas is the top-left origin [x=0,y=0] of the Canvas. But you can reposition the scaling point using translations.</li></ul> <p>You can also do less common transformations, like shearing (skewing), by directly setting the transformation matrix of the canvas using <code>context.transform</code>.</p> <p><strong>Translate (==move) a point with <code>context.translate(75,25)</code></strong></p> <p><a href="http://i.stack.imgur.com/h1jb3.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/h1jb3.png" alt="enter image description here"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><strong>Rotate a point with <code>context.rotate(Math.PI/8)</code></strong></p> <p><a href="http://i.stack.imgur.com/sf481.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/sf481.png" alt="enter image description here"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><strong>Scale a point with <code>context.scale(2,2)</code></strong></p> <p><a href="http://i.stack.imgur.com/e3Sho.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/e3Sho.png" alt="enter image description here"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Canvas actually achieves transformations by altering the canvas' entire coordinate system.</p> <ul><li><code>context.translate</code> will move the canvas [0,0] origin from the top left corner to a new location.</li> <li><code>context.rotate</code> will rotate the entire canvas coordinate system around the origin.</li> <li><code>context.scale</code> will scale the entire canvas coordinate system around the origin. Think of this as increasing the size of every x,y on the canvas: <code>every x*=scaleX</code> and <code>every y*=scaleY</code>.</li></ul> <p>Canvas transformations are persistent. All New drawings will continue to be transformed until you reset the canvas' transformation back to it's default state (==totally untransformed). You can reset back to default with:</p> <div class="language-html extra-class"><pre class="language-html"><code>// reset context transformations to the default (untransformed) state
context.setTransform(1,0,0,1,0,0);

</code></pre></div><h2 id="a-transformation-matrix-to-track-translated-rotated-scaled-shape-s"><a href="#a-transformation-matrix-to-track-translated-rotated-scaled-shape-s" class="header-anchor">#</a> A Transformation Matrix to track translated, rotated &amp; scaled shape(s)</h2> <p>Canvas allows you to <code>context.translate</code>, <code>context.rotate</code> and <code>context.scale</code> in order to draw your shape in the position &amp; size you require.</p> <p>Canvas itself uses a transformation matrix to efficiently track transformations.</p> <ul><li>You can change Canvas's matrix with <code>context.transform</code></li> <li>You can change Canvas's matrix with individual <code>translate, rotate &amp; scale</code> commands</li> <li>You can completely overwrite Canvas's matrix with <code>context.setTransform</code>,</li> <li><strong>But you can't read Canvas's internal transformation matrix -- it's write-only.</strong></li></ul> <h3 id="why-use-a-transformation-matrix"><a href="#why-use-a-transformation-matrix" class="header-anchor">#</a> <strong>Why use a transformation matrix?</strong></h3> <p>A transformation matrix allows you to aggregate many individual translations, rotations &amp; scalings into a single, easily reapplied matrix.</p> <p>During complex animations you might apply dozens (or hundreds) of transformations to a shape. By using a transformation matrix you can (almost) instantly reapply those dozens of transformations with a single line of code.</p> <p>Some Example uses:</p> <li>
**Test if the mouse is inside a shape that you have translated, rotated &amp; scaled**
There is a built-in `context.isPointInPath` that tests if a point (eg the mouse) is inside a path-shape, but this built-in test is very slow compared to testing using a matrix.
Efficiently testing if the mouse is inside a shape involves taking the mouse position reported by the browser and transforming it in the same way that the shape was transformed. Then you can apply hit-testing as if the shape was not transformed.
</li> <li>
**Redraw a shape that has been extensively translated, rotated &amp; scaled.**
Instead of reapplying individual transformations with multiple `.translate, .rotate, .scale` you can apply all the aggregated transformations in a single line of code.
</li> <li>
**Collision test shapes that have been translated, rotated &amp; scaled**
You can use geometry &amp; trigonometry to calculate the points that make up transformed shapes, but it's faster to use a transformation matrix to calculate those points.
</li> <h3 id="a-transformation-matrix-class"><a href="#a-transformation-matrix-class" class="header-anchor">#</a> <strong>A Transformation Matrix &quot;Class&quot;</strong></h3> <p>This code mirrors the native <code>context.translate</code>, <code>context.rotate</code>, <code>context.scale</code> transformation commands. Unlike the native canvas matrix, this matrix is readable and reusable.</p> <p>Methods:</p> <li>
`translate`, `rotate`, `scale` mirror the context transformation commands and allow you to feed transformations into the matrix. The matrix efficiently holds the aggregated transformations.
</li> <li>
`setContextTransform` takes a context and sets that context's matrix equal to this transformation matrix. This efficiently reapplies all transformations stored in this matrix to the context.
</li> <li>
`resetContextTransform` resets the context's transformation to it's default state (==untransformed).
</li> <li>
`getTransformedPoint` takes an untransformed coordinate point and converts it into a transformed point.
</li> <li>
`getScreenPoint` takes a transformed coordinate point and converts it into an untransformed point.
</li> <li>
`getMatrix` returns the aggregated transformations in the form of a matrix array.
</li> <p><strong>Code:</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> TransformationMatrix<span class="token operator">=</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// private</span>
    <span class="token keyword">var</span> self<span class="token punctuation">;</span>
    <span class="token keyword">var</span> m<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">reset</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">var</span> m<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token function-variable function">multiply</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">mat</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> m0<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> m1<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> m2<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> m3<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> m4<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> m5<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        m<span class="token operator">=</span><span class="token punctuation">[</span>m0<span class="token punctuation">,</span>m1<span class="token punctuation">,</span>m2<span class="token punctuation">,</span>m3<span class="token punctuation">,</span>m4<span class="token punctuation">,</span>m5<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token function-variable function">screenPoint</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">transformedX<span class="token punctuation">,</span>transformedY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// invert</span>
        <span class="token keyword">var</span> d <span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">-</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        im<span class="token operator">=</span><span class="token punctuation">[</span> m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>d<span class="token punctuation">,</span> <span class="token operator">-</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>d<span class="token punctuation">,</span> <span class="token operator">-</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>d<span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>d<span class="token punctuation">,</span> d<span class="token operator">*</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">-</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> d<span class="token operator">*</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">-</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// point</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            x<span class="token operator">:</span>transformedX<span class="token operator">*</span>im<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>transformedY<span class="token operator">*</span>im<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>im<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            y<span class="token operator">:</span>transformedX<span class="token operator">*</span>im<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>transformedY<span class="token operator">*</span>im<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>im<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token function-variable function">transformedPoint</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">screenX<span class="token punctuation">,</span>screenY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            x<span class="token operator">:</span>screenX<span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> screenY<span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            y<span class="token operator">:</span>screenX<span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> screenY<span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token punctuation">}</span>
    <span class="token comment">// public</span>
    <span class="token keyword">function</span> <span class="token function">TransformationMatrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        self<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// shared methods</span>
    <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">translate</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> mat<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">multiply</span><span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">rotate</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">rAngle</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> c <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>rAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> s <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>rAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> mat<span class="token operator">=</span><span class="token punctuation">[</span> c<span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token operator">-</span>s<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>    
        <span class="token function">multiply</span><span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">scale</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> mat<span class="token operator">=</span><span class="token punctuation">[</span> x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>        
        <span class="token function">multiply</span><span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">skew</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">radianX<span class="token punctuation">,</span>radianY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> mat<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">tan</span><span class="token punctuation">(</span>radianY<span class="token punctuation">)</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">tan</span><span class="token punctuation">(</span>radianX<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">multiply</span><span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">reset</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setContextTransform</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">resetContextTransform</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getTransformedPoint</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">screenX<span class="token punctuation">,</span>screenY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">transformedPoint</span><span class="token punctuation">(</span>screenX<span class="token punctuation">,</span>screenY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getScreenPoint</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">transformedX<span class="token punctuation">,</span>transformedY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">screenPoint</span><span class="token punctuation">(</span>transformedX<span class="token punctuation">,</span>transformedY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getMatrix</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> clone<span class="token operator">=</span><span class="token punctuation">[</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span>clone<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// return public</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>TransformationMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Demo:</strong></p> <p>This demo uses the Transformation Matrix &quot;Class&quot; above to:</p> <li>
Track (==save) a rectangle's transformation matrix.
</li> <li>
Redraw the transformed rectangle without using context transformation commands.
</li> <li>
Test if the mouse has clicked inside the transformed rectangle.
</li> <p><strong>Code:</strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!doctype html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body</span><span class="token punctuation">{</span> <span class="token property">background-color</span><span class="token punctuation">:</span>white<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token selector">#canvas</span><span class="token punctuation">{</span><span class="token property">border</span><span class="token punctuation">:</span>1px solid red<span class="token punctuation">;</span> <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
window<span class="token punctuation">.</span>onload<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token keyword">var</span> canvas<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> ctx<span class="token operator">=</span>canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> cw<span class="token operator">=</span>canvas<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token keyword">var</span> ch<span class="token operator">=</span>canvas<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">reOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> <span class="token constant">BB</span><span class="token operator">=</span>canvas<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        offsetX<span class="token operator">=</span><span class="token constant">BB</span><span class="token punctuation">.</span>left<span class="token punctuation">;</span>
        offsetY<span class="token operator">=</span><span class="token constant">BB</span><span class="token punctuation">.</span>top<span class="token punctuation">;</span>        
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> offsetX<span class="token punctuation">,</span>offsetY<span class="token punctuation">;</span>
    <span class="token function">reOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onscroll</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">reOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onresize</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">reOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token comment">// Transformation Matrix &quot;Class&quot;</span>
    
    <span class="token keyword">var</span> TransformationMatrix<span class="token operator">=</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// private</span>
        <span class="token keyword">var</span> self<span class="token punctuation">;</span>
        <span class="token keyword">var</span> m<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token function-variable function">reset</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">var</span> m<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">var</span> <span class="token function-variable function">multiply</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">mat</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> m0<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> m1<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> m2<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> m3<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> m4<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> m5<span class="token operator">=</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>mat<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            m<span class="token operator">=</span><span class="token punctuation">[</span>m0<span class="token punctuation">,</span>m1<span class="token punctuation">,</span>m2<span class="token punctuation">,</span>m3<span class="token punctuation">,</span>m4<span class="token punctuation">,</span>m5<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> <span class="token function-variable function">screenPoint</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">transformedX<span class="token punctuation">,</span>transformedY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// invert</span>
            <span class="token keyword">var</span> d <span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">-</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            im<span class="token operator">=</span><span class="token punctuation">[</span> m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>d<span class="token punctuation">,</span> <span class="token operator">-</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>d<span class="token punctuation">,</span> <span class="token operator">-</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>d<span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>d<span class="token punctuation">,</span> d<span class="token operator">*</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">-</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> d<span class="token operator">*</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">-</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// point</span>
            <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                x<span class="token operator">:</span>transformedX<span class="token operator">*</span>im<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>transformedY<span class="token operator">*</span>im<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>im<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                y<span class="token operator">:</span>transformedX<span class="token operator">*</span>im<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>transformedY<span class="token operator">*</span>im<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>im<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> <span class="token function-variable function">transformedPoint</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">screenX<span class="token punctuation">,</span>screenY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                x<span class="token operator">:</span>screenX<span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> screenY<span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                y<span class="token operator">:</span>screenX<span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> screenY<span class="token operator">*</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
        <span class="token punctuation">}</span>
        <span class="token comment">// public</span>
        <span class="token keyword">function</span> <span class="token function">TransformationMatrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            self<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// shared methods</span>
        <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">translate</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> mat<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">multiply</span><span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">rotate</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">rAngle</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> c <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>rAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> s <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>rAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> mat<span class="token operator">=</span><span class="token punctuation">[</span> c<span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token operator">-</span>s<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>    
            <span class="token function">multiply</span><span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">scale</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> mat<span class="token operator">=</span><span class="token punctuation">[</span> x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>        
            <span class="token function">multiply</span><span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">skew</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">radianX<span class="token punctuation">,</span>radianY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> mat<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">tan</span><span class="token punctuation">(</span>radianY<span class="token punctuation">)</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">tan</span><span class="token punctuation">(</span>radianX<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">multiply</span><span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">reset</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setContextTransform</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">resetContextTransform</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getTransformedPoint</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">screenX<span class="token punctuation">,</span>screenY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">transformedPoint</span><span class="token punctuation">(</span>screenX<span class="token punctuation">,</span>screenY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getScreenPoint</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">transformedX<span class="token punctuation">,</span>transformedY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">screenPoint</span><span class="token punctuation">(</span>transformedX<span class="token punctuation">,</span>transformedY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">TransformationMatrix</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getMatrix</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> clone<span class="token operator">=</span><span class="token punctuation">[</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">(</span>clone<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// return public</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span>TransformationMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// DEMO starts here</span>

    <span class="token comment">// create a rect and add a transformation matrix</span>
    <span class="token comment">// to track it's translations, rotations &amp; scalings</span>
    <span class="token keyword">var</span> rect<span class="token operator">=</span><span class="token punctuation">{</span>x<span class="token operator">:</span><span class="token number">30</span><span class="token punctuation">,</span>y<span class="token operator">:</span><span class="token number">30</span><span class="token punctuation">,</span>w<span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span>h<span class="token operator">:</span><span class="token number">35</span><span class="token punctuation">,</span>matrix<span class="token operator">:</span><span class="token keyword">new</span> <span class="token class-name">TransformationMatrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// draw the untransformed rect in black</span>
    ctx<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>w<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Demo: label</span>
    ctx<span class="token punctuation">.</span>font<span class="token operator">=</span><span class="token string">'11px arial'</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">'Untransformed Rect'</span><span class="token punctuation">,</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span>rect<span class="token punctuation">.</span>y<span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// transform the canvas &amp; draw the transformed rect in red</span>
    ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// draw the transformed rect</span>
    ctx<span class="token punctuation">.</span>strokeStyle<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>w<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>font<span class="token operator">=</span><span class="token string">'6px arial'</span><span class="token punctuation">;</span>
    <span class="token comment">// Demo: label</span>
    ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">'Same Rect: Translated, rotated &amp; scaled'</span><span class="token punctuation">,</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span>rect<span class="token punctuation">.</span>y<span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// reset the context to untransformed state</span>
    ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// record the transformations in the matrix</span>
    <span class="token keyword">var</span> m<span class="token operator">=</span>rect<span class="token punctuation">.</span>matrix<span class="token punctuation">;</span>
    m<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// use the rect's saved transformation matrix to reposition, </span>
    <span class="token comment">//     resize &amp; redraw the rect</span>
    ctx<span class="token punctuation">.</span>strokeStyle<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">;</span>
    <span class="token function">drawTransformedRect</span><span class="token punctuation">(</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Demo: instructions</span>
    ctx<span class="token punctuation">.</span>font<span class="token operator">=</span><span class="token string">'14px arial'</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">'Demo: click inside the blue rect'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// redraw a rect based on it's saved transformation matrix</span>
    <span class="token keyword">function</span> <span class="token function">drawTransformedRect</span><span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// set the context transformation matrix using the rect's saved matrix</span>
        m<span class="token punctuation">.</span><span class="token function">setContextTransform</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// draw the rect (no position or size changes needed!)</span>
        ctx<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span> r<span class="token punctuation">.</span>x<span class="token punctuation">,</span> r<span class="token punctuation">.</span>y<span class="token punctuation">,</span> r<span class="token punctuation">.</span>w<span class="token punctuation">,</span> r<span class="token punctuation">.</span>h <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// reset the context transformation to default (==untransformed);</span>
        m<span class="token punctuation">.</span><span class="token function">resetContextTransform</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// is the point in the transformed rectangle?</span>
    <span class="token keyword">function</span> <span class="token function">isPointInTransformedRect</span><span class="token punctuation">(</span><span class="token parameter">r<span class="token punctuation">,</span>transformedX<span class="token punctuation">,</span>transformedY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> p<span class="token operator">=</span>r<span class="token punctuation">.</span>matrix<span class="token punctuation">.</span><span class="token function">getScreenPoint</span><span class="token punctuation">(</span>transformedX<span class="token punctuation">,</span>transformedY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> x<span class="token operator">=</span>p<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
        <span class="token keyword">var</span> y<span class="token operator">=</span>p<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span>x<span class="token operator">&gt;</span>r<span class="token punctuation">.</span>x <span class="token operator">&amp;&amp;</span> x<span class="token operator">&lt;</span>r<span class="token punctuation">.</span>x<span class="token operator">+</span>r<span class="token punctuation">.</span>w <span class="token operator">&amp;&amp;</span> y<span class="token operator">&gt;</span>r<span class="token punctuation">.</span>y <span class="token operator">&amp;&amp;</span> y<span class="token operator">&lt;</span>r<span class="token punctuation">.</span>y<span class="token operator">+</span>r<span class="token punctuation">.</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 

    <span class="token comment">// listen for mousedown events</span>
    canvas<span class="token punctuation">.</span>onmousedown<span class="token operator">=</span>handleMouseDown<span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">handleMouseDown</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// tell the browser we're handling this event</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// get mouse position</span>
        mouseX<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX<span class="token operator">-</span>offsetX<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mouseY<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientY<span class="token operator">-</span>offsetY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// is the mouse inside the transformed rect?</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isPointInTransformedRect</span><span class="token punctuation">(</span>rect<span class="token punctuation">,</span>mouseX<span class="token punctuation">,</span>mouseY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'You clicked in the transformed Rect'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Demo: redraw transformed rect without using</span>
    <span class="token comment">//       context transformation commands</span>
    <span class="token keyword">function</span> <span class="token function">drawTransformedRect</span><span class="token punctuation">(</span><span class="token parameter">r<span class="token punctuation">,</span>color</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> m<span class="token operator">=</span>r<span class="token punctuation">.</span>matrix<span class="token punctuation">;</span>
        <span class="token keyword">var</span> tl<span class="token operator">=</span>m<span class="token punctuation">.</span><span class="token function">getTransformedPoint</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>x<span class="token punctuation">,</span>r<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> tr<span class="token operator">=</span>m<span class="token punctuation">.</span><span class="token function">getTransformedPoint</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>x<span class="token operator">+</span>r<span class="token punctuation">.</span>w<span class="token punctuation">,</span>r<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> br<span class="token operator">=</span>m<span class="token punctuation">.</span><span class="token function">getTransformedPoint</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>x<span class="token operator">+</span>r<span class="token punctuation">.</span>w<span class="token punctuation">,</span>r<span class="token punctuation">.</span>y<span class="token operator">+</span>r<span class="token punctuation">.</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> bl<span class="token operator">=</span>m<span class="token punctuation">.</span><span class="token function">getTransformedPoint</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>x<span class="token punctuation">,</span>r<span class="token punctuation">.</span>y<span class="token operator">+</span>r<span class="token punctuation">.</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>tl<span class="token punctuation">.</span>x<span class="token punctuation">,</span>tl<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>tr<span class="token punctuation">.</span>x<span class="token punctuation">,</span>tr<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>br<span class="token punctuation">.</span>x<span class="token punctuation">,</span>br<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>bl<span class="token punctuation">.</span>x<span class="token punctuation">,</span>bl<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span>strokeStyle<span class="token operator">=</span>color<span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// end window.onload</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span>512</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span>250</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/html/transformations.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/html/charts-diagrams.html" class="prev">
        Charts &amp; Diagrams
      </a></span> <span class="next"><a href="/html/compositing.html">
        Compositing
      </a>
      
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/1298.493094ca.js" defer></script>
  </body>
</html>
