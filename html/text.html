<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTML - Text</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Drawing Text, Formatting Text, Wrapping text into paragraphs, Draw text paragraphs into irregular shapes, Fill text with an image, Rendering text along an arc., Text on curve, cubic and quadratic beziers, Justified text, Justified paragraphs.">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="HTML - Text">
    <meta property="og:description" content="Drawing Text, Formatting Text, Wrapping text into paragraphs, Draw text paragraphs into irregular shapes, Fill text with an image, Rendering text along an arc., Text on curve, cubic and quadratic beziers, Justified text, Justified paragraphs.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/html/text.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="HTML - Text">
    <meta name="twitter:description" content="Drawing Text, Formatting Text, Wrapping text into paragraphs, Draw text paragraphs into irregular shapes, Fill text with an image, Rendering text along an arc., Text on curve, cubic and quadratic beziers, Justified text, Justified paragraphs.">
    <meta name="twitter:url" content="/html/text.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/1299.5e7e4eda.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>HTML</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/html/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/html/getting-started-with-html.html" class="sidebar-link">Getting started with HTML</a></li><li><a href="/html/doctypes.html" class="sidebar-link">Doctypes</a></li><li><a href="/html/headings.html" class="sidebar-link">Headings</a></li><li><a href="/html/paragraphs.html" class="sidebar-link">Paragraphs</a></li><li><a href="/html/text-formatting.html" class="sidebar-link">Text Formatting</a></li><li><a href="/html/anchors-and-hyperlinks.html" class="sidebar-link">Anchors and Hyperlinks</a></li><li><a href="/html/lists.html" class="sidebar-link">Lists</a></li><li><a href="/html/tables.html" class="sidebar-link">Tables</a></li><li><a href="/html/comments.html" class="sidebar-link">Comments</a></li><li><a href="/html/classes-and-ids.html" class="sidebar-link">Classes and IDs</a></li><li><a href="/html/data-attributes.html" class="sidebar-link">Data Attributes</a></li><li><a href="/html/linking-resources.html" class="sidebar-link">Linking Resources</a></li><li><a href="/html/include-javascript-code-in-html.html" class="sidebar-link">Include JavaScript Code in HTML</a></li><li><a href="/html/using-html-with-css.html" class="sidebar-link">Using HTML with CSS</a></li><li><a href="/html/images.html" class="sidebar-link">Images</a></li><li><a href="/html/image-maps.html" class="sidebar-link">Image Maps</a></li><li><a href="/html/input-control-elements.html" class="sidebar-link">Input Control Elements</a></li><li><a href="/html/forms.html" class="sidebar-link">Forms</a></li><li><a href="/html/div-element.html" class="sidebar-link">Div Element</a></li><li><a href="/html/sectioning-elements.html" class="sidebar-link">Sectioning Elements</a></li><li><a href="/html/navigation-bars.html" class="sidebar-link">Navigation Bars</a></li><li><a href="/html/label-element.html" class="sidebar-link">Label Element</a></li><li><a href="/html/output-element.html" class="sidebar-link">Output Element</a></li><li><a href="/html/void-elements.html" class="sidebar-link">Void Elements</a></li><li><a href="/html/media-elements.html" class="sidebar-link">Media Elements</a></li><li><a href="/html/progress-element.html" class="sidebar-link">Progress Element</a></li><li><a href="/html/selection-menu-controls.html" class="sidebar-link">Selection Menu Controls</a></li><li><a href="/html/embed.html" class="sidebar-link">Embed</a></li><li><a href="/html/iframes.html" class="sidebar-link">IFrames</a></li><li><a href="/html/content-languages.html" class="sidebar-link">Content Languages</a></li><li><a href="/html/svg.html" class="sidebar-link">SVG</a></li><li><a href="/html/canvas.html" class="sidebar-link">Canvas</a></li><li><a href="/html/meta-information.html" class="sidebar-link">Meta Information</a></li><li><a href="/html/marking-up-computer-code.html" class="sidebar-link">Marking up computer code</a></li><li><a href="/html/marking-up-quotes.html" class="sidebar-link">Marking-up Quotes</a></li><li><a href="/html/tabindex.html" class="sidebar-link">Tabindex</a></li><li><a href="/html/global-attributes.html" class="sidebar-link">Global Attributes</a></li><li><a href="/html/html-5-cache.html" class="sidebar-link">HTML 5 Cache</a></li><li><a href="/html/html-event-attributes.html" class="sidebar-link">HTML Event Attributes</a></li><li><a href="/html/character-entities.html" class="sidebar-link">Character Entities</a></li><li><a href="/html/aria.html" class="sidebar-link">ARIA</a></li><li><a href="/html/getting-started-with-html5-canvas.html" class="sidebar-link">Getting started with html5-canvas</a></li><li><a href="/html/text.html" aria-current="page" class="active sidebar-link">Text</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/html/text.html#drawing-text" class="sidebar-link">Drawing Text</a></li><li class="sidebar-sub-header"><a href="/html/text.html#formatting-text" class="sidebar-link">Formatting Text</a></li><li class="sidebar-sub-header"><a href="/html/text.html#wrapping-text-into-paragraphs" class="sidebar-link">Wrapping text into paragraphs</a></li><li class="sidebar-sub-header"><a href="/html/text.html#draw-text-paragraphs-into-irregular-shapes" class="sidebar-link">Draw text paragraphs into irregular shapes</a></li><li class="sidebar-sub-header"><a href="/html/text.html#fill-text-with-an-image" class="sidebar-link">Fill text with an image</a></li><li class="sidebar-sub-header"><a href="/html/text.html#rendering-text-along-an-arc" class="sidebar-link">Rendering text along an arc.</a></li><li class="sidebar-sub-header"><a href="/html/text.html#text-on-curve-cubic-and-quadratic-beziers" class="sidebar-link">Text on curve, cubic and quadratic beziers</a></li><li class="sidebar-sub-header"><a href="/html/text.html#justified-text" class="sidebar-link">Justified text</a></li><li class="sidebar-sub-header"><a href="/html/text.html#justified-paragraphs" class="sidebar-link">Justified paragraphs.</a></li></ul></li><li><a href="/html/polygons.html" class="sidebar-link">Polygons</a></li><li><a href="/html/images.html" class="sidebar-link">Images</a></li><li><a href="/html/path-syntax-only.html" class="sidebar-link">Path (Syntax only)</a></li><li><a href="/html/paths.html" class="sidebar-link">Paths</a></li><li><a href="/html/navigating-along-a-path.html" class="sidebar-link">Navigating along a Path</a></li><li><a href="/html/dragging-path-shapes-images-on-canvas.html" class="sidebar-link">Dragging Path Shapes &amp; Images on Canvas</a></li><li><a href="/html/media-types-and-the-canvas.html" class="sidebar-link">Media types and the canvas</a></li><li><a href="/html/animation.html" class="sidebar-link">Animation</a></li><li><a href="/html/collisions-and-intersections.html" class="sidebar-link">Collisions and Intersections</a></li><li><a href="/html/clearing-the-screen.html" class="sidebar-link">Clearing the screen</a></li><li><a href="/html/responsive-design.html" class="sidebar-link">Responsive Design</a></li><li><a href="/html/shadows.html" class="sidebar-link">Shadows</a></li><li><a href="/html/charts-diagrams.html" class="sidebar-link">Charts &amp; Diagrams</a></li><li><a href="/html/transformations.html" class="sidebar-link">Transformations</a></li><li><a href="/html/compositing.html" class="sidebar-link">Compositing</a></li><li><a href="/html/pixel-manipulation-with-getimagedata-and-putimagedata.html" class="sidebar-link">Pixel Manipulation with &quot;getImageData&quot; and &quot;putImageData&quot;</a></li><li><a href="/html/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="text"><a href="#text" class="header-anchor">#</a> Text</h1> <h2 id="drawing-text"><a href="#drawing-text" class="header-anchor">#</a> Drawing Text</h2> <p>Drawing to canvas isn't just limited to shapes and images. You can also draw text to the canvas.</p> <p>To draw text on the canvas, get a reference to the canvas and then call the <code>fillText</code> method on the context.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;My text&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>The three <strong>required</strong> arguments that are passed into <code>fillText</code> are:</p> <ol><li>The text that you would like to display</li> <li>The horizontal (x-axis) position</li> <li>The vertical (y-axis) position</li></ol> <p>Additionally, there is a fourth <strong>optional</strong> argument, which you can use to specify the maximum width of your text in pixels. In the example below the value of <code>200</code> restricts the maximum width of the text to 200px:</p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;My text&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Result:</p> <p><a href="http://i.stack.imgur.com/ugzVs.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/ugzVs.png" alt="Example result of using the fillText method on canvas"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>You can also draw text without a fill, and just an outline instead, using the <code>strokeText</code> method:</p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">strokeText</span><span class="token punctuation">(</span><span class="token string">&quot;My text&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Result:</p> <p><a href="http://i.stack.imgur.com/8Exp1.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/8Exp1.png" alt="Example result of using the strokeText method on canvas"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Without any font formatting properties applied, the canvas renders text at 10px in sans-serif by default, making it hard to see the difference between the result of the <code>fillText</code> and <code>strokeText</code> methods. See the <a href="http://stackoverflow.com/documentation/html5-canvas/5235/text/18589/formatting-text#t=201608091853255094075" target="_blank" rel="noopener noreferrer">Formatting Text example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for details on how to increase text size and apply other aesthetic changes to text.</p> <h2 id="formatting-text"><a href="#formatting-text" class="header-anchor">#</a> Formatting Text</h2> <p>The default font formatting provided by the <code>fillText</code> and <code>strokeText</code> methods isn't very aesthetically appealing. Fortunately the canvas API provides properties for formatting text.</p> <p>Using the <code>font</code> property you can specify:</p> <ul><li>font-style</li> <li>font-variant</li> <li>font-weight</li> <li>font-size / line-height</li> <li>font-family</li></ul> <p>For example:</p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;italic small-caps bold 40px Helvetica, Arial, sans-serif&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;My text&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Result:</p> <p><a href="http://i.stack.imgur.com/PtCie.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/PtCie.png" alt="Example result of specifying font properties"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Using the <code>textAlign</code> property you can also change text alignment to either:</p> <ul><li>left</li> <li>center</li> <li>right</li> <li>end (same as right)</li> <li>start (same as left)</li></ul> <p>For example:</p> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="wrapping-text-into-paragraphs"><a href="#wrapping-text-into-paragraphs" class="header-anchor">#</a> Wrapping text into paragraphs</h2> <p>Native Canvas API does not have a method to wrap text onto the next line when a desired maximum width is reached. This example wraps text into paragraphs.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">wrapText</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> maxWidth<span class="token punctuation">,</span> fontSize<span class="token punctuation">,</span> fontFace</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> firstY<span class="token operator">=</span>y<span class="token punctuation">;</span>
  <span class="token keyword">var</span> words <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> line <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> lineHeight<span class="token operator">=</span>fontSize<span class="token operator">*</span><span class="token number">1.286</span><span class="token punctuation">;</span> <span class="token comment">// a good approx for 10-18px sizes</span>

  ctx<span class="token punctuation">.</span>font<span class="token operator">=</span>fontSize<span class="token operator">+</span><span class="token string">&quot; &quot;</span><span class="token operator">+</span>fontFace<span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>textBaseline<span class="token operator">=</span><span class="token string">'top'</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> words<span class="token punctuation">.</span>length<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> testLine <span class="token operator">=</span> line <span class="token operator">+</span> words<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> metrics <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>testLine<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> testWidth <span class="token operator">=</span> metrics<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>testWidth <span class="token operator">&gt;</span> maxWidth<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">&lt;</span>words<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          line <span class="token operator">=</span> words<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">;</span>
          y <span class="token operator">+=</span> lineHeight<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      line <span class="token operator">=</span> testLine<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="draw-text-paragraphs-into-irregular-shapes"><a href="#draw-text-paragraphs-into-irregular-shapes" class="header-anchor">#</a> Draw text paragraphs into irregular shapes</h2> <p>This example draws text paragraphs into any portions of the canvas that have opaque pixels.</p> <p>It works by finding the next block of opaque pixels that is large enough to contain the next specified word and filling that block with the specified word.</p> <p>The opaque pixels can come from any source: Path drawing commands and /or  images.</p> <p><a href="http://i.stack.imgur.com/IfJpv.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/IfJpv.png" alt="enter image description here"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">doctype</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body</span><span class="token punctuation">{</span> <span class="token property">background-color</span><span class="token punctuation">:</span>white<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span>10px<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token selector">#canvas</span><span class="token punctuation">{</span><span class="token property">border</span><span class="token punctuation">:</span>1px solid red<span class="token punctuation">;</span><span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
window<span class="token punctuation">.</span>onload<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token keyword">var</span> canvas<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> ctx<span class="token operator">=</span>canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> cw<span class="token operator">=</span>canvas<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token keyword">var</span> ch<span class="token operator">=</span>canvas<span class="token punctuation">.</span>height<span class="token punctuation">;</span>

    <span class="token keyword">var</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> fontface<span class="token operator">=</span><span class="token string">'verdana'</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> lineHeight<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>fontsize<span class="token operator">*</span><span class="token number">1.286</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> text<span class="token operator">=</span><span class="token string">'It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way; in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only.'</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> words<span class="token operator">=</span>text<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> wordWidths<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>font<span class="token operator">=</span>fontsize<span class="token operator">+</span><span class="token string">'px '</span><span class="token operator">+</span>fontface<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>words<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span> wordWidths<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">var</span> spaceWidth<span class="token operator">=</span>ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token keyword">var</span> wordIndex<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">var</span> data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// Demo: draw Heart </span>
    <span class="token comment">// Note: the shape can be ANY opaque drawing -- even an image</span>
    ctx<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">bezierCurveTo</span><span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">bezierCurveTo</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">62.5</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">62.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">bezierCurveTo</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">bezierCurveTo</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">130</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">130</span><span class="token punctuation">,</span><span class="token number">62.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">bezierCurveTo</span><span class="token punctuation">(</span><span class="token number">130</span><span class="token punctuation">,</span><span class="token number">62.5</span><span class="token punctuation">,</span><span class="token number">130</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">bezierCurveTo</span><span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// fill heart with text</span>
    ctx<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> imgDataData<span class="token operator">=</span>ctx<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>cw<span class="token punctuation">,</span>ch<span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>imgDataData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>imgDataData<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">placeWords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   

    <span class="token comment">// draw words sequentially into next available block of </span>
    <span class="token comment">//    available opaque pixels </span>
    <span class="token keyword">function</span> <span class="token function">placeWords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> sx<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> sy<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> wordIndex<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span>textBaseline<span class="token operator">=</span><span class="token string">'top'</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>y<span class="token operator">&lt;</span>ch <span class="token operator">&amp;&amp;</span> wordIndex<span class="token operator">&lt;</span>words<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
            sx<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
            sy<span class="token operator">=</span>y<span class="token punctuation">;</span>
            <span class="token keyword">var</span> startingIndex<span class="token operator">=</span>wordIndex<span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>sx<span class="token operator">&lt;</span>cw <span class="token operator">&amp;&amp;</span> wordIndex<span class="token operator">&lt;</span>words<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">var</span> x<span class="token operator">=</span><span class="token function">getRect</span><span class="token punctuation">(</span>sx<span class="token punctuation">,</span>sy<span class="token punctuation">,</span>lineHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> available<span class="token operator">=</span>x<span class="token operator">-</span>sx<span class="token punctuation">;</span>
                <span class="token keyword">var</span> spacer<span class="token operator">=</span>spaceWidth<span class="token punctuation">;</span>  <span class="token comment">// spacer=0 to have no left margin</span>
                <span class="token keyword">var</span> w<span class="token operator">=</span>spacer<span class="token operator">+</span>wordWidths<span class="token punctuation">[</span>wordIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span><span class="token punctuation">(</span>available<span class="token operator">&gt;=</span>w<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>wordIndex<span class="token punctuation">]</span><span class="token punctuation">,</span>spacer<span class="token operator">+</span>sx<span class="token punctuation">,</span>sy<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    sx<span class="token operator">+=</span>w<span class="token punctuation">;</span>
                    available<span class="token operator">-=</span>w<span class="token punctuation">;</span>
                    spacer<span class="token operator">=</span>spaceWidth<span class="token punctuation">;</span>
                    wordIndex<span class="token operator">++</span><span class="token punctuation">;</span>
                    w<span class="token operator">=</span>spacer<span class="token operator">+</span>wordWidths<span class="token punctuation">[</span>wordIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                sx<span class="token operator">=</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            y<span class="token operator">=</span><span class="token punctuation">(</span>wordIndex<span class="token operator">&gt;</span>startingIndex<span class="token punctuation">)</span><span class="token operator">?</span>y<span class="token operator">+</span>lineHeight<span class="token operator">:</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// find a rectangular block of opaque pixels</span>
    <span class="token keyword">function</span> <span class="token function">getRect</span><span class="token punctuation">(</span><span class="token parameter">sx<span class="token punctuation">,</span>sy<span class="token punctuation">,</span>height</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> x<span class="token operator">=</span>sx<span class="token punctuation">;</span>
        <span class="token keyword">var</span> y<span class="token operator">=</span>sy<span class="token punctuation">;</span>
        <span class="token keyword">var</span> ok<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>ok<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>y<span class="token operator">*</span>cw<span class="token operator">+</span>x<span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">{</span>ok<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
            y<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>y<span class="token operator">&gt;=</span>sy<span class="token operator">+</span>height<span class="token punctuation">)</span><span class="token punctuation">{</span>
                y<span class="token operator">=</span>sy<span class="token punctuation">;</span>
                x<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">&gt;=</span>cw<span class="token punctuation">)</span><span class="token punctuation">{</span>ok<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// end $(function(){});</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span><span class="token punctuation">&gt;</span></span>Note: the shape must be closed and alpha&gt;=250 inside<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>canvas<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>400</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>400</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><h2 id="fill-text-with-an-image"><a href="#fill-text-with-an-image" class="header-anchor">#</a> Fill text with an image</h2> <p>This example fills text with a specified image.</p> <p>Important! The specified image must be fully loaded before calling this function or the drawing will fail. Use <code>image.onload</code> to be sure the image is fully loaded.</p> <p><a href="http://i.stack.imgur.com/58KTX.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/58KTX.png" alt="enter image description here"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">drawImageInsideText</span><span class="token punctuation">(</span><span class="token parameter">canvas<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>img<span class="token punctuation">,</span>text<span class="token punctuation">,</span>font</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> c<span class="token operator">=</span>canvas<span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> ctx<span class="token operator">=</span>c<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>font<span class="token operator">=</span>font<span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>globalCompositeOperation<span class="token operator">=</span><span class="token string">'source-atop'</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="rendering-text-along-an-arc"><a href="#rendering-text-along-an-arc" class="header-anchor">#</a> Rendering text along an arc.</h2> <p>This example shows how to render text along an arc. It includes how you can add functionality to the <code>CanvasRenderingContext2D</code> by extending its prototype.</p> <p>This examples is derived from the stackoverflow answer <a href="http://stackoverflow.com/a/34170195/3877726" target="_blank" rel="noopener noreferrer">Circular Text<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="example-rendering"><a href="#example-rendering" class="header-anchor">#</a> <strong>Example rendering</strong></h3> <p><a href="http://i.stack.imgur.com/KYlZg.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/KYlZg.png" alt="Example of circle text"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="example-code"><a href="#example-code" class="header-anchor">#</a> Example code</h3> <p>The example adds 3 new text rendering functions to the 2D context prototype.</p> <ul><li><strong>ctx.fillCircleText(text, x, y, radius, start, end, forward);</strong></li> <li><strong>ctx.strokeCircleText(text, x, y, radius, start, end, forward);</strong></li> <li><strong>ctx.measureCircleText(text, radius);</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token constant">FILL</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">// const to indicate filltext render</span>
    <span class="token keyword">const</span> <span class="token constant">STROKE</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> renderType <span class="token operator">=</span> <span class="token constant">FILL</span><span class="token punctuation">;</span> <span class="token comment">// used internal to set fill or stroke text</span>
    <span class="token keyword">const</span> multiplyCurrentTransform <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// if true Use current transform when rendering</span>
                                           <span class="token comment">// if false use absolute coordinates which is a little quicker</span>
                                           <span class="token comment">// after render the currentTransform is restored to default transform</span>
                                           
      

    <span class="token comment">// measure circle text</span>
    <span class="token comment">// ctx: canvas context</span>
    <span class="token comment">// text: string of text to measure</span>
    <span class="token comment">// r: radius in pixels</span>
    <span class="token comment">//</span>
    <span class="token comment">// returns the size metrics of the text</span>
    <span class="token comment">//</span>
    <span class="token comment">// width: Pixel width of text</span>
    <span class="token comment">// angularWidth : angular width of text in radians</span>
    <span class="token comment">// pixelAngularSize : angular width of a pixel in radians</span>
    <span class="token keyword">var</span> <span class="token function-variable function">measure</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> text<span class="token punctuation">,</span> radius</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        
        <span class="token keyword">var</span> textWidth <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span> <span class="token comment">// get the width of all the text</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            width               <span class="token operator">:</span> textWidth<span class="token punctuation">,</span>
            angularWidth        <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> radius<span class="token punctuation">)</span> <span class="token operator">*</span> textWidth<span class="token punctuation">,</span>
            pixelAngularSize    <span class="token operator">:</span> <span class="token number">1</span> <span class="token operator">/</span> radius
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// displays text along a circle</span>
    <span class="token comment">// ctx: canvas context</span>
    <span class="token comment">// text: string of text to measure</span>
    <span class="token comment">// x,y: position of circle center</span>
    <span class="token comment">// r: radius of circle in pixels</span>
    <span class="token comment">// start: angle in radians to start. </span>
    <span class="token comment">// [end]: optional. If included text align is ignored and the text is </span>
    <span class="token comment">//        scaled to fit between start and end;</span>
    <span class="token comment">// [forward]: optional default true. if true text direction is forwards, if false  direction is backward</span>
    <span class="token keyword">var</span> <span class="token function-variable function">circleText</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> radius<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> forward</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> i<span class="token punctuation">,</span> textWidth<span class="token punctuation">,</span> pA<span class="token punctuation">,</span> pAS<span class="token punctuation">,</span> a<span class="token punctuation">,</span> aw<span class="token punctuation">,</span> wScale<span class="token punctuation">,</span> aligned<span class="token punctuation">,</span> dir<span class="token punctuation">,</span> fontSize<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;&quot;</span> <span class="token operator">||</span> ctx<span class="token punctuation">.</span>globalAlpha <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// dont render empty string or transparent</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isNaN</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isNaN</span><span class="token punctuation">(</span>radius<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isNaN</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>end <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> end <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isNaN</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// </span>
            <span class="token keyword">throw</span> <span class="token function">TypeError</span><span class="token punctuation">(</span><span class="token string">&quot;circle text arguments requires a number for x,y, radius, start, and end.&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        aligned <span class="token operator">=</span> ctx<span class="token punctuation">.</span>textAlign<span class="token punctuation">;</span>        <span class="token comment">// save the current textAlign so that it can be restored at end</span>
        dir <span class="token operator">=</span> forward <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> forward <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// set dir if not true or false set forward as true  </span>
        pAS <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> radius<span class="token punctuation">;</span>               <span class="token comment">// get the angular size of a pixel in radians</span>
        textWidth <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span> <span class="token comment">// get the width of all the text</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>end <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> end <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// if end is supplied then fit text between start and end</span>
            pA <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">/</span> textWidth<span class="token punctuation">)</span> <span class="token operator">*</span> dir<span class="token punctuation">;</span>
            wScale <span class="token operator">=</span> <span class="token punctuation">(</span>pA <span class="token operator">/</span> pAS<span class="token punctuation">)</span> <span class="token operator">*</span> dir<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                 <span class="token comment">// if no end is supplied correct start and end for alignment</span>
            <span class="token comment">// if forward is not given then swap top of circle text to read the correct direction</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>forward <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> forward <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>start <span class="token operator">%</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    dir <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            pA <span class="token operator">=</span> <span class="token operator">-</span>pAS <span class="token operator">*</span> dir <span class="token punctuation">;</span>
            wScale <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">*</span> dir<span class="token punctuation">;</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span>aligned<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token string">&quot;center&quot;</span><span class="token operator">:</span>       <span class="token comment">// if centered move around half width</span>
                start <span class="token operator">-=</span> <span class="token punctuation">(</span>pA <span class="token operator">*</span> textWidth <span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
                end <span class="token operator">=</span> start <span class="token operator">+</span> pA <span class="token operator">*</span> textWidth<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">&quot;right&quot;</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span> intentionally falls through to <span class="token keyword">case</span> <span class="token string">&quot;end&quot;</span>
            <span class="token keyword">case</span> <span class="token string">&quot;end&quot;</span><span class="token operator">:</span>
                end <span class="token operator">=</span> start<span class="token punctuation">;</span>
                start <span class="token operator">-=</span> pA <span class="token operator">*</span> textWidth<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">&quot;left&quot;</span><span class="token operator">:</span>  <span class="token comment">// intentionally falls through to case &quot;start&quot;</span>
            <span class="token keyword">case</span> <span class="token string">&quot;start&quot;</span><span class="token operator">:</span>
                end <span class="token operator">=</span> start <span class="token operator">+</span> pA <span class="token operator">*</span> textWidth<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">;</span>                     <span class="token comment">// align for rendering</span>
        a <span class="token operator">=</span> start<span class="token punctuation">;</span>                                    <span class="token comment">// set the start angle</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> text<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// for each character</span>
            aw <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">*</span> pA<span class="token punctuation">;</span> <span class="token comment">// get the angular width of the text</span>
            <span class="token keyword">var</span> xDx <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>a <span class="token operator">+</span> aw <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// get the yAxies vector from the center x,y out</span>
            <span class="token keyword">var</span> xDy <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>a <span class="token operator">+</span> aw <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>multiplyCurrentTransform<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// transform multiplying current transform</span>
                ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>xDy <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// is the text upside down. If it is flip it</span>
                    ctx<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token operator">-</span>xDy <span class="token operator">*</span> wScale<span class="token punctuation">,</span> xDx <span class="token operator">*</span> wScale<span class="token punctuation">,</span> <span class="token operator">-</span>xDx<span class="token punctuation">,</span> <span class="token operator">-</span>xDy<span class="token punctuation">,</span> xDx <span class="token operator">*</span> radius <span class="token operator">+</span> x<span class="token punctuation">,</span> xDy <span class="token operator">*</span> radius <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    ctx<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token operator">-</span>xDy <span class="token operator">*</span> wScale<span class="token punctuation">,</span> xDx <span class="token operator">*</span> wScale<span class="token punctuation">,</span> xDx<span class="token punctuation">,</span> xDy<span class="token punctuation">,</span> xDx <span class="token operator">*</span> radius <span class="token operator">+</span> x<span class="token punctuation">,</span> xDy <span class="token operator">*</span> radius <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>xDy <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// is the text upside down. If it is flip it</span>
                    ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span><span class="token operator">-</span>xDy <span class="token operator">*</span> wScale<span class="token punctuation">,</span> xDx <span class="token operator">*</span> wScale<span class="token punctuation">,</span> <span class="token operator">-</span>xDx<span class="token punctuation">,</span> <span class="token operator">-</span>xDy<span class="token punctuation">,</span> xDx <span class="token operator">*</span> radius <span class="token operator">+</span> x<span class="token punctuation">,</span> xDy <span class="token operator">*</span> radius <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span><span class="token operator">-</span>xDy <span class="token operator">*</span> wScale<span class="token punctuation">,</span> xDx <span class="token operator">*</span> wScale<span class="token punctuation">,</span> xDx<span class="token punctuation">,</span> xDy<span class="token punctuation">,</span> xDx <span class="token operator">*</span> radius <span class="token operator">+</span> x<span class="token punctuation">,</span> xDy <span class="token operator">*</span> radius <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>renderType <span class="token operator">===</span> <span class="token constant">FILL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// render the character</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                    
                ctx<span class="token punctuation">.</span><span class="token function">strokeText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// render the character</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>multiplyCurrentTransform<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// restore current transform</span>
                ctx<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            a <span class="token operator">+=</span> aw<span class="token punctuation">;</span>                     <span class="token comment">// step to the next angle</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// all done clean up.</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>multiplyCurrentTransform<span class="token punctuation">)</span><span class="token punctuation">{</span>
            ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// restore the transform</span>
        <span class="token punctuation">}</span>
        ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> aligned<span class="token punctuation">;</span>            <span class="token comment">// restore the text alignment</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// define fill text</span>
    <span class="token keyword">var</span> <span class="token function-variable function">fillCircleText</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> radius<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> forward</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        renderType <span class="token operator">=</span> <span class="token constant">FILL</span><span class="token punctuation">;</span>
        <span class="token function">circleText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> radius<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> forward<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// define stroke text</span>
    <span class="token keyword">var</span> <span class="token function-variable function">strokeCircleText</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> radius<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> forward</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        renderType <span class="token operator">=</span> <span class="token constant">STROKE</span><span class="token punctuation">;</span>
        <span class="token function">circleText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> radius<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> forward<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// define measure text</span>
    <span class="token keyword">var</span> <span class="token function-variable function">measureCircleTextExt</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span>radius</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">measure</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> radius<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// set the prototypes</span>
    <span class="token class-name">CanvasRenderingContext2D</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>fillCircleText <span class="token operator">=</span> fillCircleText<span class="token punctuation">;</span>
    <span class="token class-name">CanvasRenderingContext2D</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>strokeCircleText <span class="token operator">=</span> strokeCircleText<span class="token punctuation">;</span>
    <span class="token class-name">CanvasRenderingContext2D</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>measureCircleText <span class="token operator">=</span> measureCircleTextExt<span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="function-descriptions"><a href="#function-descriptions" class="header-anchor">#</a> <strong>Function descriptions</strong></h3> <p>This example adds 3 functions to the <code>CanvasRenderingContext2D prototype</code>.  <code>fillCircleText</code>, <code>strokeCircleText</code>, and <code>measureCircleText</code></p> <h3 id="canvasrenderingcontext2d-fillcircletext-text-x-y-radius-start-end-forward"><a href="#canvasrenderingcontext2d-fillcircletext-text-x-y-radius-start-end-forward" class="header-anchor">#</a> <strong>CanvasRenderingContext2D.fillCircleText(text, x, y, radius, start, [end, [forward]]);</strong><br></h3> <h3 id="canvasrenderingcontext2d-strokecircletext-text-x-y-radius-start-end-forward"><a href="#canvasrenderingcontext2d-strokecircletext-text-x-y-radius-start-end-forward" class="header-anchor">#</a> <strong>CanvasRenderingContext2D.strokeCircleText(text, x, y, radius, start, [end, [forward]]);</strong></h3> <ul><li><strong>text:</strong> Text to render as String.</li> <li><strong>x</strong>,<strong>y</strong>: Position of circle center as Numbers.</li> <li><strong>radius:</strong> radius of circle in pixels</li> <li><strong>start:</strong> angle in radians to start.</li> <li><strong>[end]:</strong> optional. If included <code>ctx.textAlign</code> is ignored and the text is scaled to fit between start and end.</li> <li><strong>[forward]:</strong> optional default 'true'. if true text direction is forwards, if 'false'  direction is backward.</li></ul> <p>Both functions use the textBaseline to position the text vertically around the radius. For the best results use <code>ctx.TextBaseline</code>.</p> <p>Functions will throw a <code>TypeError</code> is any of the numerical arguments as NaN.</p> <p>If the <code>text</code> argument trims to an empty string or <code>ctx.globalAlpha = 0</code> the function just drops through and does nothing.</p> <h3 id="canvasrenderingcontext2d-measurecircletext-text-radius"><a href="#canvasrenderingcontext2d-measurecircletext-text-radius" class="header-anchor">#</a> <strong>CanvasRenderingContext2D.measureCircleText(text, radius);</strong></h3> <div class="language- extra-class"><pre class="language-text"><code>
- **text:** String of text to measure.
 - **radius:** radius of circle in pixels.

</code></pre></div><p>Returns a Object containing various size metrics for rendering circular text</p> <div class="language- extra-class"><pre class="language-text"><code>
  - **width:** Pixel width of text as it would normaly be rendered
   - **angularWidth:** angular width of text in radians.
   - **pixelAngularSize:** angular width of a pixel in radians.

</code></pre></div><h3 id="usage-examples"><a href="#usage-examples" class="header-anchor">#</a> <strong>Usage examples</strong></h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> rad <span class="token operator">=</span> canvas<span class="token punctuation">.</span>height <span class="token operator">*</span> <span class="token number">0.4</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token string">&quot;Hello circle TEXT!&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fontSize <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> centX <span class="token operator">=</span> canvas<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> centY <span class="token operator">=</span> canvas<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span>canvas<span class="token punctuation">.</span>height<span class="token punctuation">)</span>

ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> fontSize <span class="token operator">+</span> <span class="token string">&quot;px verdana&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">&quot;bottom&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#000&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;#666&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// Text under stretched from Math.PI to 0 (180 - 0 deg)</span>
ctx<span class="token punctuation">.</span><span class="token function">fillCircleText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> centX<span class="token punctuation">,</span> centY<span class="token punctuation">,</span> rad<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// text over top centered at Math.PI * 1.5 ( 270 deg)</span>
ctx<span class="token punctuation">.</span><span class="token function">fillCircleText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> centX<span class="token punctuation">,</span> centY<span class="token punctuation">,</span> rad<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// text under top centered at Math.PI * 1.5 ( 270 deg)</span>
ctx<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">&quot;top&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillCircleText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> centX<span class="token punctuation">,</span> centY<span class="token punctuation">,</span> rad<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// text over top centered at Math.PI * 1.5 ( 270 deg)</span>
ctx<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">&quot;middle&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillCircleText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> centX<span class="token punctuation">,</span> centY<span class="token punctuation">,</span> rad<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// Use measureCircleText to get angular size</span>
<span class="token keyword">var</span> circleTextMetric <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureCircleText</span><span class="token punctuation">(</span><span class="token string">&quot;Text to measure&quot;</span><span class="token punctuation">,</span> rad<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>circleTextMetric<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// width of text if rendered normally</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>circleTextMetric<span class="token punctuation">.</span>angularWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// angular width of text</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>circleTextMetric<span class="token punctuation">.</span>pixelAngularSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// angular size of a pixel    </span>



<span class="token comment">// Use measure text to draw a arc around the text</span>
ctx<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">&quot;middle&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> width <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureCircleText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> rad<span class="token punctuation">)</span><span class="token punctuation">.</span>angularWidth<span class="token punctuation">;</span>    
ctx<span class="token punctuation">.</span><span class="token function">fillCircleText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> centX<span class="token punctuation">,</span> centY<span class="token punctuation">,</span> rad<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// render the arc around the text</span>
ctx<span class="token punctuation">.</span>strokeStyle<span class="token operator">=</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>centX<span class="token punctuation">,</span> centY<span class="token punctuation">,</span> rad <span class="token operator">+</span> fontSize <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">1.5</span> <span class="token operator">-</span> width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">*</span><span class="token number">1.5</span> <span class="token operator">+</span> width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>centX<span class="token punctuation">,</span> centY<span class="token punctuation">,</span> rad <span class="token operator">-</span> fontSize <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">1.5</span> <span class="token operator">+</span> width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">*</span><span class="token number">1.5</span> <span class="token operator">-</span> width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><blockquote></blockquote> <p><strong>NOTE:</strong> The text rendered is only an approximation of circular text. For example if two l's are rendered the two lines will not be parallel, but if you render a &quot;H&quot; the two edges will be parallel. This is because each character is rendered as close as possible to the required direction, rather than each pixel being correctly transformed to create circular text.</p> <blockquote></blockquote> <p>**NOTE:** `const multiplyCurrentTransform = true;` defined in this example is used to set the transformation method used. If `false` the transformation for circular text rendering is absolute and does not depend on the current transformation state. The text will not be effected by any previous scale, rotate, or translate transforms. This will increase the performance of the render function, after the function is called the transform will be set to the default `setTransform(1,0,0,1,0,0)` <br><br>
If `multiplyCurrentTransform = true` (set as default in this example) the text will use the current transform so that the text can be scaled translated, skewed, rotated, etc but modifying the current transform befor calling the `fillCircleText` and `strokeCircleText` functions. Depending on the current state of the 2D context this may be somewhat slower then `multiplyCurrentTransform = false`</p> <h2 id="text-on-curve-cubic-and-quadratic-beziers"><a href="#text-on-curve-cubic-and-quadratic-beziers" class="header-anchor">#</a> Text on curve, cubic and quadratic beziers</h2> <p><a href="http://i.stack.imgur.com/Tsyf1.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/Tsyf1.png" alt="enter image description here"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>textOnCurve(text,offset,x1,y1,x2,y2,x3,y3,x4,y4)</strong></p> <p>Renders text on quadratic and cubic curves.</p> <ul><li><code>text</code> is the text to render</li> <li><code>offset</code> distance from start of curve to text &gt;= 0</li> <li><code>x1,y1</code> - <code>x3,y3</code> points of quadratic curve or</li> <li><code>x1,y1</code> - <code>x4,y4</code> points of cubic curve or</li></ul> <h3 id="example-usage"><a href="#example-usage" class="header-anchor">#</a> Example usage:</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">textOnCurve</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world!&quot;</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// draws text on quadratic curve</span>
                                                        <span class="token comment">// 50 pixels from start of curve</span>


<span class="token function">textOnCurve</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world!&quot;</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
                                                        <span class="token comment">// draws text on cubic curve</span>
                                                        <span class="token comment">// 50 pixels from start of curve</span>

</code></pre></div><p>The Function and curver helper function</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// pass 8 values for cubic bezier</span>
<span class="token comment">// pass 6 values for quadratic</span>
<span class="token comment">// Renders text from start of curve</span>
<span class="token keyword">var</span> <span class="token function-variable function">textOnCurve</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span>offset<span class="token punctuation">,</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span>x3<span class="token punctuation">,</span>y3<span class="token punctuation">,</span>x4<span class="token punctuation">,</span>y4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> widths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> text<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        widths<span class="token punctuation">[</span>widths<span class="token punctuation">.</span>length<span class="token punctuation">]</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> ch <span class="token operator">=</span> <span class="token function">curveHelper</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span>x3<span class="token punctuation">,</span>y3<span class="token punctuation">,</span>x4<span class="token punctuation">,</span>y4<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> offset<span class="token punctuation">;</span>
    <span class="token keyword">var</span> cpos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> text<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        pos <span class="token operator">+=</span> widths<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        cpos <span class="token operator">=</span> ch<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ch<span class="token punctuation">.</span><span class="token function">tangent</span><span class="token punctuation">(</span>cpos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span>ch<span class="token punctuation">.</span>vect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> ch<span class="token punctuation">.</span>vect<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token operator">-</span>ch<span class="token punctuation">.</span>vect<span class="token punctuation">.</span>y<span class="token punctuation">,</span> ch<span class="token punctuation">.</span>vect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> ch<span class="token punctuation">.</span>vec<span class="token punctuation">.</span>x<span class="token punctuation">,</span> ch<span class="token punctuation">.</span>vec<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     

        pos <span class="token operator">+=</span> widths<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ctx<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>The curve helper function is designed to increase the performance of finding points on the bezier.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// helper function locates points on bezier curves.</span>
<span class="token keyword">function</span> <span class="token function">curveHelper</span><span class="token punctuation">(</span><span class="token parameter">x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">,</span> x3<span class="token punctuation">,</span> y3<span class="token punctuation">,</span> x4<span class="token punctuation">,</span> y4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> tx1<span class="token punctuation">,</span> ty1<span class="token punctuation">,</span> tx2<span class="token punctuation">,</span> ty2<span class="token punctuation">,</span> tx3<span class="token punctuation">,</span> ty3<span class="token punctuation">,</span> tx4<span class="token punctuation">,</span> ty4<span class="token punctuation">;</span>
    <span class="token keyword">var</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>u<span class="token punctuation">;</span>
    <span class="token keyword">var</span> vec<span class="token punctuation">,</span>currentPos<span class="token punctuation">,</span>vec1<span class="token punctuation">,</span>vect<span class="token punctuation">;</span>
    vec <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>y<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    vec1 <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>y<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    vect <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>y<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    quad <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    currentPos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    currentDist <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x4 <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> x4 <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        quad <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        x4 <span class="token operator">=</span> x3<span class="token punctuation">;</span>
        y4 <span class="token operator">=</span> y3<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> estLen <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x4 <span class="token operator">-</span> x1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x4 <span class="token operator">-</span> x1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y4 <span class="token operator">-</span> y1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y4 <span class="token operator">-</span> y1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> onePix <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> estLen<span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">posAtC</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        tx1 <span class="token operator">=</span> x1<span class="token punctuation">;</span> ty1 <span class="token operator">=</span> y1<span class="token punctuation">;</span>
        tx2 <span class="token operator">=</span> x2<span class="token punctuation">;</span> ty2 <span class="token operator">=</span> y2<span class="token punctuation">;</span>
        tx3 <span class="token operator">=</span> x3<span class="token punctuation">;</span> ty3 <span class="token operator">=</span> y3<span class="token punctuation">;</span>
        tx1 <span class="token operator">+=</span> <span class="token punctuation">(</span>tx2 <span class="token operator">-</span> tx1<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        ty1 <span class="token operator">+=</span> <span class="token punctuation">(</span>ty2 <span class="token operator">-</span> ty1<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        tx2 <span class="token operator">+=</span> <span class="token punctuation">(</span>tx3 <span class="token operator">-</span> tx2<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        ty2 <span class="token operator">+=</span> <span class="token punctuation">(</span>ty3 <span class="token operator">-</span> ty2<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        tx3 <span class="token operator">+=</span> <span class="token punctuation">(</span>x4 <span class="token operator">-</span> tx3<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        ty3 <span class="token operator">+=</span> <span class="token punctuation">(</span>y4 <span class="token operator">-</span> ty3<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        tx1 <span class="token operator">+=</span> <span class="token punctuation">(</span>tx2 <span class="token operator">-</span> tx1<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        ty1 <span class="token operator">+=</span> <span class="token punctuation">(</span>ty2 <span class="token operator">-</span> ty1<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        tx2 <span class="token operator">+=</span> <span class="token punctuation">(</span>tx3 <span class="token operator">-</span> tx2<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        ty2 <span class="token operator">+=</span> <span class="token punctuation">(</span>ty3 <span class="token operator">-</span> ty2<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        vec<span class="token punctuation">.</span>x <span class="token operator">=</span> tx1 <span class="token operator">+</span> <span class="token punctuation">(</span>tx2 <span class="token operator">-</span> tx1<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        vec<span class="token punctuation">.</span>y <span class="token operator">=</span> ty1 <span class="token operator">+</span> <span class="token punctuation">(</span>ty2 <span class="token operator">-</span> ty1<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>    
        <span class="token keyword">return</span> vec<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">posAtQ</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        tx1 <span class="token operator">=</span> x1<span class="token punctuation">;</span> ty1 <span class="token operator">=</span> y1<span class="token punctuation">;</span>
        tx2 <span class="token operator">=</span> x2<span class="token punctuation">;</span> ty2 <span class="token operator">=</span> y2<span class="token punctuation">;</span>
        tx1 <span class="token operator">+=</span> <span class="token punctuation">(</span>tx2 <span class="token operator">-</span> tx1<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        ty1 <span class="token operator">+=</span> <span class="token punctuation">(</span>ty2 <span class="token operator">-</span> ty1<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        tx2 <span class="token operator">+=</span> <span class="token punctuation">(</span>x3 <span class="token operator">-</span> tx2<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        ty2 <span class="token operator">+=</span> <span class="token punctuation">(</span>y3 <span class="token operator">-</span> ty2<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        vec<span class="token punctuation">.</span>x <span class="token operator">=</span> tx1 <span class="token operator">+</span> <span class="token punctuation">(</span>tx2 <span class="token operator">-</span> tx1<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        vec<span class="token punctuation">.</span>y <span class="token operator">=</span> ty1 <span class="token operator">+</span> <span class="token punctuation">(</span>ty2 <span class="token operator">-</span> ty1<span class="token punctuation">)</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
        <span class="token keyword">return</span> vec<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>    
    <span class="token keyword">function</span> <span class="token function">forward</span><span class="token punctuation">(</span><span class="token parameter">dist</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> step<span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">posAt</span><span class="token punctuation">(</span>currentPos<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span><span class="token punctuation">(</span>currentDist <span class="token operator">&lt;</span> dist<span class="token punctuation">)</span><span class="token punctuation">{</span>
            vec1<span class="token punctuation">.</span>x <span class="token operator">=</span> vec<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
            vec1<span class="token punctuation">.</span>y <span class="token operator">=</span> vec<span class="token punctuation">.</span>y<span class="token punctuation">;</span>            
            currentPos <span class="token operator">+=</span> onePix<span class="token punctuation">;</span>
            helper<span class="token punctuation">.</span><span class="token function">posAt</span><span class="token punctuation">(</span>currentPos<span class="token punctuation">)</span><span class="token punctuation">;</span>
            currentDist <span class="token operator">+=</span> step <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span>x <span class="token operator">-</span> vec1<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>vec<span class="token punctuation">.</span>x <span class="token operator">-</span> vec1<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>vec<span class="token punctuation">.</span>y <span class="token operator">-</span> vec1<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>vec<span class="token punctuation">.</span>y <span class="token operator">-</span> vec1<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
        currentPos <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>currentDist <span class="token operator">-</span> dist<span class="token punctuation">)</span> <span class="token operator">/</span> step<span class="token punctuation">)</span> <span class="token operator">*</span> onePix
        currentDist <span class="token operator">-=</span> step<span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">posAt</span><span class="token punctuation">(</span>currentPos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        currentDist <span class="token operator">+=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span>x <span class="token operator">-</span> vec1<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>vec<span class="token punctuation">.</span>x <span class="token operator">-</span> vec1<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>vec<span class="token punctuation">.</span>y <span class="token operator">-</span> vec1<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>vec<span class="token punctuation">.</span>y <span class="token operator">-</span> vec1<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> currentPos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">function</span> <span class="token function">tangentQ</span><span class="token punctuation">(</span><span class="token parameter">pos</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>pos<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
        b <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
        vect<span class="token punctuation">.</span>x <span class="token operator">=</span> a <span class="token operator">*</span> <span class="token punctuation">(</span>x2 <span class="token operator">-</span> x1<span class="token punctuation">)</span> <span class="token operator">+</span> b <span class="token operator">*</span> <span class="token punctuation">(</span>x3 <span class="token operator">-</span> x2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        vect<span class="token punctuation">.</span>y <span class="token operator">=</span> a <span class="token operator">*</span> <span class="token punctuation">(</span>y2 <span class="token operator">-</span> y1<span class="token punctuation">)</span> <span class="token operator">+</span> b <span class="token operator">*</span> <span class="token punctuation">(</span>y3 <span class="token operator">-</span> y2<span class="token punctuation">)</span><span class="token punctuation">;</span>       
        u <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>vect<span class="token punctuation">.</span>x <span class="token operator">*</span> vect<span class="token punctuation">.</span>x <span class="token operator">+</span> vect<span class="token punctuation">.</span>y <span class="token operator">*</span> vect<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        vect<span class="token punctuation">.</span>x <span class="token operator">/=</span> u<span class="token punctuation">;</span>
        vect<span class="token punctuation">.</span>y <span class="token operator">/=</span> u<span class="token punctuation">;</span>        
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">tangentC</span><span class="token punctuation">(</span><span class="token parameter">pos</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        a  <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>pos<span class="token punctuation">)</span>
        b  <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">*</span> a <span class="token operator">*</span> pos<span class="token punctuation">;</span>       
        a <span class="token operator">*=</span> <span class="token number">3</span> <span class="token operator">*</span> a<span class="token punctuation">;</span>                  
        c  <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">*</span> pos <span class="token operator">*</span> pos<span class="token punctuation">;</span> 
        vect<span class="token punctuation">.</span>x  <span class="token operator">=</span> <span class="token operator">-</span>x1 <span class="token operator">*</span> a <span class="token operator">+</span> x2 <span class="token operator">*</span> <span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">+</span> x3 <span class="token operator">*</span> <span class="token punctuation">(</span>b <span class="token operator">-</span> c<span class="token punctuation">)</span> <span class="token operator">+</span> x4 <span class="token operator">*</span> c<span class="token punctuation">;</span>
        vect<span class="token punctuation">.</span>y  <span class="token operator">=</span> <span class="token operator">-</span>y1 <span class="token operator">*</span> a <span class="token operator">+</span> y2 <span class="token operator">*</span> <span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">+</span> y3 <span class="token operator">*</span> <span class="token punctuation">(</span>b <span class="token operator">-</span> c<span class="token punctuation">)</span> <span class="token operator">+</span> y4 <span class="token operator">*</span> c<span class="token punctuation">;</span>
        u <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>vect<span class="token punctuation">.</span>x <span class="token operator">*</span> vect<span class="token punctuation">.</span>x <span class="token operator">+</span> vect<span class="token punctuation">.</span>y <span class="token operator">*</span> vect<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        vect<span class="token punctuation">.</span>x <span class="token operator">/=</span> u<span class="token punctuation">;</span>
        vect<span class="token punctuation">.</span>y <span class="token operator">/=</span> u<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  
    <span class="token keyword">var</span> helper <span class="token operator">=</span> <span class="token punctuation">{</span>
        vec <span class="token operator">:</span> vec<span class="token punctuation">,</span>
        vect <span class="token operator">:</span> vect<span class="token punctuation">,</span>
        forward <span class="token operator">:</span> forward<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>quad<span class="token punctuation">)</span><span class="token punctuation">{</span>
        helper<span class="token punctuation">.</span>posAt <span class="token operator">=</span> posAtQ<span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span>tangent <span class="token operator">=</span> tangentQ<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        helper<span class="token punctuation">.</span>posAt <span class="token operator">=</span> posAtC<span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span>tangent <span class="token operator">=</span> tangentC<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> helper
<span class="token punctuation">}</span>

</code></pre></div><h2 id="justified-text"><a href="#justified-text" class="header-anchor">#</a> Justified text</h2> <p>This example renders justified text. It adds extra functionality to the <code>CanvasRenderingContext2D</code> by extending its prototype or as a global object <code>justifiedText</code> (optional see Note A).</p> <h3 id="example-rendering-2"><a href="#example-rendering-2" class="header-anchor">#</a> Example rendering.</h3> <p><a href="http://i.stack.imgur.com/ndKly.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/ndKly.png" alt="enter image description here"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <sub><strong>Code to render this image is in the usage examples at the bottom</strong>.</sub></p> <h3 id="the-example"><a href="#the-example" class="header-anchor">#</a> The Example</h3> <p>The function as a anonymous immediately invoked function.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token constant">FILL</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">// const to indicate filltext render</span>
    <span class="token keyword">const</span> <span class="token constant">STROKE</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token constant">MEASURE</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> renderType <span class="token operator">=</span> <span class="token constant">FILL</span><span class="token punctuation">;</span> <span class="token comment">// used internal to set fill or stroke text</span>
    
    <span class="token keyword">var</span> maxSpaceSize <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// Multiplier for max space size. If greater then no justificatoin applied</span>
    <span class="token keyword">var</span> minSpaceSize <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span> <span class="token comment">// Multiplier for minimum space size</span>
    <span class="token keyword">var</span> <span class="token function-variable function">renderTextJustified</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span>text<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>width</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> words<span class="token punctuation">,</span> wordsWidth<span class="token punctuation">,</span> count<span class="token punctuation">,</span> spaces<span class="token punctuation">,</span> spaceWidth<span class="token punctuation">,</span> adjSpace<span class="token punctuation">,</span> renderer<span class="token punctuation">,</span> i<span class="token punctuation">,</span> textAlign<span class="token punctuation">,</span> useSize<span class="token punctuation">,</span> totalWidth<span class="token punctuation">;</span>
        textAlign <span class="token operator">=</span> ctx<span class="token punctuation">.</span>textAlign<span class="token punctuation">;</span> <span class="token comment">// get current align settings</span>
        ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">;</span>
        wordsWidth <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        words <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">word</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> w <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>                
            wordsWidth <span class="token operator">+=</span> w<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                width <span class="token operator">:</span> w<span class="token punctuation">,</span>
                word <span class="token operator">:</span> word<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// count = num words, spaces = number spaces, spaceWidth normal space size</span>
        <span class="token comment">// adjSpace new space size &gt;= min size. useSize Resulting space size used to render</span>
        count <span class="token operator">=</span> words<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        spaces <span class="token operator">=</span> count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        spaceWidth <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>
        adjSpace <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>spaceWidth <span class="token operator">*</span> minSpaceSize<span class="token punctuation">,</span> <span class="token punctuation">(</span>width <span class="token operator">-</span> wordsWidth<span class="token punctuation">)</span> <span class="token operator">/</span> spaces<span class="token punctuation">)</span><span class="token punctuation">;</span>
        useSize <span class="token operator">=</span> adjSpace <span class="token operator">&gt;</span> spaceWidth <span class="token operator">*</span> maxSpaceSize <span class="token operator">?</span> spaceWidth <span class="token operator">:</span> adjSpace<span class="token punctuation">;</span>
        totalWidth <span class="token operator">=</span> wordsWidth <span class="token operator">+</span> useSize <span class="token operator">*</span> spaces
        <span class="token keyword">if</span><span class="token punctuation">(</span>renderType <span class="token operator">===</span> <span class="token constant">MEASURE</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// if measuring return size</span>
            ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> textAlign<span class="token punctuation">;</span>
            <span class="token keyword">return</span> totalWidth<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        renderer <span class="token operator">=</span> renderType <span class="token operator">===</span> <span class="token constant">FILL</span> <span class="token operator">?</span> ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">:</span> ctx<span class="token punctuation">.</span><span class="token function">strokeText</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// fill or stroke</span>
        <span class="token keyword">switch</span><span class="token punctuation">(</span>textAlign<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token string">&quot;right&quot;</span><span class="token operator">:</span>
                x <span class="token operator">-=</span> totalWidth<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">&quot;end&quot;</span><span class="token operator">:</span>
                x <span class="token operator">+=</span> width <span class="token operator">-</span> totalWidth<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">&quot;center&quot;</span><span class="token operator">:</span> <span class="token comment">// intentional fall through to default</span>
                x <span class="token operator">-=</span> totalWidth <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>                     
            <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>useSize <span class="token operator">===</span> spaceWidth<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// if space size unchanged</span>
            <span class="token function">renderer</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token function">renderer</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>word<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                x <span class="token operator">+=</span> words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>
                x <span class="token operator">+=</span> useSize<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> textAlign<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Parse vet and set settings object.</span>
    <span class="token keyword">var</span> <span class="token function-variable function">justifiedTextSettings</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> min<span class="token punctuation">,</span>max<span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token function-variable function">vetNumber</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num<span class="token punctuation">,</span> defaultNum</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            num <span class="token operator">=</span> num <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> num <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isNaN</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">?</span> num <span class="token operator">:</span> defaultNum<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                num <span class="token operator">=</span> defaultNum<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> num<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>settings <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> settings <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        max <span class="token operator">=</span> <span class="token function">vetNumber</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>maxSpaceSize<span class="token punctuation">,</span> maxSpaceSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        min <span class="token operator">=</span> <span class="token function">vetNumber</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>minSpaceSize<span class="token punctuation">,</span> minSpaceSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>min <span class="token operator">&gt;</span> max<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        minSpaceSize <span class="token operator">=</span> min<span class="token punctuation">;</span>
        maxSpaceSize <span class="token operator">=</span> max<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// define fill text</span>
    <span class="token keyword">var</span> <span class="token function-variable function">fillJustifyText</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">justifiedTextSettings</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
        renderType <span class="token operator">=</span> <span class="token constant">FILL</span><span class="token punctuation">;</span>
        <span class="token function">renderTextJustified</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// define stroke text</span>
    <span class="token keyword">var</span> <span class="token function-variable function">strokeJustifyText</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">justifiedTextSettings</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
        renderType <span class="token operator">=</span> <span class="token constant">STROKE</span><span class="token punctuation">;</span>
        <span class="token function">renderTextJustified</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// define measure text</span>
    <span class="token keyword">var</span> <span class="token function-variable function">measureJustifiedText</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> width<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">justifiedTextSettings</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
        renderType <span class="token operator">=</span> <span class="token constant">MEASURE</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">renderTextJustified</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// code point A</span>
    <span class="token comment">// set the prototypes</span>
    <span class="token class-name">CanvasRenderingContext2D</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>fillJustifyText <span class="token operator">=</span> fillJustifyText<span class="token punctuation">;</span>
    <span class="token class-name">CanvasRenderingContext2D</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>strokeJustifyText <span class="token operator">=</span> strokeJustifyText<span class="token punctuation">;</span>
    <span class="token class-name">CanvasRenderingContext2D</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>measureJustifiedText <span class="token operator">=</span> measureJustifiedText<span class="token punctuation">;</span>  
    <span class="token comment">// code point B</span>
    
    <span class="token comment">// optional code if you do not wish to extend the CanvasRenderingContext2D prototype</span>
    <span class="token comment">/* Uncomment from here to the closing comment
    window.justifiedText = {
        fill : function(ctx, text, x, y, width, settings){
            justifiedTextSettings(settings);
            renderType = FILL;
            renderTextJustified(ctx, text, x, y, width);
        },
        stroke : function(ctx, text, x, y, width, settings){
            justifiedTextSettings(settings);
            renderType = STROKE;
            renderTextJustified(ctx, text, x, y, width);
        },
        measure : function(ctx, text, width, settings){
            justifiedTextSettings(settings);
            renderType = MEASURE;
            return renderTextJustified(ctx, text, 0, 0, width);
        }
    }
    to here*/</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><blockquote></blockquote> <p><strong>Note A:</strong> If you do not wish to extend the <code>CanvasRenderingContext2D</code> prototype Remove from the example all code between <code>// code point A</code> and <code>// code point B</code> and uncomment the code marked <code>/* Uncomment from here to the closing comment</code></p> <h3 id="how-to-use"><a href="#how-to-use" class="header-anchor">#</a> How to use</h3> <p>Three functions are added to the <code>CanvasRenderingContext2D</code> and are available to all 2D context objects created.</p> <ul><li>ctx.fillJustifyText( text, x, y, width, [settings]);</li> <li>ctx.strokeJustifyText( text, x, y, width, [settings]);</li> <li>ctx.measureJustifiedText( text, width, [settings]);</li></ul> <p>Fill and stroke text function fill or stroke text and use the same arguments. <code>measureJustifiedText</code> will return the actual width that text would be rendered at. This may be equal, less, or greater than the argument <code>width</code> depending on current settings.</p> <blockquote></blockquote> <p><strong>Note:</strong> Arguments inside <code>[</code> and <code>]</code> are optional.</p> <h3 id="function-arguments"><a href="#function-arguments" class="header-anchor">#</a> Function arguments</h3> <li>
**text:** String containing the text to be rendered.
</li> <li>
**x, y:** Coordinates to render the text at.
</li> <li>
**width:** Width of the justified text. Text will increase/decrease spaces between words to fit the width. If the space between words is greater than `maxSpaceSize` (default = 6) times normal spacing will be used and the text will not fill the required width. If the spacing is less than `minSpaceSize` (default = 0.5) time normal spacing then the min space size is used and the text will overrun the width requested
</li> <li>
**settings:** Optional. Object containing min and max space sizes.
</li> <p>The <code>settings</code> argument is optional and if not included text rendering will use the last setting defined or the default (shown below).</p> <p>Both min and max are the min and max sizes for the [space] character separating words. The default <code>maxSpaceSize = 6</code> means that when the space between characters is &gt; 63 * ctx.measureText(&quot; &quot;).width text will not be justified. If text to be justified has spaces less than <code>minSpaceSize = 0.5</code> (default value 0.5) * <code>ctx.measureText(&quot; &quot;).width</code> the spacing will be set to <code>minSpaceSize * ctx.measureText(&quot; &quot;).width</code> and the resulting text will overrun the justifying width.</p> <p>The following rules are applied, min and max must be numbers. If not then the associate values will not be changed. If <code>minSpaceSize</code> is larger than <code>maxSpaceSize</code> both input setting are invalid and min max will not be changed.</p> <p>Example setting object with defaults</p> <div class="language-js extra-class"><pre class="language-js"><code>settings <span class="token operator">=</span> <span class="token punctuation">{</span> 
    maxSpaceSize <span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">;</span>   <span class="token comment">// Multiplier for max space size. </span>
    minSpaceSize <span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">;</span> <span class="token comment">// Multiplier for minimum space size</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><blockquote></blockquote> <p><strong>NOTE:</strong> These text functions introduce a subtle behaviour change for the <code>textAlign</code> property of the 2D context. 'Left', 'right', 'center' and 'start' behave as is expected but 'end' will not align from the right of the function argument <code>x</code> but rather from the right of <code>x + width</code></p> <blockquote></blockquote> <p><strong>Note:</strong> settings (min and max space size) are global to all 2D context objects.</p> <h3 id="usage-examples-2"><a href="#usage-examples-2" class="header-anchor">#</a> USAGE Examples</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This text is aligned from the left of the canvas.&quot;</span><span class="token punctuation">;</span> 
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This text is near the max spacing size&quot;</span><span class="token punctuation">;</span> 
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This text is way too short.&quot;</span><span class="token punctuation">;</span> 
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This text is too long for the space provied and will overflow#&quot;</span><span class="token punctuation">;</span>
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This text is aligned using 'end' and starts at x + width&quot;</span><span class="token punctuation">;</span> 
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This text is near the max spacing size&quot;</span><span class="token punctuation">;</span> 
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This text is way too short.&quot;</span><span class="token punctuation">;</span> 
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;#This text is too long for the space provied and will overflow&quot;</span><span class="token punctuation">;</span>
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This is aligned with 'center' and is placed from the center&quot;</span><span class="token punctuation">;</span> 
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This text is near the max spacing size&quot;</span><span class="token punctuation">;</span> 
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This text is way too short.&quot;</span><span class="token punctuation">;</span> 
text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This text is just too long for the space provied and will overflow&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// ctx is the 2d context</span>
<span class="token comment">// canvas is the canvas</span>

ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;25px arial&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span>
<span class="token keyword">var</span> left <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> center <span class="token operator">=</span> canvas<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> width <span class="token operator">=</span> canvas<span class="token punctuation">.</span>width<span class="token operator">-</span>left<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> size <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;Justified text examples.&quot;</span><span class="token punctuation">,</span>center<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
y<span class="token operator">+=</span> <span class="token number">40</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;14px arial&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;left&quot;</span>
<span class="token keyword">var</span> ww <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureJustifiedText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> setting <span class="token operator">=</span> <span class="token punctuation">{</span>
    maxSpaceSize <span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    minSpaceSize <span class="token operator">:</span> <span class="token number">0.5</span>
<span class="token punctuation">}</span>
ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span>
ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span>y <span class="token operator">-</span> size <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> y <span class="token operator">+</span> size <span class="token operator">*</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">-</span> left<span class="token punctuation">,</span>y <span class="token operator">-</span> size <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">-</span> left<span class="token punctuation">,</span> y <span class="token operator">+</span> size <span class="token operator">*</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;&lt; 'left' aligned&quot;</span><span class="token punctuation">,</span>left<span class="token punctuation">,</span>y <span class="token operator">-</span> size<span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;black&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> setting<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// settings is remembered</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> y<span class="token operator">+=</span>size<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> y<span class="token operator">+=</span>size<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> y<span class="token operator">+=</span>size<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">+=</span> <span class="token number">2.3</span><span class="token operator">*</span>size<span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;&lt; 'end' aligned from x plus the width --------------------&gt;&quot;</span><span class="token punctuation">,</span>left<span class="token punctuation">,</span>y <span class="token operator">-</span> size<span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;black&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;end&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> y<span class="token operator">+=</span>size<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> y<span class="token operator">+=</span>size<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> y<span class="token operator">+=</span>size<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>

y <span class="token operator">+=</span> <span class="token number">40</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span>
ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span>y <span class="token operator">-</span> size <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span> y <span class="token operator">+</span> size <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;'center' aligned&quot;</span><span class="token punctuation">,</span>center<span class="token punctuation">,</span>y <span class="token operator">-</span> size<span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;black&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> center<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> center<span class="token punctuation">,</span> y<span class="token operator">+=</span>size<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> center<span class="token punctuation">,</span> y<span class="token operator">+=</span>size<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> center<span class="token punctuation">,</span> y<span class="token operator">+=</span>size<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="justified-paragraphs"><a href="#justified-paragraphs" class="header-anchor">#</a> Justified paragraphs.</h2> <p>Renders text as justified paragraphs. <strong>REQUIRES</strong> the example <strong>Justified text</strong></p> <h3 id="example-render"><a href="#example-render" class="header-anchor">#</a> Example render</h3> <p><a href="https://i.stack.imgur.com/xNJh8.png" target="_blank" rel="noopener noreferrer"><img src="https://i.stack.imgur.com/xNJh8.png" alt="enter image description here"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <br><sub>Top paragraph has <strong>setting.compact = true</strong> and bottom <strong>false</strong> and line spacing is <strong>1.2</strong> rather than the default <strong>1.5</strong>. Rendered by code usage example bottom of this example.</sub></p> <h3 id="example-code-2"><a href="#example-code-2" class="header-anchor">#</a> Example code</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Requires justified text extensions </span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// code point A</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token class-name">CanvasRenderingContext2D</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>fillJustifyText <span class="token operator">!==</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ReferenceError</span><span class="token punctuation">(</span><span class="token string">&quot;Justified Paragraph extension missing requiered CanvasRenderingContext2D justified text extension&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> maxSpaceSize <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// Multiplier for max space size. If greater then no justificatoin applied</span>
    <span class="token keyword">var</span> minSpaceSize <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span> <span class="token comment">// Multiplier for minimum space size   </span>
    <span class="token keyword">var</span> compact <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// if true then try and fit as many words as possible. If false then try to get the spacing as close as possible to normal</span>
    <span class="token keyword">var</span> lineSpacing <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">;</span> <span class="token comment">// space between lines</span>
    <span class="token keyword">const</span> noJustifySetting <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment">// This setting forces justified text off. Used to render last line of paragraph.</span>
        minSpaceSize <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        maxSpaceSize <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Parse vet and set settings object.</span>
    <span class="token keyword">var</span> <span class="token function-variable function">justifiedTextSettings</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> min<span class="token punctuation">,</span> max<span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token function-variable function">vetNumber</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num<span class="token punctuation">,</span> defaultNum</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            num <span class="token operator">=</span> num <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> num <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isNaN</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">?</span> num <span class="token operator">:</span> defaultNum<span class="token punctuation">;</span>
            <span class="token keyword">return</span> num <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> defaultNum <span class="token operator">:</span> num<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>settings <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> settings <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        compact <span class="token operator">=</span> settings<span class="token punctuation">.</span>compact <span class="token operator">===</span> <span class="token boolean">true</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> settings<span class="token punctuation">.</span>compact <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token operator">?</span> <span class="token boolean">false</span> <span class="token operator">:</span> compact<span class="token punctuation">;</span>
        max <span class="token operator">=</span> <span class="token function">vetNumber</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>maxSpaceSize<span class="token punctuation">,</span> maxSpaceSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        min <span class="token operator">=</span> <span class="token function">vetNumber</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>minSpaceSize<span class="token punctuation">,</span> minSpaceSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        lineSpacing <span class="token operator">=</span> <span class="token function">vetNumber</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>lineSpacing<span class="token punctuation">,</span> lineSpacing<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>min <span class="token operator">&gt;</span> max<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        minSpaceSize <span class="token operator">=</span> min<span class="token punctuation">;</span>
        maxSpaceSize <span class="token operator">=</span> max<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>        
    <span class="token keyword">var</span> <span class="token function-variable function">getFontSize</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">font</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// get the font size. </span>
        <span class="token keyword">var</span> numFind <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[0-9]+</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> number <span class="token operator">=</span> numFind<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>font<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ReferenceError</span><span class="token punctuation">(</span><span class="token string">&quot;justifiedPar Cant find font size&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">Number</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">justifiedPar</span><span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> settings<span class="token punctuation">,</span> stroke</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> spaceWidth<span class="token punctuation">,</span> minS<span class="token punctuation">,</span> maxS<span class="token punctuation">,</span> words<span class="token punctuation">,</span> count<span class="token punctuation">,</span> lines<span class="token punctuation">,</span> lineWidth<span class="token punctuation">,</span> lastLineWidth<span class="token punctuation">,</span> lastSize<span class="token punctuation">,</span> i<span class="token punctuation">,</span> renderer<span class="token punctuation">,</span> fontSize<span class="token punctuation">,</span> adjSpace<span class="token punctuation">,</span> spaces<span class="token punctuation">,</span> word<span class="token punctuation">,</span> lineWords<span class="token punctuation">,</span> lineFound<span class="token punctuation">;</span>
        spaceWidth <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>
        minS <span class="token operator">=</span> spaceWidth <span class="token operator">*</span> minSpaceSize<span class="token punctuation">;</span>
        maxS <span class="token operator">=</span> spaceWidth <span class="token operator">*</span> maxSpaceSize<span class="token punctuation">;</span>
        words <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">word</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  <span class="token comment">// measure all words.</span>
            <span class="token keyword">var</span> w <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>                
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                width <span class="token operator">:</span> w<span class="token punctuation">,</span>
                word <span class="token operator">:</span> word<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// count = num words, spaces = number spaces, spaceWidth normal space size</span>
        <span class="token comment">// adjSpace new space size &gt;= min size. useSize Resulting space size used to render</span>
        count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        lines <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// create lines by shifting words from the words array until the spacing is optimal. If compact</span>
        <span class="token comment">// true then will true and fit as many words as possible. Else it will try and get the spacing as</span>
        <span class="token comment">// close as possible to the normal spacing</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            lastLineWidth <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            lastSize <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            lineFound <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token comment">// each line must have at least one word.</span>
            word <span class="token operator">=</span> words<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            lineWidth <span class="token operator">=</span> word<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
            lineWords <span class="token operator">=</span> <span class="token punctuation">[</span>word<span class="token punctuation">.</span>word<span class="token punctuation">]</span><span class="token punctuation">;</span>
            count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>lineWidth <span class="token operator">&lt;</span> width <span class="token operator">&amp;&amp;</span> words<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// Add words to line</span>
                word <span class="token operator">=</span> words<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                lineWidth <span class="token operator">+=</span> word<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
                lineWords<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>word<span class="token punctuation">.</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>
                count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                spaces <span class="token operator">=</span> count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                adjSpace <span class="token operator">=</span>  <span class="token punctuation">(</span>width <span class="token operator">-</span> lineWidth<span class="token punctuation">)</span> <span class="token operator">/</span> spaces<span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>minS <span class="token operator">&gt;</span> adjSpace<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// if spacing less than min remove last word and finish line</span>
                    lineFound <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                    words<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    lineWords<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>compact<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// if compact mode </span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span>adjSpace <span class="token operator">&lt;</span> spaceWidth<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// if less than normal space width</span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>lastSize <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                                lastSize <span class="token operator">=</span> adjSpace<span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token comment">// check if with last word on if its closer to space width</span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>spaceWidth <span class="token operator">-</span> adjSpace<span class="token punctuation">)</span> <span class="token operator">&lt;</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>spaceWidth <span class="token operator">-</span> lastSize<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                                lineFound <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// yes keep it</span>
                            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                                words<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// no better fit if last word removes</span>
                                lineWords<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                lineFound <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                lastSize <span class="token operator">=</span> adjSpace<span class="token punctuation">;</span> <span class="token comment">// remember spacing </span>
            <span class="token punctuation">}</span>
            lines<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>lineWords<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// and the line</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// lines have been worked out get font size, render, and render all the lines. last</span>
        <span class="token comment">// line may need to be rendered as normal so it is outside the loop.</span>
        fontSize <span class="token operator">=</span> <span class="token function">getFontSize</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>font<span class="token punctuation">)</span><span class="token punctuation">;</span>
        renderer <span class="token operator">=</span> stroke <span class="token operator">===</span> <span class="token boolean">true</span> <span class="token operator">?</span> ctx<span class="token punctuation">.</span><span class="token function">strokeJustifyText</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">:</span> ctx<span class="token punctuation">.</span><span class="token function">fillJustifyText</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lines<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">renderer</span><span class="token punctuation">(</span>lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
            y <span class="token operator">+=</span> lineSpacing <span class="token operator">*</span> fontSize<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>lines<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// last line if left or start aligned for no justify</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>textAlign <span class="token operator">===</span> <span class="token string">&quot;left&quot;</span> <span class="token operator">||</span> ctx<span class="token punctuation">.</span>textAlign <span class="token operator">===</span> <span class="token string">&quot;start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token function">renderer</span><span class="token punctuation">(</span>lines<span class="token punctuation">[</span>lines<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> noJustifySetting<span class="token punctuation">)</span><span class="token punctuation">;</span>
                ctx<span class="token punctuation">.</span><span class="token function">measureJustifiedText</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token function">renderer</span><span class="token punctuation">(</span>lines<span class="token punctuation">[</span>lines<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// return details about the paragraph.</span>
        y <span class="token operator">+=</span> lineSpacing <span class="token operator">*</span> fontSize<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            nextLine <span class="token operator">:</span> y<span class="token punctuation">,</span>
            fontSize <span class="token operator">:</span> fontSize<span class="token punctuation">,</span>
            lineHeight <span class="token operator">:</span> lineSpacing <span class="token operator">*</span> fontSize<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// define fill</span>
    <span class="token keyword">var</span> <span class="token function-variable function">fillParagraphText</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">justifiedTextSettings</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
        settings <span class="token operator">=</span> <span class="token punctuation">{</span>
            minSpaceSize <span class="token operator">:</span> minSpaceSize<span class="token punctuation">,</span>
            maxSpaceSize <span class="token operator">:</span> maxSpaceSize<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">justifiedPar</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// define stroke</span>
    <span class="token keyword">var</span> <span class="token function-variable function">strokeParagraphText</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">justifiedTextSettings</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
        settings <span class="token operator">=</span> <span class="token punctuation">{</span>
            minSpaceSize <span class="token operator">:</span> minSpaceSize<span class="token punctuation">,</span>
            maxSpaceSize <span class="token operator">:</span> maxSpaceSize<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">justifiedPar</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> settings<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">CanvasRenderingContext2D</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>fillParaText <span class="token operator">=</span> fillParagraphText<span class="token punctuation">;</span>
    <span class="token class-name">CanvasRenderingContext2D</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>strokeParaText <span class="token operator">=</span> strokeParagraphText<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><blockquote></blockquote> <p><strong>NOTE</strong> this extends the <code>CanvasRenderingContext2D</code> prototype. If you do not wish this to happen use the example <strong>Justified text</strong> to work out how to change this example to be part of the global namespace.</p> <blockquote></blockquote> <p><strong>NOTE</strong> Will throw a ReferenceError if this example can not find the function <code>CanvasRenderingContext2D.prototype.fillJustifyText</code></p> <h3 id="how-to-use-2"><a href="#how-to-use-2" class="header-anchor">#</a> How to use</h3> <div class="language-html extra-class"><pre class="language-html"><code>ctx.fillParaText(text, x, y, width, [settings]);
ctx.strokeParaText(text, x, y, width, [settings]);

</code></pre></div><p>See <strong>Justified text</strong> for details on arguments. Arguments between <code>[</code> and <code>]</code> are optional.</p> <p>The <code>settings</code> argument has two additional properties.</p> <ul><li><strong>compact:</strong> Default <code>true</code>. If true tries to pack as many words as possible per line. If false the tries to get the word spacing as close as possible to normal spacing.</li> <li><strong>lineSpacing</strong> Default <code>1.5</code>. Space per line default <code>1.5</code> the distance from on line to the next in terms of font size</li></ul> <p>Properties missing from the settings object will default to their default values or to the last valid values. The properties will only be changed if the new values are valid. For <code>compact</code> valid values are only booleans <code>true</code> or <code>false</code> Truthy values are not considered valid.</p> <h3 id="return-object"><a href="#return-object" class="header-anchor">#</a> Return object</h3> <p>The two functions return an object containing information to help you place the next paragraph. The object contains the following properties.</p> <ul><li><strong>nextLine</strong> Position of the next line after the paragraph pixels.</li> <li><strong>fontSize</strong>  Size of the font. (please note only use fonts defined in pixels eg <code>14px arial</code>)</li> <li><strong>lineHeight</strong> Distance in pixels from one line to the next</li></ul> <p>This example uses a simple algorithm that works one line at to time to find the best fit for a paragraph. This does not mean that it the best fit (rather the algorithm's best) You may wish to improve the algorithm by creating a multi pass line algorithm over the generated lines. Moving words from the end of one line to the start of the next, or from the start back to the end. The best look is achieved when the spacing over the entire paragraph has the smallest variation and is the closest to the normal text spacing.</p> <p>As this example is dependent on the <strong>Justified text</strong> example the code is very similar. You may wish to move the two into one function. Replace the function <code>justifiedTextSettings</code> in the other example with the one used in this example. Then copy all the rest of the code from this example into the anonymous function body of the <strong>Justified text</strong> example. You will no longer need to test for dependencies found at <code>// Code point A</code>  It can be removed.</p> <h3 id="usage-example"><a href="#usage-example" class="header-anchor">#</a> Usage example</h3> <div class="language-js extra-class"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;25px arial&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span>

<span class="token keyword">var</span> left <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> center <span class="token operator">=</span> canvas<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> width <span class="token operator">=</span> canvas<span class="token punctuation">.</span>width<span class="token operator">-</span>left<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> size <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;Justified paragraph examples.&quot;</span><span class="token punctuation">,</span>center<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
y<span class="token operator">+=</span> <span class="token number">30</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;14px arial&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;left&quot;</span>
<span class="token comment">// set para settings</span>
<span class="token keyword">var</span> setting <span class="token operator">=</span> <span class="token punctuation">{</span>
    maxSpaceSize <span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    minSpaceSize <span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
    lineSpacing <span class="token operator">:</span> <span class="token number">1.2</span><span class="token punctuation">,</span>
    compact <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// Show the left and right bounds.</span>
ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span>
ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span>y <span class="token operator">-</span> size <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> y <span class="token operator">+</span> size <span class="token operator">*</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">-</span> left<span class="token punctuation">,</span>y <span class="token operator">-</span> size <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">-</span> left<span class="token punctuation">,</span> y <span class="token operator">+</span> size <span class="token operator">*</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;black&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// Draw paragraph</span>
<span class="token keyword">var</span> line <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">fillParaText</span><span class="token punctuation">(</span>para<span class="token punctuation">,</span> left<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> setting<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// settings is remembered    </span>

<span class="token comment">// Next paragraph</span>
y <span class="token operator">=</span> line<span class="token punctuation">.</span>nextLine <span class="token operator">+</span> line<span class="token punctuation">.</span>lineHeight<span class="token punctuation">;</span>
setting<span class="token punctuation">.</span>compact <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillParaText</span><span class="token punctuation">(</span>para<span class="token punctuation">,</span> left<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> setting<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><blockquote></blockquote> <p><strong>Note:</strong> For text aligned <code>left</code> or <code>start</code> the last line of tha paragraph will always have normal spacing. For all other alignments the last line is treated like all others.</p> <blockquote></blockquote> <p><strong>Note:</strong> You can inset the start of the paragraph with spaces. Though this may not be consistent from paragraph to paragraph. It is always a good thing to learn what a function is doing and modifying it. An exercise would be to add a setting to the settings that indents the first line by a fixed amount. Hint the while loop will need to temporarily make the first word appear larger (+ indent) <code>words[0].width += ?</code> and then when rendering lines indent the first line.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/html/text.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/html/getting-started-with-html5-canvas.html" class="prev">
        Getting started with html5-canvas
      </a></span> <span class="next"><a href="/html/polygons.html">
        Polygons
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/1299.5e7e4eda.js" defer></script>
  </body>
</html>
