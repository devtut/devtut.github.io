<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - API Calls</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="API declaration and usage, Windows API - Dedicated Module (1 of 2), Windows API - Dedicated Module (2 of 2), Mac APIs, Get total monitors and screen resolution, FTP and Regional APIs">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - API Calls">
    <meta property="og:description" content="API declaration and usage, Windows API - Dedicated Module (1 of 2), Windows API - Dedicated Module (2 of 2), Mac APIs, Get total monitors and screen resolution, FTP and Regional APIs">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/api-calls.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - API Calls">
    <meta name="twitter:description" content="API declaration and usage, Windows API - Dedicated Module (1 of 2), Windows API - Dedicated Module (2 of 2), Mac APIs, Get total monitors and screen resolution, FTP and Regional APIs">
    <meta name="twitter:url" content="/vba/api-calls.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3402.52c54115.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" aria-current="page" class="active sidebar-link">API Calls</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/api-calls.html#api-declaration-and-usage" class="sidebar-link">API declaration and usage</a></li><li class="sidebar-sub-header"><a href="/vba/api-calls.html#windows-api-dedicated-module-1-of-2" class="sidebar-link">Windows API - Dedicated Module (1 of 2)</a></li><li class="sidebar-sub-header"><a href="/vba/api-calls.html#windows-api-dedicated-module-2-of-2" class="sidebar-link">Windows API - Dedicated Module (2 of 2)</a></li><li class="sidebar-sub-header"><a href="/vba/api-calls.html#mac-apis" class="sidebar-link">Mac APIs</a></li><li class="sidebar-sub-header"><a href="/vba/api-calls.html#get-total-monitors-and-screen-resolution" class="sidebar-link">Get total monitors and screen resolution</a></li><li class="sidebar-sub-header"><a href="/vba/api-calls.html#ftp-and-regional-apis" class="sidebar-link">FTP and Regional APIs</a></li></ul></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="api-calls"><a href="#api-calls" class="header-anchor">#</a> API Calls</h1> <p>API stands for <a href="https://en.wikipedia.org/wiki/Application_programming_interface" target="_blank" rel="noopener noreferrer">Application Programming Interface<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>API's for VBA imply a set of methods that allow direct interaction with the operating system</p> <p>System calls can be made by executing procedures defined in DLL files</p> <h2 id="api-declaration-and-usage"><a href="#api-declaration-and-usage" class="header-anchor">#</a> API declaration and usage</h2> <p><a href="https://msdn.microsoft.com/en-us/library/aa716201(v=vs.60).aspx" target="_blank" rel="noopener noreferrer">Declaring a DLL procedure<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to work with different VBA versions:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Explicit

<span class="token directive comment">#If Win64 Then</span>

    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Sub</span> xLib <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;Sleep&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> dwMilliseconds <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>

<span class="token directive comment">#ElseIf Win32 Then</span>

    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Sub</span> apiSleep <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;Sleep&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> dwMilliseconds <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>

<span class="token directive comment">#End If</span>

</code></pre></div><p>The above declaration tells VBA how to call the function &quot;Sleep&quot; defined in file Kernel32.dll</p> <p>Win64 and Win32 are predefined constants used for <a href="https://stackoverflow.com/documentation/vba/3364/conditional-compilation#t=201706212313324828424" target="_blank" rel="noopener noreferrer">conditional compilation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Pre-defined Constants</p> <p>Some compilation constants are already pre-defined. Which ones exist will depend on the bitness of the office version you're running VBA in. Note that Vba7 was introduced alongside Office 2010 to support 64 bit versions of Office.</p> <table><thead><tr><th><strong>Constant</strong></th> <th><strong>16 bit</strong></th> <th><strong>32 bit</strong></th> <th><strong>64 bit</strong></th></tr></thead> <tbody><tr><td>Vba6</td> <td>False</td> <td>If Vba6</td> <td>False</td></tr> <tr><td>Vba7</td> <td>False</td> <td>If Vba7</td> <td>True</td></tr> <tr><td>Win16</td> <td>True</td> <td>False</td> <td>False</td></tr> <tr><td>Win32</td> <td>False</td> <td>True</td> <td>True</td></tr> <tr><td>Win64</td> <td>False</td> <td>False</td> <td>True</td></tr> <tr><td>Mac</td> <td>False</td> <td>If Mac</td> <td>If Mac</td></tr></tbody></table> <p>These constants refer to the Office version, not the Windows version. For example Win32 = TRUE in 32-bit Office, even if the OS is a 64-bit version of Windows.</p> <p>The main difference when declaring APIs is between 32 bit and 64 bit Office versions which introduced new parameter types (see Remarks section for more details)</p> <blockquote></blockquote> <p>Notes:
<ul></ul></p> <ul><li>Declarations are placed at the top of the module, and outside any Subs or Functions</li> <li>Procedures declared in standard modules are public by default</li> <li>To declare a procedure private to a module precede the declaration with the <code>Private</code> keyword</li> <li>DLL procedures declared in any other type of module are private to that module
</li></ul> <p>Simple example for the Sleep API call:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> TestPause<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> start <span class="token keyword">As</span> <span class="token keyword">Double</span>

    start <span class="token operator">=</span> Timer

    Sleep <span class="token number">9000</span>      <span class="token comment">'Pause execution for 9 seconds</span>

    Debug<span class="token punctuation">.</span>Print <span class="token string">&quot;Paused for &quot;</span> <span class="token operator">&amp;</span> Format<span class="token punctuation">(</span>Timer <span class="token operator">-</span> start<span class="token punctuation">,</span> <span class="token string">&quot;#,###.000&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot; seconds&quot;</span>

    <span class="token comment">'Immediate window result: Paused for 9.000 seconds</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>It is recommended to create a dedicated API module to provide easy access to the system functions from VBA wrappers -- normal VBA Subs or Functions that encapsulate the details needed for the actual system call such as parameters used in libraries, and initialization of those parameters</p> <p>The module can contain all declarations and dependencies:</p> <ul><li>Method signatures and required data structures</li> <li>Wrappers that perform input validation, and ensure all parameters are passed as expected</li></ul> <p>To declare a DLL procedure, add a <code>Declare</code> statement to the Declarations section of the code window.</p> <p>If the procedure returns a value, declare it as a <strong>Function</strong>:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Declare</span> <span class="token keyword">Function</span> publicname <span class="token keyword">Lib</span> <span class="token string">&quot;libname&quot;</span> [<span class="token keyword">Alias</span> <span class="token string">&quot;alias&quot;</span>] [<span class="token punctuation">(</span>[[<span class="token keyword">ByVal</span>] variable [<span class="token keyword">As</span> <span class="token keyword">type</span>] [<span class="token punctuation">,</span>[<span class="token keyword">ByVal</span>] variable [<span class="token keyword">As</span> <span class="token keyword">type</span>]]<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>]<span class="token punctuation">)</span>] <span class="token keyword">As</span> <span class="token keyword">Type</span>

</code></pre></div><p>If a procedure does not return a value, declare it as a <strong>Sub</strong>:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Declare</span> <span class="token keyword">Sub</span> publicname <span class="token keyword">Lib</span> <span class="token string">&quot;libname&quot;</span> [<span class="token keyword">Alias</span> <span class="token string">&quot;alias&quot;</span>] [<span class="token punctuation">(</span>[[<span class="token keyword">ByVal</span>] variable [<span class="token keyword">As</span> <span class="token keyword">type</span>] [<span class="token punctuation">,</span>[<span class="token keyword">ByVal</span>] variable [<span class="token keyword">As</span> <span class="token keyword">type</span>]]<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>]<span class="token punctuation">)</span>]

</code></pre></div><ul><li>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</li></ul> <blockquote></blockquote> <p>Also of note is that **most invalid calls to the API's will crash Excel**,
and possibly corrupt data files</p> <ul><li>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</li></ul> <p><strong>Office 2011 for Mac</strong></p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> system <span class="token keyword">Lib</span> <span class="token string">&quot;libc.dylib&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> command <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>

<span class="token keyword">Sub</span> RunSafari<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> result <span class="token keyword">As</span> <span class="token keyword">Long</span>
    result <span class="token operator">=</span> system<span class="token punctuation">(</span><span class="token string">&quot;open -a Safari --args http://www.google.com&quot;</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print Str<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>The examples bellow (Windows API - Dedicated Module (1 and 2)) show an API module that includes common declarations for Win64 and Win32</p> <h2 id="windows-api-dedicated-module-1-of-2"><a href="#windows-api-dedicated-module-1-of-2" class="header-anchor">#</a> Windows API - Dedicated Module (1 of 2)</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Explicit

<span class="token directive comment">#If Win64 Then  'Win64 = True, Win32 = False, Win16 = False</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Sub</span> apiCopyMemory <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;RtlMoveMemory&quot;</span> <span class="token punctuation">(</span>MyDest <span class="token keyword">As</span> Any<span class="token punctuation">,</span> MySource <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> MySize <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Sub</span> apiExitProcess <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ExitProcess&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> uExitCode <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Sub</span> apiSetCursorPos <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetCursorPos&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> X <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> Y <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Sub</span> apiSleep <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;Sleep&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> dwMilliseconds <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiAttachThreadInput <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;AttachThreadInput&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> idAttach <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> idAttachTo <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> fAttach <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiBringWindowToTop <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;BringWindowToTop&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lngHWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiCloseWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;CloseWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiDestroyWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;DestroyWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiEndDialog <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;EndDialog&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> result <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiEnumChildWindows <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;EnumChildWindows&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWndParent <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> pEnumProc <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lParam <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiExitWindowsEx <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ExitWindowsEx&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> uFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwReserved <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiFindExecutable <span class="token keyword">Lib</span> <span class="token string">&quot;Shell32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FindExecutableA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> ByVallpDirectory <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpResult <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiFindWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FindWindowA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpClassName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpWindowName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiFindWindowEx <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FindWindowExA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd1 <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> hWnd2 <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpsz1 <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpsz2 <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetActiveWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetActiveWindow&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetClassNameA <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetClassNameA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> szClassName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lLength <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetCommandLine <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetCommandLineW&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetCommandLineParams <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetCommandLineA&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetDiskFreeSpaceEx <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetDiskFreeSpaceExA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpDirectoryName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> lpFreeBytesAvailableToCaller <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">,</span> lpTotalNumberOfBytes <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">,</span> lpTotalNumberOfFreeBytes <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetDriveType <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetDriveTypeA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> nDrive <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetExitCodeProcess <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetExitCodeProcess&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpExitCode <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetForegroundWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetForegroundWindow&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetFrequency <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;QueryPerformanceFrequency&quot;</span> <span class="token punctuation">(</span>cyFrequency <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetLastError <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetLastError&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetParent <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetParent&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetSystemMetrics <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetSystemMetrics&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> nIndex <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetSystemMetrics32 <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetSystemMetrics&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> nIndex <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetTickCount <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;QueryPerformanceCounter&quot;</span> <span class="token punctuation">(</span>cyTickCount <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetTickCountMs <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetTickCount&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetUserName <span class="token keyword">Lib</span> <span class="token string">&quot;AdvApi32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetUserNameA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpBuffer <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> nSize <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wCmd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetWindowRect <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetWindowRect&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpRect <span class="token keyword">As</span> winRect<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetWindowText <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetWindowTextA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> szWindowText <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lLength <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetWindowThreadProcessId <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetWindowThreadProcessId&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpdwProcessId <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiIsCharAlphaNumericA <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;IsCharAlphaNumericA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> byChar <span class="token keyword">As</span> <span class="token keyword">Byte</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiIsIconic <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;IsIconic&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiIsWindowVisible <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;IsWindowVisible&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiIsZoomed <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;IsZoomed&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiLStrCpynA <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;lstrcpynA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> pDestination <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> pSource <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> iMaxLength <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiMessageBox <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;MessageBoxA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpText <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpCaption <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiOpenIcon <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;OpenIcon&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiOpenProcess <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;OpenProcess&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> dwDesiredAccess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> bInheritHandle <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwProcessId <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiPathAddBackslashByPointer <span class="token keyword">Lib</span> <span class="token string">&quot;ShlwApi&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;PathAddBackslashW&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpszPath <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiPathAddBackslashByString <span class="token keyword">Lib</span> <span class="token string">&quot;ShlwApi&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;PathAddBackslashW&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpszPath <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token comment">'http://msdn.microsoft.com/en-us/library/aa155716%28office.10%29.aspx</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiPostMessage <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;PostMessageA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wMsg <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wParam <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lParam <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiRegQueryValue <span class="token keyword">Lib</span> <span class="token string">&quot;AdvApi32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;RegQueryValue&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hKey <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> sValueName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwReserved <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> lValueType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> sValue <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> lResultLen <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiSendMessage <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SendMessageA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wMsg <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wParam <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lParam <span class="token keyword">As</span> Any<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiSetActiveWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetActiveWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiSetCurrentDirectoryA <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetCurrentDirectoryA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpPathName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiSetFocus <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetFocus&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiSetForegroundWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetForegroundWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiSetLocalTime <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetLocalTime&quot;</span> <span class="token punctuation">(</span>lpSystem <span class="token keyword">As</span> SystemTime<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiSetWindowPlacement <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetWindowPlacement&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> lpwndpl <span class="token keyword">As</span> winPlacement<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiSetWindowPos <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetWindowPos&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> hWndInsertAfter <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> X <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> Y <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> cx <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> cy <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiSetWindowText <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetWindowTextA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiShellExecute <span class="token keyword">Lib</span> <span class="token string">&quot;Shell32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ShellExecuteA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpOperation <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpParameters <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpDirectory <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nShowCmd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiShowWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ShowWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nCmdShow <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiShowWindowAsync <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ShowWindowAsync&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nCmdShow <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiStrCpy <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;lstrcpynA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> pDestination <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> pSource <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> iMaxLength <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiStringLen <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;lstrlenW&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpString <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiStrTrimW <span class="token keyword">Lib</span> <span class="token string">&quot;ShlwApi&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;StrTrimW&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiTerminateProcess <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;TerminateProcess&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> uExitCode <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiTimeGetTime <span class="token keyword">Lib</span> <span class="token string">&quot;Winmm&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;timeGetTime&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiVarPtrArray <span class="token keyword">Lib</span> <span class="token string">&quot;MsVbVm50&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;VarPtr&quot;</span> <span class="token punctuation">(</span>Var<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Any<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> browseInfo     <span class="token comment">'used by apiBrowseForFolder</span>
        hOwner <span class="token keyword">As</span> <span class="token keyword">Long</span>
        pidlRoot <span class="token keyword">As</span> <span class="token keyword">Long</span>
        pszDisplayName <span class="token keyword">As</span> <span class="token keyword">String</span>
        lpszTitle <span class="token keyword">As</span> <span class="token keyword">String</span>
        ulFlags <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lpfn <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lParam <span class="token keyword">As</span> <span class="token keyword">Long</span>
        iImage <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiBrowseForFolder <span class="token keyword">Lib</span> <span class="token string">&quot;Shell32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SHBrowseForFolderA&quot;</span> <span class="token punctuation">(</span>lpBrowseInfo <span class="token keyword">As</span> browseInfo<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> CHOOSECOLOR    <span class="token comment">'used by apiChooseColor; http://support.microsoft.com/kb/153929 and http://www.cpearson.com/Excel/Colors.aspx</span>
        lStructSize <span class="token keyword">As</span> <span class="token keyword">Long</span>
        hWndOwner <span class="token keyword">As</span> <span class="token keyword">Long</span>
        hInstance <span class="token keyword">As</span> <span class="token keyword">Long</span>
        rgbResult <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lpCustColors <span class="token keyword">As</span> <span class="token keyword">String</span>
        flags <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lCustData <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lpfnHook <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lpTemplateName <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiChooseColor <span class="token keyword">Lib</span> <span class="token string">&quot;ComDlg32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ChooseColorA&quot;</span> <span class="token punctuation">(</span>pChoosecolor <span class="token keyword">As</span> CHOOSECOLOR<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> FindWindowParameters   <span class="token comment">'Custom structure for passing in the parameters in/out of the hook enumeration function; could use global variables instead, but this is nicer</span>
        strTitle <span class="token keyword">As</span> <span class="token keyword">String</span>  <span class="token comment">'INPUT</span>
        hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span>        <span class="token comment">'OUTPUT</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>                            <span class="token comment">'Find a specific window with dynamic caption from a list of all open windows: http://www.everythingaccess.com/tutorials.asp?ID=Bring-an-external-application-window-to-the-foreground</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiEnumWindows <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;EnumWindows&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpEnumFunc <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lParam <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> lastInputInfo  <span class="token comment">'used by apiGetLastInputInfo, getLastInputTime</span>
        cbSize <span class="token keyword">As</span> <span class="token keyword">Long</span>
        dwTime <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetLastInputInfo <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetLastInputInfo&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByRef</span> plii <span class="token keyword">As</span> lastInputInfo<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token comment">'http://www.pgacon.com/visualbasic.htm#Take%20Advantage%20of%20Conditional%20Compilation</span>
    <span class="token comment">'Logical and Bitwise Operators in Visual Basic: http://msdn.microsoft.com/en-us/library/wz3k228a(v=vs.80).aspx and http://stackoverflow.com/questions/1070863/hidden-features-of-vba</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> SystemTime
          wYear          <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wMonth         <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wDayOfWeek     <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wDay           <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wHour          <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wMinute        <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wSecond        <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wMilliseconds  <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Sub</span> apiGetLocalTime <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetLocalTime&quot;</span> <span class="token punctuation">(</span>lpSystem <span class="token keyword">As</span> SystemTime<span class="token punctuation">)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> pointAPI       <span class="token comment">'used by apiSetWindowPlacement</span>
         X <span class="token keyword">As</span> <span class="token keyword">Long</span>
         Y <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> rectAPI       <span class="token comment">'used by apiSetWindowPlacement</span>
        Left_Renamed <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Top_Renamed <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Right_Renamed <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Bottom_Renamed <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> winPlacement   <span class="token comment">'used by apiSetWindowPlacement</span>
        length <span class="token keyword">As</span> <span class="token keyword">Long</span>
        flags <span class="token keyword">As</span> <span class="token keyword">Long</span>
        showCmd <span class="token keyword">As</span> <span class="token keyword">Long</span>
        ptMinPosition <span class="token keyword">As</span> pointAPI
        ptMaxPosition <span class="token keyword">As</span> pointAPI
        rcNormalPosition <span class="token keyword">As</span> rectAPI
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiGetWindowPlacement <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetWindowPlacement&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> lpwndpl <span class="token keyword">As</span> winPlacement<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> winRect     <span class="token comment">'used by apiMoveWindow</span>
        Left <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Top <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Right <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Bottom <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiMoveWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;MoveWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> xLeft <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> yTop <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> wWidth <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> hHeight <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> repaint <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>

    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiInternetOpen <span class="token keyword">Lib</span> <span class="token string">&quot;WiniNet&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;InternetOpenA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> sAgent <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lAccessType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> sProxyName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> sProxyBypass <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>    <span class="token comment">'Open the Internet object    'ex: lngINet = InternetOpen(“MyFTP Control”, 1, vbNullString, vbNullString, 0)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiInternetConnect <span class="token keyword">Lib</span> <span class="token string">&quot;WiniNet&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;InternetConnectA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hInternetSession <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> sServerName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nServerPort <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> sUsername <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> sPassword <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lService <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lContext <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>  <span class="token comment">'Connect to the network  'ex: lngINetConn = InternetConnect(lngINet, &quot;ftp.microsoft.com&quot;, 0, &quot;anonymous&quot;, &quot;wally@wallyworld.com&quot;, 1, 0, 0)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiFtpGetFile <span class="token keyword">Lib</span> <span class="token string">&quot;WiniNet&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FtpGetFileA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hFtpSession <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpszRemoteFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpszNewFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> fFailIfExists <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwFlagsAndAttributes <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwContext <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>    <span class="token comment">'Get a file 'ex: blnRC = FtpGetFile(lngINetConn, &quot;dirmap.txt&quot;, &quot;c:\dirmap.txt&quot;, 0, 0, 1, 0)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiFtpPutFile <span class="token keyword">Lib</span> <span class="token string">&quot;WiniNet&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FtpPutFileA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hFtpSession <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpszLocalFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpszRemoteFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwContext <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>  <span class="token comment">'Send a file  'ex: blnRC = FtpPutFile(lngINetConn, “c:\dirmap.txt”, “dirmap.txt”, 1, 0)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiFtpDeleteFile <span class="token keyword">Lib</span> <span class="token string">&quot;WiniNet&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FtpDeleteFileA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hFtpSession <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpszFileName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span> <span class="token comment">'Delete a file 'ex: blnRC = FtpDeleteFile(lngINetConn, “test.txt”)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiInternetCloseHandle <span class="token keyword">Lib</span> <span class="token string">&quot;WiniNet&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hInet <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Integer</span>  <span class="token comment">'Close the Internet object  'ex: InternetCloseHandle lngINetConn    'ex: InternetCloseHandle lngINet</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiFtpFindFirstFile <span class="token keyword">Lib</span> <span class="token string">&quot;WiniNet&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FtpFindFirstFileA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hFtpSession <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpszSearchFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> lpFindFileData <span class="token keyword">As</span> WIN32_FIND_DATA<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwContent <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> FILETIME
        dwLowDateTime <span class="token keyword">As</span> <span class="token keyword">Long</span>
        dwHighDateTime <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> WIN32_FIND_DATA
        dwFileAttributes <span class="token keyword">As</span> <span class="token keyword">Long</span>
        ftCreationTime <span class="token keyword">As</span> FILETIME
        ftLastAccessTime <span class="token keyword">As</span> FILETIME
        ftLastWriteTime <span class="token keyword">As</span> FILETIME
        nFileSizeHigh <span class="token keyword">As</span> <span class="token keyword">Long</span>
        nFileSizeLow <span class="token keyword">As</span> <span class="token keyword">Long</span>
        dwReserved0 <span class="token keyword">As</span> <span class="token keyword">Long</span>
        dwReserved1 <span class="token keyword">As</span> <span class="token keyword">Long</span>
        cFileName <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">*</span> <span class="token number">1</span> <span class="token comment">'MAX_FTP_PATH</span>
        cAlternate <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">*</span> <span class="token number">14</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>    <span class="token comment">'ex: lngHINet = FtpFindFirstFile(lngINetConn, &quot;*.*&quot;, pData, 0, 0)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> apiInternetFindNextFile <span class="token keyword">Lib</span> <span class="token string">&quot;WiniNet&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;InternetFindNextFileA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hFind <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpvFindData <span class="token keyword">As</span> WIN32_FIND_DATA<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>  <span class="token comment">'ex: blnRC = InternetFindNextFile(lngHINet, pData)</span>
<span class="token directive comment">#ElseIf Win32 Then  'Win32 = True, Win16 = False</span>

</code></pre></div><p>(continued in second example)</p> <h2 id="windows-api-dedicated-module-2-of-2"><a href="#windows-api-dedicated-module-2-of-2" class="header-anchor">#</a> Windows API - Dedicated Module (2 of 2)</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token directive comment">#ElseIf Win32 Then  'Win32 = True, Win16 = False</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Sub</span> apiCopyMemory <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;RtlMoveMemory&quot;</span> <span class="token punctuation">(</span>MyDest <span class="token keyword">As</span> Any<span class="token punctuation">,</span> MySource <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> MySize <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Sub</span> apiExitProcess <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ExitProcess&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> uExitCode <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token comment">'Private Declare Sub apiGetStartupInfo Lib &quot;Kernel32&quot; Alias &quot;GetStartupInfoA&quot; (lpStartupInfo As STARTUPINFO)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Sub</span> apiSetCursorPos <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetCursorPos&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> X <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> Y <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>  <span class="token comment">'Logical and Bitwise Operators in Visual Basic: http://msdn.microsoft.com/en-us/library/wz3k228a(v=vs.80).aspx and http://stackoverflow.com/questions/1070863/hidden-features-of-vba    'http://www.pgacon.com/visualbasic.htm#Take%20Advantage%20of%20Conditional%20Compilation</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Sub</span> apiSleep <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;Sleep&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> dwMilliseconds <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiAttachThreadInput <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;AttachThreadInput&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> idAttach <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> idAttachTo <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> fAttach <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiBringWindowToTop <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;BringWindowToTop&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lngHWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiCloseHandle <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hObject <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiCloseWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;CloseWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token comment">'Private Declare Function apiCreatePipe Lib &quot;Kernel32&quot; (phReadPipe As Long, phWritePipe As Long, lpPipeAttributes As SECURITY_ATTRIBUTES, ByVal nSize As Long) As Long</span>
    <span class="token comment">'Private Declare Function apiCreateProcess Lib &quot;Kernel32&quot; Alias &quot;CreateProcessA&quot; (ByVal lpApplicationName As Long, ByVal lpCommandLine As String, lpProcessAttributes As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, lpEnvironment As Any, ByVal lpCurrentDriectory As String, lpStartupInfo As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiDestroyWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;DestroyWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiEndDialog <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;EndDialog&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> result <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiEnumChildWindows <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;EnumChildWindows&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWndParent <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> pEnumProc <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lParam <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiExitWindowsEx <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ExitWindowsEx&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> uFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwReserved <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiFindExecutable <span class="token keyword">Lib</span> <span class="token string">&quot;Shell32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FindExecutableA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> ByVallpDirectory <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpResult <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiFindWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FindWindowA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpClassName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpWindowName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiFindWindowEx <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FindWindowExA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd1 <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> hWnd2 <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpsz1 <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpsz2 <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetActiveWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetActiveWindow&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetClassNameA <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetClassNameA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> szClassName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lLength <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetCommandLine <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetCommandLineW&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetCommandLineParams <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetCommandLineA&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetDiskFreeSpaceEx <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetDiskFreeSpaceExA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpDirectoryName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> lpFreeBytesAvailableToCaller <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">,</span> lpTotalNumberOfBytes <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">,</span> lpTotalNumberOfFreeBytes <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetDriveType <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetDriveTypeA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> nDrive <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetExitCodeProcess <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hProcess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpExitCode <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetFileSize <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hFile <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpFileSizeHigh <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetForegroundWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetForegroundWindow&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetFrequency <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;QueryPerformanceFrequency&quot;</span> <span class="token punctuation">(</span>cyFrequency <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetLastError <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetLastError&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetParent <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetParent&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetSystemMetrics <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetSystemMetrics&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> nIndex <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetTickCount <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;QueryPerformanceCounter&quot;</span> <span class="token punctuation">(</span>cyTickCount <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetTickCountMs <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetTickCount&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetUserName <span class="token keyword">Lib</span> <span class="token string">&quot;AdvApi32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetUserNameA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpBuffer <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> nSize <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wCmd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetWindowRect <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetWindowRect&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpRect <span class="token keyword">As</span> winRect<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetWindowText <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetWindowTextA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> szWindowText <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lLength <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetWindowThreadProcessId <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetWindowThreadProcessId&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpdwProcessId <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiIsCharAlphaNumericA <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;IsCharAlphaNumericA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> byChar <span class="token keyword">As</span> <span class="token keyword">Byte</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiIsIconic <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;IsIconic&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiIsWindowVisible <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;IsWindowVisible&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiIsZoomed <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;IsZoomed&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiLStrCpynA <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;lstrcpynA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> pDestination <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> pSource <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> iMaxLength <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiMessageBox <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;MessageBoxA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpText <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpCaption <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiOpenIcon <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;OpenIcon&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiOpenProcess <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;OpenProcess&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> dwDesiredAccess <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> bInheritHandle <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwProcessId <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiPathAddBackslashByPointer <span class="token keyword">Lib</span> <span class="token string">&quot;ShlwApi&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;PathAddBackslashW&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpszPath <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiPathAddBackslashByString <span class="token keyword">Lib</span> <span class="token string">&quot;ShlwApi&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;PathAddBackslashW&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpszPath <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token comment">'http://msdn.microsoft.com/en-us/library/aa155716%28office.10%29.aspx</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiPostMessage <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;PostMessageA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wMsg <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wParam <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lParam <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiReadFile <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hFile <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpBuffer <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nNumberOfBytesToRead <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpNumberOfBytesRead <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpOverlapped <span class="token keyword">As</span> Any<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiRegQueryValue <span class="token keyword">Lib</span> <span class="token string">&quot;AdvApi32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;RegQueryValue&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hKey <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> sValueName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwReserved <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> lValueType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> sValue <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> lResultLen <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiSendMessage <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SendMessageA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wMsg <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wParam <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lParam <span class="token keyword">As</span> Any<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiSetActiveWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetActiveWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiSetCurrentDirectoryA <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetCurrentDirectoryA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpPathName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiSetFocus <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetFocus&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiSetForegroundWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetForegroundWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiSetLocalTime <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetLocalTime&quot;</span> <span class="token punctuation">(</span>lpSystem <span class="token keyword">As</span> SystemTime<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiSetWindowPlacement <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetWindowPlacement&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> lpwndpl <span class="token keyword">As</span> winPlacement<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiSetWindowPos <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetWindowPos&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> hWndInsertAfter <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> X <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> Y <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> cx <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> cy <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> wFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiSetWindowText <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetWindowTextA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiShellExecute <span class="token keyword">Lib</span> <span class="token string">&quot;Shell32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ShellExecuteA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpOperation <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpParameters <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpDirectory <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nShowCmd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiShowWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ShowWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nCmdShow <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiShowWindowAsync <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ShowWindowAsync&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nCmdShow <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiStrCpy <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;lstrcpynA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> pDestination <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> pSource <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> iMaxLength <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiStringLen <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;lstrlenW&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpString <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiStrTrimW <span class="token keyword">Lib</span> <span class="token string">&quot;ShlwApi&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;StrTrimW&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiTerminateProcess <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;TerminateProcess&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> uExitCode <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiTimeGetTime <span class="token keyword">Lib</span> <span class="token string">&quot;Winmm&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;timeGetTime&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiVarPtrArray <span class="token keyword">Lib</span> <span class="token string">&quot;MsVbVm50&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;VarPtr&quot;</span> <span class="token punctuation">(</span>Var<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Any<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiWaitForSingleObject <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hHandle <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwMilliseconds <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> browseInfo     <span class="token comment">'used by apiBrowseForFolder</span>
        hOwner <span class="token keyword">As</span> <span class="token keyword">Long</span>
        pidlRoot <span class="token keyword">As</span> <span class="token keyword">Long</span>
        pszDisplayName <span class="token keyword">As</span> <span class="token keyword">String</span>
        lpszTitle <span class="token keyword">As</span> <span class="token keyword">String</span>
        ulFlags <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lpfn <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lParam <span class="token keyword">As</span> <span class="token keyword">Long</span>
        iImage <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiBrowseForFolder <span class="token keyword">Lib</span> <span class="token string">&quot;Shell32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SHBrowseForFolderA&quot;</span> <span class="token punctuation">(</span>lpBrowseInfo <span class="token keyword">As</span> browseInfo<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> CHOOSECOLOR    <span class="token comment">'used by apiChooseColor; http://support.microsoft.com/kb/153929 and http://www.cpearson.com/Excel/Colors.aspx</span>
        lStructSize <span class="token keyword">As</span> <span class="token keyword">Long</span>
        hWndOwner <span class="token keyword">As</span> <span class="token keyword">Long</span>
        hInstance <span class="token keyword">As</span> <span class="token keyword">Long</span>
        rgbResult <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lpCustColors <span class="token keyword">As</span> <span class="token keyword">String</span>
        flags <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lCustData <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lpfnHook <span class="token keyword">As</span> <span class="token keyword">Long</span>
        lpTemplateName <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiChooseColor <span class="token keyword">Lib</span> <span class="token string">&quot;ComDlg32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;ChooseColorA&quot;</span> <span class="token punctuation">(</span>pChoosecolor <span class="token keyword">As</span> CHOOSECOLOR<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> FindWindowParameters   <span class="token comment">'Custom structure for passing in the parameters in/out of the hook enumeration function; could use global variables instead, but this is nicer</span>
        strTitle <span class="token keyword">As</span> <span class="token keyword">String</span>  <span class="token comment">'INPUT</span>
        hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span>        <span class="token comment">'OUTPUT</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>                            <span class="token comment">'Find a specific window with dynamic caption from a list of all open windows: http://www.everythingaccess.com/tutorials.asp?ID=Bring-an-external-application-window-to-the-foreground</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiEnumWindows <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;EnumWindows&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpEnumFunc <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lParam <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> lastInputInfo  <span class="token comment">'used by apiGetLastInputInfo, getLastInputTime</span>
        cbSize <span class="token keyword">As</span> <span class="token keyword">Long</span>
        dwTime <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetLastInputInfo <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetLastInputInfo&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByRef</span> plii <span class="token keyword">As</span> lastInputInfo<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> SystemTime
          wYear          <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wMonth         <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wDayOfWeek     <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wDay           <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wHour          <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wMinute        <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wSecond        <span class="token keyword">As</span> <span class="token keyword">Integer</span>
          wMilliseconds  <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Sub</span> apiGetLocalTime <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetLocalTime&quot;</span> <span class="token punctuation">(</span>lpSystem <span class="token keyword">As</span> SystemTime<span class="token punctuation">)</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> pointAPI
        X <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Y <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> rectAPI
        Left_Renamed <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Top_Renamed <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Right_Renamed <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Bottom_Renamed <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> winPlacement
        length <span class="token keyword">As</span> <span class="token keyword">Long</span>
        flags <span class="token keyword">As</span> <span class="token keyword">Long</span>
        showCmd <span class="token keyword">As</span> <span class="token keyword">Long</span>
        ptMinPosition <span class="token keyword">As</span> pointAPI
        ptMaxPosition <span class="token keyword">As</span> pointAPI
        rcNormalPosition <span class="token keyword">As</span> rectAPI
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiGetWindowPlacement <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetWindowPlacement&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> lpwndpl <span class="token keyword">As</span> winPlacement<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Type</span> winRect
        Left <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Top <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Right <span class="token keyword">As</span> <span class="token keyword">Long</span>
        Bottom <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">End</span> <span class="token keyword">Type</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> apiMoveWindow <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;MoveWindow&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hWnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> xLeft <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> yTop <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> wWidth <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> hHeight <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> repaint <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token directive comment">#Else   ' Win16 = True</span>
<span class="token directive comment">#End If</span>

</code></pre></div><h2 id="mac-apis"><a href="#mac-apis" class="header-anchor">#</a> Mac APIs</h2> <p><a href="https://msdn.microsoft.com/en-us/library/office/mt654019.aspx" target="_blank" rel="noopener noreferrer">Microsoft doesn't officially support APIs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> but with some research more declarations can be found online</p> <p>Office 2016 for Mac is sandboxed</p> <p>Unlike other versions of Office apps that support VBA, Office 2016 for Mac apps are sandboxed.</p> <p>Sandboxing restricts the apps from accessing resources outside the app container. This affects any add-ins or macros that involve file access or communication across processes. You can minimize the effects of sandboxing by using the new commands described in the following section.
New VBA commands for Office 2016 for Mac</p> <p>The following VBA commands are new and unique to Office 2016 for Mac.</p> <table><thead><tr><th>Command</th> <th>Use to</th></tr></thead> <tbody><tr><td><a href="https://msdn.microsoft.com/en-us/library/office/mt654020.aspx" target="_blank" rel="noopener noreferrer">GrantAccessToMultipleFiles<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>Request a user's permission to access multiple files at once</td></tr> <tr><td><a href="https://msdn.microsoft.com/en-us/library/office/mt654021.aspx" target="_blank" rel="noopener noreferrer">AppleScriptTask<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>Call external AppleScript scripts from VB</td></tr> <tr><td><a href="https://msdn.microsoft.com/en-us/library/office/mt654025.aspx" target="_blank" rel="noopener noreferrer">MAC_OFFICE_VERSION<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>IFDEF between different Mac Office versions at compile time</td></tr></tbody></table> <p><a href="https://stackoverflow.com/a/12320294/4914662" target="_blank" rel="noopener noreferrer">Office 2011 for Mac<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> system <span class="token keyword">Lib</span> <span class="token string">&quot;libc.dylib&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> command <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> popen <span class="token keyword">Lib</span> <span class="token string">&quot;libc.dylib&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> command <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> mode <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> pclose <span class="token keyword">Lib</span> <span class="token string">&quot;libc.dylib&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> file <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> fread <span class="token keyword">Lib</span> <span class="token string">&quot;libc.dylib&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> outStr <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> size <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> items <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> stream <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> feof <span class="token keyword">Lib</span> <span class="token string">&quot;libc.dylib&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> file <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>

</code></pre></div><ul><li></li></ul> <p><a href="https://stackoverflow.com/a/40029588/4914662" target="_blank" rel="noopener noreferrer">Office 2016 for Mac<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> popen <span class="token keyword">Lib</span> <span class="token string">&quot;libc.dylib&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> command <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> mode <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> pclose <span class="token keyword">Lib</span> <span class="token string">&quot;libc.dylib&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> file <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> fread <span class="token keyword">Lib</span> <span class="token string">&quot;libc.dylib&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> outStr <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> size <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> items <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> stream <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> feof <span class="token keyword">Lib</span> <span class="token string">&quot;libc.dylib&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> file <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr

</code></pre></div><h2 id="get-total-monitors-and-screen-resolution"><a href="#get-total-monitors-and-screen-resolution" class="header-anchor">#</a> Get total monitors and screen resolution</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Explicit

<span class="token comment">'GetSystemMetrics32 info: http://msdn.microsoft.com/en-us/library/ms724385(VS.85).aspx</span>
<span class="token directive comment">#If Win64 Then</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GetSystemMetrics32 <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetSystemMetrics&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> nIndex <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token directive comment">#ElseIf Win32 Then</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GetSystemMetrics32 <span class="token keyword">Lib</span> <span class="token string">&quot;User32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetSystemMetrics&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> nIndex <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token directive comment">#End If</span>

<span class="token comment">'VBA Wrappers:</span>
<span class="token keyword">Public</span> <span class="token keyword">Function</span> dllGetMonitors<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Const</span> SM_CMONITORS <span class="token operator">=</span> <span class="token number">80</span>
    dllGetMonitors <span class="token operator">=</span> GetSystemMetrics32<span class="token punctuation">(</span>SM_CMONITORS<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

<span class="token keyword">Public</span> <span class="token keyword">Function</span> dllGetHorizontalResolution<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Const</span> SM_CXVIRTUALSCREEN <span class="token operator">=</span> <span class="token number">78</span>
    dllGetHorizontalResolution <span class="token operator">=</span> GetSystemMetrics32<span class="token punctuation">(</span>SM_CXVIRTUALSCREEN<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

<span class="token keyword">Public</span> <span class="token keyword">Function</span> dllGetVerticalResolution<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Const</span> SM_CYVIRTUALSCREEN <span class="token operator">=</span> <span class="token number">79</span>
    dllGetVerticalResolution <span class="token operator">=</span> GetSystemMetrics32<span class="token punctuation">(</span>SM_CYVIRTUALSCREEN<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

<span class="token keyword">Public</span> <span class="token keyword">Sub</span> ShowDisplayInfo<span class="token punctuation">(</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print <span class="token string">&quot;Total monitors: &quot;</span> <span class="token operator">&amp;</span> vbTab <span class="token operator">&amp;</span> vbTab <span class="token operator">&amp;</span> dllGetMonitors
    Debug<span class="token punctuation">.</span>Print <span class="token string">&quot;Horizontal Resolution: &quot;</span> <span class="token operator">&amp;</span> vbTab <span class="token operator">&amp;</span> dllGetHorizontalResolution
    Debug<span class="token punctuation">.</span>Print <span class="token string">&quot;Vertical Resolution: &quot;</span> <span class="token operator">&amp;</span> vbTab <span class="token operator">&amp;</span> dllGetVerticalResolution

    <span class="token comment">'Total monitors:         1</span>
    <span class="token comment">'Horizontal Resolution:  1920</span>
    <span class="token comment">'Vertical Resolution:    1080</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="ftp-and-regional-apis"><a href="#ftp-and-regional-apis" class="header-anchor">#</a> FTP and Regional APIs</h2> <p>modFTP</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Explicit
<span class="token keyword">Option</span> Compare Text
<span class="token keyword">Option</span> <span class="token keyword">Private</span> <span class="token keyword">Module</span>

<span class="token comment">'http://msdn.microsoft.com/en-us/library/aa384180(v=VS.85).aspx</span>
<span class="token comment">'http://www.dailydoseofexcel.com/archives/2006/01/29/ftp-via-vba/</span>
<span class="token comment">'http://www.15seconds.com/issue/981203.htm</span>

<span class="token comment">'Open the Internet object</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> InternetOpen <span class="token keyword">Lib</span> <span class="token string">&quot;wininet.dll&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;InternetOpenA&quot;</span> <span class="token punctuation">(</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> sAgent <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lAccessType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> sProxyName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> sProxyBypass <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lFlags <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">_</span>
<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token comment">'ex: lngINet = InternetOpen(“MyFTP Control”, 1, vbNullString, vbNullString, 0)</span>

<span class="token comment">'Connect to the network</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> InternetConnect <span class="token keyword">Lib</span> <span class="token string">&quot;wininet.dll&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;InternetConnectA&quot;</span> <span class="token punctuation">(</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> hInternetSession <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> sServerName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> nServerPort <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> sUsername <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> sPassword <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lService <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lContext <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">_</span>
<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token comment">'ex: lngINetConn = InternetConnect(lngINet, &quot;ftp.microsoft.com&quot;, 0, &quot;anonymous&quot;, &quot;wally@wallyworld.com&quot;, 1, 0, 0)</span>

<span class="token comment">'Get a file</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> FtpGetFile <span class="token keyword">Lib</span> <span class="token string">&quot;wininet.dll&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FtpGetFileA&quot;</span> <span class="token punctuation">(</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> hFtpSession <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lpszRemoteFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lpszNewFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> fFailIfExists <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> dwFlagsAndAttributes <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> dwFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> dwContext <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">_</span>
<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
<span class="token comment">'ex: blnRC = FtpGetFile(lngINetConn, &quot;dirmap.txt&quot;, &quot;c:\dirmap.txt&quot;, 0, 0, 1, 0)</span>

<span class="token comment">'Send a file</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> FtpPutFile <span class="token keyword">Lib</span> <span class="token string">&quot;wininet.dll&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FtpPutFileA&quot;</span> <span class="token operator">_</span>
<span class="token punctuation">(</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> hFtpSession <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lpszLocalFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lpszRemoteFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> dwFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> dwContext <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">_</span>
<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
<span class="token comment">'ex: blnRC = FtpPutFile(lngINetConn, “c:\dirmap.txt”, “dirmap.txt”, 1, 0)</span>

<span class="token comment">'Delete a file</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> FtpDeleteFile <span class="token keyword">Lib</span> <span class="token string">&quot;wininet.dll&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FtpDeleteFileA&quot;</span> <span class="token operator">_</span>
<span class="token punctuation">(</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> hFtpSession <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lpszFileName <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">_</span>
<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
<span class="token comment">'ex: blnRC = FtpDeleteFile(lngINetConn, “test.txt”)</span>

<span class="token comment">'Close the Internet object</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> InternetCloseHandle <span class="token keyword">Lib</span> <span class="token string">&quot;wininet.dll&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hInet <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Integer</span>
<span class="token comment">'ex: InternetCloseHandle lngINetConn</span>
<span class="token comment">'ex: InternetCloseHandle lngINet</span>



<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> FtpFindFirstFile <span class="token keyword">Lib</span> <span class="token string">&quot;wininet.dll&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;FtpFindFirstFileA&quot;</span> <span class="token operator">_</span>
<span class="token punctuation">(</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> hFtpSession <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> lpszSearchFile <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    lpFindFileData <span class="token keyword">As</span> WIN32_FIND_DATA<span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> dwFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> dwContent <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">_</span>
<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Type</span> FILETIME
        dwLowDateTime <span class="token keyword">As</span> <span class="token keyword">Long</span>
        dwHighDateTime <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">End</span> <span class="token keyword">Type</span>
<span class="token keyword">Private</span> <span class="token keyword">Type</span> WIN32_FIND_DATA
        dwFileAttributes <span class="token keyword">As</span> <span class="token keyword">Long</span>
        ftCreationTime <span class="token keyword">As</span> FILETIME
        ftLastAccessTime <span class="token keyword">As</span> FILETIME
        ftLastWriteTime <span class="token keyword">As</span> FILETIME
        nFileSizeHigh <span class="token keyword">As</span> <span class="token keyword">Long</span>
        nFileSizeLow <span class="token keyword">As</span> <span class="token keyword">Long</span>
        dwReserved0 <span class="token keyword">As</span> <span class="token keyword">Long</span>
        dwReserved1 <span class="token keyword">As</span> <span class="token keyword">Long</span>
        cFileName <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">*</span> MAX_FTP_PATH
        cAlternate <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">*</span> <span class="token number">14</span>
<span class="token keyword">End</span> <span class="token keyword">Type</span>
<span class="token comment">'ex: lngHINet = FtpFindFirstFile(lngINetConn, &quot;*.*&quot;, pData, 0, 0)</span>

<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> InternetFindNextFile <span class="token keyword">Lib</span> <span class="token string">&quot;wininet.dll&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;InternetFindNextFileA&quot;</span> <span class="token operator">_</span>
<span class="token punctuation">(</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> hFind <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    lpvFindData <span class="token keyword">As</span> WIN32_FIND_DATA <span class="token operator">_</span>
<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token comment">'ex: blnRC = InternetFindNextFile(lngHINet, pData)</span>


<span class="token keyword">Public</span> <span class="token keyword">Sub</span> showLatestFTPVersion<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> ftpSuccess <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">,</span> msg <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> lngFindFirst <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> lngINet <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lngINetConn <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> pData <span class="token keyword">As</span> WIN32_FIND_DATA
    <span class="token comment">'init the filename buffer</span>
    pData<span class="token punctuation">.</span>cFileName <span class="token operator">=</span> <span class="token keyword">String</span><span class="token punctuation">(</span><span class="token number">260</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

    msg <span class="token operator">=</span> <span class="token string">&quot;FTP Error&quot;</span>
    lngINet <span class="token operator">=</span> InternetOpen<span class="token punctuation">(</span><span class="token string">&quot;MyFTP Control&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> vbNullString<span class="token punctuation">,</span> vbNullString<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">If</span> lngINet <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
        lngINetConn <span class="token operator">=</span> InternetConnect<span class="token punctuation">(</span>lngINet<span class="token punctuation">,</span> FTP_SERVER_NAME<span class="token punctuation">,</span> FTP_SERVER_PORT<span class="token punctuation">,</span> FTP_USER_NAME<span class="token punctuation">,</span> FTP_PASSWORD<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">If</span> lngINetConn <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                FtpPutFile lngINetConn<span class="token punctuation">,</span> <span class="token string">&quot;C:\Tmp\ftp.cls&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ftp.cls&quot;</span><span class="token punctuation">,</span> FTP_TRANSFER_BINARY<span class="token punctuation">,</span> <span class="token number">0</span>
                <span class="token comment">'lngFindFirst = FtpFindFirstFile(lngINetConn, &quot;ExcelDiff.xlsm&quot;, pData, 0, 0)</span>
            <span class="token keyword">If</span> lngINet <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                msg <span class="token operator">=</span> <span class="token string">&quot;DLL error: &quot;</span> <span class="token operator">&amp;</span> Err<span class="token punctuation">.</span>LastDllError <span class="token operator">&amp;</span> <span class="token string">&quot;, Error Number: &quot;</span> <span class="token operator">&amp;</span> Err<span class="token punctuation">.</span>Number <span class="token operator">&amp;</span> <span class="token string">&quot;, Error Desc: &quot;</span> <span class="token operator">&amp;</span> Err<span class="token punctuation">.</span>Description
            <span class="token keyword">Else</span>
                msg <span class="token operator">=</span> left<span class="token punctuation">(</span>pData<span class="token punctuation">.</span>cFileName<span class="token punctuation">,</span> InStr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> pData<span class="token punctuation">.</span>cFileName<span class="token punctuation">,</span> <span class="token keyword">String</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vbBinaryCompare<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
            InternetCloseHandle lngINetConn
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    InternetCloseHandle lngINet
    <span class="token keyword">End</span> <span class="token keyword">If</span>
        MsgBox msg
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>modRegional:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Explicit

<span class="token keyword">Private</span> <span class="token keyword">Const</span> LOCALE_SDECIMAL <span class="token operator">=</span> <span class="token number">&amp;HE</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> LOCALE_SLIST <span class="token operator">=</span> <span class="token number">&amp;HC</span>

<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GetLocaleInfo <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;GetLocaleInfoA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> Locale <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> LCType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpLCData <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> cchData <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> SetLocaleInfo <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;SetLocaleInfoA&quot;</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> Locale <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> LCType <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpLCData <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GetUserDefaultLCID<span class="token operator">%</span> <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">Public</span> <span class="token keyword">Function</span> getTimeSeparator<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
    getTimeSeparator <span class="token operator">=</span> Application<span class="token punctuation">.</span>International<span class="token punctuation">(</span>xlTimeSeparator<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>
<span class="token keyword">Public</span> <span class="token keyword">Function</span> getDateSeparator<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
    getDateSeparator <span class="token operator">=</span> Application<span class="token punctuation">.</span>International<span class="token punctuation">(</span>xlDateSeparator<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>
<span class="token keyword">Public</span> <span class="token keyword">Function</span> getListSeparator<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> ListSeparator <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> iRetVal1 <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> iRetVal2 <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lpLCDataVar <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> Position <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> Locale <span class="token keyword">As</span> <span class="token keyword">Long</span>
    Locale <span class="token operator">=</span> GetUserDefaultLCID<span class="token punctuation">(</span><span class="token punctuation">)</span>
    iRetVal1 <span class="token operator">=</span> GetLocaleInfo<span class="token punctuation">(</span>Locale<span class="token punctuation">,</span> LOCALE_SLIST<span class="token punctuation">,</span> lpLCDataVar<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    ListSeparator <span class="token operator">=</span> <span class="token keyword">String</span><span class="token operator">$</span><span class="token punctuation">(</span>iRetVal1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    iRetVal2 <span class="token operator">=</span> GetLocaleInfo<span class="token punctuation">(</span>Locale<span class="token punctuation">,</span> LOCALE_SLIST<span class="token punctuation">,</span> ListSeparator<span class="token punctuation">,</span> iRetVal1<span class="token punctuation">)</span>
    Position <span class="token operator">=</span> InStr<span class="token punctuation">(</span>ListSeparator<span class="token punctuation">,</span> Chr<span class="token operator">$</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">If</span> Position <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span> ListSeparator <span class="token operator">=</span> Left<span class="token operator">$</span><span class="token punctuation">(</span>ListSeparator<span class="token punctuation">,</span> Position <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">Else</span> ListSeparator <span class="token operator">=</span> vbNullString
    getListSeparator <span class="token operator">=</span> ListSeparator
<span class="token keyword">End</span> <span class="token keyword">Function</span>

<span class="token keyword">Private</span> <span class="token keyword">Sub</span> ChangeSettingExample<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">'change the setting of the character displayed as the decimal separator.</span>
    <span class="token keyword">Call</span> SetLocalSetting<span class="token punctuation">(</span>LOCALE_SDECIMAL<span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>  <span class="token comment">'to change to &quot;,&quot;</span>
    <span class="token keyword">Stop</span>                                        <span class="token comment">'check your control panel to verify or use the GetLocaleInfo API function</span>
    <span class="token keyword">Call</span> SetLocalSetting<span class="token punctuation">(</span>LOCALE_SDECIMAL<span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span>  <span class="token comment">'to back change to &quot;.&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">Private</span> <span class="token keyword">Function</span> SetLocalSetting<span class="token punctuation">(</span>LC_CONST <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> Setting <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token keyword">Call</span> SetLocaleInfo<span class="token punctuation">(</span>GetUserDefaultLCID<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> LC_CONST<span class="token punctuation">,</span> Setting<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>Common operating environment library files (DLL's):</p> <table><thead><tr><th>Dynamic Link Library</th> <th>Description</th></tr></thead> <tbody><tr><td>Advapi32.dll</td> <td>Advanced services library for APIs including many security and Registry calls</td></tr> <tr><td>Comdlg32.dll</td> <td>Common dialog API library</td></tr> <tr><td>Gdi32.dll</td> <td>Graphics Device Interface API library</td></tr> <tr><td>Kernel32.dll</td> <td>Core Windows 32-bit base API support</td></tr> <tr><td>Lz32.dll</td> <td>32-bit compression routines</td></tr> <tr><td>Mpr.dll</td> <td>Multiple Provider Router library</td></tr> <tr><td>Netapi32.dll</td> <td>32-bit Network API library</td></tr> <tr><td>Shell32.dll</td> <td>32-bit Shell API library</td></tr> <tr><td>User32.dll</td> <td>Library for user interface routines</td></tr> <tr><td>Version.dll</td> <td>Version library</td></tr> <tr><td>Winmm.dll</td> <td>Windows multimedia library</td></tr> <tr><td>Winspool.drv</td> <td>Print spooler interface that contains the print spooler API calls</td></tr></tbody></table> <p>New arguments used for the 64 system:</p> <table><thead><tr><th>Type</th> <th>Item</th> <th>Description</th></tr></thead> <tbody><tr><td>Qualifier</td> <td>PtrSafe</td> <td>Indicates that the Declare statement is compatible with 64-bits. This attribute is mandatory on 64-bit systems</td></tr> <tr><td>Data Type</td> <td>LongPtr</td> <td>A variable data type which is a 4-bytes data type on 32-bit versions and an 8-byte data type on 64-bit versions of Office 2010. This is the recommended way of declaring a pointer or a handle for new code but also for legacy code if it has to run in the 64-bit version of Office 2010. It is only supported in the VBA 7 runtime on 32-bit and 64-bit. Note that you can assign numeric values to it but not numeric types</td></tr> <tr><td>Data Type</td> <td>LongLong</td> <td>This is an 8-byte data type which is available only in 64-bit versions of Office 2010. You can assign numeric values but not numeric types (to avoid truncation)</td></tr> <tr><td>Conversion</td> <td>Operator</td> <td>CLngPtr    Converts a simple expression to a LongPtr data type</td></tr> <tr><td>Conversion</td> <td>Operator</td> <td>CLngLng    Converts a simple expression to a LongLong data type</td></tr> <tr><td>Function</td> <td>VarPtr</td> <td>Variant converter. Returns a LongPtr on 64-bit versions, and a Long on 32-bit (4 bytes)</td></tr> <tr><td>Function</td> <td>ObjPtr</td> <td>Object converter. Returns a LongPtr on 64-bit versions, and a Long on 32-bit (4 bytes)</td></tr> <tr><td>Function</td> <td>StrPtr</td> <td>String converter. Returns a LongPtr on 64-bit versions, and a Long on 32-bit (4 bytes)</td></tr></tbody></table> <p>Full reference of call signatures:</p> <li>
[Win32api32.txt for Visual Basic 5.0](https://support.microsoft.com/en-us/help/178020/file-win32api.exe-) (old API declarations, last reviewed Mar 2005, Microsoft)
</li> <li>
[Win32API_PtrSafe with 64-bit Support](https://www.microsoft.com/en-us/download/details.aspx?id=9970) (Office 2010, Microsoft)
</li></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/api-calls.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/non-latin-characters.html" class="prev">
        Non-Latin Characters
      </a></span> <span class="next"><a href="/vba/automation-or-using-other-applications-libraries.html">
        Automation or Using other applications Libraries
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3402.52c54115.js" defer></script>
  </body>
</html>
