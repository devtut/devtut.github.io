<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - Scripting.Dictionary object</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Properties and Methods, Getting unique values with Scripting.Dictionary, Aggregating data with Scripting.Dictionary (Maximum, Count)">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - Scripting.Dictionary object">
    <meta property="og:description" content="Properties and Methods, Getting unique values with Scripting.Dictionary, Aggregating data with Scripting.Dictionary (Maximum, Count)">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/scripting-dictionary-object.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - Scripting.Dictionary object">
    <meta name="twitter:description" content="Properties and Methods, Getting unique values with Scripting.Dictionary, Aggregating data with Scripting.Dictionary (Maximum, Count)">
    <meta name="twitter:url" content="/vba/scripting-dictionary-object.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3438.f11bcaa3.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" aria-current="page" class="active sidebar-link">Scripting.Dictionary object</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/scripting-dictionary-object.html#properties-and-methods" class="sidebar-link">Properties and Methods</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-dictionary-object.html#getting-unique-values-with-scripting-dictionary" class="sidebar-link">Getting unique values with Scripting.Dictionary</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-dictionary-object.html#aggregating-data-with-scripting-dictionary-maximum-count" class="sidebar-link">Aggregating data with Scripting.Dictionary (Maximum, Count)</a></li></ul></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="scripting-dictionary-object"><a href="#scripting-dictionary-object" class="header-anchor">#</a> Scripting.Dictionary object</h1> <h2 id="properties-and-methods"><a href="#properties-and-methods" class="header-anchor">#</a> Properties and Methods</h2> <p>A <a href="https://msdn.microsoft.com/en-us/library/x4k5wbx4(v=vs.84).aspx" target="_blank" rel="noopener noreferrer">Scripting Dictionary object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> stores information in Key/Item pairs. The Keys must be unique and not an array but the associated Items can be repeated (their uniqueness is held by the companion Key) and can be of any type of variant or object.</p> <p>A dictionary can be thought of as a two field in-memory database with a primary unique index on the first 'field' (the <strong>Key</strong>). This unique index on the Keys property allows very fast 'lookups' to retrieve a Key's associated Item value.</p> <p><strong>Properties</strong></p> <table><thead><tr><th><sub>name</sub></th> <th><sub>read/write</sub></th> <th><sub>type</sub></th> <th><sub>description</sub></th></tr></thead> <tbody><tr><td>CompareMode</td> <td><em>read / write</em></td> <td>CompareMode constant</td> <td>Setting the CompareMode can only be performed on an empty dictionary. Accepted values are 0 (vbBinaryCompare), 1 (vbTextCompare), 2 (vbDatabaseCompare).</td></tr> <tr><td>Count</td> <td><em>read only</em></td> <td>unsigned long integer</td> <td>A one-based count of the key/item pairs in the scripting dictionary object.</td></tr> <tr><td>Key</td> <td><em>read / write</em></td> <td>non-array variant</td> <td>Each individual unique key in the dictionary.</td></tr> <tr><td>Item(<strong>Key</strong>)</td> <td><em>read / write</em></td> <td>any variant</td> <td>Default property.  Each individual item associated with a key in the dictionary. Note that attempting to retrieve an item with a key that does not exist in the dictionary will <strong>implicitly add</strong> the passed key.</td></tr></tbody></table> <p><strong>Methods</strong></p> <table><thead><tr><th><sub>name</sub></th> <th><sub>description</sub></th></tr></thead> <tbody><tr><td>Add(<em>Key</em>,<em>Item</em>)</td> <td>Adds a new Key and Item to the dictionary. The new key must not exist in the dictionary's current Keys collection but an item can be repeated among many unique keys.</td></tr> <tr><td>Exists(<em>Key</em>)</td> <td>Boolean test to determine if a Key already exists in the dictionary.</td></tr> <tr><td>Keys</td> <td>Returns the array or collection of unique keys.</td></tr> <tr><td>Items</td> <td>Returns the array or collection of associated items.</td></tr> <tr><td>Remove(<em>Key</em>)</td> <td>Removes an individual dictionary key and its associated item.</td></tr> <tr><td>RemoveAll</td> <td>Clears all of a dictionary object's keys and items.</td></tr></tbody></table> <p><strong>Sample Code</strong></p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token comment">'Populate, enumerate, locate and remove entries in a dictionary that was created</span>
<span class="token comment">'with late binding</span>
<span class="token keyword">Sub</span> iterateDictionaryLate<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> k <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">,</span> dict <span class="token keyword">As</span> <span class="token keyword">Object</span>
    
    <span class="token keyword">Set</span> dict <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.Dictionary&quot;</span><span class="token punctuation">)</span>
    dict<span class="token punctuation">.</span>CompareMode <span class="token operator">=</span> vbTextCompare          <span class="token comment">'non-case sensitive compare model</span>
    
    <span class="token comment">'populate the dictionary</span>
    dict<span class="token punctuation">.</span>Add Key<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Red&quot;</span><span class="token punctuation">,</span> Item<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Balloon&quot;</span>
    dict<span class="token punctuation">.</span>Add Key<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Green&quot;</span><span class="token punctuation">,</span> Item<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Balloon&quot;</span>
    dict<span class="token punctuation">.</span>Add Key<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Blue&quot;</span><span class="token punctuation">,</span> Item<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Balloon&quot;</span>
    
    <span class="token comment">'iterate through the keys</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> k <span class="token keyword">In</span> dict<span class="token punctuation">.</span>Keys
        Debug<span class="token punctuation">.</span>Print k <span class="token operator">&amp;</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">&amp;</span> dict<span class="token punctuation">.</span>Item<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
    <span class="token keyword">Next</span> k

    <span class="token comment">'locate the Item for Green</span>
    Debug<span class="token punctuation">.</span>Print dict<span class="token punctuation">.</span>Item<span class="token punctuation">(</span><span class="token string">&quot;Green&quot;</span><span class="token punctuation">)</span>
    
    <span class="token comment">'remove key/item pairs from the dictionary</span>
    dict<span class="token punctuation">.</span>Remove <span class="token string">&quot;blue&quot;</span>      <span class="token comment">'remove individual key/item pair by key</span>
    dict<span class="token punctuation">.</span>RemoveAll          <span class="token comment">'remove all remaining key/item pairs</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">'Populate, enumerate, locate and remove entries in a dictionary that was created</span>
<span class="token comment">'with early binding (see Remarks)</span>
<span class="token keyword">Sub</span> iterateDictionaryEarly<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> d <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> k <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">Dim</span> dict <span class="token keyword">As</span> <span class="token keyword">New</span> Scripting<span class="token punctuation">.</span>Dictionary
    
    dict<span class="token punctuation">.</span>CompareMode <span class="token operator">=</span> vbTextCompare          <span class="token comment">'non-case sensitive compare model</span>
    
    <span class="token comment">'populate the dictionary</span>
    dict<span class="token punctuation">.</span>Add Key<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Red&quot;</span><span class="token punctuation">,</span> Item<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Balloon&quot;</span>
    dict<span class="token punctuation">.</span>Add Key<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Green&quot;</span><span class="token punctuation">,</span> Item<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Balloon&quot;</span>
    dict<span class="token punctuation">.</span>Add Key<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Blue&quot;</span><span class="token punctuation">,</span> Item<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Balloon&quot;</span>
    dict<span class="token punctuation">.</span>Add Key<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;White&quot;</span><span class="token punctuation">,</span> Item<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;Balloon&quot;</span>
    
    <span class="token comment">'iterate through the keys</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> k <span class="token keyword">In</span> dict<span class="token punctuation">.</span>Keys
        Debug<span class="token punctuation">.</span>Print k <span class="token operator">&amp;</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">&amp;</span> dict<span class="token punctuation">.</span>Item<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
    <span class="token keyword">Next</span> k

    <span class="token comment">'iterate through the keys by the count</span>
    <span class="token keyword">For</span> d <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> dict<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span>
        Debug<span class="token punctuation">.</span>Print dict<span class="token punctuation">.</span>Keys<span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">&amp;</span> dict<span class="token punctuation">.</span>Items<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
    <span class="token keyword">Next</span> d
    
    <span class="token comment">'iterate through the keys by the boundaries of the keys collection</span>
    <span class="token keyword">For</span> d <span class="token operator">=</span> LBound<span class="token punctuation">(</span>dict<span class="token punctuation">.</span>Keys<span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>dict<span class="token punctuation">.</span>Keys<span class="token punctuation">)</span>
        Debug<span class="token punctuation">.</span>Print dict<span class="token punctuation">.</span>Keys<span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">&amp;</span> dict<span class="token punctuation">.</span>Items<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
    <span class="token keyword">Next</span> d
    
    <span class="token comment">'locate the Item for Green</span>
    Debug<span class="token punctuation">.</span>Print dict<span class="token punctuation">.</span>Item<span class="token punctuation">(</span><span class="token string">&quot;Green&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">'locate the Item for the first key</span>
    Debug<span class="token punctuation">.</span>Print dict<span class="token punctuation">.</span>Item<span class="token punctuation">(</span>dict<span class="token punctuation">.</span>Keys<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">'locate the Item for the last key</span>
    Debug<span class="token punctuation">.</span>Print dict<span class="token punctuation">.</span>Item<span class="token punctuation">(</span>dict<span class="token punctuation">.</span>Keys<span class="token punctuation">(</span>UBound<span class="token punctuation">(</span>dict<span class="token punctuation">.</span>Keys<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment">'remove key/item pairs from the dictionary</span>
    dict<span class="token punctuation">.</span>Remove <span class="token string">&quot;blue&quot;</span>                         <span class="token comment">'remove individual key/item pair by key</span>
    dict<span class="token punctuation">.</span>Remove dict<span class="token punctuation">.</span>Keys<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                   <span class="token comment">'remove first key/item by index position</span>
    dict<span class="token punctuation">.</span>Remove dict<span class="token punctuation">.</span>Keys<span class="token punctuation">(</span>UBound<span class="token punctuation">(</span>dict<span class="token punctuation">.</span>Keys<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">'remove last key/item by index position</span>
    dict<span class="token punctuation">.</span>RemoveAll                             <span class="token comment">'remove all remaining key/item pairs</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="getting-unique-values-with-scripting-dictionary"><a href="#getting-unique-values-with-scripting-dictionary" class="header-anchor">#</a> Getting unique values with Scripting.Dictionary</h2> <p>The <code>Dictionary</code> allows getting a unique set of values very simply. Consider the following function:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Function</span> Unique<span class="token punctuation">(</span>values <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">'Put all the values as keys into a dictionary</span>
    <span class="token keyword">Dim</span> dict <span class="token keyword">As</span> <span class="token keyword">New</span> Scripting<span class="token punctuation">.</span>Dictionary
    <span class="token keyword">Dim</span> val <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> val <span class="token keyword">In</span> values
        dict<span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">'The value doesn't matter here</span>
    <span class="token keyword">Next</span>
    Unique <span class="token operator">=</span> dict<span class="token punctuation">.</span>Keys
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><p>which you could then call like this:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Variant</span>
duplicates <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">Dim</span> uniqueVals<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Variant</span>
uniqueVals <span class="token operator">=</span> Unique<span class="token punctuation">(</span>duplicates<span class="token punctuation">)</span>

</code></pre></div><p>and <code>uniqueVals</code> would contain only <code>{1,2,3}</code>.</p> <p>Note: This function can be used with any enumerable object.</p> <h2 id="aggregating-data-with-scripting-dictionary-maximum-count"><a href="#aggregating-data-with-scripting-dictionary-maximum-count" class="header-anchor">#</a> Aggregating data with Scripting.Dictionary (Maximum, Count)</h2> <p>Dictionaries are great for managing information where multiple entries occur, but you are only concerned with a single value for each set of entries — the first or last value, the mininmum or maximum value, an average, a sum etc.</p> <p>Consider a workbook that holds a log of user activity, with a script that inserts the username and edit date every time someone edits the workbook:</p> <blockquote></blockquote> <p><strong><code>Log</code> worksheet</strong> <table><thead>|A|B
</thead><tbody>|bob|10/12/2016 9:00
|alice|10/13/2016 13:00
|bob|10/13/2016 13:30
|alice|10/13/2016 14:00
|alice|10/14/2016 13:00
</tbody></table></p> <p>Let's say you want to output the last edit time for each user, into a worksheet named <code>Summary</code>.</p> <p><sup>Notes:</sup><br> <sup>1. The data is assumed to be in <code>ActiveWorkbook</code>.</sup><br> <sup>2. We are using an array to pull the values from the worksheet; this is more efficient than iterating over each cell.</sup><br> <sup>3. The <code>Dictionary</code> is created using early binding.</sup></p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> LastEdit<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">Dim</span> vLog <span class="token keyword">as</span> <span class="token keyword">Variant</span><span class="token punctuation">,</span> vKey <span class="token keyword">as</span> <span class="token keyword">Variant</span>
<span class="token keyword">Dim</span> dict <span class="token keyword">as</span> <span class="token keyword">New</span> Scripting<span class="token punctuation">.</span>Dictionary
<span class="token keyword">Dim</span> lastRow <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> lastColumn <span class="token keyword">As</span> <span class="token keyword">Integer</span>
<span class="token keyword">Dim</span> i <span class="token keyword">as</span> <span class="token keyword">Long</span>
<span class="token keyword">Dim</span> anchor <span class="token keyword">As</span> Range

<span class="token keyword">With</span> ActiveWorkbook
    <span class="token keyword">With</span> <span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">&quot;Log&quot;</span><span class="token punctuation">)</span>
        <span class="token comment">'Pull entries in &quot;log&quot; into a variant array</span>
        lastRow <span class="token operator">=</span> <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span> <span class="token operator">&amp;</span> <span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
        vlog <span class="token operator">=</span> <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;a1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>lastRow<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value2

        <span class="token comment">'Loop through array</span>
        <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">to</span> lastRow
            <span class="token keyword">Dim</span> username <span class="token keyword">As</span> <span class="token keyword">String</span>
            username <span class="token operator">=</span> vlog<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">Dim</span> editDate <span class="token keyword">As</span> <span class="token keyword">Date</span>
            editDate <span class="token operator">=</span> vlog<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

            <span class="token comment">'If the username is not yet in the dictionary:</span>
            <span class="token keyword">If</span> <span class="token keyword">Not</span> dict<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token keyword">Then</span>
                dict<span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">=</span> editDate
            <span class="token keyword">ElseIf</span> dict<span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">&lt;</span> editDate <span class="token keyword">Then</span>
                dict<span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">=</span> editDate
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">Next</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>

    <span class="token keyword">With</span> <span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">&quot;Summary&quot;</span><span class="token punctuation">)</span>
        <span class="token comment">'Loop through keys</span>
        <span class="token keyword">For</span> <span class="token keyword">Each</span> vKey <span class="token keyword">in</span> dict<span class="token punctuation">.</span>Keys
            <span class="token comment">'Add the key and value at the next available row</span>
            Anchor <span class="token operator">=</span> <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span> <span class="token operator">&amp;</span> <span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
            Anchor <span class="token operator">=</span> vKey
            Anchor<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> dict<span class="token punctuation">(</span>vKey<span class="token punctuation">)</span>
        <span class="token keyword">Next</span> vKey
    <span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>and the output will look like this:</p> <blockquote></blockquote> <p><strong><code>Summary</code> worksheet</strong> <table><thead>|A|B
</thead><tbody>|bob|10/13/2016 13:30
|alice|10/14/2016 13:00
</tbody></table></p> <p>If on the other hand you want to output how many times each user edited the workbook, the body of the <code>For</code> loop should look like this:</p> <div class="language- extra-class"><pre class="language-text"><code>
       'Loop through array
        For i = 1 to lastRow
            Dim username As String
            username = vlog(i, 1)

            'If the username is not yet in the dictionary:
            If Not dict.Exists(username) Then
                dict(username) = 1
            Else
                dict(username) = dict(username) + 1
            End If
        Next

</code></pre></div><p>and the output will look like this:</p> <blockquote></blockquote> <p><strong><code>Summary</code> worksheet</strong> <table><thead>|A|B
</thead><tbody>|bob|2
|alice|3
</tbody></table></p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>You must add Microsoft Scripting Runtime to the VBA project through the VBE's Tools → References command in order to implement early binding of the Scripting Dictionary object.
This library reference is carried with the project; it does not have to be re-referenced when the VBA project is distributed and run on another computer.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/scripting-dictionary-object.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/events.html" class="prev">
        Events
      </a></span> <span class="next"><a href="/vba/working-with-ado.html">
        Working with ADO
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3438.f11bcaa3.js" defer></script>
  </body>
</html>
