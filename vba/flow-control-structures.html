<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - Flow control structures</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="For loop, Select Case, For Each loop, Do loop, While loop">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - Flow control structures">
    <meta property="og:description" content="For loop, Select Case, For Each loop, Do loop, While loop">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/flow-control-structures.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - Flow control structures">
    <meta name="twitter:description" content="For loop, Select Case, For Each loop, Do loop, While loop">
    <meta name="twitter:url" content="/vba/flow-control-structures.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/3422.11b875e9.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="active sidebar-link">Flow control structures</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/flow-control-structures.html#for-loop" class="sidebar-link">For loop</a></li><li class="sidebar-sub-header"><a href="/vba/flow-control-structures.html#select-case" class="sidebar-link">Select Case</a></li><li class="sidebar-sub-header"><a href="/vba/flow-control-structures.html#for-each-loop" class="sidebar-link">For Each loop</a></li><li class="sidebar-sub-header"><a href="/vba/flow-control-structures.html#do-loop" class="sidebar-link">Do loop</a></li><li class="sidebar-sub-header"><a href="/vba/flow-control-structures.html#while-loop" class="sidebar-link">While loop</a></li></ul></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="flow-control-structures"><a href="#flow-control-structures" class="header-anchor">#</a> Flow control structures</h1> <h2 id="for-loop"><a href="#for-loop" class="header-anchor">#</a> For loop</h2> <p>The <code>For</code> loop is used to repeat the enclosed section of code a given number of times. The following simple example illustrates the basic syntax:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> i <span class="token keyword">as</span> <span class="token keyword">Integer</span>           <span class="token comment">'Declaration of i</span>
<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">10</span>            <span class="token comment">'Declare how many times the loop shall be executed</span>
    Debug<span class="token punctuation">.</span>Print i          <span class="token comment">'The piece of code which is repeated</span>
<span class="token keyword">Next</span> i                     <span class="token comment">'The end of the loop</span>

</code></pre></div><p>The code above declares an Integer <code>i</code>. The <code>For</code> loop assigns every value between 1 and 10 to <code>i</code> and then executes <code>Debug.Print i</code> - i.e. the code prints the numbers 1 through 10 to the immediate window. Note that the loop variable is incremented by the <code>Next</code> statement, that is after the enclosed code executes as opposed to before it executes.</p> <p>By default, the counter will be incremented by 1 each time the loop executes. However, a <code>Step</code> can be specified to change the amount of the increment as either a literal or the return value of a function. If the starting value, ending value, or <code>Step</code> value is a floating point number, it will be rounded to the nearest integer value. <code>Step</code> can be either a positive or negative value.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">10</span> <span class="token keyword">Step</span> <span class="token number">2</span>
    Debug<span class="token punctuation">.</span>Print i       <span class="token comment">'Prints 1, 3, 5, 7, and 9</span>
<span class="token keyword">Next</span>

</code></pre></div><p>In general a <code>For</code> loop would be used in situations where it is known before the loop starts how many times to execute the enclosed code (otherwise a <code>Do</code> or <code>While</code> loop may be more appropriate). This is because the exit condition is fixed after the first entry into loop, as this code demonstrates:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> Iterations <span class="token keyword">As</span> <span class="token keyword">Long</span>              <span class="token comment">'Module scope</span>

<span class="token keyword">Public</span> <span class="token keyword">Sub</span> Example<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
    Iterations <span class="token operator">=</span> <span class="token number">10</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> Iterations
        Debug<span class="token punctuation">.</span>Print Iterations     <span class="token comment">'Prints 10 through 1, descending.</span>
        Iterations <span class="token operator">=</span> Iterations <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>A <code>For</code> loop can be exited early with the <code>Exit For</code> statement:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>

<span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">10</span>
    <span class="token keyword">If</span> i <span class="token operator">&gt;</span> <span class="token number">5</span> <span class="token keyword">Then</span>
        <span class="token keyword">Exit</span> <span class="token keyword">For</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    Debug<span class="token punctuation">.</span>Print i       <span class="token comment">'Prints 1, 2, 3, 4, 5 before loop exits early.</span>
<span class="token keyword">Next</span>

</code></pre></div><h2 id="select-case"><a href="#select-case" class="header-anchor">#</a> Select Case</h2> <p><code>Select Case</code> can be used when many different conditions are possible. The conditions are checked from top to bottom and only the first case that match will be executed.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> TestCase<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> MyVar <span class="token keyword">As</span> <span class="token keyword">String</span>

    <span class="token keyword">Select</span> <span class="token keyword">Case</span> MyVar    <span class="token comment">'We Select the Variable MyVar to Work with</span>
        <span class="token keyword">Case</span> <span class="token string">&quot;Hello&quot;</span>     <span class="token comment">'Now we simply check the cases we want to check</span>
            MsgBox <span class="token string">&quot;This Case&quot;</span>
        <span class="token keyword">Case</span> <span class="token string">&quot;World&quot;</span>
            MsgBox <span class="token string">&quot;Important&quot;</span>
        <span class="token keyword">Case</span> <span class="token string">&quot;How&quot;</span>
            MsgBox <span class="token string">&quot;Stuff&quot;</span>
        <span class="token keyword">Case</span> <span class="token string">&quot;Are&quot;</span>
            MsgBox <span class="token string">&quot;I'm running out of ideas&quot;</span>
        <span class="token keyword">Case</span> <span class="token string">&quot;You?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Today&quot;</span>  <span class="token comment">'You can separate several conditions with a comma</span>
            MsgBox <span class="token string">&quot;Uuuhm...&quot;</span> <span class="token comment">'if any is matched it will go into the case</span>
        <span class="token keyword">Case</span> <span class="token keyword">Else</span>             <span class="token comment">'If none of the other cases is hit</span>
            MsgBox <span class="token string">&quot;All of the other cases failed&quot;</span>
    <span class="token keyword">End</span> <span class="token keyword">Select</span>

    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">Select</span> <span class="token keyword">Case</span> i
        <span class="token keyword">Case</span> <span class="token keyword">Is</span> <span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token comment">'&quot;Is&quot; can be used instead of the variable in conditions.</span>
            MsgBox <span class="token string">&quot;i is greater than 2&quot;</span>
        <span class="token comment">'Case 2 &lt; Is '&quot;Is&quot; can only be used at the beginning of the condition.</span>
        <span class="token comment">'Case Else is optional</span>
    <span class="token keyword">End</span> <span class="token keyword">Select</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>The logic of the <code>Select Case</code> block can be inverted to support testing of different variables too, in this kind of scenario we can also use logical operators:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> x <span class="token keyword">As</span> <span class="token keyword">Integer</span>
<span class="token keyword">Dim</span> y <span class="token keyword">As</span> <span class="token keyword">Integer</span>

x <span class="token operator">=</span> <span class="token number">2</span>
y <span class="token operator">=</span> <span class="token number">5</span>

<span class="token keyword">Select</span> <span class="token keyword">Case</span> <span class="token boolean">True</span>
    <span class="token keyword">Case</span> x <span class="token operator">&gt;</span> <span class="token number">3</span>
        MsgBox <span class="token string">&quot;x is greater than 3&quot;</span>
    <span class="token keyword">Case</span> y <span class="token operator">&lt;</span> <span class="token number">2</span>
        MsgBox <span class="token string">&quot;y is less than 2&quot;</span>
    <span class="token keyword">Case</span> x <span class="token operator">=</span> <span class="token number">1</span>
        MsgBox <span class="token string">&quot;x is equal to 1&quot;</span>
    <span class="token keyword">Case</span> x <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">Xor</span> y <span class="token operator">=</span> <span class="token number">3</span>
        MsgBox <span class="token string">&quot;Go read about &quot;&quot;Xor&quot;&quot;&quot;</span>
    <span class="token keyword">Case</span> <span class="token keyword">Not</span> y <span class="token operator">=</span> <span class="token number">5</span>
        MsgBox <span class="token string">&quot;y is not 5&quot;</span>
    <span class="token keyword">Case</span> x <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">Or</span> x <span class="token operator">=</span> <span class="token number">10</span>
        MsgBox <span class="token string">&quot;x = 3 or 10&quot;</span>
    <span class="token keyword">Case</span> y <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token keyword">And</span> x <span class="token operator">&lt;</span> <span class="token number">10</span>
        MsgBox <span class="token string">&quot;x and y are less than 10&quot;</span>
    <span class="token keyword">Case</span> <span class="token keyword">Else</span>
        MsgBox <span class="token string">&quot;No match found&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Select</span>

</code></pre></div><p>Case statements can also use arithmetic operators. Where an arithmetic operator is being used against the <code>Select Case</code> value it should be preceded with the <code>Is</code> keyword:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> x <span class="token keyword">As</span> <span class="token keyword">Integer</span>

x <span class="token operator">=</span> <span class="token number">5</span>

<span class="token keyword">Select</span> <span class="token keyword">Case</span> x
    <span class="token keyword">Case</span> <span class="token number">1</span>
        MsgBox <span class="token string">&quot;x equals 1&quot;</span>
    <span class="token keyword">Case</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span>
        MsgBox <span class="token string">&quot;x is 2, 3 or 4&quot;</span>
    <span class="token keyword">Case</span> <span class="token number">7</span> <span class="token keyword">To</span> <span class="token number">10</span>
        MsgBox <span class="token string">&quot;x is between 7 and 10 (inclusive)&quot;</span>
    <span class="token keyword">Case</span> <span class="token keyword">Is</span> <span class="token operator">&lt;</span> <span class="token number">2</span>
        MsgBox <span class="token string">&quot;x is less than one&quot;</span>
    <span class="token keyword">Case</span> <span class="token keyword">Is</span> <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">7</span>
        MsgBox <span class="token string">&quot;x is greater than or equal to 7&quot;</span>
    <span class="token keyword">Case</span> <span class="token keyword">Else</span>
        MsgBox <span class="token string">&quot;no match found&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Select</span>

</code></pre></div><h2 id="for-each-loop"><a href="#for-each-loop" class="header-anchor">#</a> For Each loop</h2> <p>The <code>For Each</code> loop construct is ideal for iterating all elements of a collection.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> IterateCollection<span class="token punctuation">(</span><span class="token keyword">ByVal</span> items <span class="token keyword">As</span> Collection<span class="token punctuation">)</span>

    <span class="token comment">'For Each iterator must always be variant</span>
    <span class="token keyword">Dim</span> element <span class="token keyword">As</span> <span class="token keyword">Variant</span>

    <span class="token keyword">For</span> <span class="token keyword">Each</span> element <span class="token keyword">In</span> items
        <span class="token comment">'assumes element can be converted to a string</span>
        Debug<span class="token punctuation">.</span>Print element
    <span class="token keyword">Next</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>Use <code>For Each</code> when iterating object collections:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> sheet <span class="token keyword">As</span> Worksheet
<span class="token keyword">For</span> <span class="token keyword">Each</span> sheet <span class="token keyword">In</span> ActiveWorkbook<span class="token punctuation">.</span>Worksheets
    Debug<span class="token punctuation">.</span>Print sheet<span class="token punctuation">.</span>Name
<span class="token keyword">Next</span>

</code></pre></div><p>Avoid <code>For Each</code> when iterating arrays; a <code>For</code> loop will offer significantly better performance with arrays. Conversely, a <code>For Each</code> loop will offer better performance when iterating a <code>Collection</code>.</p> <h3 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h3> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">For</span> <span class="token keyword">Each</span> [item] <span class="token keyword">In</span> [collection]
    [statements]
<span class="token keyword">Next</span> [item]

</code></pre></div><p>The <code>Next</code> keyword may optionally be followed by the iterator variable; this can help clarify nested loops, although there are better ways to clarify nested code, such as extracting the inner loop into its own procedure.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> book <span class="token keyword">As</span> Workbook
<span class="token keyword">For</span> <span class="token keyword">Each</span> book <span class="token keyword">In</span> Application<span class="token punctuation">.</span>Workbooks

    Debug<span class="token punctuation">.</span>Print book<span class="token punctuation">.</span>FullName

    <span class="token keyword">Dim</span> sheet <span class="token keyword">As</span> Worksheet
    <span class="token keyword">For</span> <span class="token keyword">Each</span> sheet <span class="token keyword">In</span> ActiveWorkbook<span class="token punctuation">.</span>Worksheets
        Debug<span class="token punctuation">.</span>Print sheet<span class="token punctuation">.</span>Name
    <span class="token keyword">Next</span> sheet
<span class="token keyword">Next</span> book

</code></pre></div><h2 id="do-loop"><a href="#do-loop" class="header-anchor">#</a> Do loop</h2> <div class="language- extra-class"><pre class="language-text"><code>
Public Sub DoLoop()
    Dim entry As String
    entry = &quot;&quot;
    'Equivalent to a While loop will ask for strings until &quot;Stop&quot; in given
    'Prefer using a While loop instead of this form of Do loop
    Do While entry &lt;&gt; &quot;Stop&quot;
        entry = InputBox(&quot;Enter a string, Stop to end&quot;)
        Debug.Print entry
    Loop

    'Equivalent to the above loop, but the condition is only checked AFTER the
    'first iteration of the loop, so it will execute even at least once even 
    'if entry is equal to &quot;Stop&quot; before entering the loop (like in this case)
    Do
        entry = InputBox(&quot;Enter a string, Stop to end&quot;)
        Debug.Print entry
    Loop While entry &lt;&gt; &quot;Stop&quot;

    
    'Equivalent to writing Do While Not entry=&quot;Stop&quot;
    '
    'Because the Until is at the top of the loop, it will
    'not execute because entry is still equal to &quot;Stop&quot;
    'when evaluating the condition
    Do Until entry = &quot;Stop&quot;
        entry = InputBox(&quot;Enter a string, Stop to end&quot;)
        Debug.Print entry
    Loop

    'Equivalent to writing Do ... Loop While Not i &gt;= 100
    Do
        entry = InputBox(&quot;Enter a string, Stop to end&quot;)
        Debug.Print entry
    Loop Until entry = &quot;Stop&quot;
End Sub

</code></pre></div><h2 id="while-loop"><a href="#while-loop" class="header-anchor">#</a> While loop</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token comment">'Will return whether an element is present in the array</span>
<span class="token keyword">Public</span> <span class="token keyword">Function</span> IsInArray<span class="token punctuation">(</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> whatToFind <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    i <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">While</span> i <span class="token operator">&lt;</span> UBound<span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token keyword">And</span> values<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> whatToFind
        i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">Wend</span>
    
    IsInArray <span class="token operator">=</span> values<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> whatToFind
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/flow-control-structures.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/sorting.html" class="prev">
        Sorting
      </a></span> <span class="next"><a href="/vba/passing-arguments-byref-or-byval.html">
        Passing Arguments ByRef or ByVal
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/3422.11b875e9.js" defer></script>
  </body>
</html>
