<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - Copying, returning and passing arrays</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Copying Arrays, Returning Arrays from Functions, Passing Arrays to Proceedures">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - Copying, returning and passing arrays">
    <meta property="og:description" content="Copying Arrays, Returning Arrays from Functions, Passing Arrays to Proceedures">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/copying-returning-and-passing-arrays.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - Copying, returning and passing arrays">
    <meta name="twitter:description" content="Copying Arrays, Returning Arrays from Functions, Passing Arrays to Proceedures">
    <meta name="twitter:url" content="/vba/copying-returning-and-passing-arrays.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3413.38f07995.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" aria-current="page" class="active sidebar-link">Copying, returning and passing arrays</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/copying-returning-and-passing-arrays.html#copying-arrays" class="sidebar-link">Copying Arrays</a></li><li class="sidebar-sub-header"><a href="/vba/copying-returning-and-passing-arrays.html#returning-arrays-from-functions" class="sidebar-link">Returning Arrays from Functions</a></li><li class="sidebar-sub-header"><a href="/vba/copying-returning-and-passing-arrays.html#passing-arrays-to-proceedures" class="sidebar-link">Passing Arrays to Proceedures</a></li></ul></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="copying-returning-and-passing-arrays"><a href="#copying-returning-and-passing-arrays" class="header-anchor">#</a> Copying, returning and passing arrays</h1> <h2 id="copying-arrays"><a href="#copying-arrays" class="header-anchor">#</a> Copying Arrays</h2> <p>You can copy a VBA array into an array of the same type using the <code>=</code> operator. The arrays must be of the same type otherwise the code will throw a &quot;Can't assign to array&quot; compilation error.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> source<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">to</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Dim</span> destinationLong<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Dim</span> destinationDouble<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Double</span>

destinationLong <span class="token operator">=</span> source     <span class="token comment">' copies contents of source into destinationLong</span>
destinationDouble <span class="token operator">=</span> source   <span class="token comment">' does not compile</span>

</code></pre></div><p>The source array can be fixed or dynamic, but the destination array must be dynamic. Trying to copy to a fixed array will throw a &quot;Can't assign to array&quot; compilation error. Any preexisting data in the receiving array is lost and its bounds and dimenions are changed to the same as the source array.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> source<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">ReDim</span> source<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">Dim</span> fixed<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Dim</span> dynamic<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>

fixed <span class="token operator">=</span> source   <span class="token comment">' does not compile</span>
dynamic <span class="token operator">=</span> source <span class="token comment">' does compile</span>

<span class="token keyword">Dim</span> dynamic2<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">ReDim</span> dynamic2<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">to</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token keyword">to</span> <span class="token number">99</span><span class="token punctuation">)</span> 

dynamic2 <span class="token operator">=</span> source <span class="token comment">' dynamic2 now has dimension (0 to 2)</span>

</code></pre></div><p>Once the copy is made the two arrays are seperate in memory, i.e. the two variables are not references to same underlying data, so changes made to one array do not appear in the other.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> source<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Dim</span> destination<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>

source<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3</span>
source<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
source<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span>

destination <span class="token operator">=</span> source
destination<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>

Debug<span class="token punctuation">.</span>Print source<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>; source<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>; source<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>                <span class="token comment">' outputs: 3 1 4</span>
Debug<span class="token punctuation">.</span>Print destination<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>; destination<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>; destination<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">' outputs: 2 1 4</span>

</code></pre></div><h3 id="copying-arrays-of-objects"><a href="#copying-arrays-of-objects" class="header-anchor">#</a> Copying Arrays of Objects</h3> <p>With arrays of objects the <strong>references</strong> to those objects are copied, not the objects themselves. If a change is made to an object in one array it will also appear to be changed in the other array - they are both referencing the same object. However, setting an element to a different object in one array won't set it to that object the other array.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> source<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Range
<span class="token keyword">Dim</span> destination<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Range

<span class="token keyword">Set</span> source<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span> source<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">Set</span> source<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;A2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span> source<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">Set</span> source<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;A3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span> source<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token number">4</span>

destination <span class="token operator">=</span> source

<span class="token keyword">Set</span> destination<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;A4&quot;</span><span class="token punctuation">)</span>   <span class="token comment">'reference changed in destination but not source</span>

destination<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token number">2</span>           <span class="token comment">'affects an object only in destination</span>
destination<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token number">5</span>           <span class="token comment">'affects an object in both source and destination</span>

Debug<span class="token punctuation">.</span>Print source<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>; source<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>; source<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>                  <span class="token comment">' outputs 3 5 4</span>
Debug<span class="token punctuation">.</span>Print destination<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>; destination<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>; destination<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment">' outputs 2 5 4</span>

</code></pre></div><h3 id="variants-containing-an-array"><a href="#variants-containing-an-array" class="header-anchor">#</a> Variants Containing an Array</h3> <p>You can also copy an array into and from a variant variable. When copying from a variant, it must contain an array of the same type as the receiving array otherwise it will throw a &quot;Type mismatch&quot; runtime error.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> var <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token keyword">Dim</span> source<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Range
<span class="token keyword">Dim</span> destination<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Range

var <span class="token operator">=</span> source
destination <span class="token operator">=</span> var

var <span class="token operator">=</span> <span class="token number">5</span>
destination <span class="token operator">=</span> var  <span class="token comment">' throws runtime error</span>

</code></pre></div><h2 id="returning-arrays-from-functions"><a href="#returning-arrays-from-functions" class="header-anchor">#</a> Returning Arrays from Functions</h2> <p>A function in a normal module (but not a Class module) can return an array by putting <code>()</code> after the data type.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Function</span> arrayOfPiDigits<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> outputArray<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    
    outputArray<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3</span>
    outputArray<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
    outputArray<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span>

    arrayOfPiDigits <span class="token operator">=</span> outputArray
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><p>The result of the function can then be put into a dynamic array of the same type or a variant. The elements can also be accessed directly by using a second set of brackets, however this will call the function each time, so its best to store the results in a new array if you plan to use them more than once</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> arrayExample<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> destination<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> var <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    
    destination <span class="token operator">=</span> arrayOfPiDigits<span class="token punctuation">(</span><span class="token punctuation">)</span>
    var <span class="token operator">=</span> arrayOfPiDigits
    
    Debug<span class="token punctuation">.</span>Print destination<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>          <span class="token comment">' outputs 3</span>
    Debug<span class="token punctuation">.</span>Print var<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                  <span class="token comment">' outputs 1</span>
    Debug<span class="token punctuation">.</span>Print arrayOfPiDigits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment">' outputs 4</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>Note that what is returned is actually a copy of the array inside the function, not a reference. So if the function returns the contents of a Static array its data can't be changed by the calling procedure.</p> <h3 id="outputting-an-array-via-an-output-argument"><a href="#outputting-an-array-via-an-output-argument" class="header-anchor">#</a> Outputting an Array via an output argument</h3> <p>It is normally good coding practice for a procedure's arguments to be inputs and to output via the return value. However, the limitations of VBA sometimes make it necessary for a procedure to output data via a <code>ByRef</code> argument.</p> <h3 id="outputting-to-a-fixed-array"><a href="#outputting-to-a-fixed-array" class="header-anchor">#</a> Outputting to a fixed array</h3> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> threePiDigits<span class="token punctuation">(</span><span class="token keyword">ByRef</span> destination<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    destination<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3</span>
    destination<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
    destination<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">Sub</span> printPiDigits<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> digits<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    
    threePiDigits digits
    Debug<span class="token punctuation">.</span>Print digits<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>; digits<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>; digits<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">' outputs 3 1 4</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h3 id="outputting-an-array-from-a-class-method"><a href="#outputting-an-array-from-a-class-method" class="header-anchor">#</a> Outputting an Array from a Class method</h3> <p>An output argument can also be used to output an array from a method/proceedure in a Class module</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token comment">' Class Module 'MathConstants'</span>
<span class="token keyword">Sub</span> threePiDigits<span class="token punctuation">(</span><span class="token keyword">ByRef</span> destination<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token keyword">ReDim</span> destination<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">2</span><span class="token punctuation">)</span>
    
    destination<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3</span>
    destination<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
    destination<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">' Standard Code Module</span>
<span class="token keyword">Sub</span> printPiDigits<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> digits<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> mathConsts <span class="token keyword">As</span> <span class="token keyword">New</span> MathConstants
    
    mathConsts<span class="token punctuation">.</span>threePiDigits digits
    Debug<span class="token punctuation">.</span>Print digits<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>; digits<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>; digits<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">' outputs 3 1 4</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="passing-arrays-to-proceedures"><a href="#passing-arrays-to-proceedures" class="header-anchor">#</a> Passing Arrays to Proceedures</h2> <p>Arrays can be passed to proceedures by putting <code>()</code> after the name of the array variable.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Function</span> countElements<span class="token punctuation">(</span><span class="token keyword">ByRef</span> arr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Double</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    countElements <span class="token operator">=</span> UBound<span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token operator">-</span> LBound<span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><p>Arrays <strong>must</strong> be passed by reference. If no passing mechanism is specified, e.g. <code>myFunction(arr())</code>, then VBA will assume <code>ByRef</code> by default, however it is good coding practice to make it explicit. Trying to pass an array by value, e.g. <code>myFunction(ByVal arr())</code> will result in an &quot;Array argument must be ByRef&quot; compilation error (or a &quot;Syntax error&quot; compilation error if <code>Auto Syntax Check</code> is not checked in the VBE options).</p> <p>Passing by reference means that any changes to the array will be preserved in the calling proceedure.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> testArrayPassing<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> source<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    source<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3</span>
    source<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
    
    Debug<span class="token punctuation">.</span>Print doubleAndSum<span class="token punctuation">(</span>source<span class="token punctuation">)</span>  <span class="token comment">' outputs 8</span>
    Debug<span class="token punctuation">.</span>Print source<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>; source<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">' outputs 6 2</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">Function</span> doubleAndSum<span class="token punctuation">(</span><span class="token keyword">ByRef</span> arr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    arr<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> arr<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>
    arr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> arr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>
    doubleAndSum <span class="token operator">=</span> arr<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> arr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><p>If you want to avoid changing the original array then be careful to write the function so that it doesn't change any elements.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Function</span> doubleAndSum<span class="token punctuation">(</span><span class="token keyword">ByRef</span> arr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    doubleAndSum <span class="token operator">=</span> arr<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> arr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><p>Alternatively create a working copy of the array and work with the copy.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Function</span> doubleAndSum<span class="token punctuation">(</span><span class="token keyword">ByRef</span> arr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> copyOfArr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    copyOfArr <span class="token operator">=</span> arr
    
    copyOfArr<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> copyOfArr<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>
    copyOfArr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> copyOfArr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>
    
    doubleAndSum <span class="token operator">=</span> copyOfArr<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> copyOfArr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/copying-returning-and-passing-arrays.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/arrays.html" class="prev">
        Arrays
      </a></span> <span class="next"><a href="/vba/collections.html">
        Collections
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3413.38f07995.js" defer></script>
  </body>
</html>
