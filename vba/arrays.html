<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - Arrays</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Multidimensional Arrays, Dynamic Arrays (Array Resizing and Dynamic Handling), Jagged Arrays (Arrays of Arrays), Declaring an Array in VBA, Use of Split to create an array from a string, Iterating elements of an array">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - Arrays">
    <meta property="og:description" content="Multidimensional Arrays, Dynamic Arrays (Array Resizing and Dynamic Handling), Jagged Arrays (Arrays of Arrays), Declaring an Array in VBA, Use of Split to create an array from a string, Iterating elements of an array">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/arrays.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - Arrays">
    <meta name="twitter:description" content="Multidimensional Arrays, Dynamic Arrays (Array Resizing and Dynamic Handling), Jagged Arrays (Arrays of Arrays), Declaring an Array in VBA, Use of Split to create an array from a string, Iterating elements of an array">
    <meta name="twitter:url" content="/vba/arrays.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3403.3c312fff.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" aria-current="page" class="active sidebar-link">Arrays</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/arrays.html#multidimensional-arrays" class="sidebar-link">Multidimensional Arrays</a></li><li class="sidebar-sub-header"><a href="/vba/arrays.html#dynamic-arrays-array-resizing-and-dynamic-handling" class="sidebar-link">Dynamic Arrays (Array Resizing and Dynamic Handling)</a></li><li class="sidebar-sub-header"><a href="/vba/arrays.html#jagged-arrays-arrays-of-arrays" class="sidebar-link">Jagged Arrays (Arrays of Arrays)</a></li><li class="sidebar-sub-header"><a href="/vba/arrays.html#declaring-an-array-in-vba" class="sidebar-link">Declaring an Array in VBA</a></li><li class="sidebar-sub-header"><a href="/vba/arrays.html#use-of-split-to-create-an-array-from-a-string" class="sidebar-link">Use of Split to create an array from a string</a></li><li class="sidebar-sub-header"><a href="/vba/arrays.html#iterating-elements-of-an-array" class="sidebar-link">Iterating elements of an array</a></li></ul></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="arrays"><a href="#arrays" class="header-anchor">#</a> Arrays</h1> <h2 id="multidimensional-arrays"><a href="#multidimensional-arrays" class="header-anchor">#</a> Multidimensional Arrays</h2> <h3 id="multidimensional-arrays-2"><a href="#multidimensional-arrays-2" class="header-anchor">#</a> Multidimensional Arrays</h3> <p>As the name indicates, multi dimensional arrays are arrays that contain more than one dimension, usually two or three but it can have up to 32 dimensions.</p> <p>A multi array works like a matrix with various levels, take in example a comparison between one, two, and three Dimensions.</p> <p>One Dimension is your typical array, it looks like a list of elements.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> <span class="token number">1D</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">Variant</span>

<span class="token operator">*</span><span class="token number">1D</span> <span class="token operator">-</span> Visually<span class="token operator">*</span>
<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

</code></pre></div><p>Two Dimensions would look like a Sudoku Grid or an Excel sheet, when initializing the array you would define how many rows and columns the array would have.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> <span class="token number">2D</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">Variant</span>
<span class="token comment">'this would result in a 3x3 grid </span>

<span class="token operator">*</span><span class="token number">2D</span> <span class="token operator">-</span> Visually<span class="token operator">*</span>
<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>

</code></pre></div><p>Three Dimensions would start to look like Rubik's Cube, when initializing the array you would define rows and columns and layers/depths the array would have.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> <span class="token number">3D</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">Variant</span>
<span class="token comment">'this would result in a 3x3x3 grid</span>

<span class="token operator">*</span><span class="token number">3D</span> <span class="token operator">-</span> Visually<span class="token operator">*</span>
       <span class="token number">1s</span>t layer                 <span class="token number">2</span>nd layer                  <span class="token number">3r</span>d layer
         front                     middle                     back
<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> ¦ <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> ¦ <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> ¦ <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> ¦ <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> ¦ <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> ¦ <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>

</code></pre></div><p>Further dimensions could be thought as the multiplication of the 3D, so a 4D(1,3,3,3) would be two side-by-side 3D arrays.</p> <h3 id="two-dimension-array"><a href="#two-dimension-array" class="header-anchor">#</a> Two-Dimension Array</h3> <p><strong>Creating</strong> <br> <br>
The example below will be a compilation of a list of employees, each employee will have a set of information on the list (First Name, Surname, Address, Email, Phone ...), the example will essentially be storing on the array (employee,information) being the (0,0) is the first employee's first name.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Bosses <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token comment">'set bosses as Variant, so we can input any data type we want</span>

Bosses <span class="token operator">=</span> [<span class="token punctuation">{</span><span class="token string">&quot;Jonh&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Snow&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;President&quot;</span>;<span class="token string">&quot;Ygritte&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Wild&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Vice-President&quot;</span><span class="token punctuation">}</span>]
<span class="token comment">'initialise a 2D array directly by filling it with information, the redult wil be a array(1,2) size 2x3 = 6 elements</span>

<span class="token keyword">Dim</span> Employees <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token comment">'initialize your Employees array as variant</span>
<span class="token comment">'initialize and ReDim the Employee array so it is a dynamic array instead of a static one, hence treated differently by the VBA Compiler</span>
<span class="token keyword">ReDim</span> Employees<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment">'declaring an 2D array that can store 100 employees with 6 elements of information each, but starts empty</span>
<span class="token comment">'the array size is 101 x 6 and contains 606 elements</span>

<span class="token keyword">For</span> employee <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">'for each employee/row in the array, UBound for 2D arrays, which will get the last element on the array</span>
<span class="token comment">'needs two parameters 1st the array you which to check and 2nd the dimension, in this case 1 = employee and 2 = information</span>
    <span class="token keyword">For</span> information_e <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token comment">'for each information element/column in the array</span>
        
        Employees<span class="token punctuation">(</span>employee<span class="token punctuation">,</span> information_e<span class="token punctuation">)</span> <span class="token operator">=</span> InformationNeeded <span class="token comment">' InformationNeeded would be the data to fill the array</span>
        <span class="token comment">'iterating the full array will allow for direct attribution of information into the element coordinates</span>
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

</code></pre></div><p><strong>Resizing</strong> <br> <br>
Resizing or <code>ReDim Preserve</code> a Multi-Array like the norm for a One-Dimension array would get an error, instead the information needs to be transferred into a Temporary array with the same size as the original plus the number of row/columns to add. In the example below we'll see how to initialize a Temp Array, transfer the information over from the original array, fill the remaining empty elements, and replace the temp array by the original array.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> TempEmp <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token comment">'initialise your temp array as variant</span>
<span class="token keyword">ReDim</span> TempEmp<span class="token punctuation">(</span>UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">'ReDim/Resize Temp array as a 2D array with size UBound(Employees)+1 = (last element in Employees 1st dimension) + 1,</span>
<span class="token comment">'the 2nd dimension remains the same as the original array. we effectively add 1 row in the Employee array</span>

<span class="token comment">'transfer</span>
<span class="token keyword">For</span> emp <span class="token operator">=</span> LBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> info <span class="token operator">=</span> LBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token comment">'to transfer Employees into TempEmp we iterate both arrays and fill TempEmp with the corresponding element value in Employees</span>
        TempEmp<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> info<span class="token punctuation">)</span> <span class="token operator">=</span> Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> info<span class="token punctuation">)</span>
    
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

<span class="token comment">'fill remaining</span>
<span class="token comment">'after the transfers the Temp array still has unused elements at the end, being that it was increased</span>
<span class="token comment">'to fill the remaining elements iterate from the last &quot;row&quot; with values to the last row in the array</span>
<span class="token comment">'in this case the last row in Temp will be the size of the Employees array rows + 1, as the last row of Employees array is already filled in the TempArray</span>

<span class="token keyword">For</span> emp <span class="token operator">=</span> UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>TempEmp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> info <span class="token operator">=</span> LBound<span class="token punctuation">(</span>TempEmp<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>TempEmp<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        
        TempEmp<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> info<span class="token punctuation">)</span> <span class="token operator">=</span> InformationNeeded <span class="token operator">&amp;</span> <span class="token string">&quot;NewRow&quot;</span>
    
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

<span class="token comment">'erase Employees, attribute Temp array to Employees and erase Temp array</span>
<span class="token keyword">Erase</span> Employees
Employees <span class="token operator">=</span> TempEmp
<span class="token keyword">Erase</span> TempEmp

</code></pre></div><p><strong>Changing Element Values</strong> <br> <br>
To change/alter the values in a certain element can be done by simply calling the coordinate to change and giving it a new value:
<code>Employees(0, 0) = &quot;NewValue&quot;</code></p> <p>Alternatively iterate through the coordinates use conditions to match values corresponding to the parameters needed:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">For</span> emp <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">)</span>
    <span class="token keyword">If</span> Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;Gloria&quot;</span> <span class="token keyword">And</span> Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;Stephan&quot;</span> <span class="token keyword">Then</span>
    <span class="token comment">'if value found</span>
        Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;Married, Last Name Change&quot;</span>
        <span class="token keyword">Exit</span> <span class="token keyword">For</span>
        <span class="token comment">'don't iterate through a full array unless necessary</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">Next</span>

</code></pre></div><p><strong>Reading</strong> <br> <br></p> <p>Accessing the elements in the array can be done with a Nested Loop (iterating every element), Loop and Coordinate (iterate Rows and accessing columns directly), or accessing directly with both coordinates.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token comment">'nested loop, will iterate through all elements</span>
<span class="token keyword">For</span> emp <span class="token operator">=</span> LBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> info <span class="token operator">=</span> LBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        Debug<span class="token punctuation">.</span>Print Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> info<span class="token punctuation">)</span>
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

<span class="token comment">'loop and coordinate, iteration through all rows and in each row accessing all columns directly</span>
<span class="token keyword">For</span> emp <span class="token operator">=</span> LBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Employees<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print Employees<span class="token punctuation">(</span>emp<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">Next</span>

<span class="token comment">'directly accessing element with coordinates</span>
Debug<span class="token punctuation">.</span>Print Employees<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

</code></pre></div><p><strong><strong>Remember</strong>, it's always handy to keep an array map when using Multidimensional arrays, they can easily become confusion.</strong></p> <h3 id="three-dimension-array"><a href="#three-dimension-array" class="header-anchor">#</a> Three-Dimension Array</h3> <p>For the 3D array, we'll use the same premise as the 2D array, with the addition of not only storing the Employee and Information but as well Building they work in.</p> <p>The 3D array will have the Employees (can be thought of as Rows), the Information (Columns), and Building that can be thought of as different sheets on an excel document, they have the same size between them, but every sheets has a different set of information in its cells/elements. The 3D array will contain <strong><strong>n</strong></strong> number of 2D arrays.</p> <p><strong>Creating</strong> <br> <br>
A 3D array needs 3 coordinates to be initialized <code>Dim 3Darray(2,5,5) As Variant</code> the first coordinate on the array will be the number of Building/Sheets (different sets of rows and columns), second coordinate will define Rows and third Columns. The <code>Dim</code> above will result in a 3D array with 108 elements (<code>3*6*6</code>), effectively having 3 different sets of 2D arrays.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> ThreeDArray <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token comment">'initialise your ThreeDArray array as variant</span>
<span class="token keyword">ReDim</span> ThreeDArray<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment">'declaring an 3D array that can store two sets of 51 employees with 6 elements of information each, but starts empty</span>
<span class="token comment">'the array size is 2 x 51 x 6 and contains 612 elements</span>

<span class="token keyword">For</span> building <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">'for each building/set in the array</span>
    <span class="token keyword">For</span> employee <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token comment">'for each employee/row in the array</span>
        <span class="token keyword">For</span> information_e <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token comment">'for each information element/column in the array</span>
            
            ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> employee<span class="token punctuation">,</span> information_e<span class="token punctuation">)</span> <span class="token operator">=</span> InformationNeeded <span class="token comment">' InformationNeeded would be the data to fill the array</span>
        <span class="token comment">'iterating the full array will allow for direct attribution of information into the element coordinates</span>
        <span class="token keyword">Next</span>
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

</code></pre></div><p><strong>Resizing</strong> <br> <br></p> <p>Resizing a 3D array is similar to resizing a 2D, first create a Temporary array with the same size of the original adding one in the coordinate of the parameter to increase, the first coordinate will increase the number of sets in the array, the second and third coordinates will increase the number of Rows or Columns in each set.</p> <p>The example below increases the number of Rows in each set by one, and fills those recently added elements with new information.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> TempEmp <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token comment">'initialise your temp array as variant</span>
<span class="token keyword">ReDim</span> TempEmp<span class="token punctuation">(</span>UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">'ReDim/Resize Temp array as a 3D array with size UBound(ThreeDArray)+1 = (last element in Employees 2nd dimension) + 1,</span>
<span class="token comment">'the other dimension remains the same as the original array. we effectively add 1 row in the for each set of the 3D array</span>

<span class="token comment">'transfer</span>
<span class="token keyword">For</span> building <span class="token operator">=</span> LBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> emp <span class="token operator">=</span> LBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token keyword">For</span> info <span class="token operator">=</span> LBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token comment">'to transfer ThreeDArray into TempEmp by iterating all sets in the 3D array and fill TempEmp with the corresponding element value in each set of each row</span>
            TempEmp<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> info<span class="token punctuation">)</span> <span class="token operator">=</span> ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> info<span class="token punctuation">)</span>
        
        <span class="token keyword">Next</span>
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

<span class="token comment">'fill remaining</span>
<span class="token comment">'to fill the remaining elements we need to iterate from the last &quot;row&quot; with values to the last row in the array in each set, remember that the first empty element is the original array Ubound() plus 1</span>
<span class="token keyword">For</span> building <span class="token operator">=</span> LBound<span class="token punctuation">(</span>TempEmp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>TempEmp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> emp <span class="token operator">=</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>TempEmp<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token keyword">For</span> info <span class="token operator">=</span> LBound<span class="token punctuation">(</span>TempEmp<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>TempEmp<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
            
            TempEmp<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> info<span class="token punctuation">)</span> <span class="token operator">=</span> InformationNeeded <span class="token operator">&amp;</span> <span class="token string">&quot;NewRow&quot;</span>
        
        <span class="token keyword">Next</span>
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

<span class="token comment">'erase Employees, attribute Temp array to Employees and erase Temp array</span>
<span class="token keyword">Erase</span> ThreeDArray
ThreeDArray <span class="token operator">=</span> TempEmp
<span class="token keyword">Erase</span> TempEmp

</code></pre></div><p><strong>Changing Element Values and Reading</strong> <br> <br>
Reading and changing the elements on the 3D array can be done similarly to the way we do the 2D array, just adjust for the extra level in the loops and coordinates.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Do</span>
<span class="token comment">' using Do ... While for early exit</span>
    <span class="token keyword">For</span> building <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">For</span> emp <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token keyword">If</span> ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;Gloria&quot;</span> <span class="token keyword">And</span> ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;Stephan&quot;</span> <span class="token keyword">Then</span>
            <span class="token comment">'if value found</span>
                ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;Married, Last Name Change&quot;</span>
                <span class="token keyword">Exit</span> <span class="token keyword">Do</span>
                <span class="token comment">'don't iterate through all the array unless necessary</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">Next</span>
    <span class="token keyword">Next</span>
<span class="token keyword">Loop</span> <span class="token keyword">While</span> <span class="token boolean">False</span>

<span class="token comment">'nested loop, will iterate through all elements</span>
<span class="token keyword">For</span> building <span class="token operator">=</span> LBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> emp <span class="token operator">=</span> LBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token keyword">For</span> info <span class="token operator">=</span> LBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
            Debug<span class="token punctuation">.</span>Print ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> info<span class="token punctuation">)</span>
        <span class="token keyword">Next</span>
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

<span class="token comment">'loop and coordinate, will iterate through all set of rows and ask for the row plus the value we choose for the columns</span>
<span class="token keyword">For</span> building <span class="token operator">=</span> LBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> emp <span class="token operator">=</span> LBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>ThreeDArray<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        Debug<span class="token punctuation">.</span>Print ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        Debug<span class="token punctuation">.</span>Print ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        Debug<span class="token punctuation">.</span>Print ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        Debug<span class="token punctuation">.</span>Print ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        Debug<span class="token punctuation">.</span>Print ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
        Debug<span class="token punctuation">.</span>Print ThreeDArray<span class="token punctuation">(</span>building<span class="token punctuation">,</span> emp<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

<span class="token comment">'directly accessing element with coordinates</span>
Debug<span class="token punctuation">.</span>Print Employees<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="dynamic-arrays-array-resizing-and-dynamic-handling"><a href="#dynamic-arrays-array-resizing-and-dynamic-handling" class="header-anchor">#</a> Dynamic Arrays (Array Resizing and Dynamic Handling)</h2> <h3 id="dynamic-arrays"><a href="#dynamic-arrays" class="header-anchor">#</a> Dynamic Arrays</h3> <p>Adding and reducing variables on an array dynamically is a huge advantage for when the information you are treating does not have a set number of variables.</p> <h3 id="adding-values-dynamically"><a href="#adding-values-dynamically" class="header-anchor">#</a> Adding Values Dynamically</h3> <p>You can simply resize the Array with the <code>ReDim</code> Statement, this will resize the array but to if you which to retain the information already stored in the array you'll need the part <code>Preserve</code>.</p> <p>In the example below we create an array and increase it by one more variable in each iteration while preserving the values already in the array.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Dynamic_array <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token comment">' first we set Dynamic_array as variant</span>

<span class="token keyword">For</span> n <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">100</span>

    <span class="token keyword">If</span> IsEmpty<span class="token punctuation">(</span>Dynamic_array<span class="token punctuation">)</span> <span class="token keyword">Then</span>
        <span class="token comment">'isempty() will check if we need to add the first value to the array or subsequent ones</span>
    
        <span class="token keyword">ReDim</span> Dynamic_array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token comment">'ReDim Dynamic_array(0) will resize the array to one variable only</span>
        Dynamic_array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> n

    <span class="token keyword">Else</span>
        <span class="token keyword">ReDim</span> Preserve Dynamic_array<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Dynamic_array<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token comment">'in the line above we resize the array from variable 0 to the UBound() = last variable, plus one effectivelly increeasing the size of the array by one</span>
        Dynamic_array<span class="token punctuation">(</span>UBound<span class="token punctuation">(</span>Dynamic_array<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> n
        <span class="token comment">'attribute a value to the last variable of Dynamic_array</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>

<span class="token keyword">Next</span>

</code></pre></div><h3 id="removing-values-dynamically"><a href="#removing-values-dynamically" class="header-anchor">#</a> Removing Values Dynamically</h3> <p>We can utilise the same logic to to decrease the the array. In the example the value &quot;last&quot; will be removed from the array.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Dynamic_array <span class="token keyword">As</span> <span class="token keyword">Variant</span>
Dynamic_array <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;first&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;middle&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;last&quot;</span><span class="token punctuation">)</span>
    
<span class="token keyword">ReDim</span> Preserve Dynamic_array<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Dynamic_array<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">' Resize Preserve while dropping the last value</span>

</code></pre></div><h3 id="resetting-an-array-and-reusing-dynamically"><a href="#resetting-an-array-and-reusing-dynamically" class="header-anchor">#</a> Resetting an Array and Reusing Dynamically</h3> <p>We can as well re-utilise the arrays we create as not to have many on memory, which would make the run time slower. This is useful for arrays of various sizes.
One snippet you could use to re-utilise the array is to <code>ReDim</code> the array back to <code>(0)</code>, attribute one variable to to the array and freely increase the array again.</p> <p>In the snippet below I construct an array with the values 1 to 40, empty the array, and refill the array with values 40 to 100, all this done dynamically.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Dynamic_array <span class="token keyword">As</span> <span class="token keyword">Variant</span>

<span class="token keyword">For</span> n <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">100</span>

    <span class="token keyword">If</span> IsEmpty<span class="token punctuation">(</span>Dynamic_array<span class="token punctuation">)</span> <span class="token keyword">Then</span>
        <span class="token keyword">ReDim</span> Dynamic_array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        Dynamic_array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> n
    
    <span class="token keyword">ElseIf</span> Dynamic_array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span>
        <span class="token comment">'if first variant is empty ( = &quot;&quot;) then give it the value of n</span>
        Dynamic_array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> n
    <span class="token keyword">Else</span>
        <span class="token keyword">ReDim</span> Preserve Dynamic_array<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Dynamic_array<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        Dynamic_array<span class="token punctuation">(</span>UBound<span class="token punctuation">(</span>Dynamic_array<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> n
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">If</span> n <span class="token operator">=</span> <span class="token number">40</span> <span class="token keyword">Then</span>
        <span class="token keyword">ReDim</span> Dynamic_array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token comment">'Resizing the array back to one variable without Preserving,</span>
        <span class="token comment">'leaving the first value of the array empty</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>

<span class="token keyword">Next</span>

</code></pre></div><h2 id="jagged-arrays-arrays-of-arrays"><a href="#jagged-arrays-arrays-of-arrays" class="header-anchor">#</a> Jagged Arrays (Arrays of Arrays)</h2> <h3 id="jagged-arrays-not-multidimensional-arrays"><a href="#jagged-arrays-not-multidimensional-arrays" class="header-anchor">#</a> Jagged Arrays NOT Multidimensional Arrays</h3> <p>Arrays of Arrays(Jagged Arrays) are not the same as Multidimensional Arrays if you think about them visually Multidimensional Arrays would look like Matrices (Rectangular) with defined number of elements on their dimensions(inside arrays), while Jagged array would be like a yearly calendar with the inside arrays having different number of elements, like days in on different months.</p> <p>Although Jagged Arrays are quite messy and tricky to use due to their nested levels and don't have much type safety, but they are very flexible, allow you to manipulate different types of data quite easily, and don't need to contain unused or empty elements.</p> <h3 id="creating-a-jagged-array"><a href="#creating-a-jagged-array" class="header-anchor">#</a> Creating a Jagged Array</h3> <p>In the below example we will initialise a jagged array containing two arrays one for Names and another for Numbers, and then accessing one element of each</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> OuterArray<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token keyword">Dim</span> Names<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token keyword">Dim</span> Numbers<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token comment">'arrays are declared variant so we can access attribute any data type to its elements</span>

Names <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;Person1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Person2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Person3&quot;</span><span class="token punctuation">)</span>
Numbers <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;001&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;002&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;003&quot;</span><span class="token punctuation">)</span>

OuterArray <span class="token operator">=</span> Array<span class="token punctuation">(</span>Names<span class="token punctuation">,</span> Numbers<span class="token punctuation">)</span>
<span class="token comment">'Directly giving OuterArray an array containing both Names and Numbers arrays inside</span>

Debug<span class="token punctuation">.</span>Print OuterArray<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
Debug<span class="token punctuation">.</span>Print OuterArray<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">'accessing elements inside the jagged by giving the coordenades of the element</span>

</code></pre></div><h3 id="dynamically-creating-and-reading-jagged-arrays"><a href="#dynamically-creating-and-reading-jagged-arrays" class="header-anchor">#</a> Dynamically Creating and Reading Jagged Arrays</h3> <p>We can as well be more dynamic in our approx to construct the arrays, imagine that we have a customer data sheet in excel and we want to construct an array to output the customer details.</p> <div class="language- extra-class"><pre class="language-text"><code>
  Name -   Phone   -  Email  - Customer Number 
Person1 - 153486231 - 1@STACK - 001
Person2 - 153486242 - 2@STACK - 002
Person3 - 153486253 - 3@STACK - 003
Person4 - 153486264 - 4@STACK - 004
Person5 - 153486275 - 5@STACK - 005

</code></pre></div><p>We will Dynamically construct an Header array and a Customers array, the Header will contain the column titles and the Customers array will contain the information of each customer/row as arrays.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Headers <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token comment">' headers array with the top section of the customer data sheet</span>
    <span class="token keyword">For</span> c <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">4</span>
        <span class="token keyword">If</span> IsEmpty<span class="token punctuation">(</span>Headers<span class="token punctuation">)</span> <span class="token keyword">Then</span>
            <span class="token keyword">ReDim</span> Headers<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            Headers<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
        <span class="token keyword">Else</span>
            <span class="token keyword">ReDim</span> Preserve Headers<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Headers<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
            Headers<span class="token punctuation">(</span>UBound<span class="token punctuation">(</span>Headers<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span>
    
<span class="token keyword">Dim</span> Customers <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token comment">'Customers array will contain arrays of customer values</span>
<span class="token keyword">Dim</span> Customer_Values <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token comment">'Customer_Values will be an array of the customer in its elements (Name-Phone-Email-CustNum)</span>
    
    <span class="token keyword">For</span> r <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> <span class="token number">6</span>
    <span class="token comment">'iterate through the customers/rows</span>
        <span class="token keyword">For</span> c <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">4</span>
        <span class="token comment">'iterate through the values/columns</span>
            
            <span class="token comment">'build array containing customer values</span>
            <span class="token keyword">If</span> IsEmpty<span class="token punctuation">(</span>Customer_Values<span class="token punctuation">)</span> <span class="token keyword">Then</span>
                <span class="token keyword">ReDim</span> Customer_Values<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                Customer_Values<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
            <span class="token keyword">ElseIf</span> Customer_Values<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span>
                Customer_Values<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
            <span class="token keyword">Else</span>
                <span class="token keyword">ReDim</span> Preserve Customer_Values<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Customer_Values<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
                Customer_Values<span class="token punctuation">(</span>UBound<span class="token punctuation">(</span>Customer_Values<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">Next</span>
        
        <span class="token comment">'add customer_values array to Customers Array</span>
        <span class="token keyword">If</span> IsEmpty<span class="token punctuation">(</span>Customers<span class="token punctuation">)</span> <span class="token keyword">Then</span>
            <span class="token keyword">ReDim</span> Customers<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            Customers<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> Customer_Values
        <span class="token keyword">Else</span>
            <span class="token keyword">ReDim</span> Preserve Customers<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Customers<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
            Customers<span class="token punctuation">(</span>UBound<span class="token punctuation">(</span>Customers<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> Customer_Values
        <span class="token keyword">End</span> <span class="token keyword">If</span>
        
        <span class="token comment">'reset Custumer_Values to rebuild a new array if needed</span>
        <span class="token keyword">ReDim</span> Customer_Values<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">Next</span>

    <span class="token keyword">Dim</span> Main_Array<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token comment">'main array will contain both the Headers and Customers</span>
    
    Main_Array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> Headers
    Main_Array<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> Customers

</code></pre></div><p><strong><code>To better understand the way to Dynamically construct a one dimensional array please check Dynamic Arrays (Array Resizing and Dynamic Handling) on the Arrays documentation.</code></strong></p> <p>The Result of the above snippet is an Jagged Array with two arrays one of those arrays with 4 elements, 2 indention levels, and the other being itself another Jagged Array containing 5 arrays of 4 elements each and 3 indention levels, see below the structure:</p> <div class="language-vb extra-class"><pre class="language-vb"><code>Main_Array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> Headers <span class="token operator">-</span> Array<span class="token punctuation">(</span><span class="token string">&quot;Name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Phone&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Email&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Customer Number&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> Customers<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> Array<span class="token punctuation">(</span><span class="token string">&quot;Person1&quot;</span><span class="token punctuation">,</span><span class="token number">153486231</span><span class="token punctuation">,</span><span class="token string">&quot;1@STACK&quot;</span><span class="token punctuation">,</span><span class="token number">001</span><span class="token punctuation">)</span>
                Customers<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> Array<span class="token punctuation">(</span><span class="token string">&quot;Person2&quot;</span><span class="token punctuation">,</span><span class="token number">153486242</span><span class="token punctuation">,</span><span class="token string">&quot;2@STACK&quot;</span><span class="token punctuation">,</span><span class="token number">002</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
                Customers<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span> Array<span class="token punctuation">(</span><span class="token string">&quot;Person5&quot;</span><span class="token punctuation">,</span><span class="token number">153486275</span><span class="token punctuation">,</span><span class="token string">&quot;5@STACK&quot;</span><span class="token punctuation">,</span><span class="token number">005</span><span class="token punctuation">)</span>

</code></pre></div><p>To access the information you'll have to bear in mind the structure of the Jagged Array you create, in the above example you can see that the <code>Main Array</code> contains an Array of <code>Headers</code> and an Array of Arrays (<code>Customers</code>) hence with different ways of accessing the elements.</p> <p>Now we'll read the information of the <code>Main Array</code> and print out each of the Customers information as <code>Info Type: Info</code>.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">For</span> n <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Main_Array<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">'n to iterate from fisrt to last array in Main_Array(1)</span>
    
    <span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>Main_Array<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">'j will iterate from first to last element in each array of Main_Array(1)</span>
        
        Debug<span class="token punctuation">.</span>Print Main_Array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">&amp;</span> Main_Array<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
        <span class="token comment">'print Main_Array(0)(j) which is the header and Main_Array(0)(n)(j) which is the element in the customer array</span>
        <span class="token comment">'we can call the header with j as the header array has the same structure as the customer array</span>
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

</code></pre></div><p>REMEMBER to keep track of the structure of your Jagged Array, in the example above to access the Name of a customer is by accessing <code>Main_Array -&gt; Customers -&gt; CustomerNumber -&gt; Name</code> which is three levels, to return <code>&quot;Person4&quot;</code> you'll need the location of Customers in the Main_Array, then the Location of customer four on the Customers Jagged array and lastly the location of the element you need, in this case <code>Main_Array(1)(3)(0)</code> which is <code>Main_Array(Customers)(CustomerNumber)(Name)</code>.</p> <h2 id="declaring-an-array-in-vba"><a href="#declaring-an-array-in-vba" class="header-anchor">#</a> Declaring an Array in VBA</h2> <p>Declaring an array is very similar to declaring a variable, except you need to declare the dimension of the Array right after its name:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> myArray<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token comment">'Declaring an array that will contain up to 10 strings</span>

</code></pre></div><p>By default, Arrays in VBA are <strong>indexed from ZERO</strong>, thus, the number inside the parenthesis doesn't refer to the size of the array, but rather to <strong>the index of the last element</strong></p> <h3 id="accessing-elements"><a href="#accessing-elements" class="header-anchor">#</a> Accessing Elements</h3> <p>Accessing an element of the Array is done by using the name of the Array, followed by the index of the element, inside parenthesis:</p> <div class="language-vb extra-class"><pre class="language-vb"><code>myArray<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;first element&quot;</span>
myArray<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;sixth element&quot;</span>
myArray<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;last element&quot;</span>

</code></pre></div><h3 id="array-indexing"><a href="#array-indexing" class="header-anchor">#</a> Array Indexing</h3> <p>You can change Arrays indexing by placing this line at the top of a module:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Base <span class="token number">1</span>

</code></pre></div><p>With this line, all Arrays declared in the module will be <strong>indexed from ONE</strong>.</p> <h3 id="specific-index"><a href="#specific-index" class="header-anchor">#</a> Specific Index</h3> <p>You can also declare each Array with its own index by using the <code>To</code> keyword, and the lower and upper bound (= index):</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> mySecondArray<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token comment">'Array of 12 strings indexed from 1 to 12</span>
<span class="token keyword">Dim</span> myThirdArray<span class="token punctuation">(</span><span class="token number">13</span> <span class="token keyword">To</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token comment">'Array of 12 strings indexed from 13 to 24</span>

</code></pre></div><h3 id="dynamic-declaration"><a href="#dynamic-declaration" class="header-anchor">#</a> Dynamic Declaration</h3> <p>When you do not know the size of your Array prior to its declaration, you can use the dynamic declaration, and the <code>ReDim</code> keyword:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> myDynamicArray<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Strings <span class="token comment">'Creates an Array of an unknown number of strings</span>
<span class="token keyword">ReDim</span> myDynamicArray<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">'This resets the array to 6 elements</span>

</code></pre></div><p>Note that using the <code>ReDim</code> keyword will wipe out any previous content of your Array. To prevent this, you can use the <code>Preserve</code> keyword after <code>ReDim</code>:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> myDynamicArray<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
myDynamicArray<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;Something I want to keep&quot;</span>

<span class="token keyword">ReDim</span> Preserve myDynamicArray<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment">'Expand the size to up to 9 strings</span>
Debug<span class="token punctuation">.</span>Print myDynamicArray<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">' still prints the element</span>

</code></pre></div><h2 id="use-of-split-to-create-an-array-from-a-string"><a href="#use-of-split-to-create-an-array-from-a-string" class="header-anchor">#</a> Use of Split to create an array from a string</h2> <p><strong>Split Function</strong></p> <p>returns a zero-based, one dimensional array containing a specified number of substrings.</p> <p><strong>Syntax</strong></p> <p><strong>Split(expression</strong> [, <strong>delimiter</strong> [, <strong>limit</strong> [, <strong>compare</strong>]]]<strong>)</strong></p> <table><thead><tr><th>Part</th> <th>Description</th></tr></thead> <tbody><tr><td><strong><strong>expression</strong></strong></td> <td>Required. String expression containing substrings and delimiters. If <strong>expression</strong> is a zero-length string(&quot;&quot; or vbNullString), <strong>Split</strong> returns an empty array containing no elements and no data. In this case, the returned array will have a LBound of 0 and a UBound of -1.</td></tr> <tr><td><strong><strong>delimiter</strong></strong></td> <td>Optional. String character used to identify substring limits. If omitted, the space character (&quot; &quot;) is assumed to be the delimiter. If <strong><strong>delimiter</strong></strong> is a zero-length string, a single-element array containing the entire <strong><strong>expression</strong></strong> string is returned.</td></tr> <tr><td><strong><strong>limit</strong></strong></td> <td>Optional. Number of substrings to be returned; -1 indicates that all substrings are returned.</td></tr> <tr><td><strong><strong>compare</strong></strong></td> <td>Optional. Numeric value indicating the kind of comparison to use when evaluating substrings. See Settings section for values.</td></tr></tbody></table> <p><strong>Settings</strong></p> <p>The <strong><strong>compare</strong></strong> argument can have the following values:</p> <table><thead><tr><th><strong>Constant</strong></th> <th><strong>Value</strong></th> <th><strong>Description</strong></th></tr></thead> <tbody><tr><td>Description</td> <td>-1</td> <td>Performs a comparison using the setting of the <strong>Option Compare</strong> statement.</td></tr> <tr><td>vbBinaryCompare</td> <td>0</td> <td>Performs a binary comparison.</td></tr> <tr><td>vbTextCompare</td> <td>1</td> <td>Performs a textual comparison.</td></tr> <tr><td>vbDatabaseCompare</td> <td>2</td> <td>Microsoft Access only. Performs a comparison based on information in your database.</td></tr></tbody></table> <p><strong>Example</strong></p> <p>In this example it is demonstrated how Split works by showing several styles. The comments will show the result set for each of the different performed Split options. Finally it is demonstrated how to loop over the returned string array.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> Test
    
    <span class="token keyword">Dim</span> textArray<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">String</span>

    textArray <span class="token operator">=</span> Split<span class="token punctuation">(</span><span class="token string">&quot;Tech on the Net&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">'Result: {&quot;Tech&quot;, &quot;on&quot;, &quot;the&quot;, &quot;Net&quot;}</span>

    textArray <span class="token operator">=</span> Split<span class="token punctuation">(</span><span class="token string">&quot;172.23.56.4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">'Result: {&quot;172&quot;, &quot;23&quot;, &quot;56&quot;, &quot;4&quot;}</span>

    textArray <span class="token operator">=</span> Split<span class="token punctuation">(</span><span class="token string">&quot;A;B;C;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">'Result: {&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;}</span>

    textArray <span class="token operator">=</span> Split<span class="token punctuation">(</span><span class="token string">&quot;A;B;C;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;;&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">'Result: {&quot;A;B;C;D&quot;}</span>

    textArray <span class="token operator">=</span> Split<span class="token punctuation">(</span><span class="token string">&quot;A;B;C;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;;&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token comment">'Result: {&quot;A&quot;, &quot;B;C;D&quot;}</span>

    textArray <span class="token operator">=</span> Split<span class="token punctuation">(</span><span class="token string">&quot;A;B;C;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;;&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token comment">'Result: {&quot;A&quot;, &quot;B&quot;, &quot;C;D&quot;}</span>

    textArray <span class="token operator">=</span> Split<span class="token punctuation">(</span><span class="token string">&quot;A;B;C;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;;&quot;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token comment">'Result: {&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;}</span>

    <span class="token comment">'You can iterate over the created array</span>
    <span class="token keyword">Dim</span> counter <span class="token keyword">As</span> <span class="token keyword">Long</span>

    <span class="token keyword">For</span> counter <span class="token operator">=</span> LBound<span class="token punctuation">(</span>textArray<span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>textArray<span class="token punctuation">)</span>
        Debug<span class="token punctuation">.</span>Print textArray<span class="token punctuation">(</span>counter<span class="token punctuation">)</span>
    <span class="token keyword">Next</span>
 <span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="iterating-elements-of-an-array"><a href="#iterating-elements-of-an-array" class="header-anchor">#</a> Iterating elements of an array</h2> <h3 id="for-next"><a href="#for-next" class="header-anchor">#</a> For...Next</h3> <p>Using the iterator variable as the index number is the fastest way to iterate the elements of an array:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> items <span class="token keyword">As</span> <span class="token keyword">Variant</span>
items <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token keyword">Dim</span> index <span class="token keyword">As</span> <span class="token keyword">Integer</span>
<span class="token keyword">For</span> index <span class="token operator">=</span> LBound<span class="token punctuation">(</span>items<span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>items<span class="token punctuation">)</span>
    <span class="token comment">'assumes value can be implicitly converted to a String:</span>
    Debug<span class="token punctuation">.</span>Print items<span class="token punctuation">(</span>index<span class="token punctuation">)</span> 
<span class="token keyword">Next</span>

</code></pre></div><p>Nested loops can be used to iterate multi-dimensional arrays:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> items<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Integer</span>
items<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
items<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
items<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>
items<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3</span>

<span class="token keyword">Dim</span> outer <span class="token keyword">As</span> <span class="token keyword">Integer</span>
<span class="token keyword">Dim</span> inner <span class="token keyword">As</span> <span class="token keyword">Integer</span>
<span class="token keyword">For</span> outer <span class="token operator">=</span> LBound<span class="token punctuation">(</span>items<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>items<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> inner <span class="token operator">=</span> LBound<span class="token punctuation">(</span>items<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>items<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token comment">'assumes value can be implicitly converted to a String:</span>
        Debug<span class="token punctuation">.</span>Print items<span class="token punctuation">(</span>outer<span class="token punctuation">,</span> inner<span class="token punctuation">)</span>
    <span class="token keyword">Next</span>
<span class="token keyword">Next</span>

</code></pre></div><h3 id="for-each-next"><a href="#for-each-next" class="header-anchor">#</a> For Each...Next</h3> <p>A <code>For Each...Next</code> loop can also be used to iterate arrays, if performance doesn't matter:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> items <span class="token keyword">As</span> <span class="token keyword">Variant</span>
items <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token keyword">Dim</span> item <span class="token keyword">As</span> <span class="token keyword">Variant</span> <span class="token comment">'must be variant</span>
<span class="token keyword">For</span> <span class="token keyword">Each</span> item <span class="token keyword">In</span> items
    <span class="token comment">'assumes value can be implicitly converted to a String:</span>
    Debug<span class="token punctuation">.</span>Print item
<span class="token keyword">Next</span>

</code></pre></div><p>A <code>For Each</code> loop will iterate all dimensions from outer to inner (the same order as the elements are laid out in memory), so there is no need for nested loops:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> items<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Integer</span>
items<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
items<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
items<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>
items<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3</span>

<span class="token keyword">Dim</span> item <span class="token keyword">As</span> <span class="token keyword">Variant</span> <span class="token comment">'must be Variant</span>
<span class="token keyword">For</span> <span class="token keyword">Each</span> item <span class="token keyword">In</span> items
    <span class="token comment">'assumes value can be implicitly converted to a String:</span>
    Debug<span class="token punctuation">.</span>Print item
<span class="token keyword">Next</span>

</code></pre></div><p>Note that <code>For Each</code> loops are best used to iterate <code>Collection</code> objects, if performance matters.</p> <p>All 4 snippets above produce the same output:</p> <div class="language- extra-class"><pre class="language-text"><code>
0
 1
 2
 3

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/arrays.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/data-structures.html" class="prev">
        Data Structures
      </a></span> <span class="next"><a href="/vba/copying-returning-and-passing-arrays.html">
        Copying, returning and passing arrays
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3403.3c312fff.js" defer></script>
  </body>
</html>
