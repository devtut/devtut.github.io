<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - Scripting.FileSystemObject</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Retrieve only the path from a file path, Retrieve just the extension from a file name, Recursively enumerate folders and files, Strip file extension from a file name, Creating a FileSystemObject, Reading a text file using a FileSystemObject, Creating a text file with FileSystemObject, Enumerate files in a directory using FileSystemObject, Writing to an existing file with FileSystemObject, Using FSO.BuildPath to build a Full Path from folder path and file name">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - Scripting.FileSystemObject">
    <meta property="og:description" content="Retrieve only the path from a file path, Retrieve just the extension from a file name, Recursively enumerate folders and files, Strip file extension from a file name, Creating a FileSystemObject, Reading a text file using a FileSystemObject, Creating a text file with FileSystemObject, Enumerate files in a directory using FileSystemObject, Writing to an existing file with FileSystemObject, Using FSO.BuildPath to build a Full Path from folder path and file name">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/scripting-filesystemobject.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - Scripting.FileSystemObject">
    <meta name="twitter:description" content="Retrieve only the path from a file path, Retrieve just the extension from a file name, Recursively enumerate folders and files, Strip file extension from a file name, Creating a FileSystemObject, Reading a text file using a FileSystemObject, Creating a text file with FileSystemObject, Enumerate files in a directory using FileSystemObject, Writing to an existing file with FileSystemObject, Using FSO.BuildPath to build a Full Path from folder path and file name">
    <meta name="twitter:url" content="/vba/scripting-filesystemobject.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3439.d918a5f3.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" aria-current="page" class="active sidebar-link">Scripting.FileSystemObject</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/scripting-filesystemobject.html#retrieve-only-the-path-from-a-file-path" class="sidebar-link">Retrieve only the path from a file path</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-filesystemobject.html#retrieve-just-the-extension-from-a-file-name" class="sidebar-link">Retrieve just the extension from a file name</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-filesystemobject.html#recursively-enumerate-folders-and-files" class="sidebar-link">Recursively enumerate folders and files</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-filesystemobject.html#strip-file-extension-from-a-file-name" class="sidebar-link">Strip file extension from a file name</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-filesystemobject.html#creating-a-filesystemobject" class="sidebar-link">Creating a FileSystemObject</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-filesystemobject.html#reading-a-text-file-using-a-filesystemobject" class="sidebar-link">Reading a text file using a FileSystemObject</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-filesystemobject.html#creating-a-text-file-with-filesystemobject" class="sidebar-link">Creating a text file with FileSystemObject</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-filesystemobject.html#enumerate-files-in-a-directory-using-filesystemobject" class="sidebar-link">Enumerate files in a directory using FileSystemObject</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-filesystemobject.html#writing-to-an-existing-file-with-filesystemobject" class="sidebar-link">Writing to an existing file with FileSystemObject</a></li><li class="sidebar-sub-header"><a href="/vba/scripting-filesystemobject.html#using-fso-buildpath-to-build-a-full-path-from-folder-path-and-file-name" class="sidebar-link">Using FSO.BuildPath to build a Full Path from folder path and file name</a></li></ul></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="scripting-filesystemobject"><a href="#scripting-filesystemobject" class="header-anchor">#</a> Scripting.FileSystemObject</h1> <h2 id="retrieve-only-the-path-from-a-file-path"><a href="#retrieve-only-the-path-from-a-file-path" class="header-anchor">#</a> Retrieve only the path from a file path</h2> <p>The GetParentFolderName method returns the parent folder for any path.  While this can also be used with folders, it is arguably more useful for extracting the path from an absolute file path:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> fso <span class="token keyword">As</span> <span class="token keyword">New</span> Scripting<span class="token punctuation">.</span>FileSystemObject
Debug<span class="token punctuation">.</span>Print fso<span class="token punctuation">.</span>GetParentFolderName<span class="token punctuation">(</span><span class="token string">&quot;C:\Users\Me\My Documents\SomeFile.txt&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Prints <code>C:\Users\Me\My Documents</code></p> <p>Note that the trailing path separator is not included in the returned string.</p> <h2 id="retrieve-just-the-extension-from-a-file-name"><a href="#retrieve-just-the-extension-from-a-file-name" class="header-anchor">#</a> Retrieve just the extension from a file name</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> fso <span class="token keyword">As</span> <span class="token keyword">New</span> Scripting<span class="token punctuation">.</span>FileSystemObject
Debug<span class="token punctuation">.</span>Print fso<span class="token punctuation">.</span>GetExtensionName<span class="token punctuation">(</span><span class="token string">&quot;MyFile.something.txt&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Prints <code>txt</code>
Note that the <code>GetExtensionName()</code> method already handles multiple periods in a file name.</p> <h2 id="recursively-enumerate-folders-and-files"><a href="#recursively-enumerate-folders-and-files" class="header-anchor">#</a> Recursively enumerate folders and files</h2> <p>Early Bound (with a reference to <code>Microsoft Scripting Runtime</code>)</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> EnumerateFilesAndFolders<span class="token punctuation">(</span> <span class="token operator">_</span>
    FolderPath <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">Optional</span> MaxDepth <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">Optional</span> CurrentDepth <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">Optional</span> Indentation <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
  
    <span class="token keyword">Dim</span> FSO <span class="token keyword">As</span> Scripting<span class="token punctuation">.</span>FileSystemObject
    <span class="token keyword">Set</span> FSO <span class="token operator">=</span> <span class="token keyword">New</span> Scripting<span class="token punctuation">.</span>FileSystemObject
    
    <span class="token comment">'Check the folder exists</span>
    <span class="token keyword">If</span> FSO<span class="token punctuation">.</span>FolderExists<span class="token punctuation">(</span>FolderPath<span class="token punctuation">)</span> <span class="token keyword">Then</span>
        <span class="token keyword">Dim</span> fldr <span class="token keyword">As</span> Scripting<span class="token punctuation">.</span>Folder
        <span class="token keyword">Set</span> fldr <span class="token operator">=</span> FSO<span class="token punctuation">.</span>GetFolder<span class="token punctuation">(</span>FolderPath<span class="token punctuation">)</span>
        
        <span class="token comment">'Output the starting directory path</span>
        <span class="token keyword">If</span> CurrentDepth <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
          Debug<span class="token punctuation">.</span>Print fldr<span class="token punctuation">.</span>Path
        <span class="token keyword">End</span> <span class="token keyword">If</span>
        
        <span class="token comment">'Enumerate the subfolders</span>
        <span class="token keyword">Dim</span> subFldr <span class="token keyword">As</span> Scripting<span class="token punctuation">.</span>Folder
        <span class="token keyword">For</span> <span class="token keyword">Each</span> subFldr <span class="token keyword">In</span> fldr<span class="token punctuation">.</span>SubFolders
            Debug<span class="token punctuation">.</span>Print Space<span class="token operator">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>CurrentDepth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> Indentation<span class="token punctuation">)</span> <span class="token operator">&amp;</span> subFldr<span class="token punctuation">.</span>Name
            <span class="token keyword">If</span> CurrentDepth <span class="token operator">&lt;</span> MaxDepth <span class="token keyword">Or</span> MaxDepth <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">Then</span>
                <span class="token comment">'Recursively call EnumerateFilesAndFolders</span>
                EnumerateFilesAndFolders subFldr<span class="token punctuation">.</span>Path<span class="token punctuation">,</span> MaxDepth<span class="token punctuation">,</span> CurrentDepth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> Indentation
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">Next</span> subFldr
        
        <span class="token comment">'Enumerate the files</span>
        <span class="token keyword">Dim</span> fil <span class="token keyword">As</span> Scripting<span class="token punctuation">.</span>File
        <span class="token keyword">For</span> <span class="token keyword">Each</span> fil <span class="token keyword">In</span> fldr<span class="token punctuation">.</span>Files
            Debug<span class="token punctuation">.</span>Print Space<span class="token operator">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>CurrentDepth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> Indentation<span class="token punctuation">)</span> <span class="token operator">&amp;</span> fil<span class="token punctuation">.</span>Name
        <span class="token keyword">Next</span> fil
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>Output when called with arguments like: <code>EnumerateFilesAndFolders &quot;C:\Test&quot;</code></p> <div class="language-vb extra-class"><pre class="language-vb"><code>C<span class="token punctuation">:</span><span class="token operator">\</span>Test
  Documents
    Personal
      Budget<span class="token punctuation">.</span>xls
      Recipes<span class="token punctuation">.</span>doc
    Work
      Planning<span class="token punctuation">.</span>doc
  Downloads
    FooBar<span class="token punctuation">.</span>exe
  ReadMe<span class="token punctuation">.</span>txt

</code></pre></div><p>Output when called with arguments like: <code>EnumerateFilesAndFolders &quot;C:\Test&quot;, 0</code></p> <div class="language-vb extra-class"><pre class="language-vb"><code>C<span class="token punctuation">:</span><span class="token operator">\</span>Test
  Documents
  Downloads
  ReadMe<span class="token punctuation">.</span>txt

</code></pre></div><p>Output when called with arguments like: <code>EnumerateFilesAndFolders &quot;C:\Test&quot;, 1, 4</code></p> <div class="language-vb extra-class"><pre class="language-vb"><code>C<span class="token punctuation">:</span><span class="token operator">\</span>Test
    Documents
        Personal
        Work
    Downloads
        FooBar<span class="token punctuation">.</span>exe
    ReadMe<span class="token punctuation">.</span>txt

</code></pre></div><h2 id="strip-file-extension-from-a-file-name"><a href="#strip-file-extension-from-a-file-name" class="header-anchor">#</a> Strip file extension from a file name</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> fso <span class="token keyword">As</span> <span class="token keyword">New</span> Scripting<span class="token punctuation">.</span>FileSystemObject
Debug<span class="token punctuation">.</span>Print fso<span class="token punctuation">.</span>GetBaseName<span class="token punctuation">(</span><span class="token string">&quot;MyFile.something.txt&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Prints <code>MyFile.something</code></p> <p>Note that the <code>GetBaseName()</code> method already handles multiple periods in a file name.</p> <h2 id="creating-a-filesystemobject"><a href="#creating-a-filesystemobject" class="header-anchor">#</a> Creating a FileSystemObject</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Const</span> ForReading <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">Const</span> ForWriting <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">Const</span> ForAppending <span class="token operator">=</span> <span class="token number">8</span>

<span class="token keyword">Sub</span> FsoExample<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> fso <span class="token keyword">As</span> <span class="token keyword">Object</span> <span class="token comment">' declare variable</span>
    <span class="token keyword">Set</span> fso <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span> <span class="token comment">' Set it to be a File System Object</span>

    <span class="token comment">' now use it to check if a file exists</span>
    <span class="token keyword">Dim</span> myFilePath <span class="token keyword">As</span> <span class="token keyword">String</span>
    myFilePath <span class="token operator">=</span> <span class="token string">&quot;C:\mypath\to\myfile.txt&quot;</span>
    <span class="token keyword">If</span> fso<span class="token punctuation">.</span>FileExists<span class="token punctuation">(</span>myFilePath<span class="token punctuation">)</span> <span class="token keyword">Then</span>
        <span class="token comment">' do something</span>
    <span class="token keyword">Else</span>
        <span class="token comment">' file doesn't exist</span>
        MsgBox <span class="token string">&quot;File doesn't exist&quot;</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="reading-a-text-file-using-a-filesystemobject"><a href="#reading-a-text-file-using-a-filesystemobject" class="header-anchor">#</a> Reading a text file using a FileSystemObject</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Const</span> ForReading <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">Const</span> ForWriting <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">Const</span> ForAppending <span class="token operator">=</span> <span class="token number">8</span>

<span class="token keyword">Sub</span> ReadTextFileExample<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> fso <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">Set</span> fso <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> sourceFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">Dim</span> myFilePath <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> myFileText <span class="token keyword">As</span> <span class="token keyword">String</span>

    myFilePath <span class="token operator">=</span> <span class="token string">&quot;C:\mypath\to\myfile.txt&quot;</span>
    <span class="token keyword">Set</span> sourceFile <span class="token operator">=</span> fso<span class="token punctuation">.</span>OpenTextFile<span class="token punctuation">(</span>myFilePath<span class="token punctuation">,</span> ForReading<span class="token punctuation">)</span>
    myFileText <span class="token operator">=</span> sourceFile<span class="token punctuation">.</span>ReadAll <span class="token comment">' myFileText now contains the content of the text file</span>
    sourceFile<span class="token punctuation">.</span>Close <span class="token comment">' close the file</span>
    <span class="token comment">' do whatever you might need to do with the text</span>

    <span class="token comment">' You can also read it line by line</span>
    <span class="token keyword">Dim</span> line <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Set</span> sourceFile <span class="token operator">=</span> fso<span class="token punctuation">.</span>OpenTextFile<span class="token punctuation">(</span>myFilePath<span class="token punctuation">,</span> ForReading<span class="token punctuation">)</span>
    <span class="token keyword">While</span> <span class="token keyword">Not</span> sourceFile<span class="token punctuation">.</span>AtEndOfStream <span class="token comment">' while we are not finished reading through the file</span>
        line <span class="token operator">=</span> sourceFile<span class="token punctuation">.</span>ReadLine
        <span class="token comment">' do something with the line...</span>
    <span class="token keyword">Wend</span>
    sourceFile<span class="token punctuation">.</span>Close
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="creating-a-text-file-with-filesystemobject"><a href="#creating-a-text-file-with-filesystemobject" class="header-anchor">#</a> Creating a text file with FileSystemObject</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> CreateTextFileExample<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> fso <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">Set</span> fso <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> targetFile <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">Dim</span> myFilePath <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> myFileText <span class="token keyword">As</span> <span class="token keyword">String</span>

    myFilePath <span class="token operator">=</span> <span class="token string">&quot;C:\mypath\to\myfile.txt&quot;</span>
    <span class="token keyword">Set</span> targetFile <span class="token operator">=</span> fso<span class="token punctuation">.</span>CreateTextFile<span class="token punctuation">(</span>myFilePath<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment">' this will overwrite any existing file</span>
    targetFile<span class="token punctuation">.</span>Write <span class="token string">&quot;This is some new text&quot;</span>
    targetFile<span class="token punctuation">.</span>Write <span class="token string">&quot; And this text will appear right after the first bit of text.&quot;</span>
    targetFile<span class="token punctuation">.</span>WriteLine <span class="token string">&quot;This bit of text includes a newline character to ensure each write takes its own line.&quot;</span>
    targetFile<span class="token punctuation">.</span>Close <span class="token comment">' close the file</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="enumerate-files-in-a-directory-using-filesystemobject"><a href="#enumerate-files-in-a-directory-using-filesystemobject" class="header-anchor">#</a> Enumerate files in a directory using FileSystemObject</h2> <p>Early bound (requires a reference to Microsoft Scripting Runtime):</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> EnumerateDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> fso <span class="token keyword">As</span> Scripting<span class="token punctuation">.</span>FileSystemObject
    <span class="token keyword">Set</span> fso <span class="token operator">=</span> <span class="token keyword">New</span> Scripting<span class="token punctuation">.</span>FileSystemObject

    <span class="token keyword">Dim</span> targetFolder <span class="token keyword">As</span> Folder
    <span class="token keyword">Set</span> targetFolder <span class="token operator">=</span> fso<span class="token punctuation">.</span>GetFolder<span class="token punctuation">(</span><span class="token string">&quot;C:\&quot;</span><span class="token punctuation">)</span>
    
    <span class="token keyword">Dim</span> foundFile <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> foundFile <span class="token keyword">In</span> targetFolder<span class="token punctuation">.</span>Files
        Debug<span class="token punctuation">.</span>Print foundFile<span class="token punctuation">.</span>Name
    <span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>Late bound:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> EnumerateDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> fso <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">Set</span> fso <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> targetFolder <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">Set</span> targetFolder <span class="token operator">=</span> fso<span class="token punctuation">.</span>GetFolder<span class="token punctuation">(</span><span class="token string">&quot;C:\&quot;</span><span class="token punctuation">)</span>
    
    <span class="token keyword">Dim</span> foundFile <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> foundFile <span class="token keyword">In</span> targetFolder<span class="token punctuation">.</span>Files
        Debug<span class="token punctuation">.</span>Print foundFile<span class="token punctuation">.</span>Name
    <span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="writing-to-an-existing-file-with-filesystemobject"><a href="#writing-to-an-existing-file-with-filesystemobject" class="header-anchor">#</a> Writing to an existing file with FileSystemObject</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Const</span> ForReading <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">Const</span> ForWriting <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">Const</span> ForAppending <span class="token operator">=</span> <span class="token number">8</span>


<span class="token keyword">Sub</span> WriteTextFileExample<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> oFso
    <span class="token keyword">Set</span> oFso <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> oFile <span class="token keyword">as</span> <span class="token keyword">Object</span>
    <span class="token keyword">Dim</span> myFilePath <span class="token keyword">as</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> myFileText <span class="token keyword">as</span> <span class="token keyword">String</span>

    myFilePath <span class="token operator">=</span> <span class="token string">&quot;C:\mypath\to\myfile.txt&quot;</span>
    <span class="token comment">' First check if the file exists</span>
    <span class="token keyword">If</span> oFso<span class="token punctuation">.</span>FileExists<span class="token punctuation">(</span>myFilePath<span class="token punctuation">)</span> <span class="token keyword">Then</span>
        <span class="token comment">' this will overwrite any existing filecontent with whatever you send the file</span>
        <span class="token comment">' to append data to the end of an existing file, use ForAppending instead</span>
        <span class="token keyword">Set</span> oFile <span class="token operator">=</span> oFso<span class="token punctuation">.</span>OpenTextFile<span class="token punctuation">(</span>myFilePath<span class="token punctuation">,</span> ForWriting<span class="token punctuation">)</span>  
    <span class="token keyword">Else</span>
        <span class="token comment">' create the file instead</span>
        <span class="token keyword">Set</span> oFile <span class="token operator">=</span> oFso<span class="token punctuation">.</span>CreateTextFile<span class="token punctuation">(</span>myFilePath<span class="token punctuation">)</span> <span class="token comment">' skipping the optional boolean for overwrite if exists as we already checked that the file doesn't exist.</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    oFile<span class="token punctuation">.</span>Write <span class="token string">&quot;This is some new text&quot;</span>
    oFile<span class="token punctuation">.</span>Write <span class="token string">&quot; And this text will appear right after the first bit of text.&quot;</span>
    oFile<span class="token punctuation">.</span>WriteLine <span class="token string">&quot;This bit of text includes a newline character to ensure each write takes its own line.&quot;</span>
    oFile<span class="token punctuation">.</span>Close <span class="token comment">' close the file</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="using-fso-buildpath-to-build-a-full-path-from-folder-path-and-file-name"><a href="#using-fso-buildpath-to-build-a-full-path-from-folder-path-and-file-name" class="header-anchor">#</a> Using FSO.BuildPath to build a Full Path from folder path and file name</h2> <p>If you're accepting user input for folder paths, you might need to check for trailing backslashes (<code>\</code>) before building a file path. The <code>FSO.BuildPath</code> method makes this simpler:</p> <div class="language- extra-class"><pre class="language-text"><code>
 Const sourceFilePath As String = &quot;C:\Temp&quot;  '&lt;-- Without trailing backslash
  Const targetFilePath As String = &quot;C:\Temp\&quot; '&lt;-- With trailing backslash

  Const fileName As String = &quot;Results.txt&quot;
  
  Dim FSO As FileSystemObject
  Set FSO = New FileSystemObject
  
  Debug.Print FSO.BuildPath(sourceFilePath, fileName)
  Debug.Print FSO.BuildPath(targetFilePath, fileName)

</code></pre></div><p>Output:</p> <div class="language-vb extra-class"><pre class="language-vb"><code>C<span class="token punctuation">:</span><span class="token operator">\</span>Temp<span class="token operator">\</span>Results<span class="token punctuation">.</span>txt
C<span class="token punctuation">:</span><span class="token operator">\</span>Temp<span class="token operator">\</span>Results<span class="token punctuation">.</span>txt

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/scripting-filesystemobject.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/passing-arguments-byref-or-byval.html" class="prev">
        Passing Arguments ByRef or ByVal
      </a></span> <span class="next"><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html">
        Working With Files and Directories Without Using FileSystemObject
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3439.d918a5f3.js" defer></script>
  </body>
</html>
