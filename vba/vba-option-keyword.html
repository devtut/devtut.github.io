<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - VBA Option Keyword</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Option Explicit, Option Base {0 | 1}, Option Compare {Binary | Text | Database}">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - VBA Option Keyword">
    <meta property="og:description" content="Option Explicit, Option Base {0 | 1}, Option Compare {Binary | Text | Database}">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/vba-option-keyword.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - VBA Option Keyword">
    <meta name="twitter:description" content="Option Explicit, Option Base {0 | 1}, Option Compare {Binary | Text | Database}">
    <meta name="twitter:url" content="/vba/vba-option-keyword.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3445.8fbe3147.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" aria-current="page" class="active sidebar-link">VBA Option Keyword</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/vba-option-keyword.html#option-explicit" class="sidebar-link">Option Explicit</a></li><li class="sidebar-sub-header"><a href="/vba/vba-option-keyword.html#option-base-0-1" class="sidebar-link">Option Base {0 | 1}</a></li><li class="sidebar-sub-header"><a href="/vba/vba-option-keyword.html#option-compare-binary-text-database" class="sidebar-link">Option Compare {Binary | Text | Database}</a></li></ul></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vba-option-keyword"><a href="#vba-option-keyword" class="header-anchor">#</a> VBA Option Keyword</h1> <h2 id="option-explicit"><a href="#option-explicit" class="header-anchor">#</a> Option Explicit</h2> <p>It is deemed best practice to always use <code>Option Explicit</code> in VBA as it forces the developer to declare all their variables before use. This has other benefits too, such as auto-capitalization for declared variable names and IntelliSense.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Explicit

<span class="token keyword">Sub</span> OptionExplicit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> a <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    a <span class="token operator">=</span> <span class="token number">5</span>
    b <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment">'// Causes compile error as 'b' is not declared</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>Setting <strong>Require Variable Declaration</strong> within the VBE's Tools ► Options ► Editor property page will put the <strong><a href="https://msdn.microsoft.com/en-us/library/y9341s4f.aspx" rel="nofollow">Option
Explicit</a></strong> statement at the top of each newly created code sheet.</p> <p><a href="http://i.stack.imgur.com/C29RO.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/C29RO.png" alt="require_variable_declaration"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>This will avoid silly coding mistakes like misspellings as well as influencing you to use the correct variable type in the variable declaration. (Some more examples are given at <a href="http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/3554/always-use-option-explicit#t=201607281607357211291" target="_blank" rel="noopener noreferrer">ALWAYS Use &quot;Option Explicit&quot;<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.)</p> <h2 id="option-base-0-1"><a href="#option-base-0-1" class="header-anchor">#</a> Option Base {0 | 1}</h2> <p><code>Option Base</code> is used to declare the default lower bound of <strong>array</strong> elements. It is declared at module level and is valid only for the current module.</p> <p>By default (and thus if no Option Base is specified), the Base is 0. Which means that the first element of any array declared in the module has an index of 0.</p> <p>If <code>Option Base 1</code> is specified, the first array element has the index 1</p> <h3 id="example-in-base-0"><a href="#example-in-base-0" class="header-anchor">#</a> Example in Base 0 :</h3> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Base <span class="token number">0</span>

<span class="token keyword">Sub</span> BaseZero<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> myStrings <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    
    <span class="token comment">' Create an array out of the Variant, having 3 fruits elements</span>
    myStrings <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;Apple&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Orange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Peach&quot;</span><span class="token punctuation">)</span>
    
    Debug<span class="token punctuation">.</span>Print LBound<span class="token punctuation">(</span>myStrings<span class="token punctuation">)</span> <span class="token comment">' This Prints &quot;0&quot;</span>
    Debug<span class="token punctuation">.</span>Print UBound<span class="token punctuation">(</span>myStrings<span class="token punctuation">)</span> <span class="token comment">' This print &quot;2&quot;, because we have 3 elements beginning at 0 -&gt; 0,1,2</span>
            
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>myStrings<span class="token punctuation">)</span>
    
        Debug<span class="token punctuation">.</span>Print myStrings<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">' This will print &quot;Apple&quot;, then &quot;Orange&quot;, then &quot;Peach&quot;</span>
    
    <span class="token keyword">Next</span> i

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h3 id="same-example-with-base-1"><a href="#same-example-with-base-1" class="header-anchor">#</a> Same Example with Base 1</h3> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Base <span class="token number">1</span>

<span class="token keyword">Sub</span> BaseOne<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> myStrings <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    
    <span class="token comment">' Create an array out of the Variant, having 3 fruits elements</span>
    myStrings <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;Apple&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Orange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Peach&quot;</span><span class="token punctuation">)</span>
    
    Debug<span class="token punctuation">.</span>Print LBound<span class="token punctuation">(</span>myStrings<span class="token punctuation">)</span> <span class="token comment">' This Prints &quot;1&quot;</span>
    Debug<span class="token punctuation">.</span>Print UBound<span class="token punctuation">(</span>myStrings<span class="token punctuation">)</span> <span class="token comment">' This print &quot;3&quot;, because we have 3 elements beginning at 1 -&gt; 1,2,3</span>
            
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>myStrings<span class="token punctuation">)</span>
    
        Debug<span class="token punctuation">.</span>Print myStrings<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">' This triggers an error 9 &quot;Subscript out of range&quot;</span>
    
    <span class="token keyword">Next</span> i

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>The second example generated a <a href="https://msdn.microsoft.com/en-us/library/aa264519.aspx" target="_blank" rel="noopener noreferrer">Subscript out of range (Error 9)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> at the first loop stage because an attempt to access the index 0 of the array was made, and this index doesn't exists as the module is declared with <code>Base 1</code></p> <h3 id="the-correct-code-with-base-1-is"><a href="#the-correct-code-with-base-1-is" class="header-anchor">#</a> The correct code with Base 1 is :</h3> <div class="language- extra-class"><pre class="language-text"><code>
   For i = 1 To UBound(myStrings)
    
        Debug.Print myStrings(i) ' This will print &quot;Apple&quot;, then &quot;Orange&quot;, then &quot;Peach&quot;
    
    Next i

</code></pre></div><p>It should be noted that the <a href="https://msdn.microsoft.com/en-us/library/aa263365.aspx" target="_blank" rel="noopener noreferrer">Split function<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <strong>always</strong> creates an array with a zero-based element index regardless of any <code>Option Base</code> setting. Examples on how to use the <strong>Split</strong> function can be found <a href="http://stackoverflow.com/documentation/vba/3064/arrays/10413/use-of-split-to-create-an-array-from-a-string#t=201608041103181263837" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote></blockquote> <dl><dt><sup>Split Function</sup></dt><dd><sub>Returns a zero-based, one-dimensional array containing a specified number of substrings.</sub></dd></dl> <p>In Excel, the <code>Range.Value</code> and <code>Range.Formula</code> properties for a multi-celled range <strong>always</strong> returns a 1-based 2D Variant array.</p> <p>Likewise, in ADO, the <code>Recordset.GetRows</code> method <strong>always</strong> returns a 1-based 2D array.</p> <p>One recommended 'best practice' is to always use the <a href="https://msdn.microsoft.com/en-us/library/t9a7w1ac.aspx" target="_blank" rel="noopener noreferrer">LBound<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://msdn.microsoft.com/en-us/library/office/gg278658.aspx" target="_blank" rel="noopener noreferrer">UBound<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> functions to determine the extents of an array.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token comment">'for single dimensioned array</span>
Debug<span class="token punctuation">.</span>Print LBound<span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">&amp;</span> UBound<span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">For</span> i <span class="token operator">=</span> LBound<span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print arr<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token keyword">Next</span> i

<span class="token comment">'for two dimensioned array</span>
Debug<span class="token punctuation">.</span>Print LBound<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">&amp;</span> UBound<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
Debug<span class="token punctuation">.</span>Print LBound<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">&amp;</span> UBound<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">long</span><span class="token punctuation">,</span> j <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">For</span> i <span class="token operator">=</span> LBound<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> j <span class="token operator">=</span> LBound<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
         Debug<span class="token punctuation">.</span>Print arr<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
    <span class="token keyword">Next</span> j
<span class="token keyword">Next</span> i

</code></pre></div><p>The <code>Option Base 1</code> must be at the top of every code module where an array is created or re-dimensioned if arrays are to be consistently created with an lower boundary of 1.</p> <h2 id="option-compare-binary-text-database"><a href="#option-compare-binary-text-database" class="header-anchor">#</a> Option Compare {Binary | Text | Database}</h2> <h3 id="option-compare-binary"><a href="#option-compare-binary" class="header-anchor">#</a> Option Compare Binary</h3> <p>Binary comparison makes all checks for string equality within a module/class case <strong>sensitive</strong>. Technically, with this option, string comparisons are performed using sort order of the binary representations of each character.</p> <blockquote></blockquote> <p>A &lt; B &lt; E &lt; Z &lt; a &lt; b &lt; e &lt; z</p> <p>If no Option Compare is specified in a module, Binary is used by default.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Compare Binary

<span class="token keyword">Sub</span> CompareBinary<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> foo <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> bar <span class="token keyword">As</span> <span class="token keyword">String</span>
    
    <span class="token comment">'// Case sensitive</span>
    foo <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span>
    bar <span class="token operator">=</span> <span class="token string">&quot;ABC&quot;</span>
    
    Debug<span class="token punctuation">.</span>Print <span class="token punctuation">(</span>foo <span class="token operator">=</span> bar<span class="token punctuation">)</span> <span class="token comment">'// Prints &quot;False&quot;</span>
    
    <span class="token comment">'// Still differentiates accented characters</span>
    foo <span class="token operator">=</span> <span class="token string">&quot;ábc&quot;</span>
    bar <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span>
    
    Debug<span class="token punctuation">.</span>Print <span class="token punctuation">(</span>foo <span class="token operator">=</span> bar<span class="token punctuation">)</span> <span class="token comment">'// Prints &quot;False&quot;</span>
    
    <span class="token comment">'// &quot;b&quot; (Chr 98) is greater than &quot;a&quot; (Chr 97)</span>
    foo <span class="token operator">=</span> <span class="token string">&quot;a&quot;</span>
    bar <span class="token operator">=</span> <span class="token string">&quot;b&quot;</span>
    
    Debug<span class="token punctuation">.</span>Print <span class="token punctuation">(</span>bar <span class="token operator">&gt;</span> foo<span class="token punctuation">)</span> <span class="token comment">'// Prints &quot;True&quot;</span>
    
    <span class="token comment">'// &quot;b&quot; (Chr 98) is NOT greater than &quot;á&quot; (Chr 225)</span>
    foo <span class="token operator">=</span> <span class="token string">&quot;á&quot;</span>
    bar <span class="token operator">=</span> <span class="token string">&quot;b&quot;</span>
    
    Debug<span class="token punctuation">.</span>Print <span class="token punctuation">(</span>bar <span class="token operator">&gt;</span> foo<span class="token punctuation">)</span> <span class="token comment">'// Prints &quot;False&quot;</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h3 id="option-compare-text"><a href="#option-compare-text" class="header-anchor">#</a> Option Compare Text</h3> <p>Option Compare Text makes all string comparisons within a module/class use a case <strong>insensitive</strong> comparison.</p> <blockquote></blockquote> <p>(A | a) &lt; (B | b) &lt; (Z | z)</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Compare Text

<span class="token keyword">Sub</span> CompareText<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> foo <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> bar <span class="token keyword">As</span> <span class="token keyword">String</span>
    
    <span class="token comment">'// Case insensitivity</span>
    foo <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span>
    bar <span class="token operator">=</span> <span class="token string">&quot;ABC&quot;</span>
    
    Debug<span class="token punctuation">.</span>Print <span class="token punctuation">(</span>foo <span class="token operator">=</span> bar<span class="token punctuation">)</span> <span class="token comment">'// Prints &quot;True&quot;</span>
    
    <span class="token comment">'// Still differentiates accented characters</span>
    foo <span class="token operator">=</span> <span class="token string">&quot;ábc&quot;</span>
    bar <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span>
    
    Debug<span class="token punctuation">.</span>Print <span class="token punctuation">(</span>foo <span class="token operator">=</span> bar<span class="token punctuation">)</span> <span class="token comment">'// Prints &quot;False&quot;</span>
    
    <span class="token comment">'// &quot;b&quot; still comes after &quot;a&quot; or &quot;á&quot;</span>
    foo <span class="token operator">=</span> <span class="token string">&quot;á&quot;</span>
    bar <span class="token operator">=</span> <span class="token string">&quot;b&quot;</span>
    
    Debug<span class="token punctuation">.</span>Print <span class="token punctuation">(</span>bar <span class="token operator">&gt;</span> foo<span class="token punctuation">)</span> <span class="token comment">'// Prints &quot;True&quot;</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h3 id="option-compare-database"><a href="#option-compare-database" class="header-anchor">#</a> Option Compare Database</h3> <p>Option Compare Database is only available within MS Access. It sets the module/class to use the current database settings to determine whether to use Text or Binary mode.</p> <p><strong>Note: The use of this setting is discouraged unless the module is used for writing custom Access UDFs (User defined functions) that should treat text comparisons in the same manner as SQL queries in that database.</strong></p> <h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li>Option optionName [value]</li> <li>Option Explicit</li> <li>Option Compare {Text | Binary | Database}</li> <li>Option Private Module</li> <li>Option Base {0 | 1}</li></ul> <h4 id="parameters"><a href="#parameters" class="header-anchor">#</a> Parameters</h4> <table><thead><tr><th>Option</th> <th>Detail</th></tr></thead> <tbody><tr><td>Explicit</td> <td><strong>Require variable declaration</strong> in the module it's specified in (ideally all of them); with this option specified, using an undeclared (/mispelled) variable becomes a compilation error.</td></tr> <tr><td>Compare Text</td> <td>Makes the module's string comparisons be case-insensitive, based on system locale, prioritizing alphabetical equivalency (e.g. &quot;a&quot; = &quot;A&quot;).</td></tr> <tr><td>Compare Binary</td> <td>Default string comparison mode. Makes the module's string comparisons be case sensitive, comparing strings using the binary representation / numeric value of each character (e.g. ASCII).</td></tr> <tr><td>Compare Database</td> <td>(MS-Access only) Makes the module's string comparisons work the way they would in an SQL statement.</td></tr> <tr><td>Private Module</td> <td>Prevents the module's <code>Public</code> member from being accessed from outside of the project that the module resides in, effectively hiding procedures from the host application (i.e. not available to use as macros or user-defined functions).</td></tr> <tr><td>Option Base 0</td> <td>Default setting. Sets the implicit array lower bound to <code>0</code> in a module. When an array is declared without an explicit lower boundary value, <code>0</code> will be used.</td></tr> <tr><td>Option Base 1</td> <td>Sets the implicit array lower bound to <code>1</code> in a module. When an array is declared without an explicit lower boundary value, <code>1</code> will be used.</td></tr></tbody></table> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>It is much easier to control the boundaries of arrays by declaring the boundaries explicitly rather than letting the compiler fall back on an <code>Option Base {0|1}</code> declaration. This can be done like so:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> myStringsA<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token comment">'// This has 6 elements (0 - 5)</span>
<span class="token keyword">Dim</span> myStringsB<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token comment">'// This has 5 elements (1 - 5)</span>
<span class="token keyword">Dim</span> myStringsC<span class="token punctuation">(</span><span class="token number">6</span> <span class="token keyword">To</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token comment">'// This has 3 elements (6 - 9)</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/vba-option-keyword.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="prev">
        String Literals - Escaping, non-printable characters and line-continuations
      </a></span> <span class="next"><a href="/vba/declaring-variables.html">
        Declaring Variables
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3445.8fbe3147.js" defer></script>
  </body>
</html>
