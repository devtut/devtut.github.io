<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - Working With Files and Directories Without Using FileSystemObject</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Determining If Folders and Files Exist, Creating and Deleting File Folders">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - Working With Files and Directories Without Using FileSystemObject">
    <meta property="og:description" content="Determining If Folders and Files Exist, Creating and Deleting File Folders">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/working-with-files-and-directories-without-using-filesystemobject.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - Working With Files and Directories Without Using FileSystemObject">
    <meta name="twitter:description" content="Determining If Folders and Files Exist, Creating and Deleting File Folders">
    <meta name="twitter:url" content="/vba/working-with-files-and-directories-without-using-filesystemobject.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3448.3f3f505c.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" aria-current="page" class="active sidebar-link">Working With Files and Directories Without Using FileSystemObject</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html#determining-if-folders-and-files-exist" class="sidebar-link">Determining If Folders and Files Exist</a></li><li class="sidebar-sub-header"><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html#creating-and-deleting-file-folders" class="sidebar-link">Creating and Deleting File Folders</a></li></ul></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="working-with-files-and-directories-without-using-filesystemobject"><a href="#working-with-files-and-directories-without-using-filesystemobject" class="header-anchor">#</a> Working With Files and Directories Without Using FileSystemObject</h1> <h2 id="determining-if-folders-and-files-exist"><a href="#determining-if-folders-and-files-exist" class="header-anchor">#</a> Determining If Folders and Files Exist</h2> <p><strong>Files:</strong></p> <p>To determine if a file exists, simply pass the filename to the <code>Dir$</code> function and test to see if it returns a result. Note that <code>Dir$</code> supports wild-cards, so to test for a <strong>specific</strong> file, the passed <code>pathName</code> should to be tested to ensure that it does not contain them. The sample below raises an error - if this isn't the desired behavior, the function can be changed to simply return <code>False</code>.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Function</span> FileExists<span class="token punctuation">(</span>pathName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token keyword">If</span> InStr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> pathName<span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span> <span class="token keyword">Or</span> InStr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> pathName<span class="token punctuation">,</span> <span class="token string">&quot;?&quot;</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
        <span class="token comment">'Exit Function   'Return False on wild-cards.</span>
        Err<span class="token punctuation">.</span>Raise <span class="token number">52</span>    <span class="token comment">'Raise error on wild-cards.</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    FileExists <span class="token operator">=</span> Dir<span class="token operator">$</span><span class="token punctuation">(</span>pathName<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> vbNullString
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><p><strong>Folders (Dir$ method):</strong></p> <p>The <code>Dir$()</code> function can also be used to determine if a folder exists by specifying passing <code>vbDirectory</code> for the optional <code>attributes</code> parameter. In this case, the passed <code>pathName</code> value must end with a path separator (<code>\</code>), as matching <strong>filenames</strong> will cause false positives. Keep in mind that wild-cards are only allowed after the last path separator, so the example function below will throw a run-time error 52 - &quot;Bad file name or number&quot; if the input contains a wild-card. If this isn't the desired behavior, uncomment <code>On Error Resume Next</code> at the top of the function. Also remember that <code>Dir$</code> supports relative file paths (i.e. <code>..\Foo\Bar</code>), so results are only guaranteed to be valid as long as the current working directory is not changed.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Function</span> FolderExists<span class="token punctuation">(</span><span class="token keyword">ByVal</span> pathName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token comment">'Uncomment the &quot;On Error&quot; line if paths with wild-cards should return False</span>
    <span class="token comment">'instead of raising an error.</span>
    <span class="token comment">'On Error Resume Next    </span>
    <span class="token keyword">If</span> pathName <span class="token operator">=</span> vbNullString <span class="token keyword">Or</span> Right<span class="token operator">$</span><span class="token punctuation">(</span>pathName<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;\&quot;</span> <span class="token keyword">Then</span>
        <span class="token keyword">Exit</span> <span class="token keyword">Function</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    FolderExists <span class="token operator">=</span> Dir<span class="token operator">$</span><span class="token punctuation">(</span>pathName<span class="token punctuation">,</span> vbDirectory<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> vbNullString
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><p><strong>Folders (ChDir method):</strong></p> <p>The <code>ChDir</code> statement can also be used to test if a folder exists.  Note that this method will temporarily change the environment that VBA is running in, so if that is a consideration, the <code>Dir$</code> method should be used instead.  It does have the advantage of being much less forgiving with its parameter.  This method also supports relative file paths, so has the same caveat as the <code>Dir$</code> method.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Function</span> FolderExists<span class="token punctuation">(</span><span class="token keyword">ByVal</span> pathName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token comment">'Cache the current working directory</span>
    <span class="token keyword">Dim</span> cached <span class="token keyword">As</span> <span class="token keyword">String</span>
    cached <span class="token operator">=</span> CurDir<span class="token operator">$</span>

    <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
    ChDir pathName
    FolderExists <span class="token operator">=</span> Err<span class="token punctuation">.</span>Number <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">GoTo</span> <span class="token number">0</span>
    <span class="token comment">'Change back to the cached working directory.</span>
    ChDir cached
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><h2 id="creating-and-deleting-file-folders"><a href="#creating-and-deleting-file-folders" class="header-anchor">#</a> Creating and Deleting File Folders</h2> <p><strong>NOTE:</strong> For brevity, the examples below use the FolderExists function from the <strong>Determining If Folders and Files Exist</strong> example in this topic.</p> <p>The <code>MkDir</code> statement can be used to create a new folder. It accepts paths containing drive letters (<code>C:\Foo</code>), UNC names (<code>\\Server\Foo</code>), relative paths (<code>..\Foo</code>), or the current working directory (<code>Foo</code>).</p> <p>If the drive or UNC name is omitted (i.e. <code>\Foo</code>), the folder is created on the current drive. This may or may not be the same drive as the current working directory.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> MakeNewDirectory<span class="token punctuation">(</span><span class="token keyword">ByVal</span> pathName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span>
    <span class="token comment">'MkDir will fail if the directory already exists.</span>
    <span class="token keyword">If</span> FolderExists<span class="token punctuation">(</span>pathName<span class="token punctuation">)</span> <span class="token keyword">Then</span> <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
    <span class="token comment">'This may still fail due to permissions, etc.</span>
    MkDir pathName
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>The <code>RmDir</code> statement can be used to delete existing folders. It accepts paths in the same forms as <code>MkDir</code> and uses the same relationship to the current working directory and drive. Note that the statement is similar to the Windows <code>rd</code> shell command, so will throw a run-time error 75: &quot;Path/File access error&quot; if the target directory is not empty.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> DeleteDirectory<span class="token punctuation">(</span><span class="token keyword">ByVal</span> pathName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span>
    <span class="token keyword">If</span> Right<span class="token operator">$</span><span class="token punctuation">(</span>pathName<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;\&quot;</span> <span class="token keyword">Then</span>
        pathName <span class="token operator">=</span> pathName <span class="token operator">&amp;</span> <span class="token string">&quot;\&quot;</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token comment">'Rmdir will fail if the directory doesn't exist.</span>
    <span class="token keyword">If</span> <span class="token keyword">Not</span> FolderExists<span class="token punctuation">(</span>pathName<span class="token punctuation">)</span> <span class="token keyword">Then</span> <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
    <span class="token comment">'Rmdir will fail if the directory contains files.</span>
    <span class="token keyword">If</span> Dir<span class="token operator">$</span><span class="token punctuation">(</span>pathName <span class="token operator">&amp;</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> vbNullString <span class="token keyword">Then</span> <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
    
    <span class="token comment">'Rmdir will fail if the directory contains directories.</span>
    <span class="token keyword">Dim</span> subDir <span class="token keyword">As</span> <span class="token keyword">String</span>
    subDir <span class="token operator">=</span> Dir<span class="token operator">$</span><span class="token punctuation">(</span>pathName <span class="token operator">&amp;</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span> vbDirectory<span class="token punctuation">)</span>
    <span class="token keyword">Do</span>
        <span class="token keyword">If</span> subDir <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;.&quot;</span> <span class="token keyword">And</span> subDir <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;..&quot;</span> <span class="token keyword">Then</span> <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
        subDir <span class="token operator">=</span> Dir<span class="token operator">$</span><span class="token punctuation">(</span><span class="token punctuation">,</span> vbDirectory<span class="token punctuation">)</span>
    <span class="token keyword">Loop</span> <span class="token keyword">While</span> subDir <span class="token operator">&lt;</span><span class="token operator">&gt;</span> vbNullString
    
    <span class="token comment">'This may still fail due to permissions, etc.</span>
    RmDir pathName
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>The <code>Scripting.FileSystemObject</code> is much more robust that the legacy methods in this topic.  It should be preferred in almost all cases.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/working-with-files-and-directories-without-using-filesystemobject.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/scripting-filesystemobject.html" class="prev">
        Scripting.FileSystemObject
      </a></span> <span class="next"><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html">
        Reading 2GB+ files in binary in VBA and File Hashes
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3448.3f3f505c.js" defer></script>
  </body>
</html>
