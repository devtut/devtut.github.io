<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - Automation or Using other applications Libraries</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="VBScript Regular Expressions, Scripting File System Object, Scripting Dictionary object, Internet Explorer Object">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - Automation or Using other applications Libraries">
    <meta property="og:description" content="VBScript Regular Expressions, Scripting File System Object, Scripting Dictionary object, Internet Explorer Object">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/automation-or-using-other-applications-libraries.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - Automation or Using other applications Libraries">
    <meta name="twitter:description" content="VBScript Regular Expressions, Scripting File System Object, Scripting Dictionary object, Internet Explorer Object">
    <meta name="twitter:url" content="/vba/automation-or-using-other-applications-libraries.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3406.eac1cfae.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" aria-current="page" class="active sidebar-link">Automation or Using other applications Libraries</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/automation-or-using-other-applications-libraries.html#vbscript-regular-expressions" class="sidebar-link">VBScript Regular Expressions</a></li><li class="sidebar-sub-header"><a href="/vba/automation-or-using-other-applications-libraries.html#scripting-file-system-object" class="sidebar-link">Scripting File System Object</a></li><li class="sidebar-sub-header"><a href="/vba/automation-or-using-other-applications-libraries.html#scripting-dictionary-object" class="sidebar-link">Scripting Dictionary object</a></li><li class="sidebar-sub-header"><a href="/vba/automation-or-using-other-applications-libraries.html#internet-explorer-object" class="sidebar-link">Internet Explorer Object</a></li></ul></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="automation-or-using-other-applications-libraries"><a href="#automation-or-using-other-applications-libraries" class="header-anchor">#</a> Automation or Using other applications Libraries</h1> <p>If you use the objects in other applications as part of your Visual Basic application, you may want to establish a reference to the object libraries of those applications. This Documentation provides a list, sources and examples of how to use libraries of different softwares, like Windows Shell, Internet Explorer, XML HttpRequest, and others.</p> <h2 id="vbscript-regular-expressions"><a href="#vbscript-regular-expressions" class="header-anchor">#</a> VBScript Regular Expressions</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Set</span> createVBScriptRegExObject <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;vbscript.RegExp&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Tools&gt; References&gt; Microsoft VBScript Regular Expressions #.#<br>
Associated DLL: VBScript.dll<br>
Source: Internet Explorer 1.0 and 5.5</p> <ul><li><a href="https://msdn.microsoft.com/en-us/library/ms974570.aspx" target="_blank" rel="noopener noreferrer">MSDN-Microsoft Beefs Up VBScript with Regular Expressions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://msdn.microsoft.com/en-us/library/1400241x(VS.85).aspx" target="_blank" rel="noopener noreferrer">MSDN-Regular Expression Syntax (Scripting)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.experts-exchange.com/articles/1336/Using-Regular-Expressions-in-Visual-Basic-for-Applications-and-Visual-Basic-6.html" target="_blank" rel="noopener noreferrer">experts-exchange - Using Regular Expressions in Visual Basic for Applications and Visual Basic 6<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://stackoverflow.com/q/22542834/4636801" target="_blank" rel="noopener noreferrer">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on SO.</li> <li><a href="http://www.regular-expressions.info/vbscript.html" target="_blank" rel="noopener noreferrer">regular-expressions.info/vbscript<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://www.regular-expressions.info/vbscriptexample.html" target="_blank" rel="noopener noreferrer">regular-expressions.info/vbscriptexample<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://en.wikipedia.org/wiki/Regular_expression" target="_blank" rel="noopener noreferrer">WIKI-Regular expression<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="code"><a href="#code" class="header-anchor">#</a> Code</h3> <p>You can use this functions to get RegEx results, concatenate all matches (if more than 1) into 1 string, and display result in excel cell.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Function</span> getRegExResult<span class="token punctuation">(</span><span class="token keyword">ByVal</span> SourceString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">Optional</span> <span class="token keyword">ByVal</span> RegExPattern <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;\d+&quot;</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">Optional</span> <span class="token keyword">ByVal</span> isGlobalSearch <span class="token keyword">As</span> <span class="token keyword">Boolean</span> <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token keyword">Optional</span> <span class="token keyword">ByVal</span> isCaseSensitive <span class="token keyword">As</span> <span class="token keyword">Boolean</span> <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token keyword">Optional</span> <span class="token keyword">ByVal</span> Delimiter <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
    
    <span class="token keyword">Static</span> RegExObject <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">If</span> RegExObject <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span>
        <span class="token keyword">Set</span> RegExObject <span class="token operator">=</span> createVBScriptRegExObject
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    
    getRegExResult <span class="token operator">=</span> removeLeadingDelimiter<span class="token punctuation">(</span>concatObjectItems<span class="token punctuation">(</span>getRegExMatches<span class="token punctuation">(</span>RegExObject<span class="token punctuation">,</span> SourceString<span class="token punctuation">,</span> RegExPattern<span class="token punctuation">,</span> isGlobalSearch<span class="token punctuation">,</span> isCaseSensitive<span class="token punctuation">)</span><span class="token punctuation">,</span> Delimiter<span class="token punctuation">)</span><span class="token punctuation">,</span> Delimiter<span class="token punctuation">)</span>
    
<span class="token keyword">End</span> <span class="token keyword">Function</span>

<span class="token keyword">Private</span> <span class="token keyword">Function</span> getRegExMatches<span class="token punctuation">(</span><span class="token keyword">ByRef</span> RegExObj <span class="token keyword">As</span> <span class="token keyword">Object</span><span class="token punctuation">,</span> <span class="token operator">_</span>
    <span class="token keyword">ByVal</span> SourceString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> RegExPattern <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> isGlobalSearch <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> isCaseSensitive <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Object</span>

    <span class="token keyword">With</span> RegExObj
        <span class="token punctuation">.</span><span class="token keyword">Global</span> <span class="token operator">=</span> isGlobalSearch
        <span class="token punctuation">.</span>IgnoreCase <span class="token operator">=</span> <span class="token keyword">Not</span> <span class="token punctuation">(</span>isCaseSensitive<span class="token punctuation">)</span> <span class="token comment">'it is more user friendly to use positive meaning of argument, like isCaseSensitive, than to use negative IgnoreCase</span>
        <span class="token punctuation">.</span>Pattern <span class="token operator">=</span> RegExPattern
        <span class="token keyword">Set</span> getRegExMatches <span class="token operator">=</span> <span class="token punctuation">.</span>Execute<span class="token punctuation">(</span>SourceString<span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
    
<span class="token keyword">End</span> <span class="token keyword">Function</span>

<span class="token keyword">Private</span> <span class="token keyword">Function</span> concatObjectItems<span class="token punctuation">(</span><span class="token keyword">ByRef</span> Obj <span class="token keyword">As</span> <span class="token keyword">Object</span><span class="token punctuation">,</span> <span class="token keyword">Optional</span> <span class="token keyword">ByVal</span> DelimiterCustom <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> ObjElement <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> ObjElement <span class="token keyword">In</span> Obj
        concatObjectItems <span class="token operator">=</span> concatObjectItems <span class="token operator">&amp;</span> DelimiterCustom <span class="token operator">&amp;</span> ObjElement<span class="token punctuation">.</span>Value
    <span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

<span class="token keyword">Public</span> <span class="token keyword">Function</span> removeLeadingDelimiter<span class="token punctuation">(</span><span class="token keyword">ByVal</span> SourceString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> Delimiter <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">If</span> Left<span class="token operator">$</span><span class="token punctuation">(</span>SourceString<span class="token punctuation">,</span> Len<span class="token punctuation">(</span>Delimiter<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> Delimiter <span class="token keyword">Then</span>
        removeLeadingDelimiter <span class="token operator">=</span> Mid<span class="token operator">$</span><span class="token punctuation">(</span>SourceString<span class="token punctuation">,</span> Len<span class="token punctuation">(</span>Delimiter<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

<span class="token keyword">Private</span> <span class="token keyword">Function</span> createVBScriptRegExObject<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">Set</span> createVBScriptRegExObject <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;vbscript.RegExp&quot;</span><span class="token punctuation">)</span> <span class="token comment">'ex.: createVBScriptRegExObject.Pattern</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><h2 id="scripting-file-system-object"><a href="#scripting-file-system-object" class="header-anchor">#</a> Scripting File System Object</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Set</span> createScriptingFileSystemObject <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Tools&gt; References&gt; Microsoft Scripting Runtime<br>
Associated DLL: ScrRun.dll<br>
Source: Windows OS</p> <p><a href="https://msdn.microsoft.com/en-us/library/aa711216(v=vs.71).aspx" target="_blank" rel="noopener noreferrer">MSDN-Accessing Files with FileSystemObject<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote></blockquote> <p>The File System Object (FSO) model provides an object-based tool for working with folders and files. It allows you to use the familiar object.method syntax with a rich set of properties, methods, and events to process folders and files. You can also employ the traditional Visual Basic statements and commands.</p> <blockquote></blockquote> <p>The FSO model gives your application the ability to create, alter, move, and delete folders, or to determine if and where particular folders exist. It also enables you to get information about folders, such as their names and the date they were created or last modified.</p> <p><a href="https://msdn.microsoft.com/en-us/library/6kxy1a51(v=vs.84).aspx" target="_blank" rel="noopener noreferrer">MSDN-FileSystemObject topics<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: &quot;<strong>...explain the concept of the FileSystemObject and how to use it.</strong>&quot;
<a href="http://www.exceltrick.com/formulas_macros/filesystemobject-in-vba/" target="_blank" rel="noopener noreferrer">exceltrick-FileSystemObject in VBA – Explained<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="http://stackoverflow.com/documentation/vba/990/scripting-filesystemobject#t=201701271051007258872" target="_blank" rel="noopener noreferrer">Scripting.FileSystemObject<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="scripting-dictionary-object"><a href="#scripting-dictionary-object" class="header-anchor">#</a> Scripting Dictionary object</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Set</span> dict <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.Dictionary&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Tools&gt; References&gt; Microsoft Scripting Runtime<br>
Associated DLL: ScrRun.dll<br>
Source: Windows OS</p> <p><a href="http://stackoverflow.com/documentation/vba/3667/scripting-dictionary-object#t=201701271051035696138" target="_blank" rel="noopener noreferrer">Scripting.Dictionary object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://msdn.microsoft.com/en-us/library/x4k5wbx4(v=vs.84).aspx" target="_blank" rel="noopener noreferrer">MSDN-Dictionary Object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="internet-explorer-object"><a href="#internet-explorer-object" class="header-anchor">#</a> Internet Explorer Object</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Set</span> createInternetExplorerObject <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;InternetExplorer.Application&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Tools&gt; References&gt; Microsoft Internet Controls<br>
Associated DLL: ieframe.dll<br>
Source: Internet Explorer Browser</p> <p><a href="https://msdn.microsoft.com/en-us/library/aa752084(v=vs.85).aspx" target="_blank" rel="noopener noreferrer">MSDN-InternetExplorer object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote></blockquote> <p>Controls an instance of Windows Internet Explorer through automation.</p> <h3 id="internet-explorer-objec-basic-members"><a href="#internet-explorer-objec-basic-members" class="header-anchor">#</a> Internet Explorer Objec Basic Members</h3> <p>The code below should introduce how the IE object works and how to manipulate it through VBA. I recommend stepping through it, otherwise it might error out during multiple navigations.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> IEGetToKnow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> IE <span class="token keyword">As</span> InternetExplorer <span class="token comment">'Reference to Microsoft Internet Controls</span>
    <span class="token keyword">Set</span> IE <span class="token operator">=</span> <span class="token keyword">New</span> InternetExplorer
    
    <span class="token keyword">With</span> IE
        <span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token comment">'Sets or gets a value that indicates whether the object is visible or hidden.</span>
        
        <span class="token comment">'Navigation</span>
        <span class="token punctuation">.</span>Navigate2 <span class="token string">&quot;http://www.example.com&quot;</span> <span class="token comment">'Navigates the browser to a location that might not be expressed as a URL, such as a PIDL for an entity in the Windows Shell namespace.</span>
        Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>Busy <span class="token comment">'Gets a value that indicates whether the object is engaged in a navigation or downloading operation.</span>
        Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>ReadyState <span class="token comment">'Gets the ready state of the object.</span>
        <span class="token punctuation">.</span>Navigate2 <span class="token string">&quot;http://www.example.com/2&quot;</span>
        <span class="token punctuation">.</span>GoBack <span class="token comment">'Navigates backward one item in the history list</span>
        <span class="token punctuation">.</span>GoForward <span class="token comment">'Navigates forward one item in the history list.</span>
        <span class="token punctuation">.</span>GoHome <span class="token comment">'Navigates to the current home or start page.</span>
        <span class="token punctuation">.</span><span class="token keyword">Stop</span> <span class="token comment">'Cancels a pending navigation or download, and stops dynamic page elements, such as background sounds and animations.</span>
        <span class="token punctuation">.</span>Refresh <span class="token comment">'Reloads the file that is currently displayed in the object.</span>
        
        Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>Silent <span class="token comment">'Sets or gets a value that indicates whether the object can display dialog boxes.</span>
        Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span><span class="token keyword">Type</span> <span class="token comment">'Gets the user type name of the contained document object.</span>
        
        Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>Top <span class="token comment">'Sets or gets the coordinate of the top edge of the object.</span>
        Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>Left <span class="token comment">'Sets or gets the coordinate of the left edge of the object.</span>
        Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>Height <span class="token comment">'Sets or gets the height of the object.</span>
        Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>Width <span class="token comment">'Sets or gets the width of the object.</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
    
    IE<span class="token punctuation">.</span>Quit <span class="token comment">'close the application window</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h3 id="web-scraping"><a href="#web-scraping" class="header-anchor">#</a> Web Scraping</h3> <p>The most common thing to do with IE is to scrape some information of a website, or to fill a website form and submit information. We will look at how to do it.</p> <p>Let us consider <strong><a href="http://www.example.com/" target="_blank" rel="noopener noreferrer">example.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> source code:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token operator">&lt;</span><span class="token operator">!</span>doctype html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Example Domain<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;Content-type&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;text/html; charset=utf-8&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>style <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span> 
    <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Example Domain<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>This domain <span class="token keyword">is</span> established <span class="token keyword">to</span> be used <span class="token keyword">for</span> illustrative examples <span class="token keyword">in</span> documents<span class="token punctuation">.</span> You may use this
            domain <span class="token keyword">in</span> examples without prior coordination <span class="token keyword">or</span> asking <span class="token keyword">for</span> permission<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;http://www.iana.org/domains/example&quot;</span><span class="token operator">&gt;</span>More information<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>

</code></pre></div><p>We can use code like below to get and set informations:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> IEWebScrape1<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> IE <span class="token keyword">As</span> InternetExplorer <span class="token comment">'Reference to Microsoft Internet Controls</span>
    <span class="token keyword">Set</span> IE <span class="token operator">=</span> <span class="token keyword">New</span> InternetExplorer
    
    <span class="token keyword">With</span> IE
        <span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Navigate2 <span class="token string">&quot;http://www.example.com&quot;</span>
        
        <span class="token comment">'we add a loop to be sure the website is loaded and ready.</span>
        <span class="token comment">'Does not work consistently. Cannot be relied upon.</span>
        <span class="token keyword">Do</span> <span class="token keyword">While</span> <span class="token punctuation">.</span>Busy <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token keyword">Or</span> <span class="token punctuation">.</span>ReadyState <span class="token operator">&lt;</span><span class="token operator">&gt;</span> READYSTATE_COMPLETE <span class="token comment">'Equivalent = .ReadyState &lt;&gt; 4</span>
            <span class="token comment">' DoEvents - worth considering. Know implications before you use it.</span>
            Application<span class="token punctuation">.</span>Wait <span class="token punctuation">(</span>Now <span class="token operator">+</span> TimeValue<span class="token punctuation">(</span><span class="token string">&quot;00:00:01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">'Wait 1 second, then check again.</span>
        <span class="token keyword">Loop</span>
        
        <span class="token comment">'Print info in immediate window</span>
        <span class="token keyword">With</span> <span class="token punctuation">.</span>Document <span class="token comment">'the source code HTML &quot;below&quot; the displayed page.</span>
            <span class="token keyword">Stop</span> <span class="token comment">'VBE Stop. Continue line by line to see what happens.</span>
            Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHtml <span class="token comment">'prints &quot;Example Domain&quot;</span>
            Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;h1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHtml <span class="token comment">'prints &quot;Example Domain&quot;</span>
            Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHtml <span class="token comment">'prints &quot;This domain is established...&quot;</span>
            Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHtml <span class="token comment">'prints &quot;&lt;a href=&quot;http://www.iana.org/domains/example&quot;&gt;More information...&lt;/a&gt;&quot;</span>
            Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText <span class="token comment">'prints &quot;More information...&quot;</span>
            Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText <span class="token comment">'prints &quot;More information...&quot;</span>
            
            <span class="token comment">'We can change the localy displayed website. Don't worry about breaking the site.</span>
            <span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHtml <span class="token operator">=</span> <span class="token string">&quot;Psst, scraping...&quot;</span>
            <span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;h1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHtml <span class="token operator">=</span> <span class="token string">&quot;Let me try something fishy.&quot;</span> <span class="token comment">'You have just changed the local HTML of the site.</span>
            <span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHtml <span class="token operator">=</span> <span class="token string">&quot;Lorem ipsum........... The End&quot;</span>
            <span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">&quot;iana.org&quot;</span>
        <span class="token keyword">End</span> <span class="token keyword">With</span> <span class="token comment">'.document</span>
        
        <span class="token punctuation">.</span>Quit <span class="token comment">'close the application window</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span> <span class="token comment">'ie</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>What is going on? The key player here is the <strong>.Document</strong>, that is the HTML source code. We can apply some queries to get the Collections or Object we want.<br>
For example the <code>IE.Document.GetElementsByTagName(&quot;title&quot;)(0).innerHtml</code>. <code>GetElementsByTagName</code> returns a <strong>Collection</strong> of HTML Elements, that have the &quot;<strong>title</strong>&quot; tag. There is only one such tag in the source code. The <strong>Collection</strong> is 0-based. So to get the first element we add <code>(0)</code>. Now, in our case, we want only the <code>innerHtml</code> (a String), not the Element Object itself. So we specify the property we want.</p> <h3 id="click"><a href="#click" class="header-anchor">#</a> Click</h3> <p>To follow a link on a site, we can use multiple methods:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> IEGoToPlaces<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> IE <span class="token keyword">As</span> InternetExplorer <span class="token comment">'Reference to Microsoft Internet Controls</span>
    <span class="token keyword">Set</span> IE <span class="token operator">=</span> <span class="token keyword">New</span> InternetExplorer
    
    <span class="token keyword">With</span> IE
        <span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Navigate2 <span class="token string">&quot;http://www.example.com&quot;</span>
        <span class="token keyword">Stop</span> <span class="token comment">'VBE Stop. Continue line by line to see what happens.</span>
        
        <span class="token comment">'Click</span>
        <span class="token punctuation">.</span>Document<span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Click
        <span class="token keyword">Stop</span> <span class="token comment">'VBE Stop.</span>
        
        <span class="token comment">'Return Back</span>
        <span class="token punctuation">.</span>GoBack
        <span class="token keyword">Stop</span> <span class="token comment">'VBE Stop.</span>
        
        <span class="token comment">'Navigate using the href attribute in the &lt;a&gt; tag, or &quot;link&quot;</span>
        <span class="token punctuation">.</span>Navigate2 <span class="token punctuation">.</span>Document<span class="token punctuation">.</span>GetElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>href
        <span class="token keyword">Stop</span> <span class="token comment">'VBE Stop.</span>
        
        <span class="token punctuation">.</span>Quit <span class="token comment">'close the application window</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h3 id="microsoft-html-object-library-or-ie-best-friend"><a href="#microsoft-html-object-library-or-ie-best-friend" class="header-anchor">#</a> Microsoft HTML Object Library or IE Best friend</h3> <p>To get the most out of the HTML that gets loaded into the IE, you can (or should) use another Library, i.e. <strong>Microsoft HTML Object Library</strong>. More about this in another example.</p> <h3 id="ie-main-issues"><a href="#ie-main-issues" class="header-anchor">#</a> IE Main issues</h3> <p>The main issue with IE is verifying that the page is done loading and is ready to be interacted with. The <code>Do While... Loop</code> helps, but is not reliable.</p> <p>Also, using IE just to scrape HTML content is OVERKILL. Why? Because the Browser is meant for browsing, i.e. displaying the web page with all the CSS, JavaScripts, Pictures, Popups, etc. If you only need the raw data, consider different approach. E.g. using <a href="https://en.wikipedia.org/wiki/XMLHttpRequest" target="_blank" rel="noopener noreferrer">XML HTTPRequest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. More about this in another example.</p> <h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li>expression.CreateObject(ObjectName)</li> <li>expression; Required. An expression that returns an Application object.</li> <li>ObjectName; Required String. The class name of the object to create. For information about valid class names, see OLE Programmatic Identifiers.</li></ul> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <li><a href="https://msdn.microsoft.com/en-us/library/office/gg251656.aspx" rel="nofollow noreferrer">MSDN-Understanding
Automation</a></li> <blockquote></blockquote> <p>When an application supports Automation, the objects the application exposes can be accessed by Visual Basic. Use Visual Basic to manipulate these objects by invoking methods on the object or by getting and setting the object's properties.</p> <ul><li><a href="https://msdn.microsoft.com/en-us/library/office/gg264402.aspx" target="_blank" rel="noopener noreferrer">MSDN-Check or Add an Object Library Reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <blockquote></blockquote> <p>If you use the objects in other applications as part of your Visual Basic application, you may want to establish a reference to the object libraries of those applications. Before you can do that, you must first be sure that the application provides an object library.</p> <ul><li><a href="https://msdn.microsoft.com/en-us/library/office/gg251371.aspx" target="_blank" rel="noopener noreferrer">MSDN-References Dialog Box<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <blockquote></blockquote> <p>Allows you to select another application's objects that you want available in your code by setting a reference to that application's object library.</p> <ul><li><a href="https://msdn.microsoft.com/en-us/library/office/aa220083(v=office.11).aspx" target="_blank" rel="noopener noreferrer">MSDN-CreateObject Method<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <blockquote></blockquote> <p>Creates an Automation object of the specified class. If the application is already running, CreateObject will create a new instance.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/automation-or-using-other-applications-libraries.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/api-calls.html" class="prev">
        API Calls
      </a></span> <span class="next"><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html">
        Macro security and signing of VBA-projects/-modules
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3406.eac1cfae.js" defer></script>
  </body>
</html>
