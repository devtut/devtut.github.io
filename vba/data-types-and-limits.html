<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - Data Types and Limits</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Variant, Boolean, String, Byte, Currency, Decimal, Integer, Long, Single, Double, Date, LongLong, LongPtr">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - Data Types and Limits">
    <meta property="og:description" content="Variant, Boolean, String, Byte, Currency, Decimal, Integer, Long, Single, Double, Date, LongLong, LongPtr">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/data-types-and-limits.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - Data Types and Limits">
    <meta name="twitter:description" content="Variant, Boolean, String, Byte, Currency, Decimal, Integer, Long, Single, Double, Date, LongLong, LongPtr">
    <meta name="twitter:url" content="/vba/data-types-and-limits.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3418.e0135b47.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" aria-current="page" class="active sidebar-link">Data Types and Limits</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#variant" class="sidebar-link">Variant</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#boolean" class="sidebar-link">Boolean</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#string" class="sidebar-link">String</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#byte" class="sidebar-link">Byte</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#currency" class="sidebar-link">Currency</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#decimal" class="sidebar-link">Decimal</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#integer" class="sidebar-link">Integer</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#long" class="sidebar-link">Long</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#single" class="sidebar-link">Single</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#double" class="sidebar-link">Double</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#date" class="sidebar-link">Date</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#longlong" class="sidebar-link">LongLong</a></li><li class="sidebar-sub-header"><a href="/vba/data-types-and-limits.html#longptr" class="sidebar-link">LongPtr</a></li></ul></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="data-types-and-limits"><a href="#data-types-and-limits" class="header-anchor">#</a> Data Types and Limits</h1> <h2 id="variant"><a href="#variant" class="header-anchor">#</a> Variant</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">Variant</span>    <span class="token comment">'Explicit</span>
<span class="token keyword">Dim</span> Value               <span class="token comment">'Implicit</span>

</code></pre></div><p>A Variant is a COM data type that is used for storing and exchanging values of arbitrary types, and any other type in VBA can be assigned to a Variant. Variables declared without an explicit type specified by <code>As [Type]</code> default to Variant.</p> <p>Variants are stored in memory as a <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms221627(v=vs.85).aspx" target="_blank" rel="noopener noreferrer">VARIANT structure<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> that consists of a byte type descriptor (<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms221170(v=vs.85).aspx" target="_blank" rel="noopener noreferrer">VARTYPE<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) followed by 6 reserved bytes then an 8 byte data area.  For numeric types (including Date and Boolean), the underlying value is stored in the Variant itself.  For all other types, the data area contains a pointer to the underlying value.</p> <p><a href="https://i.stack.imgur.com/RFvAd.png" target="_blank" rel="noopener noreferrer"><img src="https://i.stack.imgur.com/RFvAd.png" alt="enter image description here"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>The underlying type of a Variant can be determined with either the <code>VarType()</code> function which returns the numeric value stored in the type descriptor, or the <code>TypeName()</code> function which returns the string representation:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Example <span class="token keyword">As</span> <span class="token keyword">Variant</span>
Example <span class="token operator">=</span> <span class="token number">42</span>
Debug<span class="token punctuation">.</span>Print VarType<span class="token punctuation">(</span>Example<span class="token punctuation">)</span>    <span class="token comment">'Prints 2 (VT_I2)</span>
Debug<span class="token punctuation">.</span>Print TypeName<span class="token punctuation">(</span>Example<span class="token punctuation">)</span>   <span class="token comment">'Prints &quot;Integer&quot;</span>
Example <span class="token operator">=</span> <span class="token string">&quot;Some text&quot;</span>
Debug<span class="token punctuation">.</span>Print VarType<span class="token punctuation">(</span>Example<span class="token punctuation">)</span>    <span class="token comment">'Prints 8 (VT_BSTR)</span>
Debug<span class="token punctuation">.</span>Print TypeName<span class="token punctuation">(</span>Example<span class="token punctuation">)</span>   <span class="token comment">'Prints &quot;String&quot;</span>

</code></pre></div><p>Because Variants can store values of any type, assignments from literals without <a href="http://stackoverflow.com/documentation/vba/877/declaring-variables/2960/type-hints#t=201607241827067193123" target="_blank" rel="noopener noreferrer">type hints<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> will be implicitly cast to a Variant of the appropriate type according to the table below. Literals with type hints will be cast to a Variant of the hinted type.</p> <table><thead><tr><th>Value</th> <th>Resulting type</th></tr></thead> <tbody><tr><td>String values</td> <td>String</td></tr> <tr><td>Non-floating point numbers in Integer range</td> <td>Integer</td></tr> <tr><td>Non-floating point numbers in Long range</td> <td>Long</td></tr> <tr><td>Non-floating point numbers outside of Long range</td> <td>Double</td></tr> <tr><td>All floating point numbers</td> <td>Double</td></tr></tbody></table> <p><strong>Note:</strong> Unless there is a specific reason to use a Variant (i.e. an iterator in a For Each loop or an API requirement), the type should generally be avoided for routine tasks for the following reasons:</p> <ul><li>They are not type safe, increasing the possibility of runtime errors. For example, a Variant holding an Integer value will silently change itself into a Long instead of overflowing.</li> <li>They introduce processing overhead by requiring at least one additional pointer dereference.
</li><li>The memory requirement for a Variant is always <strong><strong>at least</strong></strong> 8 bytes
higher than needed to store the underlying type.</li></ul> <p>The casting function to convert to a Variant is <code>CVar()</code>.</p> <h2 id="boolean"><a href="#boolean" class="header-anchor">#</a> Boolean</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">Boolean</span>

</code></pre></div><p>A Boolean is used to store values that can be represented as either True or False.  Internally, the data type is stored as a 16 bit value with 0 representing False and any other value representing True.</p> <p>It should be noted that when a Boolean is cast to a numeric type, all of the bits are set to 1.  This results in an internal representation of -1 for signed types and the maximum value for an unsigned type (Byte).</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Example <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
Example <span class="token operator">=</span> <span class="token boolean">True</span>
Debug<span class="token punctuation">.</span>Print <span class="token keyword">CInt</span><span class="token punctuation">(</span>Example<span class="token punctuation">)</span>  <span class="token comment">'Prints -1</span>
Debug<span class="token punctuation">.</span>Print <span class="token keyword">CBool</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>      <span class="token comment">'Prints True</span>
Debug<span class="token punctuation">.</span>Print <span class="token keyword">CByte</span><span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token comment">'Prints 255</span>

</code></pre></div><p>The casting function to convert to a Boolean is <code>CBool()</code>. Even though it is represented internally as a 16 bit number, casting to a Boolean from values outside of that range is safe from overflow, although it sets all 16 bits to 1:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Example <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
Example <span class="token operator">=</span> <span class="token keyword">CBool</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">^</span> <span class="token number">17</span><span class="token punctuation">)</span>
Debug<span class="token punctuation">.</span>Print <span class="token keyword">CInt</span><span class="token punctuation">(</span>Example<span class="token punctuation">)</span>   <span class="token comment">'Prints -1</span>
Debug<span class="token punctuation">.</span>Print <span class="token keyword">CByte</span><span class="token punctuation">(</span>Example<span class="token punctuation">)</span>  <span class="token comment">'Prints 255</span>

</code></pre></div><h2 id="string"><a href="#string" class="header-anchor">#</a> String</h2> <p>A String represents a sequence of characters, and comes in two flavors:</p> <h3 id="variable-length"><a href="#variable-length" class="header-anchor">#</a> <strong>Variable length</strong></h3> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">String</span>

</code></pre></div><p>A variable length String allows appending and truncation and is stored in memory as a COM <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms221069(v=vs.85).aspx" target="_blank" rel="noopener noreferrer">BSTR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. This consists of a 4 byte unsigned integer that stores the length of the String in bytes followed by the string data itself as wide characters (2 bytes per character) and terminated with 2 null bytes. Thus, the maximum string length that can be handled by VBA is 2,147,483,647 characters.</p> <p>The internal pointer to the structure (retrievable by the <code>StrPtr()</code> function) points to the memory location of the <strong>data</strong>, not the length prefix. This means that a VBA String can be passed directly API functions that require a pointer to a character array.</p> <p>Because the length can change, VBA reallocates memory for a String <strong>every time the variable is assigned to</strong>, which can impose performance penalties for procedures that alter them repeatedly.</p> <h3 id="fixed-length"><a href="#fixed-length" class="header-anchor">#</a> <strong>Fixed length</strong></h3> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">*</span> <span class="token number">1024</span>    <span class="token comment">'Declares a fixed length string of 1024 characters.</span>

</code></pre></div><p>Fixed length strings are allocated 2 bytes for each character and are stored in memory as a simple byte array. Once allocated, the length of the String is immutable. They are <strong><strong>not</strong></strong> null terminated in memory, so a string that fills the memory allocated with non-null characters is unsuitable for passing to API functions expecting a null terminated string.</p> <p>Fixed length strings carry over a legacy 16 bit index limitation, so can only be up to 65,535 characters in length. Attempting to assign a value longer than the available memory space will not result in a runtime error - instead the resulting value will simply be truncated:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Foobar <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">*</span> <span class="token number">5</span>
Foobar <span class="token operator">=</span> <span class="token string">&quot;Foo&quot;</span> <span class="token operator">&amp;</span> <span class="token string">&quot;bar&quot;</span>
Debug<span class="token punctuation">.</span>Print Foobar          <span class="token comment">'Prints &quot;Fooba&quot;</span>

</code></pre></div><p>The casting function to convert to a String of either type is <code>CStr()</code>.</p> <h2 id="byte"><a href="#byte" class="header-anchor">#</a> Byte</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">Byte</span>

</code></pre></div><p>A Byte is an unsigned 8 bit data type. It can represent integer numbers between 0 and 255 and attempting to store a value outside of that range will result in <a href="https://msdn.microsoft.com/en-us/library/aa264525" target="_blank" rel="noopener noreferrer">runtime error 6: <code>Overflow</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.  Byte is the only intrinsic unsigned type available in VBA.</p> <p>The casting function to convert to a Byte is <a href="https://msdn.microsoft.com/en-us/library/office/gg278896.aspx" target="_blank" rel="noopener noreferrer"><code>CByte()</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. For casts from floating point types, the result is rounded to the nearest integer value with .5 rounding up.</p> <p><strong>Byte Arrays and Strings</strong></p> <p>Strings and byte arrays can be substituted for one another through simple assignment (no conversion functions necessary).</p> <p>For example:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> ByteToStringAndBack<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">Dim</span> str <span class="token keyword">As</span> <span class="token keyword">String</span>
str <span class="token operator">=</span> <span class="token string">&quot;Hello, World!&quot;</span>

<span class="token keyword">Dim</span> byt<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Byte</span>
byt <span class="token operator">=</span> str

Debug<span class="token punctuation">.</span>Print byt<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">' 72</span>

<span class="token keyword">Dim</span> str2 <span class="token keyword">As</span> <span class="token keyword">String</span>
str2 <span class="token operator">=</span> byt

Debug<span class="token punctuation">.</span>Print str2    <span class="token comment">' Hello, World!</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>In order to be able to encode <a href="http://unicode.org/" target="_blank" rel="noopener noreferrer">Unicode<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> characters, each character in the string takes up two bytes in the array, with the least significant byte first. For example:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> UnicodeExample<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">Dim</span> str <span class="token keyword">As</span> <span class="token keyword">String</span>
str <span class="token operator">=</span> ChrW<span class="token punctuation">(</span><span class="token number">&amp;H2123</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;.&quot;</span>  <span class="token comment">' Versicle character and a dot</span>

<span class="token keyword">Dim</span> byt<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Byte</span>
byt <span class="token operator">=</span> str

Debug<span class="token punctuation">.</span>Print byt<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> byt<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> byt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> byt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment">' Prints: 35,33,46,0</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="currency"><a href="#currency" class="header-anchor">#</a> Currency</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">Currency</span>

</code></pre></div><p>A Currency is a signed 64 bit floating point data type similar to a <a href="http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11781/double" target="_blank" rel="noopener noreferrer">Double<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, but scaled by 10,000 to give greater precision to the 4 digits to the right of the decimal point. A Currency variable can store values from -922,337,203,685,477.5808 to 922,337,203,685,477.5807, giving it the largest capacity of any intrinsic type in a 32 bit application. As the name of the data type implies, it is considered best practice to use this data type when representing monetary calculations as the scaling helps to avoid rounding errors.</p> <p>The casting function to convert to a Currency is <code>CCur()</code>.</p> <h2 id="decimal"><a href="#decimal" class="header-anchor">#</a> Decimal</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">Variant</span>
Value <span class="token operator">=</span> <span class="token keyword">CDec</span><span class="token punctuation">(</span><span class="token number">1.234</span><span class="token punctuation">)</span>

<span class="token comment">'Set Value to the smallest possible Decimal value</span>
Value <span class="token operator">=</span> <span class="token keyword">CDec</span><span class="token punctuation">(</span><span class="token string">&quot;0.0000000000000000000000000001&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>The <code>Decimal</code> data-type is <strong>only</strong> available as a sub-type of <code>Variant</code>, so you must declare any variable that needs to contain a <code>Decimal</code> as a <code>Variant</code> and <strong>then</strong> assign a <code>Decimal</code> value using the <code>CDec</code> function. The keyword <code>Decimal</code> is a reserved word (which suggests that VBA was eventually going to add first-class support for the type), so <code>Decimal</code> cannot be used as a variable or procedure name.</p> <p>The <code>Decimal</code> type requires 14 bytes of memory (in addition to the bytes required by the parent Variant)     and can store numbers with up to 28 decimal places. For numbers without any decimal places, the range of allowed values is -79,228,162,514,264,337,593,543,950,335 to +79,228,162,514,264,337,593,543,950,335 inclusive.  For numbers with the maximum 28 decimal places, the range of allowed values is -7.9228162514264337593543950335 to +7.9228162514264337593543950335 inclusive.</p> <h2 id="integer"><a href="#integer" class="header-anchor">#</a> Integer</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">Integer</span>

</code></pre></div><p>An Integer is a signed 16 bit data type. It can store integer numbers in the range of -32,768 to 32,767 and attempting to store a value outside of that range will result in runtime error 6: Overflow.</p> <p>Integers are stored in memory as <a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener noreferrer">little-endian<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> values with negatives represented as a <a href="https://en.wikipedia.org/wiki/Two%27s_complement" target="_blank" rel="noopener noreferrer">two's complement<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Note that in general, it is better practice to use a <a href="http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11779/long" target="_blank" rel="noopener noreferrer">Long<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> rather than an Integer unless the smaller type is a member of a Type or is required (either by an API calling convention or some other reason) to be 2 bytes. In most cases VBA treats Integers as 32 bit internally, so there is usually no advantage to using the smaller type. Additionally, there is a performance penalty incurred every time an Integer type is used as it is silently cast as a Long.</p> <p>The casting function to convert to an Integer is <code>CInt()</code>. For casts from floating point types, the result is rounded to the nearest integer value with .5 rounding up.</p> <h2 id="long"><a href="#long" class="header-anchor">#</a> Long</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">Long</span>

</code></pre></div><p>A Long is a signed 32 bit data type. It can store integer numbers in the range of -2,147,483,648 to 2,147,483,647 and attempting to store a value outside of that range will result in runtime error 6: Overflow.</p> <p>Longs are stored in memory as <a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener noreferrer">little-endian<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> values with negatives represented as a <a href="https://en.wikipedia.org/wiki/Two%27s_complement" target="_blank" rel="noopener noreferrer">two's complement<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Note that since a Long matches the width of a pointer in a 32 bit operating system, Longs are commonly used for storing and passing pointers to and from API functions.</p> <p>The casting function to convert to a Long is <code>CLng()</code>. For casts from floating point types, the result is rounded to the nearest integer value with .5 rounding up.</p> <h2 id="single"><a href="#single" class="header-anchor">#</a> Single</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">Single</span>

</code></pre></div><p>A Single is a signed 32 bit floating point data type. It is stored internally using a <a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener noreferrer">little-endian<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://en.wikipedia.org/wiki/Single-precision_floating-point_format" target="_blank" rel="noopener noreferrer">IEEE 754<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> memory layout.  As such, there is not a fixed range of values that can be represented by the data type - what is limited is the precision of value stored.  A Single can store a value <strong><strong>integer</strong></strong> values in the range of -16,777,216 to 16,777,216 without a loss of precision. The precision of floating point numbers depends on the exponent.</p> <p>A Single will overflow if assigned a value greater than roughly 2<sup>128</sup>. It will not overflow with negative exponents, although the usable precision will be questionable before the upper limit is reached.</p> <p>As with all floating point numbers, care should be taken when making equality comparisons. Best practice is to include a delta value appropriate to the required precision.</p> <p>The casting function to convert to a Single is <code>CSng()</code>.</p> <h2 id="double"><a href="#double" class="header-anchor">#</a> Double</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">Double</span>

</code></pre></div><p>A Double is a signed 64 bit floating point data type. Like the <a href="http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11780/single" target="_blank" rel="noopener noreferrer">Single<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, it is stored internally using a <a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener noreferrer">little-endian<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format" target="_blank" rel="noopener noreferrer">IEEE 754<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> memory layout and the same precautions regarding precision should be taken. A Double can store <strong><strong>integer</strong></strong> values in the range of -9,007,199,254,740,992 to 9,007,199,254,740,992 without a loss of precision. The precision of floating point numbers depends on the exponent.</p> <p>A Double will overflow if assigned a value greater than roughly 2<sup>1024</sup>.  It will not overflow with negative exponents, although the usable precision will be questionable before the upper limit is reached.</p> <p>The casting function to convert to a Double is <code>CDbl()</code>.</p> <h2 id="date"><a href="#date" class="header-anchor">#</a> Date</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> <span class="token keyword">Date</span>

</code></pre></div><p>A Date type is represented internally as a signed 64 bit floating point data type with the value to the left of the decimal representing the number of days from the epoch date of December 30<sup>th</sup>, 1899 (although see the note below). The value to the right of the decimal represents the time as a fractional day. Thus, an integer Date would have a time component of 12:00:00AM and x.5 would have a time component of 12:00:00PM.</p> <p>Valid values for Dates are between January 1<sup>st</sup> 100 and December 31<sup>st</sup> 9999. Since a Double has a larger range, it is possible to overflow a Date by assigning values outside of that range.</p> <p>As such, it can be used interchangeably with a <a href="http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11781/double" target="_blank" rel="noopener noreferrer">Double<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for Date calculations:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> MyDate <span class="token keyword">As</span> <span class="token keyword">Double</span>
MyDate <span class="token operator">=</span> <span class="token number">0</span>                                  <span class="token comment">'Epoch date.</span>
Debug<span class="token punctuation">.</span>Print Format<span class="token operator">$</span><span class="token punctuation">(</span>MyDate<span class="token punctuation">,</span> <span class="token string">&quot;yyyy-mm-dd&quot;</span><span class="token punctuation">)</span>   <span class="token comment">'Prints 1899-12-30.</span>
MyDate <span class="token operator">=</span> MyDate <span class="token operator">+</span> <span class="token number">365</span>
Debug<span class="token punctuation">.</span>Print Format<span class="token operator">$</span><span class="token punctuation">(</span>MyDate<span class="token punctuation">,</span> <span class="token string">&quot;yyyy-mm-dd&quot;</span><span class="token punctuation">)</span>   <span class="token comment">'Prints 1900-12-30.</span>

</code></pre></div><p>The casting function to convert to a Date is <code>CDate()</code>, which accepts any numeric type string date/time representation.  It is important to note that string representations of dates will be converted based on the current locale setting in use, so direct casts should be avoided if the code is meant to be portable.</p> <h2 id="longlong"><a href="#longlong" class="header-anchor">#</a> LongLong</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> LongLong

</code></pre></div><p>A LongLong is a signed 64 bit data type and is only available in 64 bit applications. It is <strong>not</strong> available in 32 bit applications running on 64 bit operating systems. It can store integer values in the range of -9,223,372,036,854,775,808 to 9,223,372,036,854,775,807 and attempting to store a value outside of that range will result in runtime error 6: Overflow.</p> <p>LongLongs are stored in memory as <a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener noreferrer">little-endian<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> values with negatives represented as a <a href="https://en.wikipedia.org/wiki/Two%27s_complement" target="_blank" rel="noopener noreferrer">two's complement<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>The LongLong data type was introduced as part of VBA's 64 bit operating system support. In 64 bit applications, this value can be used to store and pass pointers to 64 bit APIs.</p> <p>The casting function to convert to a LongLong is <code>CLngLng()</code>. For casts from floating point types, the result is rounded to the nearest integer value with .5 rounding up.</p> <h2 id="longptr"><a href="#longptr" class="header-anchor">#</a> LongPtr</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> Value <span class="token keyword">As</span> LongPtr

</code></pre></div><p>The LongPtr was introduced into VBA in order to support 64 bit platforms. On a 32 bit system, it is treated as a <a href="http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11779/long" target="_blank" rel="noopener noreferrer">Long<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and on 64 bit systems it is treated as a <a href="http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11785/longlong" target="_blank" rel="noopener noreferrer">LongLong<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>It's primary use is in providing a portable way to store and pass pointers on both architectures (See <a href="http://stackoverflow.com/documentation/vba/3364/conditional-compilation/11557/changing-code-behavior-at-compile-time#t=20160724185822285365" target="_blank" rel="noopener noreferrer">Changing code behavior at compile time<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</p> <p>Although it is treated by the operating system as a memory address when used in API calls, it should be noted that VBA treats it like signed type (and therefore subject to unsigned to signed overflow).  For this reason, any pointer arithmetic performed using LongPtrs should not use <code>&gt;</code> or <code>&lt;</code> comparisons. This &quot;quirk&quot; also makes it possible that adding simple offsets pointing to valid addresses in memory can cause overflow errors, so caution should be taken when working with pointers in VBA.</p> <p>The casting function to convert to a LongPtr is <code>CLngPtr()</code>. For casts from floating point types, the result is rounded to the nearest integer value with .5 rounding up (although since it is usually a memory address, using it as an assignment target for a floating point calculation is dangerous at best).</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/data-types-and-limits.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/date-time-manipulation.html" class="prev">
        Date Time Manipulation
      </a></span> <span class="next"><a href="/vba/naming-conventions.html">
        Naming Conventions
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3418.e0135b47.js" defer></script>
  </body>
</html>
