<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - CreateObject vs. GetObject</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Demonstrating GetObject and CreateObject">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - CreateObject vs. GetObject">
    <meta property="og:description" content="Demonstrating GetObject and CreateObject">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/createobject-vs-getobject.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - CreateObject vs. GetObject">
    <meta name="twitter:description" content="Demonstrating GetObject and CreateObject">
    <meta name="twitter:url" content="/vba/createobject-vs-getobject.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3414.9cf18625.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" aria-current="page" class="active sidebar-link">CreateObject vs. GetObject</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/createobject-vs-getobject.html#demonstrating-getobject-and-createobject" class="sidebar-link">Demonstrating GetObject and CreateObject</a></li></ul></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="createobject-vs-getobject"><a href="#createobject-vs-getobject" class="header-anchor">#</a> CreateObject vs. GetObject</h1> <h2 id="demonstrating-getobject-and-createobject"><a href="#demonstrating-getobject-and-createobject" class="header-anchor">#</a> Demonstrating GetObject and CreateObject</h2> <p><a href="https://msdn.microsoft.com/en-us/library/office/gg251785.aspx" target="_blank" rel="noopener noreferrer">MSDN-GetObject Function<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote></blockquote> <p>Returns a reference to an object provided by an ActiveX component.</p> <blockquote></blockquote> <p>Use the GetObject function when there is a current instance of the object or if you want to create the object with a file already loaded. If there is no current instance, and you don't want the object started with a file loaded, use the CreateObject function.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> CreateVSGet<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> ThisXLApp <span class="token keyword">As</span> Excel<span class="token punctuation">.</span>Application <span class="token comment">'An example of early binding</span>
    <span class="token keyword">Dim</span> AnotherXLApp <span class="token keyword">As</span> <span class="token keyword">Object</span> <span class="token comment">'An example of late binding</span>
    <span class="token keyword">Dim</span> ThisNewWB <span class="token keyword">As</span> Workbook
    <span class="token keyword">Dim</span> AnotherNewWB <span class="token keyword">As</span> Workbook
    <span class="token keyword">Dim</span> wb <span class="token keyword">As</span> Workbook
    
    <span class="token comment">'Get this instance of Excel</span>
    <span class="token keyword">Set</span> ThisXLApp <span class="token operator">=</span> GetObject<span class="token punctuation">(</span>ThisWorkbook<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">.</span>Application
    <span class="token comment">'Create another instance of Excel</span>
    <span class="token keyword">Set</span> AnotherXLApp <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Excel.Application&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">'Make the 2nd instance visible</span>
    AnotherXLApp<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token comment">'Add a workbook to the 2nd instance</span>
    <span class="token keyword">Set</span> AnotherNewWB <span class="token operator">=</span> AnotherXLApp<span class="token punctuation">.</span>Workbooks<span class="token punctuation">.</span>Add
    <span class="token comment">'Add a sheet to the 2nd instance</span>
    AnotherNewWB<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>Add
    
    <span class="token comment">'You should now have 2 instances of Excel open</span>
    <span class="token comment">'The 1st instance has 1 workbook: Book1</span>
    <span class="token comment">'The 2nd instance has 1 workbook: Book2</span>
    
    <span class="token comment">'Lets add another workbook to our 1st instance</span>
    <span class="token keyword">Set</span> ThisNewWB <span class="token operator">=</span> ThisXLApp<span class="token punctuation">.</span>Workbooks<span class="token punctuation">.</span>Add
    <span class="token comment">'Now loop through the workbooks and show their names</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> wb <span class="token keyword">In</span> ThisXLApp<span class="token punctuation">.</span>Workbooks
        Debug<span class="token punctuation">.</span>Print wb<span class="token punctuation">.</span>Name
    <span class="token keyword">Next</span>
    <span class="token comment">'Now the 1st instance has 2 workbooks: Book1 and Book3</span>
    <span class="token comment">'If you close the first instance of Excel,</span>
    <span class="token comment">'Book1 and Book3 will close, but book2 will still be open</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>At its simplest, <code>CreateObject</code> creates an instance of an object whereas <code>GetObject</code> gets an existing instance of an object. Determining whether an object can be created or gotten will depend on it's <a href="https://msdn.microsoft.com/en-us/library/aa242107%28v=vs.60%29.aspx?f=255&amp;MSPPError=-2147217396" target="_blank" rel="noopener noreferrer">Instancing property<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Some objects are SingleUse (eg, WMI) and cannot be created if they already exist. Other objects (eg, Excel) are MultiUse and allow multiple instances to run at once. If an instance of an object does not already exist and you attempt <code>GetObject</code>, you will receive the following trappable message: <code>Run-time error '429': ActiveX component can't create object</code>.</p> <p><strong>GetObject</strong> requires at least one of these two optional parameters to be present:</p> <ol><li><strong>Pathname</strong> - Variant (String): The full path, including filename, of the file containing the object. This parameter is optional, but <strong>Class</strong> is required if <strong>Pathname</strong> is omitted.</li> <li><strong>Class</strong> - Variant (String): A string representing the formal definition (Application and ObjectType) of the object. <strong>Class</strong> is required if <strong>Pathname</strong> is omitted.</li></ol> <p><strong>CreateObject</strong> has one required parameter and one optional parameter:</p> <ol><li><strong>Class</strong>  - Variant (String): A string representing the formal definition (Application and ObjectType) of the object. <strong>Class</strong> is a required parameter.</li> <li><strong>Servername</strong> - Variant (String): The name of the remote computer on which the object will be created. If omitted, the object will be created on the local machine.</li></ol> <p><strong>Class</strong> is always comprised of two parts in the form of <code>Application.ObjectType</code>:</p> <ol><li><strong>Application</strong> - The name of the application which the object is part of. |</li> <li><strong>Object Type</strong> - The type of object being created. |</li></ol> <p>Some example classes are:</p> <ol><li>Word.Application</li> <li>Excel.Sheet</li> <li>Scripting.FileSystemObject</li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/createobject-vs-getobject.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/user-forms.html" class="prev">
        User Forms
      </a></span> <span class="next"><a href="/vba/non-latin-characters.html">
        Non-Latin Characters
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3414.9cf18625.js" defer></script>
  </body>
</html>
