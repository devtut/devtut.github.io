<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VBA - Operators</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Concatenation Operators, Comparison Operators, Mathematical Operators, Bitwise  Logical Operators">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="VBA - Operators">
    <meta property="og:description" content="Concatenation Operators, Comparison Operators, Mathematical Operators, Bitwise  Logical Operators">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vba/operators.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="VBA - Operators">
    <meta name="twitter:description" content="Concatenation Operators, Comparison Operators, Mathematical Operators, Bitwise  Logical Operators">
    <meta name="twitter:url" content="/vba/operators.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3433.d053ad84.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vba/getting-started-with-vba.html" class="sidebar-link">Getting started with VBA</a></li><li><a href="/vba/comments.html" class="sidebar-link">Comments</a></li><li><a href="/vba/string-literals-escaping-non-printable-characters-and-line-continuations.html" class="sidebar-link">String Literals - Escaping, non-printable characters and line-continuations</a></li><li><a href="/vba/vba-option-keyword.html" class="sidebar-link">VBA Option Keyword</a></li><li><a href="/vba/declaring-variables.html" class="sidebar-link">Declaring Variables</a></li><li><a href="/vba/declaring-and-assigning-strings.html" class="sidebar-link">Declaring and assigning strings</a></li><li><a href="/vba/concatenating-strings.html" class="sidebar-link">Concatenating strings</a></li><li><a href="/vba/frequently-used-string-manipulation.html" class="sidebar-link">Frequently used string manipulation</a></li><li><a href="/vba/substrings.html" class="sidebar-link">Substrings</a></li><li><a href="/vba/searching-within-strings-for-the-presence-of-substrings.html" class="sidebar-link">Searching within strings for the presence of substrings</a></li><li><a href="/vba/assigning-strings-with-repeated-characters.html" class="sidebar-link">Assigning strings with repeated characters</a></li><li><a href="/vba/measuring-the-length-of-strings.html" class="sidebar-link">Measuring the length of strings</a></li><li><a href="/vba/converting-other-types-to-strings.html" class="sidebar-link">Converting other types to strings</a></li><li><a href="/vba/date-time-manipulation.html" class="sidebar-link">Date Time Manipulation</a></li><li><a href="/vba/data-types-and-limits.html" class="sidebar-link">Data Types and Limits</a></li><li><a href="/vba/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/vba/data-structures.html" class="sidebar-link">Data Structures</a></li><li><a href="/vba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/vba/copying-returning-and-passing-arrays.html" class="sidebar-link">Copying, returning and passing arrays</a></li><li><a href="/vba/collections.html" class="sidebar-link">Collections</a></li><li><a href="/vba/operators.html" aria-current="page" class="active sidebar-link">Operators</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vba/operators.html#concatenation-operators" class="sidebar-link">Concatenation Operators</a></li><li class="sidebar-sub-header"><a href="/vba/operators.html#comparison-operators" class="sidebar-link">Comparison Operators</a></li><li class="sidebar-sub-header"><a href="/vba/operators.html#mathematical-operators" class="sidebar-link">Mathematical Operators</a></li><li class="sidebar-sub-header"><a href="/vba/operators.html#bitwise-logical-operators" class="sidebar-link">Bitwise \ Logical Operators</a></li></ul></li><li><a href="/vba/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/vba/flow-control-structures.html" class="sidebar-link">Flow control structures</a></li><li><a href="/vba/passing-arguments-byref-or-byval.html" class="sidebar-link">Passing Arguments ByRef or ByVal</a></li><li><a href="/vba/scripting-filesystemobject.html" class="sidebar-link">Scripting.FileSystemObject</a></li><li><a href="/vba/working-with-files-and-directories-without-using-filesystemobject.html" class="sidebar-link">Working With Files and Directories Without Using FileSystemObject</a></li><li><a href="/vba/reading-2gb-files-in-binary-in-vba-and-file-hashes.html" class="sidebar-link">Reading 2GB+ files in binary in VBA and File Hashes</a></li><li><a href="/vba/creating-a-procedure.html" class="sidebar-link">Creating a procedure</a></li><li><a href="/vba/procedure-calls.html" class="sidebar-link">Procedure Calls</a></li><li><a href="/vba/conditional-compilation.html" class="sidebar-link">Conditional Compilation</a></li><li><a href="/vba/object-oriented-vba.html" class="sidebar-link">Object-Oriented VBA</a></li><li><a href="/vba/creating-a-custom-class.html" class="sidebar-link">Creating a Custom Class</a></li><li><a href="/vba/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/vba/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vba/events.html" class="sidebar-link">Events</a></li><li><a href="/vba/scripting-dictionary-object.html" class="sidebar-link">Scripting.Dictionary object</a></li><li><a href="/vba/working-with-ado.html" class="sidebar-link">Working with ADO</a></li><li><a href="/vba/attributes.html" class="sidebar-link">Attributes</a></li><li><a href="/vba/user-forms.html" class="sidebar-link">User Forms</a></li><li><a href="/vba/createobject-vs-getobject.html" class="sidebar-link">CreateObject vs. GetObject</a></li><li><a href="/vba/non-latin-characters.html" class="sidebar-link">Non-Latin Characters</a></li><li><a href="/vba/api-calls.html" class="sidebar-link">API Calls</a></li><li><a href="/vba/automation-or-using-other-applications-libraries.html" class="sidebar-link">Automation or Using other applications Libraries</a></li><li><a href="/vba/macro-security-and-signing-of-vba-projects-modules.html" class="sidebar-link">Macro security and signing of VBA-projects/-modules</a></li><li><a href="/vba/vba-run-time-errors.html" class="sidebar-link">VBA Run-Time Errors</a></li><li><a href="/vba/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="operators"><a href="#operators" class="header-anchor">#</a> Operators</h1> <h2 id="concatenation-operators"><a href="#concatenation-operators" class="header-anchor">#</a> Concatenation Operators</h2> <p>VBA supports 2 different concatenation operators, <code>+</code> and <code>&amp;</code> and both perform the exact same function when used with <code>String</code> types - the right-hand <code>String</code> is appended to the end of the left-hand <code>String</code>.</p> <p>If the <code>&amp;</code> operator is used with a variable type other than a <code>String</code>, it is implicitly cast to a <code>String</code> before being concatenated.</p> <p>Note that the <code>+</code> concatenation operator is an overload of the <code>+</code> addition operator. The behavior of <code>+</code> is determined by the <a href="http://stackoverflow.com/documentation/vba/3418/data-types-and-limits" target="_blank" rel="noopener noreferrer">variable types<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> of the operands and precedence of operator types. If both operands are typed as a <code>String</code> or <code>Variant</code> with a sub-type of <code>String</code>, they are concatenated:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> Example<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> left <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> right <span class="token keyword">As</span> <span class="token keyword">String</span>
    
    left <span class="token operator">=</span> <span class="token string">&quot;5&quot;</span>
    right <span class="token operator">=</span> <span class="token string">&quot;5&quot;</span>
    
    Debug<span class="token punctuation">.</span>Print left <span class="token operator">+</span> right    <span class="token comment">'Prints &quot;55&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>If <strong>either</strong> side is a numeric type and the other side is a <code>String</code> that can be coerced into a number, the type precedence of mathematical operators causes the operator to be treated as the addition operator and the numeric values are added:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> Example<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> left <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">Dim</span> right <span class="token keyword">As</span> <span class="token keyword">String</span>
    
    left <span class="token operator">=</span> <span class="token number">5</span>
    right <span class="token operator">=</span> <span class="token string">&quot;5&quot;</span>
    
    Debug<span class="token punctuation">.</span>Print left <span class="token operator">+</span> right    <span class="token comment">'Prints 10</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>This behavior can lead to subtle, hard to debug errors - especially if <code>Variant</code> types are being used, so only the <code>&amp;</code> operator should typically be used for concatenation.</p> <h2 id="comparison-operators"><a href="#comparison-operators" class="header-anchor">#</a> Comparison Operators</h2> <table><thead><tr><th>Token</th> <th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td><code>=</code></td> <td>Equal to</td> <td>Returns <code>True</code> if the left-hand and right-hand operands are equal. Note that this is an overload of the assignment operator.</td></tr> <tr><td><code>&lt;&gt;</code></td> <td>Not equal to</td> <td>Returns <code>True</code> if the left-hand and right-hand operands are not equal.</td></tr> <tr><td><code>&gt;</code></td> <td>Greater than</td> <td>Returns <code>True</code> if the left-hand operand is greater than the right-hand operand.</td></tr> <tr><td><code>&lt;</code></td> <td>Less than</td> <td>Returns <code>True</code> if the left-hand operand is less than the right-hand operand.</td></tr> <tr><td><code>&gt;=</code></td> <td>Greater than or equal</td> <td>Returns <code>True</code> if the if the left-hand operand is greater than or equal to the right-hand operand.</td></tr> <tr><td><code>&lt;=</code></td> <td>Less than or equal</td> <td>Returns <code>True</code> if the if the left-hand operand is less than or equal to the right-hand operand.</td></tr> <tr><td><code>Is</code></td> <td>Reference equity</td> <td>Returns <code>True</code> if the left-hand object reference is the same instance as the right-hand object reference. It can also be used with <code>Nothing</code> (the null object reference) on either side. <strong>Note:</strong> The <code>Is</code> operator will attempt to coerce both operands into an <code>Object</code> before performing the comparison. If either side is a primitive type <strong>or</strong> a <code>Variant</code> that does not contain an object (either a non-object subtype or <code>vtEmpty</code>), the comparison will result in a Run-time error 424 - &quot;Object required&quot;. If either operand belongs to a different <strong>interface</strong> of the same object, the comparison will return <code>True</code>. If you need to test for equity of both the instance <strong>and</strong> the interface, use <code>ObjPtr(left) = ObjPtr(right)</code> instead.</td></tr></tbody></table> <h3 id="notes"><a href="#notes" class="header-anchor">#</a> Notes</h3> <p>The VBA syntax allows for &quot;chains&quot; of comparison operators, but these constructs should generally be avoided. Comparisons are always performed from left to right on only 2 operands at a time, and each comparison results in a <code>Boolean</code>.  For example, the expression...</p> <div class="language-vb extra-class"><pre class="language-vb"><code>a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">:</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span> c <span class="token operator">=</span> <span class="token number">0</span>
expr <span class="token operator">=</span> a <span class="token operator">&gt;</span> b <span class="token operator">&gt;</span> c

</code></pre></div><p>...may be read in some contexts as a test of whether <code>b</code> is between <code>a</code> and <code>c</code>. In VBA, this evaluates as follows:</p> <div class="language-vb extra-class"><pre class="language-vb"><code>a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">:</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span> c <span class="token operator">=</span> <span class="token number">0</span>
expr <span class="token operator">=</span> a <span class="token operator">&gt;</span> b <span class="token operator">&gt;</span> c
expr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
expr <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
expr <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token comment">'CInt(True) = -1</span>
expr <span class="token operator">=</span> <span class="token boolean">False</span>

</code></pre></div><p>Any comparison operator other than <code>Is</code> used with an <code>Object</code> as an operand will be performed on the return value of the <code>Object</code>'s <a href="http://stackoverflow.com/documentation/vba/5321/attributes/18935/vb-varusermemid#t=201609050127168622955" target="_blank" rel="noopener noreferrer">default member<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. If the object does not have a default member, the comparison will result in a Run-time error 438 - &quot;Object doesn't support his property or method&quot;.</p> <p>If the <code>Object</code> is unintitialized, the comparison will result in a Run-time error 91 - &quot;Object variable or With block variable not set&quot;.</p> <p>If the literal <code>Nothing</code> is used with any comparison operator other than <code>Is</code>, it will result in a Compile error - &quot;Invalid use of object&quot;.</p> <p>If the default member of the <code>Object</code> is <strong>another <code>Object</code></strong>, VBA will continually call the default member of each successive return value until a primitive type is returned or an error is raised.  For example, assume <code>SomeClass</code> has a default member of <code>Value</code>, which is an instance of <code>ChildClass</code> with a default member of <code>ChildValue</code>.  The comparison...</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Set</span> x <span class="token operator">=</span> <span class="token keyword">New</span> SomeClass
Debug<span class="token punctuation">.</span>Print x <span class="token operator">&gt;</span> <span class="token number">42</span>

</code></pre></div><p>...will be evaluated as:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Set</span> x <span class="token operator">=</span> <span class="token keyword">New</span> SomeClass
Debug<span class="token punctuation">.</span>Print x<span class="token punctuation">.</span>Value<span class="token punctuation">.</span>ChildValue <span class="token operator">&gt;</span> <span class="token number">42</span>

</code></pre></div><p>If either operand is a numeric type and the <strong>other</strong> operand is a <code>String</code> or <code>Variant</code> of subtype <code>String</code>, a numeric comparison will be performed.  In this case, if the <code>String</code> cannot be cast to a number, a Run-time error 13 - &quot;Type mismatch&quot; will result from the comparison.</p> <p>If <strong><strong>both</strong></strong> operands are a <code>String</code> or a <code>Variant</code> of subtype <code>String</code>, a string comparison will be performed based on the <a href="http://stackoverflow.com/documentation/vba/3992/vba-option-keyword/13937/option-compare-binary-text-database#t=201609050200481956772" target="_blank" rel="noopener noreferrer">Option Compare<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> setting of the code module. These comparisons are performed on a character by character basis.  Note that the <strong>character representation</strong> of a <code>String</code> containing a number is <strong><strong>not</strong></strong> the same as a comparison of the numeric values:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> Example<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> left <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">Dim</span> right <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    
    left <span class="token operator">=</span> <span class="token string">&quot;42&quot;</span>
    right <span class="token operator">=</span> <span class="token string">&quot;5&quot;</span>
    Debug<span class="token punctuation">.</span>Print left <span class="token operator">&gt;</span> right              <span class="token comment">'Prints False</span>
    Debug<span class="token punctuation">.</span>Print Val<span class="token punctuation">(</span>left<span class="token punctuation">)</span> <span class="token operator">&gt;</span> Val<span class="token punctuation">(</span>right<span class="token punctuation">)</span>    <span class="token comment">'Prints True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>For this reason, make sure that <code>String</code> or <code>Variant</code> variables are cast to numbers before performing numeric inequity comparisons on them.</p> <p>If one operand is a <code>Date</code>, a numeric comparison on the underlying <a href="http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11783/date#t=201612081745238885533" target="_blank" rel="noopener noreferrer">Double<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> value will be performed if the other operand is numeric or can be cast to a numeric type.</p> <p>If the other operand is a <code>String</code> or a <code>Variant</code> of subtype <code>String</code> that can be cast to a <code>Date</code> using the current locale, the <code>String</code> will be cast to a <code>Date</code>.  If it cannot be cast to a <code>Date</code> in the current locale, a Run-time error 13 - &quot;Type mismatch&quot; will result from the comparison.</p> <p>Care should be taken when making comparisons between <code>Double</code> or <code>Single</code> values and <a href="http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11778/boolean#t=201612081745238885533" target="_blank" rel="noopener noreferrer">Booleans<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Unlike other numeric types, non-zero values cannot be assumed to be <code>True</code> due to VBA's behavior of promoting the data type of a comparison involving a floating point number to <code>Double</code>:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> Example<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> Test <span class="token keyword">As</span> <span class="token keyword">Double</span>
    
    Test <span class="token operator">=</span> <span class="token number">42</span>        Debug<span class="token punctuation">.</span>Print <span class="token keyword">CBool</span><span class="token punctuation">(</span>Test<span class="token punctuation">)</span>             <span class="token comment">'Prints True.</span>
    <span class="token comment">'True is promoted to Double - Test is not cast to Boolean</span>
    Debug<span class="token punctuation">.</span>Print Test <span class="token operator">=</span> <span class="token boolean">True</span>             <span class="token comment">'Prints False</span>
    
    <span class="token comment">'With explicit casts:</span>
    Debug<span class="token punctuation">.</span>Print <span class="token keyword">CBool</span><span class="token punctuation">(</span>Test<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token boolean">True</span>      <span class="token comment">'Prints True</span>
    Debug<span class="token punctuation">.</span>Print <span class="token keyword">CDbl</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">CDbl</span><span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>   <span class="token comment">'Prints True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="mathematical-operators"><a href="#mathematical-operators" class="header-anchor">#</a> Mathematical Operators</h2> <p>Listed in order of precedence:</p> <table><thead><tr><th>Token</th> <th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td><code>^</code></td> <td>Exponentiation</td> <td>Return the result of raising the left-hand operand to the power of the right-hand operand. Note that the value returned by exponentiation is <strong>always</strong> a <code>Double</code>, regardless of the value types being divided.  Any coercion of the result into a variable type takes place <strong><strong>after</strong></strong> the calculation is performed.</td></tr> <tr><td><code>/</code></td> <td>Division<sup>1</sup></td> <td>Returns the result of dividing the left-hand operand by the right-hand operand. Note that the value returned by division is <strong>always</strong> a <code>Double</code>, regardless of the value types being divided.  Any coercion of the result into a variable type takes place <strong><strong>after</strong></strong> the calculation is performed.</td></tr> <tr><td><code>*</code></td> <td>Multiplication<sup>1</sup></td> <td>Returns the product of 2 operands.</td></tr> <tr><td><code>\</code></td> <td>Integer Division</td> <td>Returns the integer result of dividing the left-hand operand by the right-hand operand <strong><strong>after</strong></strong> rounding both sides with .5 rounding down. Any remainder of the division is ignored. If the right-hand operand (the divisor) is <code>0</code>, a Run-time error  11: Division by zero will result.  Note that this is <strong><strong>after</strong></strong> all rounding  is performed - expressions such as <code>3 \ 0.4</code> will also result in a division by zero error.</td></tr> <tr><td><code>Mod</code></td> <td>Modulo</td> <td>Returns the integer remainder of dividing the left-hand operand by the right-hand operand. The operand on each side is rounded to an integer <strong>before</strong> the division, with .5 rounding down.  For example, both <code>8.6 Mod 3</code> and <code>12 Mod 2.6</code> result in <code>0</code>. If the right-hand operand (the divisor) is <code>0</code>, a Run-time error  11: Division by zero will result.  Note that this is <strong><strong>after</strong></strong> all rounding  is performed - expressions such as <code>3 Mod 0.4</code> will also result in a division by zero error.</td></tr> <tr><td><code>-</code></td> <td>Subtraction<sup>2</sup></td> <td>Returns the result of subtracting the right-hand operand from the left-hand operand.</td></tr> <tr><td><code>+</code></td> <td>Addition<sup>2</sup></td> <td>Returns the sum of 2 operands. Note that this token also treated as a concatenation operator when it is applied to a <code>String</code>. See <strong>Concatenation Operators</strong>.</td></tr></tbody></table> <p><sup>1</sup> Multiplication and division are treated as having the same precedence.</p> <p><sup>2</sup> Addition and subtraction are treated as having the same precedence.</p> <h2 id="bitwise-logical-operators"><a href="#bitwise-logical-operators" class="header-anchor">#</a> Bitwise \ Logical Operators</h2> <p>All of the logical operators in VBA can be thought of as &quot;overrides&quot; of the bitwise operators of the same name.  Technically, they are <strong>always</strong> treated as bitwise operators. All of the comparison operators in VBA return a <a href="http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11778/boolean#t=201609050243474000752" target="_blank" rel="noopener noreferrer">Boolean<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which will always have none of its bits set (<code>False</code>) or <strong>all</strong> of its bits set (<code>True</code>). But it will treat a value with <strong>any</strong> bit set as <code>True</code>. This means that the result of the casting the bitwise result of an expression to a <code>Boolean</code> (see Comparison Operators) will always be the same as treating it as a logical expression.</p> <p>Assigning the result of an expression using one of these operators will give the bitwise result. Note that in the truth tables below, <code>0</code> is equivalent to <code>False</code> and <code>1</code> is equivalent to <code>True</code>.</p> <p><code>And</code></p> <p>Returns <code>True</code> if the expressions on both sides evaluate to <code>True</code>.</p> <table><thead><tr><th>Left-hand Operand</th> <th>Right-hand Operand</th> <th>Result</th></tr></thead> <tbody><tr><td>0</td> <td>0</td> <td>0</td></tr> <tr><td>0</td> <td>1</td> <td>0</td></tr> <tr><td>1</td> <td>0</td> <td>0</td></tr> <tr><td>1</td> <td>1</td> <td>1</td></tr></tbody></table> <p><code>Or</code></p> <p>Returns <code>True</code> if either side of the expression evaluates to <code>True</code>.</p> <table><thead><tr><th>Left-hand Operand</th> <th>Right-hand Operand</th> <th>Result</th></tr></thead> <tbody><tr><td>0</td> <td>0</td> <td>0</td></tr> <tr><td>0</td> <td>1</td> <td>1</td></tr> <tr><td>1</td> <td>0</td> <td>1</td></tr> <tr><td>1</td> <td>1</td> <td>1</td></tr></tbody></table> <p><code>Not</code></p> <p>Returns <code>True</code> if the expression evaluates to <code>False</code> and <code>False</code> if the expression evaluations to <code>True</code>.</p> <table><thead><tr><th>Right-hand Operand</th> <th>Result</th></tr></thead> <tbody><tr><td>0</td> <td>1</td></tr> <tr><td>1</td> <td>0</td></tr></tbody></table> <p><code>Not</code> is the only operand without a Left-hand operand.  The Visual Basic Editor will automatically simplify expressions with a left hand argument.  If you type...</p> <div class="language-vb extra-class"><pre class="language-vb"><code>Debug<span class="token punctuation">.</span>Print x <span class="token keyword">Not</span> y

</code></pre></div><p>...the VBE will change the line to:</p> <div class="language-vb extra-class"><pre class="language-vb"><code>Debug<span class="token punctuation">.</span>Print <span class="token keyword">Not</span> x

</code></pre></div><p>Similar simplifications will be made to any expression that contains a left-hand operand (including expressions) for <code>Not</code>.</p> <p><code>Xor</code></p> <p>Also known as &quot;exclusive or&quot;. Returns <code>True</code> if both expressions evaluate to different results.</p> <table><thead><tr><th>Left-hand Operand</th> <th>Right-hand Operand</th> <th>Result</th></tr></thead> <tbody><tr><td>0</td> <td>0</td> <td>0</td></tr> <tr><td>0</td> <td>1</td> <td>1</td></tr> <tr><td>1</td> <td>0</td> <td>1</td></tr> <tr><td>1</td> <td>1</td> <td>0</td></tr></tbody></table> <p>Note that although the <code>Xor</code> operator can be <strong>used</strong> like a logical operator, there is absolutely no reason to do so as it gives the same result as the comparison operator <code>&lt;&gt;</code>.</p> <p><code>Eqv</code></p> <p>Also known as &quot;equivalence&quot;.  Returns <code>True</code> when both expressions evaluate to the same result.</p> <table><thead><tr><th>Left-hand Operand</th> <th>Right-hand Operand</th> <th>Result</th></tr></thead> <tbody><tr><td>0</td> <td>0</td> <td>1</td></tr> <tr><td>0</td> <td>1</td> <td>0</td></tr> <tr><td>1</td> <td>0</td> <td>0</td></tr> <tr><td>1</td> <td>1</td> <td>1</td></tr></tbody></table> <p>Note that the <code>Eqv</code> function is <strong>very</strong> rarely used as <code>x Eqv y</code> is equivalent to the much more readable <code>Not (x Xor y)</code>.</p> <p><code>Imp</code></p> <p>Also known as &quot;implication&quot;. Returns <code>True</code> if both operands are the same <strong>or</strong> the second operand is <code>True</code>.</p> <table><thead><tr><th>Left-hand Operand</th> <th>Right-hand Operand</th> <th>Result</th></tr></thead> <tbody><tr><td>0</td> <td>0</td> <td>1</td></tr> <tr><td>0</td> <td>1</td> <td>1</td></tr> <tr><td>1</td> <td>0</td> <td>0</td></tr> <tr><td>1</td> <td>1</td> <td>1</td></tr></tbody></table> <p>Note that the <code>Imp</code> function is very rarely used. A good rule of thumb is that if you can't explain what it means, you should use another construct.</p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>Operators are evaluated in the following order:</p> <ul><li>Mathematical operators</li> <li>Bitwise operators</li> <li>Concatenation operators</li> <li>Comparison operators</li> <li>Logical operators</li></ul> <p>Operators with matching precedence are evaluated from left to right. The default order can be overridden by using parentheses <code>(</code> and <code>)</code> to group expressions.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vba/operators.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vba/collections.html" class="prev">
        Collections
      </a></span> <span class="next"><a href="/vba/sorting.html">
        Sorting
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3433.d053ad84.js" defer></script>
  </body>
</html>
