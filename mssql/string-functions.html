<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Microsoft SQL Server - String Functions</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Quotename, Replace, Substring, String_Split, Left, Right, Soundex, Format, String_escape, ASCII, Char, Concat, LTrim, RTrim, PatIndex, Space, Difference, Len, Lower, Upper, Unicode, NChar, Reverse, Replicate, Str, CharIndex">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Microsoft SQL Server - String Functions">
    <meta property="og:description" content="Quotename, Replace, Substring, String_Split, Left, Right, Soundex, Format, String_escape, ASCII, Char, Concat, LTrim, RTrim, PatIndex, Space, Difference, Len, Lower, Upper, Unicode, NChar, Reverse, Replicate, Str, CharIndex">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/mssql/string-functions.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Microsoft SQL Server - String Functions">
    <meta name="twitter:description" content="Quotename, Replace, Substring, String_Split, Left, Right, Soundex, Format, String_escape, ASCII, Char, Concat, LTrim, RTrim, PatIndex, Space, Difference, Len, Lower, Upper, Unicode, NChar, Reverse, Replicate, Str, CharIndex">
    <meta name="twitter:url" content="/mssql/string-functions.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2068.ee55c38b.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MS SQL Server</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mssql/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/mssql/getting-started-with-microsoft-sql-server.html" class="sidebar-link">Getting started with Microsoft SQL Server</a></li><li><a href="/mssql/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/mssql/converting-data-types.html" class="sidebar-link">Converting data types</a></li><li><a href="/mssql/user-defined-table-types.html" class="sidebar-link">User Defined Table Types</a></li><li><a href="/mssql/select-statement.html" class="sidebar-link">SELECT statement</a></li><li><a href="/mssql/alias-names-in-sql-server.html" class="sidebar-link">Alias Names in Sql Server</a></li><li><a href="/mssql/nulls.html" class="sidebar-link">NULLs</a></li><li><a href="/mssql/variables.html" class="sidebar-link">Variables</a></li><li><a href="/mssql/dates.html" class="sidebar-link">Dates</a></li><li><a href="/mssql/generating-a-range-of-dates.html" class="sidebar-link">Generating a range of dates</a></li><li><a href="/mssql/database-snapshots.html" class="sidebar-link">Database Snapshots</a></li><li><a href="/mssql/coalesce.html" class="sidebar-link">COALESCE</a></li><li><a href="/mssql/if-else.html" class="sidebar-link">IF...ELSE</a></li><li><a href="/mssql/case-statement.html" class="sidebar-link">CASE Statement</a></li><li><a href="/mssql/insert-into.html" class="sidebar-link">INSERT INTO</a></li><li><a href="/mssql/drop-keyword.html" class="sidebar-link">Drop Keyword</a></li><li><a href="/mssql/merge.html" class="sidebar-link">MERGE</a></li><li><a href="/mssql/create-view.html" class="sidebar-link">CREATE VIEW</a></li><li><a href="/mssql/views.html" class="sidebar-link">Views</a></li><li><a href="/mssql/union.html" class="sidebar-link">UNION</a></li><li><a href="/mssql/try-catch.html" class="sidebar-link">TRY/CATCH</a></li><li><a href="/mssql/while-loop.html" class="sidebar-link">WHILE loop</a></li><li><a href="/mssql/over-clause.html" class="sidebar-link">OVER Clause</a></li><li><a href="/mssql/group-by.html" class="sidebar-link">GROUP BY</a></li><li><a href="/mssql/order-by.html" class="sidebar-link">ORDER BY</a></li><li><a href="/mssql/the-stuff-function.html" class="sidebar-link">The STUFF Function</a></li><li><a href="/mssql/json-in-sql-server.html" class="sidebar-link">JSON in Sql Server</a></li><li><a href="/mssql/openjson.html" class="sidebar-link">OPENJSON</a></li><li><a href="/mssql/for-json.html" class="sidebar-link">FOR JSON</a></li><li><a href="/mssql/queries-with-json-data.html" class="sidebar-link">Queries with JSON data</a></li><li><a href="/mssql/storing-json-in-sql-tables.html" class="sidebar-link">Storing JSON in SQL tables</a></li><li><a href="/mssql/modify-json-text.html" class="sidebar-link">Modify JSON text</a></li><li><a href="/mssql/for-xml-path.html" class="sidebar-link">FOR XML PATH</a></li><li><a href="/mssql/join.html" class="sidebar-link">Join</a></li><li><a href="/mssql/cross-apply.html" class="sidebar-link">cross apply</a></li><li><a href="/mssql/computed-columns.html" class="sidebar-link">Computed Columns</a></li><li><a href="/mssql/common-table-expressions.html" class="sidebar-link">Common Table Expressions</a></li><li><a href="/mssql/move-and-copy-data-around-tables.html" class="sidebar-link">Move and copy data around tables</a></li><li><a href="/mssql/limit-result-set.html" class="sidebar-link">Limit Result Set</a></li><li><a href="/mssql/retrieve-information-about-your-instance.html" class="sidebar-link">Retrieve Information about your Instance</a></li><li><a href="/mssql/with-ties-option.html" class="sidebar-link">With Ties Option</a></li><li><a href="/mssql/string-functions.html" aria-current="page" class="active sidebar-link">String Functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#quotename" class="sidebar-link">Quotename</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#replace" class="sidebar-link">Replace</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#substring" class="sidebar-link">Substring</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#string-split" class="sidebar-link">String_Split</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#left" class="sidebar-link">Left</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#right" class="sidebar-link">Right</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#soundex" class="sidebar-link">Soundex</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#format" class="sidebar-link">Format</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#string-escape" class="sidebar-link">String_escape</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#ascii" class="sidebar-link">ASCII</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#char" class="sidebar-link">Char</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#concat" class="sidebar-link">Concat</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#ltrim" class="sidebar-link">LTrim</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#rtrim" class="sidebar-link">RTrim</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#patindex" class="sidebar-link">PatIndex</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#space" class="sidebar-link">Space</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#difference" class="sidebar-link">Difference</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#len" class="sidebar-link">Len</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#lower" class="sidebar-link">Lower</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#upper" class="sidebar-link">Upper</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#unicode" class="sidebar-link">Unicode</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#nchar" class="sidebar-link">NChar</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#reverse" class="sidebar-link">Reverse</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#replicate" class="sidebar-link">Replicate</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#str" class="sidebar-link">Str</a></li><li class="sidebar-sub-header"><a href="/mssql/string-functions.html#charindex" class="sidebar-link">CharIndex</a></li></ul></li><li><a href="/mssql/logical-functions.html" class="sidebar-link">Logical Functions</a></li><li><a href="/mssql/aggregate-functions.html" class="sidebar-link">Aggregate Functions</a></li><li><a href="/mssql/string-aggregate-functions-in-sql-server.html" class="sidebar-link">String Aggregate functions in SQL Server</a></li><li><a href="/mssql/ranking-functions.html" class="sidebar-link">Ranking Functions</a></li><li><a href="/mssql/window-functions.html" class="sidebar-link">Window functions</a></li><li><a href="/mssql/pivot-unpivot.html" class="sidebar-link">PIVOT / UNPIVOT</a></li><li><a href="/mssql/dynamic-sql-pivot.html" class="sidebar-link">Dynamic SQL Pivot</a></li><li><a href="/mssql/partitioning.html" class="sidebar-link">Partitioning</a></li><li><a href="/mssql/stored-procedures.html" class="sidebar-link">Stored Procedures</a></li><li><a href="/mssql/retrieve-information-about-the-database.html" class="sidebar-link">Retrieve information about the database</a></li><li><a href="/mssql/split-string-function-in-sql-server.html" class="sidebar-link">Split String function in Sql Server</a></li><li><a href="/mssql/insert.html" class="sidebar-link">Insert</a></li><li><a href="/mssql/primary-keys.html" class="sidebar-link">Primary Keys</a></li><li><a href="/mssql/foreign-keys.html" class="sidebar-link">Foreign Keys</a></li><li><a href="/mssql/last-inserted-identity.html" class="sidebar-link">Last Inserted Identity</a></li><li><a href="/mssql/scope-identity.html" class="sidebar-link">SCOPE_IDENTITY()</a></li><li><a href="/mssql/sequences.html" class="sidebar-link">Sequences</a></li><li><a href="/mssql/indexing.html" class="sidebar-link">Indexing</a></li><li><a href="/mssql/full-text-indexing.html" class="sidebar-link">Full-Text Indexing</a></li><li><a href="/mssql/trigger.html" class="sidebar-link">Trigger</a></li><li><a href="/mssql/cursors.html" class="sidebar-link">Cursors</a></li><li><a href="/mssql/transaction-isolation-levels.html" class="sidebar-link">Transaction isolation levels</a></li><li><a href="/mssql/advanced-options.html" class="sidebar-link">Advanced options</a></li><li><a href="/mssql/migration.html" class="sidebar-link">Migration</a></li><li><a href="/mssql/table-valued-parameters.html" class="sidebar-link">Table Valued Parameters</a></li><li><a href="/mssql/dbmail.html" class="sidebar-link">DBMAIL</a></li><li><a href="/mssql/in-memory-oltp-hekaton.html" class="sidebar-link">In-Memory OLTP (Hekaton)</a></li><li><a href="/mssql/temporal-tables.html" class="sidebar-link">Temporal Tables</a></li><li><a href="/mssql/use-of-temp-table.html" class="sidebar-link">Use of TEMP Table</a></li><li><a href="/mssql/scheduled-task-or-job.html" class="sidebar-link">Scheduled Task or Job</a></li><li><a href="/mssql/isolation-levels-and-locking.html" class="sidebar-link">Isolation levels and locking</a></li><li><a href="/mssql/sorting-ordering-rows.html" class="sidebar-link">Sorting/ordering rows</a></li><li><a href="/mssql/privileges-or-permissions.html" class="sidebar-link">Privileges or Permissions</a></li><li><a href="/mssql/sqlcmd.html" class="sidebar-link">SQLCMD</a></li><li><a href="/mssql/resource-governor.html" class="sidebar-link">Resource Governor</a></li><li><a href="/mssql/file-group.html" class="sidebar-link">File Group</a></li><li><a href="/mssql/basic-ddl-operations-in-ms-sql-server.html" class="sidebar-link">Basic DDL Operations in MS SQL Server</a></li><li><a href="/mssql/subqueries.html" class="sidebar-link">Subqueries</a></li><li><a href="/mssql/pagination.html" class="sidebar-link">Pagination</a></li><li><a href="/mssql/clustered-columnstore.html" class="sidebar-link">CLUSTERED COLUMNSTORE</a></li><li><a href="/mssql/parsename.html" class="sidebar-link">Parsename</a></li><li><a href="/mssql/installing-sql-server-on-windows.html" class="sidebar-link">Installing SQL Server on Windows</a></li><li><a href="/mssql/analyzing-a-query.html" class="sidebar-link">Analyzing a Query</a></li><li><a href="/mssql/query-hints.html" class="sidebar-link">Query Hints</a></li><li><a href="/mssql/query-store.html" class="sidebar-link">Query Store</a></li><li><a href="/mssql/querying-results-by-page.html" class="sidebar-link">Querying results by page</a></li><li><a href="/mssql/schemas.html" class="sidebar-link">Schemas</a></li><li><a href="/mssql/backup-and-restore-database.html" class="sidebar-link">Backup and Restore Database</a></li><li><a href="/mssql/transaction-handling.html" class="sidebar-link">Transaction handling</a></li><li><a href="/mssql/natively-compiled-modules-hekaton.html" class="sidebar-link">Natively compiled modules (Hekaton)</a></li><li><a href="/mssql/spatial-data.html" class="sidebar-link">Spatial Data</a></li><li><a href="/mssql/dynamic-sql.html" class="sidebar-link">Dynamic SQL</a></li><li><a href="/mssql/dynamic-data-masking.html" class="sidebar-link">Dynamic data masking</a></li><li><a href="/mssql/export-data-in-txt-file-by-using-sqlcmd.html" class="sidebar-link">Export data in txt file by using SQLCMD</a></li><li><a href="/mssql/common-language-runtime-integration.html" class="sidebar-link">Common Language Runtime Integration</a></li><li><a href="/mssql/delimiting-special-characters-and-reserved-words.html" class="sidebar-link">Delimiting special characters and reserved words</a></li><li><a href="/mssql/dbcc.html" class="sidebar-link">DBCC</a></li><li><a href="/mssql/bulk-import.html" class="sidebar-link">BULK Import</a></li><li><a href="/mssql/service-broker.html" class="sidebar-link">Service broker</a></li><li><a href="/mssql/permissions-and-security.html" class="sidebar-link">Permissions and Security</a></li><li><a href="/mssql/database-permissions.html" class="sidebar-link">Database permissions</a></li><li><a href="/mssql/row-level-security.html" class="sidebar-link">Row-level security</a></li><li><a href="/mssql/encryption.html" class="sidebar-link">Encryption</a></li><li><a href="/mssql/phantom-read.html" class="sidebar-link">PHANTOM read</a></li><li><a href="/mssql/filestream.html" class="sidebar-link">Filestream</a></li><li><a href="/mssql/bcp-bulk-copy-program-utility.html" class="sidebar-link">bcp (bulk copy program) Utility</a></li><li><a href="/mssql/sql-server-evolution-through-different-versions-2000-2016.html" class="sidebar-link">SQL Server Evolution through different versions (2000 - 2016)</a></li><li><a href="/mssql/sql-server-management-studio-ssms.html" class="sidebar-link">SQL Server Management Studio (SSMS)</a></li><li><a href="/mssql/managing-azure-sql-database.html" class="sidebar-link">Managing Azure SQL Database</a></li><li><a href="/mssql/system-database-tempdb.html" class="sidebar-link">System database - TempDb</a></li><li><a href="/mssql/microsoft-sql-server-management-studio-shortcut-keys.html" class="sidebar-link">Microsoft SQL Server Management Studio Shortcut Keys</a></li><li><a href="/mssql/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="string-functions"><a href="#string-functions" class="header-anchor">#</a> String Functions</h1> <h2 id="quotename"><a href="#quotename" class="header-anchor">#</a> Quotename</h2> <p>Returns a Unicode string surrounded by delimiters to make it a valid SQL Server delimited identifier.</p> <p>Parameters:</p> <ol><li>character string. A string of Unicode data, up to 128 characters (<code>sysname</code>). If an input string is longer than 128 characters function returns <code>null</code>.</li> <li>quote character. <strong>Optional</strong>. A single character to use as a delimiter. Can be a single quotation mark (<code>'</code> or ``), a left or right bracket (<code>{</code>,<code>[</code>,<code>(</code>,<code>&lt;</code> or <code>&gt;</code>,<code>)</code>,<code>]</code>,<code>}</code>) or a double quotation mark (<code>&quot;</code>). Any other value will return null. Default value is square brackets.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">)</span>      <span class="token comment">-- Returns [what's my name?]</span>

<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">'['</span><span class="token punctuation">)</span> <span class="token comment">-- Returns [what's my name?]</span>
<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">']'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns [what's my name?]</span>

<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">''''</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'what''s my name?'</span>

<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">'&quot;'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns &quot;what's my name?&quot;</span>

<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns (what's my name?)</span>
<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">)</span> <span class="token comment">-- Returns (what's my name?)</span>

<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">'&lt;'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns &lt;what's my name?&gt;</span>
<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns &lt;what's my name?&gt;</span>

<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">'{'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns {what's my name?}</span>
<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">'}'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns {what's my name?}</span>

<span class="token keyword">SELECT</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'what''s my name?'</span><span class="token punctuation">,</span> <span class="token string">'`'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns `what's my name?`</span>

</code></pre></div><h2 id="replace"><a href="#replace" class="header-anchor">#</a> Replace</h2> <p>Returns a string (<code>varchar</code> or <code>nvarchar</code>) where all occurrences of a specified sub string is replaced with another sub string.</p> <p>Parameters:</p> <ol><li>string expression. This is the string that would be searched. It can be a character or binary data type.</li> <li>pattern. This is the sub string that would be replaced. It can be a character or binary data type. The pattern argument cannot be an empty string.</li> <li>replacement. This is the sub string that would replace the pattern sub string. It can be a character or binary data.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">REPLACE</span><span class="token punctuation">(</span><span class="token string">'This is my string'</span><span class="token punctuation">,</span> <span class="token string">'is'</span><span class="token punctuation">,</span> <span class="token string">'XX'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'ThXX XX my string'.</span>

</code></pre></div><p><strong>Notes:</strong></p> <ul><li>If string expression is not of type <code>varchar(max)</code> or <code>nvarchar(max)</code>, the <code>replace</code> function truncates the return value at 8,000 chars.</li> <li>Return data type depends on input data types - returns <code>nvarchar</code> if one of the input values is <code>nvarchar</code>, or <code>varchar</code> otherwise.</li> <li>Return <code>NULL</code> if any of the input parameters is <code>NULL</code></li></ul> <h2 id="substring"><a href="#substring" class="header-anchor">#</a> Substring</h2> <p>Returns a substring that starts with the char that's in the specified start index and the specified max length.</p> <p>Parameters:</p> <ol><li>Character expression. The character expression can be of any data type that can be implicitly converted to <code>varchar</code> or <code>nvarchar</code>, except for <code>text</code> or <code>ntext</code>.</li> <li>Start index. A number (<code>int</code> or <code>bigint</code>) that specifies the start index of the requested substring. (<strong>Note:</strong> strings in sql server are base 1 index, meaning that the first character of the string is index 1). This number can be less then 1. In this case, If the sum of start index and max length is greater then 0, the return string would be a string starting from the first char of the character expression and with the length of (start index + max length - 1). If it's less then 0, an empty string would be returned.</li> <li>Max length. An integer number between 0 and <code>bigint</code> max value (9,223,372,036,854,775,807). If the max length parameter is negative, an error will be raised.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SUBSTRING<span class="token punctuation">(</span><span class="token string">'This is my string'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">-- returns 'is my'</span>

</code></pre></div><p>If the max length + start index is more then the number of characters in the string, the entier string is returned.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SUBSTRING<span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token comment">-- returns 'Hello World'</span>

</code></pre></div><p>If the start index is bigger then the number of characters in the string, an empty string is returned.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SUBSTRING<span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">-- returns ''</span>

</code></pre></div><h2 id="string-split"><a href="#string-split" class="header-anchor">#</a> String_Split</h2> <p>Splits a string expression using a character separator. Note that <code>STRING_SPLIT()</code> is a table-valued function and therefore must be used within <code>FROM</code> clause.</p> <p>Parameters:</p> <ol><li>string. Any character type expression (<code>char</code>, <code>nchar</code>, <code>varchar</code> or <code>nvarchar</code>)</li> <li>seperator. A single character expression of any type (<code>char(1)</code>, <code>nchar(1)</code>, <code>varchar(1)</code> or <code>nvarchar(1)</code>).</li></ol> <p>Returns a single column table where each row contains a fragment of the string. The name of the columns is <code>value</code>, and the datatype is <code>nvarchar</code> if any of the parameters is either <code>nchar</code> or <code>nvarchar</code>, otherwise <code>varchar</code>.</p> <p>The following example splits a string using space as a separator:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">value</span> <span class="token keyword">FROM</span> STRING_SPLIT<span class="token punctuation">(</span><span class="token string">'Lorem ipsum dolor sit amet.'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Result:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">value</span>
<span class="token comment">-----</span>
Lorem
ipsum
dolor
sit
amet<span class="token punctuation">.</span>

</code></pre></div><p>Remarks:</p> <blockquote></blockquote> <p>The <code>STRING_SPLIT</code> function is available only under compatibility level <strong>130</strong>. If your database compatibility level is lower than 130, SQL Server will not be able to find and execute <code>STRING_SPLIT</code> function. You can change the compatibility level of a database using the following command:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> <span class="token punctuation">[</span>database_name<span class="token punctuation">]</span> <span class="token keyword">SET</span> COMPATIBILITY_LEVEL <span class="token operator">=</span> <span class="token number">130</span>

</code></pre></div><p>Older versions of sql server does not have a built in split string function.
There are many user defined functions that handles the problem of splitting a string.
You can read Aaron Bertrand's article <a href="http://sqlperformance.com/2012/07/t-sql-queries/split-strings" target="_blank" rel="noopener noreferrer">Split strings the right way – or the next best way<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for a comprehensive comparison of some of them.</p> <h2 id="left"><a href="#left" class="header-anchor">#</a> Left</h2> <p>Returns a sub string starting with the left most char of a string and up to the maximum length specified.</p> <p>Parameters:</p> <ol><li>character expression. The character expression can be of any data type that can be implicitly converted to <code>varchar</code> or <code>nvarchar</code>, except for <code>text</code> or <code>ntext</code></li><li>max length. An integer number between 0 and <code>bigint</code> max value (9,223,372,036,854,775,807).<br>
If the max length parameter is negative, an error will be raised.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">LEFT</span><span class="token punctuation">(</span><span class="token string">'This is my string'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">-- result: 'This'</span>

</code></pre></div><p>If the max length is more then the number of characters in the string, the entier string is returned.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">LEFT</span><span class="token punctuation">(</span><span class="token string">'This is my string'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment">-- result: 'This is my string'</span>

</code></pre></div><h2 id="right"><a href="#right" class="header-anchor">#</a> Right</h2> <p>Returns a sub string that is the right most part of the string, with the specified max length.</p> <p>Parameters:</p> <ol><li>character expression. The character expression can be of any data type that can be implicitly converted to <code>varchar</code> or <code>nvarchar</code>, except for <code>text</code> or <code>ntext</code></li><li>max length. An integer number between 0 and <code>bigint</code> max value (9,223,372,036,854,775,807).
If the max length parameter is negative, an error will be raised.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">RIGHT</span><span class="token punctuation">(</span><span class="token string">'This is my string'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment">-- returns 'string'</span>

</code></pre></div><p>If the max length is more then the number of characters in the string, the entier string is returned.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">RIGHT</span><span class="token punctuation">(</span><span class="token string">'This is my string'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment">-- returns 'This is my string'</span>

</code></pre></div><h2 id="soundex"><a href="#soundex" class="header-anchor">#</a> Soundex</h2> <p>Returns a four-character code (<code>varchar</code>) to evaluate the phonetic similarity of two strings.</p> <p>Parameters:</p> <ol><li>character expression. An alphanumeric expression of character data.</li></ol> <p>The soundex function creates a four-character code that is based on how the character expression would sound when spoken. the first char is the the upper case version of the first character of the parameter, the rest 3 characters are numbers representing the letters in the expression (except a, e, i, o, u, h, w and y that are ignored).</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SOUNDEX <span class="token punctuation">(</span><span class="token string">'Smith'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'S530'</span>

<span class="token keyword">SELECT</span> SOUNDEX <span class="token punctuation">(</span><span class="token string">'Smythe'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'S530'</span>

</code></pre></div><h2 id="format"><a href="#format" class="header-anchor">#</a> Format</h2> <p>Returns a <code>NVARCHAR</code> value formatted with the specified format and culture (if specified). This is primarily used for converting date-time types to strings.</p> <p>Parameters:</p> <ol><li><code>value</code>. An expression of a supported data type to format. valid types are listed below.</li> <li><code>format</code>. An <code>NVARCHAR</code> format pattern. See Microsoft official documentation for <a href="https://msdn.microsoft.com/library/dwhawy9k.aspx" target="_blank" rel="noopener noreferrer">standard<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://msdn.microsoft.com/library/0c899ak8.aspx" target="_blank" rel="noopener noreferrer">custom<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> format strings.</li> <li><code>culture</code>. <strong>Optional</strong>. <code>nvarchar</code> argument specifying a culture. The default value is the culture of the current session.</li></ol> <p><strong>DATE</strong></p> <p>Using standard format strings:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@d</span> <span class="token keyword">DATETIME</span> <span class="token operator">=</span> <span class="token string">'2016-07-31'</span><span class="token punctuation">;</span>  

<span class="token keyword">SELECT</span> 
    <span class="token function">FORMAT</span> <span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'en-US'</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'US English Result'</span> <span class="token comment">-- Returns '7/31/2016'</span>
   <span class="token punctuation">,</span><span class="token function">FORMAT</span> <span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'en-gb'</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Great Britain English Result'</span> <span class="token comment">-- Returns '31/07/2016'</span>
   <span class="token punctuation">,</span><span class="token function">FORMAT</span> <span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'de-de'</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'German Result'</span> <span class="token comment">-- Returns '31.07.2016'</span>
   <span class="token punctuation">,</span><span class="token function">FORMAT</span> <span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'zh-cn'</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Simplified Chinese (PRC) Result'</span> <span class="token comment">-- Returns '2016/7/31'</span>
   <span class="token punctuation">,</span><span class="token function">FORMAT</span> <span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'en-US'</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'US English Result'</span> <span class="token comment">-- Returns 'Sunday, July 31, 2016'</span>
   <span class="token punctuation">,</span><span class="token function">FORMAT</span> <span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'en-gb'</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Great Britain English Result'</span> <span class="token comment">-- Returns '31 July 2016'</span>
   <span class="token punctuation">,</span><span class="token function">FORMAT</span> <span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'de-de'</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'German Result'</span> <span class="token comment">-- Returns 'Sonntag, 31. Juli 2016'</span>

</code></pre></div><p>Using custom format strings:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span> <span class="token string">'dd/MM/yyyy'</span><span class="token punctuation">,</span> <span class="token string">'en-US'</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'DateTime Result'</span> <span class="token comment">-- Returns '31/07/2016'</span>
      <span class="token punctuation">,</span><span class="token function">FORMAT</span><span class="token punctuation">(</span><span class="token number">123456789</span><span class="token punctuation">,</span><span class="token string">'###-##-####'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Custom Number Result'</span> <span class="token comment">-- Returns '123-45-6789',</span>
      <span class="token punctuation">,</span><span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span><span class="token string">'dddd, MMMM dd, yyyy hh:mm:ss tt'</span><span class="token punctuation">,</span><span class="token string">'en-US'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'US'</span> <span class="token comment">-- Returns 'Sunday, July 31, 2016 12:00:00 AM'</span>
      <span class="token punctuation">,</span><span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span><span class="token string">'dddd, MMMM dd, yyyy hh:mm:ss tt'</span><span class="token punctuation">,</span><span class="token string">'hi-IN'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Hindi'</span> <span class="token comment">-- Returns रविवार, जुलाई 31, 2016 12:00:00 पूर्वाह्न</span>
      <span class="token punctuation">,</span><span class="token function">FORMAT</span> <span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span> <span class="token string">'dddd'</span><span class="token punctuation">,</span> <span class="token string">'en-US'</span> <span class="token punctuation">)</span>  <span class="token keyword">AS</span> <span class="token string">'US'</span> <span class="token comment">-- Returns 'Sunday'</span>
      <span class="token punctuation">,</span><span class="token function">FORMAT</span> <span class="token punctuation">(</span> <span class="token variable">@d</span><span class="token punctuation">,</span> <span class="token string">'dddd'</span><span class="token punctuation">,</span> <span class="token string">'hi-IN'</span> <span class="token punctuation">)</span>  <span class="token keyword">AS</span> <span class="token string">'Hindi'</span> <span class="token comment">-- Returns 'रविवार'</span>

</code></pre></div><p><code>FORMAT</code> can also be used for formatting <code>CURRENCY</code>,<code>PERCENTAGE</code> and <code>NUMBERS</code>.</p> <p><strong>CURRENCY</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@Price1</span> <span class="token keyword">INT</span> <span class="token operator">=</span> <span class="token number">40</span>
<span class="token keyword">SELECT</span> <span class="token function">FORMAT</span><span class="token punctuation">(</span><span class="token variable">@Price1</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'en-US'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'CURRENCY IN US Culture'</span> <span class="token comment">-- Returns '$40.00'      </span>
       <span class="token punctuation">,</span><span class="token function">FORMAT</span><span class="token punctuation">(</span><span class="token variable">@Price1</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'de-DE'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'CURRENCY IN GERMAN Culture'</span> <span class="token comment">-- Returns '40,00 €'</span>

</code></pre></div><p>We can specify the number of digits after the decimal.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@Price</span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">40.356</span>
<span class="token keyword">SELECT</span> <span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Price</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Default'</span><span class="token punctuation">,</span> <span class="token comment">-- Returns '$40.36'</span>
       <span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Price</span><span class="token punctuation">,</span> <span class="token string">'C0'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'With 0 Decimal'</span><span class="token punctuation">,</span> <span class="token comment">-- Returns '$40'</span>
       <span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Price</span><span class="token punctuation">,</span> <span class="token string">'C1'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'With 1 Decimal'</span><span class="token punctuation">,</span> <span class="token comment">-- Returns '$40.4'</span>
       <span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Price</span><span class="token punctuation">,</span> <span class="token string">'C2'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'With 2 Decimal'</span><span class="token punctuation">,</span> <span class="token comment">-- Returns '$40.36'</span>

</code></pre></div><p><strong>PERCENTAGE</strong></p> <div class="language- extra-class"><pre class="language-text"><code>
  DECLARE @Percentage float = 0.35674
   SELECT FORMAT( @Percentage, 'P') AS '% Default', -- Returns '35.67 %'
   FORMAT( @Percentage, 'P0') AS '% With 0 Decimal', -- Returns '36 %'
   FORMAT( @Percentage, 'P1') AS '% with 1 Decimal'  -- Returns '35.7 %'

</code></pre></div><p><strong>NUMBER</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@Number</span> <span class="token keyword">AS</span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">454545.389</span>
<span class="token keyword">SELECT</span> <span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Number</span><span class="token punctuation">,</span> <span class="token string">'N'</span><span class="token punctuation">,</span><span class="token string">'en-US'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Number Format in US'</span><span class="token punctuation">,</span> <span class="token comment">-- Returns '454,545.39'</span>
<span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Number</span><span class="token punctuation">,</span> <span class="token string">'N'</span><span class="token punctuation">,</span><span class="token string">'en-IN'</span><span class="token punctuation">)</span>  <span class="token keyword">AS</span> <span class="token string">'Number Format in INDIA'</span><span class="token punctuation">,</span> <span class="token comment">-- Returns '4,54,545.39'</span>
<span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Number</span><span class="token punctuation">,</span> <span class="token string">'#.0'</span><span class="token punctuation">)</span>     <span class="token keyword">AS</span> <span class="token string">'With 1 Decimal'</span><span class="token punctuation">,</span> <span class="token comment">-- Returns '454545.4'</span>
<span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Number</span><span class="token punctuation">,</span> <span class="token string">'#.00'</span><span class="token punctuation">)</span>    <span class="token keyword">AS</span> <span class="token string">'With 2 Decimal'</span><span class="token punctuation">,</span> <span class="token comment">-- Returns '454545.39'</span>
<span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Number</span><span class="token punctuation">,</span> <span class="token string">'#,##.00'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'With Comma and 2 Decimal'</span><span class="token punctuation">,</span> <span class="token comment">-- Returns '454,545.39'</span>
<span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Number</span><span class="token punctuation">,</span> <span class="token string">'##.00'</span><span class="token punctuation">)</span>   <span class="token keyword">AS</span> <span class="token string">'Without Comma and 2 Decimal'</span><span class="token punctuation">,</span> <span class="token comment">-- Returns '454545.39'</span>
<span class="token function">FORMAT</span><span class="token punctuation">(</span> <span class="token variable">@Number</span><span class="token punctuation">,</span> <span class="token string">'000000000'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Left-padded to nine digits'</span> <span class="token comment">-- Returns '000454545'</span>

</code></pre></div><p>Valid value types list: (<a href="https://msdn.microsoft.com/en-us/library/hh213505.aspx#Anchor_3" target="_blank" rel="noopener noreferrer">source<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <div class="language-sql extra-class"><pre class="language-sql"><code>Category         <span class="token keyword">Type</span>             <span class="token punctuation">.</span>Net <span class="token keyword">type</span>
<span class="token comment">-------------------------------------------</span>
<span class="token keyword">Numeric</span>          <span class="token keyword">bigint</span>           Int64
<span class="token keyword">Numeric</span>          <span class="token keyword">int</span>              Int32
<span class="token keyword">Numeric</span>          <span class="token keyword">smallint</span>         Int16
<span class="token keyword">Numeric</span>          <span class="token keyword">tinyint</span>          Byte
<span class="token keyword">Numeric</span>          <span class="token keyword">decimal</span>          SqlDecimal
<span class="token keyword">Numeric</span>          <span class="token keyword">numeric</span>          SqlDecimal
<span class="token keyword">Numeric</span>          <span class="token keyword">float</span>            <span class="token keyword">Double</span>
<span class="token keyword">Numeric</span>          <span class="token keyword">real</span>             Single
<span class="token keyword">Numeric</span>          smallmoney       <span class="token keyword">Decimal</span>
<span class="token keyword">Numeric</span>          money            <span class="token keyword">Decimal</span>
<span class="token keyword">Date</span> <span class="token operator">and</span> <span class="token keyword">Time</span>    <span class="token keyword">date</span>             <span class="token keyword">DateTime</span>
<span class="token keyword">Date</span> <span class="token operator">and</span> <span class="token keyword">Time</span>    <span class="token keyword">time</span>             TimeSpan
<span class="token keyword">Date</span> <span class="token operator">and</span> <span class="token keyword">Time</span>    <span class="token keyword">datetime</span>         <span class="token keyword">DateTime</span>
<span class="token keyword">Date</span> <span class="token operator">and</span> <span class="token keyword">Time</span>    smalldatetime    <span class="token keyword">DateTime</span>
<span class="token keyword">Date</span> <span class="token operator">and</span> <span class="token keyword">Time</span>    datetime2        <span class="token keyword">DateTime</span>
<span class="token keyword">Date</span> <span class="token operator">and</span> <span class="token keyword">Time</span>    datetimeoffset   DateTimeOffset

</code></pre></div><p><strong>Important Notes:</strong></p> <ul><li><code>FORMAT</code> returns <code>NULL</code> for errors other than a culture that is not valid. For example, <code>NULL</code> is returned if the value specified in format is not valid.</li> <li><code>FORMAT</code> relies on the presence of the .NET Framework Common Language Runtime (CLR).</li> <li><code>FORMAT</code> relies upon CLR formatting rules which dictate that colons and periods must be escaped. Therefore, when the format string (second parameter) contains a colon or period, the colon or period must be escaped with backslash when an input value (first parameter) is of the time data type.</li></ul> <p>See also <a href="http://stackoverflow.com/documentation/sql-server/1471/dates/8084/date-time-formatting-using-format" target="_blank" rel="noopener noreferrer">Date &amp; Time Formatting using FORMAT<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> documentation example.</p> <h2 id="string-escape"><a href="#string-escape" class="header-anchor">#</a> String_escape</h2> <p>Escapes special characters in texts and returns text (<code>nvarchar(max)</code>) with escaped characters.</p> <p>Parameters:</p> <li>
text. is a `nvarchar` expression representing the string that should be escaped.
</li> <li>
type. Escaping rules that will be applied. Currently the only supported value is `'json'`.
</li> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> STRING_ESCAPE<span class="token punctuation">(</span><span class="token string">'\   /  
\\    &quot;     '</span><span class="token punctuation">,</span> <span class="token string">'json'</span><span class="token punctuation">)</span> <span class="token comment">-- returns '\\\t\/\n\\\\\t\&quot;\t'</span>

</code></pre></div><p>List of characters that will be escaped:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>Special <span class="token keyword">character</span>    Encoded sequence
<span class="token comment">-------------------------------------</span>
Quotation mark <span class="token punctuation">(</span>&quot;<span class="token punctuation">)</span>   \&quot;
Reverse solidus <span class="token punctuation">(</span>\<span class="token punctuation">)</span>  \\
Solidus <span class="token punctuation">(</span><span class="token operator">/</span><span class="token punctuation">)</span>          \<span class="token operator">/</span>
Backspace            \b
Form feed            \f
New line             \n
Carriage <span class="token keyword">return</span>      \r
Horizontal tab       \t


Control <span class="token keyword">character</span>    Encoded sequence
<span class="token comment">------------------------------------</span>
<span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            \u0000
<span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>            \u0001
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">)</span>           \u001f

</code></pre></div><h2 id="ascii"><a href="#ascii" class="header-anchor">#</a> ASCII</h2> <p>Returns an int value representing the ASCII code of the leftmost character of a string.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ASCII<span class="token punctuation">(</span><span class="token string">'t'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 116</span>
<span class="token keyword">SELECT</span> ASCII<span class="token punctuation">(</span><span class="token string">'T'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 84</span>
<span class="token keyword">SELECT</span> ASCII<span class="token punctuation">(</span><span class="token string">'This'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 84</span>

</code></pre></div><p>If the string is Unicode and the leftmost character is not ASCII but representable in the current collation, a value greater than 127 can be returned:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ASCII<span class="token punctuation">(</span>N<span class="token string">'ï'</span><span class="token punctuation">)</span> <span class="token comment">-- returns 239 when `SERVERPROPERTY('COLLATION') = 'SQL_Latin1_General_CP1_CI_AS'`</span>

</code></pre></div><p>If the string is Unicode and the leftmost character cannot be represented in the current collation, the int value of 63 is returned: (which represents question mark in ASCII):</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ASCII<span class="token punctuation">(</span>N<span class="token string">'߷'</span><span class="token punctuation">)</span> <span class="token comment">-- returns 63</span>
<span class="token keyword">SELECT</span> ASCII<span class="token punctuation">(</span><span class="token keyword">nchar</span><span class="token punctuation">(</span><span class="token number">2039</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- returns 63</span>

</code></pre></div><h2 id="char"><a href="#char" class="header-anchor">#</a> Char</h2> <p>Returns a char represented by an int ASCII code.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">116</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 't'</span>
<span class="token keyword">SELECT</span> <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span>  <span class="token comment">-- Returns 'T'</span>

</code></pre></div><p>This can be used to introduce new line/line feed <code>CHAR(10)</code>, carriage returns <code>CHAR(13)</code>, etc. See <a href="http://www.asciitable.com/" target="_blank" rel="noopener noreferrer">AsciiTable.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for reference.</p> <p>If the argument value is not between 0 and 255, the CHAR function returns <code>NULL</code>.<br>
The return data type of the <code>CHAR</code> function is <code>char(1)</code></p> <h2 id="concat"><a href="#concat" class="header-anchor">#</a> Concat</h2> <p>Returns a string that is the result of two or more strings joined together.   <code>CONCAT</code> accepts two or more arguments.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span><span class="token string">'This'</span><span class="token punctuation">,</span> <span class="token string">' is'</span><span class="token punctuation">,</span> <span class="token string">' my'</span><span class="token punctuation">,</span> <span class="token string">' string'</span><span class="token punctuation">)</span> <span class="token comment">-- returns 'This is my string'</span>

</code></pre></div><p>Note: Unlike concatenating strings using the string concatenation operator (<code>+</code>), when passing a null value to the <code>concat</code> function it will implicitly convert it to an empty string:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span><span class="token string">'This'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">' is'</span><span class="token punctuation">,</span> <span class="token string">' my'</span><span class="token punctuation">,</span> <span class="token string">' string'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">-- returns 'This is my string'</span>
       <span class="token string">'This'</span> <span class="token operator">+</span> <span class="token boolean">NULL</span> <span class="token operator">+</span> <span class="token string">' is'</span> <span class="token operator">+</span> <span class="token string">' my'</span> <span class="token operator">+</span> <span class="token string">' string'</span> <span class="token comment">-- returns NULL.</span>

</code></pre></div><p>Also arguments of a non-string type will be implicitly converted to a string:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span><span class="token string">'This'</span><span class="token punctuation">,</span> <span class="token string">' is my '</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'rd string'</span><span class="token punctuation">)</span> <span class="token comment">-- returns 'This is my 3rd string'</span>

</code></pre></div><p>Non-string type variables will also be converted to string format, no need to manually covert or cast it to string:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@Age</span> <span class="token keyword">INT</span><span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span><span class="token string">'Ram is '</span><span class="token punctuation">,</span> <span class="token variable">@Age</span><span class="token punctuation">,</span><span class="token string">' years old'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- returns 'Ram is 23 years old'</span>

</code></pre></div><p>Older versions do not support <code>CONCAT</code> function and must use the string concatenation operator (<code>+</code>) instead. Non-string types must be cast or converted to string types in order to concatenate them this way.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token string">'This is the number '</span> <span class="token operator">+</span> CAST<span class="token punctuation">(</span><span class="token number">42</span> <span class="token keyword">AS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">--returns 'This is the number 42'</span>

</code></pre></div><h2 id="ltrim"><a href="#ltrim" class="header-anchor">#</a> LTrim</h2> <p>Returns a character expression (<code>varchar</code> or <code>nvarchar</code>) after removing all leading white spaces, i.e., white spaces from the left through to the first non-white space character.</p> <p>Parameters:</p> <ol><li>character expression. Any expression of character or binary data that can be implicitly converted to <code>varcher</code>, except <code>text</code>, <code>ntext</code> and <code>image</code>.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LTRIM<span class="token punctuation">(</span><span class="token string">'    This is my string'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'This is my string'</span>

</code></pre></div><h2 id="rtrim"><a href="#rtrim" class="header-anchor">#</a> RTrim</h2> <p>Returns a character expression (<code>varchar</code> or <code>nvarchar</code>) after removing all trailing white spaces, i.e., spaces from the right end of the string up until the first non-white space character to the left.</p> <p>Parameters:</p> <ol><li>character expression. Any expression of character or binary data that can be implicitly converted to <code>varcher</code>, except <code>text</code>, <code>ntext</code> and <code>image</code>.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> RTRIM<span class="token punctuation">(</span><span class="token string">'This is my string     '</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'This is my string'</span>

</code></pre></div><h2 id="patindex"><a href="#patindex" class="header-anchor">#</a> PatIndex</h2> <p>Returns the starting position of the first occurrence of a the specified pattern in the specified expression.</p> <p>Parameters:</p> <li>
pattern. A character expression the contains the sequence to be found. Limited to A maximum length of 8000 chars. Wildcards (`%`, `_`) can be used in the pattern. If the pattern does not start with a wildcard, it may only match whatever is in the beginning of the expression. If it doesn't end with a wildcard, it may only match whatever is in the end of the expression.
</li> <li>
expression. Any string data type.
</li> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> PATINDEX<span class="token punctuation">(</span><span class="token string">'%ter%'</span><span class="token punctuation">,</span> <span class="token string">'interesting'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 3. </span>

<span class="token keyword">SELECT</span> PATINDEX<span class="token punctuation">(</span><span class="token string">'%t_r%t%'</span><span class="token punctuation">,</span> <span class="token string">'interesting'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 3. </span>

<span class="token keyword">SELECT</span> PATINDEX<span class="token punctuation">(</span><span class="token string">'ter%'</span><span class="token punctuation">,</span> <span class="token string">'interesting'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 0, since 'ter' is not at the start. </span>

<span class="token keyword">SELECT</span> PATINDEX<span class="token punctuation">(</span><span class="token string">'inter%'</span><span class="token punctuation">,</span> <span class="token string">'interesting'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 1. </span>

<span class="token keyword">SELECT</span> PATINDEX<span class="token punctuation">(</span><span class="token string">'%ing'</span><span class="token punctuation">,</span> <span class="token string">'interesting'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 9. </span>

</code></pre></div><h2 id="space"><a href="#space" class="header-anchor">#</a> Space</h2> <p>Returns a string (<code>varchar</code>) of repeated spaces.</p> <p>Parameters:</p> <ol><li>integer expression. Any integer expression, up to 8000. If negative, <code>null</code> is returned. if 0, an empty string is returned. (To return a string longer then 8000 spaces, use Replicate.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SPACE<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">-- Returns NULL</span>
<span class="token keyword">SELECT</span> SPACE<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">-- Returns an empty string</span>
<span class="token keyword">SELECT</span> SPACE<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment">-- Returns '   ' (a string containing 3 spaces)</span>

</code></pre></div><h2 id="difference"><a href="#difference" class="header-anchor">#</a> Difference</h2> <p>Returns an integer (<code>int</code>) value that indicates the difference between the soundex values of two character expressions.</p> <p>Parameters:</p> <ol><li>character expression 1.</li> <li>character expression 2.</li></ol> <p>Both parameters are alphanumeric expressions of character data.</p> <p>The integer returned is the number of chars in the soundex values of the parameters that are the same, so 4 means that the expressions are very similar and 0 means that they are very different.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span>  SOUNDEX<span class="token punctuation">(</span><span class="token string">'Green'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">-- G650</span>
        SOUNDEX<span class="token punctuation">(</span><span class="token string">'Greene'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">-- G650</span>
        DIFFERENCE<span class="token punctuation">(</span><span class="token string">'Green'</span><span class="token punctuation">,</span><span class="token string">'Greene'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 4</span>
        
<span class="token keyword">SELECT</span>  SOUNDEX<span class="token punctuation">(</span><span class="token string">'Blotchet-Halls'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">-- B432</span>
        SOUNDEX<span class="token punctuation">(</span><span class="token string">'Greene'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">-- G650</span>
        DIFFERENCE<span class="token punctuation">(</span><span class="token string">'Blotchet-Halls'</span><span class="token punctuation">,</span> <span class="token string">'Greene'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 0</span>

</code></pre></div><h2 id="len"><a href="#len" class="header-anchor">#</a> Len</h2> <p>Returns the number of characters of a string.<br>
Note: the <code>LEN</code> function ignores trailing spaces:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LEN</span><span class="token punctuation">(</span><span class="token string">'My string'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">-- returns 9</span>
       <span class="token function">LEN</span><span class="token punctuation">(</span><span class="token string">'My string   '</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">-- returns 9</span>
       <span class="token function">LEN</span><span class="token punctuation">(</span><span class="token string">'   My string'</span><span class="token punctuation">)</span> <span class="token comment">-- returns 12</span>

</code></pre></div><p>If the length including trailing spaces is desired there are several techniques to achieve this, although each has its drawbacks. One technique is to append a single character to the string, and then use the <code>LEN</code> minus one:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@str</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'My string   '</span>
<span class="token keyword">SELECT</span> <span class="token function">LEN</span><span class="token punctuation">(</span><span class="token variable">@str</span> <span class="token operator">+</span> <span class="token string">'x'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token comment">-- returns 12</span>

</code></pre></div><p>The drawback to this is if the type of the string variable or column is of the maximum length, the append of the extra character is discarded, and the resulting length will still not count trailing spaces. To address that, the following modified version solves the problem, and gives the correct results in all cases at the expense of a small amount of additional execution time, and because of this (correct results, including with surrogate pairs, and reasonable execution speed) appears to be the best technique to use:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LEN</span><span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span>NVARCHAR<span class="token punctuation">(</span>MAX<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">@str</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'x'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>

</code></pre></div><p>Another technique is to use the<code>DATALENGTH</code> function.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@str</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'My string   '</span>
<span class="token keyword">SELECT</span> DATALENGTH<span class="token punctuation">(</span><span class="token variable">@str</span><span class="token punctuation">)</span> <span class="token comment">-- returns 12</span>

</code></pre></div><p>It's important to note though that <code>DATALENGTH</code> returns the length in bytes of the string in memory. This will be different for <code>varchar</code> vs. <code>nvarchar</code>.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@str</span> nvarchar<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'My string   '</span>
<span class="token keyword">SELECT</span> DATALENGTH<span class="token punctuation">(</span><span class="token variable">@str</span><span class="token punctuation">)</span> <span class="token comment">-- returns 24</span>

</code></pre></div><p>You can adjust for this by dividing the datalength of the string by the datalength of a single character (which must be of the same type). The example below does this, and also handles the case where the target string happens to be empty, thus avoiding a divide by zero.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@str</span> nvarchar<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'My string   '</span>
<span class="token keyword">SELECT</span> DATALENGTH<span class="token punctuation">(</span><span class="token variable">@str</span><span class="token punctuation">)</span> <span class="token operator">/</span> DATALENGTH<span class="token punctuation">(</span><span class="token keyword">LEFT</span><span class="token punctuation">(</span><span class="token keyword">LEFT</span><span class="token punctuation">(</span><span class="token variable">@str</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- returns 12</span>

</code></pre></div><p>Even this, though, has a problem in SQL Server 2012 and above. It will produce incorrect results when the string contains surrogate pairs (some characters can occupy more bytes than other characters in the same string).</p> <p>Another technique is to use <code>REPLACE</code> to convert spaces to a non-space character, and take the <code>LEN</code> of the result. This gives correct results in all cases, but has very poor execution speed with long strings.</p> <h2 id="lower"><a href="#lower" class="header-anchor">#</a> Lower</h2> <p>Returns a character expression (<code>varchar</code> or <code>nvarchar</code>) after converting all uppercase characters to lowercase.</p> <p>Parameters:</p> <ol><li>Character expression. Any expression of character or binary data that can be implicitly converted to <code>varchar</code>.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LOWER<span class="token punctuation">(</span><span class="token string">'This IS my STRING'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'this is my string'</span>

<span class="token keyword">DECLARE</span> <span class="token variable">@String</span> <span class="token keyword">nchar</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">=</span> N<span class="token string">'This IS my STRING'</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> LOWER<span class="token punctuation">(</span><span class="token variable">@String</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'this is my string'</span>

</code></pre></div><h2 id="upper"><a href="#upper" class="header-anchor">#</a> Upper</h2> <p>Returns a character expression (<code>varchar</code> or <code>nvarchar</code>) after converting all lowercase characters to uppercase.</p> <p>Parameters:</p> <ol><li>Character expression. Any expression of character or binary data that can be implicitly converted to <code>varchar</code>.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> UPPER<span class="token punctuation">(</span><span class="token string">'This IS my STRING'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'THIS IS MY STRING'</span>

<span class="token keyword">DECLARE</span> <span class="token variable">@String</span> <span class="token keyword">nchar</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">=</span> N<span class="token string">'This IS my STRING'</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> UPPER<span class="token punctuation">(</span><span class="token variable">@String</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'THIS IS MY STRING'</span>

</code></pre></div><h2 id="unicode"><a href="#unicode" class="header-anchor">#</a> Unicode</h2> <p>Returns the integer value representing the Unicode value of the first character of the input expression.</p> <p>Parameters:</p> <ol><li>Unicode character expression. Any valid <code>nchar</code> or <code>nvarchar</code> expression.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> UNICODE<span class="token punctuation">(</span>N<span class="token string">'Ɛ'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 400</span>

<span class="token keyword">DECLARE</span> <span class="token variable">@Unicode</span> nvarchar<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">=</span> N<span class="token string">'Ɛ is a char'</span>
<span class="token keyword">SELECT</span> UNICODE<span class="token punctuation">(</span><span class="token variable">@Unicode</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 400</span>

</code></pre></div><h2 id="nchar"><a href="#nchar" class="header-anchor">#</a> NChar</h2> <p>Returns the Unicode character(s) (<code>nchar(1)</code> or <code>nvarchar(2)</code>) corresponding to the integer argument it receives, as defined by the Unicode standard.</p> <p>Parameters:</p> <ol><li>integer expression. Any integer expression that is a positive number between 0 and 65535, or if the collation of the database supports supplementary character (CS) flag, the supported range is between 0 to 1114111. If the integer expression does not fall inside this range, <code>null</code> is returned.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">NCHAR</span><span class="token punctuation">(</span><span class="token number">257</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'ā'</span>
<span class="token keyword">SELECT</span> <span class="token keyword">NCHAR</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'Ɛ'</span>

</code></pre></div><h2 id="reverse"><a href="#reverse" class="header-anchor">#</a> Reverse</h2> <p>Returns a string value in reversed order.</p> <p>Parameters:</p> <ol><li>string expression. Any string or binary data that can be implicitly converted to <code>varchar</code>.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">Select</span> REVERSE<span class="token punctuation">(</span><span class="token string">'Sql Server'</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'revreS lqS'</span>

</code></pre></div><h2 id="replicate"><a href="#replicate" class="header-anchor">#</a> Replicate</h2> <p>Repeats a string value a specified number of times.</p> <p>Parameters:</p> <ol><li>string expression. String expression can be a character string or binary data.</li> <li>integer expression. Any integer type, including <code>bigint</code>. If negative, <code>null</code> is returned. If 0, an empty string is returned.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> REPLICATE<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">-- Returns NULL</span>

<span class="token keyword">SELECT</span> REPLICATE<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">-- Returns ''</span>

<span class="token keyword">SELECT</span> REPLICATE<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment">-- Returns 'aaaaa'</span>

<span class="token keyword">SELECT</span> REPLICATE<span class="token punctuation">(</span><span class="token string">'Abc'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 'AbcAbcAbc'</span>

</code></pre></div><p><strong>Note:</strong> If string expression is not of type <code>varchar(max)</code> or <code>nvarchar(max)</code>, the return value will not exceed 8000 chars. Replicate will stop before adding the string that will cause the return value to exceed that limit:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">LEN</span><span class="token punctuation">(</span>REPLICATE<span class="token punctuation">(</span><span class="token string">'a b c d e f g h i j k l'</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 7981</span>

<span class="token keyword">SELECT</span> <span class="token function">LEN</span><span class="token punctuation">(</span>REPLICATE<span class="token punctuation">(</span>cast<span class="token punctuation">(</span><span class="token string">'a b c d e f g h i j k l'</span> <span class="token keyword">as</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 8050</span>

</code></pre></div><h2 id="str"><a href="#str" class="header-anchor">#</a> Str</h2> <p>Returns character data (<code>varchar</code>) converted from numeric data.</p> <p>Parameters:</p> <ol><li>float expression. An approximate numeric data type with a decimal point.</li> <li>length. <strong>optional.</strong> The total length of the string expression that would return, including digits, decimal point and leading spaces (if needed). The default value is 10.</li> <li>decimal. <strong>optional.</strong> The number of digits to the right of the decimal point. If higher then 16, the result would be truncated to sixteen places to the right of the decimal point.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> STR<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">)</span> <span class="token comment">-- Returns '         1'</span>

<span class="token keyword">SELECT</span> STR<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">-- Returns '  1'</span>

<span class="token keyword">SELECT</span> STR<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">-- Returns '1.2'</span>

<span class="token keyword">SELECT</span> STR<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">-- Returns ' 1.20'</span>

<span class="token keyword">SELECT</span> STR<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">-- Returns '1.200'</span>

<span class="token keyword">SELECT</span> STR<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">-- Returns ' 1.00'</span>

<span class="token keyword">SELECT</span> STR<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">-- Returns '         1'</span>

</code></pre></div><h2 id="charindex"><a href="#charindex" class="header-anchor">#</a> CharIndex</h2> <p>Returns the start index of a the first occurrence of string expression inside another string expression.</p> <p>Parameters list:</p> <ol><li>String to find (up to 8000 chars)</li> <li>String to search (any valid character data type and length, including binary)</li> <li>(Optional) index to start. A number of type int or big int. If omitted or less then 1, the search starts at the beginning of the string.</li></ol> <p>If the string to search is <code>varchar(max)</code>, <code>nvarchar(max)</code> or <code>varbinary(max)</code>, the <code>CHARINDEX</code> function will return a <code>bigint</code> value. Otherwise, it will return an <code>int</code>.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> CHARINDEX<span class="token punctuation">(</span><span class="token string">'is'</span><span class="token punctuation">,</span> <span class="token string">'this is my string'</span><span class="token punctuation">)</span> <span class="token comment">-- returns 3</span>
<span class="token keyword">SELECT</span> CHARINDEX<span class="token punctuation">(</span><span class="token string">'is'</span><span class="token punctuation">,</span> <span class="token string">'this is my string'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">-- returns 6</span>
<span class="token keyword">SELECT</span> CHARINDEX<span class="token punctuation">(</span><span class="token string">' is'</span><span class="token punctuation">,</span> <span class="token string">'this is my string'</span><span class="token punctuation">)</span> <span class="token comment">-- returns 5</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>List of string functions (Alphabetically sorted):</p> <li>
[Ascii](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14342/ascii)
</li> <li>
[Char](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14344/char)
</li> <li>
[Charindex](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14343/charindex)
</li> <li>
[Concat](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14346/concat)
</li> <li>
[Difference](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/17326/difference)
</li> <li>
[Format](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/17327/format)
</li> <li>
[Left](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14339/left)
</li> <li>
[Len](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14345/len)
</li> <li>
[Lower](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14347/lower)
</li> <li>
[Ltrim](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14349/ltrim)
</li> <li>
[Nchar](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14352/nchar)
</li> <li>
[Patindex](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14638/patindex)
</li> <li>
[Quotename](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/15914/quotename)
</li> <li>
[Replace](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14964/replace)
</li> <li>
[Replicate](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14643/replicate)
</li> <li>
[Reverse](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14637/reverse)
</li> <li>
[Right](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14340/right)
</li> <li>
[Rtrim](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14350/rtrim)
</li> <li>
[Soundex](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/17325/soundex)
</li> <li>
[Space](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14642/space)
</li> <li>
[Str](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/15913/str)
</li> <li>
[String_escape](http://stackoverflow.com/documentation/sql-server/4113/string-functions/17987/string-escape)
</li> <li>
[String_split](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/15779/string-split)
</li> <li>
[Stuff](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14965/stuff)
</li> <li>
[Substring](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14341/substring)
</li> <li>
[Unicode](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14351/unicode)
</li> <li>
[Upper](http://stackoverflow.com/documentation/sql-server/4113/varchar-functions/14348/upper)
</li></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/mssql/string-functions.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mssql/with-ties-option.html" class="prev">
        With Ties Option
      </a></span> <span class="next"><a href="/mssql/logical-functions.html">
        Logical Functions
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2068.ee55c38b.js" defer></script>
  </body>
</html>
