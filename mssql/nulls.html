<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Microsoft SQL Server - NULLs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="COALESCE (), NULL comparison, ANSI NULLS, ISNULL(), Is null / Is not null, NULL with NOT IN SubQuery">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Microsoft SQL Server - NULLs">
    <meta property="og:description" content="COALESCE (), NULL comparison, ANSI NULLS, ISNULL(), Is null / Is not null, NULL with NOT IN SubQuery">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/mssql/nulls.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Microsoft SQL Server - NULLs">
    <meta name="twitter:description" content="COALESCE (), NULL comparison, ANSI NULLS, ISNULL(), Is null / Is not null, NULL with NOT IN SubQuery">
    <meta name="twitter:url" content="/mssql/nulls.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2032.3306d903.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MS SQL Server</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mssql/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/mssql/getting-started-with-microsoft-sql-server.html" class="sidebar-link">Getting started with Microsoft SQL Server</a></li><li><a href="/mssql/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/mssql/converting-data-types.html" class="sidebar-link">Converting data types</a></li><li><a href="/mssql/user-defined-table-types.html" class="sidebar-link">User Defined Table Types</a></li><li><a href="/mssql/select-statement.html" class="sidebar-link">SELECT statement</a></li><li><a href="/mssql/alias-names-in-sql-server.html" class="sidebar-link">Alias Names in Sql Server</a></li><li><a href="/mssql/nulls.html" aria-current="page" class="active sidebar-link">NULLs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mssql/nulls.html#coalesce" class="sidebar-link">COALESCE ()</a></li><li class="sidebar-sub-header"><a href="/mssql/nulls.html#null-comparison" class="sidebar-link">NULL comparison</a></li><li class="sidebar-sub-header"><a href="/mssql/nulls.html#ansi-nulls" class="sidebar-link">ANSI NULLS</a></li><li class="sidebar-sub-header"><a href="/mssql/nulls.html#isnull" class="sidebar-link">ISNULL()</a></li><li class="sidebar-sub-header"><a href="/mssql/nulls.html#is-null-is-not-null" class="sidebar-link">Is null / Is not null</a></li><li class="sidebar-sub-header"><a href="/mssql/nulls.html#null-with-not-in-subquery" class="sidebar-link">NULL with NOT IN SubQuery</a></li></ul></li><li><a href="/mssql/variables.html" class="sidebar-link">Variables</a></li><li><a href="/mssql/dates.html" class="sidebar-link">Dates</a></li><li><a href="/mssql/generating-a-range-of-dates.html" class="sidebar-link">Generating a range of dates</a></li><li><a href="/mssql/database-snapshots.html" class="sidebar-link">Database Snapshots</a></li><li><a href="/mssql/coalesce.html" class="sidebar-link">COALESCE</a></li><li><a href="/mssql/if-else.html" class="sidebar-link">IF...ELSE</a></li><li><a href="/mssql/case-statement.html" class="sidebar-link">CASE Statement</a></li><li><a href="/mssql/insert-into.html" class="sidebar-link">INSERT INTO</a></li><li><a href="/mssql/drop-keyword.html" class="sidebar-link">Drop Keyword</a></li><li><a href="/mssql/merge.html" class="sidebar-link">MERGE</a></li><li><a href="/mssql/create-view.html" class="sidebar-link">CREATE VIEW</a></li><li><a href="/mssql/views.html" class="sidebar-link">Views</a></li><li><a href="/mssql/union.html" class="sidebar-link">UNION</a></li><li><a href="/mssql/try-catch.html" class="sidebar-link">TRY/CATCH</a></li><li><a href="/mssql/while-loop.html" class="sidebar-link">WHILE loop</a></li><li><a href="/mssql/over-clause.html" class="sidebar-link">OVER Clause</a></li><li><a href="/mssql/group-by.html" class="sidebar-link">GROUP BY</a></li><li><a href="/mssql/order-by.html" class="sidebar-link">ORDER BY</a></li><li><a href="/mssql/the-stuff-function.html" class="sidebar-link">The STUFF Function</a></li><li><a href="/mssql/json-in-sql-server.html" class="sidebar-link">JSON in Sql Server</a></li><li><a href="/mssql/openjson.html" class="sidebar-link">OPENJSON</a></li><li><a href="/mssql/for-json.html" class="sidebar-link">FOR JSON</a></li><li><a href="/mssql/queries-with-json-data.html" class="sidebar-link">Queries with JSON data</a></li><li><a href="/mssql/storing-json-in-sql-tables.html" class="sidebar-link">Storing JSON in SQL tables</a></li><li><a href="/mssql/modify-json-text.html" class="sidebar-link">Modify JSON text</a></li><li><a href="/mssql/for-xml-path.html" class="sidebar-link">FOR XML PATH</a></li><li><a href="/mssql/join.html" class="sidebar-link">Join</a></li><li><a href="/mssql/cross-apply.html" class="sidebar-link">cross apply</a></li><li><a href="/mssql/computed-columns.html" class="sidebar-link">Computed Columns</a></li><li><a href="/mssql/common-table-expressions.html" class="sidebar-link">Common Table Expressions</a></li><li><a href="/mssql/move-and-copy-data-around-tables.html" class="sidebar-link">Move and copy data around tables</a></li><li><a href="/mssql/limit-result-set.html" class="sidebar-link">Limit Result Set</a></li><li><a href="/mssql/retrieve-information-about-your-instance.html" class="sidebar-link">Retrieve Information about your Instance</a></li><li><a href="/mssql/with-ties-option.html" class="sidebar-link">With Ties Option</a></li><li><a href="/mssql/string-functions.html" class="sidebar-link">String Functions</a></li><li><a href="/mssql/logical-functions.html" class="sidebar-link">Logical Functions</a></li><li><a href="/mssql/aggregate-functions.html" class="sidebar-link">Aggregate Functions</a></li><li><a href="/mssql/string-aggregate-functions-in-sql-server.html" class="sidebar-link">String Aggregate functions in SQL Server</a></li><li><a href="/mssql/ranking-functions.html" class="sidebar-link">Ranking Functions</a></li><li><a href="/mssql/window-functions.html" class="sidebar-link">Window functions</a></li><li><a href="/mssql/pivot-unpivot.html" class="sidebar-link">PIVOT / UNPIVOT</a></li><li><a href="/mssql/dynamic-sql-pivot.html" class="sidebar-link">Dynamic SQL Pivot</a></li><li><a href="/mssql/partitioning.html" class="sidebar-link">Partitioning</a></li><li><a href="/mssql/stored-procedures.html" class="sidebar-link">Stored Procedures</a></li><li><a href="/mssql/retrieve-information-about-the-database.html" class="sidebar-link">Retrieve information about the database</a></li><li><a href="/mssql/split-string-function-in-sql-server.html" class="sidebar-link">Split String function in Sql Server</a></li><li><a href="/mssql/insert.html" class="sidebar-link">Insert</a></li><li><a href="/mssql/primary-keys.html" class="sidebar-link">Primary Keys</a></li><li><a href="/mssql/foreign-keys.html" class="sidebar-link">Foreign Keys</a></li><li><a href="/mssql/last-inserted-identity.html" class="sidebar-link">Last Inserted Identity</a></li><li><a href="/mssql/scope-identity.html" class="sidebar-link">SCOPE_IDENTITY()</a></li><li><a href="/mssql/sequences.html" class="sidebar-link">Sequences</a></li><li><a href="/mssql/indexing.html" class="sidebar-link">Indexing</a></li><li><a href="/mssql/full-text-indexing.html" class="sidebar-link">Full-Text Indexing</a></li><li><a href="/mssql/trigger.html" class="sidebar-link">Trigger</a></li><li><a href="/mssql/cursors.html" class="sidebar-link">Cursors</a></li><li><a href="/mssql/transaction-isolation-levels.html" class="sidebar-link">Transaction isolation levels</a></li><li><a href="/mssql/advanced-options.html" class="sidebar-link">Advanced options</a></li><li><a href="/mssql/migration.html" class="sidebar-link">Migration</a></li><li><a href="/mssql/table-valued-parameters.html" class="sidebar-link">Table Valued Parameters</a></li><li><a href="/mssql/dbmail.html" class="sidebar-link">DBMAIL</a></li><li><a href="/mssql/in-memory-oltp-hekaton.html" class="sidebar-link">In-Memory OLTP (Hekaton)</a></li><li><a href="/mssql/temporal-tables.html" class="sidebar-link">Temporal Tables</a></li><li><a href="/mssql/use-of-temp-table.html" class="sidebar-link">Use of TEMP Table</a></li><li><a href="/mssql/scheduled-task-or-job.html" class="sidebar-link">Scheduled Task or Job</a></li><li><a href="/mssql/isolation-levels-and-locking.html" class="sidebar-link">Isolation levels and locking</a></li><li><a href="/mssql/sorting-ordering-rows.html" class="sidebar-link">Sorting/ordering rows</a></li><li><a href="/mssql/privileges-or-permissions.html" class="sidebar-link">Privileges or Permissions</a></li><li><a href="/mssql/sqlcmd.html" class="sidebar-link">SQLCMD</a></li><li><a href="/mssql/resource-governor.html" class="sidebar-link">Resource Governor</a></li><li><a href="/mssql/file-group.html" class="sidebar-link">File Group</a></li><li><a href="/mssql/basic-ddl-operations-in-ms-sql-server.html" class="sidebar-link">Basic DDL Operations in MS SQL Server</a></li><li><a href="/mssql/subqueries.html" class="sidebar-link">Subqueries</a></li><li><a href="/mssql/pagination.html" class="sidebar-link">Pagination</a></li><li><a href="/mssql/clustered-columnstore.html" class="sidebar-link">CLUSTERED COLUMNSTORE</a></li><li><a href="/mssql/parsename.html" class="sidebar-link">Parsename</a></li><li><a href="/mssql/installing-sql-server-on-windows.html" class="sidebar-link">Installing SQL Server on Windows</a></li><li><a href="/mssql/analyzing-a-query.html" class="sidebar-link">Analyzing a Query</a></li><li><a href="/mssql/query-hints.html" class="sidebar-link">Query Hints</a></li><li><a href="/mssql/query-store.html" class="sidebar-link">Query Store</a></li><li><a href="/mssql/querying-results-by-page.html" class="sidebar-link">Querying results by page</a></li><li><a href="/mssql/schemas.html" class="sidebar-link">Schemas</a></li><li><a href="/mssql/backup-and-restore-database.html" class="sidebar-link">Backup and Restore Database</a></li><li><a href="/mssql/transaction-handling.html" class="sidebar-link">Transaction handling</a></li><li><a href="/mssql/natively-compiled-modules-hekaton.html" class="sidebar-link">Natively compiled modules (Hekaton)</a></li><li><a href="/mssql/spatial-data.html" class="sidebar-link">Spatial Data</a></li><li><a href="/mssql/dynamic-sql.html" class="sidebar-link">Dynamic SQL</a></li><li><a href="/mssql/dynamic-data-masking.html" class="sidebar-link">Dynamic data masking</a></li><li><a href="/mssql/export-data-in-txt-file-by-using-sqlcmd.html" class="sidebar-link">Export data in txt file by using SQLCMD</a></li><li><a href="/mssql/common-language-runtime-integration.html" class="sidebar-link">Common Language Runtime Integration</a></li><li><a href="/mssql/delimiting-special-characters-and-reserved-words.html" class="sidebar-link">Delimiting special characters and reserved words</a></li><li><a href="/mssql/dbcc.html" class="sidebar-link">DBCC</a></li><li><a href="/mssql/bulk-import.html" class="sidebar-link">BULK Import</a></li><li><a href="/mssql/service-broker.html" class="sidebar-link">Service broker</a></li><li><a href="/mssql/permissions-and-security.html" class="sidebar-link">Permissions and Security</a></li><li><a href="/mssql/database-permissions.html" class="sidebar-link">Database permissions</a></li><li><a href="/mssql/row-level-security.html" class="sidebar-link">Row-level security</a></li><li><a href="/mssql/encryption.html" class="sidebar-link">Encryption</a></li><li><a href="/mssql/phantom-read.html" class="sidebar-link">PHANTOM read</a></li><li><a href="/mssql/filestream.html" class="sidebar-link">Filestream</a></li><li><a href="/mssql/bcp-bulk-copy-program-utility.html" class="sidebar-link">bcp (bulk copy program) Utility</a></li><li><a href="/mssql/sql-server-evolution-through-different-versions-2000-2016.html" class="sidebar-link">SQL Server Evolution through different versions (2000 - 2016)</a></li><li><a href="/mssql/sql-server-management-studio-ssms.html" class="sidebar-link">SQL Server Management Studio (SSMS)</a></li><li><a href="/mssql/managing-azure-sql-database.html" class="sidebar-link">Managing Azure SQL Database</a></li><li><a href="/mssql/system-database-tempdb.html" class="sidebar-link">System database - TempDb</a></li><li><a href="/mssql/microsoft-sql-server-management-studio-shortcut-keys.html" class="sidebar-link">Microsoft SQL Server Management Studio Shortcut Keys</a></li><li><a href="/mssql/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="nulls"><a href="#nulls" class="header-anchor">#</a> NULLs</h1> <p>In SQL Server, <code>NULL</code> represents data that is missing, or unknown.  This means that <code>NULL</code> is not really a value; it's better described as a placeholder for a value. This is also the reason why you can't compare <code>NULL</code> with any value, and not even with another <code>NULL</code>.</p> <h2 id="coalesce"><a href="#coalesce" class="header-anchor">#</a> COALESCE ()</h2> <p><code>COALESCE ()</code> Evaluates the arguments in order and returns the current value of the first expression that initially does not evaluate to <code>NULL</code>.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@MyInt</span> <span class="token keyword">int</span> <span class="token comment">-- variable is null until it is set with value.</span>
<span class="token keyword">DECLARE</span> <span class="token variable">@MyInt2</span> <span class="token keyword">int</span> <span class="token comment">-- variable is null until it is set with value.</span>
<span class="token keyword">DECLARE</span> <span class="token variable">@MyInt3</span> <span class="token keyword">int</span> <span class="token comment">-- variable is null until it is set with value.</span>

<span class="token keyword">SET</span> <span class="token variable">@MyInt3</span>  <span class="token operator">=</span> <span class="token number">3</span>

<span class="token keyword">SELECT</span> <span class="token keyword">COALESCE</span> <span class="token punctuation">(</span><span class="token variable">@MyInt</span><span class="token punctuation">,</span> <span class="token variable">@MyInt2</span> <span class="token punctuation">,</span><span class="token variable">@MyInt3</span> <span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 3 : value of @MyInt3.</span>

</code></pre></div><p>Although ISNULL() operates similarly to COALESCE(), the ISNULL() function only accepts two parameters - one to check, and one to use if the first parameter is NULL.
See also <code>ISNULL</code>, below</p> <h2 id="null-comparison"><a href="#null-comparison" class="header-anchor">#</a> NULL comparison</h2> <p><code>NULL</code> is a special case when it comes to comparisons.</p> <p>Assume the following data.</p> <div class="language-sql extra-class"><pre class="language-sql"><code>id someVal
 <span class="token comment">----</span>
 <span class="token number">0</span> <span class="token boolean">NULL</span>
 <span class="token number">1</span> <span class="token number">1</span>
 <span class="token number">2</span> <span class="token number">2</span>

</code></pre></div><p>With a query:</p> <div class="language- extra-class"><pre class="language-text"><code>
SELECT id
 FROM table
 WHERE someVal = 1

</code></pre></div><p>would return id <code>1</code></p> <div class="language- extra-class"><pre class="language-text"><code>
SELECT id
 FROM table
 WHERE someVal &lt;&gt; 1

</code></pre></div><p>would return id <code>2</code></p> <div class="language- extra-class"><pre class="language-text"><code>
SELECT id
 FROM table
 WHERE someVal IS NULL

</code></pre></div><p>would return id <code>0</code></p> <div class="language- extra-class"><pre class="language-text"><code>
SELECT id
 FROM table
 WHERE someVal IS NOT NULL

</code></pre></div><p>would return both ids <code>1</code> and <code>2</code>.</p> <p>If you wanted NULLs to be &quot;counted&quot; as values in a <code>=</code>, <code>&lt;&gt;</code> comparison, it must first be converted to a countable data type:</p> <div class="language- extra-class"><pre class="language-text"><code>
SELECT id
 FROM table
 WHERE ISNULL(someVal, -1) &lt;&gt; 1

</code></pre></div><p>OR</p> <div class="language- extra-class"><pre class="language-text"><code>
SELECT id
 FROM table
 WHERE someVal IS NULL OR someVal &lt;&gt; 1

</code></pre></div><p>returns <code>0</code> and <code>2</code></p> <p>Or you can change your <a href="http://stackoverflow.com/a/411868/2312877" target="_blank" rel="noopener noreferrer">ANSI Null<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> setting.</p> <h2 id="ansi-nulls"><a href="#ansi-nulls" class="header-anchor">#</a> ANSI NULLS</h2> <p>From <a href="https://msdn.microsoft.com/en-us/library/ms188048.aspx" target="_blank" rel="noopener noreferrer">MSDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote></blockquote> <p>In a future version of SQL Server, ANSI_NULLS will always be ON and any applications that explicitly set the option to OFF will generate an error. Avoid using this feature in new development work, and plan to modify applications that currently use this feature.</p> <p><code>ANSI NULLS</code> being set to off allows for a <code>=</code>/<code>&lt;&gt;</code> comparison of null values.</p> <p>Given the following data:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>id someVal
 <span class="token comment">----</span>
 <span class="token number">0</span> <span class="token boolean">NULL</span>
 <span class="token number">1</span> <span class="token number">1</span>
 <span class="token number">2</span> <span class="token number">2</span>

</code></pre></div><p>And with ANSI NULLS on, this query:</p> <div class="language- extra-class"><pre class="language-text"><code>
SELECT id
 FROM table
 WHERE someVal = NULL

</code></pre></div><p>would produce no results.  However the same query, with ANSI NULLS off:</p> <div class="language- extra-class"><pre class="language-text"><code>
set ansi_nulls off

 SELECT id
 FROM table
 WHERE someVal = NULL

</code></pre></div><p>Would return id <code>0</code>.</p> <h2 id="isnull"><a href="#isnull" class="header-anchor">#</a> ISNULL()</h2> <p>The <code>IsNull()</code> function accepts two parameters, and returns the second parameter if the first one is <code>null</code>.</p> <p>Parameters:</p> <ol><li>check expression. Any expression of any data type.</li> <li>replacement value. This is the value that would be returned if the check expression is null. The replacement value must be of a data type that can be implicitly converted to the data type of the check expression.</li></ol> <p>The <code>IsNull()</code> function returns the same data type as the check expression.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@MyInt</span> <span class="token keyword">int</span> <span class="token comment">-- All variables are null until they are set with values.</span>

<span class="token keyword">SELECT</span> ISNULL<span class="token punctuation">(</span><span class="token variable">@MyInt</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">-- Returns 3.</span>

</code></pre></div><p>See also <code>COALESCE</code>, above</p> <h2 id="is-null-is-not-null"><a href="#is-null-is-not-null" class="header-anchor">#</a> Is null / Is not null</h2> <p>Since null is not a value, you can't use comparison operators with nulls.<br>
To check if a column or variable holds null, you need to use <code>is null</code>:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@Date</span> <span class="token keyword">date</span> <span class="token operator">=</span> <span class="token string">'2016-08-03'</span>

</code></pre></div><p>The following statement will select the value <code>6</code>, since all comparisons with null values evaluates to false or unknown:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">=</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">1</span>
            <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">&lt;&gt;</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">2</span>
            <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">&gt;</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">3</span>
            <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">&lt;</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">4</span>
            <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">IS</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">5</span>
            <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">6</span>

</code></pre></div><p>Setting the content of the @Date variable to <code>null</code> and try again, the following statement will return <code>5</code>:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@Date</span> <span class="token operator">=</span> <span class="token boolean">NULL</span> <span class="token comment">-- Note that the '=' here is an assignment operator!</span>

<span class="token keyword">SELECT</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">=</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">1</span>
            <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">&lt;&gt;</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">2</span>
            <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">&gt;</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">3</span>
            <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">&lt;</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">4</span>
            <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">IS</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">5</span>
            <span class="token keyword">WHEN</span> <span class="token variable">@Date</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">6</span>

</code></pre></div><h2 id="null-with-not-in-subquery"><a href="#null-with-not-in-subquery" class="header-anchor">#</a> NULL with NOT IN SubQuery</h2> <p>While handling not in sub-query with null in the sub-query we need to eliminate NULLS to get your expected results</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token comment">#outertable (i int)</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token comment">#innertable (i int)</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token comment">#outertable (i) values (1), (2),(3),(4), (5)</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token comment">#innertable (i) values (2), (3), (null)</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token comment">#outertable where i in (select i from #innertable)</span>
<span class="token comment">--2</span>
<span class="token comment">--3</span>
<span class="token comment">--So far so good</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token comment">#outertable where i not in (select i from #innertable)</span>
<span class="token comment">--Expectation here is to get 1,4,5 but it is not. It will get empty results because of the NULL it executes as {select * from #outertable where i not in (null)}</span>

<span class="token comment">--To fix this </span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token comment">#outertable where i not in (select i from #innertable where i is not null)</span>
<span class="token comment">--you will get expected results</span>
<span class="token comment">--1</span>
<span class="token comment">--4</span>
<span class="token comment">--5</span>

</code></pre></div><p>While handling not in sub-query with null be cautious with your expected output</p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>SQL Server provides other methods to handle nulls, such as <code>IS NULL</code>, <code>IS NOT NULL</code>, <code>ISNULL()</code>, <code>COALESCE()</code> and others.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/mssql/nulls.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mssql/alias-names-in-sql-server.html" class="prev">
        Alias Names in Sql Server
      </a></span> <span class="next"><a href="/mssql/variables.html">
        Variables
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2032.3306d903.js" defer></script>
  </body>
</html>
