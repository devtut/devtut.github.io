<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Microsoft SQL Server - Retrieve information about the database</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Retrieve a List of all Stored Procedures, Get the list of all databases on a server, Count the Number of Tables in a Database, Database Files, Determine a Windows Login's Permission Path, See if Enterprise-specific features are being used, Retrieve Database Options, Show Size of All Tables in Current Database , Retrieve Tables Containing Known Column, Search and Return All Tables and Columns Containing a Specified Column Value, Get all schemas, tables, columns and indexes, Return a list of SQL Agent jobs, with schedule information, Find every mention of a field in the database, Retrieve information on backup and restore operations">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Microsoft SQL Server - Retrieve information about the database">
    <meta property="og:description" content="Retrieve a List of all Stored Procedures, Get the list of all databases on a server, Count the Number of Tables in a Database, Database Files, Determine a Windows Login's Permission Path, See if Enterprise-specific features are being used, Retrieve Database Options, Show Size of All Tables in Current Database , Retrieve Tables Containing Known Column, Search and Return All Tables and Columns Containing a Specified Column Value, Get all schemas, tables, columns and indexes, Return a list of SQL Agent jobs, with schedule information, Find every mention of a field in the database, Retrieve information on backup and restore operations">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/mssql/retrieve-information-about-the-database.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Microsoft SQL Server - Retrieve information about the database">
    <meta name="twitter:description" content="Retrieve a List of all Stored Procedures, Get the list of all databases on a server, Count the Number of Tables in a Database, Database Files, Determine a Windows Login's Permission Path, See if Enterprise-specific features are being used, Retrieve Database Options, Show Size of All Tables in Current Database , Retrieve Tables Containing Known Column, Search and Return All Tables and Columns Containing a Specified Column Value, Get all schemas, tables, columns and indexes, Return a list of SQL Agent jobs, with schedule information, Find every mention of a field in the database, Retrieve information on backup and restore operations">
    <meta name="twitter:url" content="/mssql/retrieve-information-about-the-database.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2050.e3dc0914.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MS SQL Server</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mssql/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/mssql/getting-started-with-microsoft-sql-server.html" class="sidebar-link">Getting started with Microsoft SQL Server</a></li><li><a href="/mssql/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/mssql/converting-data-types.html" class="sidebar-link">Converting data types</a></li><li><a href="/mssql/user-defined-table-types.html" class="sidebar-link">User Defined Table Types</a></li><li><a href="/mssql/select-statement.html" class="sidebar-link">SELECT statement</a></li><li><a href="/mssql/alias-names-in-sql-server.html" class="sidebar-link">Alias Names in Sql Server</a></li><li><a href="/mssql/nulls.html" class="sidebar-link">NULLs</a></li><li><a href="/mssql/variables.html" class="sidebar-link">Variables</a></li><li><a href="/mssql/dates.html" class="sidebar-link">Dates</a></li><li><a href="/mssql/generating-a-range-of-dates.html" class="sidebar-link">Generating a range of dates</a></li><li><a href="/mssql/database-snapshots.html" class="sidebar-link">Database Snapshots</a></li><li><a href="/mssql/coalesce.html" class="sidebar-link">COALESCE</a></li><li><a href="/mssql/if-else.html" class="sidebar-link">IF...ELSE</a></li><li><a href="/mssql/case-statement.html" class="sidebar-link">CASE Statement</a></li><li><a href="/mssql/insert-into.html" class="sidebar-link">INSERT INTO</a></li><li><a href="/mssql/drop-keyword.html" class="sidebar-link">Drop Keyword</a></li><li><a href="/mssql/merge.html" class="sidebar-link">MERGE</a></li><li><a href="/mssql/create-view.html" class="sidebar-link">CREATE VIEW</a></li><li><a href="/mssql/views.html" class="sidebar-link">Views</a></li><li><a href="/mssql/union.html" class="sidebar-link">UNION</a></li><li><a href="/mssql/try-catch.html" class="sidebar-link">TRY/CATCH</a></li><li><a href="/mssql/while-loop.html" class="sidebar-link">WHILE loop</a></li><li><a href="/mssql/over-clause.html" class="sidebar-link">OVER Clause</a></li><li><a href="/mssql/group-by.html" class="sidebar-link">GROUP BY</a></li><li><a href="/mssql/order-by.html" class="sidebar-link">ORDER BY</a></li><li><a href="/mssql/the-stuff-function.html" class="sidebar-link">The STUFF Function</a></li><li><a href="/mssql/json-in-sql-server.html" class="sidebar-link">JSON in Sql Server</a></li><li><a href="/mssql/openjson.html" class="sidebar-link">OPENJSON</a></li><li><a href="/mssql/for-json.html" class="sidebar-link">FOR JSON</a></li><li><a href="/mssql/queries-with-json-data.html" class="sidebar-link">Queries with JSON data</a></li><li><a href="/mssql/storing-json-in-sql-tables.html" class="sidebar-link">Storing JSON in SQL tables</a></li><li><a href="/mssql/modify-json-text.html" class="sidebar-link">Modify JSON text</a></li><li><a href="/mssql/for-xml-path.html" class="sidebar-link">FOR XML PATH</a></li><li><a href="/mssql/join.html" class="sidebar-link">Join</a></li><li><a href="/mssql/cross-apply.html" class="sidebar-link">cross apply</a></li><li><a href="/mssql/computed-columns.html" class="sidebar-link">Computed Columns</a></li><li><a href="/mssql/common-table-expressions.html" class="sidebar-link">Common Table Expressions</a></li><li><a href="/mssql/move-and-copy-data-around-tables.html" class="sidebar-link">Move and copy data around tables</a></li><li><a href="/mssql/limit-result-set.html" class="sidebar-link">Limit Result Set</a></li><li><a href="/mssql/retrieve-information-about-your-instance.html" class="sidebar-link">Retrieve Information about your Instance</a></li><li><a href="/mssql/with-ties-option.html" class="sidebar-link">With Ties Option</a></li><li><a href="/mssql/string-functions.html" class="sidebar-link">String Functions</a></li><li><a href="/mssql/logical-functions.html" class="sidebar-link">Logical Functions</a></li><li><a href="/mssql/aggregate-functions.html" class="sidebar-link">Aggregate Functions</a></li><li><a href="/mssql/string-aggregate-functions-in-sql-server.html" class="sidebar-link">String Aggregate functions in SQL Server</a></li><li><a href="/mssql/ranking-functions.html" class="sidebar-link">Ranking Functions</a></li><li><a href="/mssql/window-functions.html" class="sidebar-link">Window functions</a></li><li><a href="/mssql/pivot-unpivot.html" class="sidebar-link">PIVOT / UNPIVOT</a></li><li><a href="/mssql/dynamic-sql-pivot.html" class="sidebar-link">Dynamic SQL Pivot</a></li><li><a href="/mssql/partitioning.html" class="sidebar-link">Partitioning</a></li><li><a href="/mssql/stored-procedures.html" class="sidebar-link">Stored Procedures</a></li><li><a href="/mssql/retrieve-information-about-the-database.html" aria-current="page" class="active sidebar-link">Retrieve information about the database</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#retrieve-a-list-of-all-stored-procedures" class="sidebar-link">Retrieve a List of all Stored Procedures</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#get-the-list-of-all-databases-on-a-server" class="sidebar-link">Get the list of all databases on a server</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#count-the-number-of-tables-in-a-database" class="sidebar-link">Count the Number of Tables in a Database</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#database-files" class="sidebar-link">Database Files</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#determine-a-windows-login-s-permission-path" class="sidebar-link">Determine a Windows Login's Permission Path</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#see-if-enterprise-specific-features-are-being-used" class="sidebar-link">See if Enterprise-specific features are being used</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#retrieve-database-options" class="sidebar-link">Retrieve Database Options</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#show-size-of-all-tables-in-current-database" class="sidebar-link">Show Size of All Tables in Current Database</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#retrieve-tables-containing-known-column" class="sidebar-link">Retrieve Tables Containing Known Column</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#search-and-return-all-tables-and-columns-containing-a-specified-column-value" class="sidebar-link">Search and Return All Tables and Columns Containing a Specified Column Value</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#get-all-schemas-tables-columns-and-indexes" class="sidebar-link">Get all schemas, tables, columns and indexes</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#return-a-list-of-sql-agent-jobs-with-schedule-information" class="sidebar-link">Return a list of SQL Agent jobs, with schedule information</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#find-every-mention-of-a-field-in-the-database" class="sidebar-link">Find every mention of a field in the database</a></li><li class="sidebar-sub-header"><a href="/mssql/retrieve-information-about-the-database.html#retrieve-information-on-backup-and-restore-operations" class="sidebar-link">Retrieve information on backup and restore operations</a></li></ul></li><li><a href="/mssql/split-string-function-in-sql-server.html" class="sidebar-link">Split String function in Sql Server</a></li><li><a href="/mssql/insert.html" class="sidebar-link">Insert</a></li><li><a href="/mssql/primary-keys.html" class="sidebar-link">Primary Keys</a></li><li><a href="/mssql/foreign-keys.html" class="sidebar-link">Foreign Keys</a></li><li><a href="/mssql/last-inserted-identity.html" class="sidebar-link">Last Inserted Identity</a></li><li><a href="/mssql/scope-identity.html" class="sidebar-link">SCOPE_IDENTITY()</a></li><li><a href="/mssql/sequences.html" class="sidebar-link">Sequences</a></li><li><a href="/mssql/indexing.html" class="sidebar-link">Indexing</a></li><li><a href="/mssql/full-text-indexing.html" class="sidebar-link">Full-Text Indexing</a></li><li><a href="/mssql/trigger.html" class="sidebar-link">Trigger</a></li><li><a href="/mssql/cursors.html" class="sidebar-link">Cursors</a></li><li><a href="/mssql/transaction-isolation-levels.html" class="sidebar-link">Transaction isolation levels</a></li><li><a href="/mssql/advanced-options.html" class="sidebar-link">Advanced options</a></li><li><a href="/mssql/migration.html" class="sidebar-link">Migration</a></li><li><a href="/mssql/table-valued-parameters.html" class="sidebar-link">Table Valued Parameters</a></li><li><a href="/mssql/dbmail.html" class="sidebar-link">DBMAIL</a></li><li><a href="/mssql/in-memory-oltp-hekaton.html" class="sidebar-link">In-Memory OLTP (Hekaton)</a></li><li><a href="/mssql/temporal-tables.html" class="sidebar-link">Temporal Tables</a></li><li><a href="/mssql/use-of-temp-table.html" class="sidebar-link">Use of TEMP Table</a></li><li><a href="/mssql/scheduled-task-or-job.html" class="sidebar-link">Scheduled Task or Job</a></li><li><a href="/mssql/isolation-levels-and-locking.html" class="sidebar-link">Isolation levels and locking</a></li><li><a href="/mssql/sorting-ordering-rows.html" class="sidebar-link">Sorting/ordering rows</a></li><li><a href="/mssql/privileges-or-permissions.html" class="sidebar-link">Privileges or Permissions</a></li><li><a href="/mssql/sqlcmd.html" class="sidebar-link">SQLCMD</a></li><li><a href="/mssql/resource-governor.html" class="sidebar-link">Resource Governor</a></li><li><a href="/mssql/file-group.html" class="sidebar-link">File Group</a></li><li><a href="/mssql/basic-ddl-operations-in-ms-sql-server.html" class="sidebar-link">Basic DDL Operations in MS SQL Server</a></li><li><a href="/mssql/subqueries.html" class="sidebar-link">Subqueries</a></li><li><a href="/mssql/pagination.html" class="sidebar-link">Pagination</a></li><li><a href="/mssql/clustered-columnstore.html" class="sidebar-link">CLUSTERED COLUMNSTORE</a></li><li><a href="/mssql/parsename.html" class="sidebar-link">Parsename</a></li><li><a href="/mssql/installing-sql-server-on-windows.html" class="sidebar-link">Installing SQL Server on Windows</a></li><li><a href="/mssql/analyzing-a-query.html" class="sidebar-link">Analyzing a Query</a></li><li><a href="/mssql/query-hints.html" class="sidebar-link">Query Hints</a></li><li><a href="/mssql/query-store.html" class="sidebar-link">Query Store</a></li><li><a href="/mssql/querying-results-by-page.html" class="sidebar-link">Querying results by page</a></li><li><a href="/mssql/schemas.html" class="sidebar-link">Schemas</a></li><li><a href="/mssql/backup-and-restore-database.html" class="sidebar-link">Backup and Restore Database</a></li><li><a href="/mssql/transaction-handling.html" class="sidebar-link">Transaction handling</a></li><li><a href="/mssql/natively-compiled-modules-hekaton.html" class="sidebar-link">Natively compiled modules (Hekaton)</a></li><li><a href="/mssql/spatial-data.html" class="sidebar-link">Spatial Data</a></li><li><a href="/mssql/dynamic-sql.html" class="sidebar-link">Dynamic SQL</a></li><li><a href="/mssql/dynamic-data-masking.html" class="sidebar-link">Dynamic data masking</a></li><li><a href="/mssql/export-data-in-txt-file-by-using-sqlcmd.html" class="sidebar-link">Export data in txt file by using SQLCMD</a></li><li><a href="/mssql/common-language-runtime-integration.html" class="sidebar-link">Common Language Runtime Integration</a></li><li><a href="/mssql/delimiting-special-characters-and-reserved-words.html" class="sidebar-link">Delimiting special characters and reserved words</a></li><li><a href="/mssql/dbcc.html" class="sidebar-link">DBCC</a></li><li><a href="/mssql/bulk-import.html" class="sidebar-link">BULK Import</a></li><li><a href="/mssql/service-broker.html" class="sidebar-link">Service broker</a></li><li><a href="/mssql/permissions-and-security.html" class="sidebar-link">Permissions and Security</a></li><li><a href="/mssql/database-permissions.html" class="sidebar-link">Database permissions</a></li><li><a href="/mssql/row-level-security.html" class="sidebar-link">Row-level security</a></li><li><a href="/mssql/encryption.html" class="sidebar-link">Encryption</a></li><li><a href="/mssql/phantom-read.html" class="sidebar-link">PHANTOM read</a></li><li><a href="/mssql/filestream.html" class="sidebar-link">Filestream</a></li><li><a href="/mssql/bcp-bulk-copy-program-utility.html" class="sidebar-link">bcp (bulk copy program) Utility</a></li><li><a href="/mssql/sql-server-evolution-through-different-versions-2000-2016.html" class="sidebar-link">SQL Server Evolution through different versions (2000 - 2016)</a></li><li><a href="/mssql/sql-server-management-studio-ssms.html" class="sidebar-link">SQL Server Management Studio (SSMS)</a></li><li><a href="/mssql/managing-azure-sql-database.html" class="sidebar-link">Managing Azure SQL Database</a></li><li><a href="/mssql/system-database-tempdb.html" class="sidebar-link">System database - TempDb</a></li><li><a href="/mssql/microsoft-sql-server-management-studio-shortcut-keys.html" class="sidebar-link">Microsoft SQL Server Management Studio Shortcut Keys</a></li><li><a href="/mssql/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="retrieve-information-about-the-database"><a href="#retrieve-information-about-the-database" class="header-anchor">#</a> Retrieve information about the database</h1> <h2 id="retrieve-a-list-of-all-stored-procedures"><a href="#retrieve-a-list-of-all-stored-procedures" class="header-anchor">#</a> Retrieve a List of all Stored Procedures</h2> <p>The following queries will return a list of all Stored Procedures in the database, with basic information about each Stored Procedure:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> INFORMATION_SCHEMA<span class="token punctuation">.</span>ROUTINES
<span class="token keyword">WHERE</span> ROUTINE_TYPE <span class="token operator">=</span> <span class="token string">'PROCEDURE'</span>

</code></pre></div><p>The <code>ROUTINE_NAME</code>, <code>ROUTINE_SCHEMA</code> and <code>ROUTINE_DEFINITION</code> columns are generally the most useful.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>objects
<span class="token keyword">WHERE</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">'P'</span>

</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>procedures

</code></pre></div><p>Note that this version has an advantage over selecting from sys.objects since it includes the additional columns <code>is_auto_executed</code>, <code>is_execution_replicated</code>, <code>is_repl_serializable</code>, and <code>skips_repl_constraints</code>.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> sysobjects
<span class="token keyword">WHERE</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">'P'</span>

</code></pre></div><p>Note that the output contains many columns that will never relate to a stored procedure.</p> <p>The next set of queries will return all Stored Procedures in the database that include the string 'SearchTerm':</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> o<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> syscomments c
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> sysobjects o
    <span class="token keyword">ON</span> c<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>id
<span class="token keyword">WHERE</span> o<span class="token punctuation">.</span>xtype <span class="token operator">=</span> <span class="token string">'P'</span>
    <span class="token operator">AND</span> c<span class="token punctuation">.</span><span class="token keyword">TEXT</span> <span class="token operator">LIKE</span> <span class="token string">'%SearchTerm%'</span>

</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> p<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>sql_modules <span class="token keyword">AS</span> m
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span>procedures <span class="token keyword">AS</span> p
    <span class="token keyword">ON</span> m<span class="token punctuation">.</span>object_id <span class="token operator">=</span> p<span class="token punctuation">.</span>object_id
<span class="token keyword">WHERE</span> definition <span class="token operator">LIKE</span> <span class="token string">'%SearchTerm%'</span>

</code></pre></div><h2 id="get-the-list-of-all-databases-on-a-server"><a href="#get-the-list-of-all-databases-on-a-server" class="header-anchor">#</a> Get the list of all databases on a server</h2> <p><strong>Method 1:</strong> Below query will be applicable for SQL Server 2000+ version (Contains 12 columns)</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> dbo<span class="token punctuation">.</span>sysdatabases

</code></pre></div><p><strong>Method 2:</strong> Below query extract information about databases with more informations (ex: State, Isolation, recovery model etc.)</p> <p>Note: This is a catalog view and will be available SQL SERVER 2005+ versions</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sys<span class="token punctuation">.</span><span class="token keyword">databases</span>

</code></pre></div><p><strong>Method 3:</strong> To see just database names you can use undocumented sp_MSForEachDB</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">EXEC</span> sp_MSForEachDB <span class="token string">'SELECT ''?'' AS DatabaseName'</span>

</code></pre></div><p><strong>Method 4:</strong> Below SP will help you to provide database size along with databases name , owner, status etc. on the server</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">EXEC</span> sp_helpdb

</code></pre></div><p><strong>Method 5</strong> Similarly, below stored procedure will give database name, database size and Remarks</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">EXEC</span> sp_databases

</code></pre></div><h2 id="count-the-number-of-tables-in-a-database"><a href="#count-the-number-of-tables-in-a-database" class="header-anchor">#</a> Count the Number of Tables in a Database</h2> <p>This query will return the number of tables in the specified database.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">USE</span> YourDatabaseName
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> INFORMATION_SCHEMA<span class="token punctuation">.</span><span class="token keyword">TABLES</span>
<span class="token keyword">WHERE</span> TABLE_TYPE <span class="token operator">=</span> <span class="token string">'BASE TABLE'</span> 

</code></pre></div><p>Following is another way this can be done for all user tables with SQL Server 2008+. The reference is <a href="https://msdn.microsoft.com/en-us/library/ms187406.aspx?f=255&amp;MSPPError=-2147217396" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> sys<span class="token punctuation">.</span><span class="token keyword">tables</span>

</code></pre></div><h2 id="database-files"><a href="#database-files" class="header-anchor">#</a> Database Files</h2> <p>Display all data files for all databases with size and growth info</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span>  d<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token string">'Database'</span><span class="token punctuation">,</span>
        d<span class="token punctuation">.</span>database_id<span class="token punctuation">,</span>  
        SF<span class="token punctuation">.</span>fileid<span class="token punctuation">,</span>
        SF<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token string">'LogicalFileName'</span><span class="token punctuation">,</span>   
        <span class="token keyword">CASE</span> SF<span class="token punctuation">.</span><span class="token keyword">status</span> <span class="token operator">&amp;</span> <span class="token number">0x100000</span>  
            <span class="token keyword">WHEN</span> <span class="token number">1048576</span> <span class="token keyword">THEN</span> <span class="token string">'Percentage'</span> 
            <span class="token keyword">WHEN</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'MB'</span> 
        <span class="token keyword">END</span> <span class="token keyword">AS</span> <span class="token string">'FileGrowthOption'</span><span class="token punctuation">,</span>
        Growth <span class="token keyword">AS</span> GrowthUnit<span class="token punctuation">,</span>
        <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>CAST<span class="token punctuation">(</span>Size <span class="token keyword">AS</span> <span class="token keyword">FLOAT</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>SizeGB<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">-- Convert 8k pages to GB</span>
        Maxsize<span class="token punctuation">,</span>        
        filename <span class="token keyword">AS</span> PhysicalFileName

<span class="token keyword">FROM</span>    Master<span class="token punctuation">.</span>SYS<span class="token punctuation">.</span>SYSALTFILES SF
<span class="token keyword">Join</span>    Master<span class="token punctuation">.</span>SYS<span class="token punctuation">.</span><span class="token keyword">Databases</span> d <span class="token keyword">on</span> sf<span class="token punctuation">.</span>fileid <span class="token operator">=</span> d<span class="token punctuation">.</span>database_id

<span class="token keyword">Order</span> <span class="token keyword">by</span> d<span class="token punctuation">.</span>name

</code></pre></div><h2 id="determine-a-windows-login-s-permission-path"><a href="#determine-a-windows-login-s-permission-path" class="header-anchor">#</a> Determine a Windows Login's Permission Path</h2> <p>This will show the user type and permission path (which windows group the user is getting its permissions from).</p> <div class="language-sql extra-class"><pre class="language-sql"><code>xp_logininfo <span class="token string">'DOMAIN\user'</span>

</code></pre></div><h2 id="see-if-enterprise-specific-features-are-being-used"><a href="#see-if-enterprise-specific-features-are-being-used" class="header-anchor">#</a> See if Enterprise-specific features are being used</h2> <p>It is sometimes useful to verify that your work on Developer edition hasn't introduced a dependency on any features restricted to Enterprise edition.</p> <p>You can do this using the <code>sys.dm_db_persisted_sku_features</code> system view, like so:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>dm_db_persisted_sku_features

</code></pre></div><p>Against the database itself.</p> <p>This will list the features being used, if any.</p> <h2 id="retrieve-database-options"><a href="#retrieve-database-options" class="header-anchor">#</a> Retrieve Database Options</h2> <p>The following query returns the database options and metadata:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> sys<span class="token punctuation">.</span><span class="token keyword">databases</span> <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token string">'MyDatabaseName'</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="show-size-of-all-tables-in-current-database"><a href="#show-size-of-all-tables-in-current-database" class="header-anchor">#</a> Show Size of All Tables in Current Database</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    s<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> t<span class="token punctuation">.</span>NAME <span class="token keyword">AS</span> TableName<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>used_pages<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">8</span> <span class="token keyword">AS</span> <span class="token string">'TableSizeKB'</span>  <span class="token comment">--a page in SQL Server is 8kb</span>
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span><span class="token keyword">tables</span> t
    <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span>schemas s <span class="token keyword">on</span> t<span class="token punctuation">.</span>schema_id <span class="token operator">=</span> s<span class="token punctuation">.</span>schema_id
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span>indexes i <span class="token keyword">ON</span> t<span class="token punctuation">.</span>OBJECT_ID <span class="token operator">=</span> i<span class="token punctuation">.</span>object_id
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span>partitions p <span class="token keyword">ON</span> i<span class="token punctuation">.</span>object_id <span class="token operator">=</span> p<span class="token punctuation">.</span>OBJECT_ID <span class="token operator">AND</span> i<span class="token punctuation">.</span>index_id <span class="token operator">=</span> p<span class="token punctuation">.</span>index_id
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span>allocation_units a <span class="token keyword">ON</span> p<span class="token punctuation">.</span>partition_id <span class="token operator">=</span> a<span class="token punctuation">.</span>container_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
    s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> t<span class="token punctuation">.</span>name
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
    <span class="token comment">--Either sort by name:</span>
    s<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> t<span class="token punctuation">.</span>NAME
    <span class="token comment">--Or sort largest to smallest:</span>
    <span class="token comment">--SUM(a.used_pages) desc</span>

</code></pre></div><h2 id="retrieve-tables-containing-known-column"><a href="#retrieve-tables-containing-known-column" class="header-anchor">#</a> Retrieve Tables Containing Known Column</h2> <p>This query will return all <code>COLUMNS</code> and their associated <code>TABLES</code> for a given column name. It is designed to show you what tables (unknown) contain a specified column (known)</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
    c<span class="token punctuation">.</span>name <span class="token keyword">AS</span> ColName<span class="token punctuation">,</span> 
    t<span class="token punctuation">.</span>name <span class="token keyword">AS</span> TableName
<span class="token keyword">FROM</span> 
    sys<span class="token punctuation">.</span><span class="token keyword">columns</span> c
    <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span><span class="token keyword">tables</span> t <span class="token keyword">ON</span> c<span class="token punctuation">.</span>object_id <span class="token operator">=</span> t<span class="token punctuation">.</span>object_id
<span class="token keyword">WHERE</span> 
    c<span class="token punctuation">.</span>name <span class="token operator">LIKE</span> <span class="token string">'%MyName%'</span>

</code></pre></div><h2 id="search-and-return-all-tables-and-columns-containing-a-specified-column-value"><a href="#search-and-return-all-tables-and-columns-containing-a-specified-column-value" class="header-anchor">#</a> Search and Return All Tables and Columns Containing a Specified Column Value</h2> <p>This script, from <a href="http://stackoverflow.com/questions/1796506/search-all-tables-all-columns-for-a-specific-value-sql-server" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="http://thesitedoctor.co.uk/blog/search-every-table-and-field-in-a-sql-server-database-updated" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, will return all Tables and Columns where a specified value exists. This is powerful in finding out where a certain value is in a database. It can be taxing, so it is suggested that it be executed in a backup / test enviroment first.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@SearchStr</span> nvarchar<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">SET</span> <span class="token variable">@SearchStr</span> <span class="token operator">=</span> <span class="token string">'## YOUR STRING HERE ##'</span>
 
 
    <span class="token comment">-- Copyright Â© 2002 Narayana Vyas Kondreddi. All rights reserved.</span>
    <span class="token comment">-- Purpose: To search all columns of all tables for a given search string</span>
    <span class="token comment">-- Written by: Narayana Vyas Kondreddi</span>
    <span class="token comment">-- Site: http://vyaskn.tripod.com</span>
    <span class="token comment">-- Updated and tested by Tim Gaunt</span>
    <span class="token comment">-- http://www.thesitedoctor.co.uk</span>
    <span class="token comment">-- http://blogs.thesitedoctor.co.uk/tim/2010/02/19/Search+Every+Table+And+Field+In+A+SQL+Server+Database+Updated.aspx</span>
    <span class="token comment">-- Tested on: SQL Server 7.0, SQL Server 2000, SQL Server 2005 and SQL Server 2010</span>
    <span class="token comment">-- Date modified: 03rd March 2011 19:00 GMT</span>
    <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token comment">#Results (ColumnName nvarchar(370), ColumnValue nvarchar(3630))</span>
 
    <span class="token keyword">SET</span> NOCOUNT <span class="token keyword">ON</span>
 
    <span class="token keyword">DECLARE</span> <span class="token variable">@TableName</span> nvarchar<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">@ColumnName</span> nvarchar<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">@SearchStr2</span> nvarchar<span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">)</span>
    <span class="token keyword">SET</span>  <span class="token variable">@TableName</span> <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">SET</span> <span class="token variable">@SearchStr2</span> <span class="token operator">=</span> QUOTENAME<span class="token punctuation">(</span><span class="token string">'%'</span> <span class="token operator">+</span> <span class="token variable">@SearchStr</span> <span class="token operator">+</span> <span class="token string">'%'</span><span class="token punctuation">,</span><span class="token string">''''</span><span class="token punctuation">)</span>
 
    <span class="token keyword">WHILE</span> <span class="token variable">@TableName</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
     
    <span class="token keyword">BEGIN</span>
        <span class="token keyword">SET</span> <span class="token variable">@ColumnName</span> <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">SET</span> <span class="token variable">@TableName</span> <span class="token operator">=</span>
        <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>QUOTENAME<span class="token punctuation">(</span>TABLE_SCHEMA<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> QUOTENAME<span class="token punctuation">(</span>TABLE_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">FROM</span>     INFORMATION_SCHEMA<span class="token punctuation">.</span><span class="token keyword">TABLES</span>
            <span class="token keyword">WHERE</span>         TABLE_TYPE <span class="token operator">=</span> <span class="token string">'BASE TABLE'</span>
                <span class="token operator">AND</span>    QUOTENAME<span class="token punctuation">(</span>TABLE_SCHEMA<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> QUOTENAME<span class="token punctuation">(</span>TABLE_NAME<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token variable">@TableName</span>
                <span class="token operator">AND</span>    OBJECTPROPERTY<span class="token punctuation">(</span>
                        OBJECT_ID<span class="token punctuation">(</span>
                            QUOTENAME<span class="token punctuation">(</span>TABLE_SCHEMA<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> QUOTENAME<span class="token punctuation">(</span>TABLE_NAME<span class="token punctuation">)</span>
                             <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'IsMSShipped'</span>
                               <span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token punctuation">)</span>
 
        <span class="token keyword">WHILE</span> <span class="token punctuation">(</span><span class="token variable">@TableName</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token variable">@ColumnName</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span>
             
        <span class="token keyword">BEGIN</span>
            <span class="token keyword">SET</span> <span class="token variable">@ColumnName</span> <span class="token operator">=</span>
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>QUOTENAME<span class="token punctuation">(</span>COLUMN_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">FROM</span>     INFORMATION_SCHEMA<span class="token punctuation">.</span><span class="token keyword">COLUMNS</span>
                <span class="token keyword">WHERE</span>         TABLE_SCHEMA    <span class="token operator">=</span> PARSENAME<span class="token punctuation">(</span><span class="token variable">@TableName</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
                    <span class="token operator">AND</span>    TABLE_NAME    <span class="token operator">=</span> PARSENAME<span class="token punctuation">(</span><span class="token variable">@TableName</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token operator">AND</span>    DATA_TYPE <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'char'</span><span class="token punctuation">,</span> <span class="token string">'varchar'</span><span class="token punctuation">,</span> <span class="token string">'nchar'</span><span class="token punctuation">,</span> <span class="token string">'nvarchar'</span><span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token string">'decimal'</span><span class="token punctuation">)</span>
                    <span class="token operator">AND</span>    QUOTENAME<span class="token punctuation">(</span>COLUMN_NAME<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token variable">@ColumnName</span>
            <span class="token punctuation">)</span>
     
            <span class="token keyword">IF</span> <span class="token variable">@ColumnName</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
             
            <span class="token keyword">BEGIN</span>
                <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token comment">#Results</span>
                <span class="token keyword">EXEC</span>
                <span class="token punctuation">(</span>
                    <span class="token string">'SELECT '''</span> <span class="token operator">+</span> <span class="token variable">@TableName</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> <span class="token variable">@ColumnName</span> <span class="token operator">+</span> <span class="token string">''', LEFT('</span> <span class="token operator">+</span> <span class="token variable">@ColumnName</span> <span class="token operator">+</span> <span class="token string">', 3630) FROM '</span> <span class="token operator">+</span> <span class="token variable">@TableName</span> <span class="token operator">+</span> <span class="token string">' (NOLOCK) '</span> <span class="token operator">+</span>
                    <span class="token string">' WHERE '</span> <span class="token operator">+</span> <span class="token variable">@ColumnName</span> <span class="token operator">+</span> <span class="token string">' LIKE '</span> <span class="token operator">+</span> <span class="token variable">@SearchStr2</span>
                <span class="token punctuation">)</span>
            <span class="token keyword">END</span>
        <span class="token keyword">END</span>   
    <span class="token keyword">END</span>
 
    <span class="token keyword">SELECT</span> ColumnName<span class="token punctuation">,</span> ColumnValue <span class="token keyword">FROM</span> <span class="token comment">#Results</span>
 
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token comment">#Results</span>
<span class="token operator">-</span> See more at: http:<span class="token comment">//thesitedoctor.co.uk/blog/search-every-table-and-field-in-a-sql-server-database-updated#sthash.bBEqfJVZ.dpuf</span>

</code></pre></div><h2 id="get-all-schemas-tables-columns-and-indexes"><a href="#get-all-schemas-tables-columns-and-indexes" class="header-anchor">#</a> Get all schemas, tables, columns and indexes</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">schema</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    t<span class="token punctuation">.</span>object_id <span class="token keyword">AS</span> <span class="token punctuation">[</span>table_object_id<span class="token punctuation">]</span><span class="token punctuation">,</span> 
    t<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token punctuation">[</span>table_name<span class="token punctuation">]</span><span class="token punctuation">,</span>
    c<span class="token punctuation">.</span>column_id<span class="token punctuation">,</span>
    c<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token punctuation">[</span>column_name<span class="token punctuation">]</span><span class="token punctuation">,</span>
    i<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token punctuation">[</span>index_name<span class="token punctuation">]</span><span class="token punctuation">,</span>
    i<span class="token punctuation">.</span>type_desc <span class="token keyword">AS</span> <span class="token punctuation">[</span>index_type<span class="token punctuation">]</span>
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>schemas <span class="token keyword">AS</span> s
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">AS</span> t 
    <span class="token keyword">ON</span> s<span class="token punctuation">.</span>schema_id <span class="token operator">=</span> t<span class="token punctuation">.</span>schema_id
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">AS</span> c 
    <span class="token keyword">ON</span> t<span class="token punctuation">.</span>object_id <span class="token operator">=</span> c<span class="token punctuation">.</span>object_id
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span>index_columns <span class="token keyword">AS</span> ic 
    <span class="token keyword">ON</span> c<span class="token punctuation">.</span>object_id <span class="token operator">=</span> ic<span class="token punctuation">.</span>object_id <span class="token operator">and</span> c<span class="token punctuation">.</span>column_id <span class="token operator">=</span> ic<span class="token punctuation">.</span>column_id
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span>indexes <span class="token keyword">AS</span> i 
    <span class="token keyword">ON</span> ic<span class="token punctuation">.</span>object_id <span class="token operator">=</span> i<span class="token punctuation">.</span>object_id <span class="token operator">and</span> ic<span class="token punctuation">.</span>index_id <span class="token operator">=</span> i<span class="token punctuation">.</span>index_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">[</span><span class="token keyword">schema</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>table_name<span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>column_id<span class="token punctuation">;</span>

</code></pre></div><h2 id="return-a-list-of-sql-agent-jobs-with-schedule-information"><a href="#return-a-list-of-sql-agent-jobs-with-schedule-information" class="header-anchor">#</a> Return a list of SQL Agent jobs, with schedule information</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">USE</span> msdb
Go


<span class="token keyword">SELECT</span> dbo<span class="token punctuation">.</span>sysjobs<span class="token punctuation">.</span>Name <span class="token keyword">AS</span> <span class="token string">'Job Name'</span><span class="token punctuation">,</span> 
      <span class="token string">'Job Enabled'</span> <span class="token operator">=</span> <span class="token keyword">CASE</span> dbo<span class="token punctuation">.</span>sysjobs<span class="token punctuation">.</span>Enabled
            <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'Yes'</span>
            <span class="token keyword">WHEN</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'No'</span>
      <span class="token keyword">END</span><span class="token punctuation">,</span>
      <span class="token string">'Frequency'</span> <span class="token operator">=</span> <span class="token keyword">CASE</span> dbo<span class="token punctuation">.</span>sysschedules<span class="token punctuation">.</span>freq_type
            <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'Once'</span>
            <span class="token keyword">WHEN</span> <span class="token number">4</span> <span class="token keyword">THEN</span> <span class="token string">'Daily'</span>
            <span class="token keyword">WHEN</span> <span class="token number">8</span> <span class="token keyword">THEN</span> <span class="token string">'Weekly'</span>
            <span class="token keyword">WHEN</span> <span class="token number">16</span> <span class="token keyword">THEN</span> <span class="token string">'Monthly'</span>
            <span class="token keyword">WHEN</span> <span class="token number">32</span> <span class="token keyword">THEN</span> <span class="token string">'Monthly relative'</span>
            <span class="token keyword">WHEN</span> <span class="token number">64</span> <span class="token keyword">THEN</span> <span class="token string">'When SQLServer Agent starts'</span>
      <span class="token keyword">END</span><span class="token punctuation">,</span> 
      <span class="token string">'Start Date'</span> <span class="token operator">=</span> <span class="token keyword">CASE</span> active_start_date
            <span class="token keyword">WHEN</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span>
            <span class="token keyword">ELSE</span>
            substring<span class="token punctuation">(</span><span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>active_start_date<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> 
            substring<span class="token punctuation">(</span><span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>active_start_date<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> 
            substring<span class="token punctuation">(</span><span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>active_start_date<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
      <span class="token keyword">END</span><span class="token punctuation">,</span>
      <span class="token string">'Start Time'</span> <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token function">len</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:00:0'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">2</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:00:'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">3</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:0'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">4</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">5</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'0'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> 
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">6</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> 
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>active_start_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">END</span><span class="token punctuation">,</span>

      <span class="token keyword">CASE</span> <span class="token function">len</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:00:0'</span>
                        <span class="token operator">+</span> cast<span class="token punctuation">(</span>run_duration <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">2</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:00:'</span>
                        <span class="token operator">+</span> cast<span class="token punctuation">(</span>run_duration <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">3</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:0'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">4</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">5</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'0'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> 
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">6</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> 
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">END</span> <span class="token keyword">as</span> <span class="token string">'Max Duration'</span><span class="token punctuation">,</span>
    <span class="token keyword">CASE</span><span class="token punctuation">(</span>dbo<span class="token punctuation">.</span>sysschedules<span class="token punctuation">.</span>freq_subday_interval<span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'Once'</span>
            <span class="token keyword">ELSE</span> cast<span class="token punctuation">(</span><span class="token string">'Every '</span> 
                        <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>dbo<span class="token punctuation">.</span>sysschedules<span class="token punctuation">.</span>freq_subday_interval<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> 
                        <span class="token operator">+</span> <span class="token string">' '</span>
                        <span class="token operator">+</span>     <span class="token keyword">CASE</span><span class="token punctuation">(</span>dbo<span class="token punctuation">.</span>sysschedules<span class="token punctuation">.</span>freq_subday_type<span class="token punctuation">)</span>
                                          <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'Once'</span>
                                          <span class="token keyword">WHEN</span> <span class="token number">4</span> <span class="token keyword">THEN</span> <span class="token string">'Minutes'</span>
                                          <span class="token keyword">WHEN</span> <span class="token number">8</span> <span class="token keyword">THEN</span> <span class="token string">'Hours'</span>
                                    <span class="token keyword">END</span> <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">END</span> <span class="token keyword">as</span> <span class="token string">'Subday Frequency'</span>
<span class="token keyword">FROM</span> dbo<span class="token punctuation">.</span>sysjobs 
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> dbo<span class="token punctuation">.</span>sysjobschedules 
<span class="token keyword">ON</span> dbo<span class="token punctuation">.</span>sysjobs<span class="token punctuation">.</span>job_id <span class="token operator">=</span> dbo<span class="token punctuation">.</span>sysjobschedules<span class="token punctuation">.</span>job_id
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> dbo<span class="token punctuation">.</span>sysschedules <span class="token keyword">ON</span> dbo<span class="token punctuation">.</span>sysjobschedules<span class="token punctuation">.</span>schedule_id <span class="token operator">=</span> dbo<span class="token punctuation">.</span>sysschedules<span class="token punctuation">.</span>schedule_id 
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> job_id<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">)</span> <span class="token keyword">AS</span> run_duration
            <span class="token keyword">FROM</span> dbo<span class="token punctuation">.</span>sysjobhistory
            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id<span class="token punctuation">)</span> Q1
<span class="token keyword">ON</span> dbo<span class="token punctuation">.</span>sysjobs<span class="token punctuation">.</span>job_id <span class="token operator">=</span> Q1<span class="token punctuation">.</span>job_id
<span class="token keyword">WHERE</span> Next_run_time <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">UNION</span>

<span class="token keyword">SELECT</span> dbo<span class="token punctuation">.</span>sysjobs<span class="token punctuation">.</span>Name <span class="token keyword">AS</span> <span class="token string">'Job Name'</span><span class="token punctuation">,</span> 
      <span class="token string">'Job Enabled'</span> <span class="token operator">=</span> <span class="token keyword">CASE</span> dbo<span class="token punctuation">.</span>sysjobs<span class="token punctuation">.</span>Enabled
            <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'Yes'</span>
            <span class="token keyword">WHEN</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'No'</span>
      <span class="token keyword">END</span><span class="token punctuation">,</span>
      <span class="token string">'Frequency'</span> <span class="token operator">=</span> <span class="token keyword">CASE</span> dbo<span class="token punctuation">.</span>sysschedules<span class="token punctuation">.</span>freq_type
            <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'Once'</span>
            <span class="token keyword">WHEN</span> <span class="token number">4</span> <span class="token keyword">THEN</span> <span class="token string">'Daily'</span>
            <span class="token keyword">WHEN</span> <span class="token number">8</span> <span class="token keyword">THEN</span> <span class="token string">'Weekly'</span>
            <span class="token keyword">WHEN</span> <span class="token number">16</span> <span class="token keyword">THEN</span> <span class="token string">'Monthly'</span>
            <span class="token keyword">WHEN</span> <span class="token number">32</span> <span class="token keyword">THEN</span> <span class="token string">'Monthly relative'</span>
            <span class="token keyword">WHEN</span> <span class="token number">64</span> <span class="token keyword">THEN</span> <span class="token string">'When SQLServer Agent starts'</span>
      <span class="token keyword">END</span><span class="token punctuation">,</span> 
      <span class="token string">'Start Date'</span> <span class="token operator">=</span> <span class="token keyword">CASE</span> next_run_date
            <span class="token keyword">WHEN</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span>
            <span class="token keyword">ELSE</span>
            substring<span class="token punctuation">(</span><span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>next_run_date<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> 
            substring<span class="token punctuation">(</span><span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>next_run_date<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> 
            substring<span class="token punctuation">(</span><span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>next_run_date<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
      <span class="token keyword">END</span><span class="token punctuation">,</span>
      <span class="token string">'Start Time'</span> <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token function">len</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:00:0'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">2</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:00:'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">3</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:0'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">4</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">5</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'0'</span> <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> 
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">6</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> 
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>next_run_time<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">END</span><span class="token punctuation">,</span>

      <span class="token keyword">CASE</span> <span class="token function">len</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:00:0'</span>
                        <span class="token operator">+</span> cast<span class="token punctuation">(</span>run_duration <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">2</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:00:'</span>
                        <span class="token operator">+</span> cast<span class="token punctuation">(</span>run_duration <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">3</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:0'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">4</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'00:'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">5</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token string">'0'</span> 
                        <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> 
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">6</span> <span class="token keyword">THEN</span> cast<span class="token punctuation">(</span><span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> 
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">Left</span><span class="token punctuation">(</span><span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
                        <span class="token operator">+</span><span class="token string">':'</span> <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">char</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">END</span> <span class="token keyword">as</span> <span class="token string">'Max Duration'</span><span class="token punctuation">,</span>
    <span class="token keyword">CASE</span><span class="token punctuation">(</span>dbo<span class="token punctuation">.</span>sysschedules<span class="token punctuation">.</span>freq_subday_interval<span class="token punctuation">)</span>
            <span class="token keyword">WHEN</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'Once'</span>
            <span class="token keyword">ELSE</span> cast<span class="token punctuation">(</span><span class="token string">'Every '</span> 
                        <span class="token operator">+</span> <span class="token keyword">right</span><span class="token punctuation">(</span>dbo<span class="token punctuation">.</span>sysschedules<span class="token punctuation">.</span>freq_subday_interval<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> 
                        <span class="token operator">+</span> <span class="token string">' '</span>
                        <span class="token operator">+</span>     <span class="token keyword">CASE</span><span class="token punctuation">(</span>dbo<span class="token punctuation">.</span>sysschedules<span class="token punctuation">.</span>freq_subday_type<span class="token punctuation">)</span>
                                          <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'Once'</span>
                                          <span class="token keyword">WHEN</span> <span class="token number">4</span> <span class="token keyword">THEN</span> <span class="token string">'Minutes'</span>
                                          <span class="token keyword">WHEN</span> <span class="token number">8</span> <span class="token keyword">THEN</span> <span class="token string">'Hours'</span>
                                    <span class="token keyword">END</span> <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">END</span> <span class="token keyword">as</span> <span class="token string">'Subday Frequency'</span>
<span class="token keyword">FROM</span> dbo<span class="token punctuation">.</span>sysjobs 
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> dbo<span class="token punctuation">.</span>sysjobschedules <span class="token keyword">ON</span> dbo<span class="token punctuation">.</span>sysjobs<span class="token punctuation">.</span>job_id <span class="token operator">=</span> dbo<span class="token punctuation">.</span>sysjobschedules<span class="token punctuation">.</span>job_id
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> dbo<span class="token punctuation">.</span>sysschedules <span class="token keyword">ON</span> dbo<span class="token punctuation">.</span>sysjobschedules<span class="token punctuation">.</span>schedule_id <span class="token operator">=</span> dbo<span class="token punctuation">.</span>sysschedules<span class="token punctuation">.</span>schedule_id 
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> job_id<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>run_duration<span class="token punctuation">)</span> <span class="token keyword">AS</span> run_duration
            <span class="token keyword">FROM</span> dbo<span class="token punctuation">.</span>sysjobhistory
            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id<span class="token punctuation">)</span> Q1
<span class="token keyword">ON</span> dbo<span class="token punctuation">.</span>sysjobs<span class="token punctuation">.</span>job_id <span class="token operator">=</span> Q1<span class="token punctuation">.</span>job_id
<span class="token keyword">WHERE</span> Next_run_time <span class="token operator">&lt;&gt;</span> <span class="token number">0</span>

<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">[</span><span class="token keyword">Start</span> <span class="token keyword">Date</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token keyword">Start</span> <span class="token keyword">Time</span><span class="token punctuation">]</span>

</code></pre></div><h2 id="find-every-mention-of-a-field-in-the-database"><a href="#find-every-mention-of-a-field-in-the-database" class="header-anchor">#</a> Find every mention of a field in the database</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
 o<span class="token punctuation">.</span>name <span class="token keyword">AS</span> Object_Name<span class="token punctuation">,</span>o<span class="token punctuation">.</span>type_desc
 <span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>sql_modules m 
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span>objects  o <span class="token keyword">ON</span> m<span class="token punctuation">.</span>object_id<span class="token operator">=</span>o<span class="token punctuation">.</span>object_id
 <span class="token keyword">WHERE</span> m<span class="token punctuation">.</span>definition <span class="token operator">Like</span> <span class="token string">'%myField%'</span>
 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span>

</code></pre></div><p>Will find mentions of <code>myField</code> in SProcs, Views, etc.</p> <h2 id="retrieve-information-on-backup-and-restore-operations"><a href="#retrieve-information-on-backup-and-restore-operations" class="header-anchor">#</a> Retrieve information on backup and restore operations</h2> <p>To get the list of all backup operations performed on the current database instance:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> sdb<span class="token punctuation">.</span>Name <span class="token keyword">AS</span> DatabaseName<span class="token punctuation">,</span>
    <span class="token keyword">COALESCE</span><span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bus<span class="token punctuation">.</span>backup_finish_date<span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> LastBackUpDateTime
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>sysdatabases sdb
    <span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> msdb<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>backupset bus <span class="token keyword">ON</span> bus<span class="token punctuation">.</span>database_name <span class="token operator">=</span> sdb<span class="token punctuation">.</span>name
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sdb<span class="token punctuation">.</span>name<span class="token punctuation">,</span> bus<span class="token punctuation">.</span>backup_finish_date <span class="token keyword">DESC</span>

</code></pre></div><p>To get the list of all restore operations performed on the current database instance:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
    <span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token keyword">AS</span> database_name<span class="token punctuation">,</span> 
    <span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>restore_date <span class="token keyword">AS</span> last_restore_date<span class="token punctuation">,</span> 
    <span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>user_name<span class="token punctuation">]</span><span class="token punctuation">,</span> 
    <span class="token punctuation">[</span>bs<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>backup_finish_date<span class="token punctuation">]</span> <span class="token keyword">AS</span> backup_creation_date<span class="token punctuation">,</span> 
    <span class="token punctuation">[</span>bmf<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>physical_device_name<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>backup_file_used_for_restore<span class="token punctuation">]</span> 
<span class="token keyword">FROM</span> master<span class="token punctuation">.</span>sys<span class="token punctuation">.</span><span class="token keyword">databases</span> <span class="token punctuation">[</span>d<span class="token punctuation">]</span> 
    <span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> msdb<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span><span class="token punctuation">[</span>restorehistory<span class="token punctuation">]</span> r <span class="token keyword">ON</span> r<span class="token punctuation">.</span><span class="token punctuation">[</span>destination_database_name<span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">.</span>Name 
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> msdb<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>backupset <span class="token punctuation">[</span>bs<span class="token punctuation">]</span> <span class="token keyword">ON</span> <span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>backup_set_id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>bs<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>backup_set_id<span class="token punctuation">]</span> 
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> msdb<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>backupmediafamily bmf <span class="token keyword">ON</span> <span class="token punctuation">[</span>bs<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>media_set_id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>bmf<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>media_set_id<span class="token punctuation">]</span> 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>restore_date <span class="token keyword">DESC</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>As with other relational database systems, SQL Server exposes metadata about your databases.</p> <p>This is provided through the ISO Standard <code>INFORMATION_SCHEMA</code> schema, or the SQL Server-specific <code>sys</code> catalog views.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/mssql/retrieve-information-about-the-database.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â
      <a href="/mssql/stored-procedures.html" class="prev">
        Stored Procedures
      </a></span> <span class="next"><a href="/mssql/split-string-function-in-sql-server.html">
        Split String function in Sql Server
      </a>
      â
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2050.e3dc0914.js" defer></script>
  </body>
</html>
