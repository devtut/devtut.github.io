<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Microsoft SQL Server - Join</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Inner Join, Outer Join, Using Join in an Update, Join on a Subquery, Cross Join, Self Join, Accidentally turning an outer join into an inner join, Delete using Join">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Microsoft SQL Server - Join">
    <meta property="og:description" content="Inner Join, Outer Join, Using Join in an Update, Join on a Subquery, Cross Join, Self Join, Accidentally turning an outer join into an inner join, Delete using Join">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/mssql/join.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Microsoft SQL Server - Join">
    <meta name="twitter:description" content="Inner Join, Outer Join, Using Join in an Update, Join on a Subquery, Cross Join, Self Join, Accidentally turning an outer join into an inner join, Delete using Join">
    <meta name="twitter:url" content="/mssql/join.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/2018.0deaf8f1.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MS SQL Server</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mssql/" class="sidebar-link">Disclaimer</a></li><li><a href="/mssql/getting-started-with-microsoft-sql-server.html" class="sidebar-link">Getting started with Microsoft SQL Server</a></li><li><a href="/mssql/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/mssql/converting-data-types.html" class="sidebar-link">Converting data types</a></li><li><a href="/mssql/user-defined-table-types.html" class="sidebar-link">User Defined Table Types</a></li><li><a href="/mssql/select-statement.html" class="sidebar-link">SELECT statement</a></li><li><a href="/mssql/alias-names-in-sql-server.html" class="sidebar-link">Alias Names in Sql Server</a></li><li><a href="/mssql/nulls.html" class="sidebar-link">NULLs</a></li><li><a href="/mssql/variables.html" class="sidebar-link">Variables</a></li><li><a href="/mssql/dates.html" class="sidebar-link">Dates</a></li><li><a href="/mssql/generating-a-range-of-dates.html" class="sidebar-link">Generating a range of dates</a></li><li><a href="/mssql/database-snapshots.html" class="sidebar-link">Database Snapshots</a></li><li><a href="/mssql/coalesce.html" class="sidebar-link">COALESCE</a></li><li><a href="/mssql/if-else.html" class="sidebar-link">IF...ELSE</a></li><li><a href="/mssql/case-statement.html" class="sidebar-link">CASE Statement</a></li><li><a href="/mssql/insert-into.html" class="sidebar-link">INSERT INTO</a></li><li><a href="/mssql/drop-keyword.html" class="sidebar-link">Drop Keyword</a></li><li><a href="/mssql/merge.html" class="sidebar-link">MERGE</a></li><li><a href="/mssql/create-view.html" class="sidebar-link">CREATE VIEW</a></li><li><a href="/mssql/views.html" class="sidebar-link">Views</a></li><li><a href="/mssql/union.html" class="sidebar-link">UNION</a></li><li><a href="/mssql/try-catch.html" class="sidebar-link">TRY/CATCH</a></li><li><a href="/mssql/while-loop.html" class="sidebar-link">WHILE loop</a></li><li><a href="/mssql/over-clause.html" class="sidebar-link">OVER Clause</a></li><li><a href="/mssql/group-by.html" class="sidebar-link">GROUP BY</a></li><li><a href="/mssql/order-by.html" class="sidebar-link">ORDER BY</a></li><li><a href="/mssql/the-stuff-function.html" class="sidebar-link">The STUFF Function</a></li><li><a href="/mssql/json-in-sql-server.html" class="sidebar-link">JSON in Sql Server</a></li><li><a href="/mssql/openjson.html" class="sidebar-link">OPENJSON</a></li><li><a href="/mssql/for-json.html" class="sidebar-link">FOR JSON</a></li><li><a href="/mssql/queries-with-json-data.html" class="sidebar-link">Queries with JSON data</a></li><li><a href="/mssql/storing-json-in-sql-tables.html" class="sidebar-link">Storing JSON in SQL tables</a></li><li><a href="/mssql/modify-json-text.html" class="sidebar-link">Modify JSON text</a></li><li><a href="/mssql/for-xml-path.html" class="sidebar-link">FOR XML PATH</a></li><li><a href="/mssql/join.html" class="active sidebar-link">Join</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mssql/join.html#inner-join" class="sidebar-link">Inner Join</a></li><li class="sidebar-sub-header"><a href="/mssql/join.html#outer-join" class="sidebar-link">Outer Join</a></li><li class="sidebar-sub-header"><a href="/mssql/join.html#using-join-in-an-update" class="sidebar-link">Using Join in an Update</a></li><li class="sidebar-sub-header"><a href="/mssql/join.html#join-on-a-subquery" class="sidebar-link">Join on a Subquery</a></li><li class="sidebar-sub-header"><a href="/mssql/join.html#cross-join" class="sidebar-link">Cross Join</a></li><li class="sidebar-sub-header"><a href="/mssql/join.html#self-join" class="sidebar-link">Self Join</a></li><li class="sidebar-sub-header"><a href="/mssql/join.html#accidentally-turning-an-outer-join-into-an-inner-join" class="sidebar-link">Accidentally turning an outer join into an inner join</a></li><li class="sidebar-sub-header"><a href="/mssql/join.html#delete-using-join" class="sidebar-link">Delete using Join</a></li></ul></li><li><a href="/mssql/cross-apply.html" class="sidebar-link">cross apply</a></li><li><a href="/mssql/computed-columns.html" class="sidebar-link">Computed Columns</a></li><li><a href="/mssql/common-table-expressions.html" class="sidebar-link">Common Table Expressions</a></li><li><a href="/mssql/move-and-copy-data-around-tables.html" class="sidebar-link">Move and copy data around tables</a></li><li><a href="/mssql/limit-result-set.html" class="sidebar-link">Limit Result Set</a></li><li><a href="/mssql/retrieve-information-about-your-instance.html" class="sidebar-link">Retrieve Information about your Instance</a></li><li><a href="/mssql/with-ties-option.html" class="sidebar-link">With Ties Option</a></li><li><a href="/mssql/string-functions.html" class="sidebar-link">String Functions</a></li><li><a href="/mssql/logical-functions.html" class="sidebar-link">Logical Functions</a></li><li><a href="/mssql/aggregate-functions.html" class="sidebar-link">Aggregate Functions</a></li><li><a href="/mssql/string-aggregate-functions-in-sql-server.html" class="sidebar-link">String Aggregate functions in SQL Server</a></li><li><a href="/mssql/ranking-functions.html" class="sidebar-link">Ranking Functions</a></li><li><a href="/mssql/window-functions.html" class="sidebar-link">Window functions</a></li><li><a href="/mssql/pivot-unpivot.html" class="sidebar-link">PIVOT / UNPIVOT</a></li><li><a href="/mssql/dynamic-sql-pivot.html" class="sidebar-link">Dynamic SQL Pivot</a></li><li><a href="/mssql/partitioning.html" class="sidebar-link">Partitioning</a></li><li><a href="/mssql/stored-procedures.html" class="sidebar-link">Stored Procedures</a></li><li><a href="/mssql/retrieve-information-about-the-database.html" class="sidebar-link">Retrieve information about the database</a></li><li><a href="/mssql/split-string-function-in-sql-server.html" class="sidebar-link">Split String function in Sql Server</a></li><li><a href="/mssql/insert.html" class="sidebar-link">Insert</a></li><li><a href="/mssql/primary-keys.html" class="sidebar-link">Primary Keys</a></li><li><a href="/mssql/foreign-keys.html" class="sidebar-link">Foreign Keys</a></li><li><a href="/mssql/last-inserted-identity.html" class="sidebar-link">Last Inserted Identity</a></li><li><a href="/mssql/scope-identity.html" class="sidebar-link">SCOPE_IDENTITY()</a></li><li><a href="/mssql/sequences.html" class="sidebar-link">Sequences</a></li><li><a href="/mssql/indexing.html" class="sidebar-link">Indexing</a></li><li><a href="/mssql/full-text-indexing.html" class="sidebar-link">Full-Text Indexing</a></li><li><a href="/mssql/trigger.html" class="sidebar-link">Trigger</a></li><li><a href="/mssql/cursors.html" class="sidebar-link">Cursors</a></li><li><a href="/mssql/transaction-isolation-levels.html" class="sidebar-link">Transaction isolation levels</a></li><li><a href="/mssql/advanced-options.html" class="sidebar-link">Advanced options</a></li><li><a href="/mssql/migration.html" class="sidebar-link">Migration</a></li><li><a href="/mssql/table-valued-parameters.html" class="sidebar-link">Table Valued Parameters</a></li><li><a href="/mssql/dbmail.html" class="sidebar-link">DBMAIL</a></li><li><a href="/mssql/in-memory-oltp-hekaton.html" class="sidebar-link">In-Memory OLTP (Hekaton)</a></li><li><a href="/mssql/temporal-tables.html" class="sidebar-link">Temporal Tables</a></li><li><a href="/mssql/use-of-temp-table.html" class="sidebar-link">Use of TEMP Table</a></li><li><a href="/mssql/scheduled-task-or-job.html" class="sidebar-link">Scheduled Task or Job</a></li><li><a href="/mssql/isolation-levels-and-locking.html" class="sidebar-link">Isolation levels and locking</a></li><li><a href="/mssql/sorting-ordering-rows.html" class="sidebar-link">Sorting/ordering rows</a></li><li><a href="/mssql/privileges-or-permissions.html" class="sidebar-link">Privileges or Permissions</a></li><li><a href="/mssql/sqlcmd.html" class="sidebar-link">SQLCMD</a></li><li><a href="/mssql/resource-governor.html" class="sidebar-link">Resource Governor</a></li><li><a href="/mssql/file-group.html" class="sidebar-link">File Group</a></li><li><a href="/mssql/basic-ddl-operations-in-ms-sql-server.html" class="sidebar-link">Basic DDL Operations in MS SQL Server</a></li><li><a href="/mssql/subqueries.html" class="sidebar-link">Subqueries</a></li><li><a href="/mssql/pagination.html" class="sidebar-link">Pagination</a></li><li><a href="/mssql/clustered-columnstore.html" class="sidebar-link">CLUSTERED COLUMNSTORE</a></li><li><a href="/mssql/parsename.html" class="sidebar-link">Parsename</a></li><li><a href="/mssql/installing-sql-server-on-windows.html" class="sidebar-link">Installing SQL Server on Windows</a></li><li><a href="/mssql/analyzing-a-query.html" class="sidebar-link">Analyzing a Query</a></li><li><a href="/mssql/query-hints.html" class="sidebar-link">Query Hints</a></li><li><a href="/mssql/query-store.html" class="sidebar-link">Query Store</a></li><li><a href="/mssql/querying-results-by-page.html" class="sidebar-link">Querying results by page</a></li><li><a href="/mssql/schemas.html" class="sidebar-link">Schemas</a></li><li><a href="/mssql/backup-and-restore-database.html" class="sidebar-link">Backup and Restore Database</a></li><li><a href="/mssql/transaction-handling.html" class="sidebar-link">Transaction handling</a></li><li><a href="/mssql/natively-compiled-modules-hekaton.html" class="sidebar-link">Natively compiled modules (Hekaton)</a></li><li><a href="/mssql/spatial-data.html" class="sidebar-link">Spatial Data</a></li><li><a href="/mssql/dynamic-sql.html" class="sidebar-link">Dynamic SQL</a></li><li><a href="/mssql/dynamic-data-masking.html" class="sidebar-link">Dynamic data masking</a></li><li><a href="/mssql/export-data-in-txt-file-by-using-sqlcmd.html" class="sidebar-link">Export data in txt file by using SQLCMD</a></li><li><a href="/mssql/common-language-runtime-integration.html" class="sidebar-link">Common Language Runtime Integration</a></li><li><a href="/mssql/delimiting-special-characters-and-reserved-words.html" class="sidebar-link">Delimiting special characters and reserved words</a></li><li><a href="/mssql/dbcc.html" class="sidebar-link">DBCC</a></li><li><a href="/mssql/bulk-import.html" class="sidebar-link">BULK Import</a></li><li><a href="/mssql/service-broker.html" class="sidebar-link">Service broker</a></li><li><a href="/mssql/permissions-and-security.html" class="sidebar-link">Permissions and Security</a></li><li><a href="/mssql/database-permissions.html" class="sidebar-link">Database permissions</a></li><li><a href="/mssql/row-level-security.html" class="sidebar-link">Row-level security</a></li><li><a href="/mssql/encryption.html" class="sidebar-link">Encryption</a></li><li><a href="/mssql/phantom-read.html" class="sidebar-link">PHANTOM read</a></li><li><a href="/mssql/filestream.html" class="sidebar-link">Filestream</a></li><li><a href="/mssql/bcp-bulk-copy-program-utility.html" class="sidebar-link">bcp (bulk copy program) Utility</a></li><li><a href="/mssql/sql-server-evolution-through-different-versions-2000-2016.html" class="sidebar-link">SQL Server Evolution through different versions (2000 - 2016)</a></li><li><a href="/mssql/sql-server-management-studio-ssms.html" class="sidebar-link">SQL Server Management Studio (SSMS)</a></li><li><a href="/mssql/managing-azure-sql-database.html" class="sidebar-link">Managing Azure SQL Database</a></li><li><a href="/mssql/system-database-tempdb.html" class="sidebar-link">System database - TempDb</a></li><li><a href="/mssql/microsoft-sql-server-management-studio-shortcut-keys.html" class="sidebar-link">Microsoft SQL Server Management Studio Shortcut Keys</a></li><li><a href="/mssql/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="join"><a href="#join" class="header-anchor">#</a> Join</h1> <p>In Structured Query Language (SQL), a JOIN is a method of linking two data tables in a single query, allowing the database to return a set that contains data from both tables at once, or using data from one table to be used as a Filter on the second table. There are several types of JOINs defined within the ANSI SQL standard.</p> <h2 id="inner-join"><a href="#inner-join" class="header-anchor">#</a> Inner Join</h2> <p><code>Inner join</code> returns only those records/rows that match/exists in both the tables based on one or more conditions (specified using <code>ON</code> keyword). It is the most common type of join. The general syntax for <code>inner join</code> is:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> table_1
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> table_2
  <span class="token keyword">ON</span> table_1<span class="token punctuation">.</span>column_name <span class="token operator">=</span> table_2<span class="token punctuation">.</span>column_name

</code></pre></div><p>It can also be simplified as just <code>JOIN</code>:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> table_1
<span class="token keyword">JOIN</span> table_2
  <span class="token keyword">ON</span> table_1<span class="token punctuation">.</span>column_name <span class="token operator">=</span> table_2<span class="token punctuation">.</span>column_name

</code></pre></div><p>Example</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">/* Sample data. */</span>
<span class="token keyword">DECLARE</span> <span class="token variable">@Animal</span> <span class="token keyword">table</span> <span class="token punctuation">(</span>
    AnimalId <span class="token keyword">Int</span> <span class="token keyword">IDENTITY</span><span class="token punctuation">,</span>
    Animal <span class="token keyword">Varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">DECLARE</span> <span class="token variable">@AnimalSound</span> <span class="token keyword">table</span> <span class="token punctuation">(</span>
    AnimalSoundId <span class="token keyword">Int</span> <span class="token keyword">IDENTITY</span><span class="token punctuation">,</span>
    AnimalId <span class="token keyword">Int</span><span class="token punctuation">,</span>
    Sound <span class="token keyword">Varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Animal</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Dog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Animal</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Cat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Animal</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Elephant'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@AnimalSound</span> <span class="token punctuation">(</span>AnimalId<span class="token punctuation">,</span> Sound<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Barks'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@AnimalSound</span> <span class="token punctuation">(</span>AnimalId<span class="token punctuation">,</span> Sound<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Meows'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@AnimalSound</span> <span class="token punctuation">(</span>AnimalId<span class="token punctuation">,</span> Sound<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Trumpets'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* Sample data prepared. */</span>

<span class="token keyword">SELECT</span> 
    <span class="token operator">*</span> 
<span class="token keyword">FROM</span> 
    <span class="token variable">@Animal</span>
    <span class="token keyword">JOIN</span> <span class="token variable">@AnimalSound</span>
        <span class="token keyword">ON</span> <span class="token variable">@Animal.AnimalId</span> <span class="token operator">=</span> <span class="token variable">@AnimalSound.AnimalId</span><span class="token punctuation">;</span>

</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code>AnimalId    Animal               AnimalSoundId AnimalId    Sound
<span class="token comment">----------- -------------------- ------------- ----------- --------------------</span>
<span class="token number">1</span>           Dog                  <span class="token number">1</span>             <span class="token number">1</span>           Barks
<span class="token number">2</span>           Cat                  <span class="token number">2</span>             <span class="token number">2</span>           Meows
<span class="token number">3</span>           Elephant             <span class="token number">3</span>             <span class="token number">3</span>           Trumpets

</code></pre></div><p><strong>Using inner join with left outer join (Substitute for Not exists)</strong></p> <p>This query will return data from table 1 where fields matching with table2 with a key and data not in Table 1 when comparing with Table2 with a condition and key</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> 
  <span class="token keyword">from</span> Table1 t1
    <span class="token keyword">inner</span> <span class="token keyword">join</span> Table2 t2 <span class="token keyword">on</span> t1<span class="token punctuation">.</span>ID_Column <span class="token operator">=</span> t2<span class="token punctuation">.</span>ID_Column 
    <span class="token keyword">left</span>  <span class="token keyword">join</span> Table3 t3 <span class="token keyword">on</span> t1<span class="token punctuation">.</span>ID_Column <span class="token operator">=</span> t3<span class="token punctuation">.</span>ID_Column 
  <span class="token keyword">where</span> t2<span class="token punctuation">.</span>column_name <span class="token operator">=</span> column_value 
    <span class="token operator">and</span> t3<span class="token punctuation">.</span>ID_Column <span class="token operator">is</span> <span class="token boolean">null</span> 
  <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>column_name<span class="token punctuation">;</span>

</code></pre></div><h2 id="outer-join"><a href="#outer-join" class="header-anchor">#</a> Outer Join</h2> <p><strong>Left Outer Join</strong></p> <p><code>LEFT JOIN</code> returns all rows from the left table, matched to rows from the right table where the <code>ON</code> clause conditions are met. Rows in which the <code>ON</code> clause is not met have <code>NULL</code> in all of the right table's columns. The syntax of a <code>LEFT JOIN</code> is:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table_1 <span class="token keyword">AS</span> t1
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> table_2 <span class="token keyword">AS</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>ID_Column <span class="token operator">=</span> t2<span class="token punctuation">.</span>ID_Column 

</code></pre></div><p><strong>Right Outer Join</strong></p> <p><code>RIGHT JOIN</code> returns all rows from the right table, matched to rows from the left table where the <code>ON</code> clause conditions are met. Rows in which the <code>ON</code> clause is not met have <code>NULL</code> in all of the left table's columns. The syntax of a <code>RIGHT JOIN</code> is:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table_1 <span class="token keyword">AS</span> t1
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> table_2 <span class="token keyword">AS</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>ID_Column <span class="token operator">=</span> t2<span class="token punctuation">.</span>ID_Column 

</code></pre></div><p><strong>Full Outer Join</strong></p> <p><code>FULL JOIN</code> combines <code>LEFT JOIN</code> and <code>RIGHT JOIN</code>. All rows are returned from both tables, regardless of whether the conditions in the <code>ON</code> clause are met. Rows that do not satisfy the <code>ON</code> clause are returned with <code>NULL</code> in all of the opposite table's columns (that is, for a row in the left table, all columns in the right table will contain <code>NULL</code>, and vice versa). The syntax of a <code>FULL JOIN</code> is:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table_1 <span class="token keyword">AS</span> t1
<span class="token keyword">FULL</span> <span class="token keyword">JOIN</span> table_2 <span class="token keyword">AS</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>ID_Column <span class="token operator">=</span> t2<span class="token punctuation">.</span>ID_Column  

</code></pre></div><p><strong>Examples</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">/* Sample test data. */</span>
<span class="token keyword">DECLARE</span> <span class="token variable">@Animal</span> <span class="token keyword">table</span> <span class="token punctuation">(</span>
    AnimalId <span class="token keyword">Int</span> <span class="token keyword">IDENTITY</span><span class="token punctuation">,</span>
    Animal <span class="token keyword">Varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">DECLARE</span> <span class="token variable">@AnimalSound</span> <span class="token keyword">table</span> <span class="token punctuation">(</span>
    AnimalSoundId <span class="token keyword">Int</span> <span class="token keyword">IDENTITY</span><span class="token punctuation">,</span>
    AnimalId <span class="token keyword">Int</span><span class="token punctuation">,</span>
    Sound <span class="token keyword">Varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Animal</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Dog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Animal</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Cat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Animal</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Elephant'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Animal</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Frog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@AnimalSound</span> <span class="token punctuation">(</span>AnimalId<span class="token punctuation">,</span> Sound<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Barks'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@AnimalSound</span> <span class="token punctuation">(</span>AnimalId<span class="token punctuation">,</span> Sound<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Meows'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@AnimalSound</span> <span class="token punctuation">(</span>AnimalId<span class="token punctuation">,</span> Sound<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Trumpet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@AnimalSound</span> <span class="token punctuation">(</span>AnimalId<span class="token punctuation">,</span> Sound<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'Roars'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* Sample data prepared. */</span>

</code></pre></div><p><strong>LEFT OUTER JOIN</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> <span class="token variable">@Animal</span> <span class="token keyword">As</span> t1 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token variable">@AnimalSound</span> <span class="token keyword">As</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>AnimalId <span class="token operator">=</span> t2<span class="token punctuation">.</span>AnimalId<span class="token punctuation">;</span>

</code></pre></div><p>Results for <code>LEFT JOIN</code></p> <div class="language-sql extra-class"><pre class="language-sql"><code>AnimalId    Animal               AnimalSoundId AnimalId    Sound
<span class="token comment">----------- -------------------- ------------- ----------- --------------------</span>
<span class="token number">1</span>           Dog                  <span class="token number">1</span>             <span class="token number">1</span>           Barks
<span class="token number">2</span>           Cat                  <span class="token number">2</span>             <span class="token number">2</span>           Meows
<span class="token number">3</span>           Elephant             <span class="token number">3</span>             <span class="token number">3</span>           Trumpet
<span class="token number">4</span>           Frog                 <span class="token boolean">NULL</span>          <span class="token boolean">NULL</span>        <span class="token boolean">NULL</span>

</code></pre></div><p><strong>RIGHT OUTER JOIN</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> <span class="token variable">@Animal</span> <span class="token keyword">As</span> t1 
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> <span class="token variable">@AnimalSound</span> <span class="token keyword">As</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>AnimalId <span class="token operator">=</span> t2<span class="token punctuation">.</span>AnimalId<span class="token punctuation">;</span>

</code></pre></div><p>Results for <code>RIGHT JOIN</code></p> <div class="language-sql extra-class"><pre class="language-sql"><code>AnimalId    Animal               AnimalSoundId AnimalId    Sound
<span class="token comment">----------- -------------------- ------------- ----------- --------------------</span>
<span class="token number">1</span>           Dog                  <span class="token number">1</span>             <span class="token number">1</span>           Barks
<span class="token number">2</span>           Cat                  <span class="token number">2</span>             <span class="token number">2</span>           Meows
<span class="token number">3</span>           Elephant             <span class="token number">3</span>             <span class="token number">3</span>           Trumpet
<span class="token boolean">NULL</span>        <span class="token boolean">NULL</span>                 <span class="token number">4</span>             <span class="token number">5</span>           Roars

</code></pre></div><p><strong>FULL OUTER JOIN</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> <span class="token variable">@Animal</span> <span class="token keyword">As</span> t1 
<span class="token keyword">FULL</span> <span class="token keyword">JOIN</span> <span class="token variable">@AnimalSound</span> <span class="token keyword">As</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>AnimalId <span class="token operator">=</span> t2<span class="token punctuation">.</span>AnimalId<span class="token punctuation">;</span>

</code></pre></div><p>Results for <code>FULL JOIN</code></p> <div class="language-sql extra-class"><pre class="language-sql"><code>AnimalId    Animal               AnimalSoundId AnimalId    Sound
<span class="token comment">----------- -------------------- ------------- ----------- --------------------</span>
<span class="token number">1</span>           Dog                  <span class="token number">1</span>             <span class="token number">1</span>           Barks
<span class="token number">2</span>           Cat                  <span class="token number">2</span>             <span class="token number">2</span>           Meows
<span class="token number">3</span>           Elephant             <span class="token number">3</span>             <span class="token number">3</span>           Trumpet
<span class="token number">4</span>           Frog                 <span class="token boolean">NULL</span>          <span class="token boolean">NULL</span>        <span class="token boolean">NULL</span>
<span class="token boolean">NULL</span>        <span class="token boolean">NULL</span>                 <span class="token number">4</span>             <span class="token number">5</span>           Roars

</code></pre></div><h2 id="using-join-in-an-update"><a href="#using-join-in-an-update" class="header-anchor">#</a> Using Join in an Update</h2> <p>Joins can also be used in an <code>UPDATE</code> statement:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Users <span class="token punctuation">(</span>
    UserId <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    AccountId <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    RealName nvarchar<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Preferences <span class="token punctuation">(</span>
    UserId <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    SomeSetting <span class="token keyword">bit</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span>

</code></pre></div><p>Update the <code>SomeSetting</code> column of the <code>Preferences</code> table filtering by a predicate on the <code>Users</code> table as follows:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> p
<span class="token keyword">SET</span> p<span class="token punctuation">.</span>SomeSetting <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">FROM</span> Users u
<span class="token keyword">JOIN</span> Preferences p <span class="token keyword">ON</span> u<span class="token punctuation">.</span>UserId <span class="token operator">=</span> p<span class="token punctuation">.</span>UserId
<span class="token keyword">WHERE</span> u<span class="token punctuation">.</span>AccountId <span class="token operator">=</span> <span class="token number">1234</span>

</code></pre></div><p><code>p</code> is an alias for <code>Preferences</code> defined in the <code>FROM</code> clause of the statement. Only rows with a matching <code>AccountId</code> from the <code>Users</code> table will be updated.</p> <p><strong>Update with left outer join statements</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">Update</span> t 
<span class="token keyword">SET</span>  t<span class="token punctuation">.</span>Column1<span class="token operator">=</span><span class="token number">100</span>
<span class="token keyword">FROM</span> Table1 t <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Table12 t2 
<span class="token keyword">ON</span> t2<span class="token punctuation">.</span>ID<span class="token operator">=</span>t<span class="token punctuation">.</span>ID

</code></pre></div><p><strong>Update tables with inner join and aggregate function</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> t1
<span class="token keyword">SET</span> t1<span class="token punctuation">.</span>field1 <span class="token operator">=</span> t2<span class="token punctuation">.</span>field2Sum
<span class="token keyword">FROM</span> table1 t1
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">select</span> field3<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>field2<span class="token punctuation">)</span> <span class="token keyword">as</span> field2Sum
<span class="token keyword">from</span> table2
<span class="token keyword">group</span> <span class="token keyword">by</span> field3<span class="token punctuation">)</span> <span class="token keyword">as</span> t2
<span class="token keyword">on</span> t2<span class="token punctuation">.</span>field3 <span class="token operator">=</span> t1<span class="token punctuation">.</span>field3  

</code></pre></div><h2 id="join-on-a-subquery"><a href="#join-on-a-subquery" class="header-anchor">#</a> Join on a Subquery</h2> <p>Joining on a subquery is often used when you want to get aggregate data (such as Count, Avg, Max, or Min) from a child/details table and display that along with records from the parent/header table. For example, you may want to retrieve the top/first child row based on Date or Id or maybe you want a Count of all Child Rows or an Average.</p> <p>This example uses aliases which makes queries easier to read when you have multiple tables involved. In this case we are retrieving all rows from the parent table Purchase Orders and retrieving only the last (or most recent) child row from the child table PurchaseOrderLineItems. This example assumes the child table uses incremental numeric Id's.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> po<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> po<span class="token punctuation">.</span>PODate<span class="token punctuation">,</span> po<span class="token punctuation">.</span>VendorName<span class="token punctuation">,</span> po<span class="token punctuation">.</span><span class="token keyword">Status</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>ItemNo<span class="token punctuation">,</span> 
  item<span class="token punctuation">.</span>Description<span class="token punctuation">,</span> item<span class="token punctuation">.</span>Cost<span class="token punctuation">,</span> item<span class="token punctuation">.</span>Price
<span class="token keyword">FROM</span> PurchaseOrders po
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> 
     <span class="token punctuation">(</span>
       <span class="token keyword">SELECT</span> l<span class="token punctuation">.</span>PurchaseOrderId<span class="token punctuation">,</span> l<span class="token punctuation">.</span>ItemNo<span class="token punctuation">,</span> l<span class="token punctuation">.</span>Description<span class="token punctuation">,</span> l<span class="token punctuation">.</span>Cost<span class="token punctuation">,</span> l<span class="token punctuation">.</span>Price<span class="token punctuation">,</span> <span class="token function">Max</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token keyword">as</span> Id 
       <span class="token keyword">FROM</span> PurchaseOrderLineItems l
       <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> l<span class="token punctuation">.</span>PurchaseOrderId<span class="token punctuation">,</span> l<span class="token punctuation">.</span>ItemNo<span class="token punctuation">,</span> l<span class="token punctuation">.</span>Description<span class="token punctuation">,</span> l<span class="token punctuation">.</span>Cost<span class="token punctuation">,</span> l<span class="token punctuation">.</span>Price
     <span class="token punctuation">)</span> <span class="token keyword">AS</span> item <span class="token keyword">ON</span> item<span class="token punctuation">.</span>PurchaseOrderId <span class="token operator">=</span> po<span class="token punctuation">.</span>Id

</code></pre></div><h2 id="cross-join"><a href="#cross-join" class="header-anchor">#</a> Cross Join</h2> <p><code>A cross join</code> is a Cartesian join, meaning a Cartesian product of both the tables. This join does not need any condition to join two tables. Each row in the left table will join to each row of the right table. Syntax for a cross join:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table_1
<span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> table_2 

</code></pre></div><p>Example:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">/* Sample data. */</span>
<span class="token keyword">DECLARE</span> <span class="token variable">@Animal</span> <span class="token keyword">table</span> <span class="token punctuation">(</span>
    AnimalId <span class="token keyword">Int</span> <span class="token keyword">IDENTITY</span><span class="token punctuation">,</span>
    Animal <span class="token keyword">Varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">DECLARE</span> <span class="token variable">@AnimalSound</span> <span class="token keyword">table</span> <span class="token punctuation">(</span>
    AnimalSoundId <span class="token keyword">Int</span> <span class="token keyword">IDENTITY</span><span class="token punctuation">,</span>
    AnimalId <span class="token keyword">Int</span><span class="token punctuation">,</span>
    Sound <span class="token keyword">Varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Animal</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Dog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Animal</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Cat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Animal</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Elephant'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@AnimalSound</span> <span class="token punctuation">(</span>AnimalId<span class="token punctuation">,</span> Sound<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Barks'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@AnimalSound</span> <span class="token punctuation">(</span>AnimalId<span class="token punctuation">,</span> Sound<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Meows'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@AnimalSound</span> <span class="token punctuation">(</span>AnimalId<span class="token punctuation">,</span> Sound<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Trumpet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* Sample data prepared. */</span>

<span class="token keyword">SELECT</span> 
    <span class="token operator">*</span> 
<span class="token keyword">FROM</span> 
    <span class="token variable">@Animal</span> 
    <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> <span class="token variable">@AnimalSound</span><span class="token punctuation">;</span>

</code></pre></div><p>Results:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>AnimalId    Animal               AnimalSoundId AnimalId    Sound
<span class="token comment">----------- -------------------- ------------- ----------- --------------------</span>
<span class="token number">1</span>           Dog                  <span class="token number">1</span>             <span class="token number">1</span>           Barks
<span class="token number">2</span>           Cat                  <span class="token number">1</span>             <span class="token number">1</span>           Barks
<span class="token number">3</span>           Elephant             <span class="token number">1</span>             <span class="token number">1</span>           Barks
<span class="token number">1</span>           Dog                  <span class="token number">2</span>             <span class="token number">2</span>           Meows
<span class="token number">2</span>           Cat                  <span class="token number">2</span>             <span class="token number">2</span>           Meows
<span class="token number">3</span>           Elephant             <span class="token number">2</span>             <span class="token number">2</span>           Meows
<span class="token number">1</span>           Dog                  <span class="token number">3</span>             <span class="token number">3</span>           Trumpet
<span class="token number">2</span>           Cat                  <span class="token number">3</span>             <span class="token number">3</span>           Trumpet
<span class="token number">3</span>           Elephant             <span class="token number">3</span>             <span class="token number">3</span>           Trumpet

</code></pre></div><p>Note that there are other ways that a CROSS JOIN can be applied. This is a an <strong>&quot;old style&quot;</strong> join (deprecated since ANSI SQL-92) with no condition, which results in a cross/Cartesian join:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> <span class="token variable">@Animal</span><span class="token punctuation">,</span> <span class="token variable">@AnimalSound</span><span class="token punctuation">;</span>

</code></pre></div><p>This syntax also works due to an &quot;always true&quot; join condition, but is not recommended and should be avoided, in favor of explicit <code>CROSS JOIN</code> syntax, for the sake of readability.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> 
    <span class="token variable">@Animal</span> 
    <span class="token keyword">JOIN</span> <span class="token variable">@AnimalSound</span> 
        <span class="token keyword">ON</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span>

</code></pre></div><h2 id="self-join"><a href="#self-join" class="header-anchor">#</a> Self Join</h2> <p>A table can be joined onto itself in what is known as a self join, combining records in the table with other records in the same table. Self joins are typically used in queries where a hierarchy in the table's columns is defined.</p> <p>Consider the sample data in a table called <code>Employees</code>:</p> <table><thead><tr><th>ID</th> <th>Name</th> <th>Boss_ID</th></tr></thead> <tbody><tr><td>1</td> <td>Bob</td> <td>3</td></tr> <tr><td>2</td> <td>Jim</td> <td>1</td></tr> <tr><td>3</td> <td>Sam</td> <td>2</td></tr></tbody></table> <p>Each employee's <code>Boss_ID</code> maps to another employee's <code>ID</code>. To retrieve a list of employees with their respective boss' name, the table can be joined on itself using this mapping. Note that joining a table in this manner requires the use of an alias (<code>Bosses</code> in this case) on the second reference to the table to distinguish itself from the original table.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Employees<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
    Bosses<span class="token punctuation">.</span>Name <span class="token keyword">AS</span> Boss
<span class="token keyword">FROM</span> Employees
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Employees <span class="token keyword">AS</span> Bosses 
    <span class="token keyword">ON</span> Employees<span class="token punctuation">.</span>Boss_ID <span class="token operator">=</span> Bosses<span class="token punctuation">.</span>ID

</code></pre></div><p>Executing this query will output the following results:</p> <table><thead><tr><th>Name</th> <th>Boss</th></tr></thead> <tbody><tr><td>Bob</td> <td>Sam</td></tr> <tr><td>Jim</td> <td>Bob</td></tr> <tr><td>Sam</td> <td>Jim</td></tr></tbody></table> <h2 id="accidentally-turning-an-outer-join-into-an-inner-join"><a href="#accidentally-turning-an-outer-join-into-an-inner-join" class="header-anchor">#</a> Accidentally turning an outer join into an inner join</h2> <p>Outer joins return all the rows from one or both tables, plus matching rows.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">Table</span> People
PersonID FirstName
       <span class="token number">1</span> Alice
       <span class="token number">2</span> Bob
       <span class="token number">3</span> Eve

<span class="token keyword">Table</span> Scores
PersonID Subject Score
       <span class="token number">1</span> Math    <span class="token number">100</span>
       <span class="token number">2</span> Math     <span class="token number">54</span>
       <span class="token number">2</span> Science  <span class="token number">98</span>

</code></pre></div><p>Left joining the tables:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">Select</span> <span class="token operator">*</span> <span class="token keyword">from</span> People a
<span class="token keyword">left</span> <span class="token keyword">join</span> Scores b
<span class="token keyword">on</span> a<span class="token punctuation">.</span>PersonID <span class="token operator">=</span> b<span class="token punctuation">.</span>PersonID

</code></pre></div><p>Returns:</p> <div class="language-sql extra-class"><pre class="language-sql"><code>PersonID FirstName PersonID Subject Score
       <span class="token number">1</span> Alice            <span class="token number">1</span> Math    <span class="token number">100</span>
       <span class="token number">2</span> Bob              <span class="token number">2</span> Math     <span class="token number">54</span>
       <span class="token number">2</span> Bob              <span class="token number">2</span> Science  <span class="token number">98</span>
       <span class="token number">3</span> Eve           <span class="token boolean">NULL</span> <span class="token boolean">NULL</span>   <span class="token boolean">NULL</span>

</code></pre></div><p>If you wanted to return all the people, with any applicable math scores, a common mistake is to write:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">Select</span> <span class="token operator">*</span> <span class="token keyword">from</span> People a
<span class="token keyword">left</span> <span class="token keyword">join</span> Scores b
<span class="token keyword">on</span> a<span class="token punctuation">.</span>PersonID <span class="token operator">=</span> b<span class="token punctuation">.</span>PersonID
<span class="token keyword">where</span> Subject <span class="token operator">=</span> <span class="token string">'Math'</span>

</code></pre></div><p>This would remove Eve from your results, in addition to removing Bob's science score, as <code>Subject</code> is <code>NULL</code> for her.</p> <p>The correct syntax to remove non-Math records while retaining all individuals in the <code>People</code> table would be:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">Select</span> <span class="token operator">*</span> <span class="token keyword">from</span> People a
<span class="token keyword">left</span> <span class="token keyword">join</span> Scores b
<span class="token keyword">on</span> a<span class="token punctuation">.</span>PersonID <span class="token operator">=</span> b<span class="token punctuation">.</span>PersonID
<span class="token operator">and</span> b<span class="token punctuation">.</span>Subject <span class="token operator">=</span> <span class="token string">'Math'</span>

</code></pre></div><h2 id="delete-using-join"><a href="#delete-using-join" class="header-anchor">#</a> Delete using Join</h2> <p>Joins can also be used in a <code>DELETE</code> statement. Given a schema as follows:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Users <span class="token punctuation">(</span>
    UserId <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    AccountId <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    RealName nvarchar<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Preferences <span class="token punctuation">(</span>
    UserId <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    SomeSetting <span class="token keyword">bit</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span>

</code></pre></div><p>We can delete rows from the <code>Preferences</code> table, filtering by a predicate on the <code>Users</code> table as follows:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> p
<span class="token keyword">FROM</span> Users u
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Preferences p <span class="token keyword">ON</span> u<span class="token punctuation">.</span>UserId <span class="token operator">=</span> p<span class="token punctuation">.</span>UserId
<span class="token keyword">WHERE</span> u<span class="token punctuation">.</span>AccountId <span class="token operator">=</span> <span class="token number">1234</span>

</code></pre></div><p>Here <code>p</code> is an alias for <code>Preferences</code> defined in the <code>FROM</code> clause of the statement and we only delete rows that have a matching <code>AccountId</code> from the <code>Users</code> table.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/mssql/join.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/mssql/for-xml-path.html" class="prev">
        FOR XML PATH
      </a></span> <span class="next"><a href="/mssql/cross-apply.html">
        cross apply
      </a>
      
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/2018.0deaf8f1.js" defer></script>
  </body>
</html>
