<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Microsoft SQL Server - Getting started with Microsoft SQL Server</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="INSERT / SELECT / UPDATE / DELETE: the basics of Data Manipulation Language, SELECT all rows and columns from a table, UPDATE Specific Row, Comments in code, DELETE All Rows, PRINT, Select rows that match a condition, UPDATE All Rows, Retrieve Basic Server Information, TRUNCATE TABLE, Create new table and insert records from old table, Using Transactions to change data safely, Getting Table Row Count">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Microsoft SQL Server - Getting started with Microsoft SQL Server">
    <meta property="og:description" content="INSERT / SELECT / UPDATE / DELETE: the basics of Data Manipulation Language, SELECT all rows and columns from a table, UPDATE Specific Row, Comments in code, DELETE All Rows, PRINT, Select rows that match a condition, UPDATE All Rows, Retrieve Basic Server Information, TRUNCATE TABLE, Create new table and insert records from old table, Using Transactions to change data safely, Getting Table Row Count">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/mssql/getting-started-with-microsoft-sql-server.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Microsoft SQL Server - Getting started with Microsoft SQL Server">
    <meta name="twitter:description" content="INSERT / SELECT / UPDATE / DELETE: the basics of Data Manipulation Language, SELECT all rows and columns from a table, UPDATE Specific Row, Comments in code, DELETE All Rows, PRINT, Select rows that match a condition, UPDATE All Rows, Retrieve Basic Server Information, TRUNCATE TABLE, Create new table and insert records from old table, Using Transactions to change data safely, Getting Table Row Count">
    <meta name="twitter:url" content="/mssql/getting-started-with-microsoft-sql-server.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2011.14b1753c.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MS SQL Server</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mssql/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/mssql/getting-started-with-microsoft-sql-server.html" aria-current="page" class="active sidebar-link">Getting started with Microsoft SQL Server</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#insert-select-update-delete-the-basics-of-data-manipulation-language" class="sidebar-link">INSERT / SELECT / UPDATE / DELETE: the basics of Data Manipulation Language</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#select-all-rows-and-columns-from-a-table" class="sidebar-link">SELECT all rows and columns from a table</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#update-specific-row" class="sidebar-link">UPDATE Specific Row</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#comments-in-code" class="sidebar-link">Comments in code</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#delete-all-rows" class="sidebar-link">DELETE All Rows</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#print" class="sidebar-link">PRINT</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#select-rows-that-match-a-condition" class="sidebar-link">Select rows that match a condition</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#update-all-rows" class="sidebar-link">UPDATE All Rows</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#retrieve-basic-server-information" class="sidebar-link">Retrieve Basic Server Information</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#truncate-table" class="sidebar-link">TRUNCATE TABLE</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#create-new-table-and-insert-records-from-old-table" class="sidebar-link">Create new table and insert records from old table</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#using-transactions-to-change-data-safely" class="sidebar-link">Using Transactions to change data safely</a></li><li class="sidebar-sub-header"><a href="/mssql/getting-started-with-microsoft-sql-server.html#getting-table-row-count" class="sidebar-link">Getting Table Row Count</a></li></ul></li><li><a href="/mssql/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/mssql/converting-data-types.html" class="sidebar-link">Converting data types</a></li><li><a href="/mssql/user-defined-table-types.html" class="sidebar-link">User Defined Table Types</a></li><li><a href="/mssql/select-statement.html" class="sidebar-link">SELECT statement</a></li><li><a href="/mssql/alias-names-in-sql-server.html" class="sidebar-link">Alias Names in Sql Server</a></li><li><a href="/mssql/nulls.html" class="sidebar-link">NULLs</a></li><li><a href="/mssql/variables.html" class="sidebar-link">Variables</a></li><li><a href="/mssql/dates.html" class="sidebar-link">Dates</a></li><li><a href="/mssql/generating-a-range-of-dates.html" class="sidebar-link">Generating a range of dates</a></li><li><a href="/mssql/database-snapshots.html" class="sidebar-link">Database Snapshots</a></li><li><a href="/mssql/coalesce.html" class="sidebar-link">COALESCE</a></li><li><a href="/mssql/if-else.html" class="sidebar-link">IF...ELSE</a></li><li><a href="/mssql/case-statement.html" class="sidebar-link">CASE Statement</a></li><li><a href="/mssql/insert-into.html" class="sidebar-link">INSERT INTO</a></li><li><a href="/mssql/drop-keyword.html" class="sidebar-link">Drop Keyword</a></li><li><a href="/mssql/merge.html" class="sidebar-link">MERGE</a></li><li><a href="/mssql/create-view.html" class="sidebar-link">CREATE VIEW</a></li><li><a href="/mssql/views.html" class="sidebar-link">Views</a></li><li><a href="/mssql/union.html" class="sidebar-link">UNION</a></li><li><a href="/mssql/try-catch.html" class="sidebar-link">TRY/CATCH</a></li><li><a href="/mssql/while-loop.html" class="sidebar-link">WHILE loop</a></li><li><a href="/mssql/over-clause.html" class="sidebar-link">OVER Clause</a></li><li><a href="/mssql/group-by.html" class="sidebar-link">GROUP BY</a></li><li><a href="/mssql/order-by.html" class="sidebar-link">ORDER BY</a></li><li><a href="/mssql/the-stuff-function.html" class="sidebar-link">The STUFF Function</a></li><li><a href="/mssql/json-in-sql-server.html" class="sidebar-link">JSON in Sql Server</a></li><li><a href="/mssql/openjson.html" class="sidebar-link">OPENJSON</a></li><li><a href="/mssql/for-json.html" class="sidebar-link">FOR JSON</a></li><li><a href="/mssql/queries-with-json-data.html" class="sidebar-link">Queries with JSON data</a></li><li><a href="/mssql/storing-json-in-sql-tables.html" class="sidebar-link">Storing JSON in SQL tables</a></li><li><a href="/mssql/modify-json-text.html" class="sidebar-link">Modify JSON text</a></li><li><a href="/mssql/for-xml-path.html" class="sidebar-link">FOR XML PATH</a></li><li><a href="/mssql/join.html" class="sidebar-link">Join</a></li><li><a href="/mssql/cross-apply.html" class="sidebar-link">cross apply</a></li><li><a href="/mssql/computed-columns.html" class="sidebar-link">Computed Columns</a></li><li><a href="/mssql/common-table-expressions.html" class="sidebar-link">Common Table Expressions</a></li><li><a href="/mssql/move-and-copy-data-around-tables.html" class="sidebar-link">Move and copy data around tables</a></li><li><a href="/mssql/limit-result-set.html" class="sidebar-link">Limit Result Set</a></li><li><a href="/mssql/retrieve-information-about-your-instance.html" class="sidebar-link">Retrieve Information about your Instance</a></li><li><a href="/mssql/with-ties-option.html" class="sidebar-link">With Ties Option</a></li><li><a href="/mssql/string-functions.html" class="sidebar-link">String Functions</a></li><li><a href="/mssql/logical-functions.html" class="sidebar-link">Logical Functions</a></li><li><a href="/mssql/aggregate-functions.html" class="sidebar-link">Aggregate Functions</a></li><li><a href="/mssql/string-aggregate-functions-in-sql-server.html" class="sidebar-link">String Aggregate functions in SQL Server</a></li><li><a href="/mssql/ranking-functions.html" class="sidebar-link">Ranking Functions</a></li><li><a href="/mssql/window-functions.html" class="sidebar-link">Window functions</a></li><li><a href="/mssql/pivot-unpivot.html" class="sidebar-link">PIVOT / UNPIVOT</a></li><li><a href="/mssql/dynamic-sql-pivot.html" class="sidebar-link">Dynamic SQL Pivot</a></li><li><a href="/mssql/partitioning.html" class="sidebar-link">Partitioning</a></li><li><a href="/mssql/stored-procedures.html" class="sidebar-link">Stored Procedures</a></li><li><a href="/mssql/retrieve-information-about-the-database.html" class="sidebar-link">Retrieve information about the database</a></li><li><a href="/mssql/split-string-function-in-sql-server.html" class="sidebar-link">Split String function in Sql Server</a></li><li><a href="/mssql/insert.html" class="sidebar-link">Insert</a></li><li><a href="/mssql/primary-keys.html" class="sidebar-link">Primary Keys</a></li><li><a href="/mssql/foreign-keys.html" class="sidebar-link">Foreign Keys</a></li><li><a href="/mssql/last-inserted-identity.html" class="sidebar-link">Last Inserted Identity</a></li><li><a href="/mssql/scope-identity.html" class="sidebar-link">SCOPE_IDENTITY()</a></li><li><a href="/mssql/sequences.html" class="sidebar-link">Sequences</a></li><li><a href="/mssql/indexing.html" class="sidebar-link">Indexing</a></li><li><a href="/mssql/full-text-indexing.html" class="sidebar-link">Full-Text Indexing</a></li><li><a href="/mssql/trigger.html" class="sidebar-link">Trigger</a></li><li><a href="/mssql/cursors.html" class="sidebar-link">Cursors</a></li><li><a href="/mssql/transaction-isolation-levels.html" class="sidebar-link">Transaction isolation levels</a></li><li><a href="/mssql/advanced-options.html" class="sidebar-link">Advanced options</a></li><li><a href="/mssql/migration.html" class="sidebar-link">Migration</a></li><li><a href="/mssql/table-valued-parameters.html" class="sidebar-link">Table Valued Parameters</a></li><li><a href="/mssql/dbmail.html" class="sidebar-link">DBMAIL</a></li><li><a href="/mssql/in-memory-oltp-hekaton.html" class="sidebar-link">In-Memory OLTP (Hekaton)</a></li><li><a href="/mssql/temporal-tables.html" class="sidebar-link">Temporal Tables</a></li><li><a href="/mssql/use-of-temp-table.html" class="sidebar-link">Use of TEMP Table</a></li><li><a href="/mssql/scheduled-task-or-job.html" class="sidebar-link">Scheduled Task or Job</a></li><li><a href="/mssql/isolation-levels-and-locking.html" class="sidebar-link">Isolation levels and locking</a></li><li><a href="/mssql/sorting-ordering-rows.html" class="sidebar-link">Sorting/ordering rows</a></li><li><a href="/mssql/privileges-or-permissions.html" class="sidebar-link">Privileges or Permissions</a></li><li><a href="/mssql/sqlcmd.html" class="sidebar-link">SQLCMD</a></li><li><a href="/mssql/resource-governor.html" class="sidebar-link">Resource Governor</a></li><li><a href="/mssql/file-group.html" class="sidebar-link">File Group</a></li><li><a href="/mssql/basic-ddl-operations-in-ms-sql-server.html" class="sidebar-link">Basic DDL Operations in MS SQL Server</a></li><li><a href="/mssql/subqueries.html" class="sidebar-link">Subqueries</a></li><li><a href="/mssql/pagination.html" class="sidebar-link">Pagination</a></li><li><a href="/mssql/clustered-columnstore.html" class="sidebar-link">CLUSTERED COLUMNSTORE</a></li><li><a href="/mssql/parsename.html" class="sidebar-link">Parsename</a></li><li><a href="/mssql/installing-sql-server-on-windows.html" class="sidebar-link">Installing SQL Server on Windows</a></li><li><a href="/mssql/analyzing-a-query.html" class="sidebar-link">Analyzing a Query</a></li><li><a href="/mssql/query-hints.html" class="sidebar-link">Query Hints</a></li><li><a href="/mssql/query-store.html" class="sidebar-link">Query Store</a></li><li><a href="/mssql/querying-results-by-page.html" class="sidebar-link">Querying results by page</a></li><li><a href="/mssql/schemas.html" class="sidebar-link">Schemas</a></li><li><a href="/mssql/backup-and-restore-database.html" class="sidebar-link">Backup and Restore Database</a></li><li><a href="/mssql/transaction-handling.html" class="sidebar-link">Transaction handling</a></li><li><a href="/mssql/natively-compiled-modules-hekaton.html" class="sidebar-link">Natively compiled modules (Hekaton)</a></li><li><a href="/mssql/spatial-data.html" class="sidebar-link">Spatial Data</a></li><li><a href="/mssql/dynamic-sql.html" class="sidebar-link">Dynamic SQL</a></li><li><a href="/mssql/dynamic-data-masking.html" class="sidebar-link">Dynamic data masking</a></li><li><a href="/mssql/export-data-in-txt-file-by-using-sqlcmd.html" class="sidebar-link">Export data in txt file by using SQLCMD</a></li><li><a href="/mssql/common-language-runtime-integration.html" class="sidebar-link">Common Language Runtime Integration</a></li><li><a href="/mssql/delimiting-special-characters-and-reserved-words.html" class="sidebar-link">Delimiting special characters and reserved words</a></li><li><a href="/mssql/dbcc.html" class="sidebar-link">DBCC</a></li><li><a href="/mssql/bulk-import.html" class="sidebar-link">BULK Import</a></li><li><a href="/mssql/service-broker.html" class="sidebar-link">Service broker</a></li><li><a href="/mssql/permissions-and-security.html" class="sidebar-link">Permissions and Security</a></li><li><a href="/mssql/database-permissions.html" class="sidebar-link">Database permissions</a></li><li><a href="/mssql/row-level-security.html" class="sidebar-link">Row-level security</a></li><li><a href="/mssql/encryption.html" class="sidebar-link">Encryption</a></li><li><a href="/mssql/phantom-read.html" class="sidebar-link">PHANTOM read</a></li><li><a href="/mssql/filestream.html" class="sidebar-link">Filestream</a></li><li><a href="/mssql/bcp-bulk-copy-program-utility.html" class="sidebar-link">bcp (bulk copy program) Utility</a></li><li><a href="/mssql/sql-server-evolution-through-different-versions-2000-2016.html" class="sidebar-link">SQL Server Evolution through different versions (2000 - 2016)</a></li><li><a href="/mssql/sql-server-management-studio-ssms.html" class="sidebar-link">SQL Server Management Studio (SSMS)</a></li><li><a href="/mssql/managing-azure-sql-database.html" class="sidebar-link">Managing Azure SQL Database</a></li><li><a href="/mssql/system-database-tempdb.html" class="sidebar-link">System database - TempDb</a></li><li><a href="/mssql/microsoft-sql-server-management-studio-shortcut-keys.html" class="sidebar-link">Microsoft SQL Server Management Studio Shortcut Keys</a></li><li><a href="/mssql/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="getting-started-with-microsoft-sql-server"><a href="#getting-started-with-microsoft-sql-server" class="header-anchor">#</a> Getting started with Microsoft SQL Server</h1> <h2 id="insert-select-update-delete-the-basics-of-data-manipulation-language"><a href="#insert-select-update-delete-the-basics-of-data-manipulation-language" class="header-anchor">#</a> INSERT / SELECT / UPDATE / DELETE: the basics of Data Manipulation Language</h2> <p><strong>D</strong>ata <strong>M</strong>anipulation <strong>L</strong>anguage (DML for short) includes operations such as <code>INSERT</code>, <code>UPDATE</code> and <code>DELETE</code>:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- Create a table HelloWorld</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> HelloWorld <span class="token punctuation">(</span>
    Id <span class="token keyword">INT</span> <span class="token keyword">IDENTITY</span><span class="token punctuation">,</span>
    Description <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>


<span class="token comment">-- DML Operation INSERT, inserting a row into the table</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> HelloWorld <span class="token punctuation">(</span>Description<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">)</span>


<span class="token comment">-- DML Operation SELECT, displaying the table </span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> HelloWorld  


<span class="token comment">-- Select a specific column from table</span>
<span class="token keyword">SELECT</span> Description <span class="token keyword">FROM</span> HelloWorld


<span class="token comment">-- Display number of records in the table</span>
<span class="token keyword">SELECT</span> <span class="token function">Count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> HelloWorld


<span class="token comment">-- DML Operation UPDATE, updating a specific row in the table</span>
<span class="token keyword">UPDATE</span> HelloWorld <span class="token keyword">SET</span> Description <span class="token operator">=</span> <span class="token string">'Hello, World!'</span> <span class="token keyword">WHERE</span> Id <span class="token operator">=</span> <span class="token number">1</span>


<span class="token comment">-- Selecting rows from the table (see how the Description has changed after the update?)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> HelloWorld


<span class="token comment">-- DML Operation - DELETE, deleting a row from the table</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> HelloWorld <span class="token keyword">WHERE</span> Id <span class="token operator">=</span> <span class="token number">1</span>


<span class="token comment">-- Selecting the table. See table content after DELETE operation </span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> HelloWorld

</code></pre></div><p>In this script we're <strong>creating a table</strong> to demonstrate some basic queries.</p> <p>The following examples are showing how to <strong>query tables:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">USE</span> Northwind<span class="token punctuation">;</span>
GO
<span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Customers 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CompanyName

</code></pre></div><p>will select the first 10 records of the <code>Customer</code> table, ordered by the column <code>CompanyName</code> from the database <code>Northwind</code> (which is one of Microsoft's sample databases, it can be downloaded from <strong><a href="https://technet.microsoft.com/en-us/library/ms143221(v=sql.105).aspx" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>):</p> <p><a href="https://i.stack.imgur.com/6xeX4.jpg" target="_blank" rel="noopener noreferrer"><img src="https://i.stack.imgur.com/6xeX4.jpg" alt="Northwind database query"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>Note</strong> that <code>Use Northwind;</code> changes the default database for all subsequent queries.
You can still reference the database by using the fully qualified syntax in the form of [Database].[Schema].[Table]:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Northwind<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>Customers 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CompanyName

<span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Pubs<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>Authors
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> City

</code></pre></div><p>This is useful if you're querying data from different databases. Note that <code>dbo</code>, specified &quot;in between&quot; is called a schema and needs to be specified while using the fully qualified syntax. You can think of it as a folder within your database. <code>dbo</code> is the default schema. The default schema may be omitted. All other user defined schemas need to be specified.</p> <p>If the database table contains columns which are named like reserved words, e.g. <code>Date</code>, you need to enclose the column name in brackets, like this:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- descending order</span>
<span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">10</span> <span class="token punctuation">[</span><span class="token keyword">Date</span><span class="token punctuation">]</span> <span class="token keyword">FROM</span> dbo<span class="token punctuation">.</span>MyLogTable
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">[</span><span class="token keyword">Date</span><span class="token punctuation">]</span> <span class="token keyword">DESC</span>

</code></pre></div><p>The same applies if the column name contains spaces in its name (which is not recommended). An alternative syntax is to use double quotes instead of square brackets, e.g.:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- descending order</span>
<span class="token keyword">SELECT</span> <span class="token keyword">top</span> <span class="token number">10</span> <span class="token string">&quot;Date&quot;</span> <span class="token keyword">from</span> dbo<span class="token punctuation">.</span>MyLogTable
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token string">&quot;Date&quot;</span> <span class="token keyword">desc</span> 

</code></pre></div><p>is equivalent but not so commonly used. Notice the difference between double quotes and single quotes: Single quotes are used for strings, i.e.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- descending order</span>
<span class="token keyword">SELECT</span> <span class="token keyword">top</span> <span class="token number">10</span> <span class="token string">&quot;Date&quot;</span> <span class="token keyword">from</span> dbo<span class="token punctuation">.</span>MyLogTable
<span class="token keyword">where</span> UserId<span class="token operator">=</span><span class="token string">'johndoe'</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token string">&quot;Date&quot;</span> <span class="token keyword">desc</span> 

</code></pre></div><p>is a valid syntax. Notice that T-SQL has a <code>N</code> prefix for NChar and NVarchar data types, e.g.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Northwind<span class="token punctuation">.</span>dbo<span class="token punctuation">.</span>Customers 
<span class="token keyword">WHERE</span> CompanyName <span class="token operator">LIKE</span> N<span class="token string">'AL%'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CompanyName

</code></pre></div><p>returns all companies having a company name starting with <code>AL</code> (<code>%</code> is a wild card, use it as you would use the asterisk in a DOS command line, e.g. <code>DIR AL*</code>). For <code>LIKE</code>, there are a couple of wildcards available, look <strong><a href="https://msdn.microsoft.com/en-us/library/ms179859.aspx" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> to find out more details.</p> <h3 id="joins"><a href="#joins" class="header-anchor">#</a> <strong>Joins</strong></h3> <p>Joins are useful if you want to query fields which don't exist in one single table, but in multiple tables. For example: You want to query all columns from the <code>Region</code> table in the <code>Northwind</code> database. But you notice that you require also the <code>RegionDescription</code>, which is stored in a different table, <code>Region</code>. However, there is a common key, <code>RgionID</code> which you can use to combine this information in a single query as follows (<code>Top 5</code> just returns the first 5 rows, omit it to get all rows):</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">5</span> Territories<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> 
    Regions<span class="token punctuation">.</span>RegionDescription 
<span class="token keyword">FROM</span> Territories 
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Region 
    <span class="token keyword">ON</span> Territories<span class="token punctuation">.</span>RegionID<span class="token operator">=</span>Region<span class="token punctuation">.</span>RegionID
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> TerritoryDescription

</code></pre></div><p>will show all columns from <code>Territories</code> plus the <code>RegionDescription</code> column from <code>Region</code>. The result is ordered by <code>TerritoryDescription</code>.</p> <h3 id="table-aliases"><a href="#table-aliases" class="header-anchor">#</a> <strong>Table Aliases</strong></h3> <p>When your query requires a reference to two or more tables, you may find it useful to use a Table Alias. Table aliases are shorthand references to tables that can be used in place of a full table name, and can reduce typing and editing. The syntax for using an alias is:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token operator">&lt;</span>TableName<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token keyword">as</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>alias<span class="token operator">&gt;</span>

</code></pre></div><p>Where <code>as</code> is an optional keyword. For example, the previous query can be rewritten as:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">5</span> t<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> 
    r<span class="token punctuation">.</span>RegionDescription 
<span class="token keyword">FROM</span> Territories t
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Region r 
    <span class="token keyword">ON</span> t<span class="token punctuation">.</span>RegionID <span class="token operator">=</span> r<span class="token punctuation">.</span>RegionID
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> TerritoryDescription

</code></pre></div><p>Aliases must be unique for all tables in a query, even if you use the same table twice. For example, if your Employee table included a SupervisorId field, you can use this query to return an employee and his supervisor's name:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> 
    s<span class="token punctuation">.</span>Name <span class="token keyword">as</span> SupervisorName <span class="token comment">-- Rename the field for output</span>
<span class="token keyword">FROM</span> Employee e
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Employee s
    <span class="token keyword">ON</span> e<span class="token punctuation">.</span>SupervisorId <span class="token operator">=</span> s<span class="token punctuation">.</span>EmployeeId
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>EmployeeId <span class="token operator">=</span> <span class="token number">111</span>

</code></pre></div><h3 id="unions"><a href="#unions" class="header-anchor">#</a> <strong>Unions</strong></h3> <p>As we have seen before, a Join adds columns from different table sources. But what if you want to combine rows from different sources? In this case you can use a UNION. Suppose you're planning a party and want to invite not only employees but also the customers. Then you could run this query to do it:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> FirstName<span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span>LastName <span class="token keyword">as</span> ContactName<span class="token punctuation">,</span> Address<span class="token punctuation">,</span> City <span class="token keyword">FROM</span> Employees
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> ContactName<span class="token punctuation">,</span> Address<span class="token punctuation">,</span> City <span class="token keyword">FROM</span> Customers

</code></pre></div><p>It will return names, addresses and cities from the employees and customers in one single table. Note that duplicate rows (if there should be any) are automatically eliminated (if you don't want this, use a <code>UNION ALL</code> instead). The column number, column names, order and data type must match across all the select statements that are part of the union - this is why the first SELECT combines <code>FirstName</code> and <code>LastName</code> from Employee into <code>ContactName</code>.</p> <h3 id="table-variables"><a href="#table-variables" class="header-anchor">#</a> <strong>Table Variables</strong></h3> <p>It can be useful, if you need to deal with temporary data (especially in a stored procedure), to use table variables: The difference between a &quot;real&quot; table and a table variable is that it just exists in memory for temporary processing.</p> <p><strong>Example:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@Region</span> <span class="token keyword">TABLE</span>
<span class="token punctuation">(</span>
  RegionID <span class="token keyword">int</span><span class="token punctuation">,</span> 
  RegionDescription <span class="token keyword">NChar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><p>creates a table in memory. In this case the <code>@</code> prefix is mandatory because it is a variable. You can perform all DML operations mentioned above to insert, delete and select rows, e.g.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Region</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'Northern'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Region</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'Southern'</span><span class="token punctuation">)</span>

</code></pre></div><p>But normally, you would populate it based on a real table like</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token variable">@Region</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> dbo<span class="token punctuation">.</span>Region <span class="token keyword">WHERE</span> RegionID<span class="token operator">&gt;</span><span class="token number">2</span><span class="token punctuation">;</span>

</code></pre></div><p>which would read the filtered values from the real table <code>dbo.Region</code> and insert it into the memory table <code>@Region</code> - where it can be used for further processing. For example, you could use it in a join like</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Territories t
<span class="token keyword">JOIN</span> <span class="token variable">@Region</span> r <span class="token keyword">on</span> t<span class="token punctuation">.</span>RegionID<span class="token operator">=</span>r<span class="token punctuation">.</span>RegionID

</code></pre></div><p>which would in this case return all <code>Northern</code> and <code>Southern</code> territories.
More detailed information can be found <a href="http://odetocode.com/Articles/365.aspx" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Temporary tables are discussed <a href="https://www.simple-talk.com/sql/t-sql-programming/temporary-tables-in-sql-server/" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, if you are interested to read more about that topic.</p> <p><strong>NOTE:</strong> Microsoft only recommends the use of table variables if the number of rows of data in the table variable are less than 100. If you will be working with larger amounts of data, use a <strong>temporary table</strong>, or temp table, instead.</p> <h2 id="select-all-rows-and-columns-from-a-table"><a href="#select-all-rows-and-columns-from-a-table" class="header-anchor">#</a> SELECT all rows and columns from a table</h2> <p>Syntax:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> table_name

</code></pre></div><p>Using the asterisk operator <code>*</code> serves as a shortcut for selecting all the columns in the table. All rows will also be selected because this <code>SELECT</code> statement does not have a <code>WHERE</code> clause, to specify any filtering criteria.</p> <p>This would also work the same way if you added an alias to the table, for instance <code>e</code> in this case:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> Employees <span class="token keyword">AS</span> e

</code></pre></div><p>Or if you wanted to select all from a specific table you can use the alias + &quot; .* &quot;:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>DepartmentName
<span class="token keyword">FROM</span> Employees <span class="token keyword">AS</span> e
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Department <span class="token keyword">AS</span> d 
        <span class="token keyword">ON</span> e<span class="token punctuation">.</span>DepartmentID <span class="token operator">=</span> d<span class="token punctuation">.</span>DepartmentID

</code></pre></div><p>Database objects may also be accessed using fully qualified names:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>server_name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>database_name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>schema_name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>table_name<span class="token punctuation">]</span>

</code></pre></div><p>This is not necessarily recommended, as changing the server and/or database names would cause the queries using fully-qualified names to no longer execute due to invalid object names.</p> <p>Note that the fields before <code>table_name</code> can be omitted in many cases if the queries are executed on a single server, database and schema, respectively. However, it is common for a database to have multiple schema, and in these cases the schema name should not be omitted when possible.</p> <p><strong>Warning:</strong> Using <code>SELECT *</code> in production code or stored procedures can lead to problems later on (as new columns are added to the table, or if columns are rearranged in the table), especially if your code makes simple assumptions about the order of columns, or number of columns returned.  So it's safer to always explicitly specify column names in SELECT statements for production code.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> col1<span class="token punctuation">,</span> col2<span class="token punctuation">,</span> col3
<span class="token keyword">FROM</span> table_name

</code></pre></div><h2 id="update-specific-row"><a href="#update-specific-row" class="header-anchor">#</a> UPDATE Specific Row</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> HelloWorlds
<span class="token keyword">SET</span> HelloWorld <span class="token operator">=</span> <span class="token string">'HELLO WORLD!!!'</span>
<span class="token keyword">WHERE</span> Id <span class="token operator">=</span> <span class="token number">5</span>

</code></pre></div><p>The above code updates the value of the field &quot;HelloWorld&quot; with &quot;HELLO WORLD!!!&quot; for the record where &quot;Id = 5&quot; in HelloWorlds table.</p> <p>Note: In an update statement, It is advised to use a &quot;where&quot; clause to avoid updating the whole table unless and until your requirement is different.</p> <h2 id="comments-in-code"><a href="#comments-in-code" class="header-anchor">#</a> Comments in code</h2> <p>Transact-SQL supports two forms of comment writing.  Comments are ignored by the database engine, and are meant for people to read.</p> <p><strong>Comments</strong> are preceded by <code>--</code> and are ignored until a new line is encountered:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- This is a comment</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> MyTable <span class="token comment">-- This is another comment</span>
<span class="token keyword">WHERE</span> Id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Slash star comments</strong> begin with <code>/*</code> and end with <code>*/</code>. All text between those delimiters is considered as a comment block.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">/* This is
a multi-line
comment block. */</span>
<span class="token keyword">SELECT</span> Id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Message<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'First row'</span>
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Second row'</span>
<span class="token comment">/* This is a one liner */</span>
<span class="token keyword">SELECT</span> <span class="token string">'More'</span><span class="token punctuation">;</span>

</code></pre></div><p>Slash star comments have the advantage of keeping the comment usable if the SQL Statement loses new line characters.  This can happen when SQL is captured during troubleshooting.</p> <p>Slash star comments can be nested and a starting <code>/*</code> inside a slash star comment needs to be ended with a <code>*/</code> to be valid. The following code will result in an error</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">/*
SELECT *
FROM CommentTable
WHERE Comment = '/*'
*/</span>

</code></pre></div><p>The slash star even though inside the quote is considered as the start of a comment. Hence it needs to be ended with another closing star slash.
The correct way would be</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">/*
SELECT *
FROM CommentTable
WHERE Comment = '/*'
*/</span>  <span class="token operator">*</span><span class="token operator">/</span>

</code></pre></div><h2 id="delete-all-rows"><a href="#delete-all-rows" class="header-anchor">#</a> DELETE All Rows</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span>
<span class="token keyword">FROM</span> Helloworlds

</code></pre></div><p>This will delete all the data from the table. The table will contain no rows after you run this code. Unlike <code>DROP TABLE</code>, this preserves the table itself and its structure and you can continue to insert new rows into that table.</p> <p>Another way to delete all rows in table is truncate it, as follow:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> HelloWords

</code></pre></div><p>Difference with DELETE operation are several:</p> <ol><li>Truncate operation doesn't store in transaction log file</li> <li>If exists <code>IDENTITY</code> field, this will be reset</li> <li>TRUNCATE can be applied on whole table and no on part of it (instead with <code>DELETE</code> command you can associate a <code>WHERE</code> clause)</li></ol> <p><strong>Restrictions Of TRUNCATE</strong></p> <ol><li>Cannot TRUNCATE a table if there is a <code>FOREIGN KEY</code> reference</li> <li>If the table is participated in an <code>INDEXED VIEW</code></li> <li>If the table is published by using <code>TRANSACTIONAL REPLICATION</code> or <code>MERGE REPLICATION</code></li> <li>It will not fire any TRIGGER defined in the table</li></ol> <p><a href="https://msdn.microsoft.com/en-us/library/ms177570.aspx" target="_blank" rel="noopener noreferrer">[sic]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="print"><a href="#print" class="header-anchor">#</a> PRINT</h2> <p>Display a message to the output console. Using SQL Server Management Studio, this will be displayed in the messages tab, rather than the results tab:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">PRINT</span> <span class="token string">'Hello World!'</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="select-rows-that-match-a-condition"><a href="#select-rows-that-match-a-condition" class="header-anchor">#</a> Select rows that match a condition</h2> <p>Generally, the syntax is:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">&lt;</span><span class="token keyword">column</span> names<span class="token operator">&gt;</span>
<span class="token keyword">FROM</span> <span class="token operator">&lt;</span><span class="token keyword">table</span> name<span class="token operator">&gt;</span>
<span class="token keyword">WHERE</span> <span class="token operator">&lt;</span>condition<span class="token operator">&gt;</span>

</code></pre></div><p>For example:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> FirstName<span class="token punctuation">,</span> Age
<span class="token keyword">FROM</span> Users
<span class="token keyword">WHERE</span> LastName <span class="token operator">=</span> <span class="token string">'Smith'</span>

</code></pre></div><p>Conditions can be complex:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> FirstName<span class="token punctuation">,</span> Age
<span class="token keyword">FROM</span> Users
<span class="token keyword">WHERE</span> LastName <span class="token operator">=</span> <span class="token string">'Smith'</span> <span class="token operator">AND</span> <span class="token punctuation">(</span>City <span class="token operator">=</span> <span class="token string">'New York'</span> <span class="token operator">OR</span> City <span class="token operator">=</span> <span class="token string">'Los Angeles'</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="update-all-rows"><a href="#update-all-rows" class="header-anchor">#</a> UPDATE All Rows</h2> <p>A simple form of updating is incrementing all the values in a given field of the table.
In order to do so, we need to define the field and the increment value</p> <p>The following is an example that increments the <code>Score</code> field by 1 (in all rows):</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> Scores
<span class="token keyword">SET</span> score <span class="token operator">=</span> score <span class="token operator">+</span> <span class="token number">1</span>  

</code></pre></div><p>This can be dangerous since you can corrupt your data if you accidentally make an  UPDATE for a <strong>specific Row</strong> with an  UPDATE for <strong>All rows</strong> in the table.</p> <h2 id="retrieve-basic-server-information"><a href="#retrieve-basic-server-information" class="header-anchor">#</a> Retrieve Basic Server Information</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> @<span class="token variable">@VERSION</span>

</code></pre></div><p>Returns the version of MS SQL Server running on the instance.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> @<span class="token variable">@SERVERNAME</span>

</code></pre></div><p>Returns the name of the MS SQL Server instance.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> @<span class="token variable">@SERVICENAME</span>

</code></pre></div><p>Returns the name of the Windows service MS SQL Server is running as.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> serverproperty<span class="token punctuation">(</span><span class="token string">'ComputerNamePhysicalNetBIOS'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Returns the physical name of the machine where SQL Server is running. Useful to identify the node in a failover cluster.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> fn_virtualservernodes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>In a failover cluster returns every node where SQL Server can run on. It returns nothing if not a cluster.</p> <h2 id="truncate-table"><a href="#truncate-table" class="header-anchor">#</a> TRUNCATE TABLE</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> Helloworlds 

</code></pre></div><p>This code will delete all the data from the table Helloworlds. Truncate table is almost similar to <code>Delete from Table</code> code. The difference is that you can not use where clauses with Truncate. Truncate table is considered better than delete because it uses less transaction log spaces.</p> <p>Note that if an identity column exists, it is reset to the initial seed value (for example, auto-incremented ID will restart from 1). This can lead to inconsistency if the identity columns is used as a foreign key in another table.</p> <h2 id="create-new-table-and-insert-records-from-old-table"><a href="#create-new-table-and-insert-records-from-old-table" class="header-anchor">#</a> Create new table and insert records from old table</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">INTO</span> NewTable <span class="token keyword">FROM</span> OldTable

</code></pre></div><p>Creates a new table with structure of old table and inserts all rows into the new table.</p> <p><strong>Some Restrictions</strong></p> <blockquote></blockquote> <ol>
- You cannot specify a table variable or table-valued parameter as the new table.
<li>You cannot use SELECT…INTO to create a partitioned table, even when the source table   is partitioned. SELECT...INTO does not use the
partition scheme of the source table; instead, the new table is
created in the default filegroup. To insert rows into a partitioned
table, you must first create the partitioned table and then use the
INSERT INTO...SELECT FROM statement.</li> <li>Indexes, constraints, and triggers defined in the source table are not transferred to the new table, nor can they be specified in the
SELECT...INTO statement. If these objects are required, you can create
them after executing the SELECT...INTO statement.</li> <li>Specifying an ORDER BY clause does not guarantee the rows are inserted in the specified order. When a sparse column is included in
the select list,  the sparse column property does not transfer to the
column in the new table. If this property is required in the new
table, alter the column definition after executing the SELECT...INTO
statement to include this property.</li> <li>When a computed column is included in the select list, the corresponding column in the new table is not a computed column. The
values in the new column are the values that were computed at the time
SELECT...INTO was executed.</li></ol> <p>[<strong><a href="https://msdn.microsoft.com/en-us/library/ms188029.aspx" target="_blank" rel="noopener noreferrer">sic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>]</p> <h2 id="using-transactions-to-change-data-safely"><a href="#using-transactions-to-change-data-safely" class="header-anchor">#</a> Using Transactions to change data safely</h2> <p>Whenever you change data, in a Data Manipulation Language(DML) command, you can wrap your changes in a transaction. DML includes <code>UPDATE</code>, <code>TRUNCATE</code>, <code>INSERT</code> and <code>DELETE</code>. One of the ways that you can make sure that you're changing the right data would be to use a transaction.</p> <p>DML changes will take a lock on the rows affected. When you begin a transaction, you must end the transaction or all objects being changed in the DML will remain locked by whoever began the transaction. You can end your transaction with either <code>ROLLBACK</code> or <code>COMMIT</code>. <code>ROLLBACK</code> returns everything within the transaction to its original state. <code>COMMIT</code> places the data into a final state where you cannot undo your changes without another DML statement.</p> <p><strong>Example:</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--Create a test table</span>

<span class="token keyword">USE</span> <span class="token punctuation">[</span>your <span class="token keyword">database</span><span class="token punctuation">]</span>
GO
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_transaction <span class="token punctuation">(</span>column_1 <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
GO

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> 
 dbo<span class="token punctuation">.</span>test_transaction
        <span class="token punctuation">(</span> column_1 <span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
        <span class="token punctuation">(</span> <span class="token string">'a'</span> <span class="token punctuation">)</span>

<span class="token keyword">BEGIN</span> <span class="token keyword">TRANSACTION</span> <span class="token comment">--This is the beginning of your transaction</span>

<span class="token keyword">UPDATE</span> dbo<span class="token punctuation">.</span>test_transaction
<span class="token keyword">SET</span> column_1 <span class="token operator">=</span> <span class="token string">'B'</span>
OUTPUT INSERTED<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">WHERE</span> column_1 <span class="token operator">=</span> <span class="token string">'A'</span>
  

<span class="token keyword">ROLLBACK</span> <span class="token keyword">TRANSACTION</span>  <span class="token comment">--Rollback will undo your changes</span>
           <span class="token comment">--Alternatively, use COMMIT to save your results</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> dbo<span class="token punctuation">.</span>test_transaction   <span class="token comment">--View the table after your changes have been run</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> dbo<span class="token punctuation">.</span>test_transaction

</code></pre></div><p><strong>Notes:</strong></p> <ul><li>This is a <strong>simplified example</strong> which does not include error handling. But any database operation can fail and hence throw an exception. <strong><a href="http://stackoverflow.com/a/2128105/1016343" target="_blank" rel="noopener noreferrer">Here is an example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> how such a required error handling might look like. You should <strong>never</strong> use transactions <strong>without an error handler</strong>, otherwise you might leave the transaction in an unknown state.</li> <li>Depending on the <strong><a href="https://technet.microsoft.com/en-us/library/ms189122(v=sql.105).aspx" target="_blank" rel="noopener noreferrer">isolation level<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>, transactions are putting locks on the data being queried or changed. You need to ensure that transactions are not running for a long time, because they will lock records in a database and can lead to <strong><a href="https://www.simple-talk.com/sql/performance/sql-server-deadlocks-by-example/" target="_blank" rel="noopener noreferrer">deadlocks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> with other parallel running transactions. Keep the operations encapsulated in transactions as short as possible and minimize the impact with the amount of data you're locking.</li></ul> <h2 id="getting-table-row-count"><a href="#getting-table-row-count" class="header-anchor">#</a> Getting Table Row Count</h2> <p>The following example can be used to find the total row count for a specific table in a database if <code>table_name</code> is replaced by the the table you wish to query:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>TotalRowCount<span class="token punctuation">]</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>

</code></pre></div><p>It is also possible to get the row count for all tables by joining back to the table's partition based off the tables' HEAP (index_id = 0) or cluster clustered index (index_id = 1) using the following script:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span>  <span class="token punctuation">[</span><span class="token keyword">Tables</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name                <span class="token keyword">AS</span> <span class="token punctuation">[</span>TableName<span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token function">SUM</span><span class="token punctuation">(</span> <span class="token punctuation">[</span>Partitions<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token keyword">rows</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>    <span class="token keyword">AS</span> <span class="token punctuation">[</span>TotalRowCount<span class="token punctuation">]</span>
<span class="token keyword">FROM</span>    sys<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">Tables</span><span class="token punctuation">]</span>
<span class="token keyword">JOIN</span>    sys<span class="token punctuation">.</span>partitions <span class="token keyword">AS</span> <span class="token punctuation">[</span>Partitions<span class="token punctuation">]</span>
    <span class="token keyword">ON</span>  <span class="token punctuation">[</span><span class="token keyword">Tables</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>object_id<span class="token punctuation">]</span>    <span class="token operator">=</span>    <span class="token punctuation">[</span>Partitions<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>object_id<span class="token punctuation">]</span>
    <span class="token operator">AND</span> <span class="token punctuation">[</span>Partitions<span class="token punctuation">]</span><span class="token punctuation">.</span>index_id <span class="token operator">IN</span> <span class="token punctuation">(</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span>
<span class="token comment">--WHERE    [Tables].name = N'table name' /* uncomment to look for a specific table */</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>    <span class="token punctuation">[</span><span class="token keyword">Tables</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>

</code></pre></div><p>This is possible as every table is essentially a single partition table, unless extra partitions are added to it.
This script also has the benefit of not interfering with read/write operations to the tables rows'.</p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>This is a set of examples highlighting basic usage of SQL Server.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/mssql/getting-started-with-microsoft-sql-server.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mssql/" class="prev router-link-active">
        Disclaimer
      </a></span> <span class="next"><a href="/mssql/data-types.html">
        Data Types
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2011.14b1753c.js" defer></script>
  </body>
</html>
