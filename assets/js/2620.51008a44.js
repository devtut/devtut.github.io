(window.webpackJsonp=window.webpackJsonp||[]).push([[2620],{3028:function(e,t,s){"use strict";s.r(t);var a=s(31),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"psscriptanalyzer-powershell-script-analyzer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#psscriptanalyzer-powershell-script-analyzer"}},[e._v("#")]),e._v(" PSScriptAnalyzer - PowerShell Script Analyzer")]),e._v(" "),s("p",[e._v("PSScriptAnalyzer, "),s("a",{attrs:{href:"https://github.com/PowerShell/PSScriptAnalyzer",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/PowerShell/PSScriptAnalyzer"),s("OutboundLink")],1),e._v(", is a static code checker for Windows PowerShell modules and scripts. PSScriptAnalyzer checks the quality of Windows PowerShell code by running a set of rules based on PowerShell best practices identified by the PowerShell Team and community. It generates DiagnosticResults (errors and warnings) to inform users about potential code defects and suggests possible solutions for improvements.")]),e._v(" "),s("p",[s("code",[e._v("PS> Install-Module -Name PSScriptAnalyzer")])]),e._v(" "),s("h2",{attrs:{id:"analyzing-scripts-with-the-built-in-preset-rulesets"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#analyzing-scripts-with-the-built-in-preset-rulesets"}},[e._v("#")]),e._v(" Analyzing scripts with the built-in preset rulesets")]),e._v(" "),s("p",[e._v("ScriptAnalyzer ships with sets of built-in preset rules that can be used to analyze scripts. These include: "),s("code",[e._v("PSGallery")]),e._v(", "),s("code",[e._v("DSC")]),e._v(" and "),s("code",[e._v("CodeFormatting")]),e._v(". They can be executed as follows:")]),e._v(" "),s("p",[s("strong",[e._v("PowerShell Gallery rules")])]),e._v(" "),s("p",[e._v("To execute the PowerShell Gallery rules use the following command:")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("Invoke-ScriptAnalyzer")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Path "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("path"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("to"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("module"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Settings PSGallery "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Recurse\n\n")])])]),s("p",[s("strong",[e._v("DSC rules")])]),e._v(" "),s("p",[e._v("To execute the DSC rules use the following command:")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("Invoke-ScriptAnalyzer")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Path "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("path"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("to"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("module"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Settings DSC "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Recurse\n\n")])])]),s("p",[s("strong",[e._v("Code formatting rules")])]),e._v(" "),s("p",[e._v("To execute the code formatting rules use the following command:")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("Invoke-ScriptAnalyzer")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Path "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("path"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("to"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("module"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Settings CodeFormatting "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Recurse\n\n")])])]),s("h2",{attrs:{id:"analyzing-scripts-against-every-built-in-rule"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#analyzing-scripts-against-every-built-in-rule"}},[e._v("#")]),e._v(" Analyzing scripts against every built-in rule")]),e._v(" "),s("p",[e._v("To run the script analyzer against a single script file execute:")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("Invoke-ScriptAnalyzer")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Path myscript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ps1\n\n")])])]),s("p",[e._v("This will analyze your script against every built-in rule.  If your script is sufficiently large that could result in a lot of warnings and/or errors.")]),e._v(" "),s("p",[e._v("To run the script analyzer against a whole directory, specify the folder containing the script, module and DSC files you want analyzed. Specify the Recurse parameter if you also want sub-directories searched for files to analyze.")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("Invoke-ScriptAnalyzer")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Path "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Recurse\n\n")])])]),s("h2",{attrs:{id:"list-all-built-in-rules"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#list-all-built-in-rules"}},[e._v("#")]),e._v(" List all built-in rules")]),e._v(" "),s("p",[e._v("To see all the built-in rules execute:")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("Get-ScriptAnalyzerRule")]),e._v("\n\n")])])]),s("h4",{attrs:{id:"syntax"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#syntax"}},[e._v("#")]),e._v(" Syntax")]),e._v(" "),s("ol",[s("li",[s("code",[e._v("Get-ScriptAnalyzerRule [-CustomizedRulePath <string[]>] [-Name <string[]>] [-Severity <string[]>] [<CommonParameters>]")])]),e._v(" "),s("li",[s("code",[e._v("Invoke-ScriptAnalyzer [-Path] <string> [-CustomizedRulePath <string[]>] [-ExcludeRule <string[]>] [-IncludeRule<string[]>] [-Severity <string[]>] [-Recurse] [-SuppressedOnly] [<CommonParameters>]")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);