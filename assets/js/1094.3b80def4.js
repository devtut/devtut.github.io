(window.webpackJsonp=window.webpackJsonp||[]).push([[1094],{1446:function(t,s,e){"use strict";e.r(s);var a=e(19),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"vba-best-practices"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vba-best-practices"}},[t._v("#")]),t._v(" VBA Best Practices")]),t._v(" "),e("h2",{attrs:{id:"always-use-option-explicit"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#always-use-option-explicit"}},[t._v("#")]),t._v(' ALWAYS Use "Option Explicit"')]),t._v(" "),e("p",[t._v('In the VBA Editor window, from the Tools menu select "Options":')]),t._v(" "),e("p",[e("a",{attrs:{href:"https://i.stack.imgur.com/DBq0L.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.stack.imgur.com/DBq0L.png",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v('Then in the "Editor" tab, make sure that "Require Variable Declaration" is checked:')]),t._v(" "),e("p",[e("a",{attrs:{href:"https://i.stack.imgur.com/B3Gam.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.stack.imgur.com/B3Gam.png",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("Selecting this option will automatically put "),e("code",[t._v("Option Explicit")]),t._v(" at the top of every VBA module.")]),t._v(" "),e("blockquote"),t._v(" "),e("p",[e("strong",[t._v("Small note:")]),t._v(" This is true for the modules, class modules, etc. that haven't been opened so far. So if you already had a look at e.g. the code of "),e("code",[t._v("Sheet1")]),t._v(' before activating the option "Require Variable Declaration", '),e("code",[t._v("Option Explicit")]),t._v(" will not be added!")]),t._v(" "),e("p",[e("code",[t._v("Option Explicit")]),t._v(" requires that every variable has to be defined before use, e.g. with a "),e("code",[t._v("Dim")]),t._v(" statement.  Without "),e("code",[t._v("Option Explicit")]),t._v(" enabled, any unrecognized word will be assumed by the VBA compiler to be a new variable of the "),e("code",[t._v("Variant")]),t._v(" type, causing extremely difficult-to-spot bugs related to typographical errors.  With "),e("code",[t._v("Option Explicit")]),t._v(" enabled, any unrecognized words will cause a compile error to be thrown, indicating the offending line.")]),t._v(" "),e("p",[e("strong",[t._v("Example :")])]),t._v(" "),e("p",[t._v("If you run the following code :")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Test"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  my_variable "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v("\n  MsgBox "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"My Variable is : "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" myvariable\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("You will get the following message :")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://i.stack.imgur.com/DDpmM.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.stack.imgur.com/DDpmM.png",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("You have made an error by writing "),e("code",[t._v("myvariable")]),t._v(" instead of "),e("code",[t._v("my_variable")]),t._v(", then the message box displays an empty variable.\nIf you use "),e("code",[t._v("Option Explicit")]),t._v(" , this error is not possible because you will get a compile error message indicating the problem.")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://i.stack.imgur.com/0K5UY.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.stack.imgur.com/0K5UY.png",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("Now if you add the correct declaration :")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Test"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" my_variable "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n  my_variable "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v("\n  MsgBox "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"My Variable is : "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" myvariable\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("You will obtain an error message indicating precisely the error with "),e("code",[t._v("myvariable")]),t._v(" :")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://i.stack.imgur.com/Z55Ln.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.stack.imgur.com/Z55Ln.png",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("blockquote"),t._v(" "),e("p",[t._v("**Note on Option Explicit and Arrays** ("),e("a",{attrs:{href:"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/declaring-arrays#declaring-a-dynamic-array",rel:"nofollow noreferrer"}},[t._v("Declaring a Dynamic\nArray")]),t._v("):")]),t._v(" "),e("p",[t._v("You can use the ReDim statement to declare an array implicitly within\na procedure.")]),t._v(" "),e("ul",[e("li",[t._v("\nBe careful not to misspell the name of the array when you use the ReDim statement\n")]),t._v(" "),e("li",[t._v('\nEven if the Option Explicit statement is included in the module, a new array will be created\n`Dim arr() as Long`\n`ReDim ar() \'creates new array "ar" - "ReDim ar()" acts like "Dim ar()"`\n')])]),t._v(" "),e("h2",{attrs:{id:"work-with-arrays-not-with-ranges"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#work-with-arrays-not-with-ranges"}},[t._v("#")]),t._v(" Work with Arrays, Not With Ranges")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Office Blog - Excel VBA Performance Coding Best Practices"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("Often, best performance is achieved by avoiding the use of "),e("code",[t._v("Range")]),t._v(" as much as possible. In this example we read in an entire "),e("code",[t._v("Range")]),t._v(" object into an array, square each number in the array, and then return the array back to the "),e("code",[t._v("Range")]),t._v(". This accesses "),e("code",[t._v("Range")]),t._v(" only twice, whereas a loop would access it 20 times for the read/writes.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" WorkWithArrayExample"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" DataRange "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" Irow "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" Icol "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\nDataRange "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:A10"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' read all the values at once from the Excel grid, put into an array")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" Irow "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LBound"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DataRange"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" UBound"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DataRange"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Get the number of rows.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" Icol "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LBound"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DataRange"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" UBound"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DataRange"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Get the number of columns.")]),t._v("\n    DataRange"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Irow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Icol"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DataRange"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Irow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Icol"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" DataRange"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Irow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Icol"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' cell.value^2")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" Icol\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" Irow\nActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:A10"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DataRange "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' writes all the results back to the range at once")]),t._v("\n    \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("More tips and info with timed examples can be found in "),e("a",{attrs:{href:"https://fastexcel.wordpress.com/2011/05/25/writing-efficient-vba-udfs-part-1/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Charles Williams's Writing efficient VBA UDFs (Part 1)"),e("OutboundLink")],1),t._v(" and "),e("a",{attrs:{href:"https://fastexcel.wordpress.com/page/2/?s=writing+efficient",target:"_blank",rel:"noopener noreferrer"}},[t._v("other articles in the series"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h2",{attrs:{id:"switch-off-properties-during-macro-execution"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#switch-off-properties-during-macro-execution"}},[t._v("#")]),t._v(" Switch off properties during macro execution")]),t._v(" "),e("p",[t._v("It is best practice in any programming language to "),e("strong",[t._v("avoid premature optimization.")]),t._v(" However, if testing reveals that your code is running too slowly, you may gain some speed by switching off some of the application’s properties while it runs. Add this code to a standard module:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" SpeedUp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    SpeedUpOn "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Optional")]),t._v(" xlCalc "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" XlCalculation "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" xlCalculationAutomatic "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Application\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" SpeedUpOn "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScreenUpdating "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Calculation "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" xlCalculationManual\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableEvents "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayStatusBar "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'in case you are not showing any messages")]),t._v("\n            ActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayPageBreaks "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'note this is a sheet-level setting")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScreenUpdating "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Calculation "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" xlCalc\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableEvents "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayStatusBar "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n            ActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayPageBreaks "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[e("strong",[t._v("More info on "),e("a",{attrs:{href:"https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Office Blog - Excel VBA Performance Coding Best Practices"),e("OutboundLink")],1)])]),t._v(" "),e("p",[t._v("And just call it at beginning and end of macros:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" SomeMacro\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'store the initial "calculation" state')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" xlCalc "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" XlCalculation\n    xlCalc "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Calculation\n\n    SpeedUp "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'code here ...")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'by giving the second argument the initial "calculation" state is restored')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'otherwise it is set to 'xlCalculationAutomatic'")]),t._v("\n    SpeedUp "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" xlCalc\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v('While these can largely be considered "enhancements" for regular '),e("code",[t._v("Public Sub")]),t._v(" procedures, disabling event handling with "),e("code",[t._v("Application.EnableEvents = False")]),t._v(" should be considered mandatory for "),e("code",[t._v("Worksheet_Change")]),t._v(" and "),e("code",[t._v("Workbook_SheetChange")]),t._v(' private event macros that change values on one or more worksheets. Failure to disable event triggers will cause the event macro to recursively run on top of itself when a value changes and can lead to a "frozen" workbook. Remember to turn events back on before leaving the event macro, possibly through a "safe exit" error handler.')]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Worksheet_Change"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" Target "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" Intersect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Target"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A:A"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" bm_Safe_Exit\n        Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableEvents "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n        \n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'code that may change a value on the worksheet goes here")]),t._v("\n        \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\nbm_Safe_Exit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableEvents "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[e("strong",[t._v("One caveat:")]),t._v(" While disabling these settings will improve run time, they may make debugging your application much more difficult. If your code is "),e("strong",[t._v("not")]),t._v(" functioning correctly, comment out the "),e("code",[t._v("SpeedUp True")]),t._v(" call until you figure out the problem.")]),t._v(" "),e("p",[t._v("This is particularly important if you are writing to cells in a worksheet and then reading back in calculated results from worksheet functions since the "),e("code",[t._v("xlCalculationManual")]),t._v(" prevents the workbook from calculating. To get around this without disabling "),e("code",[t._v("SpeedUp")]),t._v(", you may want to include "),e("code",[t._v("Application.Calculate")]),t._v(" to run a calculation at specific points.")]),t._v(" "),e("p",[e("strong",[t._v("NOTE:")]),t._v(" Since these are properties of the "),e("code",[t._v("Application")]),t._v(" itself, you need to ensure that they are enabled again before your macro exits.  This makes it particularly important to use error handlers and to avoid multiple exit points (i.e. "),e("code",[t._v("End")]),t._v(" or "),e("code",[t._v("Unload Me")]),t._v(").")]),t._v(" "),e("p",[t._v("With error handling:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" SomeMacro"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'store the initial "calculation" state')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" xlCalc "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" XlCalculation\n    xlCalc "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Calculation\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" Handler\n    SpeedUp "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    \n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'code here ...")]),t._v("\n    i "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nCleanExit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    SpeedUp "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" xlCalc\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\nHandler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'handle error")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" CleanExit\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"use-vb-constants-when-available"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#use-vb-constants-when-available"}},[t._v("#")]),t._v(" Use VB constants when available")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" MsgBox"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Click OK"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vbOK "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n\n")])])]),e("p",[t._v("can be used in place of")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" MsgBox"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Click OK"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n\n")])])]),e("p",[t._v("in order to improve readability.")]),t._v(" "),e("p",[t._v("Use "),e("strong",[t._v("Object Browser")]),t._v(" to find available VB constants.  "),e("strong",[t._v("View → Object Browser")]),t._v(" or "),e("kbd",[t._v("F2")]),t._v(" from VB Editor.")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://i.stack.imgur.com/VXZD4.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.stack.imgur.com/VXZD4.png",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("Enter class to search")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://i.stack.imgur.com/tBix3.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.stack.imgur.com/tBix3.png",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("View members available")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://i.stack.imgur.com/QSQJw.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.stack.imgur.com/QSQJw.png",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"avoid-using-select-or-activate"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#avoid-using-select-or-activate"}},[t._v("#")]),t._v(" Avoid using SELECT or ACTIVATE")]),t._v(" "),e("p",[t._v("It is "),e("strong",[t._v("very")]),t._v(" rare that you'll ever want to use "),e("code",[t._v("Select")]),t._v(" or "),e("code",[t._v("Activate")]),t._v(" in your code, but some Excel methods do require a worksheet or workbook to be activated before they'll work as expected.")]),t._v(" "),e("p",[t._v("If you're just starting to learn VBA, you'll often be suggested to record your actions using the macro recorder, then go look at the code. For example, I recorded actions taken to enter a value in cell D3 on Sheet2, and the macro code looks like this:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Macro1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Macro1 Macro")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'")]),t._v("\n    Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet2"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Select")]),t._v("\n    Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D3"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Select")]),t._v("\n    ActiveCell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FormulaR1C1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.1415"')]),t._v("   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'(see **note below)")]),t._v("\n    Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D4"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Select")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("Remember though, the macro recorder creates a line of code for EACH of your (user) actions. This includes clicking on the worksheet tab to select Sheet2 ("),e("code",[t._v('Sheets("Sheet2").Select')]),t._v("), clicking on cell D3 before entering the value ("),e("code",[t._v('Range("D3").Select')]),t._v('), and using the Enter key (which is effectively "selecting" the cell below the currently selected cell: '),e("code",[t._v('Range("D4").Select')]),t._v(").")]),t._v(" "),e("p",[t._v("There are multiple issues with using "),e("code",[t._v(".Select")]),t._v(" here:")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("The worksheet is not always specified.")]),t._v(" This happens if you don't switch worksheets while recording, and means that the code will yield different results for different active worksheets.")]),t._v(" "),e("li",[e("strong",[e("code",[t._v(".Select()")]),t._v(" is slow.")]),t._v(" Even if "),e("code",[t._v("Application.ScreenUpdating")]),t._v(" is set to "),e("code",[t._v("False")]),t._v(", this is an unneccessary operation to be processed.")]),t._v(" "),e("li",[e("strong",[e("code",[t._v(".Select()")]),t._v(" is unruly.")]),t._v(" If "),e("code",[t._v("Application.ScreenUpdating")]),t._v(" is left to "),e("code",[t._v("True")]),t._v(", Excel will actually select the cells, the worksheet, the form... whatever it is you're working with. This is stressful to the eyes and really unpleasant to watch.")]),t._v(" "),e("li",[e("strong",[e("code",[t._v(".Select()")]),t._v(" will trigger listeners.")]),t._v(" This is a bit advanced already, but unless worked around, functions like "),e("code",[t._v("Worksheet_SelectionChange()")]),t._v(" will be triggered.")])]),t._v(" "),e("p",[t._v('When you\'re coding in VBA, all of the "typing" actions (i.e. '),e("code",[t._v("Select")]),t._v(" statements) are no longer necessary. Your code may be reduced to a single statement to put the value in the cell:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- GOOD")]),t._v("\nActiveWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet2"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D3"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.1415")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- BETTER")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" myWB      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" myWS      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" myCell    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" myWB "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook             "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'*** see NOTE2")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" myWS "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" myWB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet2"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" myCell "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" myWS"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D3"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmyCell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.1415")]),t._v("\n\n")])])]),e("p",[t._v("(The BETTER example above shows using intermediate variables to separate different parts of the cell reference. The GOOD example will always work just fine, but can be very cumbersome in much longer code modules and more difficult to debug if one of the references is mistyped.)")]),t._v(" "),e("p",[t._v("**NOTE: the macro recorder makes many assumptions about the type of data you're entering, in this case entering a string value as a formula to create the value. Your code doesn't have to do this and can simply assign a numerical value directly to the cell as shown above.")]),t._v(" "),e("p",[t._v("**NOTE2: the recommended practice is to set your local workbook variable to "),e("code",[t._v("ThisWorkbook")]),t._v(" instead of "),e("code",[t._v("ActiveWorkbook")]),t._v(" (unless you explicitly need it). The reason is your macro will generally need/use resources in whatever workbook the VBA code originates and will NOT look outside of that workbook -- again, unless you explicitly direct your code to work with another workbook. When you have multiple workbooks open in Excel, the "),e("code",[t._v("ActiveWorkbook")]),t._v(" is the one with the focus "),e("strong",[t._v("which may be different from the workbook being viewed in your VBA Editor")]),t._v(". So you think you're executing in a one workbook when you're really referencing another. "),e("code",[t._v("ThisWorkbook")]),t._v(" refers to the workbook containing the code being executed.")]),t._v(" "),e("h2",{attrs:{id:"always-define-and-set-references-to-all-workbooks-and-sheets"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#always-define-and-set-references-to-all-workbooks-and-sheets"}},[t._v("#")]),t._v(" Always define and set references to all Workbooks and Sheets")]),t._v(" "),e("p",[t._v("When working with multiple open Workbooks, each of which may have multiple Sheets, it’s safest to define and set reference to all Workbooks and Sheets.")]),t._v(" "),e("p",[e("strong",[t._v("Don't rely")]),t._v(" on "),e("code",[t._v("ActiveWorkbook")]),t._v(" or "),e("code",[t._v("ActiveSheet")]),t._v(" as they might be changed by the user.")]),t._v(" "),e("p",[t._v("The following code example demonstrates how to copy a range from “"),e("strong",[t._v("Raw_Data")]),t._v("” sheet in the “"),e("strong",[t._v("Data.xlsx")]),t._v("” workbook to “"),e("strong",[t._v("Refined_Data")]),t._v("” sheet in the “"),e("strong",[t._v("Results.xlsx")]),t._v("” workbook.")]),t._v(" "),e("p",[t._v("The procedure also demonstrates how to copy and paste without using the "),e("code",[t._v("Select")]),t._v(" method.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" CopyRanges_BetweenShts"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" wbSrc                           "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" wbDest                          "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" shtCopy                         "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" shtPaste                        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n    \n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' set reference to all workbooks by name, don't rely on ActiveWorkbook")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" wbSrc "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Data.xlsx"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" wbDest "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Results.xlsx"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' set reference to all sheets by name, don't rely on ActiveSheet")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" shtCopy "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wbSrc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheet1 "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'// "Raw_Data" sheet')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" shtPaste "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wbDest"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheet2 "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'// "Refined_Data") sheet')]),t._v("\n    \n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\' copy range from "Data" workbook to "Results" workbook without using Select')]),t._v("\n    shtCopy"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:C10"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Copy "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n    Destination"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("shtPaste"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"use-descriptive-variable-naming"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#use-descriptive-variable-naming"}},[t._v("#")]),t._v(" Use descriptive variable naming")]),t._v(" "),e("p",[t._v("Descriptive names and structure in your code help make comments unnecessary")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" ductWidth  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" ductHeight "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" ductArea   "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n\nductArea "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ductWidth "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" ductHeight\n\n")])])]),e("p",[t._v("is better than")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" a"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" w"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" h\n\na "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" w "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" h\n\n")])])]),e("p",[t._v("This is especially helpful when you are copying data from one place to another, whether it's a cell, range, worksheet, or workbook. Help yourself by using names such as these:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" myWB "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" srcWS "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" destWS "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" srcData "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" destData "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" myWB "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ActiveWorkbook\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" srcWS "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" myWB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" destWS "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" myWB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet2"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" srcData "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" srcWS"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:A10"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" destData "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" destWS"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B11:B20"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndestData "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" srcData\n\n")])])]),e("p",[t._v("If you declare multiple variables in one line make sure to specify a type for "),e("strong",[t._v("every")]),t._v(" variable like:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" ductWidth "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ductHeight "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ductArea "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n\n")])])]),e("p",[t._v("The following will only declare the last variable and the first ones will remain "),e("code",[t._v("Variant")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" ductWidth"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ductHeight"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ductArea "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"document-your-work"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#document-your-work"}},[t._v("#")]),t._v(" Document Your Work")]),t._v(" "),e("p",[t._v("It's good practice to document your work for later use, especially if you are coding for a dynamic workload. Good comments should explain why the code is doing something, not what the code is doing.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" Bonus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EmployeeTitle "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" EmployeeTitle "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sales"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        Bonus "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Sales representatives receive commission instead of a bonus")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        Bonus "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".10")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),e("p",[t._v("If your code is so obscure that it requires comments to explain what it is doing, consider rewriting it to be more clear instead of explaining it through comments. For example, instead of:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" CopySalesNumbers\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" IncludeWeekends "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    \n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Boolean values can be evaluated as an integer, -1 for True, 0 for False.")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'This is used here to adjust the range from 5 to 7 rows if including weekends.")]),t._v("\n    Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:A"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IncludeWeekends "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Copy\n    Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PasteSpecial\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("Clarify the code to be easier to follow, such as:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" CopySalesNumbers\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" IncludeWeekends "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" DaysinWeek "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n    \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" IncludeWeekends "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        DaysinWeek "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        DaysinWeek "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:A"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" DaysinWeek"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Copy\n    Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PasteSpecial\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" \n\n")])])]),e("h2",{attrs:{id:"error-handling"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#error-handling"}},[t._v("#")]),t._v(" Error Handling")]),t._v(" "),e("p",[t._v("Good error handling prevents end users from seeing VBA runtime errors and helps the developer easily diagnose and correct errors.")]),t._v(" "),e("p",[t._v("There are three main methods of Error Handling in VBA, two of which should be avoided for distributed programs unless specifically required in the code.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Avoid using")]),t._v("\n\n")])])]),e("p",[t._v("or")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Avoid using")]),t._v("\n\n")])])]),e("p",[t._v("Prefer using:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("line"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Prefer using")]),t._v("\n\n")])])]),e("h3",{attrs:{id:"on-error-goto-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#on-error-goto-0"}},[t._v("#")]),t._v(" On Error GoTo 0")]),t._v(" "),e("p",[t._v("If no error handling is set in your code, "),e("code",[t._v("On Error GoTo 0")]),t._v(" is the default error handler.  In this mode, any runtime errors will launch the typical VBA error message, allowing you to either end the code or enter "),e("code",[t._v("debug")]),t._v(" mode, identifying the source.  While writing code, this method is the simplest and most useful, but it should always be avoided for code that is distributed to end users, as this method is very unsightly and difficult for end users to understand.")]),t._v(" "),e("h3",{attrs:{id:"on-error-resume-next"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#on-error-resume-next"}},[t._v("#")]),t._v(" On Error Resume Next")]),t._v(" "),e("p",[e("code",[t._v("On Error Resume Next")]),t._v(" will cause VBA to ignore any errors that are thrown at runtime for all lines following the error call until the error handler has been changed.  In very specific instances, this line can be useful, but it should be avoided outside of these cases.  For example, when launching a separate program from an Excel Macro, the "),e("code",[t._v("On Error Resume Next")]),t._v(" call can be useful if you are unsure whether or not the program is already open:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'In this example, we open an instance of Powerpoint using the On Error Resume Next call")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" PPApp "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" PowerPoint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Application\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" PPPres "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" PowerPoint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Presentation\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" PPSlide "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" PowerPoint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Slide\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Open PPT if not running, otherwise select active instance")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" PPApp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PowerPoint.Application"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" ErrHandler\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" PPApp "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Open PowerPoint")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" PPApp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PowerPoint.Application"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    PPApp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Visible "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n\n")])])]),e("p",[t._v("Had we not used the "),e("code",[t._v("On Error Resume Next")]),t._v(" call and the Powerpoint application was not already open, the "),e("code",[t._v("GetObject")]),t._v(" method would throw an error.  Thus, "),e("code",[t._v("On Error Resume Next")]),t._v(" was necessary to avoid creating two instances of the application.")]),t._v(" "),e("p",[e("strong",[t._v("Note:")]),t._v(" It is also a best practice to "),e("strong",[t._v("immediately")]),t._v(" reset the error handler as soon as you no longer need the "),e("code",[t._v("On Error Resume Next")]),t._v(" call")]),t._v(" "),e("h3",{attrs:{id:"on-error-goto"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#on-error-goto"}},[t._v("#")]),t._v(" On Error GoTo "),e("line")]),t._v(" "),e("p",[t._v("This method of error handling is recommended for all code that is distributed to other users.  This allows the programmer to control exactly how VBA handles an error by sending the code to the specified line.  The  tag can be filled with any string (including numeric strings), and will send the code to the corresponding string that is followed by a colon.  Multiple error handling blocks can be used by making different calls of "),e("code",[t._v("On Error GoTo <line>")]),t._v(". The subroutine below demonstrates the syntax of an "),e("code",[t._v("On Error GoTo <line>")]),t._v(" call.")]),t._v(" "),e("p",[e("strong",[t._v("Note:")]),t._v(" It is essential that the "),e("code",[t._v("Exit Sub")]),t._v(" line is placed above the first error handler and before every subsequent error handler to prevent the code from naturally progressing into the block "),e("strong",[t._v("without")]),t._v(" an error being called.  Thus, it is best practice for function and readability to place error handlers at the end of a code block.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" YourMethodName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" errorHandler\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Insert code here")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" secondErrorHandler\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'The exit sub line is essential, as the code will otherwise")]),t._v("\n             "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'continue running into the error handling block, likely causing an error")]),t._v("\n\nerrorHandler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    MsgBox "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Error "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Err"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Err"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Description "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('" in "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n        VBE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ActiveCodePane"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CodeModule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vbOKOnly"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Error"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\nsecondErrorHandler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Err"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("424")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Object not found error (purely for illustration)")]),t._v("\n        Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScreenUpdating "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableEvents "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        MsgBox "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Error "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Err"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Err"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Desctription\n        Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScreenUpdating "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableEvents "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("   \n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("      \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("If you exit your method with your error handling code, ensure that you clean up:")]),t._v(" "),e("ul",[e("li",[t._v("Undo anything that is partially completed")]),t._v(" "),e("li",[t._v("Close files")]),t._v(" "),e("li",[t._v("Reset screen updating")]),t._v(" "),e("li",[t._v("Reset calculation mode")]),t._v(" "),e("li",[t._v("Reset events")]),t._v(" "),e("li",[t._v("Reset mouse pointer")]),t._v(" "),e("li",[t._v("Call unload method on instances of objects, that persist after the "),e("code",[t._v("End Sub")])]),t._v(" "),e("li",[t._v("Reset status bar")])]),t._v(" "),e("h2",{attrs:{id:"never-assume-the-worksheet"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#never-assume-the-worksheet"}},[t._v("#")]),t._v(" Never Assume The Worksheet")]),t._v(" "),e("p",[t._v("Even when all your work is directed at a single worksheet, it's still a very good practice to explicitly specify the worksheet in your code. This habit makes it much easier to expand your code later, or to lift parts (or all) of a "),e("code",[t._v("Sub")]),t._v(" or "),e("code",[t._v("Function")]),t._v(" to be re-used someplace else. Many developers establish a habit of (re)using the same local variable name for a worksheet in their code, making re-use of that code even more straightforward.")]),t._v(" "),e("p",[t._v("As an example, the following code is ambiguous -- but works! -- as long the developer doesn't activate or change to a different worksheet:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ShowTheTime"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- displays the current time and date in cell A1 on the worksheet")]),t._v("\n    Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Now"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' don't refer to Cells without a sheet reference!")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("If "),e("code",[t._v("Sheet1")]),t._v(" is active, then cell A1 on Sheet1 will be filled with the current date and time. But if the user changes worksheets for any reason, then the code will update whatever the worksheet is currently active. The destination worksheet is ambiguous.")]),t._v(" "),e("p",[t._v("The best practice is to always identify which worksheet to which your code refers:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ShowTheTime"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- displays the current time and date in cell A1 on the worksheet")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" myWB "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" myWB "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" timestampSH "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" timestampSH "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" myWB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    timestampSH"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Now"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("The code above is clear in identifying both the workbook and the worksheet. While it may seem like overkill, creating a good habit concerning target references will save you from future problems.")]),t._v(" "),e("h2",{attrs:{id:"avoid-using-activecell-or-activesheet-in-excel"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#avoid-using-activecell-or-activesheet-in-excel"}},[t._v("#")]),t._v(" Avoid using ActiveCell or ActiveSheet in Excel")]),t._v(" "),e("p",[t._v("Using "),e("code",[t._v("ActiveCell")]),t._v(" or "),e("code",[t._v("ActiveSheet")]),t._v(" can be source of mistakes if (for any reason) the code is executed in the wrong place.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[t._v("ActiveCell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello"')]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'will place "Hello" in the cell that is currently selected')]),t._v("\nCells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello"')]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'will always place "Hello" in A1 of the currently selected sheet')]),t._v("\n\nActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello"')]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'will place "Hello" in A1 of the currently selected sheet')]),t._v("\nSheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MySheetName"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello"')]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'will always place "Hello" in A1 of the sheet named "MySheetName"')]),t._v("\n\n")])])]),e("ul",[e("li",[t._v("The use of "),e("code",[t._v("Active*")]),t._v(" can create problems in long running macros if your user gets bored and clicks on another worksheet or opens another workbook.")]),t._v(" "),e("li",[t._v("It can create problems if your code opens or creates another workbook.")]),t._v(" "),e("li",[t._v("It can create problems if your code uses "),e("code",[t._v('Sheets("MyOtherSheet").Select')]),t._v(" and you've forgotten which sheet you were on before you start reading from or writing to it.")])]),t._v(" "),e("h2",{attrs:{id:"worksheetfunction-object-executes-faster-than-a-udf-equivalent"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#worksheetfunction-object-executes-faster-than-a-udf-equivalent"}},[t._v("#")]),t._v(" WorksheetFunction object executes faster than a UDF equivalent")]),t._v(" "),e("p",[t._v("VBA is compiled in run-time, which has a huge negative impact on it's performance, everything built-in will be faster, try to use them.")]),t._v(" "),e("p",[t._v("As an example I'm comparing SUM and COUNTIF functions, but you can use if for anything you can solve with WorkSheetFunctions.")]),t._v(" "),e("p",[t._v("A first attempt for those would be to loop through the range and process it cell by cell (using a range):")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" UseRange"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" rng "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" Range\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" Total "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    \n    Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" rng "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:A100"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" rng"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value2\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" rng"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" rng\n    Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" CountLessThan01\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("One improvement can be to store the range values in an array and process that:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" UseArray"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" DataToSummarize "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" i "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" Total "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    \n    DataToSummarize "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:A100"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value2 "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'faster than .Value")]),t._v("\n    Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" i "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n        Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" DataToSummarize"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" DataToSummarize"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" i\n    Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" CountLessThan01\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("But instead of writing any loop you can use "),e("code",[t._v("Application.Worksheetfunction")]),t._v(" which is very handy for executing simple formulas:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" UseWorksheetFunction"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" Total "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WorksheetFunction\n        Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sum"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:A100"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CountIf"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:A100"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<0.1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n    \n    Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" CountLessThan01\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("Or, for more complex calculations you can even use "),e("code",[t._v("Application.Evaluate")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" UseEvaluate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" Total "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Application\n        Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Evaluate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SUM("')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Sheet1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1:A100"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Address"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n            external"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('")"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        CountLessThan01 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Evaluate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"COUNTIF(\'Sheet1\'!A1:A100,""<0.1"")"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n    \n    Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print Total "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" CountLessThan01\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("And finally, running above Subs 25,000 times each, here is the average (5 tests) time in milliseconds (of course it'll be different on each pc, but compared to each other they'll behave similarly):")]),t._v(" "),e("ol",[e("li",[t._v("UseWorksheetFunction: 2156 ms")]),t._v(" "),e("li",[t._v("UseArray: 2219 ms (+ 3 %)")]),t._v(" "),e("li",[t._v("UseEvaluate: 4693 ms (+ 118 %)")]),t._v(" "),e("li",[t._v("UseRange: 6530 ms (+ 203 %)")])]),t._v(" "),e("h2",{attrs:{id:"avoid-re-purposing-the-names-of-properties-or-methods-as-your-variables"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#avoid-re-purposing-the-names-of-properties-or-methods-as-your-variables"}},[t._v("#")]),t._v(" Avoid re-purposing the names of Properties or Methods as your variables")]),t._v(" "),e("p",[t._v("It is generally not considered 'best practice' to re-purpose the reserved names of Properties or Methods as the name(s) of your own procedures and variables.")]),t._v(" "),e("p",[e("strong",[t._v("Bad Form")]),t._v(" - While the following is (strictly speaking) legal, working code the re-purposing of the "),e("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("Find"),e("OutboundLink")],1),t._v(" method as well as the "),e("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/office/ff196952.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("Row"),e("OutboundLink")],1),t._v(", "),e("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/office/ff198200.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("Column"),e("OutboundLink")],1),t._v(" and "),e("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/office/ff837625.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("Address"),e("OutboundLink")],1),t._v(" properties can cause problems/conflicts with name ambiguity and is just plain confusing in general.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" find"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" row "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" column "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" find "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" address "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range\n    \n    find "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"something"')]),t._v("\n    \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" ThisWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" address "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SpecialCells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlCellTypeLastCell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        row "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("what"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("find"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" after"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("address"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("row        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'< note .row not capitalized")]),t._v("\n        column "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("what"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("find"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" after"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("address"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("column  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'< note .column not capitalized")]),t._v("\n        \n        Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"The first 'something' is in \"")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("row"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" column"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("address"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[e("strong",[t._v("Good Form")]),t._v(" - With all of the reserved words renamed into close but unique approximations of the originals, any potential naming conflicts have been avoided.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" myFind"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" rw "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" col "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" wht "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lastCell "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range\n    \n    wht "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"something"')]),t._v("\n    \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" ThisWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" lastCell "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SpecialCells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlCellTypeLastCell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        rw "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Find"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("What"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("wht"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" After"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("lastCell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row         "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'◄ note .Find and .Row")]),t._v("\n        col "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Find"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("What"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("wht"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" After"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("lastCell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Column     "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'◄ .Find and .Column")]),t._v("\n        \n        Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"The first 'something' is in \"")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rw"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" col"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Address"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("While there may come a time when you want to intentionally rewrite a standard method or property to your own specifications, those situations are few and far between. For the most part, stay away from reusing reserved names for your own constructs.")]),t._v(" "),e("h4",{attrs:{id:"remarks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[t._v("#")]),t._v(" Remarks")]),t._v(" "),e("p",[t._v("We all know them, but these practices are far less obvious to someone starting to program in VBA.")])])}),[],!1,null,null,null);s.default=n.exports}}]);