(window.webpackJsonp=window.webpackJsonp||[]).push([[2006],{2413:function(s,t,a){"use strict";a.r(t);var n=a(31),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"for-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#for-json"}},[s._v("#")]),s._v(" FOR JSON")]),s._v(" "),a("h2",{attrs:{id:"for-json-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#for-json-path"}},[s._v("#")]),s._v(" FOR JSON PATH")]),s._v(" "),a("p",[s._v("Formats results of SELECT query as JSON text. FOR JSON PATH clause is added after query:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" object_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" principal_id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" JSON PATH\n\n")])])]),a("p",[s._v("Column names will be used as keys in JSON, and cell values will be generated as JSON values. Result of the query would be an array of JSON objects:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrscols"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),s._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("       \n  {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrowsets"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),s._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysclones"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),s._v("}\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])])]),a("p",[s._v("NULL values in principal_id column will be ignored (they will not be generated).")]),s._v(" "),a("h2",{attrs:{id:"for-json-path-with-column-aliases"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#for-json-path-with-column-aliases"}},[s._v("#")]),s._v(" FOR JSON PATH with column aliases")]),s._v(" "),a("p",[s._v("FOR JSON PATH enables you to control format of the output JSON using column aliases:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" object_id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" JSON PATH\n\n")])])]),a("p",[s._v("Column alias will be used as a key name. Dot-separated column aliases (data.name and data.type) will be generated as nested objects. If two column have the same prefix in dot notation, they will be grouped together in single object (data in this example):")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data"')]),s._v(":{"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrscols"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),s._v("}}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data"')]),s._v(":{"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrowsets"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),s._v("}}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data"')]),s._v(":{"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysclones"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),s._v("}}\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])])]),a("h2",{attrs:{id:"for-json-clause-without-array-wrapper-single-object-in-output"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#for-json-clause-without-array-wrapper-single-object-in-output"}},[s._v("#")]),s._v(" FOR JSON clause without array wrapper (single object in output)")]),s._v(" "),a("p",[s._v("WITHOUT_ARRAY_WRAPPER option enables you to generate a single object instead of the array. Use this option if you know that you will return single row/object:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" object_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" principal_id\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" object_id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" JSON PATH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" WITHOUT_ARRAY_WRAPPER\n\n")])])]),a("p",[s._v("Single object will be returned in this case:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("{"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrscols"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),s._v("}\n\n")])])]),a("h2",{attrs:{id:"include-null-values"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#include-null-values"}},[s._v("#")]),s._v(" INCLUDE_NULL_VALUES")]),s._v(" "),a("p",[s._v('FOR JSON clause ignores NULL values in cells. If you want to generate "key": null pairs for cells that contain NULL values, add INCLUDE_NULL_VALUES option in the query:')]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" object_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" principal_id\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" JSON PATH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" INCLUDE_NULL_VALUES\n\n")])])]),a("p",[s._v("NULL values in principal_id column will be generated:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrscols"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"principal_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrowsets"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"principal_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysclones"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"principal_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v("}\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])])]),a("h2",{attrs:{id:"wrapping-results-with-root-object"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wrapping-results-with-root-object"}},[s._v("#")]),s._v(" Wrapping results with ROOT object")]),s._v(" "),a("p",[s._v("Wraps returned JSON array in additional root object with specified key:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" object_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" JSON PATH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ROOT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'data'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])])]),a("p",[s._v("Result of the query would be array of JSON objects inside the wrapper object:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("{\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n           {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrscols"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),s._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n           {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrowsets"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),s._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n           {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysclones"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"S "')]),s._v("}\n         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n}\n\n")])])]),a("h2",{attrs:{id:"for-json-auto"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#for-json-auto"}},[s._v("#")]),s._v(" FOR JSON AUTO")]),s._v(" "),a("p",[s._v("Automatically nests values from the second table as a nested sub-array of JSON objects:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("column_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects o\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("columns")]),s._v(" c "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object_id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object_id \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" JSON AUTO\n\n")])])]),a("p",[s._v("Result of the query would be array of JSON objects:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  {\n   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrscols"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"c"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"column_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bitpos"')]),s._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"column_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cid"')]),s._v("}\n       "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  }"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  {\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"object_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sysrowsets"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"c"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n         {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"column_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"colguid"')]),s._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n         {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"column_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hbcolid"')]),s._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n         {"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"column_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"maxinrowlen"')]),s._v("}\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  }\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])])]),a("h2",{attrs:{id:"creating-custom-nested-json-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-custom-nested-json-structure"}},[s._v("#")]),s._v(" Creating custom nested JSON structure")]),s._v(" "),a("p",[s._v("If you need some complex JSON structure that cannot be created using FOR JSON PATH or FOR JSON AUTO, you can customize your JSON output by putting FOR JSON sub-queries as column expressions:")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" column_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("columns")]),s._v(" c "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object_id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object_id\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" JSON PATH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("columns")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" parameter_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parameters p "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object_id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object_id\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" JSON PATH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" parameters\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects o\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" JSON PATH\n\n")])])]),a("p",[s._v("Each sub-query will produce JSON result that will be included in the main JSON content.")])])}),[],!1,null,null,null);t.default=e.exports}}]);