(window.webpackJsonp=window.webpackJsonp||[]).push([[556],{964:function(t,a,s){"use strict";s.r(a);var e=s(31),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"compound-literals"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compound-literals"}},[t._v("#")]),t._v(" Compound Literals")]),t._v(" "),s("h2",{attrs:{id:"definition-initialisation-of-compound-literals"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#definition-initialisation-of-compound-literals"}},[t._v("#")]),t._v(" Definition/Initialisation of Compound Literals")]),t._v(" "),s("p",[t._v("A compound literal is an unnamed object which is created in the scope where is defined. The concept was first introduced in C99 standard. An example for compound literal is")]),t._v(" "),s("h3",{attrs:{id:"examples-from-c-standard-c11-ยง6-5-2-5-9"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#examples-from-c-standard-c11-ยง6-5-2-5-9"}},[t._v("#")]),t._v(" Examples from C standard, C11-ยง6.5.2.5/9:")]),t._v(" "),s("blockquote"),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("p "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[s("code",[t._v("p")]),t._v(" is initialized to the address of the first element of an unnamed array of two ints.")]),t._v(" "),s("p",[t._v("The compound literal is an lvalue. The storage duration of the unnamed object is either static (if the literal appears at file scope) or automatic (if the literal appears at block scope), and in the latter case the object's lifetime ends when control leaves the enclosing block.")]),t._v(" "),s("blockquote"),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("f")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*...*/")]),t._v("\n    p "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("p "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*...*/")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("p",[s("code",[t._v("p")]),t._v(" is assigned the address of the first element of an array of two ints, the first having the value previously pointed to by "),s("code",[t._v("p")]),t._v(" and the second, zero.[...]")]),t._v(" "),s("p",[t._v("Here "),s("code",[t._v("p")]),t._v(" remains valid until the end of the block.")]),t._v(" "),s("h3",{attrs:{id:"compound-literal-with-designators"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compound-literal-with-designators"}},[t._v("#")]),t._v(" Compound literal with designators")]),t._v(" "),s("p",[t._v("(also from C11)")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\n struct point {\n    unsigned x;\n    unsigned y;\n  };\n\n  extern void drawline(struct point, struct point);\n\n // used somewhere like this\n drawline((struct point){.x=1, .y=1}, (struct point){.x=3, .y=4});\n\n")])])]),s("p",[t._v("A fictive function "),s("code",[t._v("drawline")]),t._v(" receives two arguments of type "),s("code",[t._v("struct point")]),t._v(". The first has coordinate values "),s("code",[t._v("x == 1")]),t._v(" and "),s("code",[t._v("y == 1")]),t._v(", whereas the\nsecond has "),s("code",[t._v("x == 3")]),t._v(" and "),s("code",[t._v("y == 4")])]),t._v(" "),s("h3",{attrs:{id:"compound-literal-without-specifying-array-length"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compound-literal-without-specifying-array-length"}},[t._v("#")]),t._v(" Compound literal without specifying array length")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("p "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n\n")])])]),s("p",[t._v("In this case the size of the array is no specified then it will be determined by the length of the initializer.")]),t._v(" "),s("h3",{attrs:{id:"compound-literal-having-length-of-initializer-less-than-array-size-specified"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compound-literal-having-length-of-initializer-less-than-array-size-specified"}},[t._v("#")]),t._v(" Compound literal having length of initializer less than array size specified")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("p "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\n")])])]),s("p",[t._v("rest of the elements of compound literal will be initialized to "),s("code",[t._v("0")]),t._v(" implicitly.")]),t._v(" "),s("h3",{attrs:{id:"read-only-compound-literal"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#read-only-compound-literal"}},[t._v("#")]),t._v(" Read-only compound literal")]),t._v(" "),s("p",[t._v("Note that a compound literal is an lvalue and therefore it's elements can be modifiable. A "),s("strong",[t._v("read-only")]),t._v(" compound literal can be specified using "),s("code",[t._v("const")]),t._v(" qualifier as "),s("code",[t._v("(const int[]){1,2}")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"compound-literal-containing-arbitrary-expressions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compound-literal-containing-arbitrary-expressions"}},[t._v("#")]),t._v(" Compound literal containing arbitrary expressions")]),t._v(" "),s("p",[t._v("Inside a function, a compound literal, as for any initialization since C99, can have arbitrary expressions.")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" j "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*...*/")]),t._v("\n    p "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("j"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("j "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*...*/")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("h4",{attrs:{id:"syntax"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#syntax"}},[t._v("#")]),t._v(" Syntax")]),t._v(" "),s("ul",[s("li",[t._v("(type){ initializer-list }")])]),t._v(" "),s("h4",{attrs:{id:"remarks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[t._v("#")]),t._v(" Remarks")]),t._v(" "),s("p",[t._v("C standard says in C11-ยง6.5.2.5/3:")]),t._v(" "),s("blockquote"),t._v(" "),s("p",[t._v("A postfix expression that consists of a parenthesized type name followed by a brace enclosed list of initializers is a "),s("strong",[t._v("compound literal")]),t._v(". It provides an unnamed object whose value is given by the initializer list."),s("sup",[t._v("99)")])]),t._v(" "),s("p",[t._v("and footnote 99 says:")]),t._v(" "),s("blockquote"),t._v(" "),s("p",[s("sub",[t._v("Note that this differs from a cast expression. For example, a cast specifies a conversion to scalar types or "),s("strong",[t._v("void")]),t._v(" only, and the result of a cast expression is not an lvalue.")])]),t._v(" "),s("p",[t._v("Note that:")]),t._v(" "),s("blockquote"),t._v(" "),s("p",[t._v("String literals, and compound literals with const-qualified types, need not designate distinct objects."),s("sup",[t._v("101)")])]),t._v(" "),s("blockquote"),t._v(" "),s("p",[s("sub",[t._v("101) This allows implementations to share storage for string literals and constant compound literals with the same or overlapping representations.")])]),t._v(" "),s("p",[t._v("Example is given in standard:"),s("br"),t._v("\nC11-ยง6.5.2.5/13:")]),t._v(" "),s("blockquote"),t._v(" "),s("p",[t._v("Like string literals, const-qualified compound literals can be placed into read-only memory and can even be shared. For example,")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"abc"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"abc"')]),t._v("\n\n")])])]),s("p",[t._v("might yield 1 if the literalsโ storage is shared.")])])}),[],!1,null,null,null);a.default=n.exports}}]);