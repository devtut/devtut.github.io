(window.webpackJsonp=window.webpackJsonp||[]).push([[3111],{3519:function(s,a,t){"use strict";t.r(a);var e=t(31),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"singleton-class"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#singleton-class"}},[s._v("#")]),s._v(" Singleton Class")]),s._v(" "),t("h2",{attrs:{id:"inheritance-of-singleton-class"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#inheritance-of-singleton-class"}},[s._v("#")]),s._v(" Inheritance of Singleton Class")]),s._v(" "),t("h3",{attrs:{id:"subclassing-also-subclasses-singleton-class"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#subclassing-also-subclasses-singleton-class"}},[s._v("#")]),s._v(" Subclassing also Subclasses Singleton Class")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("singleton_class "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> #<Class:Example>")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SubExample")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SubExample")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :example")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SubExample")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("singleton_class"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("superclass "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> #<Class:Example>")]),s._v("\n\n")])])]),t("h3",{attrs:{id:"extending-or-including-a-module-does-not-extend-singleton-class"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#extending-or-including-a-module-does-not-extend-singleton-class"}},[s._v("#")]),s._v(" Extending or Including a Module does not Extend Singleton Class")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ExampleModule")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ExampleModule")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":foo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extend")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ExampleModule")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ExampleModule")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> NoMethodError: undefined method")]),s._v("\n\n")])])]),t("h2",{attrs:{id:"singleton-classes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#singleton-classes"}},[s._v("#")]),s._v(" Singleton classes")]),s._v(" "),t("p",[s._v("All objects are instances of a class. However, that is not the whole truth. In Ruby, every object also has a somewhat hidden "),t("strong",[s._v("singleton class")]),s._v(".")]),s._v(" "),t("p",[s._v("This is what allows methods to be defined on individual objects. The singleton class sits between the object itself and its actual class, so all methods defined on it are available for that object, and that object only.")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[s._v("object "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[s._v("object"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exclusive_method")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Only this object will respond to this method'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\nobject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exclusive_method\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# => "Only this object will respond to this method"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exclusive_method "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rescue")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# => #<NoMethodError: undefined method `exclusive_method' for #<Object:0xa17b77c>>")]),s._v("\n\n")])])]),t("p",[s._v("The example above could have been written using "),t("a",{attrs:{href:"http://ruby-doc.org/core/Object.html#method-i-define_singleton_method",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("define_singleton_method")]),t("OutboundLink")],1),s._v(":")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[s._v("object"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("define_singleton_method "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":exclusive_method")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The method is actually defined in the object\'s singleton class"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n")])])]),t("p",[s._v("Which is the same as defining the method on "),t("code",[s._v("object")]),s._v("'s "),t("a",{attrs:{href:"http://ruby-doc.org/core/Object.html#method-i-singleton_class",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("singleton_class")]),t("OutboundLink")],1),s._v(":")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# send is used because define_method is private")]),s._v("\nobject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("singleton_class"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("send "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":define_method")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":exclusive_method")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Now we\'re defining an instance method directly on the singleton class"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n")])])]),t("p",[s._v("Before the existence of "),t("code",[s._v("singleton_class")]),s._v(" as part of Ruby's core API, singleton classes were known as "),t("strong",[s._v("metaclasses")]),s._v(" and could be accessed via the following idiom:")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" object\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("self")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# refers to object's singleton_class")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n")])])]),t("h2",{attrs:{id:"introduction"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[s._v("#")]),s._v(" Introduction")]),s._v(" "),t("p",[s._v("Ruby has three types of objects:")]),s._v(" "),t("ul",[t("li",[s._v("Classes and modules which are instances of class Class or class Module.")]),s._v(" "),t("li",[s._v("Instances of classes.")]),s._v(" "),t("li",[s._v("Singleton Classes.")])]),s._v(" "),t("p",[s._v("Each object has a class which contains its methods:")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\nobject "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v("\n\nobject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# => Example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# => Class")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# => Class")]),s._v("\n\n")])])]),t("p",[s._v("Objects themselves can't contain methods, only their class can. But with singleton classes, it is possible to add methods to any object including other singleton classes.")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[s._v("object"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":foo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\nobject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :foo")]),s._v("\n\n")])])]),t("p",[t("code",[s._v("foo")]),s._v(" is defined on singleton class of "),t("code",[s._v("object")]),s._v(". Other "),t("code",[s._v("Example")]),s._v(" instances can not reply to "),t("code",[s._v("foo")]),s._v(".")]),s._v(" "),t("p",[s._v("Ruby creates singleton classes on demand. Accessing them or adding methods to them forces Ruby to create them.")]),s._v(" "),t("h2",{attrs:{id:"accessing-singleton-class"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#accessing-singleton-class"}},[s._v("#")]),s._v(" Accessing Singleton Class")]),s._v(" "),t("p",[s._v("There are two ways to get singleton class of an object")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("singleton_class")]),s._v(" method.")]),s._v(" "),t("li",[s._v("Reopening singleton class of an object and returning "),t("code",[s._v("self")]),s._v(".")])]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[s._v("object"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("singleton_class\n\n")])])]),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[s._v("singleton_class "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" object\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("self")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n")])])]),t("h2",{attrs:{id:"accessing-instance-class-variables-in-singleton-classes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#accessing-instance-class-variables-in-singleton-classes"}},[s._v("#")]),s._v(" Accessing Instance/Class Variables in Singleton Classes")]),s._v(" "),t("p",[s._v("Singleton classes share their instance/class variables with their object.")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@@foo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")])]),s._v("\n  class_variable_get "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@@foo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :example")]),s._v("\n\n")])])]),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@foo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@foo")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\ne "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v("\n\ne"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("instance_eval "),t("span",{pre:!0,attrs:{class:"token string heredoc-string"}},[t("span",{pre:!0,attrs:{class:"token delimiter symbol"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<<-")]),s._v("BLOCK")]),s._v("\n  def self.increase_foo\n    @foo += 1\n  end\n"),t("span",{pre:!0,attrs:{class:"token delimiter symbol"}},[s._v("BLOCK")])]),s._v("\n\ne"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("increase_foo\ne"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> 2")]),s._v("\n\n")])])]),t("p",[s._v("Blocks close around their instance/class variables target. Accessing instance or class variables using a block in "),t("code",[s._v("class_eval")]),s._v(" or "),t("code",[s._v("instance_eval")]),s._v(" isn't possible. Passing a string to "),t("code",[s._v("class_eval")]),s._v(" or using "),t("code",[s._v("class_variable_get")]),s._v(" works around the problem.")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Foo")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@@foo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":foo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@@foo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":example")]),s._v(" \n\n  "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Foo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("define_singleton_method "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":foo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@@foo")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Foo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :example")]),s._v("\n\n")])])]),t("h2",{attrs:{id:"message-propagation-with-singleton-class"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#message-propagation-with-singleton-class"}},[s._v("#")]),s._v(" Message Propagation with Singleton Class")]),s._v(" "),t("p",[s._v("Instances never contain a method they only carry data. However we can define a singleton class for any object including an instance of a class.")]),s._v(" "),t("p",[s._v("When a message is passed to an object (method is called) Ruby first checks if a singleton class is defined for that object and if it can reply to that message otherwise Ruby checks instance's class' ancestors chain and walks up on that.")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":example")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :example")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PrependedModule")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":prepend")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("prepend")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PrependedModule")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ancestors "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> [Prepended, Example, Object, Kernel, BasicObject]")]),s._v("\ne "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v("\ne"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :prepended")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[s._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":singleton")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\ne"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :singleton")]),s._v("\n\n")])])]),t("h2",{attrs:{id:"reopening-monkey-patching-singleton-classes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#reopening-monkey-patching-singleton-classes"}},[s._v("#")]),s._v(" Reopening (monkey patching) Singleton Classes")]),s._v(" "),t("p",[s._v("There are three ways to reopen a Singleton Class")]),s._v(" "),t("ul",[t("li",[s._v("Using "),t("code",[s._v("class_eval")]),s._v(" on a singleton class.")]),s._v(" "),t("li",[s._v("Using "),t("code",[s._v("class <<")]),s._v(" block.")]),s._v(" "),t("li",[s._v("Using "),t("code",[s._v("def")]),s._v(" to define a method on the object's singleton class directly")])]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("singleton_class"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("class_eval "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":foo")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :foo")]),s._v("\n\n")])])]),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bar")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":bar")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bar "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :bar")]),s._v("\n\n")])])]),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("baz")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":baz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("baz "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :baz")]),s._v("\n\n")])])]),t("p",[s._v("Every object has a singleton class which you can access")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\nex1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token method-definition"}},[s._v("ex1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foobar")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":foobar")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\nex1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foobar "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> :foobar")]),s._v("\n\nex2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Example")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v("\nex2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("foobar "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=> NoMethodError")]),s._v("\n\n")])])]),t("h4",{attrs:{id:"syntax"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#syntax"}},[s._v("#")]),s._v(" Syntax")]),s._v(" "),t("ul",[t("li",[s._v("singleton_class = class << object; self end")])]),s._v(" "),t("h4",{attrs:{id:"remarks"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[s._v("#")]),s._v(" Remarks")]),s._v(" "),t("p",[s._v("Singleton classes only have one instance: their corresponding object. This can be verified by querying Ruby's "),t("a",{attrs:{href:"http://ruby-doc.org/core/ObjectSpace.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("ObjectSpace")]),t("OutboundLink")],1),s._v(":")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[s._v("instances "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ObjectSpace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("each_object object"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("singleton_class\n\ninstances"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("count            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# => 1")]),s._v("\ninstances"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" object  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# => true")]),s._v("\n\n")])])]),t("p",[s._v("Using "),t("a",{attrs:{href:"http://ruby-doc.org/core/Module.html#method-i-3C",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("<")]),t("OutboundLink")],1),s._v(", they can also be verified to be subclasses of the object's actual class:")]),s._v(" "),t("div",{staticClass:"language-ruby extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[s._v("object"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("singleton_class "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" object"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# => true")]),s._v("\n\n")])])]),t("p",[s._v("References:")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"http://yugui.jp/articles/846",target:"_blank",rel:"noopener noreferrer"}},[s._v("Three implicit contexts in Ruby"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);