(window.webpackJsonp=window.webpackJsonp||[]).push([[3548],{3956:function(t,s,a){"use strict";a.r(s);var n=a(31),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"publishing-your-xamarin-android-apk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#publishing-your-xamarin-android-apk"}},[t._v("#")]),t._v(" Publishing your Xamarin.Android APK")]),t._v(" "),a("p",[t._v("This topic shows information on how to prepare your Xamarin.Android app for release mode and how to optimize it.")]),t._v(" "),a("h2",{attrs:{id:"preparing-your-apk-in-the-visual-studio"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#preparing-your-apk-in-the-visual-studio"}},[t._v("#")]),t._v(" Preparing your APK in the Visual Studio")]),t._v(" "),a("p",[t._v("You finished your app, tested on debug mode and it is working perfect. Now, you want to prepare it to publish in the Google Play Store.")]),t._v(" "),a("p",[t._v("Xamarin documentation provides good informations in here:")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://developer.xamarin.com/guides/android/deployment,_testing,_and_metrics/publishing_an_application/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developer.xamarin.com/guides/android/deployment,_testing,_and_metrics/publishing_an_application/"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("strong",[t._v("Android Manifest")])]),t._v(" "),a("p",[t._v("First, in Visual Studio, right-click your Xamarin.Android project in the Solution Explorer and select Properties. Then, go to the Android Manifest tab, to see this screen:")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/qZ3l5.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/qZ3l5.png",alt:"Android Manifest Configuration"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Unlike in Android Studio or Eclipse, you don't need the set the AndroidManifest.xml file by writing; Xamarin and Visual Studio do that for you. Activities, BroadcastReceivers and Services are inserted into Android Manifest by "),a("a",{attrs:{href:"https://developer.xamarin.com/guides/android/advanced_topics/working_with_androidmanifest.xml/",target:"_blank",rel:"noopener noreferrer"}},[t._v("declaring specific attributes in their classes"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[t._v("In this screen, the options are:")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Application name")]),t._v(": This is the app name that will be visible for the user.")]),t._v(" "),a("li",[a("strong",[t._v("Package name")]),t._v(": This is the package name. It must be unique, meaning that it must not use the same package name of other apps in the Google Play Store.")]),t._v(" "),a("li",[a("strong",[t._v("Application Icon")]),t._v(": This is the icon that will be visible to the user, equivalent to the @drawable/ic_launcher used in Android Studio or Eclipse projects.")]),t._v(" "),a("li",[a("strong",[t._v("Version number")]),t._v(": The version number is used by Google Play for version control. When you want to publish an APK for an updated version of your app, you must add 1 to this number for each new upgrade.")]),t._v(" "),a("li",[a("strong",[t._v("Version name")]),t._v(": This is the version name that will be displayed to the user.")]),t._v(" "),a("li",[a("strong",[t._v("Install location")]),t._v(": This determines where your APK will be installed, in the device storage or SD Card.")]),t._v(" "),a("li",[a("strong",[t._v("Required permissions")]),t._v(": Here you determine which permissions are necessary for your app.")])]),t._v(" "),a("p",[a("strong",[t._v("Android Options")])]),t._v(" "),a("p",[t._v("In the screen below, you can configure the compiler options. Using the right options here can reduce a lot your APK size and also prevent errors.")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/kSakk.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/kSakk.png",alt:"Android Options Configuration"}}),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Configuration")]),t._v(": "),a("strong",[t._v("Active (Release)")]),t._v(".")]),t._v(" "),a("li",[a("strong",[t._v("Platform")]),t._v(": "),a("strong",[t._v("Active (Any CPU)")]),t._v(". These are necessary to build your APK for the Google Play Store. If the Configuration is set to Debug, it will not be accepted by Google Play.")]),t._v(" "),a("li",[a("strong",[t._v("Use Shared Runtime")]),t._v(": "),a("strong",[t._v("false")]),t._v(". If you set it to true, the APK will use Mono Runtime to execute. The Mono Runtime is installed automatically when debugging through USB, but not in the Release APK. If Mono Runtime is not installed in the device and this option is set to true in the Release APK, the app will crash.")]),t._v(" "),a("li",[a("strong",[t._v("Generate one package (.apk) per selected ABI")]),t._v(": "),a("strong",[t._v("false")]),t._v(". Create your APK for as many platforms as possible, for compatibility reasons.")]),t._v(" "),a("li",[a("strong",[t._v("Enable Multi-Dex")]),t._v(": "),a("strong",[t._v("true")]),t._v(", but you can set it to false if your app is not very complex (that is, has less than 65536 methods, "),a("a",{attrs:{href:"https://developer.android.com/studio/build/multidex.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("see here"),a("OutboundLink")],1),t._v(").")]),t._v(" "),a("li",[a("strong",[t._v("Enable Proguard")]),t._v(": "),a("strong",[t._v("true")]),t._v(". This enables the Proguard tool that obfuscates Java code in your app. Note that it does not apply to .NET code; if you want to obfuscate .NET code, you must use "),a("a",{attrs:{href:"https://developer.xamarin.com/guides/android/deployment,_testing,_and_metrics/publishing_an_application/part_1_-_preparing_an_application_for_release#dotfuscator",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dotfuscator"),a("OutboundLink")],1),t._v(". More information on Proguard for Xamarin.Android can be found "),a("a",{attrs:{href:"https://developer.xamarin.com/guides/android/deployment,_testing,_and_metrics/proguard",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("li",[a("strong",[t._v("Enable developer instrumentation (debugging and profiling)")]),t._v(": "),a("strong",[t._v("false")]),t._v(" for Release APK.")]),t._v(" "),a("li",[a("strong",[t._v("Linking")]),t._v(": "),a("strong",[t._v("SDK and User Assemblies")]),t._v(". This will make the Xamarin Linker to remove all unused classes from SDK and your code, reducing the APK size.")])]),t._v(" "),a("h3",{attrs:{id:"important"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#important"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Important")])]),t._v(" "),a("p",[t._v('Xamarin.Linker may sometimes remove classes that are not seemed to be used by your code, especially if they are in the project\'s Core (PCL library). To avoid that, you can either set the Linking to "Sdk Assemblies Only" or use the Preserve attribute in your classes, example:')]),t._v(" "),a("p",[a("strong",[t._v("PreserveAttribute.cs")])]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("My_App_Core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Models")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sealed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PreserveAttribute")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token type-list"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Attribute")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")])]),t._v(" AllMembers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")])]),t._v(" Conditional"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("In a class:")])]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("My_App_Core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Models")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token attribute"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Preserve")]),a("span",{pre:!0,attrs:{class:"token attribute-arguments"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AllMembers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceException")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token type-list"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")])]),t._v(" errorCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token attribute"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Preserve")]),a("span",{pre:!0,attrs:{class:"token attribute-arguments"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AllMembers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ServiceException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token attribute"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Preserve")]),a("span",{pre:!0,attrs:{class:"token attribute-arguments"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AllMembers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ServiceException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")])]),t._v(" errorCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("errorCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" errorCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("ul",[a("li",[a("strong",[t._v("Supported architectures")]),t._v(": "),a("strong",[t._v("Select all")]),t._v(", for compatibility reasons.")])]),t._v(" "),a("p",[t._v("After configuring everything, Rebuild the Project to make sure that it builds successfully.")]),t._v(" "),a("p",[a("strong",[t._v("Creating the APK for Release mode")])]),t._v(" "),a("p",[t._v("You finished configuring your Android project for Release. The tutorial below shows how to generate the APK in Visual Studio. A full tutorial from Xamarin documentation can be found here:")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://developer.xamarin.com/guides/android/deployment,_testing,_and_metrics/publishing_an_application/part_2_-_signing_the_android_application_package/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developer.xamarin.com/guides/android/deployment,_testing,"),a("em",[t._v("and_metrics/publishing_an_application/part_2")]),t._v("-_signing_the_android_application_package/"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("To create the APK file, right-click the Xamarin.Android project in the Solution Explorer and select Archive...")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/WrEum.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/WrEum.png",alt:"Solution Explorer -> right-click Xamarin.Android project -> Archive..."}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("This will open the Archive manager and begin archiving the project, preparing to create the APK file.")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/kkEe7.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/kkEe7.png",alt:"Archiving project"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("When it finishes archiving the project, click in Distribute... to proceed.")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/3dR8R.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/3dR8R.png",alt:"Distribute..."}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("The Distribute screen will present you two options: Ad-hoc and Google Play. The first will create an APK and save it in your computer. The second will directly publish the app in Google Play.")]),t._v(" "),a("p",[t._v("Choosing the first is recommended, so you can test the APK in other devices if you want.")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/iqcJH.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/iqcJH.png",alt:"Distribution Channels"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("In the following screen, an Android Key Store is needed to sign the APK. If you already have one, you can use it by clicking in Import...; if you don't, you can create a new Android Key Store by clicking in +.")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/cvJ0E.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/cvJ0E.png",alt:"Signing Identity"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Creating a new Android Key Store screen:")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/hn5Xl.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/hn5Xl.png",alt:"Creating new Android Key Store"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("To create the APK, click in Save As. You may be prompted to type the Key Store password.")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/lYrDo.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/lYrDo.png",alt:"Save As"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/yRlXJ.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/yRlXJ.png",alt:"Save As -> Locate folder"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/qpXgu.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/qpXgu.png",alt:"Enter Key Store password"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("When it completes, you can click in Open Folder on the Archives screen to see your generated APK file.")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/r26gV.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/r26gV.png",alt:"Open Folder"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/SmEmU.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/SmEmU.png",alt:"APK in folder"}}),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"enabling-multidex-in-your-xamarin-android-apk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#enabling-multidex-in-your-xamarin-android-apk"}},[t._v("#")]),t._v(" Enabling MultiDex in your Xamarin.Android APK")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://developer.android.com/studio/build/multidex.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MultiDex"),a("OutboundLink")],1),t._v(" is a library in the Android APK that allows the app to have more than 65,536 methods.")]),t._v(" "),a("p",[t._v("The Android APKs have Dalvik Executable files (.dex) that contain the generated bytecodes compiled from your Java code. Each .dex file can contain up to 65,536 methods (2^16).")]),t._v(" "),a("p",[t._v("Android OS versions before Android 5.0 Lollipop (API 21) use the Dalvik runtime, which only supports one .dex file per APK, limiting to 65,536 methods per APK. Starting from Android 5.0, the Android OS use ART runtime, which can support more than one .dex file per APK, avoiding the limit.")]),t._v(" "),a("p",[t._v("To surpass the 65k methods limit in Android versions below API 21, the developers must use the MultiDex support library. The MultiDex creates extra classes.dex files (classes2.dex, classes3.dex, ...) referencing them in the classes.dex file. When the app starts loading, it uses an MultiDexApplication class to load the extra .dex files.")]),t._v(" "),a("p",[t._v("If your Android app aims for a minimum SDK version above or equal to API 21 (Android 5.0 Lollipop) it is not necessary to use the MultiDex library, because the OS handles natively the extra .dex files. However, if for compatibility reasons the developer wants to support older Android OS, then he/she should use the MultiDex library.")]),t._v(" "),a("h3",{attrs:{id:"how-to-use-multidex-in-your-xamarin-android-app"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use-multidex-in-your-xamarin-android-app"}},[t._v("#")]),t._v(" "),a("strong",[t._v("How to use MultiDex in your Xamarin.Android app")])]),t._v(" "),a("p",[t._v("First, to enable MultiDex in your Xamarin.Android app, go to your project Properties -> Android Options -> Packaging -> Enable Multi-Dex, as in the print screen below:")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/QqaV3.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/QqaV3.png",alt:"Enable MultiDex option"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Then, you must create a MultiDexApplication class in your app. In the project's root, create a new class (in the Solution Explorer, right-click in the project, Add.. -> Class, or Shift+Alt+C). In the new class file, copy the following code, replacing the namespace Sample with the name of your Xamarin.Android project namespace.")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("Android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("App")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("Android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Runtime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("Java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Interop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("Sample")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token attribute"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Register")]),a("span",{pre:!0,attrs:{class:"token attribute-arguments"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"android/support/multidex/MultiDexApplication"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" DoNotGenerateAcw "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MultiDexApplication")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token type-list"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Application")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JniPeerMembers")]),t._v(" _members "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("XAPeerMembers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"android/support/multidex/MultiDexApplication"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token type-expression class-name"}},[t._v("MultiDexApplication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntPtr")]),t._v(" java_class_handle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntPtr")]),t._v(" id_ctor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token attribute"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Register")]),a("span",{pre:!0,attrs:{class:"token attribute-arguments"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".ctor"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()V"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" DoNotGenerateAcw "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MultiDexApplication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("base")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IntPtr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Zero"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" JniHandleOwnership"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DoNotTransfer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Handle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" IntPtr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Zero"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token type-expression class-name"}},[t._v("MultiDexApplication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("SetHandle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                        JNIEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("StartCreateInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()V"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                        JniHandleOwnership"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TransferLocalRef"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        JNIEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("FinishCreateInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Handle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()V"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id_ctor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" IntPtr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Zero"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    id_ctor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" JNIEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetMethodID")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("class_ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<init>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()V"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("SetHandle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                    JNIEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("StartCreateInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("class_ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" id_ctor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    JniHandleOwnership"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TransferLocalRef"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                JNIEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("FinishCreateInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Handle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" class_ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" id_ctor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MultiDexApplication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntPtr")]),t._v(" javaReference"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JniHandleOwnership")]),t._v(" transfer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("base")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("javaReference"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" transfer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("IntPtr")]),t._v(" class_ref\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" JNIEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("FindClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"android/support/multidex/MultiDexApplication"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ref")]),t._v(" java_class_handle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("IntPtr")]),t._v(" ThresholdClass\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" class_ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Type")]),t._v(" ThresholdType\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token type-expression class-name"}},[t._v("MultiDexApplication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[a("a",{attrs:{href:"https://forums.xamarin.com/discussion/64234/multi-dex-app-with-a-custom-application-class-that-runs-on-pre-lollipop",target:"_blank",rel:"noopener noreferrer"}},[t._v("Code source here."),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("If you are developing in Visual Studio for Windows, there is also a bug in the Android SDK build tools that you need to fix in order to properly create the classes.dex files when building your project.")]),t._v(" "),a("p",[t._v("Go to your Android SDK folder, open the build-tools folder and there will be folders with the numbers of the Android SDK compilers, such as:")]),t._v(" "),a("blockquote"),t._v(" "),a("p",[t._v("C:\\android-sdk\\build-tools\\23.0.3\\")]),t._v(" "),a("blockquote"),t._v(" "),a("p",[t._v("C:\\android-sdk\\build-tools\\24.0.1\\")]),t._v(" "),a("blockquote"),t._v(" "),a("p",[t._v("C:\\android-sdk\\build-tools\\25.0.2\\")]),t._v(" "),a("p",[t._v("Inside each of those folders, there is a file called "),a("strong",[t._v("mainClassesDex.bat")]),t._v(", a batch script used to create the classes.dex files. Open each mainClassesDex.bat file with a text editor (Notepad or Notepad++) and in its script, find and replace the block:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" DEFINED output "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("goto")]),t._v(" redirect\ncall "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%java_exe%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Djava"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%frameworkdir%"')]),t._v(" com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("multidex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MainDexListBuilder "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%disableKeepAnnotated%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%tmpJar%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%params%"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("goto")]),t._v(" afterClassReferenceListBuilder\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("redirect\ncall "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%java_exe%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Djava"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%frameworkdir%"')]),t._v(" com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("multidex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MainDexListBuilder "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%disableKeepAnnotated%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%tmpJar%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%params%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%output%"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("afterClassReferenceListBuilder\n\n")])])]),a("p",[t._v("With the block:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[t._v("SET "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("params")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("params")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("'"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" DEFINED output "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("goto")]),t._v(" redirect  \ncall "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%java_exe%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Djava"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%frameworkdir%"')]),t._v(" com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("multidex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MainDexListBuilder "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("disableKeepAnnotated"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%tmpJar%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("params")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("goto")]),t._v(" afterClassReferenceListBuilder  \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("redirect\ncall "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%java_exe%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Djava"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%frameworkdir%"')]),t._v(" com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("multidex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MainDexListBuilder "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("disableKeepAnnotated"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%tmpJar%"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("params")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%output%"')]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("afterClassReferenceListBuilder\n\n")])])]),a("p",[a("a",{attrs:{href:"http://www.jon-douglas.com/2016/09/05/xamarin-android-multidex/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Source here."),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Save each mainClassesDex.bat in the text editor after changes.")]),t._v(" "),a("p",[t._v("After the steps above, you should be able to successfully build your Xamarin.Android app with MultiDex.")]),t._v(" "),a("h2",{attrs:{id:"enabling-proguard-in-your-xamarin-android-apk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#enabling-proguard-in-your-xamarin-android-apk"}},[t._v("#")]),t._v(" Enabling ProGuard in your Xamarin.Android APK")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://developer.android.com/studio/build/shrink-code.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ProGuard"),a("OutboundLink")],1),t._v(" is a tool used in the building process to optimize and obfuscate the Java code of your APK, and also remove unused classes. The resulting APK when using ProGuard will have a smaller size and will be harder to reverse-engineer (decompilation).")]),t._v(" "),a("p",[t._v("ProGuard can be used too in Xamarin.Android apps, and also will reduce the APK file size and obfuscate the Java code. Be aware, however, that the ProGuard obfuscation applies only to Java code. To obfuscate .NET code, the developer should use Dotfuscator or similar tools.")]),t._v(" "),a("h3",{attrs:{id:"how-to-use-proguard-in-your-xamarin-android-app"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use-proguard-in-your-xamarin-android-app"}},[t._v("#")]),t._v(" "),a("strong",[t._v("How to use ProGuard in your Xamarin.Android app")])]),t._v(" "),a("p",[t._v("First, to enable ProGuard in your Xamarin.Android app, go to your project Properties -> Android Options -> Packaging -> Enable ProGuard, as in the print screen below:")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/QqaV3.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/QqaV3.png",alt:"Enable ProGuard"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("This enables ProGuard when building your app.")]),t._v(" "),a("p",[t._v("Xamarin.Android, by default, sets its own configurations for ProGuard, that can be found inside the folders "),a("code",[t._v("obj/Debug/proguard")]),t._v(" or "),a("code",[t._v("obj/Release/proguard")]),t._v(", in the files "),a("code",[t._v("proguard_project_primary.cfg")]),t._v(", "),a("code",[t._v("proguard_project_references.cfg")]),t._v(" and "),a("code",[t._v("proguard_xamarin.cfg")]),t._v(". The three files are combined as configurations for ProGuard and they are automatically created by Xamarin when building.")]),t._v(" "),a("p",[t._v("If the developer wishes to further customize the ProGuard options, he/she can create a file in the project's root named "),a("code",[t._v("proguard.cfg")]),t._v(" (other names are valid too, as long as the extension is .cfg) and setting its Build Action to ProguardConfiguration, as in the picture below:")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/axEq3.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/axEq3.png",alt:"Setting Build Action to ProguardConfiguration"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("In the file, custom ProGuard options can be inserted, such as "),a("code",[t._v("-dontwarn")]),t._v(", "),a("code",[t._v("-keep class")]),t._v(" and "),a("a",{attrs:{href:"https://www.guardsquare.com/en/proguard/manual/usage",target:"_blank",rel:"noopener noreferrer"}},[t._v("others"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[a("strong",[t._v("Important")])]),t._v(" "),a("p",[t._v("As by now (April/2017), the Android SDK that is usually downloaded has an old version of ProGuard, which can cause errors when building the app using Java 1.8. When building, the Error List shows the following message:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[t._v("Error\nCan't read "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("C"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\"),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Program")]),t._v(" Files "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x86"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\\Reference Assemblies\\Microsoft\\Framework\\MonoAndroid\\v7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\mono"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Can't process "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("android"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ActivityTracker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unsupported "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("version")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("52.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("maximum "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("51.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Java "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("CREATEMULTIDEXMAINDEXCLASSLIST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n")])])]),a("p",[a("a",{attrs:{href:"https://forums.xamarin.com/discussion/76798/compiler-issue-with-targetsdkversion-24-and-jdk-1-8",target:"_blank",rel:"noopener noreferrer"}},[t._v("Source here."),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("To fix this problem, you must download the most recent version of ProGuard ("),a("a",{attrs:{href:"https://sourceforge.net/projects/proguard/files/proguard/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(") and copy the contents of the .zip file to "),a("code",[t._v("android-sdk\\tools\\proguard\\")]),t._v(". That will update the ProGuard and building process should run without problems.")]),t._v(" "),a("p",[t._v("After that, you should be able to successfully build your Xamarin.Android app with ProGuard.")]),t._v(" "),a("h2",{attrs:{id:"mysterious-bugs-related-to-proguard-and-linker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysterious-bugs-related-to-proguard-and-linker"}},[t._v("#")]),t._v(' "Mysterious" bugs related to ProGuard and Linker')]),t._v(" "),a("p",[t._v("You made a great app and tested it in Debug, with good results. Everything was working fine!")]),t._v(" "),a("p",[t._v("But then, you decided to prepare your app for release. You set up MultiDex, ProGuard and Linker, and then, it stopped working.")]),t._v(" "),a("p",[t._v("This tutorial aims to help you to find out common problems related to ProGuard and Linker that can cause mysterious bugs.")]),t._v(" "),a("h3",{attrs:{id:"understanding-xamarin-linker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#understanding-xamarin-linker"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Understanding Xamarin.Linker")])]),t._v(" "),a("p",[t._v("Xamarin.Linker is a tool in the building process that removes unused code and classes "),a("strong",[t._v("from your .NET code (not Java code)")]),t._v(". In your project's Properties -> Android Options -> Linker, there will be an selection box Linking with the options:")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/NMQMv.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/NMQMv.png",alt:"Linker options"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[a("strong",[t._v("None")]),t._v(": No code is removed.")]),t._v(" "),a("p",[a("strong",[t._v("Sdk Assemblies Only")]),t._v(": This option makes the Xamarin.Linker to check for unused code only in the Xamarin libraries. "),a("strong",[t._v("This option is safe.")])]),t._v(" "),a("p",[a("strong",[t._v("Sdk and User Assemblies")]),t._v(": This option makes the Xamarin.Linker to check for unused code in the Xamarin libraries and in the project code (including PCLs, Xamarin components and NuGet packages). "),a("strong",[t._v("This option is not always safe!")])]),t._v(" "),a("p",[t._v("When using Sdk and User Assemblies option, Xamarin.Linker may think that parts of the code are unused when actually they are very much used! That may cause some libraries to stop working properly and cause bugs in your app.")]),t._v(" "),a("p",[t._v("To make the Xamarin.Linker not remove code, there are 3 options:")]),t._v(" "),a("ol",[a("li",[t._v("Setting the Linking option to None or Sdk Assemblies Only;")]),t._v(" "),a("li",[t._v("Skip linking assemblies;")]),t._v(" "),a("li",[t._v("Using the Preserve attribute.")])]),t._v(" "),a("p",[a("strong",[t._v("Example for 2. Skip linking assemblies:")])]),t._v(" "),a("p",[t._v("In the example below, using Xamarin.Linker caused a NuGet Package ("),a("a",{attrs:{href:"https://github.com/octokit",target:"_blank",rel:"noopener noreferrer"}},[t._v("Octokit"),a("OutboundLink")],1),t._v(") that works fine to stop working, because it could not connect to the internet anymore:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ERROR\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" SOURCE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mscorlib\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" MESSAGE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Object reference "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" to an instance of an "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("STACK")]),t._v(" TRACE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("at")]),t._v(" Octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PocoJsonSerializerStrategy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DeserializeObject "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Type")]),t._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x003d8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\repos\\octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net\\Octokit\\SimpleJson"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1472")]),t._v(" \n  at Octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Internal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SimpleJsonSerializer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("GitHubSerializerStrategy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DeserializeObject "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Type")]),t._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x001c3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\repos\\octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net\\Octokit\\Http\\SimpleJsonSerializer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("165")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("at")]),t._v(" Octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SimpleJson"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DeserializeObject "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("String")]),t._v(" json"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Type")]),t._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IJsonSerializerStrategy")]),t._v(" jsonSerializerStrategy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x00007")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\repos\\octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net\\Octokit\\SimpleJson"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("583")]),t._v(" \n  at Octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SimpleJson"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DeserializeObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("T"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("String")]),t._v(" json"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IJsonSerializerStrategy")]),t._v(" jsonSerializerStrategy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\repos\\octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net\\Octokit\\SimpleJson"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("595")]),t._v(" \n  at Octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Internal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SimpleJsonSerializer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Deserialize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("T"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("String")]),t._v(" json"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\repos\\octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net\\Octokit\\Http\\SimpleJsonSerializer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" \n  at Octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Internal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("JsonHttpPipeline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DeserializeResponse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("T"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IResponse")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x000a7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\repos\\octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net\\Octokit\\Http\\JsonHttpPipeline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("62")]),t._v(" \n  at Octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Connection"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Run"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("d__54`"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("T"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MoveNext "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x0009c")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\repos\\octokit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net\\Octokit\\Http\\Connection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("574")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" End of stack trace "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" previous location "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("exception")]),t._v(" was thrown "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\n\n")])])]),a("p",[t._v("To make the library start working again, it was necessary to add the package reference name in the Skip linking assemblies field, located in project -> Properties -> Android Options -> Linker, as in the picture below:")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/sZ9ho.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/sZ9ho.png",alt:"Adding project reference to skip linking assemblies"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("After that, the library started to work without any issues.")]),t._v(" "),a("p",[a("strong",[t._v("Example for 3. Using the Preserve attribute:")])]),t._v(" "),a("p",[t._v("Xamarin.Linker perceives as unused code mostly code from model classes in your project's core.")]),t._v(" "),a("p",[t._v("To make the class preserved during the linking process, you can use the Preserve attribute.")]),t._v(" "),a("p",[t._v("First, create in your project core's a class named "),a("strong",[t._v("PreserveAttribute.cs")]),t._v(", insert the following code and replace the namespace with your project's namespace:")]),t._v(" "),a("p",[t._v("PreserveAttribute.cs:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("My_App_Core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Models")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sealed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PreserveAttribute")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token type-list"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Attribute")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")])]),t._v(" AllMembers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")])]),t._v(" Conditional"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("In each model class of your project's core, insert the Preserve attribute as in the example below:")]),t._v(" "),a("p",[t._v("Country.cs:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Collections"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Generic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("My_App_Core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Models")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token attribute"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Preserve")]),a("span",{pre:!0,attrs:{class:"token attribute-arguments"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AllMembers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Country")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("String")]),t._v(" name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("String")]),t._v(" ISOcode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token attribute"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Preserve")]),a("span",{pre:!0,attrs:{class:"token attribute-arguments"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AllMembers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Country")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ISOCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ISOCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ISOCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("After that, the linking process will not remove the preserved code anymore.")]),t._v(" "),a("h3",{attrs:{id:"understanding-proguard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#understanding-proguard"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Understanding ProGuard")])]),t._v(" "),a("p",[t._v("ProGuard is a tool in the building process that removes unused code and classes "),a("strong",[t._v("from your Java code")]),t._v(". It also obfuscates and optimizes the code.")]),t._v(" "),a("p",[t._v("However, ProGuard sometimes may remove code that it perceives as unused, when it is not. To avoid that, the developer must debug the app (in Android Device Monitor and in the Visual Studio Debug) and detect which class was removed, for then to configure the ProGuard configuration file to keep the class.")]),t._v(" "),a("p",[a("strong",[t._v("Example")])]),t._v(" "),a("p",[t._v("In the example below, ProGuard removed two classes (Android.Support.V7.Widget.FitWindowsLinearLayout and Android.Support.Design.Widget.AppBarLayout) used in AXML layout files, but that were perceived as unused in the code. The removal caused ClassNotFoundException in the Java code when rendering the activity layout:")]),t._v(" "),a("p",[t._v("layout_activitymain.axml:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("xml")]),t._v(" version"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),t._v(" encoding"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"utf-8"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("v4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("widget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DrawerLayout")]),t._v(" \n    xmlns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("android"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://schemas.android.com/apk/res/android"')]),t._v("\n    xmlns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://schemas.android.com/apk/res-auto"')]),t._v("\n    xmlns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("tools"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://schemas.android.com/tools"')]),t._v("\n    android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@+id/activitymain_drawerlayout"')]),t._v("\n    android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("layout_width"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"match_parent"')]),t._v("\n    android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("layout_height"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"match_parent"')]),t._v("\n    android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("fitsSystemWindows"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v(" ### HERE ### "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    tools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("openDrawer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"start"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RelativeLayout")]),t._v("\n        android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("layout_width"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"match_parent"')]),t._v("\n        android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("layout_height"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"match_parent"')]),t._v("\n        android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("fitsSystemWindows"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v(" ### HERE ## "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("design"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("widget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AppBarLayout")]),t._v("\n            android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@+id/activitymain_appbarlayout"')]),t._v("\n            android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("layout_width"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"match_parent"')]),t._v("\n            android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("layout_height"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wrap_content"')]),t._v("\n            android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("theme"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@style/AppTheme.AppBarOverlay"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token range operator"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n")])])]),a("p",[t._v("LogCat showing error when creating the layout in SetContentView:")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/OPgYu.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/OPgYu.png",alt:"Error showing in LogCat"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("To fix this error, it was necessary to add the following lines to the ProGuard configuration file of the project:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("keep "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("android")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("v7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("widget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FitWindowsLinearLayout\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("keep "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("android")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("design"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("widget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AppBarLayout\n\n")])])]),a("p",[t._v("After that, no more errors were shown when creating the layout.")]),t._v(" "),a("p",[a("strong",[t._v("ProGuard Warnings")])]),t._v(" "),a("p",[t._v("ProGuard sometimes show warnings in the Error List after building your project. Although they raise a question of whether your app is OK or not, not all of their warnings indicate troubles, especially if your app successfully builds.")]),t._v(" "),a("p",[t._v("One example for that is when using the "),a("a",{attrs:{href:"http://square.github.io/picasso/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Picasso"),a("OutboundLink")],1),t._v(" library: when using ProGuard, this may show warnings such as "),a("code",[t._v("okio.Okio: can't find referenced class (...)")]),t._v(" or "),a("code",[t._v("can't write resource [META-INF/MANIFEST.MF] (Duplicate zip entry [okhttp.jar:META-INF/MANIFEST.MF]) (...)")]),t._v(", but the app builds and the library works without problems.")])])}),[],!1,null,null,null);s.default=e.exports}}]);