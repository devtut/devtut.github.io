(window.webpackJsonp=window.webpackJsonp||[]).push([[3446],{3853:function(t,e,s){"use strict";s.r(e);var r=s(31),a=Object(r.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"vba-run-time-errors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vba-run-time-errors"}},[t._v("#")]),t._v(" VBA Run-Time Errors")]),t._v(" "),s("p",[t._v("Code that compiles can still run into errors, at run-time. This topic lists the most common ones, their causes, and how to avoid them.")]),t._v(" "),s("h2",{attrs:{id:"run-time-error-6-overflow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-time-error-6-overflow"}},[t._v("#")]),t._v(" Run-time error '6': Overflow")]),t._v(" "),s("h3",{attrs:{id:"incorrect-code"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#incorrect-code"}},[t._v("#")]),t._v(" Incorrect code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" row "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" row "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100000")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'do stuff")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-doesn-t-this-work"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-doesn-t-this-work"}},[t._v("#")]),t._v(" Why doesn't this work?")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("Integer")]),t._v(" data type is a 16-bit signed integer with a maximum value of 32,767; assigning it to anything larger than that will "),s("strong",[t._v("overflow")]),t._v(" the type and raise this error.")]),t._v(" "),s("h3",{attrs:{id:"correct-code"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#correct-code"}},[t._v("#")]),t._v(" Correct code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" row "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" row "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100000")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'do stuff")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-does-this-work"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-does-this-work"}},[t._v("#")]),t._v(" Why does this work?")]),t._v(" "),s("p",[t._v("By using a "),s("code",[t._v("Long")]),t._v(" (32-bit) integer instead, we can now make a loop that iterates more than 32,767 times without overflowing the counter variable's type.")]),t._v(" "),s("h3",{attrs:{id:"other-notes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#other-notes"}},[t._v("#")]),t._v(" Other notes")]),t._v(" "),s("p",[t._v("See "),s("a",{attrs:{href:"http://stackoverflow.com/documentation/vba/3418/data-types-and-limits#t=201701262133242282415",target:"_blank",rel:"noopener noreferrer"}},[t._v("Data Types and Limits"),s("OutboundLink")],1),t._v(" for more information.")]),t._v(" "),s("h2",{attrs:{id:"run-time-error-9-subscript-out-of-range"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-time-error-9-subscript-out-of-range"}},[t._v("#")]),t._v(" Run-time error '9': Subscript out of range")]),t._v(" "),s("h3",{attrs:{id:"incorrect-code-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#incorrect-code-2"}},[t._v("#")]),t._v(" Incorrect code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n        foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-doesn-t-this-work-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-doesn-t-this-work-2"}},[t._v("#")]),t._v(" Why doesn't this work?")]),t._v(" "),s("p",[s("code",[t._v("foo")]),t._v(" is an array that contains 10 items. When the "),s("code",[t._v("i")]),t._v(" loop counter reaches a value of 11, "),s("code",[t._v("foo(i)")]),t._v(" is "),s("strong",[t._v("out of range")]),t._v(". This error occurs whenever an array or collection is accessed with an index that doesn't exist in that array or collection.")]),t._v(" "),s("h3",{attrs:{id:"correct-code-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#correct-code-2"}},[t._v("#")]),t._v(" Correct code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LBound"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" UBound"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-does-this-work-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-does-this-work-2"}},[t._v("#")]),t._v(" Why does this work?")]),t._v(" "),s("p",[t._v("Use "),s("code",[t._v("LBound")]),t._v(" and "),s("code",[t._v("UBound")]),t._v(" functions to determine the lower and upper boundaries of an array, respectively.")]),t._v(" "),s("h3",{attrs:{id:"other-notes-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#other-notes-2"}},[t._v("#")]),t._v(" Other notes")]),t._v(" "),s("p",[t._v("When the index is a string, e.g. "),s("code",[t._v('ThisWorkbook.Worksheets("I don\'t exist")')]),t._v(", this error means the supplied name doesn't exist in the queried collection.")]),t._v(" "),s("p",[t._v("The actual error is implementation-specific though; "),s("code",[t._v("Collection")]),t._v(' will raise run-time error 5 "Invalid procedure call or argument" instead:')]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" RaisesRunTimeError5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" Collection\n    foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo"')]),t._v("\n    Debug"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"run-time-error-13-type-mismatch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-time-error-13-type-mismatch"}},[t._v("#")]),t._v(" Run-time error '13': Type mismatch")]),t._v(" "),s("h3",{attrs:{id:"incorrect-code-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#incorrect-code-3"}},[t._v("#")]),t._v(" Incorrect code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    DoSomethingElse "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"42?"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomethingElse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'    Debug.Print MonthName(Month(foo))")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-doesn-t-this-work-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-doesn-t-this-work-3"}},[t._v("#")]),t._v(" Why doesn't this work?")]),t._v(" "),s("p",[t._v("VBA is trying really hard to convert the "),s("code",[t._v('"42?"')]),t._v(" argument into a "),s("code",[t._v("Date")]),t._v(" value. When it fails, the call to "),s("code",[t._v("DoSomethingElse")]),t._v(" cannot be executed, because VBA doesn't know what date to pass, so it raises run-time error 13 "),s("strong",[t._v("type mismatch")]),t._v(", because the type of the argument doesn't match the expected type (and can't be implicitly converted either).")]),t._v(" "),s("h3",{attrs:{id:"correct-code-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#correct-code-3"}},[t._v("#")]),t._v(" Correct code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    DoSomethingElse Now\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomethingElse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'    Debug.Print MonthName(Month(foo))")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-does-this-work-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-does-this-work-3"}},[t._v("#")]),t._v(" Why does this work?")]),t._v(" "),s("p",[t._v("By passing a "),s("code",[t._v("Date")]),t._v(" argument to a procedure that expects a "),s("code",[t._v("Date")]),t._v(" parameter, the call can succeed.")]),t._v(" "),s("h2",{attrs:{id:"run-time-error-91-object-variable-or-with-block-variable-not-set"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-time-error-91-object-variable-or-with-block-variable-not-set"}},[t._v("#")]),t._v(" Run-time error '91': Object variable or With block variable not set")]),t._v(" "),s("h3",{attrs:{id:"incorrect-code-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#incorrect-code-4"}},[t._v("#")]),t._v(" Incorrect code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Collection\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" foo\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ABC"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"XYZ"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-doesn-t-this-work-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-doesn-t-this-work-4"}},[t._v("#")]),t._v(" Why doesn't this work?")]),t._v(" "),s("p",[t._v("Object variables hold a "),s("strong",[t._v("reference")]),t._v(", and references need to be "),s("strong",[t._v("set")]),t._v(" using the "),s("code",[t._v("Set")]),t._v(" keyword. This error occurs whenever a member call is made on an object whose reference is "),s("code",[t._v("Nothing")]),t._v(". In this case "),s("code",[t._v("foo")]),t._v(" is a "),s("code",[t._v("Collection")]),t._v(" reference, but it's not initialized, so the reference contains "),s("code",[t._v("Nothing")]),t._v(" - and we can't call "),s("code",[t._v(".Add")]),t._v(" on "),s("code",[t._v("Nothing")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"correct-code-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#correct-code-4"}},[t._v("#")]),t._v(" Correct code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Collection\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" foo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" Collection\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" foo\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ABC"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"XYZ"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-does-this-work-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-does-this-work-4"}},[t._v("#")]),t._v(" Why does this work?")]),t._v(" "),s("p",[t._v("By assigning the object variable a valid reference using the "),s("code",[t._v("Set")]),t._v(" keyword, the "),s("code",[t._v(".Add")]),t._v(" calls succeed.")]),t._v(" "),s("h3",{attrs:{id:"other-notes-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#other-notes-3"}},[t._v("#")]),t._v(" Other notes")]),t._v(" "),s("p",[t._v("Often, a function or property can return an object reference - a common example is Excel's "),s("code",[t._v("Range.Find")]),t._v(" method, which returns a "),s("code",[t._v("Range")]),t._v(" object:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" resultRow "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\nresultRow "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SomeSheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Find"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Something"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row\n\n")])])]),s("p",[t._v("However the function can very well return "),s("code",[t._v("Nothing")]),t._v(" (if the search term isn't found), so it's likely that the chained "),s("code",[t._v(".Row")]),t._v(" member call fails.")]),t._v(" "),s("p",[t._v("Before calling object members, verify that the reference is set with a "),s("code",[t._v("If Not xxxx Is Nothing")]),t._v(" condition:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SomeSheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Find"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Something"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" resultRow "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" resultRow "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row\n\n")])])]),s("h2",{attrs:{id:"run-time-error-20-resume-without-error"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-time-error-20-resume-without-error"}},[t._v("#")]),t._v(" Run-time error '20': Resume without error")]),t._v(" "),s("h3",{attrs:{id:"incorrect-code-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#incorrect-code-5"}},[t._v("#")]),t._v(" Incorrect code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" CleanFail\n    DoSomethingElse\n\nCleanFail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    Debug"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print Err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-doesn-t-this-work-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-doesn-t-this-work-5"}},[t._v("#")]),t._v(" Why doesn't this work?")]),t._v(" "),s("p",[t._v("If the "),s("code",[t._v("DoSomethingElse")]),t._v(" procedure raises an error, execution jumps to the "),s("code",[t._v("CleanFail")]),t._v(" line label, prints the error number, and the "),s("code",[t._v("Resume Next")]),t._v(" instruction jumps back to the instruction that immediately follows the line where the error occurred, which in this case is the "),s("code",[t._v("Debug.Print")]),t._v(" instruction: the error-handling subroutine is executing without an error context, and when the "),s("code",[t._v("Resume Next")]),t._v(" instruction is reached, run-time error 20 is raised because there is nowhere to resume to.")]),t._v(" "),s("h3",{attrs:{id:"correct-code-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#correct-code-5"}},[t._v("#")]),t._v(" Correct Code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" CleanFail\n    DoSomethingElse\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("    \nCleanFail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    Debug"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print Err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-does-this-work-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-does-this-work-5"}},[t._v("#")]),t._v(" Why does this work?")]),t._v(" "),s("p",[t._v("By introducing an "),s("code",[t._v("Exit Sub")]),t._v(" instruction before the "),s("code",[t._v("CleanFail")]),t._v(" line label, we have segregated the "),s("code",[t._v("CleanFail")]),t._v(" error-handling subroutine from the rest of the procedure body - the only way to execute the error-handling subroutine is via an "),s("code",[t._v("On Error")]),t._v(" jump; therefore, no execution path reaches the "),s("code",[t._v("Resume")]),t._v(" instruction outside of an error context, which avoids run-time error 20.")]),t._v(" "),s("h3",{attrs:{id:"other-notes-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#other-notes-4"}},[t._v("#")]),t._v(" Other notes")]),t._v(" "),s("p",[t._v("This is very similar to "),s("a",{attrs:{href:"http://stackoverflow.com/documentation/vba/8917/27746/run-time-error-3-return-without-gosub",target:"_blank",rel:"noopener noreferrer"}},[t._v("Run-time error '3': Return without GoSub"),s("OutboundLink")],1),t._v("; in both situations, the solution is to ensure that the "),s("strong",[t._v("normal execution path")]),t._v(" cannot enter a sub-routine (identified by a line label) without an explicit jump (assuming "),s("code",[t._v("On Error GoTo")]),t._v(" is considered an "),s("strong",[t._v("explicit jump")]),t._v(").")]),t._v(" "),s("h2",{attrs:{id:"run-time-error-3-return-without-gosub"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-time-error-3-return-without-gosub"}},[t._v("#")]),t._v(" Run-time error '3': Return without GoSub")]),t._v(" "),s("h3",{attrs:{id:"incorrect-code-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#incorrect-code-6"}},[t._v("#")]),t._v(" Incorrect Code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoSub")]),t._v(" DoThis\nDoThis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    Debug"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hi!"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Return")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-doesn-t-this-work-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-doesn-t-this-work-6"}},[t._v("#")]),t._v(" Why doesn't this work?")]),t._v(" "),s("p",[t._v("Execution enters the "),s("code",[t._v("DoSomething")]),t._v(" procedure, jumps to the "),s("code",[t._v("DoThis")]),t._v(' label, prints "Hi!" to the debug output, '),s("strong",[t._v("returns")]),t._v(" to the instruction immediately after the "),s("code",[t._v("GoSub")]),t._v(' call, prints "Hi!" again, and then encounters a '),s("code",[t._v("Return")]),t._v(" statement, but there's nowhere to "),s("strong",[t._v("return")]),t._v(" to now, because we didn't get here with a "),s("code",[t._v("GoSub")]),t._v(" statement.")]),t._v(" "),s("h3",{attrs:{id:"correct-code-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#correct-code-6"}},[t._v("#")]),t._v(" Correct Code")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoSub")]),t._v(" DoThis\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\nDoThis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    Debug"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hi!"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Return")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"why-does-this-work-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-does-this-work-6"}},[t._v("#")]),t._v(" Why does this work?")]),t._v(" "),s("p",[t._v("By introducing an "),s("code",[t._v("Exit Sub")]),t._v(" instruction "),s("strong",[t._v("before")]),t._v(" the "),s("code",[t._v("DoThis")]),t._v(" line label, we have segregated the "),s("code",[t._v("DoThis")]),t._v(" subroutine from the rest of the procedure body - the only way to execute the "),s("code",[t._v("DoThis")]),t._v(" subroutine is via the "),s("code",[t._v("GoSub")]),t._v(" jump.")]),t._v(" "),s("h3",{attrs:{id:"other-notes-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#other-notes-5"}},[t._v("#")]),t._v(" Other notes")]),t._v(" "),s("p",[s("code",[t._v("GoSub")]),t._v("/"),s("code",[t._v("Return")]),t._v(" is deprecated, and should be avoided in favor of actual procedure calls. A procedure should not contain subroutines, other than error handlers.")]),t._v(" "),s("p",[t._v("This is very similar to "),s("a",{attrs:{href:"http://stackoverflow.com/documentation/vba/8917/vba-run-time-errors/27776/run-time-error-20-resume-without-error",target:"_blank",rel:"noopener noreferrer"}},[t._v("Run-time error '20': Resume without error"),s("OutboundLink")],1),t._v("; in both situations, the solution is to ensure that the "),s("strong",[t._v("normal execution path")]),t._v(" cannot enter a sub-routine (identified by a line label) without an explicit jump (assuming "),s("code",[t._v("On Error GoTo")]),t._v(" is considered an "),s("strong",[t._v("explicit jump")]),t._v(").")])])}),[],!1,null,null,null);e.default=a.exports}}]);