(window.webpackJsonp=window.webpackJsonp||[]).push([[2948],{3292:function(t,a,e){"use strict";e.r(a);var s=e(19),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"rodbc"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rodbc"}},[t._v("#")]),t._v(" RODBC")]),t._v(" "),e("h2",{attrs:{id:"connecting-to-excel-files-via-rodbc"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#connecting-to-excel-files-via-rodbc"}},[t._v("#")]),t._v(" Connecting to Excel Files via RODBC")]),t._v(" "),e("p",[t._v("While "),e("code",[t._v("RODBC")]),t._v(" is restricted to Windows computers with compatible architecture between R and any target RDMS, one of its key flexibilities is to work with Excel files as if they were SQL databases.")]),t._v(" "),e("div",{staticClass:"language-r extra-class"},[e("pre",{pre:!0,attrs:{class:"language-r"}},[e("code",[t._v("require"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RODBC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ncon "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" odbcConnectExcel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myfile.xlsx"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# open a connection to the Excel file")]),t._v("\nsqlTables"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("con"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),t._v("TABLE_NAME "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# show all sheets")]),t._v("\ndf "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sqlFetch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("con"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# read a sheet")]),t._v("\ndf "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sqlQuery"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("con"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select * from [Sheet1 $]"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# read a sheet (alternative SQL syntax)")]),t._v("\nclose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("con"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# close the connection to the file")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"sql-server-management-database-connection-to-get-individual-table"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sql-server-management-database-connection-to-get-individual-table"}},[t._v("#")]),t._v(" SQL Server Management Database connection to get individual table")]),t._v(" "),e("p",[t._v("Another use of RODBC is in connecting with SQL Server Management Database.  We need to specify the 'Driver' i.e. SQL Server here, the database name \"Atilla\" and then use the "),e("code",[t._v("sqlQuery")]),t._v(" to extract either the full table or a fraction of it.")]),t._v(" "),e("div",{staticClass:"language-r extra-class"},[e("pre",{pre:!0,attrs:{class:"language-r"}},[e("code",[t._v("library"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RODBC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \ncn  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" odbcDriverConnect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("connection"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Driver={SQL Server};server=localhost;database=Atilla;trusted_connection=yes;"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntbl "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" sqlQuery"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cn"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'select top 10 * from table_1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"connecting-to-relational-databases"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#connecting-to-relational-databases"}},[t._v("#")]),t._v(" Connecting to relational databases")]),t._v(" "),e("div",{staticClass:"language-r extra-class"},[e("pre",{pre:!0,attrs:{class:"language-r"}},[e("code",[t._v("library"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RODBC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ncon "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" odbcDriverConnect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"driver={Sql Server};server=servername;trusted connection=true"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndat "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" sqlQuery"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("con"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select * from table"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nclose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("con"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),e("p",[t._v("This will connect to a SQL Server instance.  For more information on what your connection string should look like, visit "),e("a",{attrs:{href:"http://connectionstrings.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("connectionstrings.com"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("Also, since there's no database specified, you should make sure you fully qualify the object you're wanting to query like this databasename.schema.objectname")])])}),[],!1,null,null,null);a.default=n.exports}}]);