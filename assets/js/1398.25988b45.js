(window.webpackJsonp=window.webpackJsonp||[]).push([[1398],{1806:function(t,e,a){"use strict";a.r(e);var s=a(31),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"load-images-async"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#load-images-async"}},[t._v("#")]),t._v(" Load images async")]),t._v(" "),a("h2",{attrs:{id:"easiest-way"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#easiest-way"}},[t._v("#")]),t._v(" Easiest way")]),t._v(" "),a("p",[t._v("The most simple way to create this is to use "),a("a",{attrs:{href:"https://github.com/Alamofire/Alamofire",target:"_blank",rel:"noopener noreferrer"}},[t._v("Alamofire"),a("OutboundLink")],1),t._v(" and its "),a("a",{attrs:{href:"https://github.com/Alamofire/AlamofireImage#uiimageview-extension",target:"_blank",rel:"noopener noreferrer"}},[t._v("UIImageViewExtension"),a("OutboundLink")],1),t._v(". What we need is a tableview with a cell that has an imageView in it and lets call it "),a("code",[t._v("imageView")]),t._v(".")]),t._v(" "),a("p",[t._v("In the cellForRowAt: function of the tableView we would download the image and set in the following way:")]),t._v(" "),a("div",{staticClass:"language-swift extra-class"},[a("pre",{pre:!0,attrs:{class:"language-swift"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string-literal"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://httpbin.org/image/png"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" placeholderImage "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UIImage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("named"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string-literal"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"placeholder"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\nimageView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("af_setImage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("withURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" placeholderImage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" placeholderImage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),a("p",[t._v("The url should point to the image that you want to download and the placeHolder image should be a stored image. We then call the "),a("code",[t._v("af_setImage")]),t._v(" method on the "),a("code",[t._v("imageView")]),t._v(" which downloads the image at the given url and during the download the placeholder image will be shown. As soon as the image is downloaded the requested image is displayed")]),t._v(" "),a("h2",{attrs:{id:"check-that-the-cell-is-still-visible-after-download"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#check-that-the-cell-is-still-visible-after-download"}},[t._v("#")]),t._v(" Check that the cell is still visible after download")]),t._v(" "),a("p",[t._v("Sometimes the download takes longer than the cell is being displayed. In this case it can happen, that the downloaded image is shown in the wrong cell. To fix this we can not use the "),a("a",{attrs:{href:"https://github.com/Alamofire/AlamofireImage#uiimageview-extension",target:"_blank",rel:"noopener noreferrer"}},[t._v("UIImageView Extension"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[t._v("We still will be using "),a("a",{attrs:{href:"https://github.com/Alamofire/Alamofire",target:"_blank",rel:"noopener noreferrer"}},[t._v("Alamofire"),a("OutboundLink")],1),t._v(" however we will use the completion handler to display the image.")]),t._v(" "),a("p",[t._v("In this scenario we still need a tableView with a cell which has a imageView in it. In the cellForRowAt: method we would download the image with the following code:")]),t._v(" "),a("div",{staticClass:"language-swift extra-class"},[a("pre",{pre:!0,attrs:{class:"language-swift"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" placeholderImage "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UIImage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("named"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string-literal"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"placeholder"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nimageView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("image "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" placeholderImage\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string-literal"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://httpbin.org/image/png"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Alamofire")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseImage "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" response "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("guard")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" updateCell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tableView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cellForRow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("at"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" indexPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        updateCell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imageView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("image "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" image\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("In this example we first set the image to the placeholder image. Afterwards we download the image with the "),a("code",[t._v("request")]),t._v(" method of "),a("a",{attrs:{href:"https://github.com/Alamofire/AlamofireImage#uiimageview-extension",target:"_blank",rel:"noopener noreferrer"}},[t._v("Alamofire"),a("OutboundLink")],1),t._v(". We pass the url as the first argument and since we just want to get the image we will use the "),a("code",[t._v(".get")]),t._v(" HTTP method. Since we are downloading an image we want the response to be an image therefore we use the "),a("code",[t._v(".responseImage")]),t._v(" method.")]),t._v(" "),a("p",[t._v("After the image has been downloaded the closure gets called and first of all we make sure that the downloaded image actually exists. Then we make sure that the cell is still visible by checking that the cellForRow(at: indexPath) doesn't return nil. If it does nothing happens, if it doesn't we assign the recently downloaded image.")]),t._v(" "),a("p",[t._v("This last if statement ensures that the cell is still visible if the user already scrolled over the cell the updateCell will be nil and the if statement returns nil. This helps us prevent displaying the wrong image in a cell.")])])}),[],!1,null,null,null);e.default=n.exports}}]);