(window.webpackJsonp=window.webpackJsonp||[]).push([[2071],{2479:function(a,t,s){"use strict";s.r(t);var e=s(31),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"table-valued-parameters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#table-valued-parameters"}},[a._v("#")]),a._v(" Table Valued Parameters")]),a._v(" "),s("h2",{attrs:{id:"using-a-table-valued-parameter-to-insert-multiple-rows-to-a-table"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-table-valued-parameter-to-insert-multiple-rows-to-a-table"}},[a._v("#")]),a._v(" Using a table valued parameter to insert multiple rows to a table")]),a._v(" "),s("p",[a._v("First, define a "),s("a",{attrs:{href:"http://stackoverflow.com/documentation/sql-server/5280/user-defined-table-types",target:"_blank",rel:"noopener noreferrer"}},[a._v("used defined table type"),s("OutboundLink")],1),a._v(" to use:")]),a._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TYPE")]),a._v(" names "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    FirstName "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    LastName "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nGO\n\n")])])]),s("p",[a._v("Create the stored procedure:")]),a._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PROCEDURE")]),a._v(" prInsertNames\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@Names")]),a._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Names READONLY "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- Note: You must specify the READONLY")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("AS")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("TblNames "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("FirstName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" LastName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" FirstName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" LastName\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@Names")]),a._v(" \nGO\n\n")])])]),s("p",[a._v("Executing the stored procedure:")]),a._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DECLARE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@names")]),a._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Names\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@Names")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VALUES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Zohar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Peled'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'First'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Last'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("EXEC")]),a._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("prInsertNames "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@Names")]),a._v("\n\n")])])]),s("h4",{attrs:{id:"remarks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[a._v("#")]),a._v(" Remarks")]),a._v(" "),s("p",[a._v("Table valued parameters (TVP for short) are parameters passed to a stored procedure or function that contains data that is table structured.\nUsing table valued parameters requires creating a "),s("a",{attrs:{href:"http://stackoverflow.com/documentation/sql-server/5280/user-defined-table-types",target:"_blank",rel:"noopener noreferrer"}},[a._v("user defined table type"),s("OutboundLink")],1),a._v(" for the parameter being used.")]),a._v(" "),s("p",[a._v("Tabled valued parameters are readonly parameters.")])])}),[],!1,null,null,null);t.default=r.exports}}]);