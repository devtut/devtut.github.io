(window.webpackJsonp=window.webpackJsonp||[]).push([[3451],{3859:function(t,s,e){"use strict";e.r(s);var a=e(31),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"backgroundworker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#backgroundworker"}},[t._v("#")]),t._v(" BackgroundWorker")]),t._v(" "),e("h2",{attrs:{id:"accessing-gui-components-in-backgroundworker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#accessing-gui-components-in-backgroundworker"}},[t._v("#")]),t._v(" Accessing GUI components in BackgroundWorker")]),t._v(" "),e("p",[t._v("You cannot access any GUI components from the BackgroudWorker. For example if you try to do something like this")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" BackgroundWorker1_DoWork"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sender "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" DoWorkEventArgs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    TextBox1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Text "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("you will receive a runtime error saying that \"Cross-thread operation not valid: Control 'TextBox1' accessed from a thread other than the thread it was created on.\"")]),t._v(" "),e("p",[t._v("This is because the BackgroundWorker runs your code on another thread in parallel with the main thread, and the GUI components are not thread-safe. You have to set your code to be run on the main thread using the "),e("code",[t._v("Invoke")]),t._v(" method, giving it a delegate:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" BackgroundWorker1_DoWork"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sender "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" DoWorkEventArgs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Invoke"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" MethodInvoker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TextBox1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Text "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("Or you can use the ReportProgress method of the BackgroundWorker:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" BackgroundWorker1_DoWork"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sender "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" DoWorkEventArgs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BackgroundWorker1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReportProgress"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" BackgroundWorker1_ProgressChanged"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sender "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ProgressChangedEventArgs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TextBox1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Text "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DirectCast")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UserState"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"using-backgroundworker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-backgroundworker"}},[t._v("#")]),t._v(" Using BackgroundWorker")]),t._v(" "),e("p",[t._v("Executing a task with the background worker.")]),t._v(" "),e("p",[t._v("Double Click on the "),e("code",[t._v("BackgroundWorker")]),t._v(" control from the Toolbox")]),t._v(" "),e("p",[e("a",{attrs:{href:"http://i.stack.imgur.com/QuRSr.jpg",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"http://i.stack.imgur.com/QuRSr.jpg",alt:"BackroundWorker Control in Toolbox"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("This is how the BackgroundWorker appears after adding it.")]),t._v(" "),e("p",[e("a",{attrs:{href:"http://i.stack.imgur.com/KmxOU.jpg",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"http://i.stack.imgur.com/KmxOU.jpg",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("Double click on the added control to get the "),e("code",[t._v("BackgroundWorker1_DoWork")]),t._v(" event and add the code to be executed when the BackgroundWorker is called. Something like this:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" BackgroundWorker1_DoWork"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" sender "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" e "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ComponentModel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DoWorkEventArgs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Handles")]),t._v(" BackgroundWorker1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DoWork\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Do the time consuming background task here")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("Calling the BackgroundWorker to perform the task can be done at any event like "),e("code",[t._v("Button_Click")]),t._v(", "),e("code",[t._v("Textbox_TextChanged")]),t._v(", etc. as follows:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[t._v("BackgroundWorker1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RunWorkerAsync"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),e("p",[t._v("Modify the "),e("code",[t._v("RunWorkerCompleted")]),t._v(" event to capture the task finished event of the BackgroundWorker as follows:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" BackgroundWorker1_RunWorkerCompleted"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" sender "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" e "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ComponentModel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RunWorkerCompletedEventArgs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Handles")]),t._v(" BackgroundWorker1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RunWorkerCompleted\n    MsgBox"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("This will display a message box saying "),e("code",[t._v("Done")]),t._v(" when the worker finishes the task assigned to it.")])])}),[],!1,null,null,null);s.default=r.exports}}]);