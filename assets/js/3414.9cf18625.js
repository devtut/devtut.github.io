(window.webpackJsonp=window.webpackJsonp||[]).push([[3414],{3822:function(t,e,n){"use strict";n.r(e);var a=n(31),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"createobject-vs-getobject"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#createobject-vs-getobject"}},[t._v("#")]),t._v(" CreateObject vs. GetObject")]),t._v(" "),n("h2",{attrs:{id:"demonstrating-getobject-and-createobject"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#demonstrating-getobject-and-createobject"}},[t._v("#")]),t._v(" Demonstrating GetObject and CreateObject")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/office/gg251785.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("MSDN-GetObject Function"),n("OutboundLink")],1)]),t._v(" "),n("blockquote"),t._v(" "),n("p",[t._v("Returns a reference to an object provided by an ActiveX component.")]),t._v(" "),n("blockquote"),t._v(" "),n("p",[t._v("Use the GetObject function when there is a current instance of the object or if you want to create the object with a file already loaded. If there is no current instance, and you don't want the object started with a file loaded, use the CreateObject function.")]),t._v(" "),n("div",{staticClass:"language-vb extra-class"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" CreateVSGet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" ThisXLApp "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Excel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Application "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'An example of early binding")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" AnotherXLApp "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Object")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'An example of late binding")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" ThisNewWB "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" AnotherNewWB "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" wb "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n    \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Get this instance of Excel")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ThisXLApp "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetObject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThisWorkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Application\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Create another instance of Excel")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" AnotherXLApp "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateObject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Excel.Application"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Make the 2nd instance visible")]),t._v("\n    AnotherXLApp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Visible "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Add a workbook to the 2nd instance")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" AnotherNewWB "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" AnotherXLApp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Workbooks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Add a sheet to the 2nd instance")]),t._v("\n    AnotherNewWB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add\n    \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'You should now have 2 instances of Excel open")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'The 1st instance has 1 workbook: Book1")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'The 2nd instance has 1 workbook: Book2")]),t._v("\n    \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Lets add another workbook to our 1st instance")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ThisNewWB "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisXLApp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Workbooks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Now loop through the workbooks and show their names")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" wb "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" ThisXLApp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Workbooks\n        Debug"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print wb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Now the 1st instance has 2 workbooks: Book1 and Book3")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'If you close the first instance of Excel,")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Book1 and Book3 will close, but book2 will still be open")]),t._v("\n    \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),n("h4",{attrs:{id:"remarks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[t._v("#")]),t._v(" Remarks")]),t._v(" "),n("p",[t._v("At its simplest, "),n("code",[t._v("CreateObject")]),t._v(" creates an instance of an object whereas "),n("code",[t._v("GetObject")]),t._v(" gets an existing instance of an object. Determining whether an object can be created or gotten will depend on it's "),n("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/aa242107%28v=vs.60%29.aspx?f=255&MSPPError=-2147217396",target:"_blank",rel:"noopener noreferrer"}},[t._v("Instancing property"),n("OutboundLink")],1),t._v(". Some objects are SingleUse (eg, WMI) and cannot be created if they already exist. Other objects (eg, Excel) are MultiUse and allow multiple instances to run at once. If an instance of an object does not already exist and you attempt "),n("code",[t._v("GetObject")]),t._v(", you will receive the following trappable message: "),n("code",[t._v("Run-time error '429': ActiveX component can't create object")]),t._v(".")]),t._v(" "),n("p",[n("strong",[t._v("GetObject")]),t._v(" requires at least one of these two optional parameters to be present:")]),t._v(" "),n("ol",[n("li",[n("strong",[t._v("Pathname")]),t._v(" - Variant (String): The full path, including filename, of the file containing the object. This parameter is optional, but "),n("strong",[t._v("Class")]),t._v(" is required if "),n("strong",[t._v("Pathname")]),t._v(" is omitted.")]),t._v(" "),n("li",[n("strong",[t._v("Class")]),t._v(" - Variant (String): A string representing the formal definition (Application and ObjectType) of the object. "),n("strong",[t._v("Class")]),t._v(" is required if "),n("strong",[t._v("Pathname")]),t._v(" is omitted.")])]),t._v(" "),n("p",[n("strong",[t._v("CreateObject")]),t._v(" has one required parameter and one optional parameter:")]),t._v(" "),n("ol",[n("li",[n("strong",[t._v("Class")]),t._v("  - Variant (String): A string representing the formal definition (Application and ObjectType) of the object. "),n("strong",[t._v("Class")]),t._v(" is a required parameter.")]),t._v(" "),n("li",[n("strong",[t._v("Servername")]),t._v(" - Variant (String): The name of the remote computer on which the object will be created. If omitted, the object will be created on the local machine.")])]),t._v(" "),n("p",[n("strong",[t._v("Class")]),t._v(" is always comprised of two parts in the form of "),n("code",[t._v("Application.ObjectType")]),t._v(":")]),t._v(" "),n("ol",[n("li",[n("strong",[t._v("Application")]),t._v(" - The name of the application which the object is part of. |")]),t._v(" "),n("li",[n("strong",[t._v("Object Type")]),t._v(" - The type of object being created. |")])]),t._v(" "),n("p",[t._v("Some example classes are:")]),t._v(" "),n("ol",[n("li",[t._v("Word.Application")]),t._v(" "),n("li",[t._v("Excel.Sheet")]),t._v(" "),n("li",[t._v("Scripting.FileSystemObject")])])])}),[],!1,null,null,null);e.default=s.exports}}]);