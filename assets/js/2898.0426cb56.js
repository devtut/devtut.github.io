(window.webpackJsonp=window.webpackJsonp||[]).push([[2898],{3246:function(t,a,s){"use strict";s.r(a);var e=s(19),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"i-o-for-foreign-tables-excel-sas-spss-stata"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#i-o-for-foreign-tables-excel-sas-spss-stata"}},[t._v("#")]),t._v(" I/O for foreign tables (Excel, SAS, SPSS, Stata)")]),t._v(" "),s("h2",{attrs:{id:"importing-data-with-rio"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#importing-data-with-rio"}},[t._v("#")]),t._v(" Importing data with rio")]),t._v(" "),s("p",[t._v("A very simple way to import data from many common file formats is with "),s("a",{attrs:{href:"https://cran.r-project.org/web/packages/rio/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("rio"),s("OutboundLink")],1),t._v(". This package provides a function "),s("code",[t._v("import()")]),t._v(" that wraps many commonly used data import functions, thereby providing a standard interface. It works simply by passing a file name or URL to "),s("code",[t._v("import()")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("import"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.csv"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# comma-separated values")]),t._v("\nimport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.tsv"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tab-separated values")]),t._v("\nimport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.dta"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Stata")]),t._v("\nimport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.sav"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# SPSS")]),t._v("\nimport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.sas7bdat"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# SAS")]),t._v("\nimport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.xlsx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Excel")]),t._v("\n\n")])])]),s("p",[s("code",[t._v("import()")]),t._v(" can also read from compressed directories, URLs (HTTP or HTTPS), and the clipboard.\nA comprehensive list of all supported file formats is available on the "),s("a",{attrs:{href:"https://github.com/leeper/rio",target:"_blank",rel:"noopener noreferrer"}},[t._v("rio package github repository"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("It is even possible to specify some further parameters related to the specific file format you are trying to read, passing them directly within the "),s("code",[t._v("import()")]),t._v(" function:")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("import"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.csv"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" format "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#for csv file where comma is used as separator")]),t._v("\nimport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.csv"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" format "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('";"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#for csv file where semicolon is used as separator")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"read-and-write-stata-spss-and-sas-files"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#read-and-write-stata-spss-and-sas-files"}},[t._v("#")]),t._v(" Read and write Stata, SPSS and SAS files")]),t._v(" "),s("p",[t._v("The packages "),s("code",[t._v("foreign")]),t._v(" and "),s("code",[t._v("haven")]),t._v(" can be used to import and export files from a variety of other statistical packages like Stata, SPSS and SAS and related software. There is a "),s("code",[t._v("read")]),t._v(" function for each of the supported data types to import the files.")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# loading the packages")]),t._v("\nlibrary"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foreign"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nlibrary"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("haven"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nlibrary"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("readstata13"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nlibrary"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Hmisc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("Some examples for the most common data types:")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reading Stata files with `foreign`")]),t._v("\nread.dta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reading Stata files with `haven`")]),t._v("\nread_dta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("The "),s("code",[t._v("foreign")]),t._v(" package can read in stata (.dta) files for versions of Stata 7-12. According to the development page, the "),s("code",[t._v("read.dta")]),t._v(" is more or less frozen and will not be updated for reading in versions 13+. For more recent versions of Stata, you can use either the "),s("code",[t._v("readstata13")]),t._v(" package or "),s("code",[t._v("haven")]),t._v(". For "),s("code",[t._v("readstata13")]),t._v(", the files are")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reading recent Stata (13+) files with `readstata13`")]),t._v("\nread.dta13"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("For reading in SPSS and SAS files")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reading SPSS files with `foreign`")]),t._v("\nread.spss"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data.sav"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" to.data.frame "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("TRUE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reading SPSS files with `haven`")]),t._v("\nread_spss"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data.sav"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nread_sav"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data.sav"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nread_por"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data.por"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reading SAS files with `foreign`")]),t._v("\nread.ssd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reading SAS files with `haven`")]),t._v("\nread_sas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reading native SAS files with `Hmisc`")]),t._v("\nsas.get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#requires access to saslib ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Reading SA XPORT format ( *.XPT ) files")]),t._v("\nsasxport.get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data.xpt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# does not require access to SAS executable")]),t._v("\n\n")])])]),s("p",[t._v("The "),s("code",[t._v("SAScii")]),t._v(" package provides functions that will accept SAS SET import code and construct a text file that can be processed with "),s("code",[t._v("read.fwf")]),t._v(". It has proved very robust for import of large public-released datasets. Support is at "),s("a",{attrs:{href:"https://github.com/ajdamico/SAScii",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/ajdamico/SAScii"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("To export data frames to other statistical packages you can use the write functions "),s("code",[t._v("write.foreign()")]),t._v(". This will write 2 files, one containing the data and one containing instructions the other package needs to read the data.")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# writing to Stata, SPSS or SAS files with `foreign`")]),t._v("\nwrite.foreign"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataframe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" datafile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" codefile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n              package "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SPSS"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Stata"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SAS"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token ellipsis"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nwrite.foreign"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataframe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\data\\file"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\instruction\\file"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" package "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Stata"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# writing to Stata files with `foreign`")]),t._v("\nwrite.dta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataframe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7L")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          convert.dates "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("TRUE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tz "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GMT"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          convert.factors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"labels"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"numeric"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"codes"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# writing to Stata files with `haven`")]),t._v("\nwrite_dta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataframe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# writing to Stata files with `readstata13`")]),t._v("\nsave.dta13"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataframe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data.label "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" time.stamp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("TRUE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  convert.factors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("TRUE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" convert.dates "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("TRUE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tz "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GMT"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  add.rownames "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("FALSE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" compress "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("FALSE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("117")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  convert.underscore "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("FALSE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# writing to SPSS files with `haven`")]),t._v("\nwrite_sav"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataframe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path\\to\\your\\data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("File stored by the SPSS can also be read with "),s("code",[t._v("read.spss")]),t._v(" in this way:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\nforeign::read.spss('data.sav', to.data.frame=TRUE, use.value.labels=FALSE, \n                     use.missings=TRUE, reencode='UTF-8')\n# to.data.frame if TRUE: return a data frame\n# use.value.labels if TRUE: convert variables with value labels into R factors with those levels\n# use.missings if TRUE: information on user-defined missing values will used to set the corresponding values to NA.\n# reencode character strings will be re-encoded to the current locale. The default, NA, means to do so in a UTF-8 locale, only.\n\n")])])]),s("h2",{attrs:{id:"importing-excel-files"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#importing-excel-files"}},[t._v("#")]),t._v(" Importing Excel files")]),t._v(" "),s("p",[t._v("There are several R packages to read excel files, each of which using different languages or resources, as summarized in the following table:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("R package")]),t._v(" "),s("th",[t._v("Uses")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("xlsx")]),t._v(" "),s("td",[t._v("Java")])]),t._v(" "),s("tr",[s("td",[t._v("XLconnect")]),t._v(" "),s("td",[t._v("Java")])]),t._v(" "),s("tr",[s("td",[t._v("openxlsx")]),t._v(" "),s("td",[t._v("C++")])]),t._v(" "),s("tr",[s("td",[t._v("readxl")]),t._v(" "),s("td",[t._v("C++")])]),t._v(" "),s("tr",[s("td",[t._v("RODBC")]),t._v(" "),s("td",[t._v("ODBC")])]),t._v(" "),s("tr",[s("td",[t._v("gdata")]),t._v(" "),s("td",[t._v("Perl")])])])]),t._v(" "),s("p",[t._v("For the packages that use Java or ODBC it is important to know details about your system because you may have compatibility issues depending on your R version and OS. For instance, if you are using R 64 bits then you also must have Java 64 bits to use "),s("code",[t._v("xlsx")]),t._v(" or "),s("code",[t._v("XLconnect")]),t._v(".")]),t._v(" "),s("p",[t._v("Some examples of reading excel files with each package are provided below. Note that many of the packages have the same or very similar function names. Therefore, it is useful to state the package explicitly, like "),s("code",[t._v("package::function")]),t._v(". The package "),s("code",[t._v("openxlsx")]),t._v(" requires prior installation of RTools.")]),t._v(" "),s("h3",{attrs:{id:"reading-excel-files-with-the-xlsx-package"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reading-excel-files-with-the-xlsx-package"}},[t._v("#")]),t._v(" Reading excel files with the xlsx package")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlsx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("The index or name of the sheet is required to import.")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("xlsx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read.xlsx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Book1.xlsx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheetIndex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nxlsx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read.xlsx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Book1.xlsx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheetName"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"reading-excel-files-with-the-xlconnect-package"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reading-excel-files-with-the-xlconnect-package"}},[t._v("#")]),t._v(" Reading Excel files with the XLconnect package")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("XLConnect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nwb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" XLConnect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("loadWorkbook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Book1.xlsx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Either, if Book1.xlsx has a sheet called "Sheet1":')]),t._v("\nsheet1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" XLConnect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("readWorksheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Or, more generally, just get the first sheet in Book1.xlsx:")]),t._v("\nsheet1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" XLConnect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("readWorksheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" getSheets"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[s("code",[t._v("XLConnect")]),t._v(" automatically imports the pre-defined Excel cell-styles embedded in "),s("code",[t._v("Book1.xlsx")]),t._v(". This is useful when you wish to format your workbook object and export a perfectly formatted Excel document. Firstly, you will need to create the desired cell formats in "),s("code",[t._v("Book1.xlsx")]),t._v(" and save them, for example, as "),s("code",[t._v("myHeader")]),t._v(", "),s("code",[t._v("myBody")]),t._v(" and "),s("code",[t._v("myPcts")]),t._v(". Then, after loading the workbook in "),s("code",[t._v("R")]),t._v(" (see above):")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("Headerstyle "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" XLConnect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("getCellStyle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myHeader"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nBodystyle "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" XLConnect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("getCellStyle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myBody"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nPctsstyle "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" XLConnect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("getCellStyle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myPcts"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("The cell styles are now saved in your "),s("code",[t._v("R")]),t._v(" environment. In order to assign the cell styles to certain ranges of your data, you need to define the range and then assign the style:")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("Headerrange "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" expand.grid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("row "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" col "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nBodyrange "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" expand.grid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("row "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" col "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nPctrange "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" expand.grid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("row "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" col "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nXLConnect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("setCellStyle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sheet1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" row "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Headerrange"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),t._v("row"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n             col "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Headerrange"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),t._v("col"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cellstyle "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Headerstyle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nXLConnect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("setCellStyle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sheet1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" row "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Bodyrange"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),t._v("row"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n             col "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Bodyrange"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),t._v("col"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cellstyle "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Bodystyle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nXLConnect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("setCellStyle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sheet1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" row "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Pctrange"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),t._v("row"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n             col "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Pctrange"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),t._v("col"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cellstyle "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Pctsstyle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("Note that "),s("code",[t._v("XLConnect")]),t._v(" is easy, but can become extremely slow in formatting. A much faster, but more cumbersome formatting option is offered by "),s("code",[t._v("openxlsx")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"reading-excel-files-with-the-openxlsx-package"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reading-excel-files-with-the-openxlsx-package"}},[t._v("#")]),t._v(" Reading excel files with the openxlsx package")]),t._v(" "),s("p",[t._v("Excel files can be imported with package "),s("code",[t._v("openxlsx")])]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("openxlsx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nopenxlsx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read.xlsx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spreadsheet1.xlsx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" colNames"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("TRUE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rowNames"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("TRUE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#colNames: If TRUE, the first row of data will be used as column names.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#rowNames: If TRUE, first column of data will be used as row names.")]),t._v("\n\n")])])]),s("p",[t._v("The sheet, which should be read into R can be selected either by providing its position in the "),s("code",[t._v("sheet")]),t._v(" argument:")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("openxlsx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read.xlsx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spreadsheet1.xlsx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("or by declaring its name:")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("openxlsx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read.xlsx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spreadsheet1.xlsx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("Additionally, "),s("code",[t._v("openxlsx")]),t._v(" can detect date columns in a read sheet. In order to allow automatic detection of dates, an argument "),s("code",[t._v("detectDates")]),t._v(" should be set to "),s("code",[t._v("TRUE")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("openxlsx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read.xlsx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spreadsheet1.xlsx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" detectDates"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("TRUE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"reading-excel-files-with-the-readxl-package"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reading-excel-files-with-the-readxl-package"}},[t._v("#")]),t._v(" Reading excel files with the readxl package")]),t._v(" "),s("p",[t._v("Excel files can be imported as a data frame into "),s("code",[t._v("R")]),t._v(" using the "),s("code",[t._v("readxl")]),t._v(" package.")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("readxl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("It can read both "),s("code",[t._v(".xls")]),t._v(" and "),s("code",[t._v(".xlsx")]),t._v(" files.")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("readxl"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read_excel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spreadsheet1.xls"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nreadxl"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read_excel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spreadsheet2.xlsx"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("The sheet to be imported can be specified by number or name.")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("readxl"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read_excel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spreadsheet.xls"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nreadxl"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read_excel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spreadsheet.xls"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"summary"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("The argument "),s("code",[t._v("col_names = TRUE")]),t._v(" sets the first row as the column names.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('\nreadxl::read_excel("spreadsheet.xls", sheet = 1, col_names = TRUE)\n\n')])])]),s("p",[t._v("The argument "),s("code",[t._v("col_types")]),t._v(" can be used to specify the column types in the data as a vector.")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("readxl"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v("read_excel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spreadsheet.xls"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" col_names "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("TRUE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   col_types "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"date"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"numeric"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"numeric"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"reading-excel-files-with-the-rodbc-package"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reading-excel-files-with-the-rodbc-package"}},[t._v("#")]),t._v(" Reading excel files with the RODBC package")]),t._v(" "),s("p",[t._v("Excel files can be read using the ODBC Excel Driver that interfaces with Windows' Access Database Engine (ACE), formerly JET. With the RODBC package, R can connect to this driver and directly query workbooks. Worksheets are assumed to maintain column headers in first row with data in organized columns of similar types. "),s("strong",[t._v("NOTE:")]),t._v(" This approach is limited to only Windows/PC machines as JET/ACE are installed .dll files and not available on other operating systems.")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RODBC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nxlconn "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" odbcDriverConnect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("'Driver"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Microsoft Excel Driver "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(".xls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(".xlsx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(".xlsm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(".xlsb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                             DBQ"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("C"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\\\\Path\\\\To\\\\Workbook.xlsx'"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" sqlQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlconn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM [SheetName$]"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nclose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlconn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("Connecting with an SQL engine in this approach, Excel worksheets can be queried similar to database tables including "),s("code",[t._v("JOIN")]),t._v(" and "),s("code",[t._v("UNION")]),t._v(" operations. Syntax follows the JET/ACE SQL dialect. "),s("strong",[t._v("NOTE:")]),t._v(" Only data access DML statements, specifically "),s("code",[t._v("SELECT")]),t._v(" can be run on workbooks, considered not updateable queries.")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("joindf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v("  sqlQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlconn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(' "SELECT t1.'),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t2."),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" FROM "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Sheet1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" t1\n                             INNER JOIN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Sheet2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" t2\n                             ON t1."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t2."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nuniondf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v("  sqlQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlconn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(' "SELECT '),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" FROM "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Sheet1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                              UNION  \n                              SELECT "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" FROM "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Sheet2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("Even other workbooks can be queried from the same ODBC channel pointing to a current workbook:")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("otherwkbkdf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" sqlQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlconn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(' "SELECT '),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" FROM \n                                 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Excel "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.0")]),t._v(" Xml"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("HDR"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Yes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                                 Database"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("C"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\\\\Path\\\\To\\\\Other\\\\Workbook.xlsx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Sheet1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"reading-excel-files-with-the-gdata-package"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reading-excel-files-with-the-gdata-package"}},[t._v("#")]),t._v(" Reading excel files with the gdata package")]),t._v(" "),s("p",[s("strong",[t._v("example here")])]),t._v(" "),s("h2",{attrs:{id:"import-or-export-of-feather-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#import-or-export-of-feather-file"}},[t._v("#")]),t._v(" Import or Export of Feather file")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/wesm/feather",target:"_blank",rel:"noopener noreferrer"}},[t._v("Feather"),s("OutboundLink")],1),t._v(" is an implementation of "),s("a",{attrs:{href:"https://arrow.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache Arrow"),s("OutboundLink")],1),t._v(" designed to store data frames in a language agnostic manner while maintaining metadata (e.g. date classes), increasing interoperability between Python and R. Reading a feather file will produce a tibble, not a standard data.frame.")]),t._v(" "),s("div",{staticClass:"language-r extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[t._v("library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("feather"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\npath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"filename.feather"')]),t._v("\ndf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" mtcars\n\nwrite_feather"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndf2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v(" read_feather"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nhead"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##  A tibble: 6 x 11")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 1  21.0     6   160   110  3.90 2.620 16.46     0     1     4     4")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 2  21.0     6   160   110  3.90 2.875 17.02     0     1     4     4")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 3  22.8     4   108    93  3.85 2.320 18.61     1     1     4     1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 4  21.4     6   258   110  3.08 3.215 19.44     1     0     3     1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 5  18.7     8   360   175  3.15 3.440 17.02     0     0     3     2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 6  18.1     6   225   105  2.76 3.460 20.22     1     0     3     1")]),t._v("\n\nhead"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1")]),t._v("\n\n")])])]),s("p",[t._v("The current documentation contains this warning:")]),t._v(" "),s("blockquote"),t._v(" "),s("p",[t._v("Note to users: Feather should be treated as alpha software. In particular, the file format is likely to evolve over the coming year. Do not use Feather for long-term data storage.")])])}),[],!1,null,null,null);a.default=n.exports}}]);