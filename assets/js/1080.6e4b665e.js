(window.webpackJsonp=window.webpackJsonp||[]).push([[1080],{1488:function(t,s,a){"use strict";a.r(s);var e=a(31),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"excel-vba-optimization"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#excel-vba-optimization"}},[t._v("#")]),t._v(" Excel-VBA Optimization")]),t._v(" "),a("p",[t._v("Excel-VBA Optimization refers also to coding better error handling by documentation and additional details. This is shown here.")]),t._v(" "),a("h2",{attrs:{id:"disabling-worksheet-updating"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#disabling-worksheet-updating"}},[t._v("#")]),t._v(" Disabling Worksheet Updating")]),t._v(" "),a("p",[t._v("Disabling calculation of the worksheet can decrease running time of the macro significantly. Moreover, disabling events, screen updating and page breaks would be beneficial. Following "),a("code",[t._v("Sub")]),t._v(" can be used in any macro for this purpose.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" OptimizeVBA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isOn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Calculation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" IIf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isOn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" xlCalculationManual"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" xlCalculationAutomatic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableEvents "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isOn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isOn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ActiveSheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayPageBreaks "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isOn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("p",[t._v("For optimization follow the below pseudo-code:")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" MyCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    OptimizeVBA "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Your code goes here")]),t._v("\n\n    OptimizeVBA "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"optimizing-error-search-by-extended-debugging"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#optimizing-error-search-by-extended-debugging"}},[t._v("#")]),t._v(" Optimizing Error Search by Extended Debugging")]),t._v(" "),a("p",[a("strong",[t._v("Using Line Numbers ... and documenting them in case of error")]),t._v('\n("The importance of seeing Erl")')]),t._v(" "),a("p",[t._v("Detecting which line raises an error is a substantial part of any debugging and narrows the search for the cause. To document identified error lines with a short description completes a successful error tracking, at best together with the names of module and procedure. The example below saves these data to a log file.")]),t._v(" "),a("p",[a("strong",[t._v("Back ground")])]),t._v(" "),a("p",[t._v("The error object returns error number (Err.Number) and error description (Err.Description), but doesn't explicitly respond to the question where to locate the error. The "),a("strong",[t._v("Erl")]),t._v(" function, however, does, but on condition that you add *"),a("strong",[t._v("line numbers "),a("em",[t._v(")")])]),t._v(" to the code (BTW one of several other concessions to former Basic times).")]),t._v(" "),a("p",[t._v("If there are no error lines at all, then the Erl function returns 0, if numbering is incomplete you'll get the procedure's last preceding line number.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" MyProc1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" j "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" LogErr\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("     j "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' raises an error")]),t._v("\nokay"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nDebug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"i="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" i\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\nLogErr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nMsgBox LogErrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyModule"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyProc1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vbExclamation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Error "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Stop")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" LogErrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n           "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" sModule "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n           "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" sProc "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n           Err "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ErrObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Purpose: write error number, description and Erl to log file and return error text")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" sLogFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" sLogFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Path "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PathSeparator "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LogErrors.txt"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" sLogTxt  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" lFile    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Create error text")]),t._v("\n  sLogTxt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sModule "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" sProc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|Erl "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Erl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|Err "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Description\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n  lFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" FreeFile\n\n  Open sLogFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" Append "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" lFile\n  Print "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("#")]),t._v("lFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Format"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Now"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yy.mm.dd hh:mm:ss "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("; sLogTxt\n      Print "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("#")]),t._v("lFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Close lFile\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Return error text")]),t._v("\n  LogErrors "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sLogTxt\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),a("p",[t._v("'"),a("strong",[t._v("Additional Code to show log file")])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ShowLogFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" sLogFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" sLogFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Path "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PathSeparator "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LogErrors.txt"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GoTo")]),t._v(" LogErr\nShell "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"notepad.exe "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" sLogFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vbNormalFocus\n\nokay"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\nLogErr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nMsgBox LogErrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyModule"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ShowLogFile"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vbExclamation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Error No "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Number\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" okay\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"checking-time-of-execution"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#checking-time-of-execution"}},[t._v("#")]),t._v(" Checking time of execution")]),t._v(" "),a("p",[t._v("Different procedures can give out the same result, but they would use different processing time. In order to check out which one is faster, a code like this can be used:")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[t._v("time1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Timer\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" iCell "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" MyRange\n   iCell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" iCell\n\ntime2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Timer\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("\n   MyRange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" i\n\ntime3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Timer\n\ndebug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("print "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Proc1 time: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("cStr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("time2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("time1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndebug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("print "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Proc2 time: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("cStr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("time3"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("time2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),a("p",[a("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/office/ff700515(v=office.14).aspx#Anchor_5",target:"_blank",rel:"noopener noreferrer"}},[t._v("MicroTimer"),a("OutboundLink")],1),t._v(":")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" PtrSafe "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" getFrequency "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Kernel32"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Alias")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"QueryPerformanceFrequency"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cyFrequency "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Currency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" PtrSafe "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" getTickCount "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Kernel32"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Alias")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"QueryPerformanceCounter"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cyTickCount "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Currency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" MicroTimer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" cyTicks1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Currency")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Static")]),t._v(" cyFrequency "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Currency")]),t._v("\n\n    MicroTimer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" cyFrequency "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" getFrequency cyFrequency        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Get frequency")]),t._v("\n    getTickCount cyTicks1                                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Get ticks")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" cyFrequency "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" MicroTimer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cyTicks1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" cyFrequency "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Returns Seconds")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"using-with-blocks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-with-blocks"}},[t._v("#")]),t._v(" Using With blocks")]),t._v(" "),a("p",[t._v("Using with blocks can accelerate the process of running a macro. Instead writing a range, chart name, worksheet, etc. you can use with-blocks like below;")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" ActiveChart\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Width "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Height "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("145")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Top "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("77.5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("165")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("step")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" replacer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Left "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" \n\n")])])]),a("p",[t._v("Which is faster than this:")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[t._v("ActiveChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Width "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),t._v("\nActiveChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Height "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("145")]),t._v("\nActiveChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Top "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("77.5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("165")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("step")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" replacer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v("\nActiveChart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Left "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n\n")])])]),a("p",[t._v("Notes:")]),t._v(" "),a("li",[t._v("\nOnce a With block is entered, object can't be changed. As a result, you can't use a single With statement to affect a number of different objects\n")]),t._v(" "),a("li",[t._v("\n**Don't jump into or out of With blocks**. If statements in a With block are executed, but either the With or End With statement is not executed, **a temporary variable containing a reference to the object remains in memory until you exit the procedure**\n")]),t._v(" "),a("li",[t._v("\nDon't Loop inside With statements, especially if the cached object is used as an iterator\n")]),t._v(" "),a("li",[t._v("\nYou can nest With statements by placing one With block within another. However, because members of outer With blocks are masked within the inner With blocks, you must provide a fully qualified object reference in an inner With block to any member of an object in an outer With block.\n")]),t._v(" "),a("p",[t._v("Nesting Example:")]),t._v(" "),a("p",[t._v("This example uses the With statement to execute a series of statements on a single object."),a("br"),t._v("\nThe object and its properties are generic names used for illustration purposes only.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" MyObject \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Height "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Same as MyObject.Height = 100. ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Caption "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello World"')]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'Same as MyObject.Caption = "Hello World". ')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Font \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Red            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Same as MyObject.Font.Color = Red. ")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Bold "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Same as MyObject.Font.Bold = True. ")]),t._v("\n        MyObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Height "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Inner-most With refers to MyObject.Font (must be qualified")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n\n")])])]),a("p",[t._v("More Info on "),a("a",{attrs:{href:"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/with-statement",target:"_blank",rel:"noopener noreferrer"}},[t._v("MSDN"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"row-deletion-performance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#row-deletion-performance"}},[t._v("#")]),t._v(" Row Deletion - Performance")]),t._v(" "),a("li",[t._v("\nDeleting rows is slow, specially when looping through cells and deleting rows, one by one\n")]),t._v(" "),a("li",[t._v("\nA different approach is using an AutoFilter to hide the rows to be deleted\n")]),t._v(" "),a("li",[t._v("\nCopy the visible range and Paste it into a new WorkSheet\n")]),t._v(" "),a("li",[t._v("\nRemove the initial sheet entirely\n")]),t._v(" "),a("li",[t._v("\nWith this method, the more rows to delete, the faster it will be\n")]),t._v(" "),a("p",[t._v("Example:")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Deleted rows: 775,153, Total Rows: 1,000,009, Duration: 1.87 sec")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DeleteRows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" oldWs "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newWs "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" wsName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ur "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" oldWs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ActiveSheet\n    wsName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ur "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"F2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Rows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"F"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlUp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" newWs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("After"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("oldWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Create a new WorkSheet")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" ur    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Copy visible range after Autofilter (modify Criteria1 and 2 accordingly)")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AutoFilter Field"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Criteria1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<>0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Operator")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlAnd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Criteria2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<>"')]),t._v("\n        oldWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UsedRange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Copy\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Paste all visible data into the new WorkSheet (values and formats)")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" newWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UsedRange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Address"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PasteSpecial xlPasteColumnWidths\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PasteSpecial xlPasteAll\n        newWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" newWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Copy\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Application\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CutCopyMode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayAlerts "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n            oldWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Delete\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayAlerts "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n    newWs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wsName\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"disabling-all-excel-functionality-before-executing-large-macros"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#disabling-all-excel-functionality-before-executing-large-macros"}},[t._v("#")]),t._v(" Disabling All Excel Functionality Before executing large macros")]),t._v(" "),a("p",[t._v("The procedures bellow will temporarily disable all Excel features at WorkBook and WorkSheet level")]),t._v(" "),a("li",[t._v("\nFastWB() is a toggle that accepts On or Off flags\n")]),t._v(" "),a("li",[t._v("\nFastWS() accepts an Optional WorkSheet object, or none\n")]),t._v(" "),a("li",[t._v("\nIf the ws parameter is missing it will turn all features on and off for all WorkSheets in the collection\n"),a("ul",[t._v("\n- A custom type can be used to capture all settings before turning them off\n- At the end of the process, the initial settings can be restored\n"),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" FastWB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Optional")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" opt "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Application\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Calculation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" IIf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" xlCalculationManual"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" xlCalculationAutomatic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayAlerts "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayAlerts "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayStatusBar "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayStatusBar "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableAnimations "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableAnimations "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableEvents "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableEvents "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n    FastWS "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opt\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" FastWS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Optional")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" ws "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Optional")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" opt "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" ws "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" ws "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets\n            OptimiseWS ws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opt\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        OptimiseWS ws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opt\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" OptimiseWS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" ws "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" opt "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" ws\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayPageBreaks "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableCalculation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableFormatConditionsCalculation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnablePivotTable "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" opt\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("p",[t._v("Restore all Excel settings to default")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" XlResetSettings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'default Excel settings")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Application\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Calculation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" xlCalculationAutomatic\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayAlerts "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayStatusBar "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableAnimations "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableEvents "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" sh "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" sh "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" sh\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayPageBreaks "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableCalculation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnableFormatConditionsCalculation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EnablePivotTable "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("h4",{attrs:{id:"remarks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[t._v("#")]),t._v(" Remarks")]),t._v(" "),a("p",[t._v("*) Line numbers represent are integers, that is a signed 16 bit data type in the range of -32,768 to 32,767, otherwise you produce an overflow. Usually line numbers are inserted in steps of 10 over a part of the code or all procedures of a module as a whole.")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);