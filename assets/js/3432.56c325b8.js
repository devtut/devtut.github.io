(window.webpackJsonp=window.webpackJsonp||[]).push([[3432],{3840:function(t,s,e){"use strict";e.r(s);var a=e(31),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"object-oriented-vba"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#object-oriented-vba"}},[t._v("#")]),t._v(" Object-Oriented VBA")]),t._v(" "),e("h2",{attrs:{id:"abstraction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#abstraction"}},[t._v("#")]),t._v(" Abstraction")]),t._v(" "),e("h3",{attrs:{id:"abstraction-levels-help-determine-when-to-split-things-up"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#abstraction-levels-help-determine-when-to-split-things-up"}},[t._v("#")]),t._v(" Abstraction levels help determine when to split things up.")]),t._v(" "),e("p",[t._v("Abstraction is achieved by implementing functionality with increasingly detailed code. The entry point of a macro should be a small procedure with a "),e("strong",[t._v("high abstraction level")]),t._v(" that makes it easy to grasp at a glance what's going on:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" SomeForm\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateViewModel\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Show vbModal            \n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n        ProcessUserData "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("The "),e("code",[t._v("DoSomething")]),t._v(" procedure has a high "),e("strong",[t._v("abstraction level")]),t._v(": we can tell that it's displaying a form and creating some model, and passing that object to some "),e("code",[t._v("ProcessUserData")]),t._v(" procedure that knows what to do with it - how the model is created is the job of another procedure:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" CreateViewModel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" result "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" result "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SomeModel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Create"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Now"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Environ"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UserName"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    result"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetAvailableItems\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" CreateViewModel "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" result\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),e("p",[t._v("The "),e("code",[t._v("CreateViewModel")]),t._v(" function is only responsible for creating some "),e("code",[t._v("ISomeModel")]),t._v(" instance. Part of that responsibility is to acquire an array of "),e("strong",[t._v("available items")]),t._v(" - how these items are acquired is an implementation detail that's abstracted behind the "),e("code",[t._v("GetAvailableItems")]),t._v(" procedure:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetAvailableItems"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n    GetAvailableItems "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DataSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Names"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AvailableItems"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RefersToRange\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),e("p",[t._v("Here the procedure is reading the available values from a named range on a "),e("code",[t._v("DataSheet")]),t._v(" worksheet. It could just as well be reading them from a database, or the values could be hard-coded: it's an "),e("strong",[t._v("implementation detail")]),t._v(" that's none of a concern for any of the higher abstraction levels.")]),t._v(" "),e("h2",{attrs:{id:"encapsulation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#encapsulation"}},[t._v("#")]),t._v(" Encapsulation")]),t._v(" "),e("h3",{attrs:{id:"encapsulation-hides-implementation-details-from-client-code"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#encapsulation-hides-implementation-details-from-client-code"}},[t._v("#")]),t._v(" Encapsulation hides implementation details from client code.")]),t._v(" "),e("p",[t._v("The "),e("a",{attrs:{href:"http://stackoverflow.com/documentation/vba/5351/user-forms/19037/handling-queryclose#t=201608091819108848528",target:"_blank",rel:"noopener noreferrer"}},[t._v("Handling QueryClose"),e("OutboundLink")],1),t._v(" example demonstrates encapsulation: the form has a checkbox control, but its client code doesn't work with it directly - the checkbox is an "),e("strong",[t._v("implementation detail")]),t._v(", what the client code needs to know is whether the setting is enabled or not.")]),t._v(" "),e("p",[t._v("When the checkbox value changes, the handler assigns a private field member:")]),t._v(" "),e("blockquote"),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v(" TView\n    IsCancelled "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    SomeOtherSetting "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'other properties skipped for brievety")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" this "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" TView\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'...")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" SomeOtherSettingInput_Change"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CBool")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SomeOtherSettingInput"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("And when the client code wants to read that value, it doesn't need to worry about a checkbox - instead it simply uses the "),e("code",[t._v("SomeOtherSetting")]),t._v(" property:")]),t._v(" "),e("blockquote"),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" SomeOtherSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    SomeOtherSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n")])])]),e("p",[t._v("The "),e("code",[t._v("SomeOtherSetting")]),t._v(" property "),e("strong",[t._v("encapsulates")]),t._v(" the checkbox' state; client code doesn't need to know that there's a checkbox involved, only that there's a setting with a Boolean value. By "),e("strong",[t._v("encapsulating")]),t._v(" the "),e("code",[t._v("Boolean")]),t._v(" value, we've added an "),e("strong",[t._v("abstraction layer")]),t._v(" around the checkbox.")]),t._v(" "),e("h3",{attrs:{id:"using-interfaces-to-enforce-immutability"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-interfaces-to-enforce-immutability"}},[t._v("#")]),t._v(" Using interfaces to enforce immutability")]),t._v(" "),e("p",[t._v("Let's push that a step further by "),e("strong",[t._v("encapsulating")]),t._v(" the form's "),e("strong",[t._v("model")]),t._v(" in a dedicated class module. But if we made a "),e("code",[t._v("Public Property")]),t._v(" for the "),e("code",[t._v("UserName")]),t._v(" and "),e("code",[t._v("Timestamp")]),t._v(", we would have to expose "),e("code",[t._v("Property Let")]),t._v(" accessors, making the properties mutable, and we don't want the client code to have the ability to change these values after they're set.")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("CreateViewModel")]),t._v(" function in the "),e("strong",[t._v("Abstraction")]),t._v(" example returns an "),e("code",[t._v("ISomeModel")]),t._v(" class: that's our "),e("strong",[t._v("interface")]),t._v(", and it looks something like this:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" Timestamp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" UserName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" AvailableItems"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" AvailableItems"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByRef")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" SomeSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" SomeSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" SomeOtherSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" SomeOtherSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n")])])]),e("p",[t._v("Notice "),e("code",[t._v("Timestamp")]),t._v(" and "),e("code",[t._v("UserName")]),t._v(" properties only expose a "),e("code",[t._v("Property Get")]),t._v(" accessor. Now the "),e("code",[t._v("SomeModel")]),t._v(" class can implement that interface:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Implements")]),t._v(" ISomeModel\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v(" TModel\n    Timestamp "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("\n    UserName "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    SomeSetting "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    SomeOtherSetting "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    AvailableItems "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" this "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" TModel\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeModel_Timestamp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("\n    ISomeModel_Timestamp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Timestamp\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeModel_UserName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    ISomeModel_UserName "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UserName\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeModel_AvailableItems"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n    ISomeModel_AvailableItems "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" ISomeModel_AvailableItems"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByRef")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeModel_SomeSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    ISomeModel_SomeSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeSetting\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" ISomeModel_SomeSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeModel_SomeOtherSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    ISomeModel_SomeOtherSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" ISomeModel_SomeOtherSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" Timestamp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("\n    Timestamp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Timestamp\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" Timestamp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Timestamp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" UserName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    UserName "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UserName\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" UserName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UserName "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" AvailableItems"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n    AvailableItems "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" AvailableItems"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByRef")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" SomeSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    SomeSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeSetting\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" SomeSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" SomeOtherSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    SomeOtherSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" SomeOtherSetting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n")])])]),e("p",[t._v("The interface members are all "),e("code",[t._v("Private")]),t._v(", and all members of the interface must be implemented for the code to compile. The "),e("code",[t._v("Public")]),t._v(" members are not part of the interface, and are therefore not exposed to code written against the "),e("code",[t._v("ISomeModel")]),t._v(" interface.")]),t._v(" "),e("h3",{attrs:{id:"using-a-factory-method-to-simulate-a-constructor"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-a-factory-method-to-simulate-a-constructor"}},[t._v("#")]),t._v(" Using a "),e("strong",[t._v("Factory Method")]),t._v(" to simulate a constructor")]),t._v(" "),e("p",[t._v("Using a "),e("a",{attrs:{href:"http://stackoverflow.com/documentation/vba/5321/attributes/18932/vb-predeclaredid#t=201608091940164849835",target:"_blank",rel:"noopener noreferrer"}},[t._v("VB_PredeclaredId"),e("OutboundLink")],1),t._v(" attribute, we can make the "),e("code",[t._v("SomeModel")]),t._v(" class have a "),e("strong",[t._v("default instance")]),t._v(", and write a function that works like a type-level ("),e("code",[t._v("Shared")]),t._v(" in VB.NET, "),e("code",[t._v("static")]),t._v(" in C#) member that the client code can call without needing to first create an instance, like we did here:")]),t._v(" "),e("blockquote"),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" CreateViewModel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" result "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" result "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SomeModel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Create"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Now"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Environ"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UserName"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    result"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetAvailableItems\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" CreateViewModel "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" result\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),e("p",[t._v("This "),e("strong",[t._v("factory method")]),t._v(" assigns the property values that are read-only when accessed from the "),e("code",[t._v("ISomeModel")]),t._v(" interface, here "),e("code",[t._v("Timestamp")]),t._v(" and "),e("code",[t._v("UserName")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" Create"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" pTimeStamp "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" pUserName "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" SomeModel\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Timestamp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pTimeStamp\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UserName "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pUserName\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" Create "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Self\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" Self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" Self "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n")])])]),e("p",[t._v("And now we can code against the "),e("code",[t._v("ISomeModel")]),t._v(" interface, which exposes "),e("code",[t._v("Timestamp")]),t._v(" and "),e("code",[t._v("UserName")]),t._v(" as read-only properties that can never be reassigned (as long as the code is written against the interface).")]),t._v(" "),e("h2",{attrs:{id:"polymorphism"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#polymorphism"}},[t._v("#")]),t._v(" Polymorphism")]),t._v(" "),e("h3",{attrs:{id:"polymorphism-is-the-ability-to-present-the-same-interface-for-different-underlying-implementations"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#polymorphism-is-the-ability-to-present-the-same-interface-for-different-underlying-implementations"}},[t._v("#")]),t._v(" Polymorphism is the ability to present the same interface for different underlying implementations.")]),t._v(" "),e("p",[t._v("The ability to implement interfaces allows completely decoupling the application logic from the UI, or from the database, or from this or that worksheet.")]),t._v(" "),e("p",[t._v("Say you have an "),e("code",[t._v("ISomeView")]),t._v(" interface that the form itself implements:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" IsCancelled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" Model"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" Model"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Show"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("The form's code-behind could look like this:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Implements")]),t._v(" ISomeView\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v(" TView\n    IsCancelled "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    Model "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" this "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" TView\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeView_IsCancelled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    ISomeView_IsCancelled "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeView_Model"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ISomeView_Model "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ISomeView_Model"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ISomeView_Show"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Show vbModal\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" SomeOtherSettingInput_Change"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CBool")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SomeOtherSettingInput"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'...other event handlers...")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" OkButton_Click"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hide\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" CancelButton_Click"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hide\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" UserForm_QueryClose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Cancel "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CloseMode "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" CloseMode "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" VbQueryClose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vbFormControlMenu "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        Cancel "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hide\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("But then, nothing forbids creating another class module that implements the "),e("code",[t._v("ISomeView")]),t._v(" interface "),e("strong",[t._v("without being a user form")]),t._v(" - this could be a "),e("code",[t._v("SomeViewMock")]),t._v(" class:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Implements")]),t._v(" ISomeView\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v(" TView\n    IsCancelled "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    Model "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" this "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" TView\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" IsCancelled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    IsCancelled "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" IsCancelled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeView_IsCancelled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    ISomeView_IsCancelled "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeView_Model"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ISomeView_Model "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ISomeView_Model"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ISomeView_Show"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'do nothing")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("And now we can change the code that works with a "),e("code",[t._v("UserForm")]),t._v(" and make it work off the "),e("code",[t._v("ISomeView")]),t._v(" interface, e.g. by giving it the form as a parameter instead of instantiating it:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" view "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeView"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" view\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateViewModel\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Show\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n        ProcessUserData "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("Because the "),e("code",[t._v("DoSomething")]),t._v(" method depends on an interface (i.e. an "),e("strong",[t._v("abstraction")]),t._v(") and not a "),e("strong",[t._v("concrete class")]),t._v(" (e.g. a specific "),e("code",[t._v("UserForm")]),t._v("), we can write an automated unit test that ensures that "),e("code",[t._v("ProcessUserData")]),t._v(" isn't executed when "),e("code",[t._v("view.IsCancelled")]),t._v(" is "),e("code",[t._v("True")]),t._v(", by making our test create a "),e("code",[t._v("SomeViewMock")]),t._v(" instance, setting its "),e("code",[t._v("IsCancelled")]),t._v(" property to "),e("code",[t._v("True")]),t._v(", and passing it to "),e("code",[t._v("DoSomething")]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"testable-code-depends-on-abstractions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#testable-code-depends-on-abstractions"}},[t._v("#")]),t._v(" Testable code depends on abstractions")]),t._v(" "),e("p",[t._v("Writing unit tests in VBA can be done, there are add-ins out there that even integrate it into the IDE. But when code is "),e("strong",[t._v("tightly coupled")]),t._v(" with a worksheet, a database, a form, or the file system, then the unit test starts requiring an actual worksheet, database, form, or file system - and these "),e("strong",[t._v("dependencies")]),t._v(" are new out-of-control failure points that testable code should isolate, so that unit tests "),e("strong",[t._v("don't")]),t._v(" require an actual worksheet, database, form, or file system.")]),t._v(" "),e("p",[t._v("By writing code against interfaces, in a way that allows test code to "),e("strong",[t._v("inject")]),t._v(" stub/mock implementations (like the above "),e("code",[t._v("SomeViewMock")]),t._v(' example), you can write tests in a  "controlled environment", and simulate what happens when every single one of the 42 possible permutations of user interactions on the form\'s data, without even once displaying a form and manually clicking on a form control.')])])}),[],!1,null,null,null);s.default=n.exports}}]);