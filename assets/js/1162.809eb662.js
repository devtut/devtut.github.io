(window.webpackJsonp=window.webpackJsonp||[]).push([[1162],{1570:function(e,t,r){"use strict";r.r(t);var a=r(31),o=Object(a.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"worktrees"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#worktrees"}},[e._v("#")]),e._v(" Worktrees")]),e._v(" "),r("h2",{attrs:{id:"using-a-worktree"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#using-a-worktree"}},[e._v("#")]),e._v(" Using a worktree")]),e._v(" "),r("p",[e._v("You are right in the middle of working on a new feature, and your boss comes in demanding that you fix something immediately. You may typically want use "),r("code",[e._v("git stash")]),e._v(" to store your changes away temporarily. However, at this point your working tree is in a state of disarray (with new, moved, and removed files, and other bits and pieces strewn around) and you don't want to disturb your progress.")]),e._v(" "),r("p",[e._v("By adding a worktree, you create a temporary linked working tree to make the emergency fix, remove it when done, and then resume your earlier coding session:")]),e._v(" "),r("div",{staticClass:"language-git extra-class"},[r("pre",{pre:!0,attrs:{class:"language-git"}},[r("code",[r("span",{pre:!0,attrs:{class:"token command"}},[e._v("$ git worktree add"),r("span",{pre:!0,attrs:{class:"token parameter"}},[e._v(" -b")]),e._v(" emergency-fix ../temp master")]),e._v("\n$ pushd ../temp\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ... work work work ...")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token command"}},[e._v("$ git commit"),r("span",{pre:!0,attrs:{class:"token parameter"}},[e._v(" -a")]),r("span",{pre:!0,attrs:{class:"token parameter"}},[e._v(" -m")]),e._v(" ")]),r("span",{pre:!0,attrs:{class:"token string"}},[e._v("'emergency fix for boss'")]),e._v("\n$ popd\n$ rm -rf ../temp\n"),r("span",{pre:!0,attrs:{class:"token command"}},[e._v("$ git worktree prune")]),e._v("\n\n")])])]),r("p",[e._v("NOTE: In this example, the fix still is in the emergency-fix branch. At this point you probably want to "),r("code",[e._v("git merge")]),e._v(" or "),r("code",[e._v("git format-patch")]),e._v(" and afterwards remove the emergency-fix branch.")]),e._v(" "),r("h2",{attrs:{id:"moving-a-worktree"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#moving-a-worktree"}},[e._v("#")]),e._v(" Moving a worktree")]),e._v(" "),r("p",[e._v("Currently (as of version 2.11.0) there is no built-in functionality to move an already existing worktree. This is listed as an official bug (see "),r("a",{attrs:{href:"https://git-scm.com/docs/git-worktree#_bugs",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://git-scm.com/docs/git-worktree#_bugs)"),r("OutboundLink")],1),e._v(").")]),e._v(" "),r("p",[e._v("To get around this limitation it is possible to perform manual operations directly in the "),r("code",[e._v(".git")]),e._v(" reference files.")]),e._v(" "),r("p",[e._v("In this example, the main copy of the repo is living at "),r("code",[e._v("/home/user/project-main")]),e._v(" and the secondary worktree is located at "),r("code",[e._v("/home/user/project-1")]),e._v(" and we want to move it to "),r("code",[e._v("/home/user/project-2")]),e._v(".")]),e._v(" "),r("p",[e._v("Don't perform any git command in between these steps, otherwise the garbage collector might be triggered and the references to the secondary tree can be lost. Perform these steps from the start until the end without interruption:")]),e._v(" "),r("li",[r("p",[e._v("Change the worktree's `.git` file to point to the new location inside the main\ntree. The file `/home/user/project-1/.git` should now contain the following:")]),e._v(" "),r("div",{staticClass:"language-git extra-class"},[r("pre",{pre:!0,attrs:{class:"language-git"}},[r("code",[e._v("gitdir: /home/user/project-main/.git/worktrees/project-2\n\n")])])])]),e._v(" "),r("li",[e._v("\nRename the worktree inside the `.git` directory of the main project by moving the worktree's directory that exists in there:\n"),r("div",{staticClass:"language-git extra-class"},[r("pre",{pre:!0,attrs:{class:"language-git"}},[r("code",[e._v("$ mv /home/user/project-main/.git/worktrees/project-1 /home/user/project-main/.git/worktrees/project-2\n\n")])])])]),e._v(" "),r("li",[e._v("\nChange the reference inside `/home/user/project-main/.git/worktrees/project-2/gitdir` to point to the new location. In this example, the file would have the following contents:\n"),r("div",{staticClass:"language-git extra-class"},[r("pre",{pre:!0,attrs:{class:"language-git"}},[r("code",[e._v("/home/user/project-2/.git\n\n")])])])]),e._v(" "),r("li",[e._v("\nFinally, move your worktree to the new location:\n"),r("div",{staticClass:"language-git extra-class"},[r("pre",{pre:!0,attrs:{class:"language-git"}},[r("code",[e._v("$ mv /home/user/project-1 /home/user/project-2\n\n")])])])]),e._v(" "),r("p",[e._v("If you have done everything correctly, listing the existing worktrees should refer to the new location:")]),e._v(" "),r("div",{staticClass:"language-git extra-class"},[r("pre",{pre:!0,attrs:{class:"language-git"}},[r("code",[r("span",{pre:!0,attrs:{class:"token command"}},[e._v("$ git worktree list")]),e._v("\n/home/user/project-main  23f78ad [master]\n/home/user/project-2     78ac3f3 [branch-name]\n\n")])])]),r("p",[e._v("It should now also be safe to run "),r("code",[e._v("git worktree prune")]),e._v(".")]),e._v(" "),r("h4",{attrs:{id:"syntax"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#syntax"}},[e._v("#")]),e._v(" Syntax")]),e._v(" "),r("ul",[r("li",[e._v("git worktree add [-f] [--detach] [--checkout] [-b "),r("new-branch",[e._v("] "),r("path",[e._v(" ["),r("branch",[e._v("]")])],1)])],1),e._v(" "),r("li",[e._v("git worktree prune [-n] [-v] [--expire "),r("expire",[e._v("]")])],1),e._v(" "),r("li",[e._v("git worktree list [--porcelain]")])]),e._v(" "),r("h4",{attrs:{id:"parameters"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#parameters"}},[e._v("#")]),e._v(" Parameters")]),e._v(" "),r("table",[r("thead",[r("tr",[r("th",[e._v("Parameter")]),e._v(" "),r("th",[e._v("Details")])])]),e._v(" "),r("tbody",[r("tr",[r("td",[e._v("-f --force")]),e._v(" "),r("td",[e._v("By default, add refuses to create a new working tree when "),r("code",[e._v("<branch>")]),e._v(" is already checked out by another working tree. This option overrides that safeguard.")])]),e._v(" "),r("tr",[r("td",[e._v("-b "),r("code",[e._v("<new-branch>")]),e._v(" -B "),r("code",[e._v("<new-branch>")])]),e._v(" "),r("td",[e._v("With add, create a new branch named "),r("code",[e._v("<new-branch>")]),e._v(" starting at "),r("code",[e._v("<branch>")]),e._v(", and check out "),r("code",[e._v("<new-branch>")]),e._v(" into the new working tree. If "),r("code",[e._v("<branch>")]),e._v(" is omitted, it defaults to "),r("code",[e._v("HEAD")]),e._v(". By default, "),r("code",[e._v("-b")]),e._v(" refuses to create a new branch if it already exists. "),r("code",[e._v("-B")]),e._v(" overrides this safeguard, resetting "),r("code",[e._v("<new-branch>")]),e._v(" to "),r("code",[e._v("<branch>")]),e._v(".")])]),e._v(" "),r("tr",[r("td",[e._v("--detach")]),e._v(" "),r("td",[e._v("With add, detach "),r("code",[e._v("HEAD")]),e._v(" in the new working tree.")])]),e._v(" "),r("tr",[r("td",[e._v("--[no-] checkout")]),e._v(" "),r("td",[e._v("By default, add checks out "),r("code",[e._v("<branch>")]),e._v(", however, "),r("code",[e._v("--no-checkout")]),e._v(" can be used to suppress checkout in order to make customizations, such as configuring sparse-checkout.")])]),e._v(" "),r("tr",[r("td",[e._v("-n --dry-run")]),e._v(" "),r("td",[e._v("With prune, do not remove anything; just report what it would remove.")])]),e._v(" "),r("tr",[r("td",[e._v("--porcelain")]),e._v(" "),r("td",[e._v("With list, output in an easy-to-parse format for scripts. This format will remain stable across Git versions and regardless of user configuration.")])]),e._v(" "),r("tr",[r("td",[e._v("-v --verbose")]),e._v(" "),r("td",[e._v("With prune, report all removals.")])]),e._v(" "),r("tr",[r("td",[e._v("--expire "),r("code",[e._v("<time>")])]),e._v(" "),r("td",[e._v("With prune, only expire unused working trees older than "),r("code",[e._v("<time>")]),e._v(".")])])])]),e._v(" "),r("h4",{attrs:{id:"remarks"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[e._v("#")]),e._v(" Remarks")]),e._v(" "),r("p",[e._v("See the official documentation for more information: "),r("a",{attrs:{href:"https://git-scm.com/docs/git-worktree",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://git-scm.com/docs/git-worktree"),r("OutboundLink")],1),e._v(".")])])}),[],!1,null,null,null);t.default=o.exports}}]);