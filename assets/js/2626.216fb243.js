(window.webpackJsonp=window.webpackJsonp||[]).push([[2626],{3034:function(e,t,a){"use strict";a.r(t);var s=a(31),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"sending-email"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sending-email"}},[e._v("#")]),e._v(" Sending Email")]),e._v(" "),a("p",[e._v("A useful technique for Exchange Server administrators is to be able to send email messages via SMTP from PowerShell. Depending on the version of PowerShell installed on your computer or server, there are multiple ways to send emails via powershell. There is a native cmdlet option that is simple and easy to use. It uses the cmdlet "),a("strong",[a("strong",[e._v("Send-MailMessage")])]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"send-mailmessage-with-predefined-parameters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#send-mailmessage-with-predefined-parameters"}},[e._v("#")]),e._v(" Send-MailMessage with predefined parameters")]),e._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$parameters")]),e._v(" = @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("From")]),e._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'from@bar.com'")]),e._v("\n    To = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'to@bar.com'")]),e._v("\n    Subject = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Email Subject'")]),e._v("\n    Attachments =  @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'C:\\files\\samplefile1.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'C:\\files\\samplefile2.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    BCC = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'bcc@bar.com'")]),e._v("\n    Body = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Email body'")]),e._v("\n    BodyAsHTML = "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("$False")]),e._v("\n    CC = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'cc@bar.com'")]),e._v("\n    Credential = "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("Get-Credential")]),e._v("\n    DeliveryNotificationOption = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'onSuccess'")]),e._v("\n    Encoding = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'UTF8'")]),e._v("\n    Port = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'25'")]),e._v("\n    Priority = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'High'")]),e._v("\n    SmtpServer = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'smtp.com'")]),e._v("\n    UseSSL = "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("$True")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Notice: Splatting requires @ instead of $ in front of variable name")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("Send-MailMessage")]),e._v(" @parameters\n\n")])])]),a("h2",{attrs:{id:"simple-send-mailmessage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#simple-send-mailmessage"}},[e._v("#")]),e._v(" Simple Send-MailMessage")]),e._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("Send-MailMessage")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("From")]),e._v(" sender@bar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("com "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Subject "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Email Subject"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("To receiver@bar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("com "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("SmtpServer smtp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("com\n\n")])])]),a("h2",{attrs:{id:"smtpclient-mail-with-txt-file-in-body-message"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#smtpclient-mail-with-txt-file-in-body-message"}},[e._v("#")]),e._v(" SMTPClient - Mail with .txt file in body message")]),e._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Define the txt which will be in the email body")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Txt_File")]),e._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"c:\\file.txt"')]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),e._v(" Send_mail "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#Define Email settings")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$EmailFrom")]),e._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"source@domain.com"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$EmailTo")]),e._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"destination@domain.com"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Txt_Body")]),e._v(" = "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("Get-Content")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Txt_File")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("RAW\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Body")]),e._v(" = "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Body_Custom")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("+")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Txt_Body")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Subject")]),e._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Email Subject"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$SMTPServer")]),e._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"smtpserver.domain.com"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$SMTPClient")]),e._v(" = "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("New-Object")]),e._v(" Net"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Mail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("SmtpClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$SmtpServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" 25"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" \n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$SMTPClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("EnableSsl = "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("$false")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$SMTPClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$EmailFrom")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$EmailTo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Subject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Body_Custom")]),e._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"This is what contain file.txt : "')]),e._v("\n\nSend_mail\n\n")])])]),a("h4",{attrs:{id:"parameters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parameters"}},[e._v("#")]),e._v(" Parameters")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Parameter")]),e._v(" "),a("th",[e._v("Details")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("Attachments<String[]>")]),e._v(" "),a("td",[e._v("Path and file names of files to be attached to the message. Paths and filenames can be piped to Send-MailMessage.")])]),e._v(" "),a("tr",[a("td",[e._v("Bcc<String[]>")]),e._v(" "),a("td",[e._v("Email addresses that receive a copy of an email message but does not appear as a recipient in the message. Enter names (optional) and the email address (required), such as Name someone@example.com or someone@example.com.")])]),e._v(" "),a("tr",[a("td",[e._v("Body <String_>")]),e._v(" "),a("td",[e._v("Content of the email message.")])]),e._v(" "),a("tr",[a("td",[e._v("BodyAsHtml")]),e._v(" "),a("td",[e._v("It indicates that the content is in HTML format.")])]),e._v(" "),a("tr",[a("td",[e._v("Cc<String[]>")]),e._v(" "),a("td",[e._v("Email addresses that receive a copy of an email message. Enter names (optional) and the email address (required), such as Name someone@example.com or someone@example.com.")])]),e._v(" "),a("tr",[a("td",[e._v("Credential")]),e._v(" "),a("td",[e._v("Specifies a user account that has permission to send message from specified email address. The default is the current user. Enter name such as User or Domain\\User, or enter a PSCredential object.")])]),e._v(" "),a("tr",[a("td",[e._v("DeliveryNotificationOption")]),e._v(" "),a("td",[e._v("Specifies the delivery notification options for the email message. Multiple values can be specified. Delivery notifications are sent in message to address specified in To parameter. Acceptable values: None, OnSuccess, OnFailure, Delay, Never.")])]),e._v(" "),a("tr",[a("td",[e._v("Encoding")]),e._v(" "),a("td",[e._v("Encoding for the body and subject. Acceptable values: ASCII, UTF8, UTF7, UTF32, Unicode, BigEndianUnicode, Default, OEM.")])]),e._v(" "),a("tr",[a("td",[e._v("From")]),e._v(" "),a("td",[e._v("Email addresses from which the mail is sent. Enter names (optional) and the email address (require), such as Name someone@example.com or someone@example.com.")])]),e._v(" "),a("tr",[a("td",[e._v("Port")]),e._v(" "),a("td",[e._v("Alternate port on the SMTP server. The default value is 25. Available from Windows PowerShell 3.0.")])]),e._v(" "),a("tr",[a("td",[e._v("Priority")]),e._v(" "),a("td",[e._v("Priority of the email message. Acceptable values: Normal, High, Low.")])]),e._v(" "),a("tr",[a("td",[e._v("SmtpServer")]),e._v(" "),a("td",[e._v("Name of the SMTP server that sends the email message. Default value is the value of the $PSEmailServer variable.")])]),e._v(" "),a("tr",[a("td",[e._v("Subject")]),e._v(" "),a("td",[e._v("Subject of the email message.")])]),e._v(" "),a("tr",[a("td",[e._v("To")]),e._v(" "),a("td",[e._v("Email addresses to which the mail is sent. Enter names (optional) and the email address (required), such as Name someone@example.com or someone@example.com")])]),e._v(" "),a("tr",[a("td",[e._v("UseSsl")]),e._v(" "),a("td",[e._v("Uses the Secure Sockets Layer (SSL) protocol to establish a connection to the remote computer to send mail")])])])])])}),[],!1,null,null,null);t.default=n.exports}}]);