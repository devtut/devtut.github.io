(window.webpackJsonp=window.webpackJsonp||[]).push([[1088],{1496:function(t,s,a){"use strict";a.r(s);var n=a(31),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"methods-for-finding-the-last-used-row-or-column-in-a-worksheet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#methods-for-finding-the-last-used-row-or-column-in-a-worksheet"}},[t._v("#")]),t._v(" Methods for Finding the Last Used Row or Column in a Worksheet")]),t._v(" "),a("h2",{attrs:{id:"find-the-last-non-empty-cell-in-a-column"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find-the-last-non-empty-cell-in-a-column"}},[t._v("#")]),t._v(" Find the Last Non-Empty Cell in a Column")]),t._v(" "),a("p",[t._v("In this example, we will look at a method for returning the last non-empty row in a column for a data set.")]),t._v(" "),a("p",[t._v("This method will work regardless of empty regions within the data set.")]),t._v(" "),a("p",[t._v("However "),a("strong",[a("strong",[t._v("caution")]),t._v(" should be used if "),a("strong",[t._v("merged cells")]),t._v(" are involved")]),t._v(", as the "),a("code",[t._v("End")]),t._v(' method will be "stopped" against a merged region, returning the first cell of the merged region.')]),t._v(" "),a("p",[t._v("In addition non-empty cells in "),a("strong",[a("strong",[t._v("hidden rows")])]),t._v(" will not be taken into account.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" FindingLastRow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" wS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" LastRow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" wS "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Here we look in Column A")]),t._v("\n    LastRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Rows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlUp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print LastRow\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("p",[t._v("To address the limitations indicated above, the line:\n"),a("br"),a("code",[t._v('LastRow = wS.Cells(wS.Rows.Count, "A").End(xlUp).Row')])]),t._v(" "),a("p",[t._v("may be replaced with:")]),t._v(" "),a("li",[a("p",[t._v('for last used row of `"Sheet1"`:\n'),a("br"),t._v("`LastRow = wS.UsedRange.Row - 1 + wS.UsedRange.Rows.Count`.")])]),t._v(" "),a("li",[t._v('\nfor last non-empty cell of Column `"A"` in `"Sheet1"`:\n'),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LastRow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Step")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IsEmpty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" i\n LastRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i\n\n")])])])]),t._v(" "),a("h2",{attrs:{id:"find-the-last-non-empty-row-in-worksheet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find-the-last-non-empty-row-in-worksheet"}},[t._v("#")]),t._v(" Find the Last Non-Empty Row in Worksheet")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Get_Last_Used_Row_Index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" wS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" wS "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print LastRow_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print LastRow_0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("p",[t._v("You can choose between 2 options,\nregarding if you want to know if there is no data in the worksheet :")]),t._v(" "),a("ul",[a("li",[t._v("NO : Use LastRow_1 : You can use it directly within "),a("code",[t._v("wS.Cells(LastRow_1(wS),...)")])]),t._v(" "),a("li",[t._v("YES : Use LastRow_0 : You need to test if the result you get from the function is 0 or not before using it")])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" LastRow_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" wS\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WorksheetFunction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CountA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            LastRow_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("What"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                After"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                Lookat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlPart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                LookIn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlFormulas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                SearchOrder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlByRows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                SearchDirection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlPrevious"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                MatchCase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n            LastRow_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" LastRow_0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    LastRow_0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("What"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            After"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            Lookat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlPart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            LookIn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlFormulas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            SearchOrder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlByRows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            SearchDirection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlPrevious"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            MatchCase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"find-the-last-non-empty-column-in-worksheet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find-the-last-non-empty-column-in-worksheet"}},[t._v("#")]),t._v(" Find the Last Non-Empty Column in Worksheet")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Get_Last_Used_Row_Index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" wS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" wS "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print LastCol_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print LastCol_0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("p",[t._v("You can choose between 2 options,\nregarding if you want to know if there is no data in the worksheet :")]),t._v(" "),a("ul",[a("li",[t._v("NO : Use LastCol_1 : You can use it directly within "),a("code",[t._v("wS.Cells(...,LastCol_1(wS))")])]),t._v(" "),a("li",[t._v("YES : Use LastCol_0 : You need to test if the result you get from the function is 0 or not before using it")])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" LastCol_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" wS\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WorksheetFunction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CountA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            LastCol_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("What"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                After"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                Lookat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlPart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                LookIn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlFormulas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                SearchOrder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlByColumns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                SearchDirection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlPrevious"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                MatchCase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Column\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n            LastCol_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),a("p",[t._v("The Err object's properties are automatically reset to zero upon function exit.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" LastCol_0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    LastCol_0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("What"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            After"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            Lookat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlPart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            LookIn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlFormulas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            SearchOrder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlByColumns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            SearchDirection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlPrevious"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                            MatchCase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Column\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"find-the-last-non-empty-cell-in-a-row"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find-the-last-non-empty-cell-in-a-row"}},[t._v("#")]),t._v(" Find the Last Non-Empty Cell in a Row")]),t._v(" "),a("p",[t._v("In this example, we will look at a method for returning the last non-empty column in a row.")]),t._v(" "),a("p",[t._v("This method will work regardless of empty regions within the data set.")]),t._v(" "),a("p",[t._v("However "),a("strong",[a("strong",[t._v("caution")]),t._v(" should be used if "),a("strong",[t._v("merged cells")]),t._v(" are involved")]),t._v(", as the "),a("code",[t._v("End")]),t._v(' method will be "stopped" against a merged region, returning the first cell of the merged region.')]),t._v(" "),a("p",[t._v("In addition non-empty cells in "),a("strong",[a("strong",[t._v("hidden columns")])]),t._v(" will not be taken into account.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" FindingLastCol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" wS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" LastCol "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" wS "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Here we look in Row 1")]),t._v("\n    LastCol "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" wS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Columns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xlToLeft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Column\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print LastCol\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"find-last-row-using-named-range"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find-last-row-using-named-range"}},[t._v("#")]),t._v(" Find Last Row Using Named Range")]),t._v(" "),a("p",[t._v("In case you have a Named Range in your Sheet, and you want to dynamically get the last row of that Dynamic Named Range.\nAlso covers cases where the Named Range doesn't start from the first Row.")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" FindingLastRow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" sht "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" LastRow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" FirstRow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" sht "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"form"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'Using Named Range "MyNameRange"')]),t._v("\nFirstRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sht"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyNameRange"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' in case \"MyNameRange\" doesn't start at Row 1")]),t._v("\nLastRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sht"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyNameRange"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Rows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" FirstRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("p",[t._v("Update:\n"),a("br"),t._v("A potential loophole was pointed out by @Jeeped for a a named range with non-contiguous rows as it generates unexpected result. To addresses that issue, the code is revised as below.\n"),a("br"),t._v("Asumptions: targes sheet = "),a("code",[t._v("form")]),t._v(", named range = "),a("code",[t._v("MyNameRange")])]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" FindingLastRow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" rw "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rwMax "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" rw "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" Sheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"form"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyNameRange"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Rows\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" rw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" rwMax "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" rwMax "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    MsgBox "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"Last row of 'MyNameRange' under Sheets 'form': \"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" rwMax\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"get-the-row-of-the-last-cell-in-a-range"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-the-row-of-the-last-cell-in-a-range"}},[t._v("#")]),t._v(" Get the row of the last cell in a range")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'if only one area (not multiple areas):")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A3:D20"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CountLarge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CountLarge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'using .item is also possible")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Debug prints: 20")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'with multiple areas (also works if only one area):")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" rngArea "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" LastRow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A3:D20, E5:I50, H20:R35"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Each")]),t._v(" rngArea "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("In")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Areas\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" rngArea"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rngArea"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CountLarge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" LastRow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" \n            LastRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rngArea"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rngArea"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CountLarge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print LastRow "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Debug prints: 50")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"last-cell-in-range-currentregion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#last-cell-in-range-currentregion"}},[t._v("#")]),t._v(" Last cell in Range.CurrentRegion")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("Range.CurrentRegion")]),a("OutboundLink")],1),t._v(" is a rectangular range area surrounded by empty cells. Blank cells with formulas such as "),a("code",[t._v('=""')]),t._v(" or "),a("code",[t._v("'")]),t._v(" are not considered blank (even by the "),a("a",{attrs:{href:"https://support.microsoft.com/en-us/kb/823838",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("ISBLANK")]),a("OutboundLink")],1),t._v(" Excel function).")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" rng "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lastCell "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" rng "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C3"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CurrentRegion       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' or Set rng = Sheet1.UsedRange.CurrentRegion")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" lastCell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Rows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Columns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"find-the-last-non-empty-cell-in-worksheet-performance-array"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find-the-last-non-empty-cell-in-worksheet-performance-array"}},[t._v("#")]),t._v(" Find the Last Non-Empty Cell in Worksheet - Performance (Array)")]),t._v(" "),a("ul",[a("li",[t._v("The first function, using an array, is "),a("strong",[t._v("much faster")])]),t._v(" "),a("li",[t._v("If called without the optional parameter, will default to "),a("code",[t._v(".ThisWorkbook.ActiveSheet")])]),t._v(" "),a("li",[t._v("If the range is empty will returns "),a("code",[t._v("Cell( 1, 1 )")]),t._v(" as default, instead of "),a("code",[t._v("Nothing")])])]),t._v(" "),a("p",[t._v("Speed:")]),t._v(" "),a("blockquote"),t._v(" "),a("p",[t._v("`GetMaxCell (Array): Duration: 0.0000790063 seconds`"),a("br"),t._v("\n`GetMaxCell (Find ): Duration: 0.0002903480 seconds`")]),t._v("\n.Measured with [MicroTimer](https://msdn.microsoft.com/en-us/library/office/ff700515(v=office.14).aspx#Anchor_5)\n"),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetLastCell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Optional")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" ws "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" uRng "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uArr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" ubR "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ubC "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lRow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" ws "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ws "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ActiveSheet\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" uRng "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UsedRange\n    uArr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" uRng\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" IsEmpty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" GetLastCell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" IsArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" GetLastCell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Column"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    ubR "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" UBound"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  ubC "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" UBound"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" r "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ubR "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Step")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'----------------------------------------------- last row")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ubC "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Step")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" IsError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Trim"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n                    lRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" lRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" lRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" lRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ubR\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ubC "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Step")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'----------------------------------------------- last col")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" r "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" lRow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Step")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" IsError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Trim"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" GetLastCell "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" uRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" uRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Column "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Returns last cell (max row & max col) using Find")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetMaxCell2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Optional")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByRef")]),t._v(" rng "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Using Find")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Const")]),t._v(" NONEMPTY "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" lRow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lCol "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Range\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" rng "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" rng "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ActiveSheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UsedRange\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" WorksheetFunction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CountA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" GetMaxCell2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" rng\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" lRow "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("What"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("NONEMPTY"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" LookIn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlFormulas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                        After"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                        SearchDirection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlPrevious"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                        SearchOrder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlByRows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Not")]),t._v(" lRow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" lCol "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("What"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("NONEMPTY"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" LookIn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlFormulas"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                            After"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                            SearchDirection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlPrevious"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                                            SearchOrder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xlByColumns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" GetMaxCell2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lRow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Row"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lCol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Column"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),a("p",[t._v(".")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/office/ff700515(v=office.14).aspx#Anchor_5",target:"_blank",rel:"noopener noreferrer"}},[t._v("MicroTimer"),a("OutboundLink")],1),t._v(":")]),t._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" PtrSafe "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" getFrequency "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Kernel32"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Alias")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"QueryPerformanceFrequency"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cyFrequency "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Currency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" PtrSafe "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" getTickCount "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Kernel32"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Alias")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"QueryPerformanceCounter"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cyTickCount "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Currency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" MicroTimer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Double")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" cyTicks1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Currency")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Static")]),t._v(" cyFrequency "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Currency")]),t._v("\n\n    MicroTimer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" cyFrequency "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" getFrequency cyFrequency        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Get frequency")]),t._v("\n    getTickCount cyTicks1                                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Get ticks")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" cyFrequency "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" MicroTimer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cyTicks1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" cyFrequency "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'Returns Seconds")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),a("h4",{attrs:{id:"remarks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[t._v("#")]),t._v(" Remarks")]),t._v(" "),a("p",[t._v("You can find a good explanation on why other methods are discouraged/inaccurate here :\n"),a("a",{attrs:{href:"http://stackoverflow.com/a/11169920/4628637",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://stackoverflow.com/a/11169920/4628637"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);