(window.webpackJsonp=window.webpackJsonp||[]).push([[2610],{2956:function(t,a,e){"use strict";e.r(a);var s=e(19),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"powershell-exe-command-line"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#powershell-exe-command-line"}},[t._v("#")]),t._v(" PowerShell.exe Command-Line")]),t._v(" "),e("h2",{attrs:{id:"executing-a-command"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#executing-a-command"}},[t._v("#")]),t._v(" Executing a command")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("-Command")]),t._v(" parameter is used to specify commands to be executed on launch. It supports multiple data inputs.")]),t._v(" "),e("h3",{attrs:{id:"command"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#command"}},[t._v("#")]),t._v(" -Command "),e("string")],1),t._v(" "),e("p",[t._v("You can specify commands to executed on launch as a string. Multiple semicolon "),e("code",[t._v(";")]),t._v("-separated statements may be executed.")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[t._v(">PowerShell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Command "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"(Get-Date).ToShortDateString()"')]),t._v("\n10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("09"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("2016\n\n>PowerShell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Command "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"(Get-Date).ToShortDateString(); 'PowerShell is fun!'\"")]),t._v("\n10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("09"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("2016\nPowerShell is fun"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\n")])])]),e("h3",{attrs:{id:"command-scriptblock"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#command-scriptblock"}},[t._v("#")]),t._v(" -Command { scriptblock }")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("-Command")]),t._v(" parameter also supports a scriptblock input (one or multiple statements wrapped in braces "),e("code",[t._v("{ #code }")]),t._v(". This only works when calling "),e("code",[t._v("PowerShell.exe")]),t._v(" from another Windows PowerShell-session.")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" > powershell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Command "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"This can be useful, sometimes..."')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ToShortDateString"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nThis can be useful"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sometimes"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("09"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("2016\n\n")])])]),e("h3",{attrs:{id:"command-standard-input"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#command-standard-input"}},[t._v("#")]),t._v(" -Command -  (standard input)")]),t._v(" "),e("p",[t._v("You can pass in commands from the standard input by using "),e("code",[t._v("-Command -")]),t._v(". The standard input can come from "),e("code",[t._v("echo")]),t._v(", reading a file, a legacy console application etc.")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[t._v(">"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("echo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello World"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Greetings from PowerShell"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" PowerShell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("NoProfile "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Command "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\nHello World\nGreetings "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" PowerShell\n\n")])])]),e("h2",{attrs:{id:"executing-a-script-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#executing-a-script-file"}},[t._v("#")]),t._v(" Executing a script file")]),t._v(" "),e("p",[t._v("You can specify a file to a "),e("code",[t._v("ps1")]),t._v("-script to execute it's content on launch using the "),e("code",[t._v("-File")]),t._v(" parameter.")]),t._v(" "),e("h3",{attrs:{id:"basic-script"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#basic-script"}},[t._v("#")]),t._v(" Basic script")]),t._v(" "),e("p",[t._v("MyScript.ps1")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ToShortDateString"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello World"')]),t._v("\n\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[t._v(">PowerShell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("File Desktop\\MyScript"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ps1\n10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("09"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("2016\nHello World\n\n")])])]),e("h3",{attrs:{id:"using-parameters-and-arguments"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-parameters-and-arguments"}},[t._v("#")]),t._v(" Using parameters and arguments")]),t._v(" "),e("p",[t._v("You can add parameters and/or arguments after filepath to use them in the script. Arguments will be used as values for undefined/available script-parameters, the rest will be available in the "),e("code",[t._v("$args")]),t._v("-array")]),t._v(" "),e("p",[t._v("MyScript.ps1")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("param")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$Name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello '),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$Name")]),t._v("! Today's date it "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),t._v('.ToShortDateString())"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"First arg: '),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$args")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),t._v('"')]),t._v("\n\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[t._v(">PowerShell"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("File Desktop\\MyScript"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ps1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Name StackOverflow foo\nHello StackOverflow"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" Today's date it 10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("09"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("2016\nFirst arg: foo\n\n")])])]),e("h4",{attrs:{id:"parameters"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#parameters"}},[t._v("#")]),t._v(" Parameters")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Parameter")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("-Help")]),t._v(" "),e("td",[t._v("-?")])]),t._v(" "),e("tr",[e("td",[t._v("-File "),e("FilePath",[t._v(" ["),e("Args",[t._v("]")])],1)],1),t._v(" "),e("td",[t._v("Path to script-file that should be executed and arguments (optional)")])]),t._v(" "),e("tr",[e("td",[t._v("-Command { -")]),t._v(" "),e("td",[e("script-block",[t._v(" [-args "),e("arg-array",[t._v("]")])],1)],1)]),t._v(" "),e("tr",[e("td",[t._v("-EncodedCommand "),e("Base64EncodedCommand")],1),t._v(" "),e("td",[t._v("Base64 encoded commands")])]),t._v(" "),e("tr",[e("td",[t._v("-ExecutionPolicy "),e("ExecutionPolicy")],1),t._v(" "),e("td",[t._v("Sets the execution policy for this process only")])]),t._v(" "),e("tr",[e("td",[t._v("-InputFormat { Text")]),t._v(" "),e("td",[t._v("XML}")])]),t._v(" "),e("tr",[e("td",[t._v("-Mta")]),t._v(" "),e("td",[t._v("PowerShell 3.0+: Runs PowerShell in multi-threaded apartment (STA is default)")])]),t._v(" "),e("tr",[e("td",[t._v("-Sta")]),t._v(" "),e("td",[t._v("PowerShell 2.0: Runs PowerShell in a single-threaded apartment (MTA is default)")])]),t._v(" "),e("tr",[e("td",[t._v("-NoExit")]),t._v(" "),e("td",[t._v("Leaves PowerShell console running after executing the script/command")])]),t._v(" "),e("tr",[e("td",[t._v("-NoLogo")]),t._v(" "),e("td",[t._v("Hides copyright-banner at launch")])]),t._v(" "),e("tr",[e("td",[t._v("-NonInteractive")]),t._v(" "),e("td",[t._v("Hides console from user")])]),t._v(" "),e("tr",[e("td",[t._v("-NoProfile")]),t._v(" "),e("td",[t._v("Avoid loading of PowerShell profiles for machine or user")])]),t._v(" "),e("tr",[e("td",[t._v("-OutputFormat { Text")]),t._v(" "),e("td",[t._v("XML }")])]),t._v(" "),e("tr",[e("td",[t._v("-PSConsoleFile "),e("FilePath")],1),t._v(" "),e("td",[t._v("Loads a pre-created console file that configures the environment (created using "),e("code",[t._v("Export-Console")]),t._v(")")])]),t._v(" "),e("tr",[e("td",[t._v("-Version "),e("Windows",{attrs:{PowerShell:"",version:""}})],1),t._v(" "),e("td",[t._v("Specify a version of PowerShell to run. Mostly used with "),e("code",[t._v("2.0")])])]),t._v(" "),e("tr",[e("td",[t._v("-WindowStyle "),e("style")])])])])])}),[],!1,null,null,null);a.default=n.exports}}]);