(window.webpackJsonp=window.webpackJsonp||[]).push([[3410],{3818:function(t,e,s){"use strict";s.r(e);var a=s(31),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"conditional-compilation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#conditional-compilation"}},[t._v("#")]),t._v(" Conditional Compilation")]),t._v(" "),s("h2",{attrs:{id:"changing-code-behavior-at-compile-time"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#changing-code-behavior-at-compile-time"}},[t._v("#")]),t._v(" Changing code behavior at compile time")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("#Const")]),t._v(" directive is used to define a custom preprocessor constant. These can later be used by "),s("code",[t._v("#If")]),t._v(" to control which blocks of code get compiled and executed.")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#Const DEBUGMODE = 1")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#If DEBUGMODE Then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Const")]),t._v(" filepath "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:\\Users\\UserName\\Path\\To\\File.txt"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Const")]),t._v(" filepath "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\\\server\\share\\path\\to\\file.txt"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#End If")]),t._v("\n\n")])])]),s("p",[t._v("This results in the value of "),s("code",[t._v("filepath")]),t._v(" being set to "),s("code",[t._v('"C:\\Users\\UserName\\Path\\To\\File.txt"')]),t._v(". Removing the "),s("code",[t._v("#Const")]),t._v(" line, or changing it to "),s("code",[t._v("#Const DEBUGMODE = 0")]),t._v(" would result in the "),s("code",[t._v("filepath")]),t._v(" being set to "),s("code",[t._v('"\\\\server\\share\\path\\to\\file.txt"')]),t._v(".")]),t._v(" "),s("p",[s("strong",[t._v("#Const Scope")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("#Const")]),t._v(" directive is only effective for a single code file (module or class). It must be declared for each and every file you wish to use your custom constant in. Alternatively, you can declare a "),s("code",[t._v("#Const")]),t._v(" globally for your project by going to Tools >> [Your Project Name] Project Properties. This will bring up the project properties dialog box where we’ll enter the constant declaration. In the “Conditional Compilation Arguments” box, type in "),s("code",[t._v("[constName] = [value]")]),t._v(". You can enter more than 1 constant by separating them with a colon, like "),s("code",[t._v("[constName1] = [value1] : [constName2] = [value2]")]),t._v(".")]),t._v(" "),s("p",[s("a",{attrs:{href:"http://i.stack.imgur.com/rEY6K.png",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"http://i.stack.imgur.com/rEY6K.png",alt:"VBA Project Properties Dialog"}}),s("OutboundLink")],1)]),t._v(" "),s("p",[s("strong",[t._v("Pre-defined Constants")])]),t._v(" "),s("p",[t._v("Some compilation constants are already pre-defined. Which ones exist will depend on the bitness of the office version you're running VBA in. Note that Vba7 was introduced alongside Office 2010 to support 64 bit versions of Office.")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Constant")]),t._v(" "),s("th",[t._v("16 bit")]),t._v(" "),s("th",[t._v("32 bit")]),t._v(" "),s("th",[t._v("64 bit")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("Vba6")]),t._v(" "),s("td",[t._v("False")]),t._v(" "),s("td",[t._v("If Vba6")]),t._v(" "),s("td",[t._v("False")])]),t._v(" "),s("tr",[s("td",[t._v("Vba7")]),t._v(" "),s("td",[t._v("False")]),t._v(" "),s("td",[t._v("If Vba7")]),t._v(" "),s("td",[t._v("True")])]),t._v(" "),s("tr",[s("td",[t._v("Win16")]),t._v(" "),s("td",[t._v("True")]),t._v(" "),s("td",[t._v("False")]),t._v(" "),s("td",[t._v("False")])]),t._v(" "),s("tr",[s("td",[t._v("Win32")]),t._v(" "),s("td",[t._v("False")]),t._v(" "),s("td",[t._v("True")]),t._v(" "),s("td",[t._v("True")])]),t._v(" "),s("tr",[s("td",[t._v("Win64")]),t._v(" "),s("td",[t._v("False")]),t._v(" "),s("td",[t._v("False")]),t._v(" "),s("td",[t._v("True")])]),t._v(" "),s("tr",[s("td",[t._v("Mac")]),t._v(" "),s("td",[t._v("False")]),t._v(" "),s("td",[t._v("If Mac")]),t._v(" "),s("td",[t._v("If Mac")])])])]),t._v(" "),s("p",[t._v("Note that Win64/Win32 refer to the Office version, not the Windows version.\nFor example Win32 = TRUE in 32-bit Office, even if the OS is a 64-bit version of Windows.")]),t._v(" "),s("h2",{attrs:{id:"using-declare-imports-that-work-on-all-versions-of-office"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-declare-imports-that-work-on-all-versions-of-office"}},[t._v("#")]),t._v(" Using Declare Imports that work on all versions of Office")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#If Vba7 Then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' It's important to check for Win64 first, ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' because Win32 will also return true when Win64 does.")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#If Win64 Then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" PtrSafe "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFoo64 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exampleLib32"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" LongLong\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" PtrSafe "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFoo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exampleLib32"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#End If")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#Else ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Must be Vba6, the PtrSafe keyword didn't exist back then,")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' so we need to declare Win32 imports a bit differently than above.")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#If Win32 Then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFoo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exampleLib32"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFoo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exampleLib"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#End If")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#End If")]),t._v("\n\n")])])]),s("p",[t._v("This can be simplified a bit depending on what versions of office you need to support. For example, not many people are still supporting 16 bit versions of Office. "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/History_of_Microsoft_Office",target:"_blank",rel:"noopener noreferrer"}},[t._v("The last version of 16 bit office was version 4.3, released in 1994"),s("OutboundLink")],1),t._v(", so the following declaration is sufficient for nearly all modern cases (including Office 2007).")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#If Vba7 Then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' It's important to check for Win64 first, ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' because Win32 will also return true when Win64 does.")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#If Win64 Then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" PtrSafe "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFoo64 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exampleLib32"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" LongLong\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" PtrSafe "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFoo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exampleLib32"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#End If")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#Else ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' Must be Vba6. We don't support 16 bit office, so must be Win32. ")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFoo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exampleLib32"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#End If")]),t._v("\n\n")])])]),s("p",[t._v("If you don't have to support anything older than Office 2010, this declaration works just fine.")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("' We only have 2010 installs, so we already know we have Vba7.")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#If Win64 Then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" PtrSafe "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFoo64 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exampleLib32"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" LongLong\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Declare")]),t._v(" PtrSafe "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetFoo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Lib")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exampleLib32"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive comment"}},[t._v("#End If")]),t._v("\n\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);