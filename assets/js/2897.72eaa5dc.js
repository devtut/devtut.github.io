(window.webpackJsonp=window.webpackJsonp||[]).push([[2897],{3305:function(t,e,s){"use strict";s.r(e);var r=s(31),a=Object(r.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"hierarchical-clustering-with-hclust"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hierarchical-clustering-with-hclust"}},[t._v("#")]),t._v(" Hierarchical clustering with hclust")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("stats")]),t._v(" package provides the "),s("code",[t._v("hclust")]),t._v(" function to perform hierarchical clustering.")]),t._v(" "),s("h2",{attrs:{id:"example-1-basic-use-of-hclust-display-of-dendrogram-plot-clusters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-1-basic-use-of-hclust-display-of-dendrogram-plot-clusters"}},[t._v("#")]),t._v(" Example 1  - Basic use of hclust,  display of dendrogram, plot clusters")]),t._v(" "),s("p",[t._v("The cluster library contains the ruspini data - a standard set of data for illustrating cluster analysis.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\n   library(cluster)                ## to get the ruspini data\n    plot(ruspini, asp=1, pch=20)    ## take a look at the data\n\n")])])]),s("p",[s("a",{attrs:{href:"https://i.stack.imgur.com/pWyXD.png",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://i.stack.imgur.com/pWyXD.png",alt:"Ruspini Data"}}),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("hclust expects a distance matrix,  not the original data. We compute the tree using the default parameters and display it. The hang parameter lines up all of the leaves of the tree along the baseline.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('\n   ruspini_hc_defaults <- hclust(dist(ruspini))\n    dend <- as.dendrogram(ruspini_hc_defaults)\n    if(!require(dendextend)) install.packages("dendextend"); library(dendextend)\n    dend <- color_branches(dend, k = 4) \n    plot(dend)\n\n')])])]),s("p",[s("a",{attrs:{href:"https://i.stack.imgur.com/6SEFG.png",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://i.stack.imgur.com/6SEFG.png",alt:"enter image description here"}}),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("Cut the tree to give four clusters and replot the data coloring the points by cluster. k is the desired number of clusters.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\n   rhc_def_4 = cutree(ruspini_hc_defaults,k=4)\n    plot(ruspini, pch=20, asp=1, col=rhc_def_4)\n\n")])])]),s("p",[s("a",{attrs:{href:"https://i.stack.imgur.com/kb3MZ.png",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://i.stack.imgur.com/kb3MZ.png",alt:"Ruspini data - first clustering"}}),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("This clustering is a little odd.  We can get a better clustering by scaling the data first.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\n   scaled_ruspini_hc_defaults = hclust(dist(scale(ruspini)))\n    srhc_def_4 = cutree(scaled_ruspini_hc_defaults,4)\n    plot(ruspini, pch=20, asp=1, col=srhc_def_4)\n\n")])])]),s("p",[s("a",{attrs:{href:"https://i.stack.imgur.com/oScYH.png",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://i.stack.imgur.com/oScYH.png",alt:"Scaled Ruspini data - clustered"}}),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v('The default dissimilarity measure for comparing clusters is "complete". You can specify a different measure with the method parameter.')]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('\n   ruspini_hc_single = hclust(dist(ruspini), method="single")\n\n')])])]),s("h2",{attrs:{id:"example-2-hclust-and-outliers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-2-hclust-and-outliers"}},[t._v("#")]),t._v(" Example 2 - hclust and outliers")]),t._v(" "),s("p",[t._v("With hierarchical clustering, outliers often show up as one-point clusters.")]),t._v(" "),s("p",[t._v("Generate three Gaussian distributions to illustrate the effect of outliers.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\n   set.seed(656)\n    x = c(rnorm(150, 0, 1), rnorm(150,9,1), rnorm(150,4.5,1))\n    y = c(rnorm(150, 0, 1), rnorm(150,0,1), rnorm(150,5,1))\n    XYdf = data.frame(x,y)\n    plot(XYdf, pch=20)\n\n")])])]),s("p",[s("a",{attrs:{href:"https://i.stack.imgur.com/c5uMw.png",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://i.stack.imgur.com/c5uMw.png",alt:"Test Data"}}),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("Build the cluster structure, split it into three cluster.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('\n   XY_sing = hclust(dist(XYdf), method="single")\n    XYs3 = cutree(XY_sing,k=3)\n    table(XYs3)\n    XYs3\n      1   2   3 \n    448   1   1 \n\n')])])]),s("p",[t._v('hclust found two outliers and put everything else into one big cluster. To get the "real" clusters, you may need to set k higher.')]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\n   XYs6 = cutree(XY_sing,k=6)\n    table(XYs6)\n    XYs6\n      1   2   3   4   5   6 \n    148 150   1 149   1   1 \n    plot(XYdf, pch=20, col=XYs6)\n\n")])])]),s("p",[s("a",{attrs:{href:"https://i.stack.imgur.com/6QIK4.png",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://i.stack.imgur.com/6QIK4.png",alt:"Test data clustered - 3 Outliers & 3 large clusters"}}),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("This "),s("a",{attrs:{href:"http://stackoverflow.com/questions/15376075/cluster-analysis-in-r-determine-the-optimal-number-of-clusters/15376462#15376462",target:"_blank",rel:"noopener noreferrer"}},[t._v("StackOverflow post"),s("OutboundLink")],1),t._v(" has some guidance on how to pick the number of clusters, but be aware of this behavior in hierarchical clustering.")]),t._v(" "),s("h4",{attrs:{id:"remarks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[t._v("#")]),t._v(" Remarks")]),t._v(" "),s("p",[t._v("Besides hclust, other methods are available, see the "),s("a",{attrs:{href:"https://CRAN.R-project.org/view=Cluster",target:"_blank",rel:"noopener noreferrer"}},[t._v("CRAN Package View on Clustering"),s("OutboundLink")],1),t._v(".")])])}),[],!1,null,null,null);e.default=a.exports}}]);