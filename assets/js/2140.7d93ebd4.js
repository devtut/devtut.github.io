(window.webpackJsonp=window.webpackJsonp||[]).push([[2140],{2548:function(t,a,s){"use strict";s.r(a);var e=s(31),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"prepare-statements"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prepare-statements"}},[t._v("#")]),t._v(" PREPARE Statements")]),t._v(" "),s("h2",{attrs:{id:"prepare-execute-and-deallocate-prepare-statements"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prepare-execute-and-deallocate-prepare-statements"}},[t._v("#")]),t._v(" PREPARE, EXECUTE and DEALLOCATE PREPARE Statements")]),t._v(" "),s("p",[s("a",{attrs:{href:"http://dev.mysql.com/doc/refman/5.7/en/prepare.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PREPARE"),s("OutboundLink")],1),t._v(" prepares a statement for execution")]),t._v(" "),s("p",[s("a",{attrs:{href:"http://dev.mysql.com/doc/refman/5.7/en/execute.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("EXECUTE"),s("OutboundLink")],1),t._v(" executes a prepared statement")]),t._v(" "),s("p",[s("a",{attrs:{href:"http://dev.mysql.com/doc/refman/5.7/en/deallocate-prepare.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("DEALLOCATE PREPARE"),s("OutboundLink")],1),t._v(" releases a prepared statement")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@s")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PREPARE")]),t._v(" stmt2 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@s")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@a")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@b")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXECUTE")]),t._v(" stmt2 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@a")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@b")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[t._v("Result:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("------------+")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" hypotenuse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("------------+")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("------------+")]),t._v("\n\n")])])]),s("p",[t._v("Finally,")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEALLOCATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PREPARE")]),t._v(" stmt2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[t._v("Notes:")]),t._v(" "),s("ul",[s("li",[t._v("You must use @variables, not DECLAREd variables for "),s("code",[t._v("FROM @s")])]),t._v(" "),s("li",[t._v("A primary use for Prepare, etc, is to 'construct' a query for situations where binding will not work, such as inserting the table name.")])]),t._v(" "),s("h2",{attrs:{id:"alter-table-with-add-column"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#alter-table-with-add-column"}},[t._v("#")]),t._v(" Alter table with add column")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" v_column_definition :"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CONCAT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  v_column_name\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("v_column_type\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("v_column_options \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@stmt")]),t._v(" :"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CONCAT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ALTER TABLE ADD COLUMN '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" v_column_definition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PREPARE")]),t._v(" stmt "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@stmt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXECUTE")]),t._v(" stmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEALLOCATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PREPARE")]),t._v(" stmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"construct-and-execute"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#construct-and-execute"}},[t._v("#")]),t._v(" Construct and execute")]),t._v(" "),s("p",[t._v("(This is a request for a good example that shows how to "),s("strong",[t._v("construct")]),t._v(" a "),s("code",[t._v("SELECT")]),t._v(" using "),s("code",[t._v("CONCAT")]),t._v(", then prepare+execute it.  Please emphasize the use of @variables versus DECLAREd variables -- it makes a big difference, and it is something that novices (include myself) stumble over.)")]),t._v(" "),s("h4",{attrs:{id:"syntax"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#syntax"}},[t._v("#")]),t._v(" Syntax")]),t._v(" "),s("ul",[s("li",[t._v("PREPARE stmt_name FROM preparable_stmt")]),t._v(" "),s("li",[t._v("EXECUTE stmt_name [USING @var_name [, @var_name] ...]")]),t._v(" "),s("li",[t._v("{DEALLOCATE | DROP} PREPARE stmt_name")])])])}),[],!1,null,null,null);a.default=r.exports}}]);