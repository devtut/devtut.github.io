(window.webpackJsonp=window.webpackJsonp||[]).push([[3436],{3845:function(s,t,a){"use strict";a.r(t);var e=a(31),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"reading-2gb-files-in-binary-in-vba-and-file-hashes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reading-2gb-files-in-binary-in-vba-and-file-hashes"}},[s._v("#")]),s._v(" Reading 2GB+ files in binary in VBA and File Hashes")]),s._v(" "),a("p",[s._v("There is a built in easy way to read files in binary within VBA, however it has a restriction of 2GB (2,147,483,647 bytes - max of Long data type). As technology evolves, this 2GB limit is easily breached. e.g. an ISO image of Operating System install DVD disc. Microsoft does provide a way to overcome this via low level Windows API and here is a backup of it.")]),s._v(" "),a("p",[s._v("Also demonstrate (Read part) for calculating File Hashes without external program like "),a("code",[s._v("fciv.exe")]),s._v(" from Microsoft.")]),s._v(" "),a("h2",{attrs:{id:"this-have-to-be-in-a-class-module-examples-later-referred-as-random"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#this-have-to-be-in-a-class-module-examples-later-referred-as-random"}},[s._v("#")]),s._v(' This have to be in a Class module, examples later referred as "Random"')]),s._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' How To Seek Past VBA's 2GB File Limit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Source: https://support.microsoft.com/en-us/kb/189981 (Archived)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' This must be in a Class Module")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Option")]),s._v(" Explicit\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Enum")]),s._v(" W32F_Errors\n    W32F_UNKNOWN_ERROR "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45600")]),s._v("\n    W32F_FILE_ALREADY_OPEN\n    W32F_PROBLEM_OPENING_FILE\n    W32F_FILE_ALREADY_CLOSED\n    W32F_Problem_seeking\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Enum")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" W32F_SOURCE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Win32File Object"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" GENERIC_WRITE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("&H40000000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" GENERIC_READ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("&H80000000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" FILE_ATTRIBUTE_NORMAL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("&H80")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" CREATE_ALWAYS "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" OPEN_ALWAYS "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" FILE_BEGIN "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" FILE_CURRENT "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" FILE_END "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" FORMAT_MESSAGE_FROM_SYSTEM "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("&H1000")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" FormatMessage "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kernel32"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Alias")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FormatMessageA"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dwFlags "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    lpSource "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dwMessageId "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dwLanguageId "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpBuffer "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" nSize "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    Arguments "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" ReadFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kernel32"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    lpBuffer "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" nNumberOfBytesToRead "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    lpNumberOfBytesRead "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpOverlapped "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" CloseHandle "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kernel32"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hObject "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" WriteFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kernel32"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    lpBuffer "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" nNumberOfBytesToWrite "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    lpNumberOfBytesWritten "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpOverlapped "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" CreateFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kernel32"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Alias")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CreateFileA"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpFileName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dwDesiredAccess "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dwShareMode "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lpSecurityAttributes "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dwCreationDisposition "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dwFlagsAndAttributes "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hTemplateFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" SetFilePointer "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kernel32"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" lDistanceToMove "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    lpDistanceToMoveHigh "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" dwMoveMethod "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Declare")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" FlushFileBuffers "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Lib")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kernel32"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sFName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fAutoFlush "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Boolean")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Property")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Get")]),s._v(" FileHandle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_CLOSED\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    FileHandle "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hFile\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Property")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Property")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Get")]),s._v(" FileName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_CLOSED\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    FileName "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sFName\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Property")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Property")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Get")]),s._v(" IsOpen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Boolean")]),s._v("\n    IsOpen "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" INVALID_HANDLE_VALUE\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Property")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Property")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Get")]),s._v(" AutoFlush"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Boolean")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_CLOSED\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    AutoFlush "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" fAutoFlush\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Property")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Property")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Let")]),s._v(" AutoFlush"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" NewVal "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_CLOSED\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    fAutoFlush "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NewVal\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Property")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" OpenFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" sFileName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_OPEN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sFName\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CreateFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sFileName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" GENERIC_WRITE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Or")]),s._v(" GENERIC_READ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" OPEN_ALWAYS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" FILE_ATTRIBUTE_NORMAL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_PROBLEM_OPENING_FILE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sFileName\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    sFName "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sFileName\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" CloseFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_CLOSED\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    CloseHandle hFile\n    sFName "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n    fAutoFlush "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n    hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" ReadBytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" ByteCount "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Variant")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" BytesRead "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Byte")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_CLOSED\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ReDim")]),s._v(" Bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("To")]),s._v(" ByteCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Byte")]),s._v("\n    ReadFile hFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ByteCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" BytesRead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    ReadBytes "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Bytes\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" WriteBytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DataBytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" fSuccess "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" BytesToWrite "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" BytesWritten "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_CLOSED\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    BytesToWrite "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" UBound"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DataBytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" LBound"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DataBytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    fSuccess "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" WriteFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" DataBytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("LBound"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DataBytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" BytesToWrite"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" BytesWritten"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" fAutoFlush "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" Flush\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Flush"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_CLOSED\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    FlushFileBuffers hFile\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" SeekAbsolute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" HighPos "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" LowPos "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_CLOSED\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    LowPos "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" SetFilePointer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LowPos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" HighPos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" FILE_BEGIN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" SeekRelative"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" Offset "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" TempLow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" TempErr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        RaiseError W32F_FILE_ALREADY_CLOSED\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    TempLow "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" SetFilePointer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" FILE_CURRENT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" TempLow "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        TempErr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("LastDllError\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" TempErr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n            RaiseError W32F_Problem_seeking"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Error "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" TempErr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" vbCrLf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CStr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TempErr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Class_Initialize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INVALID_HANDLE_VALUE\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Class_Terminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" hFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" INVALID_HANDLE_VALUE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" CloseHandle hFile\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" RaiseError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" ErrorCode "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" W32F_Errors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Optional")]),s._v(" sExtra"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" Win32Err "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Win32Text "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    Win32Err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("LastDllError\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" Win32Err "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        Win32Text "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vbCrLf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Error "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Win32Err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" vbCrLf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n        DecodeAPIErrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Win32Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Case")]),s._v(" ErrorCode\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Case")]),s._v(" W32F_FILE_ALREADY_OPEN\n            Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Raise W32F_FILE_ALREADY_OPEN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" W32F_SOURCE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The file \'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" sExtra "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\' is already open."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Win32Text\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Case")]),s._v(" W32F_PROBLEM_OPENING_FILE\n            Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Raise W32F_PROBLEM_OPENING_FILE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" W32F_SOURCE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Error opening \'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" sExtra "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\'."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Win32Text\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Case")]),s._v(" W32F_FILE_ALREADY_CLOSED\n            Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Raise W32F_FILE_ALREADY_CLOSED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" W32F_SOURCE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"There is no open file."')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Case")]),s._v(" W32F_Problem_seeking\n            Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Raise W32F_Problem_seeking"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" W32F_SOURCE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Seek Error."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" vbCrLf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" sExtra\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Case")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n            Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Raise W32F_UNKNOWN_ERROR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" W32F_SOURCE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Unknown error."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Win32Text\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" DecodeAPIErrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" ErrorCode "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" sMessage "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MessageLength "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n    sMessage "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Space"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    MessageLength "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" FormatMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FORMAT_MESSAGE_FROM_SYSTEM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ErrorCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" MessageLength "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        DecodeAPIErrors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Left"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MessageLength"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n        DecodeAPIErrors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Unknown Error."')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v("\n\n")])])]),a("h2",{attrs:{id:"code-for-calculating-file-hash-in-a-standard-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#code-for-calculating-file-hash-in-a-standard-module"}},[s._v("#")]),s._v(" Code for Calculating File Hash in a Standard module")]),s._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" HashTypeMD5 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MD5"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' https://msdn.microsoft.com/en-us/library/system.security.cryptography.md5cryptoserviceprovider(v=vs.110).aspx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" HashTypeSHA1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SHA1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha1cryptoserviceprovider(v=vs.110).aspx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" HashTypeSHA256 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SHA256"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha256cryptoserviceprovider(v=vs.110).aspx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" HashTypeSHA384 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SHA384"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha384cryptoserviceprovider(v=vs.110).aspx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" HashTypeSHA512 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SHA512"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha512cryptoserviceprovider(v=vs.110).aspx")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" uFileSize "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Comment out if not testing performance by FileHashes()")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" FileHashes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" tStart "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" tFinish "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sHash "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" aTestFiles "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Variant")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oTestFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Variant")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" aBlockSizes "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Variant")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oBlockSize "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Variant")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" BLOCKSIZE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' This performs performance testing on different file sizes and block sizes")]),s._v("\n    aBlockSizes "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^12-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^13-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^14-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^15-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^16-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^17-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^18-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^19-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^20-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^21-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^22-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^23-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^24-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^25-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2^26-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    aTestFiles "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C:\\ISO\\clonezilla-live-2.2.2-37-amd64.iso"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C:\\ISO\\HPIP201.2014_0902.29.iso"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C:\\ISO\\SW_DVD5_Windows_Vista_Business_W32_32BIT_English.ISO"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C:\\ISO\\Win10_1607_English_x64.iso"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C:\\ISO\\SW_DVD9_Windows_Svr_Std_and_DataCtr_2012_R2_64Bit_English.ISO"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Print "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Test files: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aTestFiles"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" | "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Print "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"BlockSizes: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aBlockSizes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" | "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Each")]),s._v(" oTestFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("In")]),s._v(" aTestFiles\n        Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Print oTestFile\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Each")]),s._v(" oBlockSize "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("In")]),s._v(" aBlockSizes\n            BLOCKSIZE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Evaluate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oBlockSize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            tStart "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Now\n            sHash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" GetFileHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CStr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oTestFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" BLOCKSIZE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" HashTypeMD5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            tFinish "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Now\n            Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Print sHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" uFileSize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Format"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tFinish "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" tStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hh:mm:ss"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oBlockSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" ("')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" BLOCKSIZE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('")"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" GetFileHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" sFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" uBlockSize "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" sHashType "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Object")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('\' "Scripting.FileSystemObject"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Object")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('\' One of the "CryptoServiceProvider"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Random "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('\' "Random" Class by Microsoft, must be in the same file')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" uBytesRead "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" uBytesToRead "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bDone "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Boolean")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" aBytes "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Variant")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Arrays to store bytes")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" aHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sHash "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Dim uFileSize As Double ' Un-Comment if GetFileHash() is to be used individually")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" Random "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Class by Microsoft: Random")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scripting.FileSystemObject"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"System.Security.Cryptography."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" sHashType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CryptoServiceProvider"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Or")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Or")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        MsgBox "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"One or more required objects cannot be created"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GoTo")]),s._v(" CleanUp\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    \n    uFileSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" oFSO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GetFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Size "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' FILELEN() has 2GB max!")]),s._v("\n    uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    bDone "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n    sHash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("HashSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Each hexadecimal has 4 bits")]),s._v("\n    \n    Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Process the file in chunks of uBlockSize or less")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" uFileSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ReDim")]),s._v(" aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TransformFinalBlock aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        bDone "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" oRnd\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("OpenFile sFile\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Do")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" uBlockSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" uFileSize "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n                    uBytesToRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uBlockSize\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n                    uBytesToRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uFileSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" uBytesRead\n                    bDone "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Read in some bytes")]),s._v("\n                aBytes "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ReadBytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uBytesToRead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                aBlock "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" aBytes\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" bDone "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n                    oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TransformFinalBlock aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" uBytesToRead\n                    uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" uBytesToRead\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n                    uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TransformBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" uBytesToRead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n                DoEvents\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Loop")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Until")]),s._v(" bDone\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CloseFile\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" bDone "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' convert Hash byte array to an hexadecimal string")]),s._v("\n        aHash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hash\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("To")]),s._v(" UBound"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            Mid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Hex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Clean up")]),s._v("\n    oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Clear\nCleanUp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v("\n    GetFileHash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sHash\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v("\n\n")])])]),a("blockquote"),s._v(" "),a("p",[s._v("The output is pretty interesting, my test files indicates that "),a("strong",[a("code",[s._v("BLOCKSIZE = 131071")]),s._v(" (2^17-1)")]),s._v(" gives overall best performance with 32bit Office 2010 on Windows 7 x64, next best is "),a("strong",[s._v("2^16-1 (65535)")]),s._v(". Note "),a("code",[s._v("2^27-1")]),s._v(" yields "),a("strong",[s._v("Out of memory")]),s._v(".")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("File Size (bytes)")]),s._v(" "),a("th",[s._v("File Name")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("146,800,640")]),s._v(" "),a("td",[s._v("clonezilla-live-2.2.2-37-amd64.iso")])]),s._v(" "),a("tr",[a("td",[s._v("798,210,048")]),s._v(" "),a("td",[s._v("HPIP201.2014_0902.29.iso")])]),s._v(" "),a("tr",[a("td",[s._v("2,073,016,320")]),s._v(" "),a("td",[s._v("SW_DVD5_Windows_Vista_Business_W32_32BIT_English.ISO")])]),s._v(" "),a("tr",[a("td",[s._v("4,380,387,328")]),s._v(" "),a("td",[s._v("Win10_1607_English_x64.iso")])]),s._v(" "),a("tr",[a("td",[s._v("5,400,115,200")]),s._v(" "),a("td",[s._v("SW_DVD9_Windows_Svr_Std_and_DataCtr_2012_R2_64Bit_English.ISO")])])])]),s._v(" "),a("h2",{attrs:{id:"calculating-all-files-hash-from-a-root-folder"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#calculating-all-files-hash-from-a-root-folder"}},[s._v("#")]),s._v(" Calculating all Files Hash from a root Folder")]),s._v(" "),a("p",[s._v("Another variation from the code above gives you more performance when you want to get hash codes of all files from a root folder including all sub folders.")]),s._v(" "),a("h3",{attrs:{id:"example-of-worksheet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example-of-worksheet"}},[s._v("#")]),s._v(" "),a("strong",[s._v("Example of Worksheet:")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://i.stack.imgur.com/7wEZ3.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://i.stack.imgur.com/7wEZ3.png",alt:"SampleWorksheet"}}),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"code"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#code"}},[s._v("#")]),s._v(" "),a("strong",[s._v("Code")])]),s._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Option")]),s._v(" Explicit\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" HashTypeMD5 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MD5"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' https://msdn.microsoft.com/en-us/library/system.security.cryptography.md5cryptoserviceprovider(v=vs.110).aspx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" HashTypeSHA1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SHA1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha1cryptoserviceprovider(v=vs.110).aspx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" HashTypeSHA256 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SHA256"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha256cryptoserviceprovider(v=vs.110).aspx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" HashTypeSHA384 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SHA384"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha384cryptoserviceprovider(v=vs.110).aspx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" HashTypeSHA512 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SHA512"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha512cryptoserviceprovider(v=vs.110).aspx")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" BLOCKSIZE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("131071")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' 2^17-1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Object")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Object")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Random "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Requires the Class from Microsoft https://support.microsoft.com/en-us/kb/189981")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" sHashType "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" sRootFDR "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" oRng "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Range\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" uFileCount "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" AllFileHashes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Active-X button calls this")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" oWS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Worksheet\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' | A: FileHash | B: FileSize | C: FileName | D: FilaName and Path | E: File Last Modification Time | F: Time required to calculate has code (seconds)")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" ThisWorkbook\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Clear All old entries on all worksheets")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Each")]),s._v(" oWS "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("In")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheets\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oRng "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Intersect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oWS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("UsedRange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oWS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("UsedRange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Not")]),s._v(" oRng "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" oRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ClearContents\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            sHashType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Trim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Range(A1)")]),s._v("\n            sRootFDR "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Trim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Range(C1) Column B for file size")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sHashType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Or")]),s._v(" Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sRootFDR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oRng "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A3"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' First entry on First Page")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n    \n    uFileCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" Random "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Class by Microsoft: Random")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scripting.FileSystemObject"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Just to get correct FileSize")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"System.Security.Cryptography."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" sHashType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CryptoServiceProvider"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    \n    ProcessFolder oFSO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GetFolder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sRootFDR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    \n    Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("StatusBar "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n    Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n    oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Clear\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oRng "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v("\n    Debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Print "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Total file count: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" uFileCount\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" ProcessFolder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByRef")]),s._v(" oFDR "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" oFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oSubFDR "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sHash "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dStart "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dFinish "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Date")]),s._v("\n    Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Each")]),s._v(" oFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("In")]),s._v(" oFDR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Files\n        uFileCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uFileCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("StatusBar "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uFileCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('": "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Right"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" Len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uFileCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Initialize "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Reinitialize the CryptoServiceProvider")]),s._v("\n        dStart "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Now\n        sHash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" GetFileHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" BLOCKSIZE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sHashType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        dFinish "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Now\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" oRng\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sHash\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" oFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Size "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' File Size in bytes")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" oFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' File name with extension")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" oFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Path "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Full File name and Path")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" FileDateTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Last modification timestamp of file")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dFinish "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" dStart "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Time required to calculate hash code")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" oRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Row "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Rows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Count "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Max rows reached, start on Next sheet")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" oRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Count "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n                MsgBox "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"All rows in all worksheets have been used, please create more sheets"')]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oRng "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ThisWorkbook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Sheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A3"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            oRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Activate\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Move to next row otherwise")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oRng "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" oRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Application.StatusBar = False")]),s._v("\n    Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ScreenUpdating "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n    oRng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Activate\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Each")]),s._v(" oSubFDR "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("In")]),s._v(" oFDR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SubFolders\n        ProcessFolder oSubFDR\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" GetFileHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" sFile "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" uBlockSize "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" sHashType "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" uBytesRead "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" uBytesToRead "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bDone "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Boolean")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" aBytes "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Variant")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Arrays to store bytes")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" aHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sHash "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oTmp "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Variant")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" uFileSize "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Double")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Un-Comment if GetFileHash() is to be used individually")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" Random "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Class by Microsoft: Random")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scripting.FileSystemObject"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Just to get correct FileSize")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"System.Security.Cryptography."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" sHashType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CryptoServiceProvider"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" oFSO "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Or")]),s._v(" oRnd "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Or")]),s._v(" oCSP "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        MsgBox "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"One or more required objects cannot be created"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    \n    uFileSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" oFSO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GetFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Size "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' FILELEN() has 2GB max")]),s._v("\n    uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    bDone "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n    sHash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("HashSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Each hexadecimal is 4 bits")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Process the file in chunks of uBlockSize or less")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" uFileSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ReDim")]),s._v(" aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TransformFinalBlock aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        bDone "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" oRnd\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("On")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Error")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GoTo")]),s._v(" CannotOpenFile\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("OpenFile sFile\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Do")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" uBlockSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" uFileSize "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n                    uBytesToRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uBlockSize\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n                    uBytesToRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uFileSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" uBytesRead\n                    bDone "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Read in some bytes")]),s._v("\n                aBytes "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ReadBytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uBytesToRead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                aBlock "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" aBytes\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" bDone "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n                    oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TransformFinalBlock aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" uBytesToRead\n                    uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" uBytesToRead\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n                    uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uBytesRead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TransformBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" uBytesToRead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" aBlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n                DoEvents\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Loop")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Until")]),s._v(" bDone\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CloseFile\nCannotOpenFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Change the hash code to the Error description")]),s._v("\n                oTmp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Description"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vbCrLf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                sHash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" oTmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('":"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" oTmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" bDone "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' convert Hash byte array to an hexadecimal string")]),s._v("\n        aHash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" oCSP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hash\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("To")]),s._v(" UBound"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            Mid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Hex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aHash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n    GetFileHash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sHash\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v("\n\n")])])]),a("h4",{attrs:{id:"remarks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[s._v("#")]),s._v(" Remarks")]),s._v(" "),a("h3",{attrs:{id:"methods-for-the-class-by-microsoft"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#methods-for-the-class-by-microsoft"}},[s._v("#")]),s._v(" "),a("strong",[s._v("METHODS FOR THE CLASS BY MICROSOFT")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Method Name")]),s._v(" "),a("th",[s._v("Description")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[s._v("IsOpen")])]),s._v(" "),a("td",[s._v("Returns a boolean to indicate whether the file is open.")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("OpenFile")]),s._v("("),a("strong",[s._v("sFileNam")]),s._v("e As String)")]),s._v(" "),a("td",[s._v("Opens the file specified by the sFileName argument.")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("CloseFile")])]),s._v(" "),a("td",[s._v("Closes the currently open file.")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("ReadBytes")]),s._v("("),a("strong",[s._v("ByteCount")]),s._v(" As Long)")]),s._v(" "),a("td",[s._v("Reads ByteCount bytes and returns them in a Variant byte array and moves the pointer.")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("WriteBytes")]),s._v("("),a("strong",[s._v("DataBytes()")]),s._v(" As Byte)")]),s._v(" "),a("td",[s._v("Writes the contents of the byte array to the current position in the file and moves the pointer.")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("Flush")])]),s._v(" "),a("td",[s._v("Forces Windows to flush the write cache.")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("SeekAbsolute")]),s._v("("),a("strong",[s._v("HighPos")]),s._v(" As Long, "),a("strong",[s._v("LowPos")]),s._v(" As Long)")]),s._v(" "),a("td",[s._v("Moves the file pointer to the designated position from the beginning of the file. Though VBA treats the DWORDS as signed values, the API treats them as unsigned. Make the high-order argument non-zero to exceed 4GB. The low-order DWORD will be negative for values between 2GB and 4GB.")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("SeekRelative")]),s._v("("),a("strong",[s._v("Offset")]),s._v(" As Long)")]),s._v(" "),a("td",[s._v("Moves the file pointer up to +/- 2GB from the current location. You can rewrite this method to allow for offsets greater than 2GB by converting a 64-bit signed offset into two 32-bit values.")])])])]),s._v(" "),a("h3",{attrs:{id:"properties-of-the-class-by-microsoft"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#properties-of-the-class-by-microsoft"}},[s._v("#")]),s._v(" "),a("strong",[s._v("PROPERTIES OF THE CLASS BY MICROSOFT")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Property")]),s._v(" "),a("th",[s._v("Description")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[s._v("FileHandle")])]),s._v(" "),a("td",[s._v("The file handle for the currently open file. This is not compatible with VBA file handles.")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("FileName")])]),s._v(" "),a("td",[s._v("The name of the currently open file.")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("AutoFlush")])]),s._v(" "),a("td",[s._v("Sets/indicates whether WriteBytes will automatically call the Flush method.")])])])]),s._v(" "),a("h3",{attrs:{id:"normal-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#normal-module"}},[s._v("#")]),s._v(" "),a("strong",[s._v("NORMAL MODULE")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Function")]),s._v(" "),a("th",[s._v("Notes")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[s._v("GetFileHash")]),s._v("("),a("strong",[s._v("sFile")]),s._v(" As String, "),a("strong",[s._v("uBlockSize")]),s._v(" As Double, "),a("strong",[s._v("sHashType")]),s._v(" As String)")]),s._v(" "),a("td",[s._v("Simply throw in the full path to be hashed, Blocksize to use (number of bytes), and the type of Hash to use - one of the private constants: "),a("strong",[s._v("HashTypeMD5")]),s._v(", "),a("strong",[s._v("HashTypeSHA1")]),s._v(", "),a("strong",[s._v("HashTypeSHA256")]),s._v(", "),a("strong",[s._v("HashTypeSHA384")]),s._v(", "),a("strong",[s._v("HashTypeSHA512")]),s._v(". This was designed to be as generic as possible.")])])])]),s._v(" "),a("p",[s._v("You should un/comment the "),a("strong",[s._v("uFileSize As Double")]),s._v(" accordingly. I have tested MD5 and SHA1.")])])}),[],!1,null,null,null);t.default=n.exports}}]);