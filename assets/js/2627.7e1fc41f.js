(window.webpackJsonp=window.webpackJsonp||[]).push([[2627],{3035:function(t,a,s){"use strict";s.r(a);var e=s(31),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"sharepoint-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sharepoint-module"}},[t._v("#")]),t._v(" SharePoint Module")]),t._v(" "),s("h2",{attrs:{id:"loading-sharepoint-snap-in"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#loading-sharepoint-snap-in"}},[t._v("#")]),t._v(" Loading SharePoint Snap-In")]),t._v(" "),s("p",[t._v("Loading the SharePoint Snapin can be done using the following:")]),t._v(" "),s("p",[s("code",[t._v('Add-PSSnapin "Microsoft.SharePoint.PowerShell"')])]),t._v(" "),s("p",[s("strong",[t._v("This only works in the 64bit version of PowerShell.")]),t._v(' If the window says "Windows PowerShell (x86)" in the title you are using the incorrect version.')]),t._v(" "),s("p",[t._v("If the Snap-In is already loaded, the code above will cause an error. Using the following will load only if necessary, which can be used in Cmdlets/functions:")]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-PSSnapin")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Microsoft.SharePoint.PowerShell"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ErrorAction SilentlyContinue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-eq")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-PSSnapin")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Microsoft.SharePoint.PowerShell"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("p",[t._v("Alternatively, if you start the SharePoint Management Shell, it will automatically include the Snap-In.")]),t._v(" "),s("p",[t._v("To get a list of all the available SharePoint Cmdlets, run the following:")]),t._v(" "),s("p",[s("code",[t._v("Get-Command -Module Microsoft.SharePoint.PowerShell")])]),t._v(" "),s("h2",{attrs:{id:"iterating-over-all-lists-of-a-site-collection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#iterating-over-all-lists-of-a-site-collection"}},[t._v("#")]),t._v(" Iterating over all lists of a site collection")]),t._v(" "),s("p",[t._v("Print out all list names and the item count.")]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$site")]),t._v(" = "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-SPSite")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Identity https:"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mysharepointsite"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sites"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("test\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("foreach")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$web")]),t._v(" in "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$site")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AllWebs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("foreach")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$list")]),t._v(" in "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$web")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Lists"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Prints list title and item count")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Write-Output")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),t._v(", Items: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ItemCount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),t._v('"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$site")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Dispose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"get-all-installed-features-on-a-site-collection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-all-installed-features-on-a-site-collection"}},[t._v("#")]),t._v(" Get all installed features on a site collection")]),t._v(" "),s("p",[s("code",[t._v("Get-SPFeature -Site https://mysharepointsite/sites/test")])]),t._v(" "),s("p",[t._v("Get-SPFeature can also be run on web scope ("),s("code",[t._v("-Web <WebUrl>")]),t._v("), farm scope ("),s("code",[t._v("-Farm")]),t._v(") and web application scope ("),s("code",[t._v("-WebApplication <WebAppUrl>")]),t._v(").")]),t._v(" "),s("p",[s("strong",[t._v("Get all orphaned features on a site collection")])]),t._v(" "),s("p",[t._v("Another usage of Get-SPFeature can be to find all features that have no scope:")]),t._v(" "),s("p",[s("code",[t._v("Get-SPFeature -Site https://mysharepointsite/sites/test |? { $_.Scope -eq $null )")])])])}),[],!1,null,null,null);a.default=n.exports}}]);