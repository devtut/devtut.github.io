(window.webpackJsonp=window.webpackJsonp||[]).push([[1208],{1555:function(t,a,s){"use strict";s.r(a);var e=s(19),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"parsing-html-with-taggy-lens-and-lens"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parsing-html-with-taggy-lens-and-lens"}},[t._v("#")]),t._v(" Parsing HTML with taggy-lens and lens")]),t._v(" "),s("h2",{attrs:{id:"extract-the-text-contents-from-a-div-with-a-particular-id"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#extract-the-text-contents-from-a-div-with-a-particular-id"}},[t._v("#")]),t._v(" Extract the text contents from a div with a particular id")]),t._v(" "),s("p",[t._v("Taggy-lens allows us to use lenses to parse and inspect HTML documents.")]),t._v(" "),s("div",{staticClass:"language-hs extra-class"},[s("pre",{pre:!0,attrs:{class:"language-hs"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("#!/")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("usr")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("bin")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("env")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("stack")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- stack --resolver lts-7.0 --install-ghc runghc --package text --package lens --package taggy-lens")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{-# LANGUAGE OverloadedStrings #-}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("qualified")]),t._v(" Data.Text.Lazy "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" TL")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("qualified")]),t._v(" Data.Text.IO "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" T")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Text.Taggy.Lens")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Control.Lens")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("someHtml")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TL.Text")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("someHtml")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\\n    \\<!doctype html><html><body>\\\n    \\<div>first div</div>\\\n    \\<div id=\\"thediv\\">second div</div>\\\n    \\<div id=\\"not-thediv\\">third div</div>"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("main")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("IO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("main")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("putStrLn")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("someHtml")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^.")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("html")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(" . ")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("allAttributed")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("ix")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(" . ")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("only")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"thediv"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(" . ")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("contents")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"filtering-elements-from-the-tree"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#filtering-elements-from-the-tree"}},[t._v("#")]),t._v(" Filtering elements from the tree")]),t._v(" "),s("p",[t._v("Find div with "),s("code",[t._v('id="article"')]),t._v(" and strip out all the inner script tags.")]),t._v(" "),s("div",{staticClass:"language-hs extra-class"},[s("pre",{pre:!0,attrs:{class:"language-hs"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("#!/")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("usr")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("bin")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("env")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("stack")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- stack --resolver lts-7.1 --install-ghc runghc --package text --package lens --package taggy-lens --package string-class --package classy-prelude")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{-# LANGUAGE NoImplicitPrelude #-}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{-# LANGUAGE OverloadedStrings #-}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" ClassyPrelude")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Control.Lens "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("hiding")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("children")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("element")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Data.String.Class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("toText")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("fromText")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Data.Text")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Text")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Text.Taggy.Lens")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("qualified")]),t._v(" Text.Taggy.Lens "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" Taggy")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token import_statement"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("qualified")]),t._v(" Text.Taggy.Renderer "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" Renderer")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("somehtmlSmall")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Text")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("somehtmlSmall")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<!doctype html><html><body>\\\n    \\<div id=\\"article\\"><div>first</div><div>second</div><script>this should be removed<\/script><div>third</div></div>\\\n    \\</body></html>"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("renderWithoutScriptTag")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Text")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("renderWithoutScriptTag")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("mArticle")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Maybe")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Taggy.Element")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("mArticle")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("fromText")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("somehtmlSmall")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("html")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(" .\n")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("allAttributed")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("ix")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(" . ")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("only")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"article"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("mArticleFiltered")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("fmap")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("transform")]),t._v("\n                     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("children")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%~")]),t._v("\n                      "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("filter")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("n")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("n")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("element")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(" . ")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Just")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"script"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("mArticle")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("maybe")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("toText")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(" . ")]),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("Renderer.render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("mArticleFiltered")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("main")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("IO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("main")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("print")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token hvariable"}},[t._v("renderWithoutScriptTag")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- outputs:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('-- "<div id=\\"article\\"><div>first</div><div>second</div><div>third</div></div>"')]),t._v("\n\n")])])]),s("p",[t._v("Contribution based upon @duplode's "),s("a",{attrs:{href:"http://stackoverflow.com/a/39865972/540810",target:"_blank",rel:"noopener noreferrer"}},[t._v("SO answer"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=r.exports}}]);