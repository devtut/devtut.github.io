(window.webpackJsonp=window.webpackJsonp||[]).push([[3421],{3768:function(e,t,s){"use strict";s.r(t);var a=s(19),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"events"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#events"}},[e._v("#")]),e._v(" Events")]),e._v(" "),s("h2",{attrs:{id:"sources-and-handlers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sources-and-handlers"}},[e._v("#")]),e._v(" Sources and Handlers")]),e._v(" "),s("h3",{attrs:{id:"what-are-events"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#what-are-events"}},[e._v("#")]),e._v(" What are events?")]),e._v(" "),s("p",[e._v("VBA is "),s("strong",[e._v("event-driven")]),e._v(": VBA code runs in response to events raised by the host application or the host document - understanding events is fundamental to understanding VBA.")]),e._v(" "),s("p",[e._v("APIs often expose objects that raise a number of "),s("strong",[e._v("events")]),e._v(" in response to various states. For example an "),s("code",[e._v("Excel.Application")]),e._v(" object raises an event whenever a new workbook is created, opened, activated, or closed. Or whenever a worksheet gets calculated. Or just before a file is saved. Or immediately after. A button on a form raises a "),s("code",[e._v("Click")]),e._v(" event when the user clicks it, the user form itself raises an event just after it's activated, and another just before it's closed.")]),e._v(" "),s("p",[e._v("From an API perspective, events are "),s("strong",[e._v("extension points")]),e._v(": the client code can chose to implement code that "),s("strong",[e._v("handles")]),e._v(" these events, and execute custom code whenever these events are fired: that's how you can execute your custom code automatically every time the selection changes on any worksheet - by handling the event that gets fired when the selection changes on any worksheet.")]),e._v(" "),s("p",[e._v("An object that exposes events is an "),s("strong",[e._v("event source")]),e._v(". A method that handles an event is a "),s("strong",[e._v("handler")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"handlers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[e._v("#")]),e._v(" Handlers")]),e._v(" "),s("p",[e._v("VBA document modules (e.g. "),s("code",[e._v("ThisDocument")]),e._v(", "),s("code",[e._v("ThisWorkbook")]),e._v(", "),s("code",[e._v("Sheet1")]),e._v(", etc.) and "),s("code",[e._v("UserForm")]),e._v(" modules are "),s("strong",[e._v("class modules")]),e._v(" that "),s("strong",[e._v("implement")]),e._v(" special interfaces that expose a number of "),s("strong",[e._v("events")]),e._v(". You can browse these interfaces in the left-side dropdown at the top of the code pane:")]),e._v(" "),s("img",{attrs:{src:"http://i.stack.imgur.com/6dSac.png",alt:"ThisWorkbook module implements Workbook events"}}),e._v(" "),s("p",[e._v("The right-side dropdown lists the members of the interface selected in the left-side dropdown:")]),e._v(" "),s("img",{attrs:{src:"http://i.stack.imgur.com/Zbkh9.png",alt:"Worksheet modules can handle Worksheet events"}}),e._v(" "),s("p",[e._v("The VBE automatically generates an event handler stub when an item is selected on the right-side list, or navigates there if the handler exists.")]),e._v(" "),s("p",[e._v("You can define a module-scoped "),s("code",[e._v("WithEvents")]),e._v(" variable in any module:")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WithEvents")]),e._v(" Foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" Workbook\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WithEvents")]),e._v(" Bar "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" Worksheet\n\n")])])]),s("p",[e._v("Each "),s("code",[e._v("WithEvents")]),e._v(" declaration becomes available to select from the left-side dropdown. When an event is selected in the right-side dropdown, the VBE generates an event handler stub named after the "),s("code",[e._v("WithEvents")]),e._v(" object and the name of the event, joined with an underscore:")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WithEvents")]),e._v(" Foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" Workbook\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WithEvents")]),e._v(" Bar "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" Worksheet\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v(" Foo_Open"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v(" Bar_SelectionChange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ByVal")]),e._v(" Target "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" Range"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n")])])]),s("p",[e._v("Only types that expose at least one event can be used with "),s("code",[e._v("WithEvents")]),e._v(", and "),s("code",[e._v("WithEvents")]),e._v(" declarations cannot be assigned a reference on-the-spot with the "),s("code",[e._v("New")]),e._v(" keyword. This code is illegal:")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WithEvents")]),e._v(" Foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("New")]),e._v(" Workbook "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'illegal")]),e._v("\n\n")])])]),s("p",[e._v("The object reference must be "),s("code",[e._v("Set")]),e._v(" explicitly; in a class module, a good place to do that is often in the "),s("code",[e._v("Class_Initialize")]),e._v(" handler, because then the class handles that object's events for as long as its instance exists.")]),e._v(" "),s("h3",{attrs:{id:"sources"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sources"}},[e._v("#")]),e._v(" Sources")]),e._v(" "),s("p",[e._v("Any class module (or document module, or user form) can be an event source. Use the "),s("code",[e._v("Event")]),e._v(" keyword to define the "),s("strong",[e._v("signature")]),e._v(" for the event, in the "),s("strong",[e._v("declarations section")]),e._v(" of the module:")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Public")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Event")]),e._v(" SomethingHappened"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ByVal")]),e._v(" something "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n")])])]),s("p",[e._v("The signature of the event determines how the event is raised, and what the event handlers will look like.")]),e._v(" "),s("p",[e._v("Events can only be "),s("strong",[e._v("raised")]),e._v(" within the class they're defined in - client code can only "),s("strong",[e._v("handle")]),e._v(" them. Events are raised with the "),s("code",[e._v("RaiseEvent")]),e._v(" keyword; the event's arguments are provided at that point:")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Public")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RaiseEvent")]),e._v(" SomethingHappened"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"hello"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n")])])]),s("p",[e._v("Without code that handles the "),s("code",[e._v("SomethingHappened")]),e._v(" event, running the "),s("code",[e._v("DoSomething")]),e._v(" procedure will still raise the event, but nothing will happen. Assuming the event source is the above code in a class named "),s("code",[e._v("Something")]),e._v(", this code in "),s("code",[e._v("ThisWorkbook")]),e._v(' would show a message box saying "hello" whenever '),s("code",[e._v("test.DoSomething")]),e._v(" gets called:")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WithEvents")]),e._v(" test "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" Something\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v(" Workbook_Open"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Set")]),e._v(" test "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("New")]),e._v(" Something\n    test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("DoSomething\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v(" test_SomethingHappened"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ByVal")]),e._v(" bar "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'this procedure runs whenever 'test' raises the 'SomethingHappened' event")]),e._v("\n    MsgBox bar\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n")])])]),s("h2",{attrs:{id:"passing-data-back-to-the-event-source"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#passing-data-back-to-the-event-source"}},[e._v("#")]),e._v(" Passing data back to the event source")]),e._v(" "),s("h3",{attrs:{id:"using-parameters-passed-by-reference"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-parameters-passed-by-reference"}},[e._v("#")]),e._v(" Using parameters passed by reference")]),e._v(" "),s("p",[e._v("An event may define a "),s("code",[e._v("ByRef")]),e._v(" parameter meant to be returned to the caller:")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Public")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Event")]),e._v(" BeforeSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ByRef")]),e._v(" cancel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Boolean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Public")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Event")]),e._v(" AfterSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Public")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" cancel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Boolean")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RaiseEvent")]),e._v(" BeforeSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("cancel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("If")]),e._v(" cancel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Then")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Exit")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'todo: actually do something")]),e._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RaiseEvent")]),e._v(" AfterSomething\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n")])])]),s("p",[e._v("If the "),s("code",[e._v("BeforeSomething")]),e._v(" event has a handler that sets its "),s("code",[e._v("cancel")]),e._v(" parameter to "),s("code",[e._v("True")]),e._v(", then when execution returns from the handler, "),s("code",[e._v("cancel")]),e._v(" will be "),s("code",[e._v("True")]),e._v(" and "),s("code",[e._v("AfterSomething")]),e._v(" will never be raised.")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WithEvents")]),e._v(" foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" Something\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v(" foo_BeforeSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ByRef")]),e._v(" cancel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Boolean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    cancel "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" MsgBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Cancel?"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" vbYesNo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" vbYes\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v(" foo_AfterSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    MsgBox "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Didn\'t cancel!"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n")])])]),s("p",[e._v("Assuming the "),s("code",[e._v("foo")]),e._v(" object reference is assigned somewhere, when "),s("code",[e._v("foo.DoSomething")]),e._v(' runs, a message box prompts whether to cancel, and a second message box says "didn\'t cancel" only when '),s("kbd",[e._v("No")]),e._v(" was selected.")]),e._v(" "),s("h3",{attrs:{id:"using-mutable-objects"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-mutable-objects"}},[e._v("#")]),e._v(" Using mutable objects")]),e._v(" "),s("p",[e._v("You could also pass a copy of a mutable object "),s("code",[e._v("ByVal")]),e._v(", and let handlers modify that object's properties; the caller can then read the modified property values and act accordingly.")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'class module ReturnBoolean")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Option")]),e._v(" Explicit\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" encapsulated "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Boolean")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Public")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Property")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Get")]),e._v(" ReturnValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Boolean")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'Attribute ReturnValue.VB_UserMemId = 0")]),e._v("\n    ReturnValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" encapsulated\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Property")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Public")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Property")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Let")]),e._v(" ReturnValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ByVal")]),e._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Boolean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    encapsulated "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Property")]),e._v("\n\n")])])]),s("p",[e._v("Combined with the "),s("code",[e._v("Variant")]),e._v(" type, this can be used to create rather non-obvious ways to return a value to the caller:")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Public")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Event")]),e._v(" SomeEvent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ByVal")]),e._v(" foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Variant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Public")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" result "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" ReturnBoolean\n    result "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("New")]),e._v(" ReturnBoolean\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RaiseEvent")]),e._v(" SomeEvent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("If")]),e._v(" result "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Then")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("' If result.ReturnValue Then")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'handler changed the value to True")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Else")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'handler didn't modify the value")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("If")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n")])])]),s("p",[e._v("The handler would look like this:")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Private")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v(" source_SomeEvent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ByVal")]),e._v(" foo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Variant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'foo is actually a ReturnBoolean object")]),e._v("\n    foo "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("True")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'True is actually assigned to foo.ReturnValue, the class' default member")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Sub")]),e._v("\n\n")])])]),s("h4",{attrs:{id:"syntax"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#syntax"}},[e._v("#")]),e._v(" Syntax")]),e._v(" "),s("li",[e._v("\n**Source Module**: `[Public] Event [identifier]([argument_list])`\n")]),e._v(" "),s("li",[e._v("\n**Handler Module**: `Dim|Private|Public WithEvents [identifier] As [type]`\n")]),e._v(" "),s("h4",{attrs:{id:"remarks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[e._v("#")]),e._v(" Remarks")]),e._v(" "),s("li",[e._v("\nAn event can only be `Public`. The modifier is optional because class module members (including events) are implicitly `Public` by default.\n")]),e._v(" "),s("li",[e._v("\nA `WithEvents` variable can be `Private` or `Public`, but not `Friend`. The modifier is mandatory because `WithEvents` isn't a keyword that declares a variable, but a modifier keyword part of the variable declaration syntax. Hence the `Dim` keyword must be used if an access modifier isn't present.\n")])])}),[],!1,null,null,null);t.default=n.exports}}]);