(window.webpackJsonp=window.webpackJsonp||[]).push([[3461],{3807:function(s,t,e){"use strict";e.r(t);var a=e(19),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"disposable-objects"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#disposable-objects"}},[s._v("#")]),s._v(" Disposable objects")]),s._v(" "),e("h2",{attrs:{id:"basic-concept-of-idisposable"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#basic-concept-of-idisposable"}},[s._v("#")]),s._v(" Basic concept of IDisposable")]),s._v(" "),e("p",[s._v("Any time you instantiate a class that Implements "),e("code",[s._v("IDisposable")]),s._v(", you should call "),e("code",[s._v(".Dispose")]),e("sup",[s._v("1")]),s._v(" on that class when you have finished using it. This allows the class to clean up any managed or unmanaged dependencies that it may be using. Not doing this could cause a memory leak.")]),s._v(" "),e("p",[s._v("The "),e("code",[s._v("Using")]),s._v(" keyword ensures that "),e("code",[s._v(".Dispose")]),s._v(" is called, without you having to "),e("strong",[s._v("explicitly")]),s._v(" call it.")]),s._v(" "),e("p",[s._v("For example without "),e("code",[s._v("Using")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" sr "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" StreamReader"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C:\\foo.txt"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" line "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sr"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ReadLine\nsr"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Dispose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    \n\n")])])]),e("p",[s._v("Now with "),e("code",[s._v("Using")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v(" sr "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" StreamReader"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C:\\foo.txt"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" line "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sr"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ReadLine\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'.Dispose is called here for you")]),s._v("\n\n")])])]),e("p",[s._v("One major advantage "),e("code",[s._v("Using")]),s._v(" has is when an exception is thrown, because it "),e("strong",[s._v("ensures")]),s._v(" "),e("code",[s._v(".Dispose")]),s._v(" is called.")]),s._v(" "),e("p",[s._v("Consider the following. If an exception is thrown, you need to need to remember to call .Dispose but you might also have to check the state of the object to ensure you don't get a null reference error, etc.")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\n   Dim sr As StreamReader = Nothing\n    Try\n        sr = New StreamReader("C:\\foo.txt")\n        Dim line = sr.ReadLine\n    Catch ex As Exception\n        \'Handle the Exception\n    Finally\n        If sr IsNot Nothing Then sr.Dispose()\n    End Try\n\n')])])]),e("p",[s._v("A using block means you don't have to remember to do this and you can declare your object inside the "),e("code",[s._v("try")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\n   Try\n        Using sr As New StreamReader("C:\\foo.txt")\n            Dim line = sr.ReadLine\n        End Using\n    Catch ex As Exception\n        \'sr is disposed at this point\n    End Try\n\n')])])]),e("p",[e("sup",[s._v("1")]),s._v(" "),e("a",{attrs:{href:"http://blog.jongallant.com/2012/10/do-i-have-to-call-dispose-on-dbcontext.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Do I always have to call Dispose() on my DbContext objects? Nope"),e("OutboundLink")],1)]),s._v(" "),e("h2",{attrs:{id:"declaring-more-objects-in-one-using"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#declaring-more-objects-in-one-using"}},[s._v("#")]),s._v(" Declaring more objects in one Using")]),s._v(" "),e("p",[s._v("Sometimes, you have to create two "),e("code",[s._v("Disposable")]),s._v(" objects in a row. There is an easy way to avoid nesting "),e("code",[s._v("Using")]),s._v(" blocks.")]),s._v(" "),e("p",[s._v("This code")]),s._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v(" File "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" FileStream"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyFile"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" FileMode"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Append"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v(" Writer "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" BinaryWriter"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("File"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'You code here")]),s._v("\n        Writer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Writer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v("\n\n")])])]),e("p",[s._v("can be shortened into this one. The main advantage is that you gain one indentation level:")]),s._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v(" File "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" FileStream"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyFile"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" FileMode"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Append"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Writer "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" BinaryWriter"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("File"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'You code here")]),s._v("\n    Writer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Writer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v("\n\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);