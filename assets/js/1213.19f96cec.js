(window.webpackJsonp=window.webpackJsonp||[]).push([[1213],{1621:function(a,s,t){"use strict";t.r(s);var e=t(31),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"pipes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pipes"}},[a._v("#")]),a._v(" Pipes")]),a._v(" "),t("h2",{attrs:{id:"producers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#producers"}},[a._v("#")]),a._v(" Producers")]),a._v(" "),t("p",[a._v("A "),t("code",[a._v("Producer")]),a._v(" is some monadic action that can "),t("code",[a._v("yield")]),a._v(" values for downstream consumption:")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Producer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Proxy")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("yield")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Monad")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Producer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n")])])]),t("p",[a._v("For example:")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("naturals")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Monad")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Producer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Int")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("naturals")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("each")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- each is a utility function exported by Pipes")]),a._v("\n\n")])])]),t("p",[a._v("We can of course have "),t("code",[a._v("Producer")]),a._v("s that are functions of other values too:")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("naturalsUntil")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Monad")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Int")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Producer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Int")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("naturalsUntil")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("n")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("each")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("..")]),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("n")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n")])])]),t("h2",{attrs:{id:"connecting-pipes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#connecting-pipes"}},[a._v("#")]),a._v(" Connecting Pipes")]),a._v(" "),t("p",[a._v("Use "),t("a",{attrs:{href:"https://hackage.haskell.org/package/pipes-4.2.0/docs/Pipes.html#v:-62--45--62-",target:"_blank",rel:"noopener noreferrer"}},[t("code",[a._v(">->")]),t("OutboundLink")],1),a._v(" to connect "),t("code",[a._v("Producer")]),a._v("s, "),t("code",[a._v("Consumer")]),a._v("s and "),t("code",[a._v("Pipe")]),a._v("s to compose larger "),t("code",[a._v("Pipe")]),a._v(" functions.")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("printNaturals")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("MonadIO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Effect")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("printNaturals")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("naturalsUntil")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("intToStr")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("fancyPrint")]),a._v("\n\n")])])]),t("p",[t("code",[a._v("Producer")]),a._v(", "),t("code",[a._v("Consumer")]),a._v(", "),t("code",[a._v("Pipe")]),a._v(", and "),t("code",[a._v("Effect")]),a._v(" types are all defined in terms of the general "),t("code",[a._v("Proxy")]),a._v(" type. Therefore "),t("a",{attrs:{href:"https://hackage.haskell.org/package/pipes-4.2.0/docs/Pipes.html#v:-62--45--62-",target:"_blank",rel:"noopener noreferrer"}},[t("code",[a._v(">->")]),t("OutboundLink")],1),a._v(" can be used for a variety of purposes. Types defined by the left argument must match the type consumed by the right argument:")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Monad")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Producer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Consumer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Effect")]),a._v("       "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Monad")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Producer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Pipe")]),a._v("     "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Producer")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Monad")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Pipe")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Consumer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Consumer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Monad")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Pipe")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Pipe")]),a._v("     "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Pipe")]),a._v("     "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v("\n\n")])])]),t("h2",{attrs:{id:"pipes-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pipes-2"}},[a._v("#")]),a._v(" Pipes")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://hackage.haskell.org/package/pipes-4.2.0/docs/Pipes.html#g:4",target:"_blank",rel:"noopener noreferrer"}},[a._v("Pipes"),t("OutboundLink")],1),a._v(" can both "),t("code",[a._v("await")]),a._v(" and "),t("code",[a._v("yield")]),a._v(".")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Pipe")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Proxy")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("b")]),a._v("\n\n")])])]),t("p",[a._v("This Pipe awaits an "),t("code",[a._v("Int")]),a._v(" and converts it to a "),t("code",[a._v("String")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("intToStr")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Monad")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Pipe")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Int")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("String")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("intToStr")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("forever")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("await")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("yield")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(".")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("show")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n")])])]),t("h2",{attrs:{id:"running-pipes-with-runeffect"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#running-pipes-with-runeffect"}},[a._v("#")]),a._v(" Running Pipes with runEffect")]),a._v(" "),t("p",[a._v("We use "),t("a",{attrs:{href:"https://hackage.haskell.org/package/pipes-4.2.0/docs/Pipes.html#v:runEffect",target:"_blank",rel:"noopener noreferrer"}},[t("code",[a._v("runEffect")]),t("OutboundLink")],1),a._v(" to run our "),t("code",[a._v("Pipe")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("main")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("IO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("main")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("runEffect")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("naturalsUntil")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("intToStr")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("fancyPrint")]),a._v("\n\n")])])]),t("p",[a._v("Note that "),t("code",[a._v("runEffect")]),a._v(" requires an "),t("code",[a._v("Effect")]),a._v(", which is a self-contained "),t("code",[a._v("Proxy")]),a._v(" with no inputs or outputs:")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("runEffect")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Monad")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Effect")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("r")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Effect")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Proxy")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("X")]),a._v("\n\n")])])]),t("p",[a._v("(where "),t("code",[a._v("X")]),a._v(" is the empty type, also known as "),t("code",[a._v("Void")]),a._v(").")]),a._v(" "),t("h2",{attrs:{id:"consumers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#consumers"}},[a._v("#")]),a._v(" Consumers")]),a._v(" "),t("p",[a._v("A "),t("code",[a._v("Consumer")]),a._v(" can only "),t("code",[a._v("await")]),a._v(" values from upstream.")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Consumer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Proxy")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("X")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("await")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Monad")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Consumer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("a")]),a._v("\n\n")])])]),t("p",[a._v("For example:")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("fancyPrint")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("MonadIO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Consumer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("String")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("fancyPrint")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("forever")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("numStr")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("await")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("liftIO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("putStrLn")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"I received: "')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("numStr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n")])])]),t("h2",{attrs:{id:"the-proxy-monad-transformer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#the-proxy-monad-transformer"}},[a._v("#")]),a._v(" The Proxy monad transformer")]),a._v(" "),t("p",[t("code",[a._v("pipes")]),a._v("'s core data type is the "),t("code",[a._v("Proxy")]),a._v(" monad transformer. "),t("code",[a._v("Pipe")]),a._v(", "),t("code",[a._v("Producer")]),a._v(", "),t("code",[a._v("Consumer")]),a._v(" and so on are defined in terms of "),t("code",[a._v("Proxy")]),a._v(".")]),a._v(" "),t("p",[a._v("Since "),t("code",[a._v("Proxy")]),a._v(" is a monad transformer, definitions of "),t("code",[a._v("Pipe")]),a._v("s take the form of monadic scripts which "),t("code",[a._v("await")]),a._v(" and "),t("code",[a._v("yield")]),a._v(" values, additionally performing effects from the base monad "),t("code",[a._v("m")]),a._v(".")]),a._v(" "),t("h2",{attrs:{id:"combining-pipes-and-network-communication"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#combining-pipes-and-network-communication"}},[a._v("#")]),a._v(" Combining Pipes and Network communication")]),a._v(" "),t("p",[a._v("Pipes supports simple binary communication between a client and a server")]),a._v(" "),t("p",[a._v("In this example:")]),a._v(" "),t("ol",[t("li",[a._v("a client connects and sends a "),t("code",[a._v("FirstMessage")])]),a._v(" "),t("li",[a._v("the server receives and answers "),t("code",[a._v("DoSomething 0")])]),a._v(" "),t("li",[a._v("the client receives and answers "),t("code",[a._v("DoNothing")])]),a._v(" "),t("li",[a._v("step 2 and 3 are repeated indefinitely")])]),a._v(" "),t("p",[a._v("The command data type exchanged over the network:")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- Command.hs")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("{-# LANGUAGE DeriveGeneric #-}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("module")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Command")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" Data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Binary")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" GHC"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Generics")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Generic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("data")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Command")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("FirstMessage")]),a._v("\n           "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DoNothing")]),a._v("\n           "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DoSomething")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Int")]),a._v("\n           "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("deriving")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Show")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Generic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("instance")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Binary")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Command")]),a._v("\n\n")])])]),t("p",[a._v("Here, the server waits for a client to connect:")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("module")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Server")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" Pipes")]),a._v(" \n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("qualified")]),a._v(" Pipes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Binary "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" PipesBinary")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("qualified")]),a._v(" Pipes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Network"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("TCP "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" PNT")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("qualified")]),a._v(" Command "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" C")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("qualified")]),a._v(" Pipes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Parse "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" PP")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("qualified")]),a._v(" Pipes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Prelude "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" PipesPrelude")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("pageSize")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Int")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("pageSize")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("4096")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- pure handler, to be used with PipesPrelude.map")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("pureHandler")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Command")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Command")]),a._v(" \n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("pureHandler")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- answers the same command that we have receveid")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- impure handler, to be used with PipesPremude.mapM")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("sideffectHandler")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("MonadIO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Command")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Command")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("sideffectHandler")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("liftIO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("putStrLn")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"received message = "')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("DoSomething")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("    \n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- whatever incoming command `c` from the client, answer DoSomething 0")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("main")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("IO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("main")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("serve")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("PNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Host")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"23456"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("\\")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("connectionSocket")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("remoteAddress")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n                 "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("putStrLn")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Remote connection from ip = "')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("remoteAddress")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n                 "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("_")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("runEffect")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n                   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("bytesReceiver")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("fromSocket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("connectionSocket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("pageSize")]),a._v("\n                   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("commandDecoder")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("parsed")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PipesBinary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("decode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("bytesReceiver")]),a._v("\n                   "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("commandDecoder")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("PipesPrelude")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("mapM")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("sideffectHandler")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("cat")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PipesBinary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("encode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("toSocket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("connectionSocket")]),a._v("\n                   "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- if we want to use the pureHandler")]),a._v("\n                   "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("--commandDecoder >-> PipesPrelude.map pureHandler >-> for cat PipesBinary.Encode >-> PNT.toSocket connectionSocket")]),a._v("\n                 "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n")])])]),t("p",[a._v("The client connects thus:")]),a._v(" "),t("div",{staticClass:"language-hs extra-class"},[t("pre",{pre:!0,attrs:{class:"language-hs"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("module")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Client")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" Pipes")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("qualified")]),a._v(" Pipes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Binary "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" PipesBinary")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("qualified")]),a._v(" Pipes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Network"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("TCP "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" PNT")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("qualified")]),a._v(" Pipes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Prelude "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" PipesPrelude")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("qualified")]),a._v(" Pipes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Parse "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" PP")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token import-statement"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("qualified")]),a._v(" Command "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" C")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("pageSize")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("Int")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("pageSize")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("4096")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- pure handler, to be used with PipesPrelude.amp")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("pureHandler")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Command")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Command")]),a._v(" \n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("pureHandler")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- answer the same command received from the server")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- inpure handler, to be used with PipesPremude.mapM")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("sideffectHandler")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("MonadIO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Command")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Command")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("sideffectHandler")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("liftIO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("putStrLn")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Received: "')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("c")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("DoNothing")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("-- whatever is received from server, answer DoNothing")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("main")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("IO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("main")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("connect")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"23456"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("\\")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("connectionSocket")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("remoteAddress")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("putStrLn")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Connected to distant server ip = "')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("show")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("remoteAddress")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("sendFirstMessage")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("connectionSocket")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("_")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("runEffect")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("bytesReceiver")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("fromSocket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("connectionSocket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("pageSize")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("commandDecoder")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("parsed")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PipesBinary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("decode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("bytesReceiver")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("commandDecoder")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("PipesPrelude")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("mapM")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("sideffectHandler")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("cat")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PipesBinary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("encode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("toSocket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("connectionSocket")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("sendFirstMessage")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("::")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("PNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Socket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("IO")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("sendFirstMessage")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("s")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("_")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("runEffect")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("$")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("encodedProducer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PipesBinary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("encode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("C"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("FirstMessage")]),a._v(" \n    "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("encodedProducer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">->")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("PNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("toSocket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token hvariable"}},[a._v("s")]),a._v("  \n  "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n")])])]),t("h4",{attrs:{id:"remarks"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[a._v("#")]),a._v(" Remarks")]),a._v(" "),t("p",[a._v("As the "),t("a",{attrs:{href:"https://hackage.haskell.org/package/pipes",target:"_blank",rel:"noopener noreferrer"}},[a._v("hackage page"),t("OutboundLink")],1),a._v(" describes:")]),a._v(" "),t("blockquote"),a._v(" "),t("p",[a._v("pipes is a clean and powerful stream processing library that lets you\nbuild and connect reusable streaming components")]),a._v(" "),t("p",[a._v('Programs implemented through streaming can often be succinct and composable, with simple, short functions allowing you to "slot in or out" features easily with the backing of the  Haskell type system.')]),a._v(" "),t("p",[t("code",[a._v("await :: Monad m => Consumer' a m a")])]),a._v(" "),t("p",[a._v("Pulls a value from upstream, where "),t("code",[a._v("a")]),a._v(" is our input type.")]),a._v(" "),t("p",[t("code",[a._v("yield :: Monad m => a -> Producer' a m ()")])]),a._v(" "),t("p",[a._v("Produce a value, where "),t("code",[a._v("a")]),a._v(" is the output type.")]),a._v(" "),t("p",[a._v("It's highly recommended you read through the embedded "),t("a",{attrs:{href:"https://hackage.haskell.org/package/pipes-4.2.0/docs/Pipes-Tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[a._v("Pipes.Tutorial")]),t("OutboundLink")],1),a._v(" package which gives an excellent overview of the core concepts of Pipes and how "),t("code",[a._v("Producer")]),a._v(", "),t("code",[a._v("Consumer")]),a._v(" and "),t("code",[a._v("Effect")]),a._v(" interact.")])])}),[],!1,null,null,null);s.default=r.exports}}]);