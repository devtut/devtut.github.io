(window.webpackJsonp=window.webpackJsonp||[]).push([[3486],{3894:function(e,a,s){"use strict";s.r(a);var t=s(31),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"random"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#random"}},[e._v("#")]),e._v(" Random")]),e._v(" "),s("p",[e._v("The Random class is used to generate non-negative pseudo-random integers that are not truly random, but are for general purposes close enough.")]),e._v(" "),s("p",[e._v("The sequence is calculated using an initial number (called the "),s("strong",[e._v("Seed")]),e._v(") In earlier versions of .net, this seed number was the same every time an application was run. So what would happen was that you would get the same sequence of pseudo-random numbers every time the application was executed. Now, the seed is based on the time the object is declared.")]),e._v(" "),s("h2",{attrs:{id:"declaring-an-instance"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#declaring-an-instance"}},[e._v("#")]),e._v(" Declaring an instance")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" rng "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("New")]),e._v(" Random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n")])])]),s("p",[e._v("This declares an instance of the Random class called "),s("code",[e._v("rng")]),e._v(". In this case, the current time at the point where the object is created is used to calculate the seed. This is the most common usage, but has its own problems as we shall see later in the remarks")]),e._v(" "),s("p",[e._v("Instead of allowing the program to use the current time as part of the calculation for the initial seed number, you can specify the initial seed number. This can be any 32 bit integer literal, constant or variable. See below for examples. Doing this means that your instance will generate the same sequence of pseudo-random numbers, which can be useful in certain situations.")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" rng "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("New")]),e._v(" Random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("43352")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n")])])]),s("p",[e._v("or")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" rng "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("New")]),e._v(" Random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n")])])]),s("p",[e._v("where "),s("code",[e._v("x")]),e._v(" has been declared elsewhere in your program as an Integer constant or variable.")]),e._v(" "),s("h2",{attrs:{id:"generate-a-random-number-from-an-instance-of-random"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generate-a-random-number-from-an-instance-of-random"}},[e._v("#")]),e._v(" Generate a random number from an instance of Random")]),e._v(" "),s("p",[e._v("The following example declares a new instance of the Random class and then uses the method "),s("code",[e._v(".Next")]),e._v(" to generate the next number in the sequence of pseudo-random numbers.")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" rnd "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("New")]),e._v(" Random\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" x "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Integer")]),e._v("\nx "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" rnd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Next")]),e._v("\n\n")])])]),s("p",[e._v("The last line above will generate the next pseudo-random number and assign it to "),s("code",[e._v("x")]),e._v(". This number will be in the range of 0 - 2147483647. However, you can also specify the range of numbers to be generated as in the example below.")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[e._v("x "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" rnd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Next")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n")])])]),s("p",[e._v("Please note however, that using these parameters, range of numbers will be between 15 or above and 199 or below.")]),e._v(" "),s("p",[e._v("You can also generate floating point numbers of the type Double by using "),s("code",[e._v(".NextDouble")]),e._v(" e.g")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" rnd "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("New")]),e._v(" Random\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" y "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Double")]),e._v("\ny "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" rnd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("NextDouble"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n")])])]),s("p",[e._v("You cannot however specify a range for this. It will always be in the range of 0.0 to less than 1.0.")]),e._v(" "),s("h4",{attrs:{id:"remarks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[e._v("#")]),e._v(" Remarks")]),e._v(" "),s("p",[e._v("Finally, a note about randomization. As mentioned earlier, when you declare an instance of "),s("code",[e._v("Random")]),e._v(" without any parameters, the constructor will use the current time as part of the calculation to create the initial seed number. Normally this is OK.")]),e._v(" "),s("p",[e._v("However. If you re-declare new instances over a very short space of time, each time the seed number is calculated, the time could be the same. Consider this code.")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("For")]),e._v(" i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Integer")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("To")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100000")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" rnd "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("New")]),e._v(" Random\n    x "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" rnd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Next")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Next")]),e._v("\n\n")])])]),s("p",[e._v("Because computers are very quick these days, this code will take a fraction of a second to run and on several dequential iterations of the loop, the system time will not have changed. So, the seed number will not change and the random number will be the same. If you want to generate lots of random numbers, declare the instance of random outside the loop in this simple example.")]),e._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" rnd "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("New")]),e._v(" Random\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("For")]),e._v(" i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Integer")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("To")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100000")]),e._v("\n    x "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" rnd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Next")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Next")]),e._v("\n\n")])])]),s("p",[s("strong",[e._v("The basic rule of thumb is don't re-instantiate random number generator over short periods of time.")])])])}),[],!1,null,null,null);a.default=n.exports}}]);