(window.webpackJsonp=window.webpackJsonp||[]).push([[2615],{3023:function(e,t,s){"use strict";s.r(t);var r=s(31),o=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"powershell-profiles"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#powershell-profiles"}},[e._v("#")]),e._v(" Powershell profiles")]),e._v(" "),s("h2",{attrs:{id:"create-an-basic-profile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-an-basic-profile"}},[e._v("#")]),e._v(" Create an basic profile")]),e._v(" "),s("p",[e._v("A PowerShell profile is used to load user defined variables and functions automatically.")]),e._v(" "),s("p",[e._v("PowerShell profiles are not automatically created for users.")]),e._v(" "),s("p",[e._v("To create a PowerShell profile "),s("code",[e._v("C:>New-Item -ItemType File $profile")]),e._v(".")]),e._v(" "),s("p",[e._v("If you are in ISE you can use the built in editor "),s("code",[e._v("C:>psEdit $profile")])]),e._v(" "),s("p",[e._v("An easy way to get started with your personal profile for the current host is to save some text to path stored in the "),s("code",[e._v("$profile")]),e._v("-variable")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"#Current host, current user"')]),e._v(" > "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$profile")]),e._v("\n\n")])])]),s("p",[e._v("Further modification to the profile can be done using PowerShell ISE, notepad, Visual Studio Code or any other editor.")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("$profile")]),e._v("-variable returns the current user profile for the current host by default, but you can access the path to the machine-policy (all users) and/or the profile for all hosts (console, ISE, 3rd party) by using it's properties.")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("PS")]),e._v("> "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$PROFILE")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("Format-List")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("Force\n\nAllUsersAllHosts       : C:\\Windows\\System32\\WindowsPowerShell\\v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("0\\profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ps1\nAllUsersCurrentHost    : C:\\Windows\\System32\\WindowsPowerShell\\v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("0\\Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("PowerShell_profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ps1\nCurrentUserAllHosts    : C:\\Users\\user\\Documents\\WindowsPowerShell\\profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ps1\nCurrentUserCurrentHost : C:\\Users\\user\\Documents\\WindowsPowerShell\\Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("PowerShell_profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ps1\nLength                 : 75\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("PS")]),e._v("> "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$PROFILE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("AllUsersAllHosts\nC:\\Windows\\System32\\WindowsPowerShell\\v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("0\\profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ps1\n\n")])])]),s("h4",{attrs:{id:"remarks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[e._v("#")]),e._v(" Remarks")]),e._v(" "),s("p",[e._v("Profile file is a powershell script that will run while the powershell console is starting. This way we can have our environment prepared for us each time we start new powershell session.")]),e._v(" "),s("p",[e._v("Typical things we want to do on powershell start are:")]),e._v(" "),s("ul",[s("li",[e._v("importing modules we use often (ActiveDirectory, Exchange, some specific DLL)")]),e._v(" "),s("li",[e._v("logging")]),e._v(" "),s("li",[e._v("changing the prompt")]),e._v(" "),s("li",[e._v("diagnostics")])]),e._v(" "),s("p",[e._v("There are several profile files and locations that have different uses and also hierarchy of start-up order:")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("Host")]),e._v(" "),s("th",[e._v("User")]),e._v(" "),s("th",[e._v("Path")]),e._v(" "),s("th",[e._v("Start order")]),e._v(" "),s("th",[e._v("Variable")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("All")]),e._v(" "),s("td",[e._v("All")]),e._v(" "),s("td",[e._v("%WINDIR%\\System32\\WindowsPowerShell\\v1.0\\profile.ps1")]),e._v(" "),s("td",[e._v("1")]),e._v(" "),s("td",[e._v("$profile.AllUsersAllHosts")])]),e._v(" "),s("tr",[s("td",[e._v("All")]),e._v(" "),s("td",[e._v("Current")]),e._v(" "),s("td",[e._v("%USERPROFILE%\\Documents\\WindowsPowerShell\\profile.ps1")]),e._v(" "),s("td",[e._v("3")]),e._v(" "),s("td",[e._v("$profile.CurrentUserAllHosts")])]),e._v(" "),s("tr",[s("td",[e._v("Console")]),e._v(" "),s("td",[e._v("All")]),e._v(" "),s("td",[e._v("%WINDIR%\\System32\\WindowsPowerShell\\v1.0\\Microsoft.PowerShell_profile.ps1")]),e._v(" "),s("td",[e._v("2")]),e._v(" "),s("td",[e._v("$profile.AllUsersCurrentHost")])]),e._v(" "),s("tr",[s("td",[e._v("Console")]),e._v(" "),s("td",[e._v("Current")]),e._v(" "),s("td",[e._v("%USERPROFILE%\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1")]),e._v(" "),s("td",[e._v("4")]),e._v(" "),s("td",[e._v("$profile.CurrentUserCurrentHost")])]),e._v(" "),s("tr",[s("td",[e._v("ISE")]),e._v(" "),s("td",[e._v("All")]),e._v(" "),s("td",[e._v("%WINDIR%\\System32\\WindowsPowerShell\\v1.0\\Microsoft.PowerShellISE_profile.ps1")]),e._v(" "),s("td",[e._v("2")]),e._v(" "),s("td",[e._v("$profile.AllUsersCurrentHost")])]),e._v(" "),s("tr",[s("td",[e._v("ISE")]),e._v(" "),s("td",[e._v("Current")]),e._v(" "),s("td",[e._v("%USERPROFILE%\\Documents\\WindowsPowerShell\\Microsoft.PowerShellISE_profile.ps1")]),e._v(" "),s("td",[e._v("4")]),e._v(" "),s("td",[e._v("$profile.CurrentUserCurrentHost")])])])])])}),[],!1,null,null,null);t.default=o.exports}}]);