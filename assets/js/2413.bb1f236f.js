(window.webpackJsonp=window.webpackJsonp||[]).push([[2413],{2821:function(t,e,a){"use strict";a.r(e);var s=a(31),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"unicode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#unicode"}},[t._v("#")]),t._v(" Unicode")]),t._v(" "),a("h2",{attrs:{id:"the-utf8-pragma-using-unicode-in-your-sources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-utf8-pragma-using-unicode-in-your-sources"}},[t._v("#")]),t._v(" The utf8 pragma: using Unicode in your sources")]),t._v(" "),a("p",[t._v("The "),a("a",{attrs:{href:"http://perldoc.perl.org/utf8.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("utf8")]),a("OutboundLink")],1),t._v(" pragma indicates that the source code will be interpreted as UTF-8. Of course, this will only work if your text editor is also saving the source as UTF-8 encoded.")]),t._v(" "),a("p",[t._v("Now, string literals can contain arbitrary Unicode characters; identifiers can also contain Unicode but only word-like characters (see "),a("a",{attrs:{href:"http://perldoc.perl.org/perldata.html#Identifier-parsing",target:"_blank",rel:"noopener noreferrer"}},[t._v("perldata"),a("OutboundLink")],1),t._v(" and "),a("a",{attrs:{href:"http://perldoc.perl.org/perlrecharclass.html#Backslash-sequences",target:"_blank",rel:"noopener noreferrer"}},[t._v("perlrecharclass"),a("OutboundLink")],1),t._v(" for more information):")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$var1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'§я§©😄'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# works fine")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" $я "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# works since я is a word (matches \\w) character")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$p")]),t._v("§"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# does not work since § is not a word character.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("say")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ya"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$var1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/я§/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# works fine (prints "ya")')]),t._v("\n\n")])])]),a("p",[a("strong",[t._v("Note")]),t._v(": When printing text to the terminal, make sure it supports UTF-8.*")]),t._v(" "),a("p",[t._v("There may be complex and counter-intuitive relationships between output and source encoding. Running on a UTF-8 terminal, you may find that adding the "),a("code",[t._v("utf8")]),t._v(" pragma seems to break things:")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[t._v("$ perl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'print \"Møøse\\n\"'")]),t._v("\nMøøse\n$ perl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Mutf8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'print \"Møøse\\n\"'")]),t._v("\nM��se\n$ perl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Mutf8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("CO "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'print \"Møøse\\n\"'")]),t._v("\nMøøse\n\n")])])]),a("p",[t._v("In the first case, Perl treats the string as raw bytes and prints them like that. As these bytes happen to be valid UTF-8, they look correct even though Perl doesn't really know what characters they are (e.g. "),a("code",[t._v('length("Møøse")')]),t._v(" will return 7, not 5). Once you add "),a("code",[t._v("-Mutf8")]),t._v(", Perl correctly decodes the UTF-8 source to characters, but output is in Latin-1 mode by default and printing Latin-1 to a UTF-8 terminal doesn't work. Only when you switch "),a("code",[t._v("STDOUT")]),t._v(" to UTF-8 using "),a("code",[t._v("-CO")]),t._v(" will the output be correct.")]),t._v(" "),a("p",[a("code",[t._v("use utf8")]),t._v(" doesn't affect standard I/O encoding nor file handles!")]),t._v(" "),a("h2",{attrs:{id:"create-filenames"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-filenames"}},[t._v("#")]),t._v(" Create filenames")]),t._v(" "),a("p",[t._v("The following examples use the UTF-8 encoding to represent filenames (and directory names) on disk. If you want to use another encoding, you should use "),a("a",{attrs:{href:"https://metacpan.org/pod/Encode#encode",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("Encode::encode(...)")]),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token vstring string"}},[t._v("v5.14")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Make Perl recognize UTF-8 encoded characters in literal strings.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# For this to work: Make sure your text-editor is using UTF-8, so")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# that bytes on disk are really UTF-8 encoded.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Ensure that possible error messages printed to screen are converted to UTF-8.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# For this to work: Check that your terminal emulator is using UTF-8.")]),t._v("\nbinmode STDOUT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbinmode STDERR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'æ€'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# $filename is now an internally UTF-8 encoded string. ")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Note: in the following it is assumed that $filename has the internal UTF-8")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  flag set, if $filename is pure ASCII, it will also work since its encoding")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  overlaps with UTF-8. However, if it has another encoding like extended ASCII,")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  $filename will be written with that encoding and not UTF-8. ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Note: it is not necessary to encode $filename as UTF-8 here")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  since Perl is using UTF-8 as its internal encoding of $filename already")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example1  -- using open()")]),t._v("\nopen "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("die")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"Could not open '$filename': $!\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nclose "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example2 -- using qx() and touch")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("qx{touch $filename}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example3 -- using system() and touch")]),t._v("\nsystem "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'touch'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example4 -- using File::Touch")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" File"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Touch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("eval")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" touch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("die")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"Could not create file '$filename': $!\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$@")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"read-filenames"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#read-filenames"}},[t._v("#")]),t._v(" Read filenames")]),t._v(" "),a("p",[t._v("Perl does not attempt to decode filenames returned by builtin functions or modules. Such strings representing filenames should always be decoded explicitly, in order for Perl to recognize them as Unicode.")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token vstring string"}},[t._v("v5.14")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Encode "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("qw(decode_utf8)")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Ensure that possible error messages printed to screen are converted to UTF-8.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# For this to work: Check that you terminal emulator is using UTF-8.")]),t._v("\nbinmode STDOUT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbinmode STDERR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example1  -- using readdir()")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nopendir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("die")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"Could not open directory '$dir': $!\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" decode_utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("readdir "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Do something with $filename")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nclose "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example2  -- using getcwd()")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Cwd "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("qw(getcwd)")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" decode_utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" getcwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example3  -- using abs2rel()")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" File"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Spec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$base")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ø'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$base/b/æ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$relpath")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" decode_utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" File"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Spec"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("abs2rel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$base")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Note: If you omit $base, you need to encode $path first:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Encode "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("qw(encode_utf8)")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$relpath")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" decode_utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" File"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Spec"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("abs2rel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" encode_utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example4  -- using File::Find::Rule (part1 matching a filename)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" File"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Rule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Encode "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("qw(encode_utf8)")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'æ'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# File::Find::Rule needs $filename to be encoded")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@files")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" File"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Rule"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("new"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" encode_utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("in"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" decode_utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@files")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example5  -- using File::Find::Rule (part2 matching a regular expression)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" File"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Rule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pat")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[æ].$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Unicode pattern")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Note: In this case:  File::Find::Rule->new->name( qr/$pat/ )->in('.')")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  will not work since $pat is Unicode and filenames are bytes")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  Also encoding $pat first will not work correctly")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@files")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Rule"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("new"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("exec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sub")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" wanted"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@files")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("in"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" decode_utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@files")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sub")]),t._v(" wanted")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$files")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" decode_utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$full_name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" decode_utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$File::Find::name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    push "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@$files")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$full_name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/$pat/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("Note: if you are concerned about invalid UTF-8 in the filenames, the use of "),a("code",[t._v("decode_utf8( ... )")]),t._v(" in the above examples should probably be replaced by "),a("code",[t._v("decode( 'utf-8', ... )")]),t._v(". This is because "),a("code",[t._v("decode_utf8( ... )")]),t._v(" is a synonym for "),a("code",[t._v("decode( 'utf8', ... )")]),t._v(" and there is a difference between the encodings "),a("code",[t._v("utf-8")]),t._v(" and "),a("code",[t._v("utf8")]),t._v(" (see "),a("a",{attrs:{href:"http://stackoverflow.com/documentation/perl/4375/unicode&a=remarks",target:"_blank",rel:"noopener noreferrer"}},[t._v("Remarks"),a("OutboundLink")],1),t._v(" below for more information) where "),a("code",[t._v("utf-8")]),t._v(" is more strict on what is acceptable than "),a("code",[t._v("utf8")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"command-line-switches-for-one-liners"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#command-line-switches-for-one-liners"}},[t._v("#")]),t._v(" Command line switches for one-liners")]),t._v(" "),a("h3",{attrs:{id:"enable-utf8-pragma"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#enable-utf8-pragma"}},[t._v("#")]),t._v(" Enable utf8 pragma")]),t._v(" "),a("p",[t._v("In order to enable "),a("code",[t._v("utf8")]),t._v(" pragma in one-liner, perl interpreter should be called with "),a("code",[t._v("-Mutf8")]),t._v(" option:")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[t._v("perl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Mutf8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("E "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my $人 = \"human\"; say $人'")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"unicode-handling-with-c-switch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#unicode-handling-with-c-switch"}},[t._v("#")]),t._v(" Unicode handling with -C switch")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("-C")]),t._v(" command line flag lets you control Unicode features. It can be followed by a list of option letters.")]),t._v(" "),a("h3",{attrs:{id:"standard-i-o"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#standard-i-o"}},[t._v("#")]),t._v(" Standard I/O")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("I")]),t._v(" - "),a("code",[t._v("STDIN")]),t._v(" will be in "),a("strong",[t._v("UTF-8")])]),t._v(" "),a("li",[a("code",[t._v("O")]),t._v(" - "),a("code",[t._v("STDOUT")]),t._v(" will be in "),a("strong",[t._v("UTF-8")])]),t._v(" "),a("li",[a("code",[t._v("E")]),t._v(" - "),a("code",[t._v("STDERR")]),t._v(" will be in "),a("strong",[t._v("UTF-8")])]),t._v(" "),a("li",[a("code",[t._v("S")]),t._v(" - shorthand for "),a("code",[t._v("IOE")]),t._v(", standard I/O streams will be in "),a("strong",[t._v("UTF-8")])])]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[t._v("echo "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ματαιότης ματαιοτήτων"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" perl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("CS "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Mutf8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("nE "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'say \"ok\" if /Ματαιότης/'")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"script-s-arguments"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#script-s-arguments"}},[t._v("#")]),t._v(" Script's arguments")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("A")]),t._v(" - treats "),a("code",[t._v("@ARGV")]),t._v(" as an array of "),a("strong",[t._v("UTF-8")]),t._v(" encoded strings")])]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[t._v("perl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("CA "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Mutf8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("E "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'my $arg = shift; say "anteater" if $arg eq "муравьед"\'')]),t._v(" муравьед\n\n")])])]),a("h3",{attrs:{id:"default-perlio-layer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#default-perlio-layer"}},[t._v("#")]),t._v(" Default PerlIO layer")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("i")]),t._v(" - "),a("strong",[t._v("UTF-8")]),t._v(" is the default PerlIO layer for input streams")]),t._v(" "),a("li",[a("code",[t._v("o")]),t._v(" - "),a("strong",[t._v("UTF-8")]),t._v(" is the default PerlIO layer for output streams")]),t._v(" "),a("li",[a("code",[t._v("D")]),t._v(" - shorthand for "),a("code",[t._v("io")])])]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[t._v("perl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("CD "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Mutf8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'open my $fh, ">", "utf8.txt" or die $!; print $fh "개미 조심해"\'')]),t._v("\n\n")])])]),a("p",[a("code",[t._v("-M")]),t._v(" and "),a("code",[t._v("-C")]),t._v(" switches may be combined:")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[t._v("perl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("CASD "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Mutf8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("E "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'say \"Ματαιότης ματαιοτήτων\\n\"'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"standard-i-o-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#standard-i-o-2"}},[t._v("#")]),t._v(" Standard I/O")]),t._v(" "),a("p",[t._v("The encoding to be used for the standard I/O filehandles ("),a("code",[t._v("STDIN")]),t._v(", "),a("code",[t._v("STDOUT")]),t._v(", and "),a("code",[t._v("STDERR")]),t._v("), can be set separately for each handle using "),a("a",{attrs:{href:"http://perldoc.perl.org/functions/binmode.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("binmode")]),a("OutboundLink")],1),t._v(":")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[t._v("binmode STDIN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':encoding(utf-8)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbinmode STDOUT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbinmode STDERR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[t._v("Note: when reading one would in general prefer "),a("code",[t._v(":encoding(utf-8)")]),t._v(" over "),a("code",[t._v(":utf8")]),t._v(", see "),a("a",{attrs:{href:"http://stackoverflow.com/documentation/perl/4375/unicode&a=remarks",target:"_blank",rel:"noopener noreferrer"}},[t._v("Remarks"),a("OutboundLink")],1),t._v(" for more information.")]),t._v(" "),a("p",[t._v("Alternatively, you can use the "),a("a",{attrs:{href:"http://perldoc.perl.org/open.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("open")]),a("OutboundLink")],1),t._v(" pragma.")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Setup such that all subsequently opened input streams will use ':encoding(utf-8)'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# and all subsequently opened output streams will use ':utf8'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# by default")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" open "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IN "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':encoding(utf-8)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" OUT "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Make the (already opened) standard file handles inherit the setting ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# given by the IO settings for the open pragma")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" open "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("std "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Now, STDIN has been converted to ':encoding(utf-8)', and ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# STDOUT and STDERR have ':utf8'")]),t._v("\n\n")])])]),a("p",[t._v("Alternatively, to set all filehandles (both those yet to be opened and also the standard ones) to use "),a("code",[t._v(":encoding(utf-8)")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" open qw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("encoding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("utf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("std "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"file-handles"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#file-handles"}},[t._v("#")]),t._v(" File handles")]),t._v(" "),a("h3",{attrs:{id:"setting-encoding-with-open"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setting-encoding-with-open"}},[t._v("#")]),t._v(" Setting encoding with open()")]),t._v(" "),a("p",[t._v("When opening a text file, you may specify it's encoding explicitly with a three-argument "),a("a",{attrs:{href:"http://perldoc.perl.org/functions/open.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("open()")]),a("OutboundLink")],1),t._v('. This en-/decoder attached to a file handle is called an "I/O layer":')]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/path/to/file'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nopen "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<:encoding(utf-8)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("die")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Failed to open $filename: $!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[t._v("See "),a("a",{attrs:{href:"http://stackoverflow.com/documentation/perl/4375/unicode&a=remarks",target:"_blank",rel:"noopener noreferrer"}},[t._v("Remarks"),a("OutboundLink")],1),t._v(" for a discussion of the differences between "),a("code",[t._v(":utf8")]),t._v(" and "),a("code",[t._v(":encoding(utf-8)")]),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"setting-encoding-with-binmode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setting-encoding-with-binmode"}},[t._v("#")]),t._v(" Setting encoding with binmode()")]),t._v(" "),a("p",[t._v("Alternatively, you may use binmode() to set the encoding for individual file handle:")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/path/to/file'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nopen "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("die")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Failed to open $filename: $!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbinmode "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':encoding(utf-8)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"open-pragma"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#open-pragma"}},[t._v("#")]),t._v(" open pragma")]),t._v(" "),a("p",[t._v("To avoid setting encoding for each file handle separately, you may use the "),a("a",{attrs:{href:"http://perldoc.perl.org/open.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("open")]),a("OutboundLink")],1),t._v(" pragma to set a default I/O layer used by all subsequent calls to the "),a("code",[t._v("open()")]),t._v(" function and similar operators within the lexical scope of this pragma:")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Set input streams to ':encoding(utf-8)' and output streams to ':utf8'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" open "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IN "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':encoding(utf-8)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" OUT "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Or to set all input and output streams to ':encoding(utf-8)'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" open "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':encoding(utf-8)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"setting-encoding-with-command-line-c-flag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setting-encoding-with-command-line-c-flag"}},[t._v("#")]),t._v(" Setting encoding with command line -C flag")]),t._v(" "),a("p",[t._v("Finally, it is also possible to run the perl interpreter with a "),a("code",[t._v("-CD")]),t._v(" flag that applies UTF-8 as the default I/O layer. However, this option should be avoided since it relies on specific user behaviour which cannot be predicted nor controlled.")]),t._v(" "),a("h2",{attrs:{id:"handling-invalid-utf-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handling-invalid-utf-8"}},[t._v("#")]),t._v(" Handling invalid UTF-8")]),t._v(" "),a("h3",{attrs:{id:"reading-invalid-utf-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reading-invalid-utf-8"}},[t._v("#")]),t._v(" Reading invalid UTF-8")]),t._v(" "),a("p",[t._v("When reading UTF-8 encoded data, it is important to be aware of the fact the UTF-8 encoded data can be invalid or malformed. Such data should usually not be accepted by your program (unless you know what you are doing). When unexpectedly encountering malformed data, different actions can be considered:")]),t._v(" "),a("ul",[a("li",[t._v("Print stacktrace or error message, and abort program gracefully, or")]),t._v(" "),a("li",[t._v("Insert a substitution character at the place where the malformed byte sequence appeared, print a warning message to STDERR and continue reading as nothing happened.")])]),t._v(" "),a("p",[t._v("By default, Perl will "),a("a",{attrs:{href:"http://perldoc.perl.org/functions/warn.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("warn")]),a("OutboundLink")],1),t._v(" you about encoding glitches, but it will not abort your program.\nYou can make your program abort by making UTF-8 warnings fatal, but be aware of the caveats in "),a("a",{attrs:{href:"http://perldoc.perl.org/warnings.html#Fatal-Warnings",target:"_blank",rel:"noopener noreferrer"}},[t._v("Fatal Warnings"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[t._v("The following example writes 3 bytes in encoding ISO 8859-1 to disk. It then tries to read the bytes back again as UTF-8 encoded data. One of the bytes, "),a("code",[t._v("0xE5")]),t._v(", is an invalid UTF-8 one byte sequence:")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" strict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" warnings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" warnings FATAL "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nbinmode STDOUT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbinmode STDERR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$bytes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\x{61}\\x{E5}\\x{61}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3 bytes in iso 8859-1: aåa")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nopen "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'>:raw'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("die")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"Could not open file '$fn': $!\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nclose "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nopen "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<:encoding(utf-8)"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("die")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"Could not open file '$fn': $!\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("my")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nclose "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"Read string: '$str'\\n\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[t._v("The program will abort with a fatal warning:")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[t._v("utf8 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\xE5"')]),t._v(" does "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" map to Unicode at "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("pl line "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("\n\n")])])]),a("p",[t._v("Line 10 is here the second last line, and the error occurs in the part of the line with "),a("code",[t._v("<$fh>")]),t._v(" when trying to read a line from the file.")]),t._v(" "),a("p",[t._v("If you don't make warnings fatal in the above program, Perl will still print the warning. However, in this case it will try to recover from the malformed byte "),a("code",[t._v("0xE5")]),t._v(" by inserting the four characters "),a("code",[t._v("\\xE5")]),t._v(" into the stream, and then continue with the next byte. As a result, the program will print:")]),t._v(" "),a("div",{staticClass:"language-perl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-perl"}},[a("code",[t._v("Read string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a\\xE5a'")]),t._v("\n\n")])])]),a("h4",{attrs:{id:"remarks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[t._v("#")]),t._v(" Remarks")]),t._v(" "),a("h3",{attrs:{id:"a-warning-on-filename-encoding"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#a-warning-on-filename-encoding"}},[t._v("#")]),t._v(" A Warning on Filename Encoding")]),t._v(" "),a("p",[t._v("It should be worth mentioning that Filename Encoding is not only "),a("strong",[t._v("platform")]),t._v(" specific but also "),a("strong",[t._v("filesystem")]),t._v(" specific.")]),t._v(" "),a("p",[t._v("It is never "),a("strong",[t._v("entirely")]),t._v(" safe to assume (but often usually is) that just because you can encode and write to a given filename, that when you later try to open that same filename for reading, it will still be called the same thing.")]),t._v(" "),a("p",[t._v("For instance, if you write to a filesystem such as "),a("code",[t._v("FAT16")]),t._v(" which doesn't support unicode, your filenames might silently get translated into ASCII-compatible forms.")]),t._v(" "),a("p",[t._v("But it is even "),a("strong",[t._v("less")]),t._v(" safe to assume that a file you can create, read and write to by explicit naming will be called the same thing when queried through other calls, for instance, "),a("code",[t._v("readdir")]),t._v(" might return different bytes for your filename than you specified to "),a("code",[t._v("open")]),t._v(".")]),t._v(" "),a("p",[t._v("On some systems such as VAX, you can't even always assume that "),a("code",[t._v("readdir")]),t._v(" will return the same filename you specified with "),a("code",[t._v("open")]),t._v(" for filenames as simple as "),a("code",[t._v("foo.bar")]),t._v(", because filename "),a("strong",[t._v("extensions")]),t._v(" can be mangled by the OS.")]),t._v(" "),a("p",[t._v("Also, on UNIX, there is a very liberal set of legal characters for filenames that the OS permits, excluding only "),a("code",[t._v("/")]),t._v(" and "),a("code",[t._v("\\0")]),t._v(", where as on Windows, there are specific ranges of characters that are forbidden in filenames and will cause errors.")]),t._v(" "),a("p",[a("strong",[t._v("Exercise much caution here, avoid fancy tricks with filenames if you have a choice")]),t._v(", and always have tests to make sure any fancy tricks you "),a("strong",[t._v("do")]),t._v(" use are consistent.")]),t._v(" "),a("p",[a("strong",[t._v("Exercise doubly as much caution")]),t._v(" if you're writing code intended to be run on platforms outside your control, such as if you're writing code that is intended for "),a("code",[t._v("CPAN")]),t._v(", and assume at least 5% of your user base will be stuck using some ancient or broken technology, either by choice, by accident, or by powers outside their control, and that these will conspire to create bugs for them.")]),t._v(" "),a("h3",{attrs:{id:"encoding-utf8-vs-utf8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#encoding-utf8-vs-utf8"}},[t._v("#")]),t._v(" :encoding(utf8) vs :utf8")]),t._v(" "),a("p",[t._v("Since UTF-8 is one of the internal formats for representation of strings in Perl, the encoding/decoding step may often be skipped. Instead of "),a("code",[t._v(":encoding(utf-8)")]),t._v(", you can simply use "),a("code",[t._v(":utf8")]),t._v(", if your data is already in UTF-8. "),a("code",[t._v(":utf8")]),t._v(" can be used safely with output streams, whereas for input stream it can be dangerous, because it causes internal inconsistency when you have invalid byte sequences. Also, using "),a("code",[t._v(":utf8")]),t._v(" for input may result in security breaches, so the use of "),a("code",[t._v(":encoding(utf-8)")]),t._v(" is advisable.")]),t._v(" "),a("p",[t._v("More details: "),a("a",{attrs:{href:"http://perldoc.perl.org/perlunifaq.html#What-is-the-difference-between-%3aencoding-and-%3autf8%3f",target:"_blank",rel:"noopener noreferrer"}},[t._v("What is the difference between :encoding and :utf8"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"utf-8-vs-utf8-vs-utf8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#utf-8-vs-utf8-vs-utf8"}},[t._v("#")]),t._v(" UTF-8 vs utf8 vs UTF8")]),t._v(" "),a("p",[t._v("As of Perl "),a("code",[t._v("v5.8.7")]),t._v(", "),a("code",[t._v('"UTF-8"')]),t._v(" (with dash) means UTF-8 in its strict and security-conscious form, whereas "),a("code",[t._v('"utf8"')]),t._v(" means UTF-8 in its liberal and loose form.")]),t._v(" "),a("p",[t._v("For example, "),a("code",[t._v('"utf8"')]),t._v(" can be used for code points that don't exist in Unicode, like "),a("code",[t._v("0xFFFFFFFF")]),t._v(". Correspondingly, invalid UTF-8 byte sequences like "),a("code",[t._v('"\\x{FE}\\x{83}\\x{BF}\\x{BF}\\x{BF}\\x{BF}\\x{BF}"')]),t._v(" will decode into an invalid Unicode (but valid Perl) codepoint ("),a("code",[t._v("0xFFFFFFFF")]),t._v(") when using "),a("code",[t._v('"utf8"')]),t._v(", whereas the "),a("code",[t._v('"UTF-8"')]),t._v(" encoding would not allow decoding to codepoints outside the range of valid Unicode and  would give you a substitution character ("),a("code",[t._v("0xFFFD")]),t._v(") instead.")]),t._v(" "),a("p",[t._v("Since encoding names are case insensitive, "),a("code",[t._v('"UTF8"')]),t._v(" is the same as "),a("code",[t._v('"utf8"')]),t._v(" (i.e. "),a("strong",[t._v("non-strict")]),t._v(" variant).")]),t._v(" "),a("p",[t._v("More details: "),a("a",{attrs:{href:"http://perldoc.perl.org/Encode.html#UTF-8-vs.-utf8-vs.-UTF8",target:"_blank",rel:"noopener noreferrer"}},[t._v("UTF-8 vs. utf8 vs. UTF8"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"more-reading"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#more-reading"}},[t._v("#")]),t._v(" More Reading")]),t._v(" "),a("p",[t._v("Details about Perl's Unicode handling is described in more detail in the following sources:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://metacpan.org/pod/perlunicode",target:"_blank",rel:"noopener noreferrer"}},[t._v("perlunicode"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://metacpan.org/pod/distribution/perl/pod/perlunitut.pod",target:"_blank",rel:"noopener noreferrer"}},[t._v("perlunitut"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://metacpan.org/pod/distribution/perl/pod/perluniintro.pod",target:"_blank",rel:"noopener noreferrer"}},[t._v("perluniintro"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://metacpan.org/pod/distribution/perl/pod/perlunifaq.pod",target:"_blank",rel:"noopener noreferrer"}},[t._v("perlunifaq"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://metacpan.org/pod/distribution/perl/pod/perlunicook.pod",target:"_blank",rel:"noopener noreferrer"}},[t._v("perlunicook"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://perldoc.perl.org/utf8.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("utf8 pragma"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://perldoc.perl.org/feature.html#The-%27unicode_strings%27-feature",target:"_blank",rel:"noopener noreferrer"}},[t._v("unicode_strings feature"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://perldoc.perl.org/open.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("open pragma"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://perldoc.perl.org/PerlIO.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PerlIO"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://perldoc.perl.org/PerlIO/encoding.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PerlIO::encoding"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://perldoc.perl.org/functions/open.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("open function"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://metacpan.org/pod/Encode",target:"_blank",rel:"noopener noreferrer"}},[t._v("Encode"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://perldoc.perl.org/perlrun.html#Command-Switches",target:"_blank",rel:"noopener noreferrer"}},[t._v("perlrun - command line switches"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://shop.oreilly.com/product/9780596004927.do",target:"_blank",rel:"noopener noreferrer"}},[t._v("Chapter 6, Programming Perl"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("Posts from stackoverflow.com (caveat: might not be up-to-date):")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://stackoverflow.com/q/6162484/2173773",target:"_blank",rel:"noopener noreferrer"}},[t._v("Why does modern Perl avoid UTF-8 by default?"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("Youtube videos:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.youtube.com/watch?v=TmTeXcEixEg",target:"_blank",rel:"noopener noreferrer"}},[t._v("A Million Billion Squiggly Characters"),a("OutboundLink")],1),t._v(" by Ricardo Signes at YAPC NA 2016.")])])])}),[],!1,null,null,null);e.default=n.exports}}]);