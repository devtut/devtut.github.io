(window.webpackJsonp=window.webpackJsonp||[]).push([[1071],{1418:function(t,s,e){"use strict";e.r(s);var a=e(19),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"common-mistakes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#common-mistakes"}},[t._v("#")]),t._v(" Common Mistakes")]),t._v(" "),e("h2",{attrs:{id:"qualifying-references"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#qualifying-references"}},[t._v("#")]),t._v(" Qualifying References")]),t._v(" "),e("p",[t._v("When referring to a "),e("code",[t._v("worksheet")]),t._v(", a "),e("code",[t._v("range")]),t._v(" or individual "),e("code",[t._v("cells")]),t._v(", it is important to fully qualify the reference.")]),t._v(" "),e("p",[t._v("For example:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[t._v("ThisWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Copy\n\n")])])]),e("p",[t._v("Is not fully qualified: The "),e("code",[t._v("Cells")]),t._v(" references do not have a workbook and worksheet associated with them. Without an explicit reference, Cells refers to the "),e("code",[t._v("ActiveSheet")]),t._v(" by default.  So this code will fail (produce incorrect results) if a worksheet other than "),e("code",[t._v("Sheet1")]),t._v(" is the current "),e("code",[t._v("ActiveSheet")]),t._v(".")]),t._v(" "),e("p",[t._v("The easiest way to correct this is to use a "),e("code",[t._v("With")]),t._v(" statement as follows:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" ThisWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Copy\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n\n")])])]),e("p",[t._v("Alternatively, you can use a Worksheet variable.  (This will most likely be preferred method if your code needs to reference multiple Worksheets, like copying data from one sheet to another.)")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" ws1 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Worksheet\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ws1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThisWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nws1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ws1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ws1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Copy\n\n")])])]),e("p",[t._v("Another frequent problem is referencing the Worksheets collection without qualifying the Workbook. For example:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Copy\n\n")])])]),e("p",[t._v("The worksheet "),e("code",[t._v("Sheet1")]),t._v(" is not fully qualified, and lacks a workbook. This could fail if multiple workbooks are referenced in the code. Instead, use one of the following:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[t._v("ThisWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'<--ThisWorkbook refers to the workbook containing ")]),t._v("\n                                        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'the running VBA code")]),t._v("\nWorkbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Book1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'<--Where Book1 is the workbook containing Sheet1")]),t._v("\n\n")])])]),e("p",[t._v("However, avoid using the following:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[t._v("ActiveWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("     "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'<--Valid, but if another workbook is activated")]),t._v("\n                                        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'the reference will be changed")]),t._v("\n\n")])])]),e("p",[t._v("Similarly for "),e("code",[t._v("range")]),t._v(" objects, if not explicitly qualified, the "),e("code",[t._v("range")]),t._v(" will refer to the currently active sheet:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),e("p",[t._v("Is the same as:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[t._v("ActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"deleting-rows-or-columns-in-a-loop"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deleting-rows-or-columns-in-a-loop"}},[t._v("#")]),t._v(" Deleting rows or columns in a loop")]),t._v(" "),e("p",[t._v("If you want to delete rows (or columns) in a loop, you should always loop starting from the end of range and move back in every step. In case of using the code:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" i "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Book1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" i "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" IsEmpty"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Rows"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Delete\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" i\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n\n")])])]),e("p",[t._v("You will miss some rows. For example, if the code deletes row 3, then row 4 becomes row 3. However, variable "),e("code",[t._v("i")]),t._v(" will change to 4. So, in this case the code will miss one row and check another, which wasn't in range previously.")]),t._v(" "),e("p",[t._v("The right code would be")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" i "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Book1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Worksheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sheet1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("For")]),t._v(" i "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("To")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Step")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" IsEmpty"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Rows"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Delete\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v(" i\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"activeworkbook-vs-thisworkbook"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#activeworkbook-vs-thisworkbook"}},[t._v("#")]),t._v(" ActiveWorkbook vs. ThisWorkbook")]),t._v(" "),e("p",[e("code",[t._v("ActiveWorkbook")]),t._v(" and "),e("code",[t._v("ThisWorkbook")]),t._v(" sometimes get used interchangeably by new users of VBA without fully understanding which each object relates to, this can cause undesired behaviour at run-time. Both of these objects belong to the "),e("a",{attrs:{href:"http://stackoverflow.com/documentation/excel-vba/5645/application-object",target:"_blank",rel:"noopener noreferrer"}},[t._v("Application Object"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("ActiveWorkbook")]),t._v(" object refers to the workbook that is currently in the top-most view of the Excel application object at the time of execution. "),e("strong",[t._v("(e.g. The workbook that you can see and interact with at the point when this object is referenced)")])]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ActiveWorkbookExample"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'// Let's assume that 'Other Workbook.xlsx' has \"Bar\" written in A1.")]),t._v("\n\n    ActiveWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Foo"')]),t._v("\n    Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print ActiveWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'// Prints "Foo"')]),t._v("\n\n    Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Open"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:\\Users\\BloggsJ\\Other Workbook.xlsx"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print ActiveWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'// Prints "Bar"')]),t._v("\n\n    Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print ActiveWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'// Prints nothing")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("p",[t._v("The "),e("code",[t._v("ThisWorkbook")]),t._v(" object refers to the workbook in which the code belongs to at the time it is being executed.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ThisWorkbookExample"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'// Let's assume to begin that this code is in the same workbook that is currently active")]),t._v("\n\n    ActiveWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheet1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Foo"')]),t._v("\n    Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    ActiveWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Bar"')]),t._v("\n\n    Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print ActiveWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ActiveSheet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'// Prints "Bar"')]),t._v("\n    Debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Print ThisWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheet1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\'// Prints "Foo"')]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"single-document-interface-versus-multiple-document-interfaces"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#single-document-interface-versus-multiple-document-interfaces"}},[t._v("#")]),t._v(" Single Document Interface Versus Multiple Document Interfaces")]),t._v(" "),e("blockquote"),t._v(" "),e("p",[t._v("Be aware that Microsoft Excel 2013 (and higher) uses Single Document\nInterface (SDI) and that Excel 2010 (And below) uses Multiple Document\nInterfaces (MDI).")]),t._v(" "),e("p",[t._v("This implies that for Excel 2013 (SDI), each workbook in a single instance of Excel contains its "),e("strong",[t._v("own")]),t._v(" ribbon UI:")]),t._v(" "),e("p",[e("a",{attrs:{href:"http://i.stack.imgur.com/VY2TA.jpg",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"http://i.stack.imgur.com/VY2TA.jpg",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("Conversely for Excel 2010,  each workbook in a single instance of Excel utilized a "),e("strong",[t._v("common")]),t._v(" ribbon UI (MDI):\n"),e("a",{attrs:{href:"http://i.stack.imgur.com/I4Dv1.jpg",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"http://i.stack.imgur.com/I4Dv1.jpg",alt:"enter image description here"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("This raise some important issues if you want to migrate a VBA code (2010 <->2013) that interact with the Ribbon.")]),t._v(" "),e("blockquote"),t._v(" "),e("p",[t._v("A procedure has to be created to update ribbon UI controls in the same\nstate across all workbooks for Excel 2013 and Higher.")]),t._v(" "),e("p",[t._v("Note that :")]),t._v(" "),e("ol",[e("li",[t._v("All Excel application-level window methods, events, and properties remain unaffected. ("),e("code",[t._v("Application.ActiveWindow")]),t._v(", "),e("code",[t._v("Application.Windows")]),t._v(" ... )")]),t._v(" "),e("li",[t._v("In Excel 2013 and higher (SDI) all of the workbook-level window methods, events, and properties now operate on the top level window. It is possible to retrieve the handle of this top level window with "),e("code",[t._v("Application.Hwnd")])])]),t._v(" "),e("p",[t._v("To get more details, see the source of this example:  "),e("a",{attrs:{href:"https://msdn.microsoft.com/fr-fr/library/office/dn251093.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("MSDN"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("This also causes some trouble with modeless userforms. See "),e("a",{attrs:{href:"http://www.jkp-ads.com/Articles/keepuserformontop.asp",target:"_blank",rel:"noopener noreferrer"}},[t._v("Here"),e("OutboundLink")],1),t._v(" for a solution.")])])}),[],!1,null,null,null);s.default=n.exports}}]);