(window.webpackJsonp=window.webpackJsonp||[]).push([[2586],{2994:function(e,t,s){"use strict";s.r(t);var a=s(31),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"creating-dsc-class-based-resources"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-dsc-class-based-resources"}},[e._v("#")]),e._v(" Creating DSC Class-Based Resources")]),e._v(" "),s("p",[e._v("Starting with PowerShell version 5.0, you can use PowerShell class definitions to create Desired State Configuration (DSC) Resources.")]),e._v(" "),s("p",[e._v("To aid in building DSC Resource, there's a "),s("code",[e._v("[DscResource()]")]),e._v(" attribute that's applied to the class definition, and a "),s("code",[e._v("[DscProperty()]")]),e._v(" resource to designate properties as configurable by the DSC Resource user.")]),e._v(" "),s("h2",{attrs:{id:"create-a-dsc-resource-skeleton-class"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-dsc-resource-skeleton-class"}},[e._v("#")]),e._v(" Create a DSC Resource Skeleton Class")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[DscResource()]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("class")]),e._v(" File "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n")])])]),s("p",[e._v("This example demonstrates how to build the outer section of a PowerShell class, that declares a DSC Resource. You still need to fill in the contents of the class definition.")]),e._v(" "),s("h2",{attrs:{id:"dsc-resource-skeleton-with-key-property"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dsc-resource-skeleton-with-key-property"}},[e._v("#")]),e._v(" DSC Resource Skeleton with Key Property")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[DscResource()]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("class")]),e._v(" Ticket "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[DscProperty(Key)]")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[string]")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$TicketId")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n")])])]),s("p",[e._v("A DSC Resource must declare at least one key property. The key property is what uniquely identifies the resource from other resources. For example, let's say that you're building a DSC Resource that represents a ticket in a ticketing system. Each ticket would be uniquely represented with a ticket ID.")]),e._v(" "),s("p",[e._v("Each property that will be exposed to the "),s("strong",[e._v("user")]),e._v(" of the DSC Resource must be decorated with the "),s("code",[e._v("[DscProperty()]")]),e._v(" attribute. This attributes accepts a "),s("code",[e._v("key")]),e._v(" parameter, to indicate that the property is a key attribute for the DSC Resource.")]),e._v(" "),s("h2",{attrs:{id:"dsc-resource-with-mandatory-property"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dsc-resource-with-mandatory-property"}},[e._v("#")]),e._v(" DSC Resource with Mandatory Property")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[DscResource()]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("class")]),e._v(" Ticket "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[DscProperty(Key)]")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[string]")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$TicketId")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[DscProperty(Mandatory)]")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[string]")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Subject")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n")])])]),s("p",[e._v("When building a DSC Resource, you'll often find that not every single property should be mandatory. However, there are some core properties that you'll want to ensure are configured by the user of the DSC Resource. You use the "),s("code",[e._v("Mandatory")]),e._v(" parameter of the "),s("code",[e._v("[DscResource()]")]),e._v(" attribute to declare a property as required by the DSC Resource's user.")]),e._v(" "),s("p",[e._v("In the example above, we've added a "),s("code",[e._v("Subject")]),e._v(" property to a "),s("code",[e._v("Ticket")]),e._v(" resource, that represents a unique ticket in a ticketing system, and designated it as a "),s("code",[e._v("Mandatory")]),e._v(" property.")]),e._v(" "),s("h2",{attrs:{id:"dsc-resource-with-required-methods"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dsc-resource-with-required-methods"}},[e._v("#")]),e._v(" DSC Resource with Required Methods")]),e._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[DscResource()]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("class")]),e._v(" Ticket "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[DscProperty(Key)]")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[string]")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$TicketId")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# The subject line of the ticket")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[DscProperty(Mandatory)]")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[string]")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$Subject")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Get / Set if ticket should be open or closed")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[DscProperty(Mandatory)]")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[string]")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$TicketState")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[void]")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("Set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Create or update the resource")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[Ticket]")]),e._v(" Get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Return the resource's current state as an object")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$TicketState")]),e._v(" = "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[Ticket]")]),e._v("::new"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$TicketState")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("[bool]")]),e._v(" Test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Return $true if desired state is met")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Return $false if desired state is not met")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("$false")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n")])])]),s("p",[e._v("This is a complete DSC Resource that demonstrates all of the core requirements to build a valid resource. The method implementations are not complete, but are provided with the intention of showing the basic structure.")]),e._v(" "),s("h4",{attrs:{id:"remarks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[e._v("#")]),e._v(" Remarks")]),e._v(" "),s("p",[e._v("A class-based DSC Resource must:")]),e._v(" "),s("ul",[s("li",[e._v("Be decorated with the "),s("code",[e._v("[DscResource()]")]),e._v(" attribute")]),e._v(" "),s("li",[e._v("Define a "),s("code",[e._v("Test()")]),e._v(" method that returns "),s("code",[e._v("[bool]")])]),e._v(" "),s("li",[e._v("Define a "),s("code",[e._v("Get()")]),e._v(" method that returns its own object type (eg. "),s("code",[e._v("[Ticket]")]),e._v(")")]),e._v(" "),s("li",[e._v("Define a "),s("code",[e._v("Set()")]),e._v(" method that returns "),s("code",[e._v("[void]")])]),e._v(" "),s("li",[e._v("At least one "),s("code",[e._v("Key")]),e._v(" DSC Property")])]),e._v(" "),s("p",[e._v('After creating a class-based PowerShell DSC Resource, it must be "exported" from a module, using a module manifest (.psd1) file. Within the module manifest, the '),s("code",[e._v("DscResourcesToExport")]),e._v(' hashtable key is used to declare an array of DSC Resources (class names) to "export" from the module. This enables consumers of the DSC module to "see" the class-based resources inside the module.')])])}),[],!1,null,null,null);t.default=r.exports}}]);