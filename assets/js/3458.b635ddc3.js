(window.webpackJsonp=window.webpackJsonp||[]).push([[3458],{3866:function(s,t,a){"use strict";a.r(t);var e=a(31),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"data-access"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-access"}},[s._v("#")]),s._v(" Data Access")]),s._v(" "),a("h2",{attrs:{id:"read-field-from-database"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#read-field-from-database"}},[s._v("#")]),s._v(" Read field from Database")]),s._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" GetUserFirstName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("UserName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" Firstname "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Specify the SQL that you want to use including a Parameter")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" SQL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"select firstname from users where username=@UserName"')]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Provide a Data Source")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" DBDSN "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Data Source=server.address;Initial Catalog=DatabaseName;Persist Security Info=True;User ID=UserName;Password=UserPassword"')]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" dbConn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" SqlConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DBDSN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" dbCommand "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" SqlCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SQL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dbConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Provide one or more Parameters")]),s._v("\n    dbCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Parameters"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AddWithValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@UserName"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" UserName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'An optional Timeout")]),s._v("\n    dbCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CommandTimeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" reader "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" SqlDataReader\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" previousConnectionState "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" ConnectionState "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dbConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("State\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Try")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" dbConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("State "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ConnectionState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Closed "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n            dbConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Open"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n        reader "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dbCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ExecuteReader\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v(" reader\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" reader\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("HasRows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Read the 1st Record")]),s._v("\n                    reader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Read required field/s")]),s._v("\n                    Firstname "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FirstName"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ToString\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Catch")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Handle the error here")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Finally")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" previousConnectionState "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ConnectionState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Closed "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n            dbConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n        dbConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Dispose"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        dbCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Dispose"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Try")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Pass the data back from the function")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Return")]),s._v(" Firstname\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v("\n\n")])])]),a("p",[s._v("Using the above function is simply:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\n  Dim UserFirstName as string=GetUserFirstName(UserName)\n\n")])])]),a("h2",{attrs:{id:"simple-function-to-read-from-database-and-return-as-datatable"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#simple-function-to-read-from-database-and-return-as-datatable"}},[s._v("#")]),s._v(" Simple Function to read from Database and return as DataTable")]),s._v(" "),a("p",[s._v("This simple function will execute the specified Select SQL command and return the result as data set.")]),s._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" ReadFromDatabase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" DBConnectionString "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ByVal")]),s._v(" SQL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" DataTable\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" dtReturn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" DataTable\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Try")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Open the connection using the connection string")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v(" conn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" SqlClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SqlConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DBConnectionString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Open"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v(" cmd "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" SqlClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SqlCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                cmd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Connection "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn\n                cmd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CommandText "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" SQL\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" da "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" SqlClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SqlDataAdapter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cmd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                da"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Fill"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dtReturn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Catch")]),s._v(" ex "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Exception\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Handle the exception")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Try")]),s._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Return the result data set")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Return")]),s._v(" dtReturn\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v("\n\n")])])]),a("p",[s._v("Now you can execute the above function from below codes")]),s._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" MainFunction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" dtCustomers "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" DataTable\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" dtEmployees "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" DataTable\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" dtSuppliers "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" DataTable\n\n\n    dtCustomers "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ReadFromDatabase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Server=MYDEVPC\\SQLEXPRESS;Database=MyDatabase;User Id=sa;Password=pwd22;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Select * from [Customers]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    dtEmployees "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ReadFromDatabase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Server=MYDEVPC\\SQLEXPRESS;Database=MyDatabase;User Id=sa;Password=pwd22;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Select * from [Employees]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    dtSuppliers "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ReadFromDatabase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Server=MYDEVPC\\SQLEXPRESS;Database=MyDatabase;User Id=sa;Password=pwd22;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Select * from [Suppliers]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n")])])]),a("p",[s._v('The above example expects that your SQL Express instance "SQLEXPRESS" is currently installed on "MYDEVPC" and your database "MyDatabase" contains "Customers", "Suppliers" and "Employees" tables and the "sa" user password is "pwd22".  Please change these values as per your setup to get the desired results.')]),s._v(" "),a("h2",{attrs:{id:"get-scalar-data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-scalar-data"}},[s._v("#")]),s._v(" Get Scalar Data")]),s._v(" "),a("p",[s._v("This simple function can be used to get value from exactly one field one record query result")]),s._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" getDataScalar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ssql "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    openConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Try")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" q "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" MySqlCommand\n\n        q"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Connection "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" db\n        q"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CommandText "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ssql\n        getDataScalar "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" q"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ExecuteScalar\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Catch")]),s._v(" ex "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Exception\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Exception")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Try")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v("\n\n")])])]),a("p",[s._v("How to use it:")]),s._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" userid "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" getDataScalar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"select username from user where userid=99"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])])]),a("p",[s._v("Variable 'username' would be filled with the value of field username as a result from that query.")])])}),[],!1,null,null,null);t.default=n.exports}}]);