(window.webpackJsonp=window.webpackJsonp||[]).push([[1098],{1506:function(t,s,e){"use strict";e.r(s);var a=e(31),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"workbooks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#workbooks"}},[t._v("#")]),t._v(" Workbooks")]),t._v(" "),e("h2",{attrs:{id:"when-to-use-activeworkbook-and-thisworkbook"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#when-to-use-activeworkbook-and-thisworkbook"}},[t._v("#")]),t._v(" When To Use ActiveWorkbook and ThisWorkbook")]),t._v(" "),e("p",[t._v("It's a VBA Best Practice to always specify which workbook your VBA code refers. If this specification is omitted, then VBA assumes the code is directed at the currently active workbook ("),e("code",[t._v("ActiveWorkbook")]),t._v(").")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- the currently active workbook (and worksheet) is implied")]),t._v("\nRange"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.1415")]),t._v("\nCells"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.1415")]),t._v("\n\n")])])]),e("p",[t._v("However, when several workbooks are open at the same time -- particularly and especially when VBA code is running from an Excel Add-In -- references to the "),e("code",[t._v("ActiveWorkbook")]),t._v(" may be confused or misdirected. For example, an add-in with a UDF that checks the time of day and compares it to a value stored on one of the add-in's worksheets (that are typically not readily visible to the user) will have to explicitly identify which workbook is being referenced. In our example, our open (and active) workbook has a formula in cell A1 "),e("code",[t._v("=EarlyOrLate()")]),t._v(" and does NOT have any VBA written for that active workbook. In our add-in, we have the following User Defined Function (UDF):")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" EarlyOrLate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" Hour"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Now"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ThisWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sheets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WatchTime"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Range"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        EarlyOrLate "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"It\'s Late!"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        EarlyOrLate "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"It\'s Early!"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),e("p",[t._v('The code for the UDF is written and stored in the installed Excel add-in. It uses data stored on a worksheet in the add-in called "WatchTime". If the UDF had used '),e("code",[t._v("ActiveWorkbook")]),t._v(" instead of "),e("code",[t._v("ThisWorkbook")]),t._v(", then it would never be able to guarantee which workbook was intended.")]),t._v(" "),e("h2",{attrs:{id:"changing-the-default-number-of-worksheets-in-a-new-workbook"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#changing-the-default-number-of-worksheets-in-a-new-workbook"}},[t._v("#")]),t._v(" Changing The Default Number of Worksheets In A New Workbook")]),t._v(" "),e("p",[t._v('The "factory default" number of worksheets created in a new Excel workbook is generally set to three. Your VBA code can explicitly set the number of worksheets in a new workbook.')]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- save the current Excel global setting")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" Application\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" oldSheetsCount "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n    oldSheetsCount "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SheetsInNewWorkbook\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" myNewWB "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SheetsInNewWorkbook "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" myNewWB "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- restore the previous setting")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SheetsInNewWorkbook "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldsheetcount\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"application-workbooks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#application-workbooks"}},[t._v("#")]),t._v(" Application Workbooks")]),t._v(" "),e("p",[t._v('In many Excel applications, the VBA code takes actions directed at the workbook in which it\'s contained. You save that workbook with a ".xlsm" extension and the VBA macros only focus on the worksheets and data within. However, there are often times when you need to combine or merge data from other workbooks, or write some of your data to a separate workbook. Opening, closing, saving, creating, and deleting other workbooks is a common need for many VBA applications.')]),t._v(" "),e("p",[t._v("At any time in the VBA Editor, you can view and access any and all workbooks currently open by that instance of Excel by using the "),e("code",[t._v("Workbooks")]),t._v(" property of the "),e("code",[t._v("Application")]),t._v(" object. The "),e("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/office/ff820765.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("MSDN Documentation"),e("OutboundLink")],1),t._v(" explains it with references.")]),t._v(" "),e("h2",{attrs:{id:"opening-a-new-workbook-even-if-it-s-already-open"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#opening-a-new-workbook-even-if-it-s-already-open"}},[t._v("#")]),t._v(" Opening A (New) Workbook, Even If It's Already Open")]),t._v(" "),e("p",[t._v("If you want to access a workbook that's already open, then getting the assignment from the "),e("code",[t._v("Workbooks")]),t._v(" collection is straightforward:")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dim")]),t._v(" myWB "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" Workbook\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" myWB "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UsuallyFullPathnameOfWorkbook.xlsx"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),e("p",[t._v("If you want to create a new workbook, then use the "),e("code",[t._v("Workbooks")]),t._v(" collection object to "),e("code",[t._v("Add")]),t._v(" a new entry.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" myNewWB "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" Workbook\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" myNewWB "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add\n\n")])])]),e("p",[t._v("There are times when you may not or (or care) if the workbook you need is open already or not, or possible does not exist. The example function shows how to always return a valid workbook object.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetWorkbook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" wbFilename "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- returns a workbook object for the given filename, including checks")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'    for when the workbook is already open, exists but not open, or")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'    does not yet exist (and must be created)")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'    ***  wbFilename must be a fully specified pathname")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" folderFile "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" returnedWB "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" Workbook\n    \n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- check if the file exists in the directory location")]),t._v("\n    folderFile "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" File"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wbFilename"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" folderFile "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- the workbook doesn't exist, so create it")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" pos1 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" fileExt "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" fileFormatNum "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Long")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- in order to save the workbook correctly, we need to infer which workbook")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'    type the user intended from the file extension")]),t._v("\n        pos1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" InStrRev"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFullName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"."')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vbTextCompare"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        fileExt "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Right"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFullName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Len"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFullName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" pos1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Select")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Case")]),t._v(" fileExt\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Case")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xlsx"')]),t._v("\n                fileFormatNum "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("51")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Case")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xlsm"')]),t._v("\n                fileFormatNum "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Case")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xls"')]),t._v("\n                fileFormatNum "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("56")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Case")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xlsb"')]),t._v("\n                fileFormatNum "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Case")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n                Err"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Raise vbObjectError "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GetWorkbook function"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                         "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"The file type you\'ve requested (file extension) is not recognized. "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("_")]),t._v("\n                         "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Please use a known extension: xlsx, xlsm, xls, or xlsb."')]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Select")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" returnedWB "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add\n        Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayAlerts "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n        returnedWB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SaveAs filename"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("wbFilename"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" FileFormat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("fileFormatNum\n        Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayAlerts "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" GetWorkbook "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" returnedWB\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Else")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'--- the workbook exists in the directory, so check to see if")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'    it's already open or not")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("On")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Resume")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Next")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" returnedWB "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" returnedWB "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Is")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("Nothing")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" returnedWB "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Workbooks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Open"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFullName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),e("h2",{attrs:{id:"saving-a-workbook-without-asking-the-user"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#saving-a-workbook-without-asking-the-user"}},[t._v("#")]),t._v(" Saving A Workbook Without Asking The User")]),t._v(" "),e("p",[t._v("Often saving new data in an existing workbook using VBA will cause a pop-up question noting that the file already exists.")]),t._v(" "),e("p",[t._v("To prevent this pop-up question, you have to suppress these types of alerts.")]),t._v(" "),e("div",{staticClass:"language-vb extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vb"}},[e("code",[t._v("Application"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayAlerts "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'disable user prompt to overwrite file")]),t._v("\nmyWB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SaveAs FileName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NewOrExistingFilename.xlsx"')]),t._v("\nApplication"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayAlerts "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'re-enable user prompt to overwrite file")]),t._v("\n\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);