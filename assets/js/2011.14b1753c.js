(window.webpackJsonp=window.webpackJsonp||[]).push([[2011],{2419:function(t,e,s){"use strict";s.r(e);var a=s(31),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"getting-started-with-microsoft-sql-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getting-started-with-microsoft-sql-server"}},[t._v("#")]),t._v(" Getting started with Microsoft SQL Server")]),t._v(" "),s("h2",{attrs:{id:"insert-select-update-delete-the-basics-of-data-manipulation-language"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#insert-select-update-delete-the-basics-of-data-manipulation-language"}},[t._v("#")]),t._v(" INSERT / SELECT / UPDATE / DELETE: the basics of Data Manipulation Language")]),t._v(" "),s("p",[s("strong",[t._v("D")]),t._v("ata "),s("strong",[t._v("M")]),t._v("anipulation "),s("strong",[t._v("L")]),t._v("anguage (DML for short) includes operations such as "),s("code",[t._v("INSERT")]),t._v(", "),s("code",[t._v("UPDATE")]),t._v(" and "),s("code",[t._v("DELETE")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- Create a table HelloWorld")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" HelloWorld "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    Id "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IDENTITY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Description "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VARCHAR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- DML Operation INSERT, inserting a row into the table")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" HelloWorld "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Description"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello World'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- DML Operation SELECT, displaying the table ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" HelloWorld  \n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- Select a specific column from table")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" Description "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" HelloWorld\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- Display number of records in the table")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" HelloWorld\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- DML Operation UPDATE, updating a specific row in the table")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v(" HelloWorld "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" Description "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello, World!'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" Id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- Selecting rows from the table (see how the Description has changed after the update?)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" HelloWorld\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- DML Operation - DELETE, deleting a row from the table")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" HelloWorld "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" Id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- Selecting the table. See table content after DELETE operation ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" HelloWorld\n\n")])])]),s("p",[t._v("In this script we're "),s("strong",[t._v("creating a table")]),t._v(" to demonstrate some basic queries.")]),t._v(" "),s("p",[t._v("The following examples are showing how to "),s("strong",[t._v("query tables:")])]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USE")]),t._v(" Northwind"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nGO\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TOP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Customers \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" CompanyName\n\n")])])]),s("p",[t._v("will select the first 10 records of the "),s("code",[t._v("Customer")]),t._v(" table, ordered by the column "),s("code",[t._v("CompanyName")]),t._v(" from the database "),s("code",[t._v("Northwind")]),t._v(" (which is one of Microsoft's sample databases, it can be downloaded from "),s("strong",[s("a",{attrs:{href:"https://technet.microsoft.com/en-us/library/ms143221(v=sql.105).aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1)]),t._v("):")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://i.stack.imgur.com/6xeX4.jpg",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://i.stack.imgur.com/6xeX4.jpg",alt:"Northwind database query"}}),s("OutboundLink")],1)]),t._v(" "),s("p",[s("strong",[t._v("Note")]),t._v(" that "),s("code",[t._v("Use Northwind;")]),t._v(" changes the default database for all subsequent queries.\nYou can still reference the database by using the fully qualified syntax in the form of [Database].[Schema].[Table]:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TOP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Northwind"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Customers \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" CompanyName\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TOP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Pubs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Authors\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" City\n\n")])])]),s("p",[t._v("This is useful if you're querying data from different databases. Note that "),s("code",[t._v("dbo")]),t._v(', specified "in between" is called a schema and needs to be specified while using the fully qualified syntax. You can think of it as a folder within your database. '),s("code",[t._v("dbo")]),t._v(" is the default schema. The default schema may be omitted. All other user defined schemas need to be specified.")]),t._v(" "),s("p",[t._v("If the database table contains columns which are named like reserved words, e.g. "),s("code",[t._v("Date")]),t._v(", you need to enclose the column name in brackets, like this:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- descending order")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TOP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MyLogTable\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESC")]),t._v("\n\n")])])]),s("p",[t._v("The same applies if the column name contains spaces in its name (which is not recommended). An alternative syntax is to use double quotes instead of square brackets, e.g.:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- descending order")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("top")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Date"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MyLogTable\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Date"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),t._v(" \n\n")])])]),s("p",[t._v("is equivalent but not so commonly used. Notice the difference between double quotes and single quotes: Single quotes are used for strings, i.e.")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- descending order")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("top")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Date"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MyLogTable\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" UserId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'johndoe'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Date"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),t._v(" \n\n")])])]),s("p",[t._v("is a valid syntax. Notice that T-SQL has a "),s("code",[t._v("N")]),t._v(" prefix for NChar and NVarchar data types, e.g.")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TOP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Northwind"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Customers \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" CompanyName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("LIKE")]),t._v(" N"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AL%'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" CompanyName\n\n")])])]),s("p",[t._v("returns all companies having a company name starting with "),s("code",[t._v("AL")]),t._v(" ("),s("code",[t._v("%")]),t._v(" is a wild card, use it as you would use the asterisk in a DOS command line, e.g. "),s("code",[t._v("DIR AL*")]),t._v("). For "),s("code",[t._v("LIKE")]),t._v(", there are a couple of wildcards available, look "),s("strong",[s("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/ms179859.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1)]),t._v(" to find out more details.")]),t._v(" "),s("h3",{attrs:{id:"joins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#joins"}},[t._v("#")]),t._v(" "),s("strong",[t._v("Joins")])]),t._v(" "),s("p",[t._v("Joins are useful if you want to query fields which don't exist in one single table, but in multiple tables. For example: You want to query all columns from the "),s("code",[t._v("Region")]),t._v(" table in the "),s("code",[t._v("Northwind")]),t._v(" database. But you notice that you require also the "),s("code",[t._v("RegionDescription")]),t._v(", which is stored in a different table, "),s("code",[t._v("Region")]),t._v(". However, there is a common key, "),s("code",[t._v("RgionID")]),t._v(" which you can use to combine this information in a single query as follows ("),s("code",[t._v("Top 5")]),t._v(" just returns the first 5 rows, omit it to get all rows):")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TOP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" Territories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    Regions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegionDescription \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Territories \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INNER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" Region \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" Territories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegionID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Region"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegionID\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" TerritoryDescription\n\n")])])]),s("p",[t._v("will show all columns from "),s("code",[t._v("Territories")]),t._v(" plus the "),s("code",[t._v("RegionDescription")]),t._v(" column from "),s("code",[t._v("Region")]),t._v(". The result is ordered by "),s("code",[t._v("TerritoryDescription")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"table-aliases"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#table-aliases"}},[t._v("#")]),t._v(" "),s("strong",[t._v("Table Aliases")])]),t._v(" "),s("p",[t._v("When your query requires a reference to two or more tables, you may find it useful to use a Table Alias. Table aliases are shorthand references to tables that can be used in place of a full table name, and can reduce typing and editing. The syntax for using an alias is:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("TableName"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("alias"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n")])])]),s("p",[t._v("Where "),s("code",[t._v("as")]),t._v(" is an optional keyword. For example, the previous query can be rewritten as:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TOP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegionDescription \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Territories t\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INNER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" Region r \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegionID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegionID\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" TerritoryDescription\n\n")])])]),s("p",[t._v("Aliases must be unique for all tables in a query, even if you use the same table twice. For example, if your Employee table included a SupervisorId field, you can use this query to return an employee and his supervisor's name:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" SupervisorName "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- Rename the field for output")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Employee e\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INNER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" Employee s\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SupervisorId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EmployeeId\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EmployeeId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("111")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"unions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unions"}},[t._v("#")]),t._v(" "),s("strong",[t._v("Unions")])]),t._v(" "),s("p",[t._v("As we have seen before, a Join adds columns from different table sources. But what if you want to combine rows from different sources? In this case you can use a UNION. Suppose you're planning a party and want to invite not only employees but also the customers. Then you could run this query to do it:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" FirstName"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("LastName "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ContactName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Address"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" City "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Employees\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UNION")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" ContactName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Address"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" City "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Customers\n\n")])])]),s("p",[t._v("It will return names, addresses and cities from the employees and customers in one single table. Note that duplicate rows (if there should be any) are automatically eliminated (if you don't want this, use a "),s("code",[t._v("UNION ALL")]),t._v(" instead). The column number, column names, order and data type must match across all the select statements that are part of the union - this is why the first SELECT combines "),s("code",[t._v("FirstName")]),t._v(" and "),s("code",[t._v("LastName")]),t._v(" from Employee into "),s("code",[t._v("ContactName")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"table-variables"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#table-variables"}},[t._v("#")]),t._v(" "),s("strong",[t._v("Table Variables")])]),t._v(" "),s("p",[t._v('It can be useful, if you need to deal with temporary data (especially in a stored procedure), to use table variables: The difference between a "real" table and a table variable is that it just exists in memory for temporary processing.')]),t._v(" "),s("p",[s("strong",[t._v("Example:")])]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DECLARE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@Region")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  RegionID "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  RegionDescription "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("NChar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("creates a table in memory. In this case the "),s("code",[t._v("@")]),t._v(" prefix is mandatory because it is a variable. You can perform all DML operations mentioned above to insert, delete and select rows, e.g.")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@Region")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Northern'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@Region")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Southern'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("But normally, you would populate it based on a real table like")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@Region")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Region "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" RegionID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[t._v("which would read the filtered values from the real table "),s("code",[t._v("dbo.Region")]),t._v(" and insert it into the memory table "),s("code",[t._v("@Region")]),t._v(" - where it can be used for further processing. For example, you could use it in a join like")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Territories t\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@Region")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegionID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RegionID\n\n")])])]),s("p",[t._v("which would in this case return all "),s("code",[t._v("Northern")]),t._v(" and "),s("code",[t._v("Southern")]),t._v(" territories.\nMore detailed information can be found "),s("a",{attrs:{href:"http://odetocode.com/Articles/365.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1),t._v(". Temporary tables are discussed "),s("a",{attrs:{href:"https://www.simple-talk.com/sql/t-sql-programming/temporary-tables-in-sql-server/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1),t._v(", if you are interested to read more about that topic.")]),t._v(" "),s("p",[s("strong",[t._v("NOTE:")]),t._v(" Microsoft only recommends the use of table variables if the number of rows of data in the table variable are less than 100. If you will be working with larger amounts of data, use a "),s("strong",[t._v("temporary table")]),t._v(", or temp table, instead.")]),t._v(" "),s("h2",{attrs:{id:"select-all-rows-and-columns-from-a-table"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#select-all-rows-and-columns-from-a-table"}},[t._v("#")]),t._v(" SELECT all rows and columns from a table")]),t._v(" "),s("p",[t._v("Syntax:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" table_name\n\n")])])]),s("p",[t._v("Using the asterisk operator "),s("code",[t._v("*")]),t._v(" serves as a shortcut for selecting all the columns in the table. All rows will also be selected because this "),s("code",[t._v("SELECT")]),t._v(" statement does not have a "),s("code",[t._v("WHERE")]),t._v(" clause, to specify any filtering criteria.")]),t._v(" "),s("p",[t._v("This would also work the same way if you added an alias to the table, for instance "),s("code",[t._v("e")]),t._v(" in this case:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Employees "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" e\n\n")])])]),s("p",[t._v('Or if you wanted to select all from a specific table you can use the alias + " .* ":')]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DepartmentName\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Employees "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" e\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INNER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" Department "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" d \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DepartmentID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DepartmentID\n\n")])])]),s("p",[t._v("Database objects may also be accessed using fully qualified names:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("server_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("database_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("schema_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("table_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n")])])]),s("p",[t._v("This is not necessarily recommended, as changing the server and/or database names would cause the queries using fully-qualified names to no longer execute due to invalid object names.")]),t._v(" "),s("p",[t._v("Note that the fields before "),s("code",[t._v("table_name")]),t._v(" can be omitted in many cases if the queries are executed on a single server, database and schema, respectively. However, it is common for a database to have multiple schema, and in these cases the schema name should not be omitted when possible.")]),t._v(" "),s("p",[s("strong",[t._v("Warning:")]),t._v(" Using "),s("code",[t._v("SELECT *")]),t._v(" in production code or stored procedures can lead to problems later on (as new columns are added to the table, or if columns are rearranged in the table), especially if your code makes simple assumptions about the order of columns, or number of columns returned.  So it's safer to always explicitly specify column names in SELECT statements for production code.")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" col1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" col2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" col3\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" table_name\n\n")])])]),s("h2",{attrs:{id:"update-specific-row"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update-specific-row"}},[t._v("#")]),t._v(" UPDATE Specific Row")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v(" HelloWorlds\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" HelloWorld "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HELLO WORLD!!!'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" Id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n\n")])])]),s("p",[t._v('The above code updates the value of the field "HelloWorld" with "HELLO WORLD!!!" for the record where "Id = 5" in HelloWorlds table.')]),t._v(" "),s("p",[t._v('Note: In an update statement, It is advised to use a "where" clause to avoid updating the whole table unless and until your requirement is different.')]),t._v(" "),s("h2",{attrs:{id:"comments-in-code"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#comments-in-code"}},[t._v("#")]),t._v(" Comments in code")]),t._v(" "),s("p",[t._v("Transact-SQL supports two forms of comment writing.  Comments are ignored by the database engine, and are meant for people to read.")]),t._v(" "),s("p",[s("strong",[t._v("Comments")]),t._v(" are preceded by "),s("code",[t._v("--")]),t._v(" and are ignored until a new line is encountered:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- This is a comment")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" MyTable "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- This is another comment")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" Id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[s("strong",[t._v("Slash star comments")]),t._v(" begin with "),s("code",[t._v("/*")]),t._v(" and end with "),s("code",[t._v("*/")]),t._v(". All text between those delimiters is considered as a comment block.")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* This is\na multi-line\ncomment block. */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" Id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'First row'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UNION")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALL")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Second row'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* This is a one liner */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'More'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[t._v("Slash star comments have the advantage of keeping the comment usable if the SQL Statement loses new line characters.  This can happen when SQL is captured during troubleshooting.")]),t._v(" "),s("p",[t._v("Slash star comments can be nested and a starting "),s("code",[t._v("/*")]),t._v(" inside a slash star comment needs to be ended with a "),s("code",[t._v("*/")]),t._v(" to be valid. The following code will result in an error")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\nSELECT *\nFROM CommentTable\nWHERE Comment = '/*'\n*/")]),t._v("\n\n")])])]),s("p",[t._v("The slash star even though inside the quote is considered as the start of a comment. Hence it needs to be ended with another closing star slash.\nThe correct way would be")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\nSELECT *\nFROM CommentTable\nWHERE Comment = '/*'\n*/")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"delete-all-rows"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#delete-all-rows"}},[t._v("#")]),t._v(" DELETE All Rows")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Helloworlds\n\n")])])]),s("p",[t._v("This will delete all the data from the table. The table will contain no rows after you run this code. Unlike "),s("code",[t._v("DROP TABLE")]),t._v(", this preserves the table itself and its structure and you can continue to insert new rows into that table.")]),t._v(" "),s("p",[t._v("Another way to delete all rows in table is truncate it, as follow:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRUNCATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" HelloWords\n\n")])])]),s("p",[t._v("Difference with DELETE operation are several:")]),t._v(" "),s("ol",[s("li",[t._v("Truncate operation doesn't store in transaction log file")]),t._v(" "),s("li",[t._v("If exists "),s("code",[t._v("IDENTITY")]),t._v(" field, this will be reset")]),t._v(" "),s("li",[t._v("TRUNCATE can be applied on whole table and no on part of it (instead with "),s("code",[t._v("DELETE")]),t._v(" command you can associate a "),s("code",[t._v("WHERE")]),t._v(" clause)")])]),t._v(" "),s("p",[s("strong",[t._v("Restrictions Of TRUNCATE")])]),t._v(" "),s("ol",[s("li",[t._v("Cannot TRUNCATE a table if there is a "),s("code",[t._v("FOREIGN KEY")]),t._v(" reference")]),t._v(" "),s("li",[t._v("If the table is participated in an "),s("code",[t._v("INDEXED VIEW")])]),t._v(" "),s("li",[t._v("If the table is published by using "),s("code",[t._v("TRANSACTIONAL REPLICATION")]),t._v(" or "),s("code",[t._v("MERGE REPLICATION")])]),t._v(" "),s("li",[t._v("It will not fire any TRIGGER defined in the table")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/ms177570.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("[sic]"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"print"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#print"}},[t._v("#")]),t._v(" PRINT")]),t._v(" "),s("p",[t._v("Display a message to the output console. Using SQL Server Management Studio, this will be displayed in the messages tab, rather than the results tab:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRINT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello World!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"select-rows-that-match-a-condition"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#select-rows-that-match-a-condition"}},[t._v("#")]),t._v(" Select rows that match a condition")]),t._v(" "),s("p",[t._v("Generally, the syntax is:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("column")]),t._v(" names"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("condition"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n")])])]),s("p",[t._v("For example:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" FirstName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Age\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Users\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" LastName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Smith'")]),t._v("\n\n")])])]),s("p",[t._v("Conditions can be complex:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" FirstName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Age\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Users\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" LastName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Smith'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("City "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'New York'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("OR")]),t._v(" City "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Los Angeles'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"update-all-rows"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update-all-rows"}},[t._v("#")]),t._v(" UPDATE All Rows")]),t._v(" "),s("p",[t._v("A simple form of updating is incrementing all the values in a given field of the table.\nIn order to do so, we need to define the field and the increment value")]),t._v(" "),s("p",[t._v("The following is an example that increments the "),s("code",[t._v("Score")]),t._v(" field by 1 (in all rows):")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v(" Scores\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" score "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" score "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  \n\n")])])]),s("p",[t._v("This can be dangerous since you can corrupt your data if you accidentally make an  UPDATE for a "),s("strong",[t._v("specific Row")]),t._v(" with an  UPDATE for "),s("strong",[t._v("All rows")]),t._v(" in the table.")]),t._v(" "),s("h2",{attrs:{id:"retrieve-basic-server-information"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#retrieve-basic-server-information"}},[t._v("#")]),t._v(" Retrieve Basic Server Information")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" @"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@VERSION")]),t._v("\n\n")])])]),s("p",[t._v("Returns the version of MS SQL Server running on the instance.")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" @"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@SERVERNAME")]),t._v("\n\n")])])]),s("p",[t._v("Returns the name of the MS SQL Server instance.")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" @"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@SERVICENAME")]),t._v("\n\n")])])]),s("p",[t._v("Returns the name of the Windows service MS SQL Server is running as.")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" serverproperty"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ComputerNamePhysicalNetBIOS'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[t._v("Returns the physical name of the machine where SQL Server is running. Useful to identify the node in a failover cluster.")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" fn_virtualservernodes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[t._v("In a failover cluster returns every node where SQL Server can run on. It returns nothing if not a cluster.")]),t._v(" "),s("h2",{attrs:{id:"truncate-table"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#truncate-table"}},[t._v("#")]),t._v(" TRUNCATE TABLE")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRUNCATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" Helloworlds \n\n")])])]),s("p",[t._v("This code will delete all the data from the table Helloworlds. Truncate table is almost similar to "),s("code",[t._v("Delete from Table")]),t._v(" code. The difference is that you can not use where clauses with Truncate. Truncate table is considered better than delete because it uses less transaction log spaces.")]),t._v(" "),s("p",[t._v("Note that if an identity column exists, it is reset to the initial seed value (for example, auto-incremented ID will restart from 1). This can lead to inconsistency if the identity columns is used as a foreign key in another table.")]),t._v(" "),s("h2",{attrs:{id:"create-new-table-and-insert-records-from-old-table"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-new-table-and-insert-records-from-old-table"}},[t._v("#")]),t._v(" Create new table and insert records from old table")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" NewTable "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" OldTable\n\n")])])]),s("p",[t._v("Creates a new table with structure of old table and inserts all rows into the new table.")]),t._v(" "),s("p",[s("strong",[t._v("Some Restrictions")])]),t._v(" "),s("blockquote"),t._v(" "),s("ol",[t._v("\n- You cannot specify a table variable or table-valued parameter as the new table.\n"),s("li",[t._v("You cannot use SELECTINTO to create a partitioned table, even when the source table   is partitioned. SELECT...INTO does not use the\npartition scheme of the source table; instead, the new table is\ncreated in the default filegroup. To insert rows into a partitioned\ntable, you must first create the partitioned table and then use the\nINSERT INTO...SELECT FROM statement.")]),t._v(" "),s("li",[t._v("Indexes, constraints, and triggers defined in the source table are not transferred to the new table, nor can they be specified in the\nSELECT...INTO statement. If these objects are required, you can create\nthem after executing the SELECT...INTO statement.")]),t._v(" "),s("li",[t._v("Specifying an ORDER BY clause does not guarantee the rows are inserted in the specified order. When a sparse column is included in\nthe select list,  the sparse column property does not transfer to the\ncolumn in the new table. If this property is required in the new\ntable, alter the column definition after executing the SELECT...INTO\nstatement to include this property.")]),t._v(" "),s("li",[t._v("When a computed column is included in the select list, the corresponding column in the new table is not a computed column. The\nvalues in the new column are the values that were computed at the time\nSELECT...INTO was executed.")])]),t._v(" "),s("p",[t._v("["),s("strong",[s("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/ms188029.aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("sic"),s("OutboundLink")],1)]),t._v("]")]),t._v(" "),s("h2",{attrs:{id:"using-transactions-to-change-data-safely"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-transactions-to-change-data-safely"}},[t._v("#")]),t._v(" Using Transactions to change data safely")]),t._v(" "),s("p",[t._v("Whenever you change data, in a Data Manipulation Language(DML) command, you can wrap your changes in a transaction. DML includes "),s("code",[t._v("UPDATE")]),t._v(", "),s("code",[t._v("TRUNCATE")]),t._v(", "),s("code",[t._v("INSERT")]),t._v(" and "),s("code",[t._v("DELETE")]),t._v(". One of the ways that you can make sure that you're changing the right data would be to use a transaction.")]),t._v(" "),s("p",[t._v("DML changes will take a lock on the rows affected. When you begin a transaction, you must end the transaction or all objects being changed in the DML will remain locked by whoever began the transaction. You can end your transaction with either "),s("code",[t._v("ROLLBACK")]),t._v(" or "),s("code",[t._v("COMMIT")]),t._v(". "),s("code",[t._v("ROLLBACK")]),t._v(" returns everything within the transaction to its original state. "),s("code",[t._v("COMMIT")]),t._v(" places the data into a final state where you cannot undo your changes without another DML statement.")]),t._v(" "),s("p",[s("strong",[t._v("Example:")])]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--Create a test table")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("your "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("database")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGO\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" test_transaction "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("column_1 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nGO\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" \n dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test_transaction\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" column_1 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--This is the beginning of your transaction")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test_transaction\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" column_1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'B'")]),t._v("\nOUTPUT INSERTED"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" column_1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A'")]),t._v("\n  \n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROLLBACK")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--Rollback will undo your changes")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--Alternatively, use COMMIT to save your results")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test_transaction   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--View the table after your changes have been run")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" dbo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test_transaction\n\n")])])]),s("p",[s("strong",[t._v("Notes:")])]),t._v(" "),s("ul",[s("li",[t._v("This is a "),s("strong",[t._v("simplified example")]),t._v(" which does not include error handling. But any database operation can fail and hence throw an exception. "),s("strong",[s("a",{attrs:{href:"http://stackoverflow.com/a/2128105/1016343",target:"_blank",rel:"noopener noreferrer"}},[t._v("Here is an example"),s("OutboundLink")],1)]),t._v(" how such a required error handling might look like. You should "),s("strong",[t._v("never")]),t._v(" use transactions "),s("strong",[t._v("without an error handler")]),t._v(", otherwise you might leave the transaction in an unknown state.")]),t._v(" "),s("li",[t._v("Depending on the "),s("strong",[s("a",{attrs:{href:"https://technet.microsoft.com/en-us/library/ms189122(v=sql.105).aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("isolation level"),s("OutboundLink")],1)]),t._v(", transactions are putting locks on the data being queried or changed. You need to ensure that transactions are not running for a long time, because they will lock records in a database and can lead to "),s("strong",[s("a",{attrs:{href:"https://www.simple-talk.com/sql/performance/sql-server-deadlocks-by-example/",target:"_blank",rel:"noopener noreferrer"}},[t._v("deadlocks"),s("OutboundLink")],1)]),t._v(" with other parallel running transactions. Keep the operations encapsulated in transactions as short as possible and minimize the impact with the amount of data you're locking.")])]),t._v(" "),s("h2",{attrs:{id:"getting-table-row-count"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getting-table-row-count"}},[t._v("#")]),t._v(" Getting Table Row Count")]),t._v(" "),s("p",[t._v("The following example can be used to find the total row count for a specific table in a database if "),s("code",[t._v("table_name")]),t._v(" is replaced by the the table you wish to query:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("COUNT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("TotalRowCount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" table_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[t._v("It is also possible to get the row count for all tables by joining back to the table's partition based off the tables' HEAP (index_id = 0) or cluster clustered index (index_id = 1) using the following script:")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Tables")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("TableName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("SUM")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Partitions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("rows")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("TotalRowCount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v("    sys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tables")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Tables")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v("    sys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Partitions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Tables")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("object_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Partitions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("object_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Partitions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("index_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("IN")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--WHERE    [Tables].name = N'table name' /* uncomment to look for a specific table */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Tables")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[t._v("This is possible as every table is essentially a single partition table, unless extra partitions are added to it.\nThis script also has the benefit of not interfering with read/write operations to the tables rows'.")]),t._v(" "),s("h4",{attrs:{id:"remarks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[t._v("#")]),t._v(" Remarks")]),t._v(" "),s("p",[t._v("This is a set of examples highlighting basic usage of SQL Server.")])])}),[],!1,null,null,null);e.default=n.exports}}]);