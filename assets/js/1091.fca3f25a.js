(window.webpackJsonp=window.webpackJsonp||[]).push([[1091],{1499:function(e,t,a){"use strict";a.r(t);var s=a(31),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"powerpoint-integration-through-vba"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#powerpoint-integration-through-vba"}},[e._v("#")]),e._v(" PowerPoint Integration Through VBA")]),e._v(" "),a("h2",{attrs:{id:"the-basics-launching-powerpoint-from-vba"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-basics-launching-powerpoint-from-vba"}},[e._v("#")]),e._v(" The Basics: Launching PowerPoint from VBA")]),e._v(" "),a("p",[e._v("While there are many parameters that can be changed and variations that can be added depending on the desired functionality, this example lays out the basic framework for launching PowerPoint.")]),e._v(" "),a("blockquote"),e._v(" "),a("p",[a("strong",[e._v("Note:")]),e._v(" This code requires that the PowerPoint reference has been added to the active VBA Project.  See the "),a("a",{attrs:{href:"http://stackoverflow.com/documentation/excel-vba/777/introduction-to-excel-vba/6489/adding-a-new-object-library-reference#t=201607220850379525533",target:"_blank",rel:"noopener noreferrer"}},[e._v("References"),a("OutboundLink")],1),e._v(" Documentation entry to learn how to enable the reference.")]),e._v(" "),a("p",[e._v("First, define variables for the Application, Presentation, and Slide Objects.  While this can be done with late binding, it is always best to use early binding when applicable.")]),e._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" PPApp "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" PowerPoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Application\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" PPPres "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" PowerPoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Presentation\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Dim")]),e._v(" PPSlide "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("As")]),e._v(" PowerPoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Slide\n\n")])])]),a("p",[e._v("Next, open or create a new instance of the PowerPoint application.  Here, the "),a("code",[e._v("On Error Resume Next")]),e._v(" call is used to avoid an error being thrown by "),a("code",[e._v("GetObject")]),e._v(" if PowerPoint has not yet been opened.  See the "),a("a",{attrs:{href:"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/5411/error-handling#t=201607220853263117281",target:"_blank",rel:"noopener noreferrer"}},[e._v("Error Handling"),a("OutboundLink")],1),e._v(" example of the Best Practices Topic for a more detailed explanation.")]),e._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'Open PPT if not running, otherwise select active instance")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("On")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Error")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Resume")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Next")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Set")]),e._v(" PPApp "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" GetObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"PowerPoint.Application"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("On")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Error")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("GoTo")]),e._v(" ErrHandler\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("If")]),e._v(" PPApp "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Is")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("Nothing")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Then")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'Open PowerPoint")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Set")]),e._v(" PPApp "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" CreateObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"PowerPoint.Application"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    PPApp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Visible "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("True")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("End")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("If")]),e._v("\n\n")])])]),a("p",[e._v("Once the application has been launched, a new presentation and subsequently contained slide is generated for use.")]),e._v(" "),a("div",{staticClass:"language-vb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'Generate new Presentation and slide for graphic creation")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Set")]),e._v(" PPPres "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" PPApp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Presentations"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Add\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("Set")]),e._v(" PPSlide "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" PPPres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Slides"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" ppLayoutBlank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'Here, the slide type is set to the 4:3 shape with slide numbers enabled and the window ")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("'maximized on the screen.  These properties can, of course, be altered as needed")]),e._v("\n\nPPApp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ActiveWindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ViewType "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" ppViewSlide\nPPPres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("PageSetup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("SlideOrientation "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" msoOrientationHorizontal\nPPPres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("PageSetup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("SlideSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" ppSlideSizeOnScreen\nPPPres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("SlideMaster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("HeadersFooters"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("SlideNumber"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Visible "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" msoTrue\nPPApp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ActiveWindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("WindowState "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" ppWindowMaximized\n\n")])])]),a("p",[e._v("Upon completion of this code, a new PowerPoint window with a blank slide will be open.  By using the object variables, shapes, text, graphics, and excel ranges can be added as desired")]),e._v(" "),a("h4",{attrs:{id:"remarks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remarks"}},[e._v("#")]),e._v(" Remarks")]),e._v(" "),a("p",[e._v("This section demonstrates a variety of ways to interact with PowerPoint through VBA.  From showing data on slides to creating charts, PowerPoint is a very powerful tool when used in conjunction with Excel.  Thus, this section seeks to demonstrate the various ways VBA can be used to automate this interaction.")])])}),[],!1,null,null,null);t.default=n.exports}}]);