<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PHP - PHP MySQLi</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Close connection, MySQLi connect, Loop through MySQLi results, Prepared statements in MySQLi, Escaping Strings, MySQLi query, Debugging SQL in MySQLi, How to get data from a prepared statement, MySQLi Insert ID">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="PHP - PHP MySQLi">
    <meta property="og:description" content="Close connection, MySQLi connect, Loop through MySQLi results, Prepared statements in MySQLi, Escaping Strings, MySQLi query, Debugging SQL in MySQLi, How to get data from a prepared statement, MySQLi Insert ID">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/php/php-mysqli.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="PHP - PHP MySQLi">
    <meta name="twitter:description" content="Close connection, MySQLi connect, Loop through MySQLi results, Prepared statements in MySQLi, Escaping Strings, MySQLi query, Debugging SQL in MySQLi, How to get data from a prepared statement, MySQLi Insert ID">
    <meta name="twitter:url" content="/php/php-mysqli.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2493.f379ab22.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>PHP</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/php/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/php/installing-a-php-environment-on-windows.html" class="sidebar-link">Installing a PHP environment on Windows</a></li><li><a href="/php/installing-on-linux-unix-environments.html" class="sidebar-link">Installing on Linux/Unix Environments</a></li><li><a href="/php/getting-started-with-php.html" class="sidebar-link">Getting started with PHP</a></li><li><a href="/php/variables.html" class="sidebar-link">Variables</a></li><li><a href="/php/variable-scope.html" class="sidebar-link">Variable Scope</a></li><li><a href="/php/superglobal-variables-php.html" class="sidebar-link">Superglobal Variables PHP</a></li><li><a href="/php/outputting-the-value-of-a-variable.html" class="sidebar-link">Outputting the Value of a Variable</a></li><li><a href="/php/constants.html" class="sidebar-link">Constants</a></li><li><a href="/php/magic-constants.html" class="sidebar-link">Magic Constants</a></li><li><a href="/php/comments.html" class="sidebar-link">Comments</a></li><li><a href="/php/types.html" class="sidebar-link">Types</a></li><li><a href="/php/operators.html" class="sidebar-link">Operators</a></li><li><a href="/php/references.html" class="sidebar-link">References</a></li><li><a href="/php/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/php/array-iteration.html" class="sidebar-link">Array iteration</a></li><li><a href="/php/executing-upon-an-array.html" class="sidebar-link">Executing Upon an Array</a></li><li><a href="/php/manipulating-an-array.html" class="sidebar-link">Manipulating an Array</a></li><li><a href="/php/processing-multiple-arrays-together.html" class="sidebar-link">Processing Multiple Arrays Together</a></li><li><a href="/php/datetime-class.html" class="sidebar-link">Datetime Class</a></li><li><a href="/php/working-with-dates-and-time.html" class="sidebar-link">Working with Dates and Time</a></li><li><a href="/php/control-structures.html" class="sidebar-link">Control Structures</a></li><li><a href="/php/loops.html" class="sidebar-link">Loops</a></li><li><a href="/php/functions.html" class="sidebar-link">Functions</a></li><li><a href="/php/functional-programming.html" class="sidebar-link">Functional Programming</a></li><li><a href="/php/alternative-syntax-for-control-structures.html" class="sidebar-link">Alternative Syntax for Control Structures</a></li><li><a href="/php/string-formatting.html" class="sidebar-link">String formatting</a></li><li><a href="/php/string-parsing.html" class="sidebar-link">String Parsing</a></li><li><a href="/php/classes-and-objects.html" class="sidebar-link">Classes and Objects</a></li><li><a href="/php/namespaces.html" class="sidebar-link">Namespaces</a></li><li><a href="/php/sessions.html" class="sidebar-link">Sessions</a></li><li><a href="/php/cookies.html" class="sidebar-link">Cookies</a></li><li><a href="/php/output-buffering.html" class="sidebar-link">Output Buffering</a></li><li><a href="/php/json.html" class="sidebar-link">JSON</a></li><li><a href="/php/soap-client.html" class="sidebar-link">SOAP Client</a></li><li><a href="/php/using-curl-in-php.html" class="sidebar-link">Using cURL in PHP</a></li><li><a href="/php/reflection.html" class="sidebar-link">Reflection</a></li><li><a href="/php/dependency-injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/php/xml.html" class="sidebar-link">XML</a></li><li><a href="/php/simplexml.html" class="sidebar-link">SimpleXML</a></li><li><a href="/php/parsing-html.html" class="sidebar-link">Parsing HTML</a></li><li><a href="/php/regular-expressions-regexp-pcre.html" class="sidebar-link">Regular Expressions (regexp/PCRE)</a></li><li><a href="/php/traits.html" class="sidebar-link">Traits</a></li><li><a href="/php/composer-dependency-manager.html" class="sidebar-link">Composer Dependency Manager</a></li><li><a href="/php/magic-methods.html" class="sidebar-link">Magic Methods</a></li><li><a href="/php/file-handling.html" class="sidebar-link">File handling</a></li><li><a href="/php/streams.html" class="sidebar-link">Streams</a></li><li><a href="/php/type-hinting.html" class="sidebar-link">Type hinting</a></li><li><a href="/php/filters-filter-functions.html" class="sidebar-link">Filters &amp; Filter Functions</a></li><li><a href="/php/generators.html" class="sidebar-link">Generators</a></li><li><a href="/php/utf-8.html" class="sidebar-link">UTF-8</a></li><li><a href="/php/how-to-break-down-an-url.html" class="sidebar-link">How to break down an URL</a></li><li><a href="/php/object-serialization.html" class="sidebar-link">Object Serialization</a></li><li><a href="/php/serialization.html" class="sidebar-link">Serialization</a></li><li><a href="/php/closure.html" class="sidebar-link">Closure</a></li><li><a href="/php/reading-request-data.html" class="sidebar-link">Reading Request Data</a></li><li><a href="/php/type-juggling-and-non-strict-comparison-issues.html" class="sidebar-link">Type juggling and Non-Strict Comparison Issues</a></li><li><a href="/php/sockets.html" class="sidebar-link">Sockets</a></li><li><a href="/php/pdo.html" class="sidebar-link">PDO</a></li><li><a href="/php/php-mysqli.html" aria-current="page" class="active sidebar-link">PHP MySQLi</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/php/php-mysqli.html#close-connection" class="sidebar-link">Close connection</a></li><li class="sidebar-sub-header"><a href="/php/php-mysqli.html#mysqli-connect" class="sidebar-link">MySQLi connect</a></li><li class="sidebar-sub-header"><a href="/php/php-mysqli.html#loop-through-mysqli-results" class="sidebar-link">Loop through MySQLi results</a></li><li class="sidebar-sub-header"><a href="/php/php-mysqli.html#prepared-statements-in-mysqli" class="sidebar-link">Prepared statements in MySQLi</a></li><li class="sidebar-sub-header"><a href="/php/php-mysqli.html#escaping-strings" class="sidebar-link">Escaping Strings</a></li><li class="sidebar-sub-header"><a href="/php/php-mysqli.html#mysqli-query" class="sidebar-link">MySQLi query</a></li><li class="sidebar-sub-header"><a href="/php/php-mysqli.html#debugging-sql-in-mysqli" class="sidebar-link">Debugging SQL in MySQLi</a></li><li class="sidebar-sub-header"><a href="/php/php-mysqli.html#how-to-get-data-from-a-prepared-statement" class="sidebar-link">How to get data from a prepared statement</a></li><li class="sidebar-sub-header"><a href="/php/php-mysqli.html#mysqli-insert-id" class="sidebar-link">MySQLi Insert ID</a></li></ul></li><li><a href="/php/sqlite3.html" class="sidebar-link">SQLite3</a></li><li><a href="/php/using-mongodb.html" class="sidebar-link">Using MongoDB</a></li><li><a href="/php/mongo-php.html" class="sidebar-link">mongo-php</a></li><li><a href="/php/using-redis-with-php.html" class="sidebar-link">Using Redis with PHP</a></li><li><a href="/php/sending-email.html" class="sidebar-link">Sending Email</a></li><li><a href="/php/using-sqlsrv.html" class="sidebar-link">Using SQLSRV</a></li><li><a href="/php/command-line-interface-cli.html" class="sidebar-link">Command Line Interface (CLI)</a></li><li><a href="/php/localization.html" class="sidebar-link">Localization</a></li><li><a href="/php/headers-manipulation.html" class="sidebar-link">Headers Manipulation</a></li><li><a href="/php/coding-conventions.html" class="sidebar-link">Coding Conventions</a></li><li><a href="/php/asynchronous-programming.html" class="sidebar-link">Asynchronous programming</a></li><li><a href="/php/how-to-detect-client-ip-address.html" class="sidebar-link">How to Detect Client IP Address</a></li><li><a href="/php/create-pdf-files-in-php.html" class="sidebar-link">Create PDF files in PHP</a></li><li><a href="/php/yaml-in-php.html" class="sidebar-link">YAML in PHP</a></li><li><a href="/php/image-processing-with-gd.html" class="sidebar-link">Image Processing with GD</a></li><li><a href="/php/imagick.html" class="sidebar-link">Imagick</a></li><li><a href="/php/soap-server.html" class="sidebar-link">SOAP Server</a></li><li><a href="/php/machine-learning.html" class="sidebar-link">Machine learning</a></li><li><a href="/php/cache.html" class="sidebar-link">Cache</a></li><li><a href="/php/autoloading-primer.html" class="sidebar-link">Autoloading Primer</a></li><li><a href="/php/spl-data-structures.html" class="sidebar-link">SPL data structures</a></li><li><a href="/php/imap.html" class="sidebar-link">IMAP</a></li><li><a href="/php/http-authentication.html" class="sidebar-link">HTTP Authentication</a></li><li><a href="/php/websockets.html" class="sidebar-link">WebSockets</a></li><li><a href="/php/bc-math-binary-calculator.html" class="sidebar-link">BC Math (Binary Calculator)</a></li><li><a href="/php/docker-deployment.html" class="sidebar-link">Docker deployment</a></li><li><a href="/php/apcu.html" class="sidebar-link">APCu</a></li><li><a href="/php/php-built-in-server.html" class="sidebar-link">PHP Built in server</a></li><li><a href="/php/psr.html" class="sidebar-link">PSR</a></li><li><a href="/php/phpdoc.html" class="sidebar-link">PHPDoc</a></li><li><a href="/php/design-patterns.html" class="sidebar-link">Design Patterns</a></li><li><a href="/php/compile-php-extensions.html" class="sidebar-link">Compile PHP Extensions</a></li><li><a href="/php/common-errors.html" class="sidebar-link">Common Errors</a></li><li><a href="/php/compilation-of-errors-and-warnings.html" class="sidebar-link">Compilation of Errors and Warnings</a></li><li><a href="/php/exception-handling-and-error-reporting.html" class="sidebar-link">Exception Handling and Error Reporting</a></li><li><a href="/php/debugging.html" class="sidebar-link">Debugging</a></li><li><a href="/php/unit-testing.html" class="sidebar-link">Unit Testing</a></li><li><a href="/php/performance.html" class="sidebar-link">Performance</a></li><li><a href="/php/multiprocessing.html" class="sidebar-link">Multiprocessing</a></li><li><a href="/php/multi-threading-extension.html" class="sidebar-link">Multi Threading Extension</a></li><li><a href="/php/secure-remeber-me.html" class="sidebar-link">Secure Remeber Me</a></li><li><a href="/php/security.html" class="sidebar-link">Security</a></li><li><a href="/php/cryptography.html" class="sidebar-link">Cryptography</a></li><li><a href="/php/password-hashing-functions.html" class="sidebar-link">Password Hashing Functions</a></li><li><a href="/php/urls.html" class="sidebar-link">URLs</a></li><li><a href="/php/unicode-support-in-php.html" class="sidebar-link">Unicode Support in PHP</a></li><li><a href="/php/getting-started-with-php-7.html" class="sidebar-link">Getting started with php-7</a></li><li><a href="/php/null-coalesce-operator.html" class="sidebar-link">Null Coalesce Operator</a></li><li><a href="/php/spaceship-operator.html" class="sidebar-link">Spaceship operator</a></li><li><a href="/php/anonymous-class.html" class="sidebar-link">Anonymous class</a></li><li><a href="/php/contributing-to-the-php-manual.html" class="sidebar-link">Contributing to the PHP Manual</a></li><li><a href="/php/contributing-to-the-php-core.html" class="sidebar-link">Contributing to the PHP Core</a></li><li><a href="/php/getting-started-with-composer-php.html" class="sidebar-link">Getting started with composer-php</a></li><li><a href="/php/auto-loading-with-composer.html" class="sidebar-link">Auto loading with composer</a></li><li><a href="/php/how-to-use-private-repositories-with-composer.html" class="sidebar-link">How to use private repositories with Composer</a></li><li><a href="/php/getting-started-with-phpunit.html" class="sidebar-link">Getting Started with PHPUnit</a></li><li><a href="/php/assertions.html" class="sidebar-link">Assertions</a></li><li><a href="/php/test-doubles-mocks-and-stubs.html" class="sidebar-link">Test Doubles (Mocks and Stubs)</a></li><li><a href="/php/recipes.html" class="sidebar-link">Recipes</a></li><li><a href="/php/php-mysqli-affected-rows-returns-0-when-it-should-return-a-positive-integer.html" class="sidebar-link">php mysqli affected rows returns 0 when it should return a positive integer</a></li><li><a href="/php/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="php-mysqli"><a href="#php-mysqli" class="header-anchor">#</a> PHP MySQLi</h1> <p>The <a href="http://php.net/manual/en/book.mysqli.php" target="_blank" rel="noopener noreferrer"><code>mysqli</code> interface<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is an improvement (it means &quot;MySQL Improvement extension&quot;) of the <code>mysql</code> interface, which was deprecated in version 5.5 and is removed in version 7.0.
The mysqli extension, or as it is sometimes known, the MySQL improved extension, was developed to take advantage of new features found in MySQL systems versions 4.1.3 and newer. The mysqli extension is included with PHP versions 5 and later.</p> <h2 id="close-connection"><a href="#close-connection" class="header-anchor">#</a> Close connection</h2> <p>When we are finished querying the database, it is recommended to close the connection to free up resources.</p> <p><strong>Object oriented style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Procedural style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Note</strong>: The connection to the server will be closed as soon as the execution of the script ends, unless it's closed earlier by explicitly calling the close connection function.</p> <p><strong>Use Case:</strong> If our script has a fair amount of processing to perform after fetching the result and has retrieved the full result set, we definitely should close the connection. If we were not to, there's a chance the MySQL server will reach its connection limit when the web server is under heavy use.</p> <h2 id="mysqli-connect"><a href="#mysqli-connect" class="header-anchor">#</a> MySQLi connect</h2> <p><strong>Object oriented style</strong></p> <p>Connect to Server</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;localhost&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;my_user&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;my_password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Set the default database:</strong> <code>$conn-&gt;select_db(&quot;my_db&quot;);</code></p> <p>Connect to Database</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;localhost&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;my_user&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;my_password&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;my_db&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Procedural style</strong></p> <p>Connect to Server</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;localhost&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;my_user&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;my_password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Set the default database:</strong> <code>mysqli_select_db($conn, &quot;my_db&quot;);</code></p> <p>Connect to Database</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;localhost&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;my_user&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;my_password&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;my_db&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Verify Database Connection</strong></p> <p>Object oriented style</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token property">connect_errno</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">trigger_error</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token operator">-&gt;</span><span class="token property">connect_error</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">// else: successfully connected</span>

</code></pre></div><p>Procedural style</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$conn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">trigger_error</span><span class="token punctuation">(</span><span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">// else: successfully connected</span>

</code></pre></div><h2 id="loop-through-mysqli-results"><a href="#loop-through-mysqli-results" class="header-anchor">#</a> Loop through MySQLi results</h2> <p>PHP makes it easy to get data from your results and loop over it using a <code>while</code> statement. When it fails to get the next row, it returns <code>false</code>, and your loop ends. These examples work with</p> <ul><li><a href="http://php.net/manual/en/mysqli-result.fetch-assoc.php" target="_blank" rel="noopener noreferrer">mysqli_fetch_assoc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - Associative array with column names as keys</li> <li><a href="http://php.net/manual/en/mysqli-result.fetch-object.php" target="_blank" rel="noopener noreferrer">mysqli_fetch_object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - <code>stdClass</code> object with column names as variables</li> <li><a href="http://php.net/manual/en/mysqli-result.fetch-array.php" target="_blank" rel="noopener noreferrer">mysqli_fetch_array<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - Associative AND Numeric array (can use arguments to get one or the other)</li> <li><a href="http://php.net/manual/en/mysqli-result.fetch-row.php" target="_blank" rel="noopener noreferrer">mysqli_fetch_row<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - Numeric  array</li></ul> <p><strong>Object oriented style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-&gt;</span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Procedural style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>To get exact information from results, we can use:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-&gt;</span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Name and surname: '</span><span class="token operator">.</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">' '</span><span class="token operator">.</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'surname'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br&gt;'</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Age: '</span><span class="token operator">.</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'age'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br&gt;'</span><span class="token punctuation">;</span> <span class="token comment">// Prints info from 'age' column</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="prepared-statements-in-mysqli"><a href="#prepared-statements-in-mysqli" class="header-anchor">#</a> Prepared statements in MySQLi</h2> <p>Please read <a href="http://stackoverflow.com/documentation/php/5828/pdo/2685/preventing-sql-injection-with-parametrized-queries" target="_blank" rel="noopener noreferrer">Preventing SQL injection with Parametrized Queries<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for a complete discussion of why prepared statements help you secure your SQL statements from SQL Injection attacks</p> <p>The <code>$conn</code> variable here is a MySQLi object. See <a href="http://stackoverflow.com/documentation/php/2784/php-mysqli/9380/mysqli-connect#t=201607250822526544368" target="_blank" rel="noopener noreferrer">MySQLi connect example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for more details.</p> <p>For both examples, we assume that <code>$sql</code> is</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT column_1 
    FROM table 
    WHERE column_2 = ? 
        AND column_3 &gt; ?&quot;</span><span class="token punctuation">;</span>

</code></pre></div><p>The <code>?</code> represents the values we will provide later. Please note that we do not need quotes for the placeholders, regardless of the type. We can also only provide placeholders in the data portions of the query, meaning <code>SET</code>, <code>VALUES</code> and <code>WHERE</code>. You cannot use placeholders in the <code>SELECT</code> or <code>FROM</code> portions.</p> <p><strong>Object oriented style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">bind_param</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;si&quot;</span><span class="token punctuation">,</span> <span class="token variable">$column_2_value</span><span class="token punctuation">,</span> <span class="token variable">$column_3_value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">bind_result</span><span class="token punctuation">(</span><span class="token variable">$column_1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//Now use variable $column_1 one as if it were any other PHP variable</span>
  <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Procedural style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token function">mysqli_prepare</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">mysqli_stmt_bind_param</span><span class="token punctuation">(</span><span class="token variable">$stmt</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;si&quot;</span><span class="token punctuation">,</span> <span class="token variable">$column_2_value</span><span class="token punctuation">,</span> <span class="token variable">$column_3_value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">mysqli_stmt_execute</span><span class="token punctuation">(</span><span class="token variable">$stmt</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Fetch data here</span>
  <span class="token function">mysqli_stmt_close</span><span class="token punctuation">(</span><span class="token variable">$stmt</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>The first parameter of <code>$stmt-&gt;bind_param</code> or the second parameter of <code>mysqli_stmt_bind_param</code> is determined by the data type of the corresponding parameter in the SQL query:</p> <table><thead><tr><th>Parameter</th> <th>Data type of the bound parameter</th></tr></thead> <tbody><tr><td><code>i</code></td> <td>integer</td></tr> <tr><td><code>d</code></td> <td>double</td></tr> <tr><td><code>s</code></td> <td>string</td></tr> <tr><td><code>b</code></td> <td>blob</td></tr></tbody></table> <p>Your list of parameters needs to be in the order provided in your query.
In this example <code>si</code> means the first parameter <strong>(<code>column_2 = ?</code>)</strong> is string and the second parameter <strong>(<code>column_3 &gt; ?</code>)</strong> is integer.</p> <p>For retrieving data, see <a href="http://stackoverflow.com/documentation/php/2784/php-mysqli/24001/how-to-get-data-from-a-prepared-statements" target="_blank" rel="noopener noreferrer">How to get data from a prepared statement<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="escaping-strings"><a href="#escaping-strings" class="header-anchor">#</a> Escaping Strings</h2> <p>Escaping strings is an older (<strong>and less secure</strong>) method of securing data for insertion into a query. It works by using <a href="http://dev.mysql.com/doc/refman/5.7/en/mysql-real-escape-string.html" target="_blank" rel="noopener noreferrer">MySQL's function mysql_real_escape_string()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to process and sanitize the data (in other words, PHP is not doing the escaping). The MySQLi API provides direct access to this function</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$escaped</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token function">real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// OR</span>
<span class="token variable">$escaped</span> <span class="token operator">=</span> <span class="token function">mysqli_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>At this point, you have a string that MySQL considers to be safe for use in a direct query</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'SELECT * FROM users WHERE username = &quot;'</span> <span class="token operator">.</span> <span class="token variable">$escaped</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&quot;'</span><span class="token punctuation">;</span>
<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>So why is this not as secure as <a href="http://stackoverflow.com/documentation/php/2784/php-mysqli/11958/prepared-statements-in-mysqli" target="_blank" rel="noopener noreferrer">prepared statements<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>? There are ways to trick MySQL to produce a string it considers safe. Consider the following example</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">mysqli_real_escape_string</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;1 OR 1=1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'SELECT * FROM table WHERE id = '</span> <span class="token operator">.</span> <span class="token variable">$id</span><span class="token punctuation">;</span>

</code></pre></div><p><code>1 OR 1=1</code> does not represent data that MySQL will escape, yet this still represents SQL injection. There are <a href="http://stackoverflow.com/questions/5741187/sql-injection-that-gets-around-mysql-real-escape-string" target="_blank" rel="noopener noreferrer">other examples<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> as well that represent places where it returns unsafe data. The problem is that MySQL's escaping function is designed to <strong>make data comply with SQL syntax</strong>. It's NOT designed to make sure that <strong>MySQL can't confuse user data for SQL instructions</strong>.</p> <h2 id="mysqli-query"><a href="#mysqli-query" class="header-anchor">#</a> MySQLi query</h2> <p>The <code>query</code> function takes a valid SQL string and executes it directly against the database connection <code>$conn</code></p> <p><strong>Object oriented style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;SELECT * FROM `people`&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Procedural style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;SELECT * FROM `people`&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><blockquote></blockquote> <p><strong>CAUTION</strong></p> <p>A common problem here is that people will simply execute the query and expect it to work (i.e. return a <a href="https://secure.php.net/manual/en/class.mysqli-stmt.php" target="_blank" rel="noopener noreferrer">mysqli_stmt object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>). Since this function takes only a string, you're building the query first yourself. If there are any mistakes in the SQL at all, the MySQL compiler will fail, <strong>at which point this function will return <code>false</code></strong>.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'SELECT * FROM non_existent_table'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This query will fail</span>
<span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-&gt;</span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>The above code will generate a <code>E_FATAL</code> error because <code>$result</code> is <code>false</code>, and not an object.</p> <blockquote></blockquote> <p>PHP Fatal error: Call to a member function fetch_assoc() on a non-object</p> <p>The procedural error is similar, but not fatal, because we're just violating the expectations of the function.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// same query as previous</span>

</code></pre></div><p>You will get the following message from PHP</p> <blockquote></blockquote> <p>mysqli_fetch_array() expects parameter 1 to be mysqli_result, boolean given</p> <p>You can avoid this by doing a test first</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="debugging-sql-in-mysqli"><a href="#debugging-sql-in-mysqli" class="header-anchor">#</a> Debugging SQL in MySQLi</h2> <p>So your query has failed (see <a href="http://stackoverflow.com/documentation/php/2784/php-mysqli/9380/mysqli-connect" target="_blank" rel="noopener noreferrer">MySQLi connect<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for how we made <code>$conn</code>)</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'SELECT * FROM non_existent_table'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This query will fail</span>

</code></pre></div><p>How do we find out what happened? <code>$result</code> is <code>false</code> so that's no help. Thankfully the connect <code>$conn</code> can tell us what MySQL told us about the failure</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">trigger_error</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token property">error</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>or procedural</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">trigger_error</span><span class="token punctuation">(</span><span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>You should get an error similar to</p> <blockquote></blockquote> <p>Table 'my_db.non_existent_table' doesn't exist</p> <h2 id="how-to-get-data-from-a-prepared-statement"><a href="#how-to-get-data-from-a-prepared-statement" class="header-anchor">#</a> How to get data from a prepared statement</h2> <h3 id="prepared-statements"><a href="#prepared-statements" class="header-anchor">#</a> Prepared statements</h3> <p>See <a href="http://stackoverflow.com/documentation/php/2784/php-mysqli/11958/prepared-statements-in-mysqli" target="_blank" rel="noopener noreferrer">Prepared statements in MySQLi<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for how to prepare and execute a query.</p> <h3 id="binding-of-results"><a href="#binding-of-results" class="header-anchor">#</a> Binding of results</h3> <p><strong>Object-oriented style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">bind_result</span><span class="token punctuation">(</span><span class="token variable">$forename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Procedural style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">mysqli_stmt_bind_result</span><span class="token punctuation">(</span><span class="token variable">$stmt</span><span class="token punctuation">,</span> <span class="token variable">$forename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>The problem with using <code>bind_result</code> is that it requires the statement to specify the columns that will be used. This means that for the above to work the query must have looked like this <code>SELECT forename FROM users</code>. To include more columns simply add them as parameters to the <code>bind_result</code> function (and ensure that you add them to the SQL query).</p> <p>In both cases, we're assigning the <code>forename</code> column to the <code>$forename</code> variable. These functions take as many arguments as columns you want to assign. The assignment is only done once, since the function binds by reference.</p> <p>We can then loop as follows:</p> <p><strong>Object-oriented style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;<span class="token interpolation"><span class="token variable">$forename</span></span>&lt;br /&gt;&quot;</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Procedural style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">mysqli_stmt_fetch</span><span class="token punctuation">(</span><span class="token variable">$stmt</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;<span class="token interpolation"><span class="token variable">$forename</span></span>&lt;br /&gt;&quot;</span><span class="token punctuation">;</span>

</code></pre></div><p>The drawback to this is that you have to assign a lot of variables at once. This makes keeping track of large queries difficult. If you have <a href="http://php.net/manual/en/book.mysqlnd.php" target="_blank" rel="noopener noreferrer">MySQL Native Driver (<code>mysqlnd</code>)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> installed, all you need to do is use <a href="http://php.net/manual/en/mysqli-stmt.get-result.php" target="_blank" rel="noopener noreferrer">get_result<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p><strong>Object-oriented style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">get_result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Procedural style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_stmt_get_result</span><span class="token punctuation">(</span><span class="token variable">$stmt</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>This is <strong>much</strong> easier to work with because now we're getting a <a href="http://php.net/manual/en/class.mysqli-result.php" target="_blank" rel="noopener noreferrer">mysqli_result<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> object. This is the same object that <a href="http://stackoverflow.com/documentation/php/2784/php-mysqli/9381/mysqli-query" target="_blank" rel="noopener noreferrer">mysqli_query returns<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. This means you can use a <a href="http://stackoverflow.com/documentation/php/2784/php-mysqli/9382/loop-through-mysqli-results" target="_blank" rel="noopener noreferrer">regular result loop<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to get your data.</p> <h3 id="what-if-i-cannot-install-mysqlnd"><a href="#what-if-i-cannot-install-mysqlnd" class="header-anchor">#</a> What if I cannot install <code>mysqlnd</code>?</h3> <p>If that is the case then @Sophivorus has you covered with <a href="http://stackoverflow.com/a/30551477/3578036" target="_blank" rel="noopener noreferrer">this amazing answer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>This function can perform the task of <code>get_result</code> without it being installed on the server. It simply loops through the results and builds an associative array</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">function</span> <span class="token function-definition function">get_result</span><span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified type-declaration"><span class="token punctuation">\</span>mysqli_stmt</span> <span class="token variable">$statement</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$statement</span><span class="token operator">-&gt;</span><span class="token function">store_result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$statement</span><span class="token operator">-&gt;</span><span class="token property">num_rows</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$metadata</span> <span class="token operator">=</span> <span class="token variable">$statement</span><span class="token operator">-&gt;</span><span class="token function">result_metadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$params</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$field</span> <span class="token operator">=</span> <span class="token variable">$metadata</span><span class="token operator">-&gt;</span><span class="token function">fetch_field</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token variable">$params</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$field</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">call_user_func_array</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$statement</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'bind_result'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$statement</span><span class="token operator">-&gt;</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>We can then use the function to get results like this, just as if we were using <code>mysqli_fetch_assoc()</code></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$query</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;SELECT * FROM users WHERE forename LIKE ?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$condition</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;J%&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$query</span><span class="token operator">-&gt;</span><span class="token function">bind_param</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;s&quot;</span><span class="token punctuation">,</span> <span class="token variable">$condition</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$query</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">get_result</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">array_shift</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' - '</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;forename&quot;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;surname&quot;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br&gt;'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</span></code></pre></div><p>It will have the same output as if you were using the <code>mysqlnd</code> driver, except it does not have to be installed. This is very useful if you are unable to install said driver on your system. Just implement this solution.</p> <h2 id="mysqli-insert-id"><a href="#mysqli-insert-id" class="header-anchor">#</a> MySQLi Insert ID</h2> <p>Retrieve the last ID generated by an <a href="http://stackoverflow.com/documentation/sql/465/insert#t=20160725153942900947" target="_blank" rel="noopener noreferrer"><code>INSERT</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> query on a table with an <a href="http://stackoverflow.com/documentation/sql/505/primary-keys/1664/using-auto-increment#t=201607251534302898415" target="_blank" rel="noopener noreferrer">AUTO_INCREMENT<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> column.</p> <p><strong>Object-oriented Style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token property">insert_id</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Procedural Style</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">mysqli_insert_id</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><blockquote></blockquote> <p>Returns zero if there was no previous query on the connection or if the query did not update an AUTO_INCREMENT value.</p> <p><strong>Insert id when updating rows</strong></p> <p>Normally an <code>UPDATE</code> statement does not return an insert id, since an <code>AUTO_INCREMENT</code> id is only returned when a new row has been saved (or inserted). One way of making updates to the new id is to use <code>INSERT ... ON DUPLICATE KEY UPDATE</code> syntax for updating.</p> <p>Setup for examples to follow:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token constant">CREATE</span> <span class="token constant">TABLE</span> <span class="token function">iodku</span> <span class="token punctuation">(</span>
    id <span class="token keyword type-declaration">INT</span> <span class="token constant">AUTO_INCREMENT</span> <span class="token constant">NOT</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
    name <span class="token function">VARCHAR</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span> <span class="token constant">NOT</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
    misc <span class="token keyword type-declaration">INT</span> <span class="token constant">NOT</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
    <span class="token constant">PRIMARY</span> <span class="token function">KEY</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">UNIQUE</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token constant">ENGINE</span><span class="token operator">=</span>InnoDB<span class="token punctuation">;</span>

<span class="token constant">INSERT</span> <span class="token constant">INTO</span> <span class="token function">iodku</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> misc<span class="token punctuation">)</span>
    <span class="token function">VALUES</span>
    <span class="token punctuation">(</span><span class="token string single-quoted-string">'Leslie'</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string single-quoted-string">'Sally'</span><span class="token punctuation">,</span> <span class="token number">456</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query <span class="token constant">OK</span><span class="token punctuation">,</span> <span class="token number">2</span> rows <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
Records<span class="token punctuation">:</span> <span class="token number">2</span>  Duplicates<span class="token punctuation">:</span> <span class="token number">0</span>  Warnings<span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> <span class="token class-name">id</span> <span class="token operator">|</span> <span class="token class-name">name</span>   <span class="token operator">|</span> <span class="token class-name">misc</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token class-name">Leslie</span> <span class="token operator">|</span>  <span class="token number">123</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> <span class="token class-name">Sally</span>  <span class="token operator">|</span>  <span class="token number">456</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>

</code></pre></div><p>The case of IODKU performing an &quot;update&quot; and <code>LAST_INSERT_ID()</code> retrieving the relevant <code>id</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;INSERT INTO iodku (name, misc)
    VALUES
    ('Sally', 3333)            -- should update
    ON DUPLICATE KEY UPDATE    -- `name` will trigger &quot;</span>duplicate key<span class="token string double-quoted-string">&quot;
    id = LAST_INSERT_ID(id),
    misc = VALUES(misc)&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token property">insert_id</span><span class="token punctuation">;</span>        <span class="token operator">--</span> picking up existing <span class="token function">value</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

</code></pre></div><p>The case where IODKU performs an &quot;insert&quot; and <code>LAST_INSERT_ID()</code> retrieves the new <code>id</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$sql</span> <span class="token operator">=</span> &quot;<span class="token constant">INSERT</span> <span class="token constant">INTO</span> <span class="token function">iodku</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> misc<span class="token punctuation">)</span>
    <span class="token function">VALUES</span>
    <span class="token punctuation">(</span><span class="token string single-quoted-string">'Dana'</span><span class="token punctuation">,</span> <span class="token number">789</span><span class="token punctuation">)</span>            <span class="token operator">--</span> Should insert
    <span class="token constant">ON</span> <span class="token constant">DUPLICATE</span> <span class="token constant">KEY</span> <span class="token constant">UPDATE</span>
    id <span class="token operator">=</span> <span class="token function">LAST_INSERT_ID</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    misc <span class="token operator">=</span> <span class="token function">VALUES</span><span class="token punctuation">(</span>misc<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-&gt;</span><span class="token property">insert_id</span><span class="token punctuation">;</span>      <span class="token operator">--</span> picking up <span class="token keyword">new</span> <span class="token class-name">value</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

</code></pre></div><p>Resulting table contents:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> iodku<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> <span class="token class-name">id</span> <span class="token operator">|</span> <span class="token class-name">name</span>   <span class="token operator">|</span> <span class="token class-name">misc</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token class-name">Leslie</span> <span class="token operator">|</span>  <span class="token number">123</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> <span class="token class-name">Sally</span>  <span class="token operator">|</span> <span class="token number">3333</span> <span class="token operator">|</span>  <span class="token operator">--</span> <span class="token constant">IODKU</span> changed <span class="token class-name">this</span>
<span class="token operator">|</span>  <span class="token number">3</span> <span class="token operator">|</span> <span class="token class-name">Dana</span>   <span class="token operator">|</span>  <span class="token number">789</span> <span class="token operator">|</span>  <span class="token operator">--</span> <span class="token constant">IODKU</span> added this
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <h3 id="features"><a href="#features" class="header-anchor">#</a> Features</h3> <p>The mysqli interface has a number of benefits, the key enhancements over the mysql extension being:</p> <ul><li>Object-oriented interface</li> <li>Support for Prepared Statements</li> <li>Support for Multiple Statements</li> <li>Support for Transactions</li> <li>Enhanced debugging capabilities</li> <li>Embedded server support</li></ul> <p>It features a <a href="http://php.net/manual/en/mysqli.quickstart.dual-interface.php" target="_blank" rel="noopener noreferrer">dual interface<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: the older, procedural style and a new, <a href="https://en.wikipedia.org/wiki/Object-oriented_programming" target="_blank" rel="noopener noreferrer">object-oriented programming (OOP)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> style. The deprecated <code>mysql</code> had only a procedural interface, so the object-oriented style is often preferred. However, the new style is also favorable because of the power of OOP.</p> <h3 id="alternatives"><a href="#alternatives" class="header-anchor">#</a> Alternatives</h3> <p>An alternative to the <code>mysqli</code> interface to access databases is the newer <a href="http://stackoverflow.com/documentation/php/275/using-a-database/1030/basic-pdo-connection-and-retrieval#t=201607261841421573197" target="_blank" rel="noopener noreferrer">PHP Data Objects (PDO)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> interface. This features only OOP-style programming and can access more than only MySQL-type databases.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/php/php-mysqli.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/php/pdo.html" class="prev">
        PDO
      </a></span> <span class="next"><a href="/php/sqlite3.html">
        SQLite3
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2493.f379ab22.js" defer></script>
  </body>
</html>
