<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MongoDB - Indexes</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Dropping/Deleting an Index, Get Indices of a Collection, Sparse indexes and Partial indexes, Compound, Unique Index, Single field, Delete, List, Index Creation Basics">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="MongoDB - Indexes">
    <meta property="og:description" content="Dropping/Deleting an Index, Get Indices of a Collection, Sparse indexes and Partial indexes, Compound, Unique Index, Single field, Delete, List, Index Creation Basics">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/mongodb/indexes.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="MongoDB - Indexes">
    <meta name="twitter:description" content="Dropping/Deleting an Index, Get Indices of a Collection, Sparse indexes and Partial indexes, Compound, Unique Index, Single field, Delete, List, Index Creation Basics">
    <meta name="twitter:url" content="/mongodb/indexes.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/1956.ca99442c.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MongoDB</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mongodb/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/mongodb/getting-started-with-mongodb.html" class="sidebar-link">Getting started with MongoDB</a></li><li><a href="/mongodb/crud-operation.html" class="sidebar-link">CRUD Operation</a></li><li><a href="/mongodb/getting-database-information.html" class="sidebar-link">Getting database information</a></li><li><a href="/mongodb/querying-for-data-getting-started.html" class="sidebar-link">Querying for Data ( Getting Started )</a></li><li><a href="/mongodb/update-operators.html" class="sidebar-link">Update Operators</a></li><li><a href="/mongodb/upserts-and-inserts.html" class="sidebar-link">Upserts and Inserts</a></li><li><a href="/mongodb/collections.html" class="sidebar-link">Collections</a></li><li><a href="/mongodb/mongodb-aggregation.html" class="sidebar-link">MongoDB Aggregation</a></li><li><a href="/mongodb/aggregation.html" class="sidebar-link">Aggregation</a></li><li><a href="/mongodb/indexes.html" aria-current="page" class="active sidebar-link">Indexes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mongodb/indexes.html#dropping-deleting-an-index" class="sidebar-link">Dropping/Deleting an Index</a></li><li class="sidebar-sub-header"><a href="/mongodb/indexes.html#get-indices-of-a-collection" class="sidebar-link">Get Indices of a Collection</a></li><li class="sidebar-sub-header"><a href="/mongodb/indexes.html#sparse-indexes-and-partial-indexes" class="sidebar-link">Sparse indexes and Partial indexes</a></li><li class="sidebar-sub-header"><a href="/mongodb/indexes.html#compound" class="sidebar-link">Compound</a></li><li class="sidebar-sub-header"><a href="/mongodb/indexes.html#unique-index" class="sidebar-link">Unique Index</a></li><li class="sidebar-sub-header"><a href="/mongodb/indexes.html#single-field" class="sidebar-link">Single field</a></li><li class="sidebar-sub-header"><a href="/mongodb/indexes.html#delete" class="sidebar-link">Delete</a></li><li class="sidebar-sub-header"><a href="/mongodb/indexes.html#list" class="sidebar-link">List</a></li><li class="sidebar-sub-header"><a href="/mongodb/indexes.html#index-creation-basics" class="sidebar-link">Index Creation Basics</a></li></ul></li><li><a href="/mongodb/bulk-operations.html" class="sidebar-link">Bulk Operations</a></li><li><a href="/mongodb/2dsphere-index.html" class="sidebar-link">2dsphere Index</a></li><li><a href="/mongodb/pluggable-storage-engines.html" class="sidebar-link">Pluggable Storage Engines</a></li><li><a href="/mongodb/java-driver.html" class="sidebar-link">Java Driver</a></li><li><a href="/mongodb/python-driver.html" class="sidebar-link">Python Driver</a></li><li><a href="/mongodb/mongo-as-shards.html" class="sidebar-link">Mongo as Shards</a></li><li><a href="/mongodb/replication.html" class="sidebar-link">Replication</a></li><li><a href="/mongodb/mongo-as-a-replica-set.html" class="sidebar-link">Mongo as a Replica Set</a></li><li><a href="/mongodb/mongodb-configure-a-replicaset-to-support-tls-ssl.html" class="sidebar-link">MongoDB - Configure a ReplicaSet to support TLS/SSL</a></li><li><a href="/mongodb/authentication-mechanisms-in-mongodb.html" class="sidebar-link">Authentication Mechanisms in MongoDB</a></li><li><a href="/mongodb/mongodb-authorization-model.html" class="sidebar-link">MongoDB Authorization Model</a></li><li><a href="/mongodb/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/mongodb/backing-up-and-restoring-data.html" class="sidebar-link">Backing up and Restoring Data</a></li><li><a href="/mongodb/upgrading-mongodb-version.html" class="sidebar-link">Upgrading MongoDB version</a></li><li><a href="/mongodb/backing-up-and-restoring-data.html" class="sidebar-link">Backing up and Restoring Data</a></li><li><a href="/mongodb/mongo-as-a-replica-set.html" class="sidebar-link">Mongo as a Replica Set</a></li><li><a href="/mongodb/managing-mongodb.html" class="sidebar-link">Managing MongoDB</a></li><li><a href="/mongodb/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="indexes"><a href="#indexes" class="header-anchor">#</a> Indexes</h1> <h2 id="dropping-deleting-an-index"><a href="#dropping-deleting-an-index" class="header-anchor">#</a> Dropping/Deleting an Index</h2> <p>If index name is known,</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span><span class="token function">dropIndex</span><span class="token punctuation">(</span><span class="token string">'name_of_index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>If index name is not known,</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span><span class="token function">dropIndex</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">'name_of_field'</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="get-indices-of-a-collection"><a href="#get-indices-of-a-collection" class="header-anchor">#</a> Get Indices of a Collection</h2> <div class="language- extra-class"><pre class="language-text"><code>
db.collection.getIndexes();

</code></pre></div><p><strong>Output</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;_id_&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;cr_dr&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;cr_dr_1&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;cr_dr&quot;</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;index on cr_dr desc&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><h2 id="sparse-indexes-and-partial-indexes"><a href="#sparse-indexes-and-partial-indexes" class="header-anchor">#</a> Sparse indexes and Partial indexes</h2> <p><strong>Sparse indexes:</strong></p> <p>These can be particularly useful for fields that are optional but which should also be unique.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;john@example.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;nickname&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Johnnie&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;jane@example.com&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;julia@example.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;nickname&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Jules&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;jack@example.com&quot;</span> <span class="token punctuation">}</span>

</code></pre></div><p>Since two entries have no &quot;nickname&quot; specified and indexing will treat unspecified fields as null, the index creation would fail with 2 documents having 'null', so:</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>scores<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> nickname<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span> unique<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> sparse<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

</code></pre></div><p>will let you still have 'null' nicknames.</p> <p>Sparse indexes are more compact since they skip/ignore documents that don't specify that field. So if you have a collection where only less than 10% of documents specify this field, you can create much smaller indexes - making better use of limited memory if you want to do queries like:</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>scores<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'nickname'</span><span class="token operator">:</span> <span class="token string">'Johnnie'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p><strong>Partial indexes:</strong></p> <blockquote></blockquote> <p>Partial indexes represent a superset of the functionality offered by
sparse indexes and should be preferred over sparse indexes.
(**New in version 3.2**)</p> <p>Partial indexes determine the index entries based on the specified filter.</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>restaurants<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> cuisine<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> partialFilterExpression<span class="token operator">:</span> <span class="token punctuation">{</span> rating<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

</code></pre></div><p>If <code>rating</code> is greater than 5, then <code>cuisine</code> will be indexed. Yes, we can specify a property to be indexed based on the value of other properties also.</p> <p><strong>Difference between Sparse and Partial indexes:</strong></p> <p>Sparse indexes select documents to index solely based on the existence of the indexed field, or for compound indexes, the existence of the indexed fields.</p> <p>Partial indexes determine the index entries based on the specified filter. The filter can include fields other than the index keys and can specify conditions other than just an existence check.</p> <p>Still, a partial index can implement the same behavior as a sparse index</p> <p>Eg:</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>contacts<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span>
   <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span> partialFilterExpression<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $exists<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

</code></pre></div><blockquote></blockquote> <p>**Note:** Both the **partialFilterExpression** option and the **sparse** option
cannot be specified at the same time.</p> <h2 id="compound"><a href="#compound" class="header-anchor">#</a> Compound</h2> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>people<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>This creates an index on multiple fields, in this case on the <code>name</code> and <code>age</code> fields. It will be ascending in <code>name</code> and descending in <code>age</code>.</p> <p>In this type of index, the sort order is relevant, because it will determine whether the index can support a sort operation or not. Reverse sorting is supported on any prefix of a compound index, as long as the sort is in the reverse sort direction for <strong>all</strong> of the keys in the sort. Otherwise, sorting for compound indexes need to match the order of the index.</p> <p>Field order is also important, in this case the index will be sorted first by <code>name</code>, and within each name value, sorted by the values of the <code>age</code> field. This allows the index to be used by queries on the <code>name</code> field, or on <code>name</code> and <code>age</code>, but not on <code>age</code> alone.</p> <h2 id="unique-index"><a href="#unique-index" class="header-anchor">#</a> Unique Index</h2> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> unique<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>

</code></pre></div><p>enforce uniqueness on the defined index (either single or compound). Building the index will fail if the collection already contains duplicate values; the indexing will fail also with multiple entries missing the field (since they will all be indexed with the value <code>null</code>) unless <code>sparse: true</code> is specified.</p> <h2 id="single-field"><a href="#single-field" class="header-anchor">#</a> Single field</h2> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>people<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>This creates an ascending single field index on the field <strong>name</strong>.</p> <p>In this type of indexes the sort order is irrelevant, because mongo can traverse the index in both directions.</p> <h2 id="delete"><a href="#delete" class="header-anchor">#</a> Delete</h2> <p>To drop an index you could use the index name</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>people<span class="token punctuation">.</span><span class="token function">dropIndex</span><span class="token punctuation">(</span><span class="token string">&quot;nameIndex&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Or the index specification document</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>people<span class="token punctuation">.</span><span class="token function">dropIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="list"><a href="#list" class="header-anchor">#</a> List</h2> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>people<span class="token punctuation">.</span><span class="token function">getIndexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><p>This will return an array of documents each describing an index on the <strong>people</strong> collection</p> <h2 id="index-creation-basics"><a href="#index-creation-basics" class="header-anchor">#</a> Index Creation Basics</h2> <p>See the below transactions collection.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cr_dr <span class="token operator">:</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> amount <span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> fee <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cr_dr <span class="token operator">:</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> amount <span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> fee <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cr_dr <span class="token operator">:</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> amount <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  fee <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cr_dr <span class="token operator">:</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> amount <span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> fee <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cr_dr <span class="token operator">:</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> amount <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  fee <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cr_dr <span class="token operator">:</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> amount <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  fee <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cr_dr <span class="token operator">:</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> amount <span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> fee <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><code>getIndexes()</code> functions will show all the indices available for a collection.</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">getIndexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Let see the output of above statement.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;_id_&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><p>There is already one index for transaction collection. This is because MongoDB creates a <strong>unique index</strong> on the <code>_id</code> field during the creation of a collection. The <code>_id</code> index prevents clients from inserting two documents with the same value for the <code>_id</code> field. You cannot drop this index on the <code>_id</code> field.</p> <p>Now let's add an index for cr_dr field;</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cr_dr <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>The result of the index execution is as follows.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;createdCollectionAutomatically&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string">&quot;numIndexesBefore&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;numIndexesAfter&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string">&quot;ok&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

</code></pre></div><blockquote></blockquote> <p>The createdCollectionAutomatically indicates if the operation created
a collection. If a collection does not exist, MongoDB creates the
collection as part of the indexing operation.</p> <p>Let run <code>db.transactions.getIndexes();</code> again.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;_id_&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;cr_dr&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;cr_dr_1&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><p>Now you see transactions collection have two indices. Default <code>_id</code> index and <code>cr_dr_1</code> which we created. The name is assigned by MongoDB. You can set your own name like below.</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cr_dr <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>name <span class="token operator">:</span> <span class="token string">&quot;index on cr_dr desc&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>Now <code>db.transactions.getIndexes();</code> will give you three indices.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;_id_&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;cr_dr&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;cr_dr_1&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;cr_dr&quot;</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;index on cr_dr desc&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><p>While creating index <code>{ cr_dr : -1 }</code> 1 means index will be in <code>ascending</code> order and -1 for <code>descending</code> order.</p> <h3 id="hashed-indexes"><a href="#hashed-indexes" class="header-anchor">#</a> Hashed indexes</h3> <p>Indexes can be defined also as <strong>hashed</strong>. This is more performant on <strong>equality queries</strong>, but is not efficient for <strong>range queries</strong>; however you can define both hashed and ascending/descending indexes on the same field.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cr_dr <span class="token operator">:</span> <span class="token string">&quot;hashed&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    

<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">getIndexes</span><span class="token punctuation">(</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;_id_&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;cr_dr&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;hashed&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;cr_dr_hashed&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;documentation_db.transactions&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li><code>db.collection.createIndex({ &lt;string field&gt; : &lt;1|-1 order&gt; [, &lt;string field&gt; : &lt;1|-1 order&gt;] });</code></li></ul> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p><strong>Performance Impact</strong>: Note that indexes improve read performances, but can have bad impact on write performance, as inserting a document requires updating all indexes.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/mongodb/indexes.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mongodb/aggregation.html" class="prev">
        Aggregation
      </a></span> <span class="next"><a href="/mongodb/bulk-operations.html">
        Bulk Operations
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/1956.ca99442c.js" defer></script>
  </body>
</html>
