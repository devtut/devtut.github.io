<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PowerShell - Powershell Modules</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Create a Module Manifest, Simple Module Example, Exporting a Variable from a Module, Structuring PowerShell Modules, Location of Modules, Module Member Visibility">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="PowerShell - Powershell Modules">
    <meta property="og:description" content="Create a Module Manifest, Simple Module Example, Exporting a Variable from a Module, Structuring PowerShell Modules, Location of Modules, Module Member Visibility">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/powershell/powershell-modules.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="PowerShell - Powershell Modules">
    <meta name="twitter:description" content="Create a Module Manifest, Simple Module Example, Exporting a Variable from a Module, Structuring PowerShell Modules, Location of Modules, Module Member Visibility">
    <meta name="twitter:url" content="/powershell/powershell-modules.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/2612.0478ad64.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>PowerShell</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powershell/" class="sidebar-link">Disclaimer</a></li><li><a href="/powershell/getting-started-with-powershell.html" class="sidebar-link">Getting started with PowerShell</a></li><li><a href="/powershell/variables-in-powershell.html" class="sidebar-link">Variables in PowerShell</a></li><li><a href="/powershell/operators.html" class="sidebar-link">Operators</a></li><li><a href="/powershell/special-operators.html" class="sidebar-link">Special Operators</a></li><li><a href="/powershell/basic-set-operations.html" class="sidebar-link">Basic Set Operations</a></li><li><a href="/powershell/conditional-logic.html" class="sidebar-link">Conditional logic</a></li><li><a href="/powershell/loops.html" class="sidebar-link">Loops</a></li><li><a href="/powershell/switch-statement.html" class="sidebar-link">Switch statement</a></li><li><a href="/powershell/strings.html" class="sidebar-link">Strings</a></li><li><a href="/powershell/hashtables.html" class="sidebar-link">HashTables</a></li><li><a href="/powershell/working-with-objects.html" class="sidebar-link">Working with Objects</a></li><li><a href="/powershell/powershell-functions.html" class="sidebar-link">PowerShell Functions</a></li><li><a href="/powershell/powershell-classes.html" class="sidebar-link">PowerShell Classes</a></li><li><a href="/powershell/powershell-modules.html" class="active sidebar-link">Powershell Modules</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/powershell/powershell-modules.html#create-a-module-manifest" class="sidebar-link">Create a Module Manifest</a></li><li class="sidebar-sub-header"><a href="/powershell/powershell-modules.html#simple-module-example" class="sidebar-link">Simple Module Example</a></li><li class="sidebar-sub-header"><a href="/powershell/powershell-modules.html#exporting-a-variable-from-a-module" class="sidebar-link">Exporting a Variable from a Module</a></li><li class="sidebar-sub-header"><a href="/powershell/powershell-modules.html#structuring-powershell-modules" class="sidebar-link">Structuring PowerShell Modules</a></li><li class="sidebar-sub-header"><a href="/powershell/powershell-modules.html#location-of-modules" class="sidebar-link">Location of Modules</a></li><li class="sidebar-sub-header"><a href="/powershell/powershell-modules.html#module-member-visibility" class="sidebar-link">Module Member Visibility</a></li></ul></li><li><a href="/powershell/powershell-profiles.html" class="sidebar-link">Powershell profiles</a></li><li><a href="/powershell/calculated-properties.html" class="sidebar-link">Calculated Properties</a></li><li><a href="/powershell/using-existing-static-classes.html" class="sidebar-link">Using existing static classes</a></li><li><a href="/powershell/built-in-variables.html" class="sidebar-link">Built-in variables</a></li><li><a href="/powershell/automatic-variables.html" class="sidebar-link">Automatic Variables</a></li><li><a href="/powershell/automatic-variables-part-2.html" class="sidebar-link">Automatic Variables - part 2</a></li><li><a href="/powershell/environment-variables.html" class="sidebar-link">Environment Variables</a></li><li><a href="/powershell/splatting.html" class="sidebar-link">Splatting</a></li><li><a href="/powershell/powershell-streams-debug-verbose-warning-error-output-and-information.html" class="sidebar-link">PowerShell &quot;Streams&quot;; Debug, Verbose, Warning, Error, Output and Information</a></li><li><a href="/powershell/sending-email.html" class="sidebar-link">Sending Email</a></li><li><a href="/powershell/powershell-remoting.html" class="sidebar-link">Powershell Remoting</a></li><li><a href="/powershell/working-with-the-powershell-pipeline.html" class="sidebar-link">Working with the PowerShell pipeline</a></li><li><a href="/powershell/powershell-background-jobs.html" class="sidebar-link">PowerShell Background Jobs</a></li><li><a href="/powershell/return-behavior-in-powershell.html" class="sidebar-link">Return behavior in PowerShell</a></li><li><a href="/powershell/csv-parsing.html" class="sidebar-link">CSV parsing</a></li><li><a href="/powershell/working-with-xml-files.html" class="sidebar-link">Working with XML Files</a></li><li><a href="/powershell/communicating-with-restful-apis.html" class="sidebar-link">Communicating with RESTful APIs</a></li><li><a href="/powershell/powershell-sql-queries.html" class="sidebar-link">powershell sql queries</a></li><li><a href="/powershell/regular-expressions.html" class="sidebar-link">Regular Expressions</a></li><li><a href="/powershell/aliases.html" class="sidebar-link">Aliases</a></li><li><a href="/powershell/using-the-progress-bar.html" class="sidebar-link">Using the progress bar</a></li><li><a href="/powershell/powershell-exe-command-line.html" class="sidebar-link">PowerShell.exe Command-Line</a></li><li><a href="/powershell/cmdlet-naming.html" class="sidebar-link">Cmdlet Naming</a></li><li><a href="/powershell/running-executables.html" class="sidebar-link">Running Executables</a></li><li><a href="/powershell/enforcing-script-prerequisites.html" class="sidebar-link">Enforcing script prerequisites</a></li><li><a href="/powershell/using-the-help-system.html" class="sidebar-link">Using the Help System</a></li><li><a href="/powershell/modules-scripts-and-functions.html" class="sidebar-link">Modules, Scripts and Functions</a></li><li><a href="/powershell/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/powershell/common-parameters.html" class="sidebar-link">Common parameters</a></li><li><a href="/powershell/parameter-sets.html" class="sidebar-link">Parameter sets</a></li><li><a href="/powershell/powershell-dynamic-parameters.html" class="sidebar-link">PowerShell Dynamic Parameters</a></li><li><a href="/powershell/gui-in-powershell.html" class="sidebar-link">GUI in Powershell</a></li><li><a href="/powershell/url-encode-decode.html" class="sidebar-link">URL Encode/Decode</a></li><li><a href="/powershell/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/powershell/package-management.html" class="sidebar-link">Package management</a></li><li><a href="/powershell/tcp-communication-with-powershell.html" class="sidebar-link">TCP Communication with PowerShell</a></li><li><a href="/powershell/powershell-workflows.html" class="sidebar-link">PowerShell Workflows</a></li><li><a href="/powershell/embedding-managed-code-c-vb.html" class="sidebar-link">Embedding Managed Code (C# | VB)</a></li><li><a href="/powershell/how-to-download-latest-artifact-from-artifactory-using-powershell-script-v2-0-or-below.html" class="sidebar-link">How to download latest artifact from Artifactory using Powershell script (v2.0 or below)?</a></li><li><a href="/powershell/comment-based-help.html" class="sidebar-link">Comment-based help</a></li><li><a href="/powershell/archive-module.html" class="sidebar-link">Archive Module</a></li><li><a href="/powershell/infrastructure-automation.html" class="sidebar-link">Infrastructure Automation</a></li><li><a href="/powershell/psscriptanalyzer-powershell-script-analyzer.html" class="sidebar-link">PSScriptAnalyzer - PowerShell Script Analyzer</a></li><li><a href="/powershell/desired-state-configuration.html" class="sidebar-link">Desired State Configuration</a></li><li><a href="/powershell/using-shouldprocess.html" class="sidebar-link">Using ShouldProcess</a></li><li><a href="/powershell/scheduled-tasks-module.html" class="sidebar-link">Scheduled tasks module</a></li><li><a href="/powershell/ise-module.html" class="sidebar-link">ISE module</a></li><li><a href="/powershell/creating-dsc-class-based-resources.html" class="sidebar-link">Creating DSC Class-Based Resources</a></li><li><a href="/powershell/wmi-and-cim.html" class="sidebar-link">WMI and CIM</a></li><li><a href="/powershell/activedirectory-module.html" class="sidebar-link">ActiveDirectory module</a></li><li><a href="/powershell/sharepoint-module.html" class="sidebar-link">SharePoint Module</a></li><li><a href="/powershell/introduction-to-psake.html" class="sidebar-link">Introduction to Psake</a></li><li><a href="/powershell/introduction-to-pester.html" class="sidebar-link">Introduction to Pester</a></li><li><a href="/powershell/handling-secrets-and-credentials.html" class="sidebar-link">Handling Secrets and Credentials</a></li><li><a href="/powershell/security-and-cryptography.html" class="sidebar-link">Security and Cryptography</a></li><li><a href="/powershell/signing-scripts.html" class="sidebar-link">Signing Scripts</a></li><li><a href="/powershell/anonymize-ip-v4-and-v6-in-text-file-with-powershell.html" class="sidebar-link">Anonymize IP (v4 and v6) in text file with Powershell</a></li><li><a href="/powershell/amazon-web-services-aws-rekognition.html" class="sidebar-link">Amazon Web Services (AWS) Rekognition</a></li><li><a href="/powershell/amazon-web-services-aws-simple-storage-service-s3.html" class="sidebar-link">Amazon Web Services (AWS) Simple Storage Service (S3)</a></li><li><a href="/powershell/mongodb.html" class="sidebar-link">MongoDB</a></li><li><a href="/powershell/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="powershell-modules"><a href="#powershell-modules" class="header-anchor">#</a> Powershell Modules</h1> <p>Starting with PowerShell version 2.0, developers can create PowerShell modules. PowerShell modules encapsulate a set of common functionality. For example, there are vendor-specific PowerShell modules that manage various cloud services. There are also generic PowerShell modules that interact with social media services, and perform common programming tasks, such as Base64 encoding, working with Named Pipes, and more.</p> <p>Modules can expose command aliases, functions, variables, classes, and more.</p> <h2 id="create-a-module-manifest"><a href="#create-a-module-manifest" class="header-anchor">#</a> Create a Module Manifest</h2> <div class="language-powershell extra-class"><pre class="language-powershell"><code>@<span class="token punctuation">{</span>
  RootModule = <span class="token string">'MyCoolModule.psm1'</span>
  ModuleVersion = <span class="token string">'1.0'</span>
  CompatiblePSEditions = @<span class="token punctuation">(</span><span class="token string">'Core'</span><span class="token punctuation">)</span>
  GUID = <span class="token string">'6b42c995-67da-4139-be79-597a328056cc'</span>
  Author = <span class="token string">'Bob Schmob'</span>
  CompanyName = <span class="token string">'My Company'</span>
  Copyright = <span class="token string">'(c) 2017 Administrator. All rights reserved.'</span>
  Description = <span class="token string">'It does cool stuff.'</span>
  FunctionsToExport = @<span class="token punctuation">(</span><span class="token punctuation">)</span>
  CmdletsToExport = @<span class="token punctuation">(</span><span class="token punctuation">)</span>
  VariablesToExport = @<span class="token punctuation">(</span><span class="token punctuation">)</span>
  AliasesToExport = @<span class="token punctuation">(</span><span class="token punctuation">)</span>
  DscResourcesToExport = @<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Every good PowerShell module has a module manifest. The module manifest simply contains metadata about a PowerShell module, and doesn't define the actual contents of the module.</p> <p>The manifest file is a PowerShell script file, with a <code>.psd1</code> file extension, that contains a HashTable. The HashTable in the manifest must contain specific keys, in order for PowerShell to correctly interpret it as a PowerShell module file.</p> <p>The example above provides a list of the core HashTable keys that make up a module manifest, but there are many others. The <code>New-ModuleManifest</code> command helps you create a new module manifest skeleton.</p> <h2 id="simple-module-example"><a href="#simple-module-example" class="header-anchor">#</a> Simple Module Example</h2> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> Add <span class="token punctuation">{</span>
  <span class="token namespace">[CmdletBinding()]</span>
  <span class="token keyword">param</span> <span class="token punctuation">(</span>
    <span class="token namespace">[int]</span> <span class="token variable">$x</span>
  <span class="token punctuation">,</span> <span class="token namespace">[int]</span> <span class="token variable">$y</span>
  <span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token variable">$x</span> <span class="token operator">+</span> <span class="token variable">$y</span>
<span class="token punctuation">}</span>

<span class="token function">Export-ModuleMember</span> <span class="token operator">-</span><span class="token keyword">Function</span> Add

</code></pre></div><p>This is a simple example of what a PowerShell script module file might look like. This file would be called <code>MyCoolModule.psm1</code>, and is referenced from the module manifest (.psd1) file. You'll notice that the <code>Export-ModuleMember</code> command enables us to specify which functions in the module we want to &quot;export,&quot; or expose, to the user of the module. Some functions will be internal-only, and shouldn't be exposed, so those would be omitted from the call to <code>Export-ModuleMember</code>.</p> <h2 id="exporting-a-variable-from-a-module"><a href="#exporting-a-variable-from-a-module" class="header-anchor">#</a> Exporting a Variable from a Module</h2> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$FirstName</span> = <span class="token string">'Bob'</span>
<span class="token function">Export-ModuleMember</span> <span class="token operator">-</span>Variable FirstName

</code></pre></div><p>To export a variable from a module, you use the <code>Export-ModuleMember</code> command, with the <code>-Variable</code> parameter. Remember, however, that if the variable is also not explicitly exported in the module manifest (.psd1) file, then the variable will not be visible to the module consumer. Think of the module manifest like a &quot;gatekeeper.&quot; If a function or variable isn't allowed in the module manifest, it won't be visible to the module consumer.</p> <p><strong>Note:</strong> Exporting a variable is similar to making a field in a class public.  It is not advisable.  It would be better to expose a function to get the field and a function to set the field.</p> <h2 id="structuring-powershell-modules"><a href="#structuring-powershell-modules" class="header-anchor">#</a> Structuring PowerShell Modules</h2> <p>Rather than defining all of your functions in a single <code>.psm1</code> PowerShell script module file, you might want to break apart your function into individual files. You can then dot-source these files from your script module file, which in essence, treats them as if they were part of the <code>.psm1</code> file itself.</p> <p>Consider this module directory structure:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>\MyCoolModule
  \Functions
    Function1<span class="token punctuation">.</span>ps1
    Function2<span class="token punctuation">.</span>ps1
    Function3<span class="token punctuation">.</span>ps1
MyCoolModule<span class="token punctuation">.</span>psd1
MyCoolModule<span class="token punctuation">.</span>psm1

</code></pre></div><p>Inside your <code>MyCoolModule.psm1</code> file, you could insert the following code:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path <span class="token variable">$PSScriptRoot</span>\Functions <span class="token punctuation">|</span> 
  <span class="token function">ForEach-Object</span> <span class="token operator">-</span><span class="token keyword">Process</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span> <span class="token variable">$PSItem</span><span class="token punctuation">.</span>FullName <span class="token punctuation">}</span>

</code></pre></div><p>This would dot-source the individual function files into the <code>.psm1</code> module file.</p> <h2 id="location-of-modules"><a href="#location-of-modules" class="header-anchor">#</a> Location of Modules</h2> <p>PowerShell looks for modules in the directories listed in the $Env:PSModulepath.</p> <p>A module called <strong>foo</strong>, in a folder called <strong>foo</strong> will be found with <code>Import-Module foo</code></p> <p>In that folder, PowerShell will look for a module manifest (foo.psd1), a module file (foo.psm1), a DLL (foo.dll).</p> <h2 id="module-member-visibility"><a href="#module-member-visibility" class="header-anchor">#</a> Module Member Visibility</h2> <p>By default, only functions defined in a module are visible outside of the module. In other words, if you define variables and aliases in a module, they won't be available except in the module's code.</p> <p>To override this behavior, you can use the <code>Export-ModuleMember</code> cmdlet.  It has parameters called <code>-Function</code>, <code>-Variable</code>, and <code>-Alias</code> which allow you to specify exactly which members are exported.</p> <p>It is important to note that if you use <code>Export-ModuleMember</code>, <strong>only</strong> the items you specify will be visible.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/powershell/powershell-modules.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/powershell/powershell-classes.html" class="prev">
        PowerShell Classes
      </a></span> <span class="next"><a href="/powershell/powershell-profiles.html">
        Powershell profiles
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/2612.0478ad64.js" defer></script>
  </body>
</html>
