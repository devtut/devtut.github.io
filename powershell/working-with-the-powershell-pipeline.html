<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PowerShell - Working with the PowerShell pipeline</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Writing Functions with Advanced Lifecycle, Basic Pipeline Support in Functions, Working concept of pipeline">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="PowerShell - Working with the PowerShell pipeline">
    <meta property="og:description" content="Writing Functions with Advanced Lifecycle, Basic Pipeline Support in Functions, Working concept of pipeline">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/powershell/working-with-the-powershell-pipeline.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="PowerShell - Working with the PowerShell pipeline">
    <meta name="twitter:description" content="Writing Functions with Advanced Lifecycle, Basic Pipeline Support in Functions, Working concept of pipeline">
    <meta name="twitter:url" content="/powershell/working-with-the-powershell-pipeline.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2642.c9ee16c9.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>PowerShell</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powershell/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/powershell/getting-started-with-powershell.html" class="sidebar-link">Getting started with PowerShell</a></li><li><a href="/powershell/variables-in-powershell.html" class="sidebar-link">Variables in PowerShell</a></li><li><a href="/powershell/operators.html" class="sidebar-link">Operators</a></li><li><a href="/powershell/special-operators.html" class="sidebar-link">Special Operators</a></li><li><a href="/powershell/basic-set-operations.html" class="sidebar-link">Basic Set Operations</a></li><li><a href="/powershell/conditional-logic.html" class="sidebar-link">Conditional logic</a></li><li><a href="/powershell/loops.html" class="sidebar-link">Loops</a></li><li><a href="/powershell/switch-statement.html" class="sidebar-link">Switch statement</a></li><li><a href="/powershell/strings.html" class="sidebar-link">Strings</a></li><li><a href="/powershell/hashtables.html" class="sidebar-link">HashTables</a></li><li><a href="/powershell/working-with-objects.html" class="sidebar-link">Working with Objects</a></li><li><a href="/powershell/powershell-functions.html" class="sidebar-link">PowerShell Functions</a></li><li><a href="/powershell/powershell-classes.html" class="sidebar-link">PowerShell Classes</a></li><li><a href="/powershell/powershell-modules.html" class="sidebar-link">Powershell Modules</a></li><li><a href="/powershell/powershell-profiles.html" class="sidebar-link">Powershell profiles</a></li><li><a href="/powershell/calculated-properties.html" class="sidebar-link">Calculated Properties</a></li><li><a href="/powershell/using-existing-static-classes.html" class="sidebar-link">Using existing static classes</a></li><li><a href="/powershell/built-in-variables.html" class="sidebar-link">Built-in variables</a></li><li><a href="/powershell/automatic-variables.html" class="sidebar-link">Automatic Variables</a></li><li><a href="/powershell/automatic-variables-part-2.html" class="sidebar-link">Automatic Variables - part 2</a></li><li><a href="/powershell/environment-variables.html" class="sidebar-link">Environment Variables</a></li><li><a href="/powershell/splatting.html" class="sidebar-link">Splatting</a></li><li><a href="/powershell/powershell-streams-debug-verbose-warning-error-output-and-information.html" class="sidebar-link">PowerShell &quot;Streams&quot;; Debug, Verbose, Warning, Error, Output and Information</a></li><li><a href="/powershell/sending-email.html" class="sidebar-link">Sending Email</a></li><li><a href="/powershell/powershell-remoting.html" class="sidebar-link">Powershell Remoting</a></li><li><a href="/powershell/working-with-the-powershell-pipeline.html" aria-current="page" class="active sidebar-link">Working with the PowerShell pipeline</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/powershell/working-with-the-powershell-pipeline.html#writing-functions-with-advanced-lifecycle" class="sidebar-link">Writing Functions with Advanced Lifecycle</a></li><li class="sidebar-sub-header"><a href="/powershell/working-with-the-powershell-pipeline.html#basic-pipeline-support-in-functions" class="sidebar-link">Basic Pipeline Support in Functions</a></li><li class="sidebar-sub-header"><a href="/powershell/working-with-the-powershell-pipeline.html#working-concept-of-pipeline" class="sidebar-link">Working concept of pipeline</a></li></ul></li><li><a href="/powershell/powershell-background-jobs.html" class="sidebar-link">PowerShell Background Jobs</a></li><li><a href="/powershell/return-behavior-in-powershell.html" class="sidebar-link">Return behavior in PowerShell</a></li><li><a href="/powershell/csv-parsing.html" class="sidebar-link">CSV parsing</a></li><li><a href="/powershell/working-with-xml-files.html" class="sidebar-link">Working with XML Files</a></li><li><a href="/powershell/communicating-with-restful-apis.html" class="sidebar-link">Communicating with RESTful APIs</a></li><li><a href="/powershell/powershell-sql-queries.html" class="sidebar-link">powershell sql queries</a></li><li><a href="/powershell/regular-expressions.html" class="sidebar-link">Regular Expressions</a></li><li><a href="/powershell/aliases.html" class="sidebar-link">Aliases</a></li><li><a href="/powershell/using-the-progress-bar.html" class="sidebar-link">Using the progress bar</a></li><li><a href="/powershell/powershell-exe-command-line.html" class="sidebar-link">PowerShell.exe Command-Line</a></li><li><a href="/powershell/cmdlet-naming.html" class="sidebar-link">Cmdlet Naming</a></li><li><a href="/powershell/running-executables.html" class="sidebar-link">Running Executables</a></li><li><a href="/powershell/enforcing-script-prerequisites.html" class="sidebar-link">Enforcing script prerequisites</a></li><li><a href="/powershell/using-the-help-system.html" class="sidebar-link">Using the Help System</a></li><li><a href="/powershell/modules-scripts-and-functions.html" class="sidebar-link">Modules, Scripts and Functions</a></li><li><a href="/powershell/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/powershell/common-parameters.html" class="sidebar-link">Common parameters</a></li><li><a href="/powershell/parameter-sets.html" class="sidebar-link">Parameter sets</a></li><li><a href="/powershell/powershell-dynamic-parameters.html" class="sidebar-link">PowerShell Dynamic Parameters</a></li><li><a href="/powershell/gui-in-powershell.html" class="sidebar-link">GUI in Powershell</a></li><li><a href="/powershell/url-encode-decode.html" class="sidebar-link">URL Encode/Decode</a></li><li><a href="/powershell/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/powershell/package-management.html" class="sidebar-link">Package management</a></li><li><a href="/powershell/tcp-communication-with-powershell.html" class="sidebar-link">TCP Communication with PowerShell</a></li><li><a href="/powershell/powershell-workflows.html" class="sidebar-link">PowerShell Workflows</a></li><li><a href="/powershell/embedding-managed-code-c-vb.html" class="sidebar-link">Embedding Managed Code (C# | VB)</a></li><li><a href="/powershell/how-to-download-latest-artifact-from-artifactory-using-powershell-script-v2-0-or-below.html" class="sidebar-link">How to download latest artifact from Artifactory using Powershell script (v2.0 or below)?</a></li><li><a href="/powershell/comment-based-help.html" class="sidebar-link">Comment-based help</a></li><li><a href="/powershell/archive-module.html" class="sidebar-link">Archive Module</a></li><li><a href="/powershell/infrastructure-automation.html" class="sidebar-link">Infrastructure Automation</a></li><li><a href="/powershell/psscriptanalyzer-powershell-script-analyzer.html" class="sidebar-link">PSScriptAnalyzer - PowerShell Script Analyzer</a></li><li><a href="/powershell/desired-state-configuration.html" class="sidebar-link">Desired State Configuration</a></li><li><a href="/powershell/using-shouldprocess.html" class="sidebar-link">Using ShouldProcess</a></li><li><a href="/powershell/scheduled-tasks-module.html" class="sidebar-link">Scheduled tasks module</a></li><li><a href="/powershell/ise-module.html" class="sidebar-link">ISE module</a></li><li><a href="/powershell/creating-dsc-class-based-resources.html" class="sidebar-link">Creating DSC Class-Based Resources</a></li><li><a href="/powershell/wmi-and-cim.html" class="sidebar-link">WMI and CIM</a></li><li><a href="/powershell/activedirectory-module.html" class="sidebar-link">ActiveDirectory module</a></li><li><a href="/powershell/sharepoint-module.html" class="sidebar-link">SharePoint Module</a></li><li><a href="/powershell/introduction-to-psake.html" class="sidebar-link">Introduction to Psake</a></li><li><a href="/powershell/introduction-to-pester.html" class="sidebar-link">Introduction to Pester</a></li><li><a href="/powershell/handling-secrets-and-credentials.html" class="sidebar-link">Handling Secrets and Credentials</a></li><li><a href="/powershell/security-and-cryptography.html" class="sidebar-link">Security and Cryptography</a></li><li><a href="/powershell/signing-scripts.html" class="sidebar-link">Signing Scripts</a></li><li><a href="/powershell/anonymize-ip-v4-and-v6-in-text-file-with-powershell.html" class="sidebar-link">Anonymize IP (v4 and v6) in text file with Powershell</a></li><li><a href="/powershell/amazon-web-services-aws-rekognition.html" class="sidebar-link">Amazon Web Services (AWS) Rekognition</a></li><li><a href="/powershell/amazon-web-services-aws-simple-storage-service-s3.html" class="sidebar-link">Amazon Web Services (AWS) Simple Storage Service (S3)</a></li><li><a href="/powershell/mongodb.html" class="sidebar-link">MongoDB</a></li><li><a href="/powershell/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="working-with-the-powershell-pipeline"><a href="#working-with-the-powershell-pipeline" class="header-anchor">#</a> Working with the PowerShell pipeline</h1> <p>PowerShell introduces an object pipelining model, which allows you to send whole objects down through the pipeline to consuming commandlets or (at least) the output. In contrast to classical string-based pipelining, information in piped objects don't have to be on specific positions. Commandlets can declare to interact with Objects from the pipeline as input, while return values are sent to the pipeline automatically.</p> <h2 id="writing-functions-with-advanced-lifecycle"><a href="#writing-functions-with-advanced-lifecycle" class="header-anchor">#</a> Writing Functions with Advanced Lifecycle</h2> <p>This example shows how a function can accept pipelined input, and iterate efficiently.</p> <p>Note, that the <code>begin</code> and <code>end</code> structures of the function are optional when pipelining, but that <code>process</code> is required when using <code>ValueFromPipeline</code> or <code>ValueFromPipelineByPropertyName</code>.</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> <span class="token function">Write-FromPipeline</span><span class="token punctuation">{</span>
    <span class="token namespace">[CmdletBinding()]</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span>
        <span class="token namespace">[Parameter(ValueFromPipeline)]</span>
        <span class="token variable">$myInput</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">begin</span> <span class="token punctuation">{</span>
        <span class="token function">Write-Verbose</span> <span class="token operator">-</span>Message <span class="token string">&quot;Beginning Write-FromPipeline&quot;</span> 
    <span class="token punctuation">}</span>
    <span class="token keyword">process</span> <span class="token punctuation">{</span>
        <span class="token function">Write-Output</span> <span class="token operator">-</span>InputObject <span class="token variable">$myInput</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">end</span> <span class="token punctuation">{</span>
        <span class="token function">Write-Verbose</span> <span class="token operator">-</span>Message <span class="token string">&quot;Ending Write-FromPipeline&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token variable">$foo</span> = <span class="token string">'hello'</span><span class="token punctuation">,</span><span class="token string">'world'</span><span class="token punctuation">,</span>1<span class="token punctuation">,</span>2<span class="token punctuation">,</span>3

<span class="token variable">$foo</span> <span class="token punctuation">|</span> <span class="token function">Write-FromPipeline</span> <span class="token operator">-</span>Verbose

</code></pre></div><p>Output:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>VERBOSE: Beginning <span class="token function">Write-FromPipeline</span>
hello
world
1
2
3
VERBOSE: Ending <span class="token function">Write-FromPipeline</span>

</code></pre></div><h2 id="basic-pipeline-support-in-functions"><a href="#basic-pipeline-support-in-functions" class="header-anchor">#</a> Basic Pipeline Support in Functions</h2> <p>This is an example of a function with the simplest possible support for pipelining.<br>
Any function with pipeline support must have at least one parameter with the ParameterAttribute <code>ValueFromPipeline</code> or <code>ValueFromPipelineByPropertyName</code> set, as shown below.</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> <span class="token function">Write-FromPipeline</span> <span class="token punctuation">{</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span>
        <span class="token namespace">[Parameter(ValueFromPipeline)]</span>  <span class="token comment"># This sets the ParameterAttribute</span>
        <span class="token namespace">[String]</span><span class="token variable">$Input</span>
    <span class="token punctuation">)</span>
    <span class="token function">Write-Host</span> <span class="token variable">$Input</span>
<span class="token punctuation">}</span>

<span class="token variable">$foo</span> = <span class="token string">'Hello World!'</span>

<span class="token variable">$foo</span> <span class="token punctuation">|</span> <span class="token function">Write-FromPipeline</span>

</code></pre></div><p>Output:</p> <p><code>Hello World!</code></p> <p>Note: In PowerShell 3.0 and above, Default Values for ParameterAttributes is supported. In earlier versions, you must specify <code>ValueFromPipeline=$true</code>.</p> <h2 id="working-concept-of-pipeline"><a href="#working-concept-of-pipeline" class="header-anchor">#</a> Working concept of pipeline</h2> <p>In a pipeline series each function runs parallel to the others, like parallel threads. The first processed object is transmitted to the next pipeline and the next processing is immediately executed in another thread. This explains the high speed gain compared to the standard <code>ForEach</code></p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>@<span class="token punctuation">(</span> bigFile_1<span class="token punctuation">,</span> bigFile_2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> bigFile_n<span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">Copy-File</span> <span class="token punctuation">|</span> Encrypt<span class="token operator">-</span>File <span class="token punctuation">|</span> Get<span class="token operator">-</span>Md5

</code></pre></div><ol><li>step - copy the first file (in <code>Copy-file</code> Thread)
</li><li>step - copy
second file (in <code>Copy-file</code> Thread) and simultaneously Encrypt the
first (in <code>Encrypt-File</code>)</li> <li>step -
copy third file (in <code>Copy-file</code> Thread) and simultaneously encrypt second file (in <code>Encrypt-File</code>) and simultaneously <code>get-Md5</code> of the first (in <code>Get-Md5</code>)</li></ol> <h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li>BEGIN The first block. Executed once at the beginning. The pipeline input here is $null, as it has not been set.</li> <li>PROCESS The second block. Executed for each element of the pipeline. The pipeline parameter is equal to the currently processed element.</li> <li>END Last block. Executed once at the end. The pipeline parameter is equal to the last element of the input, because it has not been changed since it was set.</li></ul> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>In most cases, the input of the pipeline will be an array of objects. Although the behavior of the <code>PROCESS{}</code> block may seem similar to the <code>foreach{}</code> block, skipping an element in the array requires a different process.</p> <p>If, like in <code>foreach{}</code>, you used <code>continue</code> inside the <code>PROCESS{}</code> block, it would break the pipeline, skipping all following statements including the <code>END{}</code> block. Instead, use <code>return</code> - it will only end the <code>PROCESS{}</code> block for the current element and move to the next.</p> <p>In some cases, there is a need to output the result of functions with different encoding. The encoding of the output of the CmdLets is controlled by the <code>$OutputEncoding</code> variable. When the output is intended to be put into a pipeline to native applications, it might be a good idea to fix the encoding to match the target <code>$OutputEncoding = [Console]::OutputEncoding</code></p> <p><strong>Additional references:</strong></p> <p>Blog article with more insight about <code>$OutputEncoding</code> <a href="https://blogs.msdn.microsoft.com/powershell/2006/12/11/outputencoding-to-the-rescue/" target="_blank" rel="noopener noreferrer">https://blogs.msdn.microsoft.com/powershell/2006/12/11/outputencoding-to-the-rescue/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/powershell/working-with-the-powershell-pipeline.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/powershell/powershell-remoting.html" class="prev">
        Powershell Remoting
      </a></span> <span class="next"><a href="/powershell/powershell-background-jobs.html">
        PowerShell Background Jobs
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2642.c9ee16c9.js" defer></script>
  </body>
</html>
