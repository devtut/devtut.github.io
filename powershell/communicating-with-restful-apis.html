<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PowerShell - Communicating with RESTful APIs</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Post Message to hipChat, Using REST with PowerShell Objects to GET and POST many items, Use Slack.com Incoming Webhooks, Using REST with PowerShell Objects to Get and Put individual data, Using REST with PowerShell to Delete items">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="PowerShell - Communicating with RESTful APIs">
    <meta property="og:description" content="Post Message to hipChat, Using REST with PowerShell Objects to GET and POST many items, Use Slack.com Incoming Webhooks, Using REST with PowerShell Objects to Get and Put individual data, Using REST with PowerShell to Delete items">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/powershell/communicating-with-restful-apis.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="PowerShell - Communicating with RESTful APIs">
    <meta name="twitter:description" content="Post Message to hipChat, Using REST with PowerShell Objects to GET and POST many items, Use Slack.com Incoming Webhooks, Using REST with PowerShell Objects to Get and Put individual data, Using REST with PowerShell to Delete items">
    <meta name="twitter:url" content="/powershell/communicating-with-restful-apis.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/2581.1f54e54b.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>PowerShell</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powershell/" class="sidebar-link">Disclaimer</a></li><li><a href="/powershell/getting-started-with-powershell.html" class="sidebar-link">Getting started with PowerShell</a></li><li><a href="/powershell/variables-in-powershell.html" class="sidebar-link">Variables in PowerShell</a></li><li><a href="/powershell/operators.html" class="sidebar-link">Operators</a></li><li><a href="/powershell/special-operators.html" class="sidebar-link">Special Operators</a></li><li><a href="/powershell/basic-set-operations.html" class="sidebar-link">Basic Set Operations</a></li><li><a href="/powershell/conditional-logic.html" class="sidebar-link">Conditional logic</a></li><li><a href="/powershell/loops.html" class="sidebar-link">Loops</a></li><li><a href="/powershell/switch-statement.html" class="sidebar-link">Switch statement</a></li><li><a href="/powershell/strings.html" class="sidebar-link">Strings</a></li><li><a href="/powershell/hashtables.html" class="sidebar-link">HashTables</a></li><li><a href="/powershell/working-with-objects.html" class="sidebar-link">Working with Objects</a></li><li><a href="/powershell/powershell-functions.html" class="sidebar-link">PowerShell Functions</a></li><li><a href="/powershell/powershell-classes.html" class="sidebar-link">PowerShell Classes</a></li><li><a href="/powershell/powershell-modules.html" class="sidebar-link">Powershell Modules</a></li><li><a href="/powershell/powershell-profiles.html" class="sidebar-link">Powershell profiles</a></li><li><a href="/powershell/calculated-properties.html" class="sidebar-link">Calculated Properties</a></li><li><a href="/powershell/using-existing-static-classes.html" class="sidebar-link">Using existing static classes</a></li><li><a href="/powershell/built-in-variables.html" class="sidebar-link">Built-in variables</a></li><li><a href="/powershell/automatic-variables.html" class="sidebar-link">Automatic Variables</a></li><li><a href="/powershell/automatic-variables-part-2.html" class="sidebar-link">Automatic Variables - part 2</a></li><li><a href="/powershell/environment-variables.html" class="sidebar-link">Environment Variables</a></li><li><a href="/powershell/splatting.html" class="sidebar-link">Splatting</a></li><li><a href="/powershell/powershell-streams-debug-verbose-warning-error-output-and-information.html" class="sidebar-link">PowerShell &quot;Streams&quot;; Debug, Verbose, Warning, Error, Output and Information</a></li><li><a href="/powershell/sending-email.html" class="sidebar-link">Sending Email</a></li><li><a href="/powershell/powershell-remoting.html" class="sidebar-link">Powershell Remoting</a></li><li><a href="/powershell/working-with-the-powershell-pipeline.html" class="sidebar-link">Working with the PowerShell pipeline</a></li><li><a href="/powershell/powershell-background-jobs.html" class="sidebar-link">PowerShell Background Jobs</a></li><li><a href="/powershell/return-behavior-in-powershell.html" class="sidebar-link">Return behavior in PowerShell</a></li><li><a href="/powershell/csv-parsing.html" class="sidebar-link">CSV parsing</a></li><li><a href="/powershell/working-with-xml-files.html" class="sidebar-link">Working with XML Files</a></li><li><a href="/powershell/communicating-with-restful-apis.html" class="active sidebar-link">Communicating with RESTful APIs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/powershell/communicating-with-restful-apis.html#post-message-to-hipchat" class="sidebar-link">Post Message to hipChat</a></li><li class="sidebar-sub-header"><a href="/powershell/communicating-with-restful-apis.html#using-rest-with-powershell-objects-to-get-and-post-many-items" class="sidebar-link">Using REST with PowerShell Objects to GET and POST many items</a></li><li class="sidebar-sub-header"><a href="/powershell/communicating-with-restful-apis.html#use-slack-com-incoming-webhooks" class="sidebar-link">Use Slack.com Incoming Webhooks</a></li><li class="sidebar-sub-header"><a href="/powershell/communicating-with-restful-apis.html#using-rest-with-powershell-objects-to-get-and-put-individual-data" class="sidebar-link">Using REST with PowerShell Objects to Get and Put individual data</a></li><li class="sidebar-sub-header"><a href="/powershell/communicating-with-restful-apis.html#using-rest-with-powershell-to-delete-items" class="sidebar-link">Using REST with PowerShell to Delete items</a></li></ul></li><li><a href="/powershell/powershell-sql-queries.html" class="sidebar-link">powershell sql queries</a></li><li><a href="/powershell/regular-expressions.html" class="sidebar-link">Regular Expressions</a></li><li><a href="/powershell/aliases.html" class="sidebar-link">Aliases</a></li><li><a href="/powershell/using-the-progress-bar.html" class="sidebar-link">Using the progress bar</a></li><li><a href="/powershell/powershell-exe-command-line.html" class="sidebar-link">PowerShell.exe Command-Line</a></li><li><a href="/powershell/cmdlet-naming.html" class="sidebar-link">Cmdlet Naming</a></li><li><a href="/powershell/running-executables.html" class="sidebar-link">Running Executables</a></li><li><a href="/powershell/enforcing-script-prerequisites.html" class="sidebar-link">Enforcing script prerequisites</a></li><li><a href="/powershell/using-the-help-system.html" class="sidebar-link">Using the Help System</a></li><li><a href="/powershell/modules-scripts-and-functions.html" class="sidebar-link">Modules, Scripts and Functions</a></li><li><a href="/powershell/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/powershell/common-parameters.html" class="sidebar-link">Common parameters</a></li><li><a href="/powershell/parameter-sets.html" class="sidebar-link">Parameter sets</a></li><li><a href="/powershell/powershell-dynamic-parameters.html" class="sidebar-link">PowerShell Dynamic Parameters</a></li><li><a href="/powershell/gui-in-powershell.html" class="sidebar-link">GUI in Powershell</a></li><li><a href="/powershell/url-encode-decode.html" class="sidebar-link">URL Encode/Decode</a></li><li><a href="/powershell/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/powershell/package-management.html" class="sidebar-link">Package management</a></li><li><a href="/powershell/tcp-communication-with-powershell.html" class="sidebar-link">TCP Communication with PowerShell</a></li><li><a href="/powershell/powershell-workflows.html" class="sidebar-link">PowerShell Workflows</a></li><li><a href="/powershell/embedding-managed-code-c-vb.html" class="sidebar-link">Embedding Managed Code (C# | VB)</a></li><li><a href="/powershell/how-to-download-latest-artifact-from-artifactory-using-powershell-script-v2-0-or-below.html" class="sidebar-link">How to download latest artifact from Artifactory using Powershell script (v2.0 or below)?</a></li><li><a href="/powershell/comment-based-help.html" class="sidebar-link">Comment-based help</a></li><li><a href="/powershell/archive-module.html" class="sidebar-link">Archive Module</a></li><li><a href="/powershell/infrastructure-automation.html" class="sidebar-link">Infrastructure Automation</a></li><li><a href="/powershell/psscriptanalyzer-powershell-script-analyzer.html" class="sidebar-link">PSScriptAnalyzer - PowerShell Script Analyzer</a></li><li><a href="/powershell/desired-state-configuration.html" class="sidebar-link">Desired State Configuration</a></li><li><a href="/powershell/using-shouldprocess.html" class="sidebar-link">Using ShouldProcess</a></li><li><a href="/powershell/scheduled-tasks-module.html" class="sidebar-link">Scheduled tasks module</a></li><li><a href="/powershell/ise-module.html" class="sidebar-link">ISE module</a></li><li><a href="/powershell/creating-dsc-class-based-resources.html" class="sidebar-link">Creating DSC Class-Based Resources</a></li><li><a href="/powershell/wmi-and-cim.html" class="sidebar-link">WMI and CIM</a></li><li><a href="/powershell/activedirectory-module.html" class="sidebar-link">ActiveDirectory module</a></li><li><a href="/powershell/sharepoint-module.html" class="sidebar-link">SharePoint Module</a></li><li><a href="/powershell/introduction-to-psake.html" class="sidebar-link">Introduction to Psake</a></li><li><a href="/powershell/introduction-to-pester.html" class="sidebar-link">Introduction to Pester</a></li><li><a href="/powershell/handling-secrets-and-credentials.html" class="sidebar-link">Handling Secrets and Credentials</a></li><li><a href="/powershell/security-and-cryptography.html" class="sidebar-link">Security and Cryptography</a></li><li><a href="/powershell/signing-scripts.html" class="sidebar-link">Signing Scripts</a></li><li><a href="/powershell/anonymize-ip-v4-and-v6-in-text-file-with-powershell.html" class="sidebar-link">Anonymize IP (v4 and v6) in text file with Powershell</a></li><li><a href="/powershell/amazon-web-services-aws-rekognition.html" class="sidebar-link">Amazon Web Services (AWS) Rekognition</a></li><li><a href="/powershell/amazon-web-services-aws-simple-storage-service-s3.html" class="sidebar-link">Amazon Web Services (AWS) Simple Storage Service (S3)</a></li><li><a href="/powershell/mongodb.html" class="sidebar-link">MongoDB</a></li><li><a href="/powershell/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="communicating-with-restful-apis"><a href="#communicating-with-restful-apis" class="header-anchor">#</a> Communicating with RESTful APIs</h1> <p>REST stands for Representational State Transfer (sometimes spelled &quot;ReST&quot;). It relies on a stateless, client-server, cacheable communications protocol and mostly HTTP protocol is used. It is primarily used to build Web services that are lightweight, maintainable, and scalable. A service based on REST is called a RESTful service and the APIs which are being used for it are RESTful APIs. In PowerShell, <strong><code>Invoke-RestMethod</code></strong> is used to deal with them.</p> <h2 id="post-message-to-hipchat"><a href="#post-message-to-hipchat" class="header-anchor">#</a> Post Message to hipChat</h2> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$params</span> = @<span class="token punctuation">{</span>
    Uri = <span class="token string">&quot;https://your.hipchat.com/v2/room/934419/notification?auth_token=???&quot;</span>
    Method = <span class="token string">&quot;POST&quot;</span>
    Body = @<span class="token punctuation">{</span>
        color = <span class="token string">'yellow'</span>
        message = <span class="token string">&quot;This is a test message!&quot;</span>
        notify = <span class="token boolean">$false</span> 
        message_format = <span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">ConvertTo-Json</span>
    ContentType = <span class="token string">'application/json'</span>
<span class="token punctuation">}</span>

<span class="token function">Invoke-RestMethod</span> @params 

</code></pre></div><h2 id="using-rest-with-powershell-objects-to-get-and-post-many-items"><a href="#using-rest-with-powershell-objects-to-get-and-post-many-items" class="header-anchor">#</a> Using REST with PowerShell Objects to GET and POST many items</h2> <p>GET your REST data and store in a PowerShell object:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$Users</span> = <span class="token function">Invoke-RestMethod</span> <span class="token operator">-</span>Uri <span class="token string">&quot;http://jsonplaceholder.typicode.com/users&quot;</span>

</code></pre></div><p>Modify many items in your data:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$Users</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">.</span>name = <span class="token string">&quot;John Smith&quot;</span>
<span class="token variable">$Users</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">.</span>email = <span class="token string">&quot;John.Smith@example.com&quot;</span>
<span class="token variable">$Users</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">.</span>name = <span class="token string">&quot;Jane Smith&quot;</span>
<span class="token variable">$Users</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">.</span>email = <span class="token string">&quot;Jane.Smith@example.com&quot;</span>

</code></pre></div><p>POST all of the REST data back:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$Json</span> = <span class="token variable">$Users</span> <span class="token punctuation">|</span> <span class="token function">ConvertTo-Json</span>
<span class="token function">Invoke-RestMethod</span> <span class="token operator">-</span>Method Post <span class="token operator">-</span>Uri <span class="token string">&quot;http://jsonplaceholder.typicode.com/users&quot;</span> <span class="token operator">-</span>Body <span class="token variable">$Json</span> <span class="token operator">-</span>ContentType <span class="token string">'application/json'</span>

</code></pre></div><h2 id="use-slack-com-incoming-webhooks"><a href="#use-slack-com-incoming-webhooks" class="header-anchor">#</a> Use Slack.com Incoming Webhooks</h2> <p>Define your payload to send for possible more complex data</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$Payload</span> = @<span class="token punctuation">{</span> text=<span class="token string">&quot;test string&quot;</span><span class="token punctuation">;</span> username=<span class="token string">&quot;testuser&quot;</span> <span class="token punctuation">}</span>

</code></pre></div><p>Use <code>ConvertTo-Json</code> cmdlet and <code>Invoke-RestMethod</code> to execute the call</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">Invoke-RestMethod</span> <span class="token operator">-</span>Uri <span class="token string">&quot;https://hooks.slack.com/services/yourwebhookstring&quot;</span> <span class="token operator">-</span>Method Post <span class="token operator">-</span>Body <span class="token punctuation">(</span><span class="token function">ConvertTo-Json</span> <span class="token variable">$Payload</span><span class="token punctuation">)</span> 

</code></pre></div><h2 id="using-rest-with-powershell-objects-to-get-and-put-individual-data"><a href="#using-rest-with-powershell-objects-to-get-and-put-individual-data" class="header-anchor">#</a> Using REST with PowerShell Objects to Get and Put individual data</h2> <p>GET your REST data and store in a PowerShell object:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$Post</span> = <span class="token function">Invoke-RestMethod</span> <span class="token operator">-</span>Uri <span class="token string">&quot;http://jsonplaceholder.typicode.com/posts/1&quot;</span>

</code></pre></div><p>Modify your data:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$Post</span><span class="token punctuation">.</span>title = <span class="token string">&quot;New Title&quot;</span>

</code></pre></div><p>PUT the REST data back</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$Json</span> = <span class="token variable">$Post</span> <span class="token punctuation">|</span> <span class="token function">ConvertTo-Json</span>
<span class="token function">Invoke-RestMethod</span> <span class="token operator">-</span>Method Put <span class="token operator">-</span>Uri <span class="token string">&quot;http://jsonplaceholder.typicode.com/posts/1&quot;</span> <span class="token operator">-</span>Body <span class="token variable">$Json</span> <span class="token operator">-</span>ContentType <span class="token string">'application/json'</span>

</code></pre></div><h2 id="using-rest-with-powershell-to-delete-items"><a href="#using-rest-with-powershell-to-delete-items" class="header-anchor">#</a> Using REST with PowerShell to Delete items</h2> <p>Identify the item that is to be deleted and delete it:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">Invoke-RestMethod</span> <span class="token operator">-</span>Method Delete <span class="token operator">-</span>Uri <span class="token string">&quot;http://jsonplaceholder.typicode.com/posts/1&quot;</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/powershell/communicating-with-restful-apis.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/powershell/working-with-xml-files.html" class="prev">
        Working with XML Files
      </a></span> <span class="next"><a href="/powershell/powershell-sql-queries.html">
        powershell sql queries
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/2581.1f54e54b.js" defer></script>
  </body>
</html>
