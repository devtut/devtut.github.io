<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PowerShell - PowerShell Functions</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Basic Parameters, Advanced Function, Mandatory Parameters, Parameter Validation, Simple Function with No Parameters">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="PowerShell - PowerShell Functions">
    <meta property="og:description" content="Basic Parameters, Advanced Function, Mandatory Parameters, Parameter Validation, Simple Function with No Parameters">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/powershell/powershell-functions.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="PowerShell - PowerShell Functions">
    <meta name="twitter:description" content="Basic Parameters, Advanced Function, Mandatory Parameters, Parameter Validation, Simple Function with No Parameters">
    <meta name="twitter:url" content="/powershell/powershell-functions.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2613.0eefc3f3.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>PowerShell</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powershell/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/powershell/getting-started-with-powershell.html" class="sidebar-link">Getting started with PowerShell</a></li><li><a href="/powershell/variables-in-powershell.html" class="sidebar-link">Variables in PowerShell</a></li><li><a href="/powershell/operators.html" class="sidebar-link">Operators</a></li><li><a href="/powershell/special-operators.html" class="sidebar-link">Special Operators</a></li><li><a href="/powershell/basic-set-operations.html" class="sidebar-link">Basic Set Operations</a></li><li><a href="/powershell/conditional-logic.html" class="sidebar-link">Conditional logic</a></li><li><a href="/powershell/loops.html" class="sidebar-link">Loops</a></li><li><a href="/powershell/switch-statement.html" class="sidebar-link">Switch statement</a></li><li><a href="/powershell/strings.html" class="sidebar-link">Strings</a></li><li><a href="/powershell/hashtables.html" class="sidebar-link">HashTables</a></li><li><a href="/powershell/working-with-objects.html" class="sidebar-link">Working with Objects</a></li><li><a href="/powershell/powershell-functions.html" aria-current="page" class="active sidebar-link">PowerShell Functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/powershell/powershell-functions.html#basic-parameters" class="sidebar-link">Basic Parameters</a></li><li class="sidebar-sub-header"><a href="/powershell/powershell-functions.html#advanced-function" class="sidebar-link">Advanced Function</a></li><li class="sidebar-sub-header"><a href="/powershell/powershell-functions.html#mandatory-parameters" class="sidebar-link">Mandatory Parameters</a></li><li class="sidebar-sub-header"><a href="/powershell/powershell-functions.html#parameter-validation" class="sidebar-link">Parameter Validation</a></li><li class="sidebar-sub-header"><a href="/powershell/powershell-functions.html#simple-function-with-no-parameters" class="sidebar-link">Simple Function with No Parameters</a></li></ul></li><li><a href="/powershell/powershell-classes.html" class="sidebar-link">PowerShell Classes</a></li><li><a href="/powershell/powershell-modules.html" class="sidebar-link">Powershell Modules</a></li><li><a href="/powershell/powershell-profiles.html" class="sidebar-link">Powershell profiles</a></li><li><a href="/powershell/calculated-properties.html" class="sidebar-link">Calculated Properties</a></li><li><a href="/powershell/using-existing-static-classes.html" class="sidebar-link">Using existing static classes</a></li><li><a href="/powershell/built-in-variables.html" class="sidebar-link">Built-in variables</a></li><li><a href="/powershell/automatic-variables.html" class="sidebar-link">Automatic Variables</a></li><li><a href="/powershell/automatic-variables-part-2.html" class="sidebar-link">Automatic Variables - part 2</a></li><li><a href="/powershell/environment-variables.html" class="sidebar-link">Environment Variables</a></li><li><a href="/powershell/splatting.html" class="sidebar-link">Splatting</a></li><li><a href="/powershell/powershell-streams-debug-verbose-warning-error-output-and-information.html" class="sidebar-link">PowerShell &quot;Streams&quot;; Debug, Verbose, Warning, Error, Output and Information</a></li><li><a href="/powershell/sending-email.html" class="sidebar-link">Sending Email</a></li><li><a href="/powershell/powershell-remoting.html" class="sidebar-link">Powershell Remoting</a></li><li><a href="/powershell/working-with-the-powershell-pipeline.html" class="sidebar-link">Working with the PowerShell pipeline</a></li><li><a href="/powershell/powershell-background-jobs.html" class="sidebar-link">PowerShell Background Jobs</a></li><li><a href="/powershell/return-behavior-in-powershell.html" class="sidebar-link">Return behavior in PowerShell</a></li><li><a href="/powershell/csv-parsing.html" class="sidebar-link">CSV parsing</a></li><li><a href="/powershell/working-with-xml-files.html" class="sidebar-link">Working with XML Files</a></li><li><a href="/powershell/communicating-with-restful-apis.html" class="sidebar-link">Communicating with RESTful APIs</a></li><li><a href="/powershell/powershell-sql-queries.html" class="sidebar-link">powershell sql queries</a></li><li><a href="/powershell/regular-expressions.html" class="sidebar-link">Regular Expressions</a></li><li><a href="/powershell/aliases.html" class="sidebar-link">Aliases</a></li><li><a href="/powershell/using-the-progress-bar.html" class="sidebar-link">Using the progress bar</a></li><li><a href="/powershell/powershell-exe-command-line.html" class="sidebar-link">PowerShell.exe Command-Line</a></li><li><a href="/powershell/cmdlet-naming.html" class="sidebar-link">Cmdlet Naming</a></li><li><a href="/powershell/running-executables.html" class="sidebar-link">Running Executables</a></li><li><a href="/powershell/enforcing-script-prerequisites.html" class="sidebar-link">Enforcing script prerequisites</a></li><li><a href="/powershell/using-the-help-system.html" class="sidebar-link">Using the Help System</a></li><li><a href="/powershell/modules-scripts-and-functions.html" class="sidebar-link">Modules, Scripts and Functions</a></li><li><a href="/powershell/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/powershell/common-parameters.html" class="sidebar-link">Common parameters</a></li><li><a href="/powershell/parameter-sets.html" class="sidebar-link">Parameter sets</a></li><li><a href="/powershell/powershell-dynamic-parameters.html" class="sidebar-link">PowerShell Dynamic Parameters</a></li><li><a href="/powershell/gui-in-powershell.html" class="sidebar-link">GUI in Powershell</a></li><li><a href="/powershell/url-encode-decode.html" class="sidebar-link">URL Encode/Decode</a></li><li><a href="/powershell/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/powershell/package-management.html" class="sidebar-link">Package management</a></li><li><a href="/powershell/tcp-communication-with-powershell.html" class="sidebar-link">TCP Communication with PowerShell</a></li><li><a href="/powershell/powershell-workflows.html" class="sidebar-link">PowerShell Workflows</a></li><li><a href="/powershell/embedding-managed-code-c-vb.html" class="sidebar-link">Embedding Managed Code (C# | VB)</a></li><li><a href="/powershell/how-to-download-latest-artifact-from-artifactory-using-powershell-script-v2-0-or-below.html" class="sidebar-link">How to download latest artifact from Artifactory using Powershell script (v2.0 or below)?</a></li><li><a href="/powershell/comment-based-help.html" class="sidebar-link">Comment-based help</a></li><li><a href="/powershell/archive-module.html" class="sidebar-link">Archive Module</a></li><li><a href="/powershell/infrastructure-automation.html" class="sidebar-link">Infrastructure Automation</a></li><li><a href="/powershell/psscriptanalyzer-powershell-script-analyzer.html" class="sidebar-link">PSScriptAnalyzer - PowerShell Script Analyzer</a></li><li><a href="/powershell/desired-state-configuration.html" class="sidebar-link">Desired State Configuration</a></li><li><a href="/powershell/using-shouldprocess.html" class="sidebar-link">Using ShouldProcess</a></li><li><a href="/powershell/scheduled-tasks-module.html" class="sidebar-link">Scheduled tasks module</a></li><li><a href="/powershell/ise-module.html" class="sidebar-link">ISE module</a></li><li><a href="/powershell/creating-dsc-class-based-resources.html" class="sidebar-link">Creating DSC Class-Based Resources</a></li><li><a href="/powershell/wmi-and-cim.html" class="sidebar-link">WMI and CIM</a></li><li><a href="/powershell/activedirectory-module.html" class="sidebar-link">ActiveDirectory module</a></li><li><a href="/powershell/sharepoint-module.html" class="sidebar-link">SharePoint Module</a></li><li><a href="/powershell/introduction-to-psake.html" class="sidebar-link">Introduction to Psake</a></li><li><a href="/powershell/introduction-to-pester.html" class="sidebar-link">Introduction to Pester</a></li><li><a href="/powershell/handling-secrets-and-credentials.html" class="sidebar-link">Handling Secrets and Credentials</a></li><li><a href="/powershell/security-and-cryptography.html" class="sidebar-link">Security and Cryptography</a></li><li><a href="/powershell/signing-scripts.html" class="sidebar-link">Signing Scripts</a></li><li><a href="/powershell/anonymize-ip-v4-and-v6-in-text-file-with-powershell.html" class="sidebar-link">Anonymize IP (v4 and v6) in text file with Powershell</a></li><li><a href="/powershell/amazon-web-services-aws-rekognition.html" class="sidebar-link">Amazon Web Services (AWS) Rekognition</a></li><li><a href="/powershell/amazon-web-services-aws-simple-storage-service-s3.html" class="sidebar-link">Amazon Web Services (AWS) Simple Storage Service (S3)</a></li><li><a href="/powershell/mongodb.html" class="sidebar-link">MongoDB</a></li><li><a href="/powershell/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="powershell-functions"><a href="#powershell-functions" class="header-anchor">#</a> PowerShell Functions</h1> <p>A function is basically a named block of code. When you call the function name, the script block within that function runs. It is a list of PowerShell statements that has a name that you assign. When you run a function, you type the function name.It is a method of saving time when tackling repetitive tasks. PowerShell formats in three parts: the keyword 'Function', followed by a Name, finally, the payload containing the script block, which is enclosed by curly/parenthesis style bracket.</p> <h2 id="basic-parameters"><a href="#basic-parameters" class="header-anchor">#</a> Basic Parameters</h2> <p>A function can be defined with parameters using the param block:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> <span class="token function">Write-Greeting</span> <span class="token punctuation">{</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span>
        <span class="token namespace">[Parameter(Mandatory,Position=0)]</span>
        <span class="token namespace">[String]</span><span class="token variable">$name</span><span class="token punctuation">,</span>
        <span class="token namespace">[Parameter(Mandatory,Position=1)]</span>
        <span class="token namespace">[Int]</span><span class="token variable">$age</span>
    <span class="token punctuation">)</span>
    <span class="token string">&quot;Hello <span class="token variable">$name</span>, you are <span class="token variable">$age</span> years old.&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Or using the simple function syntax:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> <span class="token function">Write-Greeting</span> <span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;Hello <span class="token variable">$name</span>, you are <span class="token variable">$age</span> years old.&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Note:</strong> Casting parameters is not required in either type of parameter definition.</p> <p>Simple function syntax (SFS) has very limited capabilities in comparison to the param block.<br>
Though you can define parameters to be exposed within the function, you cannot specify <a href="https://msdn.microsoft.com/en-us/library/ms714348(v=vs.85).aspx" target="_blank" rel="noopener noreferrer">Parameter Attributes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, utilize <a href="https://msdn.microsoft.com/en-gb/library/ms714432(v=vs.85).aspx" target="_blank" rel="noopener noreferrer">Parameter Validation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, include <code>[CmdletBinding()]</code>, with SFS (and this is a non-exhaustive list).</p> <p>Functions can be invoked with ordered or named parameters.</p> <p>The order of the parameters on the invocation is matched to the order of the declaration in the function header (by default), or can be specified using the <code>Position</code> Parameter Attribute (as shown in the advanced function example, above).</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$greeting</span> = <span class="token function">Write-Greeting</span> <span class="token string">&quot;Jim&quot;</span> 82

</code></pre></div><p>Alternatively, this function can be invoked with named parameters</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$greeting</span> = <span class="token function">Write-Greeting</span> <span class="token operator">-</span>name <span class="token string">&quot;Bob&quot;</span> <span class="token operator">-</span>age 82

</code></pre></div><h2 id="advanced-function"><a href="#advanced-function" class="header-anchor">#</a> Advanced Function</h2> <p>This is a copy of the advanced function snippet from the Powershell ISE.  Basically this is a template for many of the things you can use with advanced functions in Powershell.  Key points to note:</p> <ul><li>get-help integration - the beginning of the function contains a comment block that is set up to be read by the get-help cmdlet.  The function block may be located at the end, if desired.</li> <li>cmdletbinding - function will behave like a cmdlet</li> <li>parameters</li> <li>parameter sets</li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token comment">&lt;#
.Synopsis
   Short description
.DESCRIPTION
   Long description
.EXAMPLE
   Example of how to use this cmdlet
.EXAMPLE
   Another example of how to use this cmdlet
.INPUTS
   Inputs to this cmdlet (if any)
.OUTPUTS
   Output from this cmdlet (if any)
.NOTES
   General notes
.COMPONENT
   The component this cmdlet belongs to
.ROLE
   The role this cmdlet belongs to
.FUNCTIONALITY
   The functionality that best describes this cmdlet
#&gt;</span>
<span class="token keyword">function</span> Verb<span class="token operator">-</span>Noun
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span>CmdletBinding<span class="token punctuation">(</span>DefaultParameterSetName=<span class="token string">'Parameter Set 1'</span><span class="token punctuation">,</span> 
                  SupportsShouldProcess=<span class="token boolean">$true</span><span class="token punctuation">,</span> 
                  PositionalBinding=<span class="token boolean">$false</span><span class="token punctuation">,</span>
                  HelpUri = <span class="token string">'http://www.microsoft.com/'</span><span class="token punctuation">,</span>
                  ConfirmImpact=<span class="token string">'Medium'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token namespace">[Alias()]</span>
    <span class="token namespace">[OutputType([String])]</span>
    <span class="token keyword">Param</span>
    <span class="token punctuation">(</span>
        <span class="token comment"># Param1 help description</span>
        <span class="token punctuation">[</span>Parameter<span class="token punctuation">(</span>Mandatory=<span class="token boolean">$true</span><span class="token punctuation">,</span> 
                   ValueFromPipeline=<span class="token boolean">$true</span><span class="token punctuation">,</span>
                   ValueFromPipelineByPropertyName=<span class="token boolean">$true</span><span class="token punctuation">,</span> 
                   ValueFromRemainingArguments=<span class="token boolean">$false</span><span class="token punctuation">,</span> 
                   Position=0<span class="token punctuation">,</span>
                   ParameterSetName=<span class="token string">'Parameter Set 1'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token namespace">[ValidateNotNull()]</span>
        <span class="token namespace">[ValidateNotNullOrEmpty()]</span>
        <span class="token namespace">[ValidateCount(0,5)]</span>
        <span class="token punctuation">[</span>ValidateSet<span class="token punctuation">(</span><span class="token string">&quot;sun&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;moon&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;earth&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>Alias<span class="token punctuation">(</span><span class="token string">&quot;p1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> 
        <span class="token variable">$Param1</span><span class="token punctuation">,</span>

        <span class="token comment"># Param2 help description</span>
        <span class="token punctuation">[</span>Parameter<span class="token punctuation">(</span>ParameterSetName=<span class="token string">'Parameter Set 1'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token namespace">[AllowNull()]</span>
        <span class="token namespace">[AllowEmptyCollection()]</span>
        <span class="token namespace">[AllowEmptyString()]</span>
        <span class="token namespace">[ValidateScript({$true})]</span>
        <span class="token namespace">[ValidateRange(0,5)]</span>
        <span class="token namespace">[int]</span>
        <span class="token variable">$Param2</span><span class="token punctuation">,</span>

        <span class="token comment"># Param3 help description</span>
        <span class="token punctuation">[</span>Parameter<span class="token punctuation">(</span>ParameterSetName=<span class="token string">'Another Parameter Set'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>ValidatePattern<span class="token punctuation">(</span><span class="token string">&quot;[a-z]*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token namespace">[ValidateLength(0,15)]</span>
        <span class="token namespace">[String]</span>
        <span class="token variable">$Param3</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">Begin</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">Process</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$pscmdlet</span><span class="token punctuation">.</span>ShouldProcess<span class="token punctuation">(</span><span class="token string">&quot;Target&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Operation&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">End</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="mandatory-parameters"><a href="#mandatory-parameters" class="header-anchor">#</a> Mandatory Parameters</h2> <p>Parameters to a function can be marked as mandatory</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> <span class="token function">Get-Greeting</span><span class="token punctuation">{</span>
    <span class="token keyword">param</span>
    <span class="token punctuation">(</span>
        <span class="token namespace">[Parameter(Mandatory=$true)]</span><span class="token variable">$name</span>
    <span class="token punctuation">)</span>
    <span class="token string">&quot;Hello World <span class="token variable">$name</span>&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>If the function is invoked without a value, the command line will prompt for the value:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$greeting</span> = <span class="token function">Get-Greeting</span> 

cmdlet <span class="token function">Get-Greeting</span> at command pipeline position 1
Supply values <span class="token keyword">for</span> the following parameters:
name: 

</code></pre></div><h2 id="parameter-validation"><a href="#parameter-validation" class="header-anchor">#</a> Parameter Validation</h2> <p>There are a variety of ways to validate parameter entry, in PowerShell.</p> <p>Instead of writing code within functions or scripts to validate parameter values, these ParameterAttributes will throw if invalid values are passed.</p> <h3 id="validateset"><a href="#validateset" class="header-anchor">#</a> ValidateSet</h3> <p>Sometimes we need to restrict the possible values that a parameter can accept. Say we want to allow only red, green and blue for the <code>$Color</code> parameter in a script or function.</p> <p>We can use the <code>ValidateSet</code> parameter attribute to restrict this. It has the additional benefit of allowing tab completion when setting this argument (in some environments).</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">param</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span>ValidateSet<span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'green'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">,</span>IgnoreCase<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token namespace">[string]</span><span class="token variable">$Color</span>
<span class="token punctuation">)</span>

</code></pre></div><p>You can also specify <code>IgnoreCase</code> to disable case sensitivity.</p> <h3 id="validaterange"><a href="#validaterange" class="header-anchor">#</a> ValidateRange</h3> <p>This method of parameter validation takes a min and max Int32 value, and requires the parameter to be within that range.</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">param</span><span class="token punctuation">(</span>
    <span class="token namespace">[ValidateRange(0,120)]</span>
    <span class="token namespace">[Int]</span><span class="token variable">$Age</span>
<span class="token punctuation">)</span>

</code></pre></div><h3 id="validatepattern"><a href="#validatepattern" class="header-anchor">#</a> ValidatePattern</h3> <p>This method of parameter validation accepts parameters that match the regex pattern specified.</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">param</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span>ValidatePattern<span class="token punctuation">(</span><span class="token string">&quot;\w{4-6}\d{2}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token namespace">[string]</span><span class="token variable">$UserName</span>
<span class="token punctuation">)</span>

</code></pre></div><h3 id="validatelength"><a href="#validatelength" class="header-anchor">#</a> ValidateLength</h3> <p>This method of parameter validation tests the length of the passed string.</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">param</span><span class="token punctuation">(</span>
    <span class="token namespace">[ValidateLength(0,15)]</span>
    <span class="token namespace">[String]</span><span class="token variable">$PhoneNumber</span>
<span class="token punctuation">)</span>

</code></pre></div><h3 id="validatecount"><a href="#validatecount" class="header-anchor">#</a> ValidateCount</h3> <p>This method of parameter validation tests the amount of arguments passed in, for example, an array of strings.</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">param</span><span class="token punctuation">(</span>
    <span class="token namespace">[ValidateCount(1,5)]</span>
    <span class="token namespace">[String[]]</span><span class="token variable">$ComputerName</span>
<span class="token punctuation">)</span>

</code></pre></div><h3 id="validatescript"><a href="#validatescript" class="header-anchor">#</a> ValidateScript</h3> <p>Finally, the ValidateScript method is extraordinarily flexible, taking a scriptblock and evaluating it using $_ to represent the passed argument. It then passes the argument if the result is $true (including any output as valid).</p> <p>This can be used to test that a file exists:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">param</span><span class="token punctuation">(</span>
    <span class="token namespace">[ValidateScript({Test-Path $_})]</span>
    <span class="token namespace">[IO.FileInfo]</span><span class="token variable">$Path</span> 
<span class="token punctuation">)</span>

</code></pre></div><p>To check that a user exists in AD:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">param</span><span class="token punctuation">(</span>
    <span class="token namespace">[ValidateScript({Get-ADUser $_})]</span>
    <span class="token namespace">[String]</span><span class="token variable">$UserName</span>
<span class="token punctuation">)</span>

</code></pre></div><p>And pretty much anything else you can write (as it's not restricted to oneliners):</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">param</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span>ValidateScript<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token variable">$AnHourAgo</span> = <span class="token punctuation">(</span><span class="token function">Get-Date</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AddHours<span class="token punctuation">(</span><span class="token operator">-</span>1<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_</span> <span class="token operator">-lt</span> <span class="token variable">$AnHourAgo</span><span class="token punctuation">.</span>AddMinutes<span class="token punctuation">(</span>5<span class="token punctuation">)</span> <span class="token operator">-and</span> <span class="token variable">$_</span> <span class="token operator">-gt</span> <span class="token variable">$AnHourAgo</span><span class="token punctuation">.</span>AddMinutes<span class="token punctuation">(</span><span class="token operator">-</span>5<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token boolean">$true</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token string">&quot;That's not within five minutes. Try again.&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token namespace">[String]</span><span class="token variable">$TimeAboutAnHourAgo</span>
<span class="token punctuation">)</span>

</code></pre></div><h2 id="simple-function-with-no-parameters"><a href="#simple-function-with-no-parameters" class="header-anchor">#</a> Simple Function with No Parameters</h2> <p>This is an example of a function which returns a string.  In the example, the function is called in a statement assigning a value to a variable.  The value in this case is the return value of the function.</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> <span class="token function">Get-Greeting</span><span class="token punctuation">{</span>
    <span class="token string">&quot;Hello World&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment"># Invoking the function</span>
<span class="token variable">$greeting</span> = <span class="token function">Get-Greeting</span>

<span class="token comment"># demonstrate output</span>
<span class="token variable">$greeting</span>
<span class="token function">Get-Greeting</span>

</code></pre></div><p><code>function</code> declares the following code to be a function.</p> <p><code>Get-Greeting</code> is the name of the function.  Any time that function needs to be used in the script, the function can be called by means of invoking it by name.</p> <p><code>{ ... }</code> is the script block that is executed by the function.</p> <p>If the above code is executed in the ISE, the results would be something like:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>Hello World
Hello World

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/powershell/powershell-functions.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/powershell/working-with-objects.html" class="prev">
        Working with Objects
      </a></span> <span class="next"><a href="/powershell/powershell-classes.html">
        PowerShell Classes
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2613.0eefc3f3.js" defer></script>
  </body>
</html>
