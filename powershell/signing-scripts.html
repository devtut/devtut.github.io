<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PowerShell - Signing Scripts</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Bypassing execution policy for a single script, Signing a script, Changing the execution policy using Set-ExecutionPolicy, Get the current execution policy, Getting the signature from a signed script, Creating a self-signed code signing certificate for testing">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="PowerShell - Signing Scripts">
    <meta property="og:description" content="Bypassing execution policy for a single script, Signing a script, Changing the execution policy using Set-ExecutionPolicy, Get the current execution policy, Getting the signature from a signed script, Creating a self-signed code signing certificate for testing">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/powershell/signing-scripts.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="PowerShell - Signing Scripts">
    <meta name="twitter:description" content="Bypassing execution policy for a single script, Signing a script, Changing the execution policy using Set-ExecutionPolicy, Get the current execution policy, Getting the signature from a signed script, Creating a self-signed code signing certificate for testing">
    <meta name="twitter:url" content="/powershell/signing-scripts.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2628.c3dbefd3.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>PowerShell</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powershell/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/powershell/getting-started-with-powershell.html" class="sidebar-link">Getting started with PowerShell</a></li><li><a href="/powershell/variables-in-powershell.html" class="sidebar-link">Variables in PowerShell</a></li><li><a href="/powershell/operators.html" class="sidebar-link">Operators</a></li><li><a href="/powershell/special-operators.html" class="sidebar-link">Special Operators</a></li><li><a href="/powershell/basic-set-operations.html" class="sidebar-link">Basic Set Operations</a></li><li><a href="/powershell/conditional-logic.html" class="sidebar-link">Conditional logic</a></li><li><a href="/powershell/loops.html" class="sidebar-link">Loops</a></li><li><a href="/powershell/switch-statement.html" class="sidebar-link">Switch statement</a></li><li><a href="/powershell/strings.html" class="sidebar-link">Strings</a></li><li><a href="/powershell/hashtables.html" class="sidebar-link">HashTables</a></li><li><a href="/powershell/working-with-objects.html" class="sidebar-link">Working with Objects</a></li><li><a href="/powershell/powershell-functions.html" class="sidebar-link">PowerShell Functions</a></li><li><a href="/powershell/powershell-classes.html" class="sidebar-link">PowerShell Classes</a></li><li><a href="/powershell/powershell-modules.html" class="sidebar-link">Powershell Modules</a></li><li><a href="/powershell/powershell-profiles.html" class="sidebar-link">Powershell profiles</a></li><li><a href="/powershell/calculated-properties.html" class="sidebar-link">Calculated Properties</a></li><li><a href="/powershell/using-existing-static-classes.html" class="sidebar-link">Using existing static classes</a></li><li><a href="/powershell/built-in-variables.html" class="sidebar-link">Built-in variables</a></li><li><a href="/powershell/automatic-variables.html" class="sidebar-link">Automatic Variables</a></li><li><a href="/powershell/automatic-variables-part-2.html" class="sidebar-link">Automatic Variables - part 2</a></li><li><a href="/powershell/environment-variables.html" class="sidebar-link">Environment Variables</a></li><li><a href="/powershell/splatting.html" class="sidebar-link">Splatting</a></li><li><a href="/powershell/powershell-streams-debug-verbose-warning-error-output-and-information.html" class="sidebar-link">PowerShell &quot;Streams&quot;; Debug, Verbose, Warning, Error, Output and Information</a></li><li><a href="/powershell/sending-email.html" class="sidebar-link">Sending Email</a></li><li><a href="/powershell/powershell-remoting.html" class="sidebar-link">Powershell Remoting</a></li><li><a href="/powershell/working-with-the-powershell-pipeline.html" class="sidebar-link">Working with the PowerShell pipeline</a></li><li><a href="/powershell/powershell-background-jobs.html" class="sidebar-link">PowerShell Background Jobs</a></li><li><a href="/powershell/return-behavior-in-powershell.html" class="sidebar-link">Return behavior in PowerShell</a></li><li><a href="/powershell/csv-parsing.html" class="sidebar-link">CSV parsing</a></li><li><a href="/powershell/working-with-xml-files.html" class="sidebar-link">Working with XML Files</a></li><li><a href="/powershell/communicating-with-restful-apis.html" class="sidebar-link">Communicating with RESTful APIs</a></li><li><a href="/powershell/powershell-sql-queries.html" class="sidebar-link">powershell sql queries</a></li><li><a href="/powershell/regular-expressions.html" class="sidebar-link">Regular Expressions</a></li><li><a href="/powershell/aliases.html" class="sidebar-link">Aliases</a></li><li><a href="/powershell/using-the-progress-bar.html" class="sidebar-link">Using the progress bar</a></li><li><a href="/powershell/powershell-exe-command-line.html" class="sidebar-link">PowerShell.exe Command-Line</a></li><li><a href="/powershell/cmdlet-naming.html" class="sidebar-link">Cmdlet Naming</a></li><li><a href="/powershell/running-executables.html" class="sidebar-link">Running Executables</a></li><li><a href="/powershell/enforcing-script-prerequisites.html" class="sidebar-link">Enforcing script prerequisites</a></li><li><a href="/powershell/using-the-help-system.html" class="sidebar-link">Using the Help System</a></li><li><a href="/powershell/modules-scripts-and-functions.html" class="sidebar-link">Modules, Scripts and Functions</a></li><li><a href="/powershell/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/powershell/common-parameters.html" class="sidebar-link">Common parameters</a></li><li><a href="/powershell/parameter-sets.html" class="sidebar-link">Parameter sets</a></li><li><a href="/powershell/powershell-dynamic-parameters.html" class="sidebar-link">PowerShell Dynamic Parameters</a></li><li><a href="/powershell/gui-in-powershell.html" class="sidebar-link">GUI in Powershell</a></li><li><a href="/powershell/url-encode-decode.html" class="sidebar-link">URL Encode/Decode</a></li><li><a href="/powershell/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/powershell/package-management.html" class="sidebar-link">Package management</a></li><li><a href="/powershell/tcp-communication-with-powershell.html" class="sidebar-link">TCP Communication with PowerShell</a></li><li><a href="/powershell/powershell-workflows.html" class="sidebar-link">PowerShell Workflows</a></li><li><a href="/powershell/embedding-managed-code-c-vb.html" class="sidebar-link">Embedding Managed Code (C# | VB)</a></li><li><a href="/powershell/how-to-download-latest-artifact-from-artifactory-using-powershell-script-v2-0-or-below.html" class="sidebar-link">How to download latest artifact from Artifactory using Powershell script (v2.0 or below)?</a></li><li><a href="/powershell/comment-based-help.html" class="sidebar-link">Comment-based help</a></li><li><a href="/powershell/archive-module.html" class="sidebar-link">Archive Module</a></li><li><a href="/powershell/infrastructure-automation.html" class="sidebar-link">Infrastructure Automation</a></li><li><a href="/powershell/psscriptanalyzer-powershell-script-analyzer.html" class="sidebar-link">PSScriptAnalyzer - PowerShell Script Analyzer</a></li><li><a href="/powershell/desired-state-configuration.html" class="sidebar-link">Desired State Configuration</a></li><li><a href="/powershell/using-shouldprocess.html" class="sidebar-link">Using ShouldProcess</a></li><li><a href="/powershell/scheduled-tasks-module.html" class="sidebar-link">Scheduled tasks module</a></li><li><a href="/powershell/ise-module.html" class="sidebar-link">ISE module</a></li><li><a href="/powershell/creating-dsc-class-based-resources.html" class="sidebar-link">Creating DSC Class-Based Resources</a></li><li><a href="/powershell/wmi-and-cim.html" class="sidebar-link">WMI and CIM</a></li><li><a href="/powershell/activedirectory-module.html" class="sidebar-link">ActiveDirectory module</a></li><li><a href="/powershell/sharepoint-module.html" class="sidebar-link">SharePoint Module</a></li><li><a href="/powershell/introduction-to-psake.html" class="sidebar-link">Introduction to Psake</a></li><li><a href="/powershell/introduction-to-pester.html" class="sidebar-link">Introduction to Pester</a></li><li><a href="/powershell/handling-secrets-and-credentials.html" class="sidebar-link">Handling Secrets and Credentials</a></li><li><a href="/powershell/security-and-cryptography.html" class="sidebar-link">Security and Cryptography</a></li><li><a href="/powershell/signing-scripts.html" aria-current="page" class="active sidebar-link">Signing Scripts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/powershell/signing-scripts.html#bypassing-execution-policy-for-a-single-script" class="sidebar-link">Bypassing execution policy for a single script</a></li><li class="sidebar-sub-header"><a href="/powershell/signing-scripts.html#signing-a-script" class="sidebar-link">Signing a script</a></li><li class="sidebar-sub-header"><a href="/powershell/signing-scripts.html#changing-the-execution-policy-using-set-executionpolicy" class="sidebar-link">Changing the execution policy using Set-ExecutionPolicy</a></li><li class="sidebar-sub-header"><a href="/powershell/signing-scripts.html#get-the-current-execution-policy" class="sidebar-link">Get the current execution policy</a></li><li class="sidebar-sub-header"><a href="/powershell/signing-scripts.html#getting-the-signature-from-a-signed-script" class="sidebar-link">Getting the signature from a signed script</a></li><li class="sidebar-sub-header"><a href="/powershell/signing-scripts.html#creating-a-self-signed-code-signing-certificate-for-testing" class="sidebar-link">Creating a self-signed code signing certificate for testing</a></li></ul></li><li><a href="/powershell/anonymize-ip-v4-and-v6-in-text-file-with-powershell.html" class="sidebar-link">Anonymize IP (v4 and v6) in text file with Powershell</a></li><li><a href="/powershell/amazon-web-services-aws-rekognition.html" class="sidebar-link">Amazon Web Services (AWS) Rekognition</a></li><li><a href="/powershell/amazon-web-services-aws-simple-storage-service-s3.html" class="sidebar-link">Amazon Web Services (AWS) Simple Storage Service (S3)</a></li><li><a href="/powershell/mongodb.html" class="sidebar-link">MongoDB</a></li><li><a href="/powershell/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="signing-scripts"><a href="#signing-scripts" class="header-anchor">#</a> Signing Scripts</h1> <h2 id="bypassing-execution-policy-for-a-single-script"><a href="#bypassing-execution-policy-for-a-single-script" class="header-anchor">#</a> Bypassing execution policy for a single script</h2> <p>Often you might need to execute an unsigned script that doesn't comply with the current execution policy. An easy way to do this is by bypassing the execution policy for that single process. Example:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>powershell<span class="token punctuation">.</span>exe <span class="token operator">-</span>ExecutionPolicy Bypass <span class="token operator">-</span>File C:\MyUnsignedScript<span class="token punctuation">.</span>ps1

</code></pre></div><p>Or you can use the shorthand:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>powershell <span class="token operator">-</span>ep Bypass C:\MyUnsignedScript<span class="token punctuation">.</span>ps1

</code></pre></div><h3 id="other-execution-policies"><a href="#other-execution-policies" class="header-anchor">#</a> Other Execution Policies:</h3> <table><thead><tr><th>Policy</th> <th>Description</th></tr></thead> <tbody><tr><td><code>AllSigned</code></td> <td>Only scripts signed by a trusted publisher can be run.</td></tr> <tr><td><code>Bypass</code></td> <td>No restrictions; all Windows PowerShell scripts can be run.</td></tr> <tr><td><code>Default</code></td> <td>Normally <code>RemoteSigned</code>, but is controlled via ActiveDirectory</td></tr> <tr><td><code>RemoteSigned</code></td> <td>Downloaded scripts must be signed by a trusted publisher before they can be run.</td></tr> <tr><td><code>Restricted</code></td> <td>No scripts can be run. Windows PowerShell can be used only in interactive mode.</td></tr> <tr><td><code>Undefined</code></td> <td>NA</td></tr> <tr><td><code>Unrestricted</code>*</td> <td>Similar to <code>bypass</code></td></tr></tbody></table> <p><strong><strong><code>Unrestricted*</code> Caveat:</strong> If you run an unsigned script that was downloaded from the Internet, you are prompted for permission before it runs.</strong></p> <p>More Information available <a href="https://blog.netspi.com/15-ways-to-bypass-the-powershell-execution-policy/" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="signing-a-script"><a href="#signing-a-script" class="header-anchor">#</a> Signing a script</h2> <p>Signing a script is done by using the <code>Set-AuthenticodeSignature</code>-cmdlet and a code-signing certificate.</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token comment">#Get the first available personal code-signing certificate for the logged on user</span>
<span class="token variable">$cert</span> = @<span class="token punctuation">(</span><span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path Cert:\CurrentUser\My <span class="token operator">-</span>CodeSigningCert<span class="token punctuation">)</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span>
    
<span class="token comment">#Sign script using certificate</span>
<span class="token function">Set-AuthenticodeSignature</span> <span class="token operator">-</span>Certificate <span class="token variable">$cert</span> <span class="token operator">-</span>FilePath c:\MyScript<span class="token punctuation">.</span>ps1

</code></pre></div><p>You can also read a certificate from a <code>.pfx</code>-file using:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$cert</span> = <span class="token function">Get-PfxCertificate</span> <span class="token operator">-</span>FilePath <span class="token string">&quot;C:\MyCodeSigningCert.pfx&quot;</span>

</code></pre></div><p>The script will be valid until the cetificate expires. If you use a timestamp-server during the signing, the script will continue to be valid after the certificate expires. It is also useful to add the trust chain for the certificate (including root authority) to help most computers trust the certificated used to sign the script.</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">Set-AuthenticodeSignature</span> <span class="token operator">-</span>Certificate <span class="token variable">$cert</span> <span class="token operator">-</span>FilePath c:\MyScript<span class="token punctuation">.</span>ps1 <span class="token operator">-</span>IncludeChain All <span class="token operator">-</span>TimeStampServer <span class="token string">&quot;http://timestamp.verisign.com/scripts/timstamp.dll&quot;</span>

</code></pre></div><p>It's recommended to use a timestamp-server from a trusted certificate provider like Verisign, Comodo, Thawte etc.</p> <h2 id="changing-the-execution-policy-using-set-executionpolicy"><a href="#changing-the-execution-policy-using-set-executionpolicy" class="header-anchor">#</a> Changing the execution policy using Set-ExecutionPolicy</h2> <p>To change the execution policy for the default scope (LocalMachine), use:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">Set-ExecutionPolicy</span> AllSigned

</code></pre></div><p>To change the policy for a specific scope, use:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">Set-ExecutionPolicy</span> <span class="token operator">-</span>Scope CurrentUser <span class="token operator">-</span>ExecutionPolicy AllSigned

</code></pre></div><p>You can suppress the prompts by adding the <code>-Force</code> switch.</p> <h2 id="get-the-current-execution-policy"><a href="#get-the-current-execution-policy" class="header-anchor">#</a> Get the current execution policy</h2> <p>Getting the effective execution policy for the current session:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">PS</span>&gt; <span class="token function">Get-ExecutionPolicy</span>
RemoteSigned

</code></pre></div><p>List all effective execution policies for the current session:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">PS</span>&gt; <span class="token function">Get-ExecutionPolicy</span> <span class="token operator">-</span>List

        Scope ExecutionPolicy
        <span class="token operator">--</span>-<span class="token operator">--</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>
MachinePolicy       Undefined
   UserPolicy       Undefined
      <span class="token keyword">Process</span>       Undefined
  CurrentUser       Undefined
 LocalMachine    RemoteSigned

</code></pre></div><p>List the execution policy for a specific scope, ex. process:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">PS</span>&gt; <span class="token function">Get-ExecutionPolicy</span> <span class="token operator">-</span>Scope <span class="token keyword">Process</span>
Undefined

</code></pre></div><h2 id="getting-the-signature-from-a-signed-script"><a href="#getting-the-signature-from-a-signed-script" class="header-anchor">#</a> Getting the signature from a signed script</h2> <p>Get information about the Authenticode signature from a signed script by using the <code>Get-AuthenticodeSignature</code>-cmdlet:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">Get-AuthenticodeSignature</span> <span class="token punctuation">.</span>\MyScript<span class="token punctuation">.</span>ps1 <span class="token punctuation">|</span> <span class="token function">Format-List</span> <span class="token operator">*</span>

</code></pre></div><h2 id="creating-a-self-signed-code-signing-certificate-for-testing"><a href="#creating-a-self-signed-code-signing-certificate-for-testing" class="header-anchor">#</a> Creating a self-signed code signing certificate for testing</h2> <p>When signing personal scripts or when testing code signing it can be useful to create a self-signed code signing certificate.</p> <p>Beginning with PowerShell 5.0 you can generate a self-signed code signing certificate by using the <code>New-SelfSignedCertificate</code>-cmdlet:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">New-SelfSignedCertificate</span> <span class="token operator">-</span>FriendlyName <span class="token string">&quot;StackOverflow Example Code Signing&quot;</span> <span class="token operator">-</span>CertStoreLocation Cert:\CurrentUser\My <span class="token operator">-</span>Subject <span class="token string">&quot;SO User&quot;</span> <span class="token operator">-</span><span class="token function">Type</span> CodeSigningCert

</code></pre></div><p>In earlier versions, you can create a self-signed certificate using the <code>makecert.exe</code> tool found in the .NET Framework SDK and Windows SDK.</p> <p>A self-signed ceriticate will only be trusted by computers that have installed the certificate. For scripts that will be shared, a certificate from a trusted certificate authority (internal or trusted third-party) are recommended.</p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>Signing a script will make your scripts comply with all exeuction policies in PowerShell and ensure the integrity of a script. Signed scripts will fail to run if they have been modified after being signed.</p> <p>Scripts signing requires a code signing certificate. Recommendations:</p> <ul><li>Personal scripts/testing (not shared): Certificate from trusted certifiate authority (internal or third-party) <strong>OR</strong> a self-signed certificate.</li> <li>Shared inside organization: Certificate from trusted certifiate authority (internal or third-party)</li> <li>Shared outside organization: Certificate from trusted third party certifiate authority</li></ul> <p>Read more at <a href="https://technet.microsoft.com/en-us/library/hh847874(v=wps.640).aspx" target="_blank" rel="noopener noreferrer">about_Signing @ TechNet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="execution-policies"><a href="#execution-policies" class="header-anchor">#</a> Execution policies</h3> <p>PowerShell has configurable execution policies that control which conditions are required for a script or configuration to be executed. An excecution policy can be set for multiple scopes; computer, current user and current process. <strong>Execution policies can easily be bypassed and is not designed to restrict users, but rather protect them from violating signing policies unintentionally.</strong></p> <p>The available policies are:</p> <table><thead><tr><th>Setting</th> <th>Description</th></tr></thead> <tbody><tr><td>Restricted</td> <td>No scripts allowed</td></tr> <tr><td>AllSigned</td> <td>All scripts need to be signed</td></tr> <tr><td>RemoteSigned</td> <td>All local scripts allowed; only signed remote scripts</td></tr> <tr><td>Unrestricted</td> <td>No requirements. All scripts allowed, but will warn before running scripts downloaded from the internet</td></tr> <tr><td>Bypass</td> <td>All scripts are allowed and no warnings are displayed</td></tr> <tr><td>Undefined</td> <td>Remove the current execution policy for the current scope. Uses the parent policy. If all policies are undefined, restricted will be used.</td></tr></tbody></table> <p>You can modify the current execution policies using <code>Set-ExecutionPolicy</code>-cmdlet, Group Policy or the <code>-ExecutionPolicy</code> parameter when launching a <code>powershell.exe</code> process.</p> <p>Read more at <a href="https://technet.microsoft.com/en-us/library/hh847748(v=wps.620).aspx" target="_blank" rel="noopener noreferrer">about_Execution_Policies @ TechNet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/powershell/signing-scripts.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/powershell/security-and-cryptography.html" class="prev">
        Security and Cryptography
      </a></span> <span class="next"><a href="/powershell/anonymize-ip-v4-and-v6-in-text-file-with-powershell.html">
        Anonymize IP (v4 and v6) in text file with Powershell
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2628.c3dbefd3.js" defer></script>
  </body>
</html>
