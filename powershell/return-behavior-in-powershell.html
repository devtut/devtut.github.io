<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PowerShell - Return behavior in PowerShell</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Early exit, Gotcha! Return in the pipeline, Return with a value, Gotcha! Ignoring unwanted output, How to work with functions returns">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="PowerShell - Return behavior in PowerShell">
    <meta property="og:description" content="Early exit, Gotcha! Return in the pipeline, Return with a value, Gotcha! Ignoring unwanted output, How to work with functions returns">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/powershell/return-behavior-in-powershell.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="PowerShell - Return behavior in PowerShell">
    <meta name="twitter:description" content="Early exit, Gotcha! Return in the pipeline, Return with a value, Gotcha! Ignoring unwanted output, How to work with functions returns">
    <meta name="twitter:url" content="/powershell/return-behavior-in-powershell.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2622.f905f268.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>PowerShell</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powershell/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/powershell/getting-started-with-powershell.html" class="sidebar-link">Getting started with PowerShell</a></li><li><a href="/powershell/variables-in-powershell.html" class="sidebar-link">Variables in PowerShell</a></li><li><a href="/powershell/operators.html" class="sidebar-link">Operators</a></li><li><a href="/powershell/special-operators.html" class="sidebar-link">Special Operators</a></li><li><a href="/powershell/basic-set-operations.html" class="sidebar-link">Basic Set Operations</a></li><li><a href="/powershell/conditional-logic.html" class="sidebar-link">Conditional logic</a></li><li><a href="/powershell/loops.html" class="sidebar-link">Loops</a></li><li><a href="/powershell/switch-statement.html" class="sidebar-link">Switch statement</a></li><li><a href="/powershell/strings.html" class="sidebar-link">Strings</a></li><li><a href="/powershell/hashtables.html" class="sidebar-link">HashTables</a></li><li><a href="/powershell/working-with-objects.html" class="sidebar-link">Working with Objects</a></li><li><a href="/powershell/powershell-functions.html" class="sidebar-link">PowerShell Functions</a></li><li><a href="/powershell/powershell-classes.html" class="sidebar-link">PowerShell Classes</a></li><li><a href="/powershell/powershell-modules.html" class="sidebar-link">Powershell Modules</a></li><li><a href="/powershell/powershell-profiles.html" class="sidebar-link">Powershell profiles</a></li><li><a href="/powershell/calculated-properties.html" class="sidebar-link">Calculated Properties</a></li><li><a href="/powershell/using-existing-static-classes.html" class="sidebar-link">Using existing static classes</a></li><li><a href="/powershell/built-in-variables.html" class="sidebar-link">Built-in variables</a></li><li><a href="/powershell/automatic-variables.html" class="sidebar-link">Automatic Variables</a></li><li><a href="/powershell/automatic-variables-part-2.html" class="sidebar-link">Automatic Variables - part 2</a></li><li><a href="/powershell/environment-variables.html" class="sidebar-link">Environment Variables</a></li><li><a href="/powershell/splatting.html" class="sidebar-link">Splatting</a></li><li><a href="/powershell/powershell-streams-debug-verbose-warning-error-output-and-information.html" class="sidebar-link">PowerShell &quot;Streams&quot;; Debug, Verbose, Warning, Error, Output and Information</a></li><li><a href="/powershell/sending-email.html" class="sidebar-link">Sending Email</a></li><li><a href="/powershell/powershell-remoting.html" class="sidebar-link">Powershell Remoting</a></li><li><a href="/powershell/working-with-the-powershell-pipeline.html" class="sidebar-link">Working with the PowerShell pipeline</a></li><li><a href="/powershell/powershell-background-jobs.html" class="sidebar-link">PowerShell Background Jobs</a></li><li><a href="/powershell/return-behavior-in-powershell.html" aria-current="page" class="active sidebar-link">Return behavior in PowerShell</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/powershell/return-behavior-in-powershell.html#early-exit" class="sidebar-link">Early exit</a></li><li class="sidebar-sub-header"><a href="/powershell/return-behavior-in-powershell.html#gotcha-return-in-the-pipeline" class="sidebar-link">Gotcha! Return in the pipeline</a></li><li class="sidebar-sub-header"><a href="/powershell/return-behavior-in-powershell.html#return-with-a-value" class="sidebar-link">Return with a value</a></li><li class="sidebar-sub-header"><a href="/powershell/return-behavior-in-powershell.html#gotcha-ignoring-unwanted-output" class="sidebar-link">Gotcha! Ignoring unwanted output</a></li><li class="sidebar-sub-header"><a href="/powershell/return-behavior-in-powershell.html#how-to-work-with-functions-returns" class="sidebar-link">How to work with functions returns</a></li></ul></li><li><a href="/powershell/csv-parsing.html" class="sidebar-link">CSV parsing</a></li><li><a href="/powershell/working-with-xml-files.html" class="sidebar-link">Working with XML Files</a></li><li><a href="/powershell/communicating-with-restful-apis.html" class="sidebar-link">Communicating with RESTful APIs</a></li><li><a href="/powershell/powershell-sql-queries.html" class="sidebar-link">powershell sql queries</a></li><li><a href="/powershell/regular-expressions.html" class="sidebar-link">Regular Expressions</a></li><li><a href="/powershell/aliases.html" class="sidebar-link">Aliases</a></li><li><a href="/powershell/using-the-progress-bar.html" class="sidebar-link">Using the progress bar</a></li><li><a href="/powershell/powershell-exe-command-line.html" class="sidebar-link">PowerShell.exe Command-Line</a></li><li><a href="/powershell/cmdlet-naming.html" class="sidebar-link">Cmdlet Naming</a></li><li><a href="/powershell/running-executables.html" class="sidebar-link">Running Executables</a></li><li><a href="/powershell/enforcing-script-prerequisites.html" class="sidebar-link">Enforcing script prerequisites</a></li><li><a href="/powershell/using-the-help-system.html" class="sidebar-link">Using the Help System</a></li><li><a href="/powershell/modules-scripts-and-functions.html" class="sidebar-link">Modules, Scripts and Functions</a></li><li><a href="/powershell/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/powershell/common-parameters.html" class="sidebar-link">Common parameters</a></li><li><a href="/powershell/parameter-sets.html" class="sidebar-link">Parameter sets</a></li><li><a href="/powershell/powershell-dynamic-parameters.html" class="sidebar-link">PowerShell Dynamic Parameters</a></li><li><a href="/powershell/gui-in-powershell.html" class="sidebar-link">GUI in Powershell</a></li><li><a href="/powershell/url-encode-decode.html" class="sidebar-link">URL Encode/Decode</a></li><li><a href="/powershell/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/powershell/package-management.html" class="sidebar-link">Package management</a></li><li><a href="/powershell/tcp-communication-with-powershell.html" class="sidebar-link">TCP Communication with PowerShell</a></li><li><a href="/powershell/powershell-workflows.html" class="sidebar-link">PowerShell Workflows</a></li><li><a href="/powershell/embedding-managed-code-c-vb.html" class="sidebar-link">Embedding Managed Code (C# | VB)</a></li><li><a href="/powershell/how-to-download-latest-artifact-from-artifactory-using-powershell-script-v2-0-or-below.html" class="sidebar-link">How to download latest artifact from Artifactory using Powershell script (v2.0 or below)?</a></li><li><a href="/powershell/comment-based-help.html" class="sidebar-link">Comment-based help</a></li><li><a href="/powershell/archive-module.html" class="sidebar-link">Archive Module</a></li><li><a href="/powershell/infrastructure-automation.html" class="sidebar-link">Infrastructure Automation</a></li><li><a href="/powershell/psscriptanalyzer-powershell-script-analyzer.html" class="sidebar-link">PSScriptAnalyzer - PowerShell Script Analyzer</a></li><li><a href="/powershell/desired-state-configuration.html" class="sidebar-link">Desired State Configuration</a></li><li><a href="/powershell/using-shouldprocess.html" class="sidebar-link">Using ShouldProcess</a></li><li><a href="/powershell/scheduled-tasks-module.html" class="sidebar-link">Scheduled tasks module</a></li><li><a href="/powershell/ise-module.html" class="sidebar-link">ISE module</a></li><li><a href="/powershell/creating-dsc-class-based-resources.html" class="sidebar-link">Creating DSC Class-Based Resources</a></li><li><a href="/powershell/wmi-and-cim.html" class="sidebar-link">WMI and CIM</a></li><li><a href="/powershell/activedirectory-module.html" class="sidebar-link">ActiveDirectory module</a></li><li><a href="/powershell/sharepoint-module.html" class="sidebar-link">SharePoint Module</a></li><li><a href="/powershell/introduction-to-psake.html" class="sidebar-link">Introduction to Psake</a></li><li><a href="/powershell/introduction-to-pester.html" class="sidebar-link">Introduction to Pester</a></li><li><a href="/powershell/handling-secrets-and-credentials.html" class="sidebar-link">Handling Secrets and Credentials</a></li><li><a href="/powershell/security-and-cryptography.html" class="sidebar-link">Security and Cryptography</a></li><li><a href="/powershell/signing-scripts.html" class="sidebar-link">Signing Scripts</a></li><li><a href="/powershell/anonymize-ip-v4-and-v6-in-text-file-with-powershell.html" class="sidebar-link">Anonymize IP (v4 and v6) in text file with Powershell</a></li><li><a href="/powershell/amazon-web-services-aws-rekognition.html" class="sidebar-link">Amazon Web Services (AWS) Rekognition</a></li><li><a href="/powershell/amazon-web-services-aws-simple-storage-service-s3.html" class="sidebar-link">Amazon Web Services (AWS) Simple Storage Service (S3)</a></li><li><a href="/powershell/mongodb.html" class="sidebar-link">MongoDB</a></li><li><a href="/powershell/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="return-behavior-in-powershell"><a href="#return-behavior-in-powershell" class="header-anchor">#</a> Return behavior in PowerShell</h1> <p>It can be used to Exit the current scope, which can be a function, script, or script block. In PowerShell, the result of each statement is returned as output, even without an explicit Return keyword or to indicate that the end of the scope has been reached.</p> <h2 id="early-exit"><a href="#early-exit" class="header-anchor">#</a> Early exit</h2> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> earlyexit <span class="token punctuation">{</span>
    <span class="token string">&quot;Hello&quot;</span>
    <span class="token keyword">return</span>
    <span class="token string">&quot;World&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>&quot;Hello&quot; will be placed in the output pipeline, &quot;World&quot; will not</p> <h2 id="gotcha-return-in-the-pipeline"><a href="#gotcha-return-in-the-pipeline" class="header-anchor">#</a> Gotcha! Return in the pipeline</h2> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">get-childitem</span> <span class="token punctuation">|</span> <span class="token function">foreach-object</span> <span class="token punctuation">{</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>IsReadOnly<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> 

</code></pre></div><p>Pipeline cmdlets (ex: <code>ForEach-Object</code>, <code>Where-Object</code>, etc) operate on closures. The return here will only move to the next item on the pipeline, not exit processing.
You can use <strong>break</strong> instead of <strong>return</strong> if you want to exit processing.</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">get-childitem</span> <span class="token punctuation">|</span> <span class="token function">foreach-object</span> <span class="token punctuation">{</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>IsReadOnly<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">break</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> 

</code></pre></div><h2 id="return-with-a-value"><a href="#return-with-a-value" class="header-anchor">#</a> Return with a value</h2> <p>(paraphrased from <a href="https://technet.microsoft.com/en-us/library/hh847760.aspx" target="_blank" rel="noopener noreferrer">about_return<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <p>The following methods will have the same values on the pipeline</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> foo <span class="token punctuation">{</span>
    <span class="token variable">$a</span> = <span class="token string">&quot;Hello&quot;</span>
    <span class="token keyword">return</span> <span class="token variable">$a</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> bar <span class="token punctuation">{</span>
    <span class="token variable">$a</span> = <span class="token string">&quot;Hello&quot;</span>
    <span class="token variable">$a</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span> 

<span class="token keyword">function</span> quux <span class="token punctuation">{</span>
    <span class="token variable">$a</span> = <span class="token string">&quot;Hello&quot;</span>
    <span class="token variable">$a</span>
<span class="token punctuation">}</span> 

</code></pre></div><h2 id="gotcha-ignoring-unwanted-output"><a href="#gotcha-ignoring-unwanted-output" class="header-anchor">#</a> Gotcha! Ignoring unwanted output</h2> <p>Inspired by</p> <ul><li><a href="http://stackoverflow.com/questions/22663848/powershell-function-doesnt-have-proper-return-value" target="_blank" rel="noopener noreferrer">PowerShell: Function doesn't have proper return value<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> bar <span class="token punctuation">{</span>
 <span class="token namespace">[System.Collections.ArrayList]</span><span class="token variable">$MyVariable</span> = @<span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token variable">$MyVariable</span><span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
 <span class="token variable">$MyVariable</span><span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
 <span class="token variable">$MyVariable</span>
<span class="token punctuation">}</span>

</code></pre></div><p>The <code>Out-Null</code> is necessary because the .NET <code>ArrayList.Add</code> method returns the number of items in the collection after adding. If omitted, the pipeline would have contained <code>1, 2, &quot;a&quot;, &quot;b&quot;</code></p> <p>There are multiple ways to omit unwanted output:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">function</span> bar
<span class="token punctuation">{</span>
    <span class="token comment"># New-Item cmdlet returns information about newly created file/folder</span>
    <span class="token function">New-Item</span> <span class="token string">&quot;test1.txt&quot;</span> <span class="token punctuation">|</span> <span class="token function">out-null</span>
    <span class="token function">New-Item</span> <span class="token string">&quot;test2.txt&quot;</span> &gt; <span class="token variable">$null</span>
    <span class="token namespace">[void]</span><span class="token punctuation">(</span><span class="token function">New-Item</span> <span class="token string">&quot;test3.txt&quot;</span><span class="token punctuation">)</span>
    <span class="token variable">$tmp</span> = <span class="token function">New-Item</span> <span class="token string">&quot;test4.txt&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Note:</strong> to learn more about why to prefer <code>&gt; $null</code>, see [topic not yet created].</p> <h2 id="how-to-work-with-functions-returns"><a href="#how-to-work-with-functions-returns" class="header-anchor">#</a> How to work with functions returns</h2> <p>A function returns everything that is not captured by something else.<br>
If u use the <strong>return</strong> keyword, every statement after the return line will not be executed!</p> <p>Like this:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">Function</span> <span class="token function">Test-Function</span>
<span class="token punctuation">{</span>
    <span class="token keyword">Param</span>
    <span class="token punctuation">(</span>
        <span class="token namespace">[switch]</span><span class="token variable">$ExceptionalReturn</span>
    <span class="token punctuation">)</span>
    <span class="token string">&quot;Start&quot;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ExceptionalReturn</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">Return</span> <span class="token string">&quot;Damn, it didn't work!&quot;</span><span class="token punctuation">}</span>
    <span class="token function">New-ItemProperty</span> <span class="token operator">-</span>Path <span class="token string">&quot;HKCU:\&quot;</span> <span class="token operator">-</span>Name <span class="token string">&quot;test&quot;</span> <span class="token operator">-</span>Value <span class="token string">&quot;TestValue&quot;</span> <span class="token operator">-</span><span class="token function">Type</span> <span class="token string">&quot;String&quot;</span>
    <span class="token keyword">Return</span> <span class="token string">&quot;Yes, it worked!&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Test-Function<br>
Will return:</p> <ul><li>Start</li> <li>The newly created registry key (this is because there are some statements that create output that you may not be expecting)</li> <li>Yes, it worked!</li></ul> <p>Test-Function  -ExceptionalReturn
Will return:</p> <ul><li>Start</li> <li>Damn, it didn't work!</li></ul> <p>If you do it like this:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token keyword">Function</span> <span class="token function">Test-Function</span>
<span class="token punctuation">{</span>
    <span class="token keyword">Param</span>
    <span class="token punctuation">(</span>
        <span class="token namespace">[switch]</span><span class="token variable">$ExceptionalReturn</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span> <span class="token punctuation">{</span>
       <span class="token string">&quot;Start&quot;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ExceptionalReturn</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token variable">$Return</span> = <span class="token string">&quot;Damn, it didn't work!&quot;</span>
            <span class="token keyword">Return</span>
        <span class="token punctuation">}</span>
        <span class="token function">New-ItemProperty</span> <span class="token operator">-</span>Path <span class="token string">&quot;HKCU:\&quot;</span> <span class="token operator">-</span>Name <span class="token string">&quot;test&quot;</span> <span class="token operator">-</span>Value <span class="token string">&quot;TestValue&quot;</span> <span class="token operator">-</span><span class="token function">Type</span> <span class="token string">&quot;String&quot;</span>
        <span class="token variable">$Return</span> = <span class="token string">&quot;Yes, it worked!&quot;</span>
        <span class="token keyword">Return</span> 
    <span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
    <span class="token keyword">Return</span> <span class="token variable">$Return</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Test-Function<br>
Will return:</p> <ul><li>Yes, it worked!</li></ul> <p>Test-Function  -ExceptionalReturn
Will return:</p> <ul><li>Damn, it didn't work!</li></ul> <p>With this trick you can control the returned output even if you are not sure what will each statement will spit out.</p> <p>It works like this</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token punctuation">.</span><span class="token punctuation">{</span>&lt;Statements&gt;<span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">Out-Null</span>

</code></pre></div><p>the . makes the following scriptblock included in the code<br>
the {} marks the script block<br>
the | Out-Null pipes any unexpected output to Out-Null (so it is gone!)<br>
Because the scriptblock is included it gets the same scope as the rest of the function.<br>
So you can access variables who were made inside the scriptblock.</p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>You can read more about the return semantics on the <a href="https://technet.microsoft.com/en-us/library/hh847760.aspx" target="_blank" rel="noopener noreferrer">about_Return<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> page on TechNet, or by invoking <code>get-help return</code> from a PowerShell prompt.</p> <hr> <p>Notable Q&amp;A question(s) with more examples/explanation:</p> <ul><li><a href="http://stackoverflow.com/questions/10286164/function-return-value-in-powershell" target="_blank" rel="noopener noreferrer">Function return value in PowerShell<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://stackoverflow.com/questions/22663848/powershell-function-doesnt-have-proper-return-value" target="_blank" rel="noopener noreferrer">PowerShell: Function doesn't have proper return value<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <hr> <p><a href="https://technet.microsoft.com/en-us/library/hh847760.aspx" target="_blank" rel="noopener noreferrer">about_return<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on MSDN explains it succinctly:</p> <blockquote></blockquote> <p>The Return keyword exits a function, script, or script block. It can
be  used to exit a scope at a specific point, to return a value, or to
indicate  that the end of the scope has been reached.</p> <p>Users who are familiar with languages like C or C# might want to use
the  Return keyword to make the logic of leaving a scope explicit.</p> <p>In Windows PowerShell, the results of each statement are returned as
output, even without a statement that contains the Return keyword.
Languages like C or C# return only the value or values that are
specified  by the Return keyword.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/powershell/return-behavior-in-powershell.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/powershell/powershell-background-jobs.html" class="prev">
        PowerShell Background Jobs
      </a></span> <span class="next"><a href="/powershell/csv-parsing.html">
        CSV parsing
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2622.f905f268.js" defer></script>
  </body>
</html>
