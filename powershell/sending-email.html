<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PowerShell - Sending Email</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Send-MailMessage with predefined parameters, Simple Send-MailMessage, SMTPClient - Mail with .txt file in body message">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="PowerShell - Sending Email">
    <meta property="og:description" content="Send-MailMessage with predefined parameters, Simple Send-MailMessage, SMTPClient - Mail with .txt file in body message">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/powershell/sending-email.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="PowerShell - Sending Email">
    <meta name="twitter:description" content="Send-MailMessage with predefined parameters, Simple Send-MailMessage, SMTPClient - Mail with .txt file in body message">
    <meta name="twitter:url" content="/powershell/sending-email.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2626.216fb243.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>PowerShell</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powershell/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/powershell/getting-started-with-powershell.html" class="sidebar-link">Getting started with PowerShell</a></li><li><a href="/powershell/variables-in-powershell.html" class="sidebar-link">Variables in PowerShell</a></li><li><a href="/powershell/operators.html" class="sidebar-link">Operators</a></li><li><a href="/powershell/special-operators.html" class="sidebar-link">Special Operators</a></li><li><a href="/powershell/basic-set-operations.html" class="sidebar-link">Basic Set Operations</a></li><li><a href="/powershell/conditional-logic.html" class="sidebar-link">Conditional logic</a></li><li><a href="/powershell/loops.html" class="sidebar-link">Loops</a></li><li><a href="/powershell/switch-statement.html" class="sidebar-link">Switch statement</a></li><li><a href="/powershell/strings.html" class="sidebar-link">Strings</a></li><li><a href="/powershell/hashtables.html" class="sidebar-link">HashTables</a></li><li><a href="/powershell/working-with-objects.html" class="sidebar-link">Working with Objects</a></li><li><a href="/powershell/powershell-functions.html" class="sidebar-link">PowerShell Functions</a></li><li><a href="/powershell/powershell-classes.html" class="sidebar-link">PowerShell Classes</a></li><li><a href="/powershell/powershell-modules.html" class="sidebar-link">Powershell Modules</a></li><li><a href="/powershell/powershell-profiles.html" class="sidebar-link">Powershell profiles</a></li><li><a href="/powershell/calculated-properties.html" class="sidebar-link">Calculated Properties</a></li><li><a href="/powershell/using-existing-static-classes.html" class="sidebar-link">Using existing static classes</a></li><li><a href="/powershell/built-in-variables.html" class="sidebar-link">Built-in variables</a></li><li><a href="/powershell/automatic-variables.html" class="sidebar-link">Automatic Variables</a></li><li><a href="/powershell/automatic-variables-part-2.html" class="sidebar-link">Automatic Variables - part 2</a></li><li><a href="/powershell/environment-variables.html" class="sidebar-link">Environment Variables</a></li><li><a href="/powershell/splatting.html" class="sidebar-link">Splatting</a></li><li><a href="/powershell/powershell-streams-debug-verbose-warning-error-output-and-information.html" class="sidebar-link">PowerShell &quot;Streams&quot;; Debug, Verbose, Warning, Error, Output and Information</a></li><li><a href="/powershell/sending-email.html" aria-current="page" class="active sidebar-link">Sending Email</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/powershell/sending-email.html#send-mailmessage-with-predefined-parameters" class="sidebar-link">Send-MailMessage with predefined parameters</a></li><li class="sidebar-sub-header"><a href="/powershell/sending-email.html#simple-send-mailmessage" class="sidebar-link">Simple Send-MailMessage</a></li><li class="sidebar-sub-header"><a href="/powershell/sending-email.html#smtpclient-mail-with-txt-file-in-body-message" class="sidebar-link">SMTPClient - Mail with .txt file in body message</a></li></ul></li><li><a href="/powershell/powershell-remoting.html" class="sidebar-link">Powershell Remoting</a></li><li><a href="/powershell/working-with-the-powershell-pipeline.html" class="sidebar-link">Working with the PowerShell pipeline</a></li><li><a href="/powershell/powershell-background-jobs.html" class="sidebar-link">PowerShell Background Jobs</a></li><li><a href="/powershell/return-behavior-in-powershell.html" class="sidebar-link">Return behavior in PowerShell</a></li><li><a href="/powershell/csv-parsing.html" class="sidebar-link">CSV parsing</a></li><li><a href="/powershell/working-with-xml-files.html" class="sidebar-link">Working with XML Files</a></li><li><a href="/powershell/communicating-with-restful-apis.html" class="sidebar-link">Communicating with RESTful APIs</a></li><li><a href="/powershell/powershell-sql-queries.html" class="sidebar-link">powershell sql queries</a></li><li><a href="/powershell/regular-expressions.html" class="sidebar-link">Regular Expressions</a></li><li><a href="/powershell/aliases.html" class="sidebar-link">Aliases</a></li><li><a href="/powershell/using-the-progress-bar.html" class="sidebar-link">Using the progress bar</a></li><li><a href="/powershell/powershell-exe-command-line.html" class="sidebar-link">PowerShell.exe Command-Line</a></li><li><a href="/powershell/cmdlet-naming.html" class="sidebar-link">Cmdlet Naming</a></li><li><a href="/powershell/running-executables.html" class="sidebar-link">Running Executables</a></li><li><a href="/powershell/enforcing-script-prerequisites.html" class="sidebar-link">Enforcing script prerequisites</a></li><li><a href="/powershell/using-the-help-system.html" class="sidebar-link">Using the Help System</a></li><li><a href="/powershell/modules-scripts-and-functions.html" class="sidebar-link">Modules, Scripts and Functions</a></li><li><a href="/powershell/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/powershell/common-parameters.html" class="sidebar-link">Common parameters</a></li><li><a href="/powershell/parameter-sets.html" class="sidebar-link">Parameter sets</a></li><li><a href="/powershell/powershell-dynamic-parameters.html" class="sidebar-link">PowerShell Dynamic Parameters</a></li><li><a href="/powershell/gui-in-powershell.html" class="sidebar-link">GUI in Powershell</a></li><li><a href="/powershell/url-encode-decode.html" class="sidebar-link">URL Encode/Decode</a></li><li><a href="/powershell/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/powershell/package-management.html" class="sidebar-link">Package management</a></li><li><a href="/powershell/tcp-communication-with-powershell.html" class="sidebar-link">TCP Communication with PowerShell</a></li><li><a href="/powershell/powershell-workflows.html" class="sidebar-link">PowerShell Workflows</a></li><li><a href="/powershell/embedding-managed-code-c-vb.html" class="sidebar-link">Embedding Managed Code (C# | VB)</a></li><li><a href="/powershell/how-to-download-latest-artifact-from-artifactory-using-powershell-script-v2-0-or-below.html" class="sidebar-link">How to download latest artifact from Artifactory using Powershell script (v2.0 or below)?</a></li><li><a href="/powershell/comment-based-help.html" class="sidebar-link">Comment-based help</a></li><li><a href="/powershell/archive-module.html" class="sidebar-link">Archive Module</a></li><li><a href="/powershell/infrastructure-automation.html" class="sidebar-link">Infrastructure Automation</a></li><li><a href="/powershell/psscriptanalyzer-powershell-script-analyzer.html" class="sidebar-link">PSScriptAnalyzer - PowerShell Script Analyzer</a></li><li><a href="/powershell/desired-state-configuration.html" class="sidebar-link">Desired State Configuration</a></li><li><a href="/powershell/using-shouldprocess.html" class="sidebar-link">Using ShouldProcess</a></li><li><a href="/powershell/scheduled-tasks-module.html" class="sidebar-link">Scheduled tasks module</a></li><li><a href="/powershell/ise-module.html" class="sidebar-link">ISE module</a></li><li><a href="/powershell/creating-dsc-class-based-resources.html" class="sidebar-link">Creating DSC Class-Based Resources</a></li><li><a href="/powershell/wmi-and-cim.html" class="sidebar-link">WMI and CIM</a></li><li><a href="/powershell/activedirectory-module.html" class="sidebar-link">ActiveDirectory module</a></li><li><a href="/powershell/sharepoint-module.html" class="sidebar-link">SharePoint Module</a></li><li><a href="/powershell/introduction-to-psake.html" class="sidebar-link">Introduction to Psake</a></li><li><a href="/powershell/introduction-to-pester.html" class="sidebar-link">Introduction to Pester</a></li><li><a href="/powershell/handling-secrets-and-credentials.html" class="sidebar-link">Handling Secrets and Credentials</a></li><li><a href="/powershell/security-and-cryptography.html" class="sidebar-link">Security and Cryptography</a></li><li><a href="/powershell/signing-scripts.html" class="sidebar-link">Signing Scripts</a></li><li><a href="/powershell/anonymize-ip-v4-and-v6-in-text-file-with-powershell.html" class="sidebar-link">Anonymize IP (v4 and v6) in text file with Powershell</a></li><li><a href="/powershell/amazon-web-services-aws-rekognition.html" class="sidebar-link">Amazon Web Services (AWS) Rekognition</a></li><li><a href="/powershell/amazon-web-services-aws-simple-storage-service-s3.html" class="sidebar-link">Amazon Web Services (AWS) Simple Storage Service (S3)</a></li><li><a href="/powershell/mongodb.html" class="sidebar-link">MongoDB</a></li><li><a href="/powershell/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sending-email"><a href="#sending-email" class="header-anchor">#</a> Sending Email</h1> <p>A useful technique for Exchange Server administrators is to be able to send email messages via SMTP from PowerShell. Depending on the version of PowerShell installed on your computer or server, there are multiple ways to send emails via powershell. There is a native cmdlet option that is simple and easy to use. It uses the cmdlet <strong><strong>Send-MailMessage</strong></strong>.</p> <h2 id="send-mailmessage-with-predefined-parameters"><a href="#send-mailmessage-with-predefined-parameters" class="header-anchor">#</a> Send-MailMessage with predefined parameters</h2> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$parameters</span> = @<span class="token punctuation">{</span>
    <span class="token keyword">From</span> = <span class="token string">'from@bar.com'</span>
    To = <span class="token string">'to@bar.com'</span>
    Subject = <span class="token string">'Email Subject'</span>
    Attachments =  @<span class="token punctuation">(</span><span class="token string">'C:\files\samplefile1.txt'</span><span class="token punctuation">,</span><span class="token string">'C:\files\samplefile2.txt'</span><span class="token punctuation">)</span>
    BCC = <span class="token string">'bcc@bar.com'</span>
    Body = <span class="token string">'Email body'</span>
    BodyAsHTML = <span class="token boolean">$False</span>
    CC = <span class="token string">'cc@bar.com'</span>
    Credential = <span class="token function">Get-Credential</span>
    DeliveryNotificationOption = <span class="token string">'onSuccess'</span>
    Encoding = <span class="token string">'UTF8'</span>
    Port = <span class="token string">'25'</span>
    Priority = <span class="token string">'High'</span>
    SmtpServer = <span class="token string">'smtp.com'</span>
    UseSSL = <span class="token boolean">$True</span>
<span class="token punctuation">}</span>

<span class="token comment"># Notice: Splatting requires @ instead of $ in front of variable name</span>
<span class="token function">Send-MailMessage</span> @parameters

</code></pre></div><h2 id="simple-send-mailmessage"><a href="#simple-send-mailmessage" class="header-anchor">#</a> Simple Send-MailMessage</h2> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">Send-MailMessage</span> <span class="token operator">-</span><span class="token keyword">From</span> sender@bar<span class="token punctuation">.</span>com <span class="token operator">-</span>Subject <span class="token string">&quot;Email Subject&quot;</span> <span class="token operator">-</span>To receiver@bar<span class="token punctuation">.</span>com <span class="token operator">-</span>SmtpServer smtp<span class="token punctuation">.</span>com

</code></pre></div><h2 id="smtpclient-mail-with-txt-file-in-body-message"><a href="#smtpclient-mail-with-txt-file-in-body-message" class="header-anchor">#</a> SMTPClient - Mail with .txt file in body message</h2> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token comment"># Define the txt which will be in the email body</span>
<span class="token variable">$Txt_File</span> = <span class="token string">&quot;c:\file.txt&quot;</span>

<span class="token keyword">function</span> Send_mail <span class="token punctuation">{</span>
    <span class="token comment">#Define Email settings</span>
    <span class="token variable">$EmailFrom</span> = <span class="token string">&quot;source@domain.com&quot;</span>
    <span class="token variable">$EmailTo</span> = <span class="token string">&quot;destination@domain.com&quot;</span>
    <span class="token variable">$Txt_Body</span> = <span class="token function">Get-Content</span> <span class="token variable">$Txt_File</span> <span class="token operator">-</span>RAW
    <span class="token variable">$Body</span> = <span class="token variable">$Body_Custom</span> <span class="token operator">+</span> <span class="token variable">$Txt_Body</span>
    <span class="token variable">$Subject</span> = <span class="token string">&quot;Email Subject&quot;</span>
    <span class="token variable">$SMTPServer</span> = <span class="token string">&quot;smtpserver.domain.com&quot;</span>
    <span class="token variable">$SMTPClient</span> = <span class="token function">New-Object</span> Net<span class="token punctuation">.</span>Mail<span class="token punctuation">.</span>SmtpClient<span class="token punctuation">(</span><span class="token variable">$SmtpServer</span><span class="token punctuation">,</span> 25<span class="token punctuation">)</span> 
    <span class="token variable">$SMTPClient</span><span class="token punctuation">.</span>EnableSsl = <span class="token boolean">$false</span>
    <span class="token variable">$SMTPClient</span><span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token variable">$EmailFrom</span><span class="token punctuation">,</span> <span class="token variable">$EmailTo</span><span class="token punctuation">,</span> <span class="token variable">$Subject</span><span class="token punctuation">,</span> <span class="token variable">$Body</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token variable">$Body_Custom</span> = <span class="token string">&quot;This is what contain file.txt : &quot;</span>

Send_mail

</code></pre></div><h4 id="parameters"><a href="#parameters" class="header-anchor">#</a> Parameters</h4> <table><thead><tr><th>Parameter</th> <th>Details</th></tr></thead> <tbody><tr><td>Attachments&lt;String[]&gt;</td> <td>Path and file names of files to be attached to the message. Paths and filenames can be piped to Send-MailMessage.</td></tr> <tr><td>Bcc&lt;String[]&gt;</td> <td>Email addresses that receive a copy of an email message but does not appear as a recipient in the message. Enter names (optional) and the email address (required), such as Name someone@example.com or someone@example.com.</td></tr> <tr><td>Body &lt;String_&gt;</td> <td>Content of the email message.</td></tr> <tr><td>BodyAsHtml</td> <td>It indicates that the content is in HTML format.</td></tr> <tr><td>Cc&lt;String[]&gt;</td> <td>Email addresses that receive a copy of an email message. Enter names (optional) and the email address (required), such as Name someone@example.com or someone@example.com.</td></tr> <tr><td>Credential</td> <td>Specifies a user account that has permission to send message from specified email address. The default is the current user. Enter name such as User or Domain\User, or enter a PSCredential object.</td></tr> <tr><td>DeliveryNotificationOption</td> <td>Specifies the delivery notification options for the email message. Multiple values can be specified. Delivery notifications are sent in message to address specified in To parameter. Acceptable values: None, OnSuccess, OnFailure, Delay, Never.</td></tr> <tr><td>Encoding</td> <td>Encoding for the body and subject. Acceptable values: ASCII, UTF8, UTF7, UTF32, Unicode, BigEndianUnicode, Default, OEM.</td></tr> <tr><td>From</td> <td>Email addresses from which the mail is sent. Enter names (optional) and the email address (require), such as Name someone@example.com or someone@example.com.</td></tr> <tr><td>Port</td> <td>Alternate port on the SMTP server. The default value is 25. Available from Windows PowerShell 3.0.</td></tr> <tr><td>Priority</td> <td>Priority of the email message. Acceptable values: Normal, High, Low.</td></tr> <tr><td>SmtpServer</td> <td>Name of the SMTP server that sends the email message. Default value is the value of the $PSEmailServer variable.</td></tr> <tr><td>Subject</td> <td>Subject of the email message.</td></tr> <tr><td>To</td> <td>Email addresses to which the mail is sent. Enter names (optional) and the email address (required), such as Name someone@example.com or someone@example.com</td></tr> <tr><td>UseSsl</td> <td>Uses the Secure Sockets Layer (SSL) protocol to establish a connection to the remote computer to send mail</td></tr></tbody></table></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/powershell/sending-email.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/powershell/powershell-streams-debug-verbose-warning-error-output-and-information.html" class="prev">
        PowerShell &quot;Streams&quot;; Debug, Verbose, Warning, Error, Output and Information
      </a></span> <span class="next"><a href="/powershell/powershell-remoting.html">
        Powershell Remoting
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2626.216fb243.js" defer></script>
  </body>
</html>
