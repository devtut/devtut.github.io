<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Perl - Sorting</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Basic Lexical Sort, The Schwartzian Transform, Case Insensitive Sort, Numeric Sort, Reverse Sort">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Perl - Sorting">
    <meta property="og:description" content="Basic Lexical Sort, The Schwartzian Transform, Case Insensitive Sort, Numeric Sort, Reverse Sort">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/perl/sorting.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Perl - Sorting">
    <meta name="twitter:description" content="Basic Lexical Sort, The Schwartzian Transform, Case Insensitive Sort, Numeric Sort, Reverse Sort">
    <meta name="twitter:url" content="/perl/sorting.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2407.c51ce240.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Perl</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/perl/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/perl/getting-started-with-perl-language.html" class="sidebar-link">Getting started with Perl Language</a></li><li><a href="/perl/comments.html" class="sidebar-link">Comments</a></li><li><a href="/perl/variables.html" class="sidebar-link">Variables</a></li><li><a href="/perl/interpolation-in-perl.html" class="sidebar-link">Interpolation in Perl</a></li><li><a href="/perl/true-and-false.html" class="sidebar-link">True and false</a></li><li><a href="/perl/dates-and-time.html" class="sidebar-link">Dates and Time</a></li><li><a href="/perl/control-statements.html" class="sidebar-link">Control Statements</a></li><li><a href="/perl/subroutines.html" class="sidebar-link">Subroutines</a></li><li><a href="/perl/debug-output.html" class="sidebar-link">Debug Output</a></li><li><a href="/perl/lists.html" class="sidebar-link">Lists</a></li><li><a href="/perl/sorting.html" aria-current="page" class="active sidebar-link">Sorting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/perl/sorting.html#basic-lexical-sort" class="sidebar-link">Basic Lexical Sort</a></li><li class="sidebar-sub-header"><a href="/perl/sorting.html#the-schwartzian-transform" class="sidebar-link">The Schwartzian Transform</a></li><li class="sidebar-sub-header"><a href="/perl/sorting.html#case-insensitive-sort" class="sidebar-link">Case Insensitive Sort</a></li><li class="sidebar-sub-header"><a href="/perl/sorting.html#numeric-sort" class="sidebar-link">Numeric Sort</a></li><li class="sidebar-sub-header"><a href="/perl/sorting.html#reverse-sort" class="sidebar-link">Reverse Sort</a></li></ul></li><li><a href="/perl/file-i-o-reading-and-writing-files.html" class="sidebar-link">File I/O (reading and writing files)</a></li><li><a href="/perl/reading-a-file-s-content-into-a-variable.html" class="sidebar-link">Reading a file's content into a variable</a></li><li><a href="/perl/strings-and-quoting-methods.html" class="sidebar-link">Strings and quoting methods</a></li><li><a href="/perl/split-a-string-on-unquoted-separators.html" class="sidebar-link">Split a string on unquoted separators</a></li><li><a href="/perl/object-oriented-perl.html" class="sidebar-link">Object-oriented Perl</a></li><li><a href="/perl/exception-handling.html" class="sidebar-link">Exception handling</a></li><li><a href="/perl/regular-expressions.html" class="sidebar-link">Regular Expressions</a></li><li><a href="/perl/xml-parsing.html" class="sidebar-link">XML Parsing</a></li><li><a href="/perl/unicode.html" class="sidebar-link">Unicode</a></li><li><a href="/perl/perl-one-liners.html" class="sidebar-link">Perl one-liners</a></li><li><a href="/perl/randomness.html" class="sidebar-link">Randomness</a></li><li><a href="/perl/special-variables.html" class="sidebar-link">Special variables</a></li><li><a href="/perl/dates-and-time.html" class="sidebar-link">Dates and Time</a></li><li><a href="/perl/packages-and-modules.html" class="sidebar-link">Packages and modules</a></li><li><a href="/perl/install-perl-modules-via-cpan.html" class="sidebar-link">Install Perl modules via CPAN</a></li><li><a href="/perl/easy-way-to-check-installed-modules-on-mac-and-ubuntu.html" class="sidebar-link">Easy way to check installed modules on Mac and Ubuntu</a></li><li><a href="/perl/pack-and-unpack.html" class="sidebar-link">Pack and unpack</a></li><li><a href="/perl/perl-commands-for-windows-excel-with-win32-ole-module.html" class="sidebar-link">Perl commands for Windows Excel with Win32::OLE module</a></li><li><a href="/perl/simple-interaction-with-database-via-dbi-module.html" class="sidebar-link">Simple interaction with database via DBI module</a></li><li><a href="/perl/perl-testing.html" class="sidebar-link">Perl Testing</a></li><li><a href="/perl/dancer.html" class="sidebar-link">Dancer</a></li><li><a href="/perl/attributed-text.html" class="sidebar-link">Attributed Text</a></li><li><a href="/perl/gui-applications-in-perl.html" class="sidebar-link">GUI Applications in Perl</a></li><li><a href="/perl/memory-usage-optimization.html" class="sidebar-link">Memory usage optimization</a></li><li><a href="/perl/perl-script-debugging.html" class="sidebar-link">Perl script debugging</a></li><li><a href="/perl/perlbrew.html" class="sidebar-link">Perlbrew</a></li><li><a href="/perl/installation-of-perl.html" class="sidebar-link">Installation of Perl</a></li><li><a href="/perl/compile-perl-cpan-module-sapnwrfc-from-source-code.html" class="sidebar-link">Compile Perl cpan module sapnwrfc from source code</a></li><li><a href="/perl/best-practices.html" class="sidebar-link">Best Practices</a></li><li><a href="/perl/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sorting"><a href="#sorting" class="header-anchor">#</a> Sorting</h1> <p>For sorting lists of things, Perl has only a single function, unsurprisingly called <code>sort</code>. It is flexible enough to sort all kinds of items: numbers, strings in any number of encodings, nested data structures or objects. However, due to its flexibility, there are quite a few tricks and idioms to be learned for its use.</p> <h2 id="basic-lexical-sort"><a href="#basic-lexical-sort" class="header-anchor">#</a> Basic Lexical Sort</h2> <div class="language-perl extra-class"><pre class="language-perl"><code><span class="token variable">@sorted</span> <span class="token operator">=</span> sort <span class="token variable">@list</span><span class="token punctuation">;</span>

<span class="token variable">@sorted</span> <span class="token operator">=</span> sort <span class="token punctuation">{</span> <span class="token variable">$a</span> <span class="token operator">cmp</span> <span class="token variable">$b</span> <span class="token punctuation">}</span> <span class="token variable">@list</span><span class="token punctuation">;</span>

<span class="token function"><span class="token keyword">sub</span> compare</span> <span class="token punctuation">{</span> <span class="token variable">$a</span> <span class="token operator">cmp</span> <span class="token variable">$b</span> <span class="token punctuation">}</span>
<span class="token variable">@sorted</span> <span class="token operator">=</span> sort compare <span class="token variable">@list</span><span class="token punctuation">;</span>

</code></pre></div><p>The three examples above do exactly the same thing. If you don't supply any comparator function or block, <code>sort</code> assumes you want the list on its right sorted lexically. This is usually the form you want if you just need your data in some predictable order and don't care about linguistic correctness.</p> <p><code>sort</code> passes pairs of items in <code>@list</code> to the comparator function, which tells <code>sort</code> which item is larger. The <code>cmp</code> operator does this for strings while <code>&lt;=&gt;</code> does the same thing for numbers. The comparator is called quite often, on average <strong>n</strong> * log(<strong>n</strong>) times with <strong>n</strong> being the number of elements to be sorted, so it's important it be fast. This is the reason <code>sort</code> uses predefined package global variables (<code>$a</code> and <code>$b</code>) to pass the elements to be compared to the block or function, instead of proper function parameters.</p> <p>If you <code>use locale</code>, <code>cmp</code> takes locale specific collation order into account, e.g. it will sort <code>Å</code> like <code>A</code> under a Danish locale but after <code>Z</code> under an English or German one. However, it doesn't take the more complex Unicode sorting rules into account nor does it offer any control over the order—for example phone books are often sorted differently from dictionaries. For those cases, the <code>Unicode::Collate</code> and particularly <code>Unicode::Collate::Locale</code> modules are recommended.</p> <h2 id="the-schwartzian-transform"><a href="#the-schwartzian-transform" class="header-anchor">#</a> The Schwartzian Transform</h2> <p>This is probably the most famous example of a sort optimization making use of Perl's functional programming facilities, to be used where the sort order of items depend on an expensive function.</p> <div class="language-perl extra-class"><pre class="language-perl"><code><span class="token comment"># What you would usually do</span>
<span class="token variable">@sorted</span> <span class="token operator">=</span> sort <span class="token punctuation">{</span> slow<span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">&lt;=&gt;</span> slow<span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token variable">@list</span><span class="token punctuation">;</span>

<span class="token comment"># What you do to make it faster</span>
<span class="token variable">@sorted</span> <span class="token operator">=</span>
map <span class="token punctuation">{</span> <span class="token variable">$_</span><span class="token operator">-&gt;</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
sort <span class="token punctuation">{</span> <span class="token variable">$a</span><span class="token operator">-&gt;</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=&gt;</span> <span class="token variable">$b</span><span class="token operator">-&gt;</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
map <span class="token punctuation">{</span> <span class="token punctuation">[</span> <span class="token variable">$_</span><span class="token punctuation">,</span> slow<span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token variable">@list</span><span class="token punctuation">;</span>

</code></pre></div><p>The trouble with the first example is that the comparator is called very often and keeps recalculating values using a slow function over and over. A typical example would be sorting file names by their file size:</p> <div class="language-perl extra-class"><pre class="language-perl"><code><span class="token keyword">use</span> File<span class="token punctuation">:</span><span class="token punctuation">:</span>stat<span class="token punctuation">;</span>
<span class="token variable">@sorted</span> <span class="token operator">=</span> sort <span class="token punctuation">{</span> stat<span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span>size <span class="token operator">&lt;=&gt;</span> stat<span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span>size <span class="token punctuation">}</span> glob <span class="token string">&quot;*&quot;</span><span class="token punctuation">;</span>

</code></pre></div><p>This works, but at best it incurs the overhead of two system calls per comparison, at worst it has to go to the disk, twice, for every single comparison, and that disk may be in an overloaded file server on the other side of the planet.</p> <p>Enter Randall Schwartz's trick.</p> <p>The Schwartzian Transform basically shoves <code>@list</code> through three functions, bottom-to-top. The first <code>map</code> turns each entry into a two-element list of the original item and the result of the slow function as a sort key, so at the end of this we have called <code>slow()</code> exactly once for each element. The following <code>sort</code> can then simply access the sort key by looking in the list. As we don't care about the sort keys but only need the original elements in sorted order, the final <code>map</code> throws away the two-element lists from the already-sorted list it receives from <code>@sort</code> and returns a list of only their first members.</p> <h2 id="case-insensitive-sort"><a href="#case-insensitive-sort" class="header-anchor">#</a> Case Insensitive Sort</h2> <p>The traditional technique to make <code>sort</code> ignore case is to pass strings to <code>lc</code> or <code>uc</code> for comparison:</p> <div class="language-perl extra-class"><pre class="language-perl"><code><span class="token variable">@sorted</span> <span class="token operator">=</span> sort <span class="token punctuation">{</span> lc<span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">cmp</span> lc<span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token variable">@list</span><span class="token punctuation">;</span>

</code></pre></div><p>This works on all versions of Perl 5 and is completely sufficient for English; it doesn't matter whether you use <code>uc</code> or <code>lc</code>. However, it presents a problem for languages like Greek or Turkish where there is no 1:1 correspondence between upper- and lowercase letters so you get different results depending on whether you use <code>uc</code> or <code>lc</code>. Therefore, Perl 5.16 and higher have a <strong>case folding</strong> function called <code>fc</code> that avoids this problem, so modern multi-lingual sorting should use this:</p> <div class="language-perl extra-class"><pre class="language-perl"><code><span class="token variable">@sorted</span> <span class="token operator">=</span> sort <span class="token punctuation">{</span> fc<span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">cmp</span> fc<span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token variable">@list</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="numeric-sort"><a href="#numeric-sort" class="header-anchor">#</a> Numeric Sort</h2> <div class="language-perl extra-class"><pre class="language-perl"><code><span class="token variable">@sorted</span> <span class="token operator">=</span> sort <span class="token punctuation">{</span> <span class="token variable">$a</span> <span class="token operator">&lt;=&gt;</span> <span class="token variable">$b</span> <span class="token punctuation">}</span> <span class="token variable">@list</span><span class="token punctuation">;</span>

</code></pre></div><p>Comparing <code>$a</code> and <code>$b</code> with the <code>&lt;=&gt;</code> operator ensures they are compared numerically and not textually as per default.</p> <h2 id="reverse-sort"><a href="#reverse-sort" class="header-anchor">#</a> Reverse Sort</h2> <div class="language-perl extra-class"><pre class="language-perl"><code><span class="token variable">@sorted</span> <span class="token operator">=</span> sort <span class="token punctuation">{</span> <span class="token variable">$b</span> <span class="token operator">&lt;=&gt;</span> <span class="token variable">$a</span> <span class="token punctuation">}</span> <span class="token variable">@list</span><span class="token punctuation">;</span>
<span class="token variable">@sorted</span> <span class="token operator">=</span> reverse sort <span class="token punctuation">{</span> <span class="token variable">$a</span> <span class="token operator">&lt;=&gt;</span> <span class="token variable">$b</span> <span class="token punctuation">}</span> <span class="token variable">@list</span><span class="token punctuation">;</span>

</code></pre></div><p>Sorting items in descending order can simply be achieved by swapping <code>$a</code> and <code>$b</code> in the comparator block. However, some people prefer the clarity of a separate <code>reverse</code> even though it is slightly slower.</p> <h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li>sort SUBNAME LIST</li> <li>sort BLOCK LIST</li> <li>sort LIST</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/perl/sorting.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/perl/lists.html" class="prev">
        Lists
      </a></span> <span class="next"><a href="/perl/file-i-o-reading-and-writing-files.html">
        File I/O (reading and writing files)
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2407.c51ce240.js" defer></script>
  </body>
</html>
