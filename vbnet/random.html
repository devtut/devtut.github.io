<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Visual Basic .NET - Random</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Declaring an instance, Generate a random number from an instance of Random">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Visual Basic .NET - Random">
    <meta property="og:description" content="Declaring an instance, Generate a random number from an instance of Random">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/vbnet/random.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Visual Basic .NET - Random">
    <meta name="twitter:description" content="Declaring an instance, Generate a random number from an instance of Random">
    <meta name="twitter:url" content="/vbnet/random.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3486.57111ba1.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Visual Basic .NET</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vbnet/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/vbnet/getting-started-with-visual-basic-net-language.html" class="sidebar-link">Getting started with Visual Basic .NET Language</a></li><li><a href="/vbnet/declaring-variables.html" class="sidebar-link">Declaring variables</a></li><li><a href="/vbnet/introduction-to-syntax.html" class="sidebar-link">Introduction to Syntax</a></li><li><a href="/vbnet/operators.html" class="sidebar-link">Operators</a></li><li><a href="/vbnet/conditions.html" class="sidebar-link">Conditions</a></li><li><a href="/vbnet/short-circuiting-operators-andalso-orelse.html" class="sidebar-link">Short-Circuiting Operators (AndAlso - OrElse)</a></li><li><a href="/vbnet/date.html" class="sidebar-link">Date</a></li><li><a href="/vbnet/array.html" class="sidebar-link">Array</a></li><li><a href="/vbnet/lists.html" class="sidebar-link">Lists</a></li><li><a href="/vbnet/enum.html" class="sidebar-link">Enum</a></li><li><a href="/vbnet/dictionaries.html" class="sidebar-link">Dictionaries</a></li><li><a href="/vbnet/looping.html" class="sidebar-link">Looping</a></li><li><a href="/vbnet/file-handling.html" class="sidebar-link">File Handling</a></li><li><a href="/vbnet/file-folder-compression.html" class="sidebar-link">File/Folder Compression</a></li><li><a href="/vbnet/connection-handling.html" class="sidebar-link">Connection Handling</a></li><li><a href="/vbnet/data-access.html" class="sidebar-link">Data Access</a></li><li><a href="/vbnet/type-conversion.html" class="sidebar-link">Type conversion</a></li><li><a href="/vbnet/byval-and-byref-keywords.html" class="sidebar-link">ByVal and ByRef keywords</a></li><li><a href="/vbnet/console.html" class="sidebar-link">Console</a></li><li><a href="/vbnet/functions.html" class="sidebar-link">Functions</a></li><li><a href="/vbnet/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/vbnet/random.html" aria-current="page" class="active sidebar-link">Random</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vbnet/random.html#declaring-an-instance" class="sidebar-link">Declaring an instance</a></li><li class="sidebar-sub-header"><a href="/vbnet/random.html#generate-a-random-number-from-an-instance-of-random" class="sidebar-link">Generate a random number from an instance of Random</a></li></ul></li><li><a href="/vbnet/classes.html" class="sidebar-link">Classes</a></li><li><a href="/vbnet/generics.html" class="sidebar-link">Generics</a></li><li><a href="/vbnet/disposable-objects.html" class="sidebar-link">Disposable objects</a></li><li><a href="/vbnet/nullreferenceexception.html" class="sidebar-link">NullReferenceException</a></li><li><a href="/vbnet/using-statement.html" class="sidebar-link">Using Statement</a></li><li><a href="/vbnet/option-strict.html" class="sidebar-link">Option Strict</a></li><li><a href="/vbnet/option-explicit.html" class="sidebar-link">Option Explicit</a></li><li><a href="/vbnet/option-infer.html" class="sidebar-link">Option Infer</a></li><li><a href="/vbnet/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/vbnet/oop-keywords.html" class="sidebar-link">OOP Keywords</a></li><li><a href="/vbnet/extension-methods.html" class="sidebar-link">Extension methods</a></li><li><a href="/vbnet/reflection.html" class="sidebar-link">Reflection</a></li><li><a href="/vbnet/visual-basic-14-0-features.html" class="sidebar-link">Visual Basic 14.0 Features</a></li><li><a href="/vbnet/linq.html" class="sidebar-link">LINQ</a></li><li><a href="/vbnet/ftp-server.html" class="sidebar-link">FTP server</a></li><li><a href="/vbnet/working-with-windows-forms.html" class="sidebar-link">Working with Windows Forms</a></li><li><a href="/vbnet/google-maps-in-a-windows-form.html" class="sidebar-link">Google Maps in a Windows Form</a></li><li><a href="/vbnet/gdi.html" class="sidebar-link">GDI+</a></li><li><a href="/vbnet/winforms-spellcheckbox.html" class="sidebar-link">WinForms SpellCheckBox</a></li><li><a href="/vbnet/using-axwindowsmediaplayer-in-vb-net.html" class="sidebar-link">Using axWindowsMediaPlayer in VB.Net</a></li><li><a href="/vbnet/wpf-xaml-data-binding.html" class="sidebar-link">WPF XAML Data Binding</a></li><li><a href="/vbnet/reading-compressed-textfile-on-the-fly.html" class="sidebar-link">Reading compressed textfile on-the-fly</a></li><li><a href="/vbnet/threading.html" class="sidebar-link">Threading</a></li><li><a href="/vbnet/multithreading.html" class="sidebar-link">Multithreading</a></li><li><a href="/vbnet/backgroundworker.html" class="sidebar-link">BackgroundWorker</a></li><li><a href="/vbnet/using-backgroundworker.html" class="sidebar-link">Using BackgroundWorker</a></li><li><a href="/vbnet/task-based-asynchronous-pattern.html" class="sidebar-link">Task-based asynchronous pattern</a></li><li><a href="/vbnet/debugging-your-application.html" class="sidebar-link">Debugging your application</a></li><li><a href="/vbnet/unit-testing-in-vb-net.html" class="sidebar-link">Unit Testing in VB.NET</a></li><li><a href="/vbnet/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="random"><a href="#random" class="header-anchor">#</a> Random</h1> <p>The Random class is used to generate non-negative pseudo-random integers that are not truly random, but are for general purposes close enough.</p> <p>The sequence is calculated using an initial number (called the <strong>Seed</strong>) In earlier versions of .net, this seed number was the same every time an application was run. So what would happen was that you would get the same sequence of pseudo-random numbers every time the application was executed. Now, the seed is based on the time the object is declared.</p> <h2 id="declaring-an-instance"><a href="#declaring-an-instance" class="header-anchor">#</a> Declaring an instance</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> rng <span class="token keyword">As</span> <span class="token keyword">New</span> Random<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><p>This declares an instance of the Random class called <code>rng</code>. In this case, the current time at the point where the object is created is used to calculate the seed. This is the most common usage, but has its own problems as we shall see later in the remarks</p> <p>Instead of allowing the program to use the current time as part of the calculation for the initial seed number, you can specify the initial seed number. This can be any 32 bit integer literal, constant or variable. See below for examples. Doing this means that your instance will generate the same sequence of pseudo-random numbers, which can be useful in certain situations.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> rng <span class="token keyword">As</span> <span class="token keyword">New</span> Random<span class="token punctuation">(</span><span class="token number">43352</span><span class="token punctuation">)</span>

</code></pre></div><p>or</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> rng <span class="token keyword">As</span> <span class="token keyword">New</span> Random<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

</code></pre></div><p>where <code>x</code> has been declared elsewhere in your program as an Integer constant or variable.</p> <h2 id="generate-a-random-number-from-an-instance-of-random"><a href="#generate-a-random-number-from-an-instance-of-random" class="header-anchor">#</a> Generate a random number from an instance of Random</h2> <p>The following example declares a new instance of the Random class and then uses the method <code>.Next</code> to generate the next number in the sequence of pseudo-random numbers.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> rnd <span class="token keyword">As</span> <span class="token keyword">New</span> Random
<span class="token keyword">Dim</span> x <span class="token keyword">As</span> <span class="token keyword">Integer</span>
x <span class="token operator">=</span> rnd<span class="token punctuation">.</span><span class="token keyword">Next</span>

</code></pre></div><p>The last line above will generate the next pseudo-random number and assign it to <code>x</code>. This number will be in the range of 0 - 2147483647. However, you can also specify the range of numbers to be generated as in the example below.</p> <div class="language-vb extra-class"><pre class="language-vb"><code>x <span class="token operator">=</span> rnd<span class="token punctuation">.</span><span class="token keyword">Next</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>

</code></pre></div><p>Please note however, that using these parameters, range of numbers will be between 15 or above and 199 or below.</p> <p>You can also generate floating point numbers of the type Double by using <code>.NextDouble</code> e.g</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> rnd <span class="token keyword">As</span> <span class="token keyword">New</span> Random
<span class="token keyword">Dim</span> y <span class="token keyword">As</span> <span class="token keyword">Double</span>
y <span class="token operator">=</span> rnd<span class="token punctuation">.</span>NextDouble<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><p>You cannot however specify a range for this. It will always be in the range of 0.0 to less than 1.0.</p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>Finally, a note about randomization. As mentioned earlier, when you declare an instance of <code>Random</code> without any parameters, the constructor will use the current time as part of the calculation to create the initial seed number. Normally this is OK.</p> <p>However. If you re-declare new instances over a very short space of time, each time the seed number is calculated, the time could be the same. Consider this code.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">For</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">100000</span>
    <span class="token keyword">Dim</span> rnd <span class="token keyword">As</span> <span class="token keyword">New</span> Random
    x <span class="token operator">=</span> rnd<span class="token punctuation">.</span><span class="token keyword">Next</span>
<span class="token keyword">Next</span>

</code></pre></div><p>Because computers are very quick these days, this code will take a fraction of a second to run and on several dequential iterations of the loop, the system time will not have changed. So, the seed number will not change and the random number will be the same. If you want to generate lots of random numbers, declare the instance of random outside the loop in this simple example.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> rnd <span class="token keyword">As</span> <span class="token keyword">New</span> Random
<span class="token keyword">For</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">100000</span>
    x <span class="token operator">=</span> rnd<span class="token punctuation">.</span><span class="token keyword">Next</span>
<span class="token keyword">Next</span>

</code></pre></div><p><strong>The basic rule of thumb is don't re-instantiate random number generator over short periods of time.</strong></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/vbnet/random.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vbnet/recursion.html" class="prev">
        Recursion
      </a></span> <span class="next"><a href="/vbnet/classes.html">
        Classes
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3486.57111ba1.js" defer></script>
  </body>
</html>
