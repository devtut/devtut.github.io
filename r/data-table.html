<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>R - data.table</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Creating a data.table, Special symbols in data.table, Adding and modifying columns, Writing code compatible with both data.frame and data.table, Setting keys in data.table">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="R - data.table">
    <meta property="og:description" content="Creating a data.table, Special symbols in data.table, Adding and modifying columns, Writing code compatible with both data.frame and data.table, Setting keys in data.table">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/r/data-table.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="R - data.table">
    <meta name="twitter:description" content="Creating a data.table, Special symbols in data.table, Adding and modifying columns, Writing code compatible with both data.frame and data.table, Setting keys in data.table">
    <meta name="twitter:url" content="/r/data-table.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2876.15a6f5fe.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>R</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/r/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/r/getting-started-with-r-language.html" class="sidebar-link">Getting started with R Language</a></li><li><a href="/r/variables.html" class="sidebar-link">Variables</a></li><li><a href="/r/arithmetic-operators.html" class="sidebar-link">Arithmetic Operators</a></li><li><a href="/r/matrices.html" class="sidebar-link">Matrices</a></li><li><a href="/r/formula.html" class="sidebar-link">Formula</a></li><li><a href="/r/reading-and-writing-strings.html" class="sidebar-link">Reading and writing strings</a></li><li><a href="/r/string-manipulation-with-stringi-package.html" class="sidebar-link">String manipulation with stringi package</a></li><li><a href="/r/classes.html" class="sidebar-link">Classes</a></li><li><a href="/r/lists.html" class="sidebar-link">Lists</a></li><li><a href="/r/hashmaps.html" class="sidebar-link">Hashmaps</a></li><li><a href="/r/creating-vectors.html" class="sidebar-link">Creating vectors</a></li><li><a href="/r/date-and-time.html" class="sidebar-link">Date and Time</a></li><li><a href="/r/the-date-class.html" class="sidebar-link">The Date class</a></li><li><a href="/r/date-time-classes-posixct-and-posixlt.html" class="sidebar-link">Date-time classes (POSIXct and POSIXlt)</a></li><li><a href="/r/the-character-class.html" class="sidebar-link">The character class</a></li><li><a href="/r/numeric-classes-and-storage-modes.html" class="sidebar-link">Numeric classes and storage modes</a></li><li><a href="/r/the-logical-class.html" class="sidebar-link">The logical class</a></li><li><a href="/r/data-frames.html" class="sidebar-link">Data frames</a></li><li><a href="/r/split-function.html" class="sidebar-link">Split function</a></li><li><a href="/r/reading-and-writing-tabular-data-in-plain-text-files-csv-tsv-etc.html" class="sidebar-link">Reading and writing tabular data in plain-text files (CSV, TSV, etc.)</a></li><li><a href="/r/pipe-operators-and-others.html" class="sidebar-link">Pipe operators (%&gt;% and others)</a></li><li><a href="/r/linear-models-regression.html" class="sidebar-link">Linear Models (Regression)</a></li><li><a href="/r/data-table.html" aria-current="page" class="active sidebar-link">data.table</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/r/data-table.html#creating-a-data-table" class="sidebar-link">Creating a data.table</a></li><li class="sidebar-sub-header"><a href="/r/data-table.html#special-symbols-in-data-table" class="sidebar-link">Special symbols in data.table</a></li><li class="sidebar-sub-header"><a href="/r/data-table.html#adding-and-modifying-columns" class="sidebar-link">Adding and modifying columns</a></li><li class="sidebar-sub-header"><a href="/r/data-table.html#writing-code-compatible-with-both-data-frame-and-data-table" class="sidebar-link">Writing code compatible with both data.frame and data.table</a></li><li class="sidebar-sub-header"><a href="/r/data-table.html#setting-keys-in-data-table" class="sidebar-link">Setting keys in data.table</a></li></ul></li><li><a href="/r/pivot-and-unpivot-with-data-table.html" class="sidebar-link">Pivot and unpivot with data.table</a></li><li><a href="/r/bar-chart.html" class="sidebar-link">Bar Chart</a></li><li><a href="/r/base-plotting.html" class="sidebar-link">Base Plotting</a></li><li><a href="/r/boxplot.html" class="sidebar-link">boxplot</a></li><li><a href="/r/ggplot2.html" class="sidebar-link">ggplot2</a></li><li><a href="/r/factors.html" class="sidebar-link">Factors</a></li><li><a href="/r/pattern-matching-and-replacement.html" class="sidebar-link">Pattern Matching and Replacement</a></li><li><a href="/r/run-length-encoding.html" class="sidebar-link">Run-length encoding</a></li><li><a href="/r/speeding-up-tough-to-vectorize-code.html" class="sidebar-link">Speeding up tough-to-vectorize code</a></li><li><a href="/r/introduction-to-geographical-maps.html" class="sidebar-link">Introduction to Geographical Maps</a></li><li><a href="/r/set-operations.html" class="sidebar-link">Set operations</a></li><li><a href="/r/tidyverse.html" class="sidebar-link">tidyverse</a></li><li><a href="/r/rcpp.html" class="sidebar-link">Rcpp</a></li><li><a href="/r/random-numbers-generator.html" class="sidebar-link">Random Numbers Generator</a></li><li><a href="/r/parallel-processing.html" class="sidebar-link">Parallel processing</a></li><li><a href="/r/subsetting.html" class="sidebar-link">Subsetting</a></li><li><a href="/r/debugging.html" class="sidebar-link">Debugging</a></li><li><a href="/r/installing-packages.html" class="sidebar-link">Installing packages</a></li><li><a href="/r/updating-r-and-the-package-library.html" class="sidebar-link">Updating R and the package library</a></li><li><a href="/r/inspecting-packages.html" class="sidebar-link">Inspecting packages</a></li><li><a href="/r/creating-packages-with-devtools.html" class="sidebar-link">Creating packages with devtools</a></li><li><a href="/r/using-pipe-assignment-in-your-own-package-how-to.html" class="sidebar-link">Using pipe assignment in your own package %%: How to ?</a></li><li><a href="/r/arima-models.html" class="sidebar-link">Arima Models</a></li><li><a href="/r/distribution-functions.html" class="sidebar-link">Distribution Functions</a></li><li><a href="/r/shiny.html" class="sidebar-link">Shiny</a></li><li><a href="/r/spatial-analysis.html" class="sidebar-link">spatial analysis</a></li><li><a href="/r/sqldf.html" class="sidebar-link">sqldf</a></li><li><a href="/r/code-profiling.html" class="sidebar-link">Code profiling</a></li><li><a href="/r/control-flow-structures.html" class="sidebar-link">Control flow structures</a></li><li><a href="/r/column-wise-operation.html" class="sidebar-link">Column wise operation</a></li><li><a href="/r/json.html" class="sidebar-link">JSON</a></li><li><a href="/r/rodbc.html" class="sidebar-link">RODBC</a></li><li><a href="/r/lubridate.html" class="sidebar-link">lubridate</a></li><li><a href="/r/time-series-and-forecasting.html" class="sidebar-link">Time Series and Forecasting</a></li><li><a href="/r/strsplit-function.html" class="sidebar-link">strsplit function</a></li><li><a href="/r/web-scraping-and-parsing.html" class="sidebar-link">Web scraping and parsing</a></li><li><a href="/r/generalized-linear-models.html" class="sidebar-link">Generalized linear models</a></li><li><a href="/r/reshaping-data-between-long-and-wide-forms.html" class="sidebar-link">Reshaping data between long and wide forms</a></li><li><a href="/r/rmarkdown-and-knitr-presentation.html" class="sidebar-link">RMarkdown and knitr presentation</a></li><li><a href="/r/scope-of-variables.html" class="sidebar-link">Scope of variables</a></li><li><a href="/r/performing-a-permutation-test.html" class="sidebar-link">Performing a Permutation Test</a></li><li><a href="/r/xgboost.html" class="sidebar-link">xgboost</a></li><li><a href="/r/r-code-vectorization-best-practices.html" class="sidebar-link">R code vectorization best practices</a></li><li><a href="/r/missing-values.html" class="sidebar-link">Missing values</a></li><li><a href="/r/hierarchical-linear-modeling.html" class="sidebar-link">Hierarchical Linear Modeling</a></li><li><a href="/r/apply-family-of-functions-functionals.html" class="sidebar-link">*apply family of functions (functionals)</a></li><li><a href="/r/text-mining.html" class="sidebar-link">Text mining</a></li><li><a href="/r/anova.html" class="sidebar-link">ANOVA</a></li><li><a href="/r/raster-and-image-analysis.html" class="sidebar-link">Raster and Image Analysis</a></li><li><a href="/r/survival-analysis.html" class="sidebar-link">Survival analysis</a></li><li><a href="/r/fault-tolerant-resilient-code.html" class="sidebar-link">Fault-tolerant/resilient code</a></li><li><a href="/r/reproducible-r.html" class="sidebar-link">Reproducible R</a></li><li><a href="/r/fourier-series-and-transformations.html" class="sidebar-link">Fourier Series and Transformations</a></li><li><a href="/r/rprofile.html" class="sidebar-link">.Rprofile</a></li><li><a href="/r/dplyr.html" class="sidebar-link">dplyr</a></li><li><a href="/r/caret.html" class="sidebar-link">caret</a></li><li><a href="/r/extracting-and-listing-files-in-compressed-archives.html" class="sidebar-link">Extracting and Listing Files in Compressed Archives</a></li><li><a href="/r/probability-distributions-with-r.html" class="sidebar-link">Probability Distributions with R</a></li><li><a href="/r/r-in-latex-with-knitr.html" class="sidebar-link">R in LaTeX with knitr</a></li><li><a href="/r/web-crawling-in-r.html" class="sidebar-link">Web Crawling in R</a></li><li><a href="/r/creating-reports-with-rmarkdown.html" class="sidebar-link">Creating reports with RMarkdown</a></li><li><a href="/r/gpu-accelerated-computing.html" class="sidebar-link">GPU-accelerated computing</a></li><li><a href="/r/heatmap-and-heatmap-2.html" class="sidebar-link">heatmap and heatmap.2</a></li><li><a href="/r/network-analysis-with-the-igraph-package.html" class="sidebar-link">Network analysis with the igraph package</a></li><li><a href="/r/functional-programming.html" class="sidebar-link">Functional programming</a></li><li><a href="/r/get-user-input.html" class="sidebar-link">Get user input</a></li><li><a href="/r/spark-api-sparkr.html" class="sidebar-link">Spark API (SparkR)</a></li><li><a href="/r/meta-documentation-guidelines.html" class="sidebar-link">Meta: Documentation Guidelines</a></li><li><a href="/r/input-and-output.html" class="sidebar-link">Input and output</a></li><li><a href="/r/i-o-for-foreign-tables-excel-sas-spss-stata.html" class="sidebar-link">I/O for foreign tables (Excel, SAS, SPSS, Stata)</a></li><li><a href="/r/i-o-for-database-tables.html" class="sidebar-link">I/O for database tables</a></li><li><a href="/r/i-o-for-geographic-data-shapefiles-etc.html" class="sidebar-link">I/O for geographic data (shapefiles, etc.)</a></li><li><a href="/r/i-o-for-raster-images.html" class="sidebar-link">I/O for raster images</a></li><li><a href="/r/i-o-for-r-s-binary-format.html" class="sidebar-link">I/O for R's binary format</a></li><li><a href="/r/recycling.html" class="sidebar-link">Recycling</a></li><li><a href="/r/expression-parse-eval.html" class="sidebar-link">Expression: parse + eval</a></li><li><a href="/r/regular-expression-syntax-in-r.html" class="sidebar-link">Regular Expression Syntax in R</a></li><li><a href="/r/regular-expressions-regex.html" class="sidebar-link">Regular Expressions (regex)</a></li><li><a href="/r/combinatorics.html" class="sidebar-link">Combinatorics</a></li><li><a href="/r/solving-odes-in-r.html" class="sidebar-link">Solving ODEs in R</a></li><li><a href="/r/feature-selection-in-r-removing-extraneous-features.html" class="sidebar-link">Feature Selection in R -- Removing Extraneous Features</a></li><li><a href="/r/bibliography-in-rmd.html" class="sidebar-link">Bibliography in RMD</a></li><li><a href="/r/writing-functions-in-r.html" class="sidebar-link">Writing functions in R</a></li><li><a href="/r/color-schemes-for-graphics.html" class="sidebar-link">Color schemes for graphics</a></li><li><a href="/r/hierarchical-clustering-with-hclust.html" class="sidebar-link">Hierarchical clustering with hclust</a></li><li><a href="/r/random-forest-algorithm.html" class="sidebar-link">Random Forest Algorithm</a></li><li><a href="/r/restful-r-services.html" class="sidebar-link">RESTful R Services</a></li><li><a href="/r/machine-learning.html" class="sidebar-link">Machine learning</a></li><li><a href="/r/using-texreg-to-export-models-in-a-paper-ready-way.html" class="sidebar-link">Using texreg to export models in a paper-ready way</a></li><li><a href="/r/publishing.html" class="sidebar-link">Publishing</a></li><li><a href="/r/implement-state-machine-pattern-using-s4-class.html" class="sidebar-link">Implement State Machine Pattern using S4 Class</a></li><li><a href="/r/reshape-using-tidyr.html" class="sidebar-link">Reshape using tidyr</a></li><li><a href="/r/modifying-strings-by-substitution.html" class="sidebar-link">Modifying strings by substitution</a></li><li><a href="/r/non-standard-evaluation-and-standard-evaluation.html" class="sidebar-link">Non-standard evaluation and standard evaluation</a></li><li><a href="/r/randomization.html" class="sidebar-link">Randomization</a></li><li><a href="/r/object-oriented-programming-in-r.html" class="sidebar-link">Object-Oriented Programming in R</a></li><li><a href="/r/coercion.html" class="sidebar-link">Coercion</a></li><li><a href="/r/standardize-analyses-by-writing-standalone-r-scripts.html" class="sidebar-link">Standardize analyses by writing standalone R scripts</a></li><li><a href="/r/analyze-tweets-with-r.html" class="sidebar-link">Analyze tweets with R</a></li><li><a href="/r/natural-language-processing.html" class="sidebar-link">Natural language processing</a></li><li><a href="/r/r-markdown-notebooks-from-rstudio.html" class="sidebar-link">R Markdown Notebooks (from RStudio)</a></li><li><a href="/r/aggregating-data-frames.html" class="sidebar-link">Aggregating data frames</a></li><li><a href="/r/data-acquisition.html" class="sidebar-link">Data acquisition</a></li><li><a href="/r/r-memento-by-examples.html" class="sidebar-link">R memento by examples</a></li><li><a href="/r/updating-r-version.html" class="sidebar-link">Updating R version</a></li><li><a href="/r/introspection.html" class="sidebar-link">Introspection</a></li><li><a href="/r/roxygen2.html" class="sidebar-link">roxygen2</a></li><li><a href="/r/cleaning-data.html" class="sidebar-link">Cleaning data</a></li><li><a href="/r/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="data-table"><a href="#data-table" class="header-anchor">#</a> data.table</h1> <p>Data.table is a package that extends the functionality of data frames from base R, particularly improving on their performance and syntax. See the package's Docs area at <a href="http://stackoverflow.com/documentation/data.table/3389" target="_blank" rel="noopener noreferrer">Getting started with data.table<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for details.</p> <h2 id="creating-a-data-table"><a href="#creating-a-data-table" class="header-anchor">#</a> Creating a data.table</h2> <p>A data.table is an enhanced version of the data.frame class from base R. As such, its <code>class()</code> attribute is the vector <code>&quot;data.table&quot; &quot;data.frame&quot;</code> and functions that work on a data.frame will also work with a data.table. There are many ways to create, load or coerce to a data.table.</p> <h3 id="build"><a href="#build" class="header-anchor">#</a> Build</h3> <p>Don't forget to install and activate the <code>data.table</code> package</p> <div class="language-r extra-class"><pre class="language-r"><code>library<span class="token punctuation">(</span>data.table<span class="token punctuation">)</span>

</code></pre></div><p>There is a constructor of the same name:</p> <div class="language-r extra-class"><pre class="language-r"><code>DT <span class="token operator">&lt;-</span> data.table<span class="token punctuation">(</span>
  x <span class="token operator">=</span> letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
  y <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> 
  z <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">3</span>
<span class="token punctuation">)</span>
<span class="token comment">#    x y     z</span>
<span class="token comment"># 1: a 1 FALSE</span>
<span class="token comment"># 2: b 2 FALSE</span>
<span class="token comment"># 3: c 3 FALSE</span>
<span class="token comment"># 4: d 4  TRUE</span>
<span class="token comment"># 5: e 5  TRUE</span>

</code></pre></div><p>Unlike <code>data.frame</code>, <code>data.table</code> will not coerce strings to factors:</p> <div class="language-r extra-class"><pre class="language-r"><code>sapply<span class="token punctuation">(</span>DT<span class="token punctuation">,</span> class<span class="token punctuation">)</span>
<span class="token comment">#               x           y           z </span>
<span class="token comment">#     &quot;character&quot;   &quot;integer&quot;   &quot;logical&quot; </span>

</code></pre></div><h3 id="read-in"><a href="#read-in" class="header-anchor">#</a> Read in</h3> <p>We can read from a text file:</p> <div class="language-r extra-class"><pre class="language-r"><code>dt <span class="token operator">&lt;-</span> fread<span class="token punctuation">(</span><span class="token string">&quot;my_file.csv&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Unlike <code>read.csv</code>, <code>fread</code> will read strings as strings, not as factors.</p> <h3 id="modify-a-data-frame"><a href="#modify-a-data-frame" class="header-anchor">#</a> Modify a data.frame</h3> <p>For efficiency, data.table offers a way of altering a data.frame or list to make a data.table in-place (without making a copy or changing its memory location):</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment"># example data.frame</span>
DF <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>x <span class="token operator">=</span> letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># modification</span>
setDT<span class="token punctuation">(</span>DF<span class="token punctuation">)</span>

</code></pre></div><p>Note that we do not <code>&lt;-</code> assign the result, since the object <code>DF</code> has been modified in-place. The class attributes of the data.frame will be retained:</p> <div class="language-r extra-class"><pre class="language-r"><code>sapply<span class="token punctuation">(</span>DF<span class="token punctuation">,</span> class<span class="token punctuation">)</span>
<span class="token comment">#         x         y         z </span>
<span class="token comment">#  &quot;factor&quot; &quot;integer&quot; &quot;logical&quot; </span>

</code></pre></div><h3 id="coerce-object-to-data-table"><a href="#coerce-object-to-data-table" class="header-anchor">#</a> Coerce object to data.table</h3> <p><strong>If you have a <code>list</code>, <code>data.frame</code>, or <code>data.table</code>, you should use the <code>setDT</code> function</strong> to convert to a <code>data.table</code> because it does the conversion by reference instead of making a copy (which <code>as.data.table</code> does). This is important if you are working with large datasets.</p> <p>If you have another R object (such as a matrix), you must use <code>as.data.table</code> to coerce it to a <code>data.table</code>.</p> <div class="language-r extra-class"><pre class="language-r"><code>mat <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>

DT <span class="token operator">&lt;-</span> as.data.table<span class="token punctuation">(</span>mat<span class="token punctuation">)</span>
<span class="token comment"># or</span>
DT <span class="token operator">&lt;-</span> data.table<span class="token punctuation">(</span>mat<span class="token punctuation">)</span>

</code></pre></div><h2 id="special-symbols-in-data-table"><a href="#special-symbols-in-data-table" class="header-anchor">#</a> Special symbols in data.table</h2> <h3 id="sd"><a href="#sd" class="header-anchor">#</a> .SD</h3> <p><code>.SD</code> refers to the subset of the <code>data.table</code> for each group, excluding all columns used in <code>by</code>.</p> <p><code>.SD</code> along with <code>lapply</code> can be used to apply any function to multiple columns by group in a <code>data.table</code></p> <p>We will continue using the same built-in dataset, <code>mtcars</code>:</p> <div class="language-r extra-class"><pre class="language-r"><code>mtcars <span class="token operator">=</span> data.table<span class="token punctuation">(</span>mtcars<span class="token punctuation">)</span> <span class="token comment"># Let's not include rownames to keep things simpler</span>

</code></pre></div><p>Mean of all columns in the dataset by <strong>number of cylinders</strong>, <code>cyl</code>:</p> <div class="language-r extra-class"><pre class="language-r"><code>mtcars<span class="token punctuation">[</span> <span class="token punctuation">,</span> lapply<span class="token punctuation">(</span>.SD<span class="token punctuation">,</span> mean<span class="token punctuation">)</span><span class="token punctuation">,</span> by <span class="token operator">=</span> cyl<span class="token punctuation">]</span>

<span class="token comment">#   cyl      mpg     disp        hp     drat       wt     qsec        vs        am     gear     carb</span>
<span class="token comment">#1:   6 19.74286 183.3143 122.28571 3.585714 3.117143 17.97714 0.5714286 0.4285714 3.857143 3.428571</span>
<span class="token comment">#2:   4 26.66364 105.1364  82.63636 4.070909 2.285727 19.13727 0.9090909 0.7272727 4.090909 1.545455</span>
<span class="token comment">#3:   8 15.10000 353.1000 209.21429 3.229286 3.999214 16.77214 0.0000000 0.1428571 3.285714 3.500000</span>

</code></pre></div><p>Apart from <code>cyl</code>, there are other categorical columns in the dataset such as <code>vs</code>, <code>am</code>, <code>gear</code> and <code>carb</code>. It doesn't really make sense to take the <code>mean</code> of these columns. So let's exclude these columns. This is where <code>.SDcols</code> comes into the picture.</p> <h3 id="sdcols"><a href="#sdcols" class="header-anchor">#</a> .SDcols</h3> <p><code>.SDcols</code> specifies the columns of the <code>data.table</code> that are included in <code>.SD</code>.</p> <p>Mean of all columns (continuous columns) in the dataset by <strong>number of gears</strong> <code>gear</code>, and <strong>number of cylinders</strong>, <code>cyl</code>, arranged by <code>gear</code> and <code>cyl</code>:</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment"># All the continuous variables in the dataset</span>
cols_chosen <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">&quot;mpg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;disp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;drat&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;qsec&quot;</span><span class="token punctuation">)</span>

mtcars<span class="token punctuation">[</span>order<span class="token punctuation">(</span>gear<span class="token punctuation">,</span> cyl<span class="token punctuation">)</span><span class="token punctuation">,</span> lapply<span class="token punctuation">(</span>.SD<span class="token punctuation">,</span> mean<span class="token punctuation">)</span><span class="token punctuation">,</span> by <span class="token operator">=</span> .<span class="token punctuation">(</span>gear<span class="token punctuation">,</span> cyl<span class="token punctuation">)</span><span class="token punctuation">,</span> .SDcols <span class="token operator">=</span> cols_chosen<span class="token punctuation">]</span>

<span class="token comment">#   gear cyl    mpg     disp       hp     drat       wt    qsec</span>
<span class="token comment">#1:    3   4 21.500 120.1000  97.0000 3.700000 2.465000 20.0100</span>
<span class="token comment">#2:    3   6 19.750 241.5000 107.5000 2.920000 3.337500 19.8300</span>
<span class="token comment">#3:    3   8 15.050 357.6167 194.1667 3.120833 4.104083 17.1425</span>
<span class="token comment">#4:    4   4 26.925 102.6250  76.0000 4.110000 2.378125 19.6125</span>
<span class="token comment">#5:    4   6 19.750 163.8000 116.5000 3.910000 3.093750 17.6700</span>
<span class="token comment">#6:    5   4 28.200 107.7000 102.0000 4.100000 1.826500 16.8000</span>
<span class="token comment">#7:    5   6 19.700 145.0000 175.0000 3.620000 2.770000 15.5000</span>
<span class="token comment">#8:    5   8 15.400 326.0000 299.5000 3.880000 3.370000 14.5500</span>

</code></pre></div><p>Maybe we don't want to calculate the <code>mean</code> by groups. To calculate the mean for all the cars in the dataset, we don't specify the <code>by</code> variable.</p> <div class="language-r extra-class"><pre class="language-r"><code>mtcars<span class="token punctuation">[</span> <span class="token punctuation">,</span> lapply<span class="token punctuation">(</span>.SD<span class="token punctuation">,</span> mean<span class="token punctuation">)</span><span class="token punctuation">,</span> .SDcols <span class="token operator">=</span> cols_chosen<span class="token punctuation">]</span> 

<span class="token comment">#        mpg     disp       hp     drat      wt     qsec</span>
<span class="token comment">#1: 20.09062 230.7219 146.6875 3.596563 3.21725 17.84875</span>

</code></pre></div><p>Note:</p> <ul><li>It is not necessary to define <code>cols_chosen</code> beforehand. <code>.SDcols</code> can directly take column names</li> <li><code>.SDcols</code> can also directly take a vector of columnnumbers. In the above example this would be <code>mtcars[ , lapply(.SD, mean), .SDcols = c(1,3:7)]</code></li></ul> <h3 id="n"><a href="#n" class="header-anchor">#</a> .N</h3> <p><code>.N</code> is shorthand for the number of rows in a group.</p> <div class="language-r extra-class"><pre class="language-r"><code>iris<span class="token punctuation">[</span><span class="token punctuation">,</span> .<span class="token punctuation">(</span>count<span class="token operator">=</span>.N<span class="token punctuation">)</span><span class="token punctuation">,</span> by<span class="token operator">=</span>Species<span class="token punctuation">]</span>

<span class="token comment">#      Species count</span>
<span class="token comment">#1:     setosa    50</span>
<span class="token comment">#2: versicolor    50</span>
<span class="token comment">#3:  virginica    50</span>

</code></pre></div><h2 id="adding-and-modifying-columns"><a href="#adding-and-modifying-columns" class="header-anchor">#</a> Adding and modifying columns</h2> <p><code>DT[where, select|update|do, by]</code> syntax is used to work with columns of a data.table.</p> <ul><li>The &quot;where&quot; part is the <code>i</code> argument</li> <li>The &quot;select|update|do&quot; part is the <code>j</code> argument</li></ul> <p>These two arguments are usually passed by position instead of by name.</p> <p>Our example data below is</p> <div class="language-r extra-class"><pre class="language-r"><code>mtcars <span class="token operator">=</span> data.table<span class="token punctuation">(</span>mtcars<span class="token punctuation">,</span> keep.rownames <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="editing-entire-columns"><a href="#editing-entire-columns" class="header-anchor">#</a> Editing entire columns</h3> <p>Use the <code>:=</code> operator inside <code>j</code> to assign new columns:</p> <div class="language-r extra-class"><pre class="language-r"><code>mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> mpg_sq <span class="token operator">:</span><span class="token operator">=</span> mpg<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">]</span>

</code></pre></div><p>Remove columns by setting to <code>NULL</code>:</p> <div class="language-r extra-class"><pre class="language-r"><code>mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> mpg_sq <span class="token operator">:</span><span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">]</span>

</code></pre></div><p>Add multiple columns by using the <code>:=</code> operator's multivariate format:</p> <div class="language-r extra-class"><pre class="language-r"><code>mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> `<span class="token operator">:</span><span class="token operator">=</span>`<span class="token punctuation">(</span>mpg_sq <span class="token operator">=</span> mpg<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> wt_sqrt <span class="token operator">=</span> sqrt<span class="token punctuation">(</span>wt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># or </span>
mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">&quot;mpg_sq&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wt_sqrt&quot;</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token operator">=</span> .<span class="token punctuation">(</span>mpg<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> sqrt<span class="token punctuation">(</span>wt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

</code></pre></div><p>If the columns are dependent and must be defined in sequence, one way is:</p> <div class="language-r extra-class"><pre class="language-r"><code>mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">&quot;mpg_sq&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mpg2_hp&quot;</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token operator">=</span> .<span class="token punctuation">(</span>temp1 <span class="token operator">&lt;-</span> mpg<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> temp1<span class="token operator">/</span>hp<span class="token punctuation">)</span><span class="token punctuation">]</span>

</code></pre></div><p>The <code>.()</code> syntax is used when the right-hand side of <code>LHS := RHS</code> is a list of columns.</p> <p>For dynamically-determined column names, use parentheses:</p> <div class="language-r extra-class"><pre class="language-r"><code>vn <span class="token operator">=</span> <span class="token string">&quot;mpg_sq&quot;</span>
mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>vn<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token operator">=</span> mpg<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">]</span>

</code></pre></div><p>Columns can also be modified with <code>set</code>, though this is rarely necessary:</p> <div class="language-r extra-class"><pre class="language-r"><code>set<span class="token punctuation">(</span>mtcars<span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token string">&quot;hp_over_wt&quot;</span><span class="token punctuation">,</span> v <span class="token operator">=</span> mtcars<span class="token operator">$</span>hp<span class="token operator">/</span>mtcars<span class="token operator">$</span>wt<span class="token punctuation">)</span>

</code></pre></div><h3 id="editing-subsets-of-columns"><a href="#editing-subsets-of-columns" class="header-anchor">#</a> Editing subsets of columns</h3> <p>Use the <code>i</code> argument to subset to rows &quot;where&quot; edits should be made:</p> <div class="language-r extra-class"><pre class="language-r"><code>mtcars<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> newvar <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">]</span>
<span class="token comment"># or</span>
set<span class="token punctuation">(</span>mtcars<span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token string">&quot;newvar&quot;</span><span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> v <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span>  

</code></pre></div><p>As in a data.frame, we can subset using row numbers or logical tests. It is also possible to use a &quot;join&quot; in <code>i</code>, but that more complicated task is covered in another example.</p> <h3 id="editing-column-attributes"><a href="#editing-column-attributes" class="header-anchor">#</a> Editing column attributes</h3> <p>Functions that edit attributes, such as <code>levels&lt;-</code> or <code>names&lt;-</code>, actually replace an object with a modified copy. Even if only used on one column in a data.table, the entire object is copied and replaced.</p> <p>To modify an object without copies, use <code>setnames</code> to change the column names of a data.table or data.frame and <code>setattr</code> to change an attribute for any object.</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment"># Print a message to the console whenever the data.table is copied</span>
tracemem<span class="token punctuation">(</span>mtcars<span class="token punctuation">)</span>
mtcars<span class="token punctuation">[</span><span class="token punctuation">,</span> cyl2 <span class="token operator">:</span><span class="token operator">=</span> factor<span class="token punctuation">(</span>cyl<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># Neither of these statements copy the data.table</span>
setnames<span class="token punctuation">(</span>mtcars<span class="token punctuation">,</span> old <span class="token operator">=</span> <span class="token string">&quot;cyl2&quot;</span><span class="token punctuation">,</span> new <span class="token operator">=</span> <span class="token string">&quot;cyl_fac&quot;</span><span class="token punctuation">)</span>
setattr<span class="token punctuation">(</span>mtcars<span class="token operator">$</span>cyl_fac<span class="token punctuation">,</span> <span class="token string">&quot;levels&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">&quot;four&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;six&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;eight&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Each of these statements copies the data.table</span>
names<span class="token punctuation">(</span>mtcars<span class="token punctuation">)</span><span class="token punctuation">[</span>names<span class="token punctuation">(</span>mtcars<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;cyl_fac&quot;</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token string">&quot;cf&quot;</span>
levels<span class="token punctuation">(</span>mtcars<span class="token operator">$</span>cf<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">&quot;IV&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;VI&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;VIII&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Be aware that these changes are made by reference, so they are <strong>global</strong>. Changing them within one environment affects the object in all environments.</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment"># This function also changes the levels in the global environment</span>
edit_levels <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> setattr<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">&quot;levels&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">&quot;low&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;med&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;high&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
edit_levels<span class="token punctuation">(</span>mtcars<span class="token operator">$</span>cyl_factor<span class="token punctuation">)</span>

</code></pre></div><h2 id="writing-code-compatible-with-both-data-frame-and-data-table"><a href="#writing-code-compatible-with-both-data-frame-and-data-table" class="header-anchor">#</a> Writing code compatible with both data.frame and data.table</h2> <h3 id="differences-in-subsetting-syntax"><a href="#differences-in-subsetting-syntax" class="header-anchor">#</a> Differences in subsetting syntax</h3> <p>A <code>data.table</code> is one of several two-dimensional data structures available in R, besides <code>data.frame</code>, <code>matrix</code> and (2D) <code>array</code>. All of these classes use a very similar but not identical syntax for subsetting, the <code>A[rows, cols]</code> schema.</p> <p>Consider the following data stored in a <code>matrix</code>, a <code>data.frame</code> and a <code>data.table</code>:</p> <div class="language-r extra-class"><pre class="language-r"><code>ma <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nrow<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> dimnames<span class="token operator">=</span>list<span class="token punctuation">(</span>letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">'X'</span><span class="token punctuation">,</span> <span class="token string">'Y'</span><span class="token punctuation">,</span> <span class="token string">'Z'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df <span class="token operator">&lt;-</span> as.data.frame<span class="token punctuation">(</span>ma<span class="token punctuation">)</span>
dt <span class="token operator">&lt;-</span> as.data.table<span class="token punctuation">(</span>ma<span class="token punctuation">)</span>

ma<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span>  <span class="token comment">#---&gt; returns the 2nd and 3rd items, as if 'ma' were a vector (because it is!)</span>
df<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span>  <span class="token comment">#---&gt; returns the 2nd and 3rd columns</span>
dt<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span>  <span class="token comment">#---&gt; returns the 2nd and 3rd rows!</span>

</code></pre></div><p>If you want to be sure of what will be returned, it is better to be <strong>explicit</strong>.</p> <p>To get specific <strong>rows</strong>, just add a comma after the range:</p> <div class="language-r extra-class"><pre class="language-r"><code>ma<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>  <span class="token comment"># \</span>
df<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>  <span class="token comment">#  }---&gt; returns the 2nd and 3rd rows</span>
dt<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>  <span class="token comment"># /</span>

</code></pre></div><p>But, if you want to subset <strong>columns</strong>, some cases are interpreted differently. All
three can be subset the same way with integer or character indices <strong>not</strong> stored in a
variable.</p> <div class="language-r extra-class"><pre class="language-r"><code>ma<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span>          <span class="token comment">#  \</span>
df<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span>          <span class="token comment">#   \</span>
dt<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span>          <span class="token comment">#    }---&gt; returns the 2nd and 3rd columns</span>
ma<span class="token punctuation">[</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">&quot;Y&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment">#   /</span>
df<span class="token punctuation">[</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">&quot;Y&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment">#  /</span>
dt<span class="token punctuation">[</span><span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">&quot;Y&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment"># /</span>

</code></pre></div><p>However, they differ for unquoted variable names</p> <div class="language-r extra-class"><pre class="language-r"><code>mycols <span class="token operator">&lt;-</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span>
ma<span class="token punctuation">[</span><span class="token punctuation">,</span> mycols<span class="token punctuation">]</span>                <span class="token comment"># \</span>
df<span class="token punctuation">[</span><span class="token punctuation">,</span> mycols<span class="token punctuation">]</span>                <span class="token comment">#  }---&gt; returns the 2nd and 3rd columns</span>
dt<span class="token punctuation">[</span><span class="token punctuation">,</span> mycols<span class="token punctuation">,</span> with <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">]</span>  <span class="token comment"># /</span>

dt<span class="token punctuation">[</span><span class="token punctuation">,</span> mycols<span class="token punctuation">]</span>                <span class="token comment"># ---&gt; Raises an error</span>

</code></pre></div><p>In the last case, <code>mycols</code> is evaluated as the name of a column. Because <code>dt</code> cannot find
a column named <code>mycols</code>, an error is raised.</p> <p>Note: For versions of the <code>data.table</code> package priorto 1.9.8, this behavior was slightly
different. Anything in the column index would have been evaluated using <code>dt</code> as an
environment. So both <code>dt[, 2:3]</code> and <code>dt[, mycols]</code> would return the vector <code>2:3</code>. No
error would be raised for the second case, because the variable <code>mycols</code> does exist in
the parent environment.</p> <h3 id="strategies-for-maintaining-compatibility-with-data-frame-and-data-table"><a href="#strategies-for-maintaining-compatibility-with-data-frame-and-data-table" class="header-anchor">#</a> Strategies for maintaining compatibility with data.frame and data.table</h3> <p>There are many reasons to write code that is guaranteed to work with <code>data.frame</code> and <code>data.table</code>. Maybe you are forced to use <code>data.frame</code>, or you may need to share some code that you don't know how will be used. So, there are some main strategies for achieving this, in order of convenience:</p> <ol><li>Use syntax that behaves the same for both classes.</li> <li>Use a common function that does the same thing as the shortest syntax.</li> <li>Force <code>data.table</code> to behave as <code>data.frame</code> (ex.: call the specific method <code>print.data.frame</code>).</li> <li>Treat them as <code>list</code>, which they ultimately are.</li> <li>Convert the table to a <code>data.frame</code> before doing anything (bad idea if it is a huge table).</li> <li>Convert the table to <code>data.table</code>, if dependencies are not a concern.</li></ol> <p><strong>Subset rows.</strong> Its simple, just use the <code>[, ]</code> selector, <strong>with</strong> the comma:</p> <div class="language-r extra-class"><pre class="language-r"><code>A<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
A<span class="token punctuation">[</span>A<span class="token operator">$</span>var <span class="token operator">&gt;</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>  <span class="token comment"># A[var &gt; 17, ] just works for data.table</span>

</code></pre></div><p><strong>Subset columns.</strong> If you want a single column, use the <code>$</code> or the <code>[[ ]]</code> selector:</p> <div class="language-r extra-class"><pre class="language-r"><code>A<span class="token operator">$</span>var
colname <span class="token operator">&lt;-</span> <span class="token string">'var'</span>
A<span class="token punctuation">[</span><span class="token punctuation">[</span>colname<span class="token punctuation">]</span><span class="token punctuation">]</span>
A<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

</code></pre></div><p>If you want a uniform way to grab more than one column, it's necessary to appeal a bit:</p> <div class="language-r extra-class"><pre class="language-r"><code>B <span class="token operator">&lt;-</span> `<span class="token punctuation">[</span>.data.frame`<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>

<span class="token comment"># We can give it a better name</span>
select <span class="token operator">&lt;-</span> `<span class="token punctuation">[</span>.data.frame`
B <span class="token operator">&lt;-</span> select<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>
C <span class="token operator">&lt;-</span> select<span class="token punctuation">(</span>A<span class="token punctuation">,</span> c<span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p><strong>Subset 'indexed' rows.</strong> While <code>data.frame</code> has <code>row.names</code>, <code>data.table</code> has its unique <code>key</code> feature. The best thing is to avoid <code>row.names</code> entirely and take advantage of the existing optimizations in the case of <code>data.table</code> when possible.</p> <div class="language-r extra-class"><pre class="language-r"><code>B <span class="token operator">&lt;-</span> A<span class="token punctuation">[</span>A<span class="token operator">$</span>var <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
<span class="token comment"># or...</span>
B <span class="token operator">&lt;-</span> with<span class="token punctuation">(</span>A<span class="token punctuation">,</span> A<span class="token punctuation">[</span>var <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># data.table will silently index A by var before subsetting</span>

stuff <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">)</span>
C <span class="token operator">&lt;-</span> A<span class="token punctuation">[</span>match<span class="token punctuation">(</span>stuff<span class="token punctuation">,</span> A<span class="token operator">$</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>  <span class="token comment"># really worse than: setkey(A); A[stuff, ]</span>

</code></pre></div><p><strong>Get a 1-column table, get a row as a vector.</strong> These are easy with what we have seen until now:</p> <div class="language-r extra-class"><pre class="language-r"><code>B <span class="token operator">&lt;-</span> select<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment">#---&gt; a table with just the second column</span>
C <span class="token operator">&lt;-</span> unlist<span class="token punctuation">(</span>A<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#---&gt; the first row as a vector (coerced if necessary)</span>

</code></pre></div><h2 id="setting-keys-in-data-table"><a href="#setting-keys-in-data-table" class="header-anchor">#</a> Setting keys in data.table</h2> <p><strong>Yes, you need to SETKEY pre 1.9.6</strong></p> <p>In the past (pre 1.9.6),  your <code>data.table</code> was sped up by setting columns as keys to the table, particularly for large tables. [See <a href="http://stackoverflow.com/questions/20039335/what-is-the-purpose-of-setting-a-key-in-data-table" target="_blank" rel="noopener noreferrer">intro vignette page 5<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> of September 2015 version, where speed of  search was 544 times better.] You may find older code making use of this setting keys with 'setkey' or setting a 'key=' column when setting up the table.</p> <div class="language-r extra-class"><pre class="language-r"><code>library<span class="token punctuation">(</span>data.table<span class="token punctuation">)</span>
DT <span class="token operator">&lt;-</span> data.table<span class="token punctuation">(</span>
  x <span class="token operator">=</span> letters<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
  y <span class="token operator">=</span> <span class="token number">5</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> 
  z <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">3</span>
<span class="token punctuation">)</span>

<span class="token comment">#&gt; DT</span>
<span class="token comment">#   x y     z</span>
<span class="token comment">#1: a 5 FALSE</span>
<span class="token comment">#2: b 4 FALSE</span>
<span class="token comment">#3: c 3 FALSE</span>
<span class="token comment">#4: d 2  TRUE</span>
<span class="token comment">#5: e 1  TRUE</span>

</code></pre></div><p>Set your key with the <code>setkey</code> command. You can have a key with multiple columns.</p> <div class="language-r extra-class"><pre class="language-r"><code>setkey<span class="token punctuation">(</span>DT<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

</code></pre></div><p>Check your table's key in tables()</p> <div class="language-r extra-class"><pre class="language-r"><code>tables<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">&gt;</span> tables<span class="token punctuation">(</span><span class="token punctuation">)</span>
     NAME NROW NCOL MB COLS  KEY
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span> DT      <span class="token number">5</span>    <span class="token number">3</span>  <span class="token number">1</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z y  
Total<span class="token operator">:</span> <span class="token number">1</span>MB

</code></pre></div><p>Note this will re-sort your data.</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment">#&gt; DT</span>
<span class="token comment">#   x y     z</span>
<span class="token comment">#1: e 1  TRUE</span>
<span class="token comment">#2: d 2  TRUE</span>
<span class="token comment">#3: c 3 FALSE</span>
<span class="token comment">#4: b 4 FALSE</span>
<span class="token comment">#5: a 5 FALSE</span>

</code></pre></div><p><strong>Now it is unnecessary</strong></p> <p>Prior to v1.9.6 you had to have set a key for certain operations especially joining tables. The developers of data.table have sped up and introduced a <code>&quot;on=&quot;</code> feature that can replace the dependency on keys. See <a href="http://stackoverflow.com/questions/20039335/what-is-the-purpose-of-setting-a-key-in-data-table" target="_blank" rel="noopener noreferrer">SO answer here for a detailed discussion.<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>In Jan 2017, the developers have written a <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-secondary-indices-and-auto-indexing.html" target="_blank" rel="noopener noreferrer">vignette around secondary indices<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> which explains the &quot;on&quot; syntax and allows for other columns to be identified for fast indexing.</p> <p><strong>Creating secondary indices?</strong></p> <p>In a manner similar to key, you can <code>setindex(DT, key.col)</code> or <code>setindexv(DT, &quot;key.col.string&quot;)</code>, where DT is your data.table. Remove all indices with <code>setindex(DT, NULL)</code>.</p> <p>See your secondary indices with <code>indices(DT)</code>.</p> <p><strong>Why secondary indices?</strong></p> <p>This <strong>does not sort</strong> the table (unlike key), but does allow for quick indexing using the &quot;on&quot; syntax. Note there can be only one key, but you can use multiple secondary indices, which saves having to rekey and resort the table. This will speed up your subsetting when changing the columns you want to subset on.</p> <p>Recall, in example above y was the key for table DT:</p> <div class="language-r extra-class"><pre class="language-r"><code>DT
<span class="token comment"># x y     z</span>
<span class="token comment"># 1: e 1  TRUE</span>
<span class="token comment"># 2: d 2  TRUE</span>
<span class="token comment"># 3: c 3 FALSE</span>
<span class="token comment"># 4: b 4 FALSE</span>
<span class="token comment"># 5: a 5 FALSE</span>

<span class="token comment"># Let us set x as index </span>
setindex<span class="token punctuation">(</span>DT<span class="token punctuation">,</span> x<span class="token punctuation">)</span>

<span class="token comment"># Use indices to see what has been set</span>
indices<span class="token punctuation">(</span>DT<span class="token punctuation">)</span>
<span class="token comment"># [1] &quot;x&quot;</span>

<span class="token comment"># fast subset using index and not keyed column</span>
DT<span class="token punctuation">[</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span> on <span class="token operator">=</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">]</span>
<span class="token comment">#x y     z</span>
<span class="token comment">#1: c 3 FALSE</span>

<span class="token comment"># old way would have been rekeying DT from y to x, doing subset and </span>
<span class="token comment"># perhaps keying back to y (now we save two sorts)</span>
<span class="token comment"># This is a toy example above but would have been more valuable with big data sets</span>

</code></pre></div><h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <li>`DT[i, j, by]`<br>
# DT[where, select|update|do, by]</li> <li>`DT[...][...]`<br>
# chaining</li>
- `################# Shortcuts, special functions and special symbols inside DT[...]`
<li>.()<br>
# in several arguments, replaces list()</li> <li>J()<br>
# in i, replaces list()</li> <li>:=<br>
# in j, a function used to add or modify columns</li> <li>.N<br>
# in i, the total number of rows<br>
# in j, the number of rows in a group</li> <li>.I<br>
# in j, the vector of row numbers in the table (filtered by i)</li> <li>.SD<br>
# in j, the current subset of the data<br>
# selected by the .SDcols argument</li> <li>.GRP<br>
# in j, the current index of the subset of the data</li> <li>.BY<br>
# in j, the list of by values for the current subset of data</li> <li>V1, V2, ...<br>
# default names for unnamed columns created in j</li>
- `################# Joins inside DT[...]`
<li>DT1[DT2, on, j]<br>
# join two tables</li> <li>i.*<br>
# special prefix on DT2's columns after the join</li> <li>by=.EACHI<br>
# special option available only with a join</li> <li>DT1[!DT2, on, j]<br>
# anti-join two tables</li> <li>DT1[DT2, on, roll, j]<br>
# join two tables, rolling on the last column in on=</li>
- `################# Reshaping, stacking and splitting`
<li>melt(DT, id.vars, measure.vars)<br>
# transform to long format<br>
# for multiple columns, use measure.vars = patterns(...)</li> <li>dcast(DT, formula)<br>
# transform to wide format</li> <li>rbind(DT1, DT2, ...)<br>
# stack enumerated data.tables</li> <li>rbindlist(DT_list, idcol)<br>
# stack a list of data.tables</li> <li>split(DT, by)<br>
# split a data.table into a list</li>
- `################# Some other functions specialized for data.tables`
<li>foverlaps<br>
# overlap joins</li> <li>merge<br>
# another way of joining two tables</li> <li>set<br>
# another way of adding or modifying columns</li> <li>fintersect, fsetdiff, funion, fsetequal, unique, duplicated, anyDuplicated<br>
# set-theory operations with rows as elements</li> <li>uniqueN<br>
# the number of distinct rows</li> <li>rowidv(DT, cols)<br>
# row ID (1 to .N) within each group determined by cols</li> <li>rleidv(DT, cols)<br>
# group ID (1 to .GRP) within each group determined by runs of cols</li> <li>shift(DT, n, type=c(&quot;lag&quot;, &quot;lead&quot;))<br>
# apply a shift operator to every column</li> <li>setorder, setcolorder, setnames, setkey, setindex, setattr<br>
# modify attributes and order by reference</li> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <h3 id="installation-and-support"><a href="#installation-and-support" class="header-anchor">#</a> Installation and support</h3> <p><a href="https://github.com/Rdatatable/data.table/wiki/Installation" target="_blank" rel="noopener noreferrer">To install<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> the data.table package:</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment"># install from CRAN</span>
install.packages<span class="token punctuation">(</span><span class="token string">&quot;data.table&quot;</span><span class="token punctuation">)</span>       

<span class="token comment"># or install development version </span>
install.packages<span class="token punctuation">(</span><span class="token string">&quot;data.table&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">&quot;source&quot;</span><span class="token punctuation">,</span> repos <span class="token operator">=</span> <span class="token string">&quot;http://Rdatatable.github.io/data.table&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># and to revert from devel to CRAN, the current version must first be removed</span>
remove.packages<span class="token punctuation">(</span><span class="token string">&quot;data.table&quot;</span><span class="token punctuation">)</span>
install.packages<span class="token punctuation">(</span><span class="token string">&quot;data.table&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>The package's <a href="https://github.com/Rdatatable/data.table/wiki" target="_blank" rel="noopener noreferrer">official site<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> has wiki pages providing help getting started, and lists of presentations and articles from around the web. Before asking a question -- here on StackOverflow or anywhere else -- please read <a href="https://github.com/Rdatatable/data.table/wiki/Support" target="_blank" rel="noopener noreferrer">the support page<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="loading-the-package"><a href="#loading-the-package" class="header-anchor">#</a> Loading the package</h3> <p>Many of the functions in the examples above exist in the data.table namespace. To use them, you will need to add a line like <code>library(data.table)</code> first or to use their full path, like <code>data.table::fread</code> instead of simply <code>fread</code>. For help on individual functions, the syntax is <code>help(&quot;fread&quot;)</code> or <code>?fread</code>. Again, if the package is not loaded, use the full name like <code>?data.table::fread</code>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/r/data-table.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/r/linear-models-regression.html" class="prev">
        Linear Models (Regression)
      </a></span> <span class="next"><a href="/r/pivot-and-unpivot-with-data-table.html">
        Pivot and unpivot with data.table
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2876.15a6f5fe.js" defer></script>
  </body>
</html>
