<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>R - Formula</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="The basics of formula, Create Linear, Quadratic and Second Order Interaction Terms">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="R - Formula">
    <meta property="og:description" content="The basics of formula, Create Linear, Quadratic and Second Order Interaction Terms">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/r/formula.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="R - Formula">
    <meta name="twitter:description" content="The basics of formula, Create Linear, Quadratic and Second Order Interaction Terms">
    <meta name="twitter:url" content="/r/formula.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2887.ca046479.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>R</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/r/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/r/getting-started-with-r-language.html" class="sidebar-link">Getting started with R Language</a></li><li><a href="/r/variables.html" class="sidebar-link">Variables</a></li><li><a href="/r/arithmetic-operators.html" class="sidebar-link">Arithmetic Operators</a></li><li><a href="/r/matrices.html" class="sidebar-link">Matrices</a></li><li><a href="/r/formula.html" aria-current="page" class="active sidebar-link">Formula</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/r/formula.html#the-basics-of-formula" class="sidebar-link">The basics of formula</a></li><li class="sidebar-sub-header"><a href="/r/formula.html#create-linear-quadratic-and-second-order-interaction-terms" class="sidebar-link">Create Linear, Quadratic and Second Order Interaction Terms</a></li></ul></li><li><a href="/r/reading-and-writing-strings.html" class="sidebar-link">Reading and writing strings</a></li><li><a href="/r/string-manipulation-with-stringi-package.html" class="sidebar-link">String manipulation with stringi package</a></li><li><a href="/r/classes.html" class="sidebar-link">Classes</a></li><li><a href="/r/lists.html" class="sidebar-link">Lists</a></li><li><a href="/r/hashmaps.html" class="sidebar-link">Hashmaps</a></li><li><a href="/r/creating-vectors.html" class="sidebar-link">Creating vectors</a></li><li><a href="/r/date-and-time.html" class="sidebar-link">Date and Time</a></li><li><a href="/r/the-date-class.html" class="sidebar-link">The Date class</a></li><li><a href="/r/date-time-classes-posixct-and-posixlt.html" class="sidebar-link">Date-time classes (POSIXct and POSIXlt)</a></li><li><a href="/r/the-character-class.html" class="sidebar-link">The character class</a></li><li><a href="/r/numeric-classes-and-storage-modes.html" class="sidebar-link">Numeric classes and storage modes</a></li><li><a href="/r/the-logical-class.html" class="sidebar-link">The logical class</a></li><li><a href="/r/data-frames.html" class="sidebar-link">Data frames</a></li><li><a href="/r/split-function.html" class="sidebar-link">Split function</a></li><li><a href="/r/reading-and-writing-tabular-data-in-plain-text-files-csv-tsv-etc.html" class="sidebar-link">Reading and writing tabular data in plain-text files (CSV, TSV, etc.)</a></li><li><a href="/r/pipe-operators-and-others.html" class="sidebar-link">Pipe operators (%&gt;% and others)</a></li><li><a href="/r/linear-models-regression.html" class="sidebar-link">Linear Models (Regression)</a></li><li><a href="/r/data-table.html" class="sidebar-link">data.table</a></li><li><a href="/r/pivot-and-unpivot-with-data-table.html" class="sidebar-link">Pivot and unpivot with data.table</a></li><li><a href="/r/bar-chart.html" class="sidebar-link">Bar Chart</a></li><li><a href="/r/base-plotting.html" class="sidebar-link">Base Plotting</a></li><li><a href="/r/boxplot.html" class="sidebar-link">boxplot</a></li><li><a href="/r/ggplot2.html" class="sidebar-link">ggplot2</a></li><li><a href="/r/factors.html" class="sidebar-link">Factors</a></li><li><a href="/r/pattern-matching-and-replacement.html" class="sidebar-link">Pattern Matching and Replacement</a></li><li><a href="/r/run-length-encoding.html" class="sidebar-link">Run-length encoding</a></li><li><a href="/r/speeding-up-tough-to-vectorize-code.html" class="sidebar-link">Speeding up tough-to-vectorize code</a></li><li><a href="/r/introduction-to-geographical-maps.html" class="sidebar-link">Introduction to Geographical Maps</a></li><li><a href="/r/set-operations.html" class="sidebar-link">Set operations</a></li><li><a href="/r/tidyverse.html" class="sidebar-link">tidyverse</a></li><li><a href="/r/rcpp.html" class="sidebar-link">Rcpp</a></li><li><a href="/r/random-numbers-generator.html" class="sidebar-link">Random Numbers Generator</a></li><li><a href="/r/parallel-processing.html" class="sidebar-link">Parallel processing</a></li><li><a href="/r/subsetting.html" class="sidebar-link">Subsetting</a></li><li><a href="/r/debugging.html" class="sidebar-link">Debugging</a></li><li><a href="/r/installing-packages.html" class="sidebar-link">Installing packages</a></li><li><a href="/r/updating-r-and-the-package-library.html" class="sidebar-link">Updating R and the package library</a></li><li><a href="/r/inspecting-packages.html" class="sidebar-link">Inspecting packages</a></li><li><a href="/r/creating-packages-with-devtools.html" class="sidebar-link">Creating packages with devtools</a></li><li><a href="/r/using-pipe-assignment-in-your-own-package-how-to.html" class="sidebar-link">Using pipe assignment in your own package %%: How to ?</a></li><li><a href="/r/arima-models.html" class="sidebar-link">Arima Models</a></li><li><a href="/r/distribution-functions.html" class="sidebar-link">Distribution Functions</a></li><li><a href="/r/shiny.html" class="sidebar-link">Shiny</a></li><li><a href="/r/spatial-analysis.html" class="sidebar-link">spatial analysis</a></li><li><a href="/r/sqldf.html" class="sidebar-link">sqldf</a></li><li><a href="/r/code-profiling.html" class="sidebar-link">Code profiling</a></li><li><a href="/r/control-flow-structures.html" class="sidebar-link">Control flow structures</a></li><li><a href="/r/column-wise-operation.html" class="sidebar-link">Column wise operation</a></li><li><a href="/r/json.html" class="sidebar-link">JSON</a></li><li><a href="/r/rodbc.html" class="sidebar-link">RODBC</a></li><li><a href="/r/lubridate.html" class="sidebar-link">lubridate</a></li><li><a href="/r/time-series-and-forecasting.html" class="sidebar-link">Time Series and Forecasting</a></li><li><a href="/r/strsplit-function.html" class="sidebar-link">strsplit function</a></li><li><a href="/r/web-scraping-and-parsing.html" class="sidebar-link">Web scraping and parsing</a></li><li><a href="/r/generalized-linear-models.html" class="sidebar-link">Generalized linear models</a></li><li><a href="/r/reshaping-data-between-long-and-wide-forms.html" class="sidebar-link">Reshaping data between long and wide forms</a></li><li><a href="/r/rmarkdown-and-knitr-presentation.html" class="sidebar-link">RMarkdown and knitr presentation</a></li><li><a href="/r/scope-of-variables.html" class="sidebar-link">Scope of variables</a></li><li><a href="/r/performing-a-permutation-test.html" class="sidebar-link">Performing a Permutation Test</a></li><li><a href="/r/xgboost.html" class="sidebar-link">xgboost</a></li><li><a href="/r/r-code-vectorization-best-practices.html" class="sidebar-link">R code vectorization best practices</a></li><li><a href="/r/missing-values.html" class="sidebar-link">Missing values</a></li><li><a href="/r/hierarchical-linear-modeling.html" class="sidebar-link">Hierarchical Linear Modeling</a></li><li><a href="/r/apply-family-of-functions-functionals.html" class="sidebar-link">*apply family of functions (functionals)</a></li><li><a href="/r/text-mining.html" class="sidebar-link">Text mining</a></li><li><a href="/r/anova.html" class="sidebar-link">ANOVA</a></li><li><a href="/r/raster-and-image-analysis.html" class="sidebar-link">Raster and Image Analysis</a></li><li><a href="/r/survival-analysis.html" class="sidebar-link">Survival analysis</a></li><li><a href="/r/fault-tolerant-resilient-code.html" class="sidebar-link">Fault-tolerant/resilient code</a></li><li><a href="/r/reproducible-r.html" class="sidebar-link">Reproducible R</a></li><li><a href="/r/fourier-series-and-transformations.html" class="sidebar-link">Fourier Series and Transformations</a></li><li><a href="/r/rprofile.html" class="sidebar-link">.Rprofile</a></li><li><a href="/r/dplyr.html" class="sidebar-link">dplyr</a></li><li><a href="/r/caret.html" class="sidebar-link">caret</a></li><li><a href="/r/extracting-and-listing-files-in-compressed-archives.html" class="sidebar-link">Extracting and Listing Files in Compressed Archives</a></li><li><a href="/r/probability-distributions-with-r.html" class="sidebar-link">Probability Distributions with R</a></li><li><a href="/r/r-in-latex-with-knitr.html" class="sidebar-link">R in LaTeX with knitr</a></li><li><a href="/r/web-crawling-in-r.html" class="sidebar-link">Web Crawling in R</a></li><li><a href="/r/creating-reports-with-rmarkdown.html" class="sidebar-link">Creating reports with RMarkdown</a></li><li><a href="/r/gpu-accelerated-computing.html" class="sidebar-link">GPU-accelerated computing</a></li><li><a href="/r/heatmap-and-heatmap-2.html" class="sidebar-link">heatmap and heatmap.2</a></li><li><a href="/r/network-analysis-with-the-igraph-package.html" class="sidebar-link">Network analysis with the igraph package</a></li><li><a href="/r/functional-programming.html" class="sidebar-link">Functional programming</a></li><li><a href="/r/get-user-input.html" class="sidebar-link">Get user input</a></li><li><a href="/r/spark-api-sparkr.html" class="sidebar-link">Spark API (SparkR)</a></li><li><a href="/r/meta-documentation-guidelines.html" class="sidebar-link">Meta: Documentation Guidelines</a></li><li><a href="/r/input-and-output.html" class="sidebar-link">Input and output</a></li><li><a href="/r/i-o-for-foreign-tables-excel-sas-spss-stata.html" class="sidebar-link">I/O for foreign tables (Excel, SAS, SPSS, Stata)</a></li><li><a href="/r/i-o-for-database-tables.html" class="sidebar-link">I/O for database tables</a></li><li><a href="/r/i-o-for-geographic-data-shapefiles-etc.html" class="sidebar-link">I/O for geographic data (shapefiles, etc.)</a></li><li><a href="/r/i-o-for-raster-images.html" class="sidebar-link">I/O for raster images</a></li><li><a href="/r/i-o-for-r-s-binary-format.html" class="sidebar-link">I/O for R's binary format</a></li><li><a href="/r/recycling.html" class="sidebar-link">Recycling</a></li><li><a href="/r/expression-parse-eval.html" class="sidebar-link">Expression: parse + eval</a></li><li><a href="/r/regular-expression-syntax-in-r.html" class="sidebar-link">Regular Expression Syntax in R</a></li><li><a href="/r/regular-expressions-regex.html" class="sidebar-link">Regular Expressions (regex)</a></li><li><a href="/r/combinatorics.html" class="sidebar-link">Combinatorics</a></li><li><a href="/r/solving-odes-in-r.html" class="sidebar-link">Solving ODEs in R</a></li><li><a href="/r/feature-selection-in-r-removing-extraneous-features.html" class="sidebar-link">Feature Selection in R -- Removing Extraneous Features</a></li><li><a href="/r/bibliography-in-rmd.html" class="sidebar-link">Bibliography in RMD</a></li><li><a href="/r/writing-functions-in-r.html" class="sidebar-link">Writing functions in R</a></li><li><a href="/r/color-schemes-for-graphics.html" class="sidebar-link">Color schemes for graphics</a></li><li><a href="/r/hierarchical-clustering-with-hclust.html" class="sidebar-link">Hierarchical clustering with hclust</a></li><li><a href="/r/random-forest-algorithm.html" class="sidebar-link">Random Forest Algorithm</a></li><li><a href="/r/restful-r-services.html" class="sidebar-link">RESTful R Services</a></li><li><a href="/r/machine-learning.html" class="sidebar-link">Machine learning</a></li><li><a href="/r/using-texreg-to-export-models-in-a-paper-ready-way.html" class="sidebar-link">Using texreg to export models in a paper-ready way</a></li><li><a href="/r/publishing.html" class="sidebar-link">Publishing</a></li><li><a href="/r/implement-state-machine-pattern-using-s4-class.html" class="sidebar-link">Implement State Machine Pattern using S4 Class</a></li><li><a href="/r/reshape-using-tidyr.html" class="sidebar-link">Reshape using tidyr</a></li><li><a href="/r/modifying-strings-by-substitution.html" class="sidebar-link">Modifying strings by substitution</a></li><li><a href="/r/non-standard-evaluation-and-standard-evaluation.html" class="sidebar-link">Non-standard evaluation and standard evaluation</a></li><li><a href="/r/randomization.html" class="sidebar-link">Randomization</a></li><li><a href="/r/object-oriented-programming-in-r.html" class="sidebar-link">Object-Oriented Programming in R</a></li><li><a href="/r/coercion.html" class="sidebar-link">Coercion</a></li><li><a href="/r/standardize-analyses-by-writing-standalone-r-scripts.html" class="sidebar-link">Standardize analyses by writing standalone R scripts</a></li><li><a href="/r/analyze-tweets-with-r.html" class="sidebar-link">Analyze tweets with R</a></li><li><a href="/r/natural-language-processing.html" class="sidebar-link">Natural language processing</a></li><li><a href="/r/r-markdown-notebooks-from-rstudio.html" class="sidebar-link">R Markdown Notebooks (from RStudio)</a></li><li><a href="/r/aggregating-data-frames.html" class="sidebar-link">Aggregating data frames</a></li><li><a href="/r/data-acquisition.html" class="sidebar-link">Data acquisition</a></li><li><a href="/r/r-memento-by-examples.html" class="sidebar-link">R memento by examples</a></li><li><a href="/r/updating-r-version.html" class="sidebar-link">Updating R version</a></li><li><a href="/r/introspection.html" class="sidebar-link">Introspection</a></li><li><a href="/r/roxygen2.html" class="sidebar-link">roxygen2</a></li><li><a href="/r/cleaning-data.html" class="sidebar-link">Cleaning data</a></li><li><a href="/r/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="formula"><a href="#formula" class="header-anchor">#</a> Formula</h1> <h2 id="the-basics-of-formula"><a href="#the-basics-of-formula" class="header-anchor">#</a> The basics of formula</h2> <p>Statistical functions in R make heavy use of the so-called Wilkinson-Rogers formula notation<sup>1</sup> .</p> <p>When running model functions like <code>lm</code> for the <a href="http://stackoverflow.com/documentation/r/801/linear-regression" target="_blank" rel="noopener noreferrer">Linear Regressions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, they need a <code>formula</code>. This <code>formula</code> specifies which regression coefficients shall be estimated.</p> <div class="language-r extra-class"><pre class="language-r"><code>my_formula1 <span class="token operator">&lt;-</span> formula<span class="token punctuation">(</span>mpg <span class="token operator">~</span> wt<span class="token punctuation">)</span>
class<span class="token punctuation">(</span>my_formula1<span class="token punctuation">)</span> 
<span class="token comment"># gives &quot;formula&quot;</span>

mod1 <span class="token operator">&lt;-</span> lm<span class="token punctuation">(</span>my_formula1<span class="token punctuation">,</span> data <span class="token operator">=</span> mtcars<span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>mod1<span class="token punctuation">)</span>
<span class="token comment"># gives (Intercept)          wt </span>
<span class="token comment">#         37.285126   -5.344472 </span>

</code></pre></div><p>On the left side of the <code>~</code> (LHS) the dependent variable is specified, while the right hand side (RHS) contains the independent variables. Technically the <code>formula</code> call above is redundant because the tilde-operator is an infix function that returns an object with formula class:</p> <div class="language-r extra-class"><pre class="language-r"><code>form <span class="token operator">&lt;-</span> mpg <span class="token operator">~</span> wt
class<span class="token punctuation">(</span>form<span class="token punctuation">)</span>
<span class="token comment">#[1] &quot;formula&quot;</span>

</code></pre></div><p>The advantage of the <code>formula</code> function over <code>~</code> is that it also allows an environment for evaluation to be specified:</p> <div class="language-r extra-class"><pre class="language-r"><code>form_mt <span class="token operator">&lt;-</span> formula<span class="token punctuation">(</span>mpg <span class="token operator">~</span> wt<span class="token punctuation">,</span> env <span class="token operator">=</span> mtcars<span class="token punctuation">)</span>

</code></pre></div><p>In this case, the output shows that a regression coefficient for <code>wt</code> is estimated, as well as (per default) an intercept parameter. The intercept can be excluded / forced to be 0 by including <code>0</code> or <code>-1</code> in the <code>formula</code>:</p> <div class="language-r extra-class"><pre class="language-r"><code>coef<span class="token punctuation">(</span>lm<span class="token punctuation">(</span>mpg <span class="token operator">~</span> <span class="token number">0</span> <span class="token operator">+</span> wt<span class="token punctuation">,</span> data <span class="token operator">=</span> mtcars<span class="token punctuation">)</span><span class="token punctuation">)</span>
coef<span class="token punctuation">(</span>lm<span class="token punctuation">(</span>mpg <span class="token operator">~</span> wt <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> data <span class="token operator">=</span> mtcars<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>Interactions between variables <code>a</code> and <code>b</code> can added by included <code>a:b</code> to the <code>formula</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>
coef(lm(mpg ~ wt:vs, data = mtcars))

</code></pre></div><p>As it is (from a statistical point of view) generally advisable not have interactions in the model without the main effects, the naive approach would be to expand the <code>formula</code> to <code>a + b + a:b</code>. This works but can be simplified by writing <code>a*b</code>, where the <code>*</code> operator indicates factor crossing (when between two factor columns) or multiplication when one or both of the columns are 'numeric':</p> <div class="language-r extra-class"><pre class="language-r"><code>coef<span class="token punctuation">(</span>lm<span class="token punctuation">(</span>mpg <span class="token operator">~</span> wt<span class="token operator">*</span>vs<span class="token punctuation">,</span> data <span class="token operator">=</span> mtcars<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>Using the <code>*</code> notation expands a term to include all lower order effects, such that:</p> <div class="language-r extra-class"><pre class="language-r"><code>coef<span class="token punctuation">(</span>lm<span class="token punctuation">(</span>mpg <span class="token operator">~</span> wt<span class="token operator">*</span>vs<span class="token operator">*</span>hp<span class="token punctuation">,</span> data <span class="token operator">=</span> mtcars<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>will give, in addition to the intercept, 7 regression coefficients. One for the three-way interaction, three for the two-way interactions and three for the main effects.</p> <p>If one wants, for example, to exclude the three-way interaction, but retain all two-way interactions there are two shorthands. First, using <code>-</code> we can subtract any particular term:</p> <div class="language-r extra-class"><pre class="language-r"><code>coef<span class="token punctuation">(</span>lm<span class="token punctuation">(</span>mpg <span class="token operator">~</span> wt<span class="token operator">*</span>vs<span class="token operator">*</span>hp <span class="token operator">-</span> wt<span class="token operator">:</span>vs<span class="token operator">:</span>hp<span class="token punctuation">,</span> data <span class="token operator">=</span> mtcars<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>Or, we can use the <code>^</code> notation to specify which level of interaction we require:</p> <div class="language-r extra-class"><pre class="language-r"><code>coef<span class="token punctuation">(</span>lm<span class="token punctuation">(</span>mpg <span class="token operator">~</span> <span class="token punctuation">(</span>wt <span class="token operator">+</span> vs <span class="token operator">+</span> hp<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">2</span><span class="token punctuation">,</span> data <span class="token operator">=</span> mtcars<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>Those two formula specifications should create the same model matrix.</p> <p>Finally, <code>.</code> is shorthand to use all available variables as main effects. In this case, the <code>data</code> argument is used to obtain the available variables (which are not on the LHS). Therefore:</p> <div class="language-r extra-class"><pre class="language-r"><code>coef<span class="token punctuation">(</span>lm<span class="token punctuation">(</span>mpg <span class="token operator">~</span> .<span class="token punctuation">,</span> data <span class="token operator">=</span> mtcars<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>gives coefficients for the intercept and 10 independent variables. This notation is frequently used in machine learning packages, where one would like to use all variables for prediction or classification. Note that the meaning of <code>.</code> depends on context (see e.g. <code>?update.formula</code> for a different meaning).</p> <ol><li>G. N. Wilkinson and C. E. Rogers. <strong>Journal of the Royal Statistical Society. Series C (Applied Statistics)</strong> Vol. 22, No. 3 (1973), pp. 392-399</li></ol> <h2 id="create-linear-quadratic-and-second-order-interaction-terms"><a href="#create-linear-quadratic-and-second-order-interaction-terms" class="header-anchor">#</a> Create Linear, Quadratic and Second Order Interaction Terms</h2> <p><strong><code>y ~ .</code></strong> : Here <code>.</code> is interpreted as all variables except <code>y</code> in the data frame used in fitting the model. It is equivalent to the linear combinations of predictor variables. For example <code>y ~ var1 + var2 + var3+...+var15</code></p> <p><strong><code>y ~ . ^ 2</code></strong> will give all linear (main effects) and second order interaction terms of the variables in the data frame. It is equivalent to <code>y ~ var1 + var2 + ...+var15 + var1:var2 + var1:var3 + var1:var4...and so on</code></p> <p><strong><code>y ~ var1 + var2 + ...+var15 + I(var1^2) + I(var2^2) + I(var3^2)...+I(var15^2)</code></strong> : Here <code>I(var^2)</code> indicates quadratic polynomial of one variable in the data frame.</p> <p><strong><code>y ~ poly(var1, degree = 2) + poly(var2, degree = 2)+...poly(var15, degree = 2)</code></strong></p> <p>or</p> <p><strong><code>y ~ poly(var1, var2, var3, ....var15, degree = 2)</code></strong> will be equivalent to the above expression.</p> <p><code>poly(var1, degree = 2)</code> is equivalent to <code>var1 + I(var1^2)</code>.</p> <p>To get cubic polynomials, use <code>degree = 3</code> in <code>poly()</code>.</p> <p>There is a caveat in using <code>poly</code> versus <code>I(var, 2)</code>, which is after fitting the model, each of them will produce different coefficients, but the fitted values are equivalent, because they represent different parameterizations of the same model. It is recommended to use <code>I(var, 2)</code> over <code>poly()</code> to avoid the summary effect seen in <code>poly()</code>.</p> <p>In summary, to get linear, quadratic and second order interaction terms, you will have an expression like</p> <p><strong><code>y ~ .^2 + I(var1^2) + I(var2^2)+...I(var15^2)</code></strong></p> <p><strong>Demo for four variables:</strong></p> <div class="language-r extra-class"><pre class="language-r"><code>old <span class="token operator">&lt;-</span> reformulate<span class="token punctuation">(</span> <span class="token string">'y ~ x1+x2+x3+x4'</span> <span class="token punctuation">)</span>
new <span class="token operator">&lt;-</span> reformulate<span class="token punctuation">(</span> <span class="token string">&quot; y ~ .^2 + I(x1^2) + I(x2^2) + I(x3^2) + I(x4^2) &quot;</span><span class="token punctuation">)</span>
tmp <span class="token operator">&lt;-</span> .Call<span class="token punctuation">(</span>stats<span class="token operator">::</span><span class="token operator">:</span>C_updateform<span class="token punctuation">,</span> old<span class="token punctuation">,</span> new<span class="token punctuation">)</span>
terms.formula<span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> simplify <span class="token operator">=</span> <span class="token boolean">TRUE</span> <span class="token punctuation">)</span>

<span class="token comment"># ~y ~ x1 + x2 + x3 + x4 + I(x1^2) + I(x2^2) + I(x3^2) + I(x4^2) + </span>
<span class="token comment">#   x1:x2 + x1:x3 + x1:x4 + x2:x3 + x2:x4 + x3:x4</span>
<span class="token comment"># attr(,&quot;variables&quot;)</span>
<span class="token comment"># list(~y, x1, x2, x3, x4, I(x1^2), I(x2^2), I(x3^2), I(x4^2))</span>
<span class="token comment"># attr(,&quot;factors&quot;)</span>
<span class="token comment">#         x1 x2 x3 x4 I(x1^2) I(x2^2) I(x3^2) I(x4^2) x1:x2 x1:x3 x1:x4 x2:x3 x2:x4 x3:x4</span>
<span class="token comment"># ~y       0  0  0  0       0       0       0       0     0     0     0     0     0     0</span>
<span class="token comment"># x1       1  0  0  0       0       0       0       0     1     1     1     0     0     0</span>
<span class="token comment"># x2       0  1  0  0       0       0       0       0     1     0     0     1     1     0</span>
<span class="token comment"># x3       0  0  1  0       0       0       0       0     0     1     0     1     0     1</span>
<span class="token comment"># x4       0  0  0  1       0       0       0       0     0     0     1     0     1     1</span>
<span class="token comment"># I(x1^2)  0  0  0  0       1       0       0       0     0     0     0     0     0     0</span>
<span class="token comment"># I(x2^2)  0  0  0  0       0       1       0       0     0     0     0     0     0     0</span>
<span class="token comment"># I(x3^2)  0  0  0  0       0       0       1       0     0     0     0     0     0     0</span>
<span class="token comment"># I(x4^2)  0  0  0  0       0       0       0       1     0     0     0     0     0     0</span>
<span class="token comment"># attr(,&quot;term.labels&quot;)</span>
<span class="token comment"># [1] &quot;x1&quot;      &quot;x2&quot;      &quot;x3&quot;      &quot;x4&quot;      &quot;I(x1^2)&quot; &quot;I(x2^2)&quot; &quot;I(x3^2)&quot; &quot;I(x4^2)&quot;</span>
<span class="token comment"># [9] &quot;x1:x2&quot;   &quot;x1:x3&quot;   &quot;x1:x4&quot;   &quot;x2:x3&quot;   &quot;x2:x4&quot;   &quot;x3:x4&quot;  </span>
<span class="token comment"># attr(,&quot;order&quot;)</span>
<span class="token comment"># [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2</span>
<span class="token comment"># attr(,&quot;intercept&quot;)</span>
<span class="token comment"># [1] 1</span>
<span class="token comment"># attr(,&quot;response&quot;)</span>
<span class="token comment"># [1] 1</span>
<span class="token comment"># attr(,&quot;.Environment&quot;)</span>
<span class="token comment"># &lt;environment: R_GlobalEnv&gt;</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/r/formula.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/r/matrices.html" class="prev">
        Matrices
      </a></span> <span class="next"><a href="/r/reading-and-writing-strings.html">
        Reading and writing strings
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2887.ca046479.js" defer></script>
  </body>
</html>
