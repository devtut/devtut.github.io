<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>R - I/O for foreign tables (Excel, SAS, SPSS, Stata)</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Importing data with rio, Read and write Stata, SPSS and SAS files, Importing Excel files, Import or Export of Feather file">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="R - I/O for foreign tables (Excel, SAS, SPSS, Stata)">
    <meta property="og:description" content="Importing data with rio, Read and write Stata, SPSS and SAS files, Importing Excel files, Import or Export of Feather file">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/r/i-o-for-foreign-tables-excel-sas-spss-stata.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="R - I/O for foreign tables (Excel, SAS, SPSS, Stata)">
    <meta name="twitter:description" content="Importing data with rio, Read and write Stata, SPSS and SAS files, Importing Excel files, Import or Export of Feather file">
    <meta name="twitter:url" content="/r/i-o-for-foreign-tables-excel-sas-spss-stata.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2900.07b618da.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>R</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/r/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/r/getting-started-with-r-language.html" class="sidebar-link">Getting started with R Language</a></li><li><a href="/r/variables.html" class="sidebar-link">Variables</a></li><li><a href="/r/arithmetic-operators.html" class="sidebar-link">Arithmetic Operators</a></li><li><a href="/r/matrices.html" class="sidebar-link">Matrices</a></li><li><a href="/r/formula.html" class="sidebar-link">Formula</a></li><li><a href="/r/reading-and-writing-strings.html" class="sidebar-link">Reading and writing strings</a></li><li><a href="/r/string-manipulation-with-stringi-package.html" class="sidebar-link">String manipulation with stringi package</a></li><li><a href="/r/classes.html" class="sidebar-link">Classes</a></li><li><a href="/r/lists.html" class="sidebar-link">Lists</a></li><li><a href="/r/hashmaps.html" class="sidebar-link">Hashmaps</a></li><li><a href="/r/creating-vectors.html" class="sidebar-link">Creating vectors</a></li><li><a href="/r/date-and-time.html" class="sidebar-link">Date and Time</a></li><li><a href="/r/the-date-class.html" class="sidebar-link">The Date class</a></li><li><a href="/r/date-time-classes-posixct-and-posixlt.html" class="sidebar-link">Date-time classes (POSIXct and POSIXlt)</a></li><li><a href="/r/the-character-class.html" class="sidebar-link">The character class</a></li><li><a href="/r/numeric-classes-and-storage-modes.html" class="sidebar-link">Numeric classes and storage modes</a></li><li><a href="/r/the-logical-class.html" class="sidebar-link">The logical class</a></li><li><a href="/r/data-frames.html" class="sidebar-link">Data frames</a></li><li><a href="/r/split-function.html" class="sidebar-link">Split function</a></li><li><a href="/r/reading-and-writing-tabular-data-in-plain-text-files-csv-tsv-etc.html" class="sidebar-link">Reading and writing tabular data in plain-text files (CSV, TSV, etc.)</a></li><li><a href="/r/pipe-operators-and-others.html" class="sidebar-link">Pipe operators (%&gt;% and others)</a></li><li><a href="/r/linear-models-regression.html" class="sidebar-link">Linear Models (Regression)</a></li><li><a href="/r/data-table.html" class="sidebar-link">data.table</a></li><li><a href="/r/pivot-and-unpivot-with-data-table.html" class="sidebar-link">Pivot and unpivot with data.table</a></li><li><a href="/r/bar-chart.html" class="sidebar-link">Bar Chart</a></li><li><a href="/r/base-plotting.html" class="sidebar-link">Base Plotting</a></li><li><a href="/r/boxplot.html" class="sidebar-link">boxplot</a></li><li><a href="/r/ggplot2.html" class="sidebar-link">ggplot2</a></li><li><a href="/r/factors.html" class="sidebar-link">Factors</a></li><li><a href="/r/pattern-matching-and-replacement.html" class="sidebar-link">Pattern Matching and Replacement</a></li><li><a href="/r/run-length-encoding.html" class="sidebar-link">Run-length encoding</a></li><li><a href="/r/speeding-up-tough-to-vectorize-code.html" class="sidebar-link">Speeding up tough-to-vectorize code</a></li><li><a href="/r/introduction-to-geographical-maps.html" class="sidebar-link">Introduction to Geographical Maps</a></li><li><a href="/r/set-operations.html" class="sidebar-link">Set operations</a></li><li><a href="/r/tidyverse.html" class="sidebar-link">tidyverse</a></li><li><a href="/r/rcpp.html" class="sidebar-link">Rcpp</a></li><li><a href="/r/random-numbers-generator.html" class="sidebar-link">Random Numbers Generator</a></li><li><a href="/r/parallel-processing.html" class="sidebar-link">Parallel processing</a></li><li><a href="/r/subsetting.html" class="sidebar-link">Subsetting</a></li><li><a href="/r/debugging.html" class="sidebar-link">Debugging</a></li><li><a href="/r/installing-packages.html" class="sidebar-link">Installing packages</a></li><li><a href="/r/updating-r-and-the-package-library.html" class="sidebar-link">Updating R and the package library</a></li><li><a href="/r/inspecting-packages.html" class="sidebar-link">Inspecting packages</a></li><li><a href="/r/creating-packages-with-devtools.html" class="sidebar-link">Creating packages with devtools</a></li><li><a href="/r/using-pipe-assignment-in-your-own-package-how-to.html" class="sidebar-link">Using pipe assignment in your own package %%: How to ?</a></li><li><a href="/r/arima-models.html" class="sidebar-link">Arima Models</a></li><li><a href="/r/distribution-functions.html" class="sidebar-link">Distribution Functions</a></li><li><a href="/r/shiny.html" class="sidebar-link">Shiny</a></li><li><a href="/r/spatial-analysis.html" class="sidebar-link">spatial analysis</a></li><li><a href="/r/sqldf.html" class="sidebar-link">sqldf</a></li><li><a href="/r/code-profiling.html" class="sidebar-link">Code profiling</a></li><li><a href="/r/control-flow-structures.html" class="sidebar-link">Control flow structures</a></li><li><a href="/r/column-wise-operation.html" class="sidebar-link">Column wise operation</a></li><li><a href="/r/json.html" class="sidebar-link">JSON</a></li><li><a href="/r/rodbc.html" class="sidebar-link">RODBC</a></li><li><a href="/r/lubridate.html" class="sidebar-link">lubridate</a></li><li><a href="/r/time-series-and-forecasting.html" class="sidebar-link">Time Series and Forecasting</a></li><li><a href="/r/strsplit-function.html" class="sidebar-link">strsplit function</a></li><li><a href="/r/web-scraping-and-parsing.html" class="sidebar-link">Web scraping and parsing</a></li><li><a href="/r/generalized-linear-models.html" class="sidebar-link">Generalized linear models</a></li><li><a href="/r/reshaping-data-between-long-and-wide-forms.html" class="sidebar-link">Reshaping data between long and wide forms</a></li><li><a href="/r/rmarkdown-and-knitr-presentation.html" class="sidebar-link">RMarkdown and knitr presentation</a></li><li><a href="/r/scope-of-variables.html" class="sidebar-link">Scope of variables</a></li><li><a href="/r/performing-a-permutation-test.html" class="sidebar-link">Performing a Permutation Test</a></li><li><a href="/r/xgboost.html" class="sidebar-link">xgboost</a></li><li><a href="/r/r-code-vectorization-best-practices.html" class="sidebar-link">R code vectorization best practices</a></li><li><a href="/r/missing-values.html" class="sidebar-link">Missing values</a></li><li><a href="/r/hierarchical-linear-modeling.html" class="sidebar-link">Hierarchical Linear Modeling</a></li><li><a href="/r/apply-family-of-functions-functionals.html" class="sidebar-link">*apply family of functions (functionals)</a></li><li><a href="/r/text-mining.html" class="sidebar-link">Text mining</a></li><li><a href="/r/anova.html" class="sidebar-link">ANOVA</a></li><li><a href="/r/raster-and-image-analysis.html" class="sidebar-link">Raster and Image Analysis</a></li><li><a href="/r/survival-analysis.html" class="sidebar-link">Survival analysis</a></li><li><a href="/r/fault-tolerant-resilient-code.html" class="sidebar-link">Fault-tolerant/resilient code</a></li><li><a href="/r/reproducible-r.html" class="sidebar-link">Reproducible R</a></li><li><a href="/r/fourier-series-and-transformations.html" class="sidebar-link">Fourier Series and Transformations</a></li><li><a href="/r/rprofile.html" class="sidebar-link">.Rprofile</a></li><li><a href="/r/dplyr.html" class="sidebar-link">dplyr</a></li><li><a href="/r/caret.html" class="sidebar-link">caret</a></li><li><a href="/r/extracting-and-listing-files-in-compressed-archives.html" class="sidebar-link">Extracting and Listing Files in Compressed Archives</a></li><li><a href="/r/probability-distributions-with-r.html" class="sidebar-link">Probability Distributions with R</a></li><li><a href="/r/r-in-latex-with-knitr.html" class="sidebar-link">R in LaTeX with knitr</a></li><li><a href="/r/web-crawling-in-r.html" class="sidebar-link">Web Crawling in R</a></li><li><a href="/r/creating-reports-with-rmarkdown.html" class="sidebar-link">Creating reports with RMarkdown</a></li><li><a href="/r/gpu-accelerated-computing.html" class="sidebar-link">GPU-accelerated computing</a></li><li><a href="/r/heatmap-and-heatmap-2.html" class="sidebar-link">heatmap and heatmap.2</a></li><li><a href="/r/network-analysis-with-the-igraph-package.html" class="sidebar-link">Network analysis with the igraph package</a></li><li><a href="/r/functional-programming.html" class="sidebar-link">Functional programming</a></li><li><a href="/r/get-user-input.html" class="sidebar-link">Get user input</a></li><li><a href="/r/spark-api-sparkr.html" class="sidebar-link">Spark API (SparkR)</a></li><li><a href="/r/meta-documentation-guidelines.html" class="sidebar-link">Meta: Documentation Guidelines</a></li><li><a href="/r/input-and-output.html" class="sidebar-link">Input and output</a></li><li><a href="/r/i-o-for-foreign-tables-excel-sas-spss-stata.html" aria-current="page" class="active sidebar-link">I/O for foreign tables (Excel, SAS, SPSS, Stata)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/r/i-o-for-foreign-tables-excel-sas-spss-stata.html#importing-data-with-rio" class="sidebar-link">Importing data with rio</a></li><li class="sidebar-sub-header"><a href="/r/i-o-for-foreign-tables-excel-sas-spss-stata.html#read-and-write-stata-spss-and-sas-files" class="sidebar-link">Read and write Stata, SPSS and SAS files</a></li><li class="sidebar-sub-header"><a href="/r/i-o-for-foreign-tables-excel-sas-spss-stata.html#importing-excel-files" class="sidebar-link">Importing Excel files</a></li><li class="sidebar-sub-header"><a href="/r/i-o-for-foreign-tables-excel-sas-spss-stata.html#import-or-export-of-feather-file" class="sidebar-link">Import or Export of Feather file</a></li></ul></li><li><a href="/r/i-o-for-database-tables.html" class="sidebar-link">I/O for database tables</a></li><li><a href="/r/i-o-for-geographic-data-shapefiles-etc.html" class="sidebar-link">I/O for geographic data (shapefiles, etc.)</a></li><li><a href="/r/i-o-for-raster-images.html" class="sidebar-link">I/O for raster images</a></li><li><a href="/r/i-o-for-r-s-binary-format.html" class="sidebar-link">I/O for R's binary format</a></li><li><a href="/r/recycling.html" class="sidebar-link">Recycling</a></li><li><a href="/r/expression-parse-eval.html" class="sidebar-link">Expression: parse + eval</a></li><li><a href="/r/regular-expression-syntax-in-r.html" class="sidebar-link">Regular Expression Syntax in R</a></li><li><a href="/r/regular-expressions-regex.html" class="sidebar-link">Regular Expressions (regex)</a></li><li><a href="/r/combinatorics.html" class="sidebar-link">Combinatorics</a></li><li><a href="/r/solving-odes-in-r.html" class="sidebar-link">Solving ODEs in R</a></li><li><a href="/r/feature-selection-in-r-removing-extraneous-features.html" class="sidebar-link">Feature Selection in R -- Removing Extraneous Features</a></li><li><a href="/r/bibliography-in-rmd.html" class="sidebar-link">Bibliography in RMD</a></li><li><a href="/r/writing-functions-in-r.html" class="sidebar-link">Writing functions in R</a></li><li><a href="/r/color-schemes-for-graphics.html" class="sidebar-link">Color schemes for graphics</a></li><li><a href="/r/hierarchical-clustering-with-hclust.html" class="sidebar-link">Hierarchical clustering with hclust</a></li><li><a href="/r/random-forest-algorithm.html" class="sidebar-link">Random Forest Algorithm</a></li><li><a href="/r/restful-r-services.html" class="sidebar-link">RESTful R Services</a></li><li><a href="/r/machine-learning.html" class="sidebar-link">Machine learning</a></li><li><a href="/r/using-texreg-to-export-models-in-a-paper-ready-way.html" class="sidebar-link">Using texreg to export models in a paper-ready way</a></li><li><a href="/r/publishing.html" class="sidebar-link">Publishing</a></li><li><a href="/r/implement-state-machine-pattern-using-s4-class.html" class="sidebar-link">Implement State Machine Pattern using S4 Class</a></li><li><a href="/r/reshape-using-tidyr.html" class="sidebar-link">Reshape using tidyr</a></li><li><a href="/r/modifying-strings-by-substitution.html" class="sidebar-link">Modifying strings by substitution</a></li><li><a href="/r/non-standard-evaluation-and-standard-evaluation.html" class="sidebar-link">Non-standard evaluation and standard evaluation</a></li><li><a href="/r/randomization.html" class="sidebar-link">Randomization</a></li><li><a href="/r/object-oriented-programming-in-r.html" class="sidebar-link">Object-Oriented Programming in R</a></li><li><a href="/r/coercion.html" class="sidebar-link">Coercion</a></li><li><a href="/r/standardize-analyses-by-writing-standalone-r-scripts.html" class="sidebar-link">Standardize analyses by writing standalone R scripts</a></li><li><a href="/r/analyze-tweets-with-r.html" class="sidebar-link">Analyze tweets with R</a></li><li><a href="/r/natural-language-processing.html" class="sidebar-link">Natural language processing</a></li><li><a href="/r/r-markdown-notebooks-from-rstudio.html" class="sidebar-link">R Markdown Notebooks (from RStudio)</a></li><li><a href="/r/aggregating-data-frames.html" class="sidebar-link">Aggregating data frames</a></li><li><a href="/r/data-acquisition.html" class="sidebar-link">Data acquisition</a></li><li><a href="/r/r-memento-by-examples.html" class="sidebar-link">R memento by examples</a></li><li><a href="/r/updating-r-version.html" class="sidebar-link">Updating R version</a></li><li><a href="/r/introspection.html" class="sidebar-link">Introspection</a></li><li><a href="/r/roxygen2.html" class="sidebar-link">roxygen2</a></li><li><a href="/r/cleaning-data.html" class="sidebar-link">Cleaning data</a></li><li><a href="/r/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="i-o-for-foreign-tables-excel-sas-spss-stata"><a href="#i-o-for-foreign-tables-excel-sas-spss-stata" class="header-anchor">#</a> I/O for foreign tables (Excel, SAS, SPSS, Stata)</h1> <h2 id="importing-data-with-rio"><a href="#importing-data-with-rio" class="header-anchor">#</a> Importing data with rio</h2> <p>A very simple way to import data from many common file formats is with <a href="https://cran.r-project.org/web/packages/rio/index.html" target="_blank" rel="noopener noreferrer">rio<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. This package provides a function <code>import()</code> that wraps many commonly used data import functions, thereby providing a standard interface. It works simply by passing a file name or URL to <code>import()</code>:</p> <div class="language-r extra-class"><pre class="language-r"><code>import<span class="token punctuation">(</span><span class="token string">&quot;example.csv&quot;</span><span class="token punctuation">)</span>       <span class="token comment"># comma-separated values</span>
import<span class="token punctuation">(</span><span class="token string">&quot;example.tsv&quot;</span><span class="token punctuation">)</span>       <span class="token comment"># tab-separated values</span>
import<span class="token punctuation">(</span><span class="token string">&quot;example.dta&quot;</span><span class="token punctuation">)</span>       <span class="token comment"># Stata</span>
import<span class="token punctuation">(</span><span class="token string">&quot;example.sav&quot;</span><span class="token punctuation">)</span>       <span class="token comment"># SPSS</span>
import<span class="token punctuation">(</span><span class="token string">&quot;example.sas7bdat&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># SAS</span>
import<span class="token punctuation">(</span><span class="token string">&quot;example.xlsx&quot;</span><span class="token punctuation">)</span>      <span class="token comment"># Excel</span>

</code></pre></div><p><code>import()</code> can also read from compressed directories, URLs (HTTP or HTTPS), and the clipboard.
A comprehensive list of all supported file formats is available on the <a href="https://github.com/leeper/rio" target="_blank" rel="noopener noreferrer">rio package github repository<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>It is even possible to specify some further parameters related to the specific file format you are trying to read, passing them directly within the <code>import()</code> function:</p> <div class="language-r extra-class"><pre class="language-r"><code>import<span class="token punctuation">(</span><span class="token string">&quot;example.csv&quot;</span><span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span> <span class="token comment">#for csv file where comma is used as separator</span>
import<span class="token punctuation">(</span><span class="token string">&quot;example.csv&quot;</span><span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span> <span class="token comment">#for csv file where semicolon is used as separator</span>

</code></pre></div><h2 id="read-and-write-stata-spss-and-sas-files"><a href="#read-and-write-stata-spss-and-sas-files" class="header-anchor">#</a> Read and write Stata, SPSS and SAS files</h2> <p>The packages <code>foreign</code> and <code>haven</code> can be used to import and export files from a variety of other statistical packages like Stata, SPSS and SAS and related software. There is a <code>read</code> function for each of the supported data types to import the files.</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment"># loading the packages</span>
library<span class="token punctuation">(</span>foreign<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>haven<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>readstata13<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>Hmisc<span class="token punctuation">)</span>

</code></pre></div><p>Some examples for the most common data types:</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment"># reading Stata files with `foreign`</span>
read.dta<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># reading Stata files with `haven`</span>
read_dta<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>The <code>foreign</code> package can read in stata (.dta) files for versions of Stata 7-12. According to the development page, the <code>read.dta</code> is more or less frozen and will not be updated for reading in versions 13+. For more recent versions of Stata, you can use either the <code>readstata13</code> package or <code>haven</code>. For <code>readstata13</code>, the files are</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment"># reading recent Stata (13+) files with `readstata13`</span>
read.dta13<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>For reading in SPSS and SAS files</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment"># reading SPSS files with `foreign`</span>
read.spss<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data.sav&quot;</span><span class="token punctuation">,</span> to.data.frame <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>
<span class="token comment"># reading SPSS files with `haven`</span>
read_spss<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data.sav&quot;</span><span class="token punctuation">)</span>
read_sav<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data.sav&quot;</span><span class="token punctuation">)</span>
read_por<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data.por&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># reading SAS files with `foreign`</span>
read.ssd<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># reading SAS files with `haven`</span>
read_sas<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># reading native SAS files with `Hmisc`</span>
sas.get<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data&quot;</span><span class="token punctuation">)</span>   <span class="token comment">#requires access to saslib </span>
<span class="token comment"># Reading SA XPORT format ( *.XPT ) files</span>
sasxport.get<span class="token punctuation">(</span><span class="token string">&quot;path\to\your\data.xpt&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># does not require access to SAS executable</span>

</code></pre></div><p>The <code>SAScii</code> package provides functions that will accept SAS SET import code and construct a text file that can be processed with <code>read.fwf</code>. It has proved very robust for import of large public-released datasets. Support is at <a href="https://github.com/ajdamico/SAScii" target="_blank" rel="noopener noreferrer">https://github.com/ajdamico/SAScii<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>To export data frames to other statistical packages you can use the write functions <code>write.foreign()</code>. This will write 2 files, one containing the data and one containing instructions the other package needs to read the data.</p> <div class="language-r extra-class"><pre class="language-r"><code><span class="token comment"># writing to Stata, SPSS or SAS files with `foreign`</span>
write.foreign<span class="token punctuation">(</span>dataframe<span class="token punctuation">,</span> datafile<span class="token punctuation">,</span> codefile<span class="token punctuation">,</span>
              package <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">&quot;SPSS&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Stata&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;SAS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span>
write.foreign<span class="token punctuation">(</span>dataframe<span class="token punctuation">,</span> <span class="token string">&quot;path\to\data\file&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;path\to\instruction\file&quot;</span><span class="token punctuation">,</span> package <span class="token operator">=</span> <span class="token string">&quot;Stata&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># writing to Stata files with `foreign`</span>
write.dta<span class="token punctuation">(</span>dataframe<span class="token punctuation">,</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token number">7L</span><span class="token punctuation">,</span>
          convert.dates <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> tz <span class="token operator">=</span> <span class="token string">&quot;GMT&quot;</span><span class="token punctuation">,</span>
          convert.factors <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">&quot;labels&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;numeric&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;codes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># writing to Stata files with `haven`</span>
write_dta<span class="token punctuation">(</span>dataframe<span class="token punctuation">,</span> <span class="token string">&quot;path\to\your\data&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># writing to Stata files with `readstata13`</span>
save.dta13<span class="token punctuation">(</span>dataframe<span class="token punctuation">,</span> file<span class="token punctuation">,</span> data.label <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> time.stamp <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
  convert.factors <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> convert.dates <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> tz <span class="token operator">=</span> <span class="token string">&quot;GMT&quot;</span><span class="token punctuation">,</span>
  add.rownames <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> compress <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token number">117</span><span class="token punctuation">,</span>
  convert.underscore <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

<span class="token comment"># writing to SPSS files with `haven`</span>
write_sav<span class="token punctuation">(</span>dataframe<span class="token punctuation">,</span> <span class="token string">&quot;path\to\your\data&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>File stored by the SPSS can also be read with <code>read.spss</code> in this way:</p> <div class="language- extra-class"><pre class="language-text"><code>
foreign::read.spss('data.sav', to.data.frame=TRUE, use.value.labels=FALSE, 
                     use.missings=TRUE, reencode='UTF-8')
# to.data.frame if TRUE: return a data frame
# use.value.labels if TRUE: convert variables with value labels into R factors with those levels
# use.missings if TRUE: information on user-defined missing values will used to set the corresponding values to NA.
# reencode character strings will be re-encoded to the current locale. The default, NA, means to do so in a UTF-8 locale, only.

</code></pre></div><h2 id="importing-excel-files"><a href="#importing-excel-files" class="header-anchor">#</a> Importing Excel files</h2> <p>There are several R packages to read excel files, each of which using different languages or resources, as summarized in the following table:</p> <table><thead><tr><th>R package</th> <th>Uses</th></tr></thead> <tbody><tr><td>xlsx</td> <td>Java</td></tr> <tr><td>XLconnect</td> <td>Java</td></tr> <tr><td>openxlsx</td> <td>C++</td></tr> <tr><td>readxl</td> <td>C++</td></tr> <tr><td>RODBC</td> <td>ODBC</td></tr> <tr><td>gdata</td> <td>Perl</td></tr></tbody></table> <p>For the packages that use Java or ODBC it is important to know details about your system because you may have compatibility issues depending on your R version and OS. For instance, if you are using R 64 bits then you also must have Java 64 bits to use <code>xlsx</code> or <code>XLconnect</code>.</p> <p>Some examples of reading excel files with each package are provided below. Note that many of the packages have the same or very similar function names. Therefore, it is useful to state the package explicitly, like <code>package::function</code>. The package <code>openxlsx</code> requires prior installation of RTools.</p> <h3 id="reading-excel-files-with-the-xlsx-package"><a href="#reading-excel-files-with-the-xlsx-package" class="header-anchor">#</a> Reading excel files with the xlsx package</h3> <div class="language-r extra-class"><pre class="language-r"><code>library<span class="token punctuation">(</span>xlsx<span class="token punctuation">)</span>

</code></pre></div><p>The index or name of the sheet is required to import.</p> <div class="language-r extra-class"><pre class="language-r"><code>xlsx<span class="token operator">::</span>read.xlsx<span class="token punctuation">(</span><span class="token string">&quot;Book1.xlsx&quot;</span><span class="token punctuation">,</span> sheetIndex<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

xlsx<span class="token operator">::</span>read.xlsx<span class="token punctuation">(</span><span class="token string">&quot;Book1.xlsx&quot;</span><span class="token punctuation">,</span> sheetName<span class="token operator">=</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="reading-excel-files-with-the-xlconnect-package"><a href="#reading-excel-files-with-the-xlconnect-package" class="header-anchor">#</a> Reading Excel files with the XLconnect package</h3> <div class="language-r extra-class"><pre class="language-r"><code>library<span class="token punctuation">(</span>XLConnect<span class="token punctuation">)</span>
wb <span class="token operator">&lt;-</span> XLConnect<span class="token operator">::</span>loadWorkbook<span class="token punctuation">(</span><span class="token string">&quot;Book1.xlsx&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># Either, if Book1.xlsx has a sheet called &quot;Sheet1&quot;:</span>
sheet1 <span class="token operator">&lt;-</span> XLConnect<span class="token operator">::</span>readWorksheet<span class="token punctuation">(</span>wb<span class="token punctuation">,</span> <span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># Or, more generally, just get the first sheet in Book1.xlsx:</span>
sheet1 <span class="token operator">&lt;-</span> XLConnect<span class="token operator">::</span>readWorksheet<span class="token punctuation">(</span>wb<span class="token punctuation">,</span> getSheets<span class="token punctuation">(</span>wb<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre></div><p><code>XLConnect</code> automatically imports the pre-defined Excel cell-styles embedded in <code>Book1.xlsx</code>. This is useful when you wish to format your workbook object and export a perfectly formatted Excel document. Firstly, you will need to create the desired cell formats in <code>Book1.xlsx</code> and save them, for example, as <code>myHeader</code>, <code>myBody</code> and <code>myPcts</code>. Then, after loading the workbook in <code>R</code> (see above):</p> <div class="language-r extra-class"><pre class="language-r"><code>Headerstyle <span class="token operator">&lt;-</span> XLConnect<span class="token operator">::</span>getCellStyle<span class="token punctuation">(</span>wb<span class="token punctuation">,</span> <span class="token string">&quot;myHeader&quot;</span><span class="token punctuation">)</span>
Bodystyle <span class="token operator">&lt;-</span> XLConnect<span class="token operator">::</span>getCellStyle<span class="token punctuation">(</span>wb<span class="token punctuation">,</span> <span class="token string">&quot;myBody&quot;</span><span class="token punctuation">)</span>
Pctsstyle <span class="token operator">&lt;-</span> XLConnect<span class="token operator">::</span>getCellStyle<span class="token punctuation">(</span>wb<span class="token punctuation">,</span> <span class="token string">&quot;myPcts&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>The cell styles are now saved in your <code>R</code> environment. In order to assign the cell styles to certain ranges of your data, you need to define the range and then assign the style:</p> <div class="language-r extra-class"><pre class="language-r"><code>Headerrange <span class="token operator">&lt;-</span> expand.grid<span class="token punctuation">(</span>row <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span>
Bodyrange <span class="token operator">&lt;-</span> expand.grid<span class="token punctuation">(</span>row <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
Pctrange <span class="token operator">&lt;-</span> expand.grid<span class="token punctuation">(</span>row <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> col <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

XLConnect<span class="token operator">::</span>setCellStyle<span class="token punctuation">(</span>wb<span class="token punctuation">,</span> sheet <span class="token operator">=</span> <span class="token string">&quot;sheet1&quot;</span><span class="token punctuation">,</span> row <span class="token operator">=</span> Headerrange<span class="token operator">$</span>row<span class="token punctuation">,</span>
             col <span class="token operator">=</span> Headerrange<span class="token operator">$</span>col<span class="token punctuation">,</span> cellstyle <span class="token operator">=</span> Headerstyle<span class="token punctuation">)</span>
XLConnect<span class="token operator">::</span>setCellStyle<span class="token punctuation">(</span>wb<span class="token punctuation">,</span> sheet <span class="token operator">=</span> <span class="token string">&quot;sheet1&quot;</span><span class="token punctuation">,</span> row <span class="token operator">=</span> Bodyrange<span class="token operator">$</span>row<span class="token punctuation">,</span>
             col <span class="token operator">=</span> Bodyrange<span class="token operator">$</span>col<span class="token punctuation">,</span> cellstyle <span class="token operator">=</span> Bodystyle<span class="token punctuation">)</span>
XLConnect<span class="token operator">::</span>setCellStyle<span class="token punctuation">(</span>wb<span class="token punctuation">,</span> sheet <span class="token operator">=</span> <span class="token string">&quot;sheet1&quot;</span><span class="token punctuation">,</span> row <span class="token operator">=</span> Pctrange<span class="token operator">$</span>row<span class="token punctuation">,</span>
             col <span class="token operator">=</span> Pctrange<span class="token operator">$</span>col<span class="token punctuation">,</span> cellstyle <span class="token operator">=</span> Pctsstyle<span class="token punctuation">)</span>

</code></pre></div><p>Note that <code>XLConnect</code> is easy, but can become extremely slow in formatting. A much faster, but more cumbersome formatting option is offered by <code>openxlsx</code>.</p> <h3 id="reading-excel-files-with-the-openxlsx-package"><a href="#reading-excel-files-with-the-openxlsx-package" class="header-anchor">#</a> Reading excel files with the openxlsx package</h3> <p>Excel files can be imported with package <code>openxlsx</code></p> <div class="language-r extra-class"><pre class="language-r"><code>library<span class="token punctuation">(</span>openxlsx<span class="token punctuation">)</span>

openxlsx<span class="token operator">::</span>read.xlsx<span class="token punctuation">(</span><span class="token string">&quot;spreadsheet1.xlsx&quot;</span><span class="token punctuation">,</span> colNames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> rowNames<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>

<span class="token comment">#colNames: If TRUE, the first row of data will be used as column names.</span>
<span class="token comment">#rowNames: If TRUE, first column of data will be used as row names.</span>

</code></pre></div><p>The sheet, which should be read into R can be selected either by providing its position in the <code>sheet</code> argument:</p> <div class="language-r extra-class"><pre class="language-r"><code>openxlsx<span class="token operator">::</span>read.xlsx<span class="token punctuation">(</span><span class="token string">&quot;spreadsheet1.xlsx&quot;</span><span class="token punctuation">,</span> sheet <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>

</code></pre></div><p>or by declaring its name:</p> <div class="language-r extra-class"><pre class="language-r"><code>openxlsx<span class="token operator">::</span>read.xlsx<span class="token punctuation">(</span><span class="token string">&quot;spreadsheet1.xlsx&quot;</span><span class="token punctuation">,</span> sheet <span class="token operator">=</span> <span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Additionally, <code>openxlsx</code> can detect date columns in a read sheet. In order to allow automatic detection of dates, an argument <code>detectDates</code> should be set to <code>TRUE</code>:</p> <div class="language-r extra-class"><pre class="language-r"><code>openxlsx<span class="token operator">::</span>read.xlsx<span class="token punctuation">(</span><span class="token string">&quot;spreadsheet1.xlsx&quot;</span><span class="token punctuation">,</span> sheet <span class="token operator">=</span> <span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">,</span> detectDates<span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="reading-excel-files-with-the-readxl-package"><a href="#reading-excel-files-with-the-readxl-package" class="header-anchor">#</a> Reading excel files with the readxl package</h3> <p>Excel files can be imported as a data frame into <code>R</code> using the <code>readxl</code> package.</p> <div class="language-r extra-class"><pre class="language-r"><code>library<span class="token punctuation">(</span>readxl<span class="token punctuation">)</span>

</code></pre></div><p>It can read both <code>.xls</code> and <code>.xlsx</code> files.</p> <div class="language-r extra-class"><pre class="language-r"><code>readxl<span class="token operator">::</span>read_excel<span class="token punctuation">(</span><span class="token string">&quot;spreadsheet1.xls&quot;</span><span class="token punctuation">)</span>
readxl<span class="token operator">::</span>read_excel<span class="token punctuation">(</span><span class="token string">&quot;spreadsheet2.xlsx&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>The sheet to be imported can be specified by number or name.</p> <div class="language-r extra-class"><pre class="language-r"><code>readxl<span class="token operator">::</span>read_excel<span class="token punctuation">(</span><span class="token string">&quot;spreadsheet.xls&quot;</span><span class="token punctuation">,</span> sheet <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
readxl<span class="token operator">::</span>read_excel<span class="token punctuation">(</span><span class="token string">&quot;spreadsheet.xls&quot;</span><span class="token punctuation">,</span> sheet <span class="token operator">=</span> <span class="token string">&quot;summary&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>The argument <code>col_names = TRUE</code> sets the first row as the column names.</p> <div class="language- extra-class"><pre class="language-text"><code>
readxl::read_excel(&quot;spreadsheet.xls&quot;, sheet = 1, col_names = TRUE)

</code></pre></div><p>The argument <code>col_types</code> can be used to specify the column types in the data as a vector.</p> <div class="language-r extra-class"><pre class="language-r"><code>readxl<span class="token operator">::</span>read_excel<span class="token punctuation">(</span><span class="token string">&quot;spreadsheet.xls&quot;</span><span class="token punctuation">,</span> sheet <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> col_names <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
                   col_types <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;numeric&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;numeric&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="reading-excel-files-with-the-rodbc-package"><a href="#reading-excel-files-with-the-rodbc-package" class="header-anchor">#</a> Reading excel files with the RODBC package</h3> <p>Excel files can be read using the ODBC Excel Driver that interfaces with Windows' Access Database Engine (ACE), formerly JET. With the RODBC package, R can connect to this driver and directly query workbooks. Worksheets are assumed to maintain column headers in first row with data in organized columns of similar types. <strong>NOTE:</strong> This approach is limited to only Windows/PC machines as JET/ACE are installed .dll files and not available on other operating systems.</p> <div class="language-r extra-class"><pre class="language-r"><code>library<span class="token punctuation">(</span>RODBC<span class="token punctuation">)</span>

xlconn <span class="token operator">&lt;-</span> odbcDriverConnect<span class="token punctuation">(</span>'Driver<span class="token operator">=</span><span class="token punctuation">{</span>Microsoft Excel Driver <span class="token punctuation">(</span><span class="token operator">*</span>.xls<span class="token punctuation">,</span> <span class="token operator">*</span>.xlsx<span class="token punctuation">,</span> <span class="token operator">*</span>.xlsm<span class="token punctuation">,</span> <span class="token operator">*</span>.xlsb<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
                             DBQ<span class="token operator">=</span>C<span class="token operator">:</span>\\Path\\To\\Workbook.xlsx'<span class="token punctuation">)</span>

df <span class="token operator">&lt;-</span> sqlQuery<span class="token punctuation">(</span>xlconn<span class="token punctuation">,</span> <span class="token string">&quot;SELECT * FROM [SheetName$]&quot;</span><span class="token punctuation">)</span>
close<span class="token punctuation">(</span>xlconn<span class="token punctuation">)</span>

</code></pre></div><p>Connecting with an SQL engine in this approach, Excel worksheets can be queried similar to database tables including <code>JOIN</code> and <code>UNION</code> operations. Syntax follows the JET/ACE SQL dialect. <strong>NOTE:</strong> Only data access DML statements, specifically <code>SELECT</code> can be run on workbooks, considered not updateable queries.</p> <div class="language-r extra-class"><pre class="language-r"><code>joindf <span class="token operator">&lt;-</span>  sqlQuery<span class="token punctuation">(</span>xlconn<span class="token punctuation">,</span> &quot;SELECT t1.<span class="token operator">*</span><span class="token punctuation">,</span> t2.<span class="token operator">*</span> FROM <span class="token punctuation">[</span>Sheet1<span class="token operator">$</span><span class="token punctuation">]</span> t1
                             INNER JOIN <span class="token punctuation">[</span>Sheet2<span class="token operator">$</span><span class="token punctuation">]</span> t2
                             ON t1.<span class="token punctuation">[</span>ID<span class="token punctuation">]</span> <span class="token operator">=</span> t2.<span class="token punctuation">[</span>ID<span class="token punctuation">]</span>&quot;<span class="token punctuation">)</span>

uniondf <span class="token operator">&lt;-</span>  sqlQuery<span class="token punctuation">(</span>xlconn<span class="token punctuation">,</span> &quot;SELECT <span class="token operator">*</span> FROM <span class="token punctuation">[</span>Sheet1<span class="token operator">$</span><span class="token punctuation">]</span>
                              UNION  
                              SELECT <span class="token operator">*</span> FROM <span class="token punctuation">[</span>Sheet2<span class="token operator">$</span><span class="token punctuation">]</span>&quot;<span class="token punctuation">)</span>

</code></pre></div><p>Even other workbooks can be queried from the same ODBC channel pointing to a current workbook:</p> <div class="language-r extra-class"><pre class="language-r"><code>otherwkbkdf <span class="token operator">&lt;-</span> sqlQuery<span class="token punctuation">(</span>xlconn<span class="token punctuation">,</span> &quot;SELECT <span class="token operator">*</span> FROM 
                                 <span class="token punctuation">[</span>Excel <span class="token number">12.0</span> Xml<span class="token punctuation">;</span>HDR<span class="token operator">=</span>Yes<span class="token punctuation">;</span>
                                 Database<span class="token operator">=</span>C<span class="token operator">:</span>\\Path\\To\\Other\\Workbook.xlsx<span class="token punctuation">]</span>.<span class="token punctuation">[</span>Sheet1<span class="token operator">$</span><span class="token punctuation">]</span><span class="token punctuation">;</span>&quot;<span class="token punctuation">)</span>

</code></pre></div><h3 id="reading-excel-files-with-the-gdata-package"><a href="#reading-excel-files-with-the-gdata-package" class="header-anchor">#</a> Reading excel files with the gdata package</h3> <p><strong>example here</strong></p> <h2 id="import-or-export-of-feather-file"><a href="#import-or-export-of-feather-file" class="header-anchor">#</a> Import or Export of Feather file</h2> <p><a href="https://github.com/wesm/feather" target="_blank" rel="noopener noreferrer">Feather<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is an implementation of <a href="https://arrow.apache.org/" target="_blank" rel="noopener noreferrer">Apache Arrow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> designed to store data frames in a language agnostic manner while maintaining metadata (e.g. date classes), increasing interoperability between Python and R. Reading a feather file will produce a tibble, not a standard data.frame.</p> <div class="language-r extra-class"><pre class="language-r"><code>library<span class="token punctuation">(</span>feather<span class="token punctuation">)</span>

path <span class="token operator">&lt;-</span> <span class="token string">&quot;filename.feather&quot;</span>
df <span class="token operator">&lt;-</span> mtcars

write_feather<span class="token punctuation">(</span>df<span class="token punctuation">,</span> path<span class="token punctuation">)</span>

df2 <span class="token operator">&lt;-</span> read_feather<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

head<span class="token punctuation">(</span>df2<span class="token punctuation">)</span>
<span class="token comment">##  A tibble: 6 x 11</span>
<span class="token comment">##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span>
<span class="token comment">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="token comment">## 1  21.0     6   160   110  3.90 2.620 16.46     0     1     4     4</span>
<span class="token comment">## 2  21.0     6   160   110  3.90 2.875 17.02     0     1     4     4</span>
<span class="token comment">## 3  22.8     4   108    93  3.85 2.320 18.61     1     1     4     1</span>
<span class="token comment">## 4  21.4     6   258   110  3.08 3.215 19.44     1     0     3     1</span>
<span class="token comment">## 5  18.7     8   360   175  3.15 3.440 17.02     0     0     3     2</span>
<span class="token comment">## 6  18.1     6   225   105  2.76 3.460 20.22     1     0     3     1</span>

head<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token comment">##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb</span>
<span class="token comment">## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4</span>
<span class="token comment">## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4</span>
<span class="token comment">## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1</span>
<span class="token comment">## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</span>
<span class="token comment">## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</span>
<span class="token comment">## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</span>

</code></pre></div><p>The current documentation contains this warning:</p> <blockquote></blockquote> <p>Note to users: Feather should be treated as alpha software. In particular, the file format is likely to evolve over the coming year. Do not use Feather for long-term data storage.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/r/i-o-for-foreign-tables-excel-sas-spss-stata.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/r/input-and-output.html" class="prev">
        Input and output
      </a></span> <span class="next"><a href="/r/i-o-for-database-tables.html">
        I/O for database tables
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2900.07b618da.js" defer></script>
  </body>
</html>
