<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Swift - Getting Started with Protocol Oriented Programming</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Leveraging Protocol Oriented Programming for Unit Testing, Using protocols as first class types">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Swift - Getting Started with Protocol Oriented Programming">
    <meta property="og:description" content="Leveraging Protocol Oriented Programming for Unit Testing, Using protocols as first class types">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/swift/getting-started-with-protocol-oriented-programming.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Swift - Getting Started with Protocol Oriented Programming">
    <meta name="twitter:description" content="Leveraging Protocol Oriented Programming for Unit Testing, Using protocols as first class types">
    <meta name="twitter:url" content="/swift/getting-started-with-protocol-oriented-programming.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/3335.22499aaa.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Swift</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/swift/" class="sidebar-link">Disclaimer</a></li><li><a href="/swift/getting-started-with-swift-language.html" class="sidebar-link">Getting started with Swift Language</a></li><li><a href="/swift/variables-properties.html" class="sidebar-link">Variables &amp; Properties</a></li><li><a href="/swift/numbers.html" class="sidebar-link">Numbers</a></li><li><a href="/swift/strings-and-characters.html" class="sidebar-link">Strings and Characters</a></li><li><a href="/swift/booleans.html" class="sidebar-link">Booleans</a></li><li><a href="/swift/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/swift/tuples.html" class="sidebar-link">Tuples</a></li><li><a href="/swift/enums.html" class="sidebar-link">Enums</a></li><li><a href="/swift/structs.html" class="sidebar-link">Structs</a></li><li><a href="/swift/sets.html" class="sidebar-link">Sets</a></li><li><a href="/swift/dictionaries.html" class="sidebar-link">Dictionaries</a></li><li><a href="/swift/switch.html" class="sidebar-link">Switch</a></li><li><a href="/swift/optionals.html" class="sidebar-link">Optionals</a></li><li><a href="/swift/conditionals.html" class="sidebar-link">Conditionals</a></li><li><a href="/swift/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/swift/loops.html" class="sidebar-link">Loops</a></li><li><a href="/swift/protocols.html" class="sidebar-link">Protocols</a></li><li><a href="/swift/functions.html" class="sidebar-link">Functions</a></li><li><a href="/swift/extensions.html" class="sidebar-link">Extensions</a></li><li><a href="/swift/classes.html" class="sidebar-link">Classes</a></li><li><a href="/swift/type-casting.html" class="sidebar-link">Type Casting</a></li><li><a href="/swift/generics.html" class="sidebar-link">Generics</a></li><li><a href="/swift/optionset.html" class="sidebar-link">OptionSet</a></li><li><a href="/swift/reading-writing-json.html" class="sidebar-link">Reading &amp; Writing JSON</a></li><li><a href="/swift/advanced-operators.html" class="sidebar-link">Advanced Operators</a></li><li><a href="/swift/method-swizzling.html" class="sidebar-link">Method Swizzling</a></li><li><a href="/swift/reflection.html" class="sidebar-link">Reflection</a></li><li><a href="/swift/access-control.html" class="sidebar-link">Access Control</a></li><li><a href="/swift/closures.html" class="sidebar-link">Closures</a></li><li><a href="/swift/initializers.html" class="sidebar-link">Initializers</a></li><li><a href="/swift/associated-objects.html" class="sidebar-link">Associated Objects</a></li><li><a href="/swift/concurrency.html" class="sidebar-link">Concurrency</a></li><li><a href="/swift/getting-started-with-protocol-oriented-programming.html" class="active sidebar-link">Getting Started with Protocol Oriented Programming</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/swift/getting-started-with-protocol-oriented-programming.html#leveraging-protocol-oriented-programming-for-unit-testing" class="sidebar-link">Leveraging Protocol Oriented Programming for Unit Testing</a></li><li class="sidebar-sub-header"><a href="/swift/getting-started-with-protocol-oriented-programming.html#using-protocols-as-first-class-types" class="sidebar-link">Using protocols as first class types</a></li></ul></li><li><a href="/swift/functional-programming-in-swift.html" class="sidebar-link">Functional Programming in Swift</a></li><li><a href="/swift/function-as-first-class-citizens-in-swift.html" class="sidebar-link">Function as first class citizens in Swift</a></li><li><a href="/swift/blocks.html" class="sidebar-link">Blocks</a></li><li><a href="/swift/the-defer-statement.html" class="sidebar-link">The Defer Statement</a></li><li><a href="/swift/style-conventions.html" class="sidebar-link">Style Conventions</a></li><li><a href="/swift/nsregularexpression-in-swift.html" class="sidebar-link">NSRegularExpression in Swift</a></li><li><a href="/swift/rxswift.html" class="sidebar-link">RxSwift</a></li><li><a href="/swift/swift-package-manager.html" class="sidebar-link">Swift Package Manager</a></li><li><a href="/swift/working-with-c-and-objective-c.html" class="sidebar-link">Working with C and Objective-C</a></li><li><a href="/swift/documentation-markup.html" class="sidebar-link">Documentation markup</a></li><li><a href="/swift/typealias.html" class="sidebar-link">Typealias</a></li><li><a href="/swift/dependency-injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/swift/caching-on-disk-space.html" class="sidebar-link">Caching on disk space</a></li><li><a href="/swift/algorithms-with-swift.html" class="sidebar-link">Algorithms with Swift</a></li><li><a href="/swift/swift-advance-functions.html" class="sidebar-link">Swift Advance functions</a></li><li><a href="/swift/completion-handler.html" class="sidebar-link">Completion Handler</a></li><li><a href="/swift/swift-http-server-by-kitura.html" class="sidebar-link">Swift HTTP server by Kitura</a></li><li><a href="/swift/generate-uiimage-of-initials-from-string.html" class="sidebar-link">Generate UIImage of Initials from String</a></li><li><a href="/swift/design-patterns-creational.html" class="sidebar-link">Design Patterns - Creational</a></li><li><a href="/swift/design-patterns-structural.html" class="sidebar-link">Design Patterns - Structural</a></li><li><a href="/swift/unsafe-buffer-pointers.html" class="sidebar-link">(Unsafe) Buffer Pointers</a></li><li><a href="/swift/cryptographic-hashing.html" class="sidebar-link">Cryptographic Hashing</a></li><li><a href="/swift/aes-encryption.html" class="sidebar-link">AES encryption</a></li><li><a href="/swift/pbkdf2-key-derivation.html" class="sidebar-link">PBKDF2 Key Derivation</a></li><li><a href="/swift/logging-in-swift.html" class="sidebar-link">Logging in Swift</a></li><li><a href="/swift/memory-management.html" class="sidebar-link">Memory Management</a></li><li><a href="/swift/performance.html" class="sidebar-link">Performance</a></li><li><a href="/swift/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="getting-started-with-protocol-oriented-programming"><a href="#getting-started-with-protocol-oriented-programming" class="header-anchor">#</a> Getting Started with Protocol Oriented Programming</h1> <h2 id="leveraging-protocol-oriented-programming-for-unit-testing"><a href="#leveraging-protocol-oriented-programming-for-unit-testing" class="header-anchor">#</a> Leveraging Protocol Oriented Programming for Unit Testing</h2> <p>Protocol Oriented Programming is a useful tool in order to easily write better unit tests for our code.</p> <p>Let's say we want to test a UIViewController that relies on a ViewModel class.</p> <p>The needed steps on the production code are:</p> <ol><li>Define a protocol that exposes the public interface of the class ViewModel, with all the properties and methods needed by the UIViewController.</li> <li>Implement the real ViewModel class, conforming to that protocol.</li> <li>Use a dependency injection technique to let the view controller use the implementation we want, passing it as the protocol and not the concrete instance.</li></ol> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">protocol</span> <span class="token builtin">ViewModelType</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> title <span class="token punctuation">:</span> <span class="token builtin">String</span> <span class="token punctuation">{</span><span class="token keyword">get</span><span class="token punctuation">}</span>
   <span class="token keyword">func</span> <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ViewModel</span> <span class="token punctuation">:</span> <span class="token builtin">ViewModelType</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> title <span class="token punctuation">:</span> <span class="token builtin">String</span>

   <span class="token keyword">init</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">self</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title
   <span class="token punctuation">}</span>
   <span class="token keyword">func</span> <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ViewController</span> <span class="token punctuation">:</span> <span class="token builtin">UIViewController</span> <span class="token punctuation">{</span>
   <span class="token comment">// We declare the viewModel property as an object conforming to the protocol</span>
   <span class="token comment">// so we can swap the implementations without any friction.</span>
   <span class="token keyword">var</span> viewModel <span class="token punctuation">:</span> <span class="token builtin">ViewModelType</span><span class="token operator">!</span> 
   <span class="token atrule">@IBOutlet</span> <span class="token keyword">var</span> titleLabel <span class="token punctuation">:</span> <span class="token builtin">UILabel</span><span class="token operator">!</span>

   <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
       titleLabel<span class="token punctuation">.</span>text <span class="token operator">=</span> viewModel<span class="token punctuation">.</span>title
   <span class="token punctuation">}</span>

   <span class="token atrule">@IBAction</span> <span class="token keyword">func</span> <span class="token function">didTapOnButton</span><span class="token punctuation">(</span>sender<span class="token punctuation">:</span> <span class="token builtin">UIButton</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       viewModel<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// With DI we setup the view controller and assign the view model.</span>
<span class="token comment">// The view controller doesn't know the concrete class of the view model, </span>
<span class="token comment">// but just relies on the declared interface on the protocol.</span>
<span class="token keyword">let</span> viewController <span class="token operator">=</span> <span class="token comment">//... Instantiate view controller</span>
viewController<span class="token punctuation">.</span>viewModel <span class="token operator">=</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string">&quot;MyTitle&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p>Then, on unit test:</p> <ol><li>Implement a mock ViewModel that conforms to the same protocol</li> <li>Pass it to the UIViewController under test using dependency injection, instead of the real instance.</li> <li>Test!</li></ol> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">FakeViewModel</span> <span class="token punctuation">:</span> <span class="token builtin">ViewModelType</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> title <span class="token punctuation">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> <span class="token string">&quot;FakeTitle&quot;</span>

   <span class="token keyword">var</span> didConfirm <span class="token operator">=</span> <span class="token boolean">false</span>
   <span class="token keyword">func</span> <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       didConfirm <span class="token operator">=</span> <span class="token boolean">true</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ViewControllerTest</span> <span class="token punctuation">:</span> <span class="token builtin">XCTestCase</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> sut <span class="token punctuation">:</span> <span class="token builtin">ViewController</span><span class="token operator">!</span>
    <span class="token keyword">var</span> viewModel <span class="token punctuation">:</span> <span class="token builtin">FakeViewModel</span><span class="token operator">!</span>

    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">setUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        viewModel <span class="token operator">=</span> <span class="token function">FakeViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        sut <span class="token operator">=</span> <span class="token comment">// ... initialization for view controller</span>
        sut<span class="token punctuation">.</span>viewModel <span class="token operator">=</span> viewModel

        <span class="token function">XCTAssertNotNil</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>sut<span class="token punctuation">.</span>view<span class="token punctuation">)</span> <span class="token comment">// Needed to trigger view loading</span>
    <span class="token punctuation">}</span> 

    <span class="token keyword">func</span> <span class="token function">testTitleLabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">XCTAssertEqual</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>sut<span class="token punctuation">.</span>titleLabel<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">&quot;FakeTitle&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">func</span> <span class="token function">testTapOnButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sut<span class="token punctuation">.</span><span class="token function">didTapOnButton</span><span class="token punctuation">(</span><span class="token function">UIButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">XCTAssertTrue</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>viewModel<span class="token punctuation">.</span>didConfirm<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="using-protocols-as-first-class-types"><a href="#using-protocols-as-first-class-types" class="header-anchor">#</a> Using protocols as first class types</h2> <p>Protocol oriented programing can be used as a core Swift design pattern.</p> <p>Different types are able to conform to the same protocol, value types can even conform to multiple protocols and even provide default method implementation.</p> <p>Initially protocols are defined that can represent commonly used properties and/or methods with either specific or generic types.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">protocol</span> <span class="token builtin">ItemData</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">var</span> title<span class="token punctuation">:</span> <span class="token builtin">String</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
    <span class="token keyword">var</span> description<span class="token punctuation">:</span> <span class="token builtin">String</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
    <span class="token keyword">var</span> thumbnailURL<span class="token punctuation">:</span> <span class="token constant">NSURL</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
    <span class="token keyword">var</span> created<span class="token punctuation">:</span> <span class="token builtin">NSDate</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
    <span class="token keyword">var</span> updated<span class="token punctuation">:</span> <span class="token builtin">NSDate</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>

<span class="token keyword">protocol</span> <span class="token builtin">DisplayItem</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">func</span> <span class="token function">hasBeenUpdated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span>
    <span class="token keyword">func</span> <span class="token function">getFormattedTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">String</span>
    <span class="token keyword">func</span> <span class="token function">getFormattedDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">String</span>

<span class="token punctuation">}</span>

<span class="token keyword">protocol</span> <span class="token builtin">GetAPIItemDataOperation</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token constant">NSURL</span><span class="token punctuation">,</span> completed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ItemData</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Void</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>A default implementation for the get method can be created, though if desired conforming types may override the implementation.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">extension</span> <span class="token builtin">GetAPIItemDataOperation</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token constant">NSURL</span><span class="token punctuation">,</span> completed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ItemData</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token function">NSDate</span><span class="token punctuation">(</span>
        timeIntervalSinceNow<span class="token punctuation">:</span> <span class="token function">NSDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>timeIntervalSince1970
            <span class="token operator">+</span> <span class="token number">5000</span><span class="token punctuation">)</span>
        
        <span class="token comment">// get data from url</span>
        <span class="token keyword">let</span> urlData<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">:</span> <span class="token builtin">AnyObject</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Red Camaro&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;desc&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;A fast red car.&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;thumb&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;http://cars.images.com/red-camaro.png&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;created&quot;</span><span class="token punctuation">:</span> <span class="token function">NSDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;updated&quot;</span><span class="token punctuation">:</span> date<span class="token punctuation">]</span>
        
        <span class="token comment">// in this example forced unwrapping is used</span>
        <span class="token comment">// forced unwrapping should never be used in practice</span>
        <span class="token comment">// instead conditional unwrapping should be used (guard or if/let)</span>
        <span class="token keyword">let</span> item <span class="token operator">=</span> <span class="token function">Item</span><span class="token punctuation">(</span>
            title<span class="token punctuation">:</span> urlData<span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token builtin">String</span><span class="token punctuation">,</span>
            description<span class="token punctuation">:</span> urlData<span class="token punctuation">[</span><span class="token string">&quot;desc&quot;</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token builtin">String</span><span class="token punctuation">,</span>
            thumbnailURL<span class="token punctuation">:</span> <span class="token function">NSURL</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> urlData<span class="token punctuation">[</span><span class="token string">&quot;thumb&quot;</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">,</span>
            created<span class="token punctuation">:</span> urlData<span class="token punctuation">[</span><span class="token string">&quot;created&quot;</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token builtin">NSDate</span><span class="token punctuation">,</span>
            updated<span class="token punctuation">:</span> urlData<span class="token punctuation">[</span><span class="token string">&quot;updated&quot;</span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token builtin">NSDate</span><span class="token punctuation">)</span>
        
        <span class="token function">completed</span><span class="token punctuation">(</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token builtin">ItemOperation</span><span class="token punctuation">:</span> <span class="token builtin">GetAPIItemDataOperation</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

</code></pre></div><p>A value type that conforms to the ItemData protocol, this value type is also able to conform to other protocols.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">struct</span> <span class="token builtin">Item</span><span class="token punctuation">:</span> <span class="token builtin">ItemData</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">let</span> title<span class="token punctuation">:</span> <span class="token builtin">String</span>
    <span class="token keyword">let</span> description<span class="token punctuation">:</span> <span class="token builtin">String</span>
    <span class="token keyword">let</span> thumbnailURL<span class="token punctuation">:</span> <span class="token constant">NSURL</span>
    <span class="token keyword">let</span> created<span class="token punctuation">:</span> <span class="token builtin">NSDate</span>
    <span class="token keyword">let</span> updated<span class="token punctuation">:</span> <span class="token builtin">NSDate</span>
    
<span class="token punctuation">}</span>

</code></pre></div><p>Here the item struct is extended to conform to a display item.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">extension</span> <span class="token builtin">Item</span><span class="token punctuation">:</span> <span class="token builtin">DisplayItem</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">func</span> <span class="token function">hasBeenUpdated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> updated<span class="token punctuation">.</span>timeIntervalSince1970 <span class="token operator">&gt;</span>
            created<span class="token punctuation">.</span>timeIntervalSince1970
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function">getFormattedTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">String</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> title<span class="token punctuation">.</span><span class="token function">stringByTrimmingCharactersInSet</span><span class="token punctuation">(</span>
            <span class="token punctuation">.</span><span class="token function">whitespaceAndNewlineCharacterSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function">getFormattedDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">String</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> description<span class="token punctuation">.</span><span class="token function">stringByTrimmingCharactersInSet</span><span class="token punctuation">(</span>
            <span class="token punctuation">.</span><span class="token function">whitespaceAndNewlineCharacterSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>An example call site for using the static get method.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token builtin">ItemOperation</span><span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token function">NSURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>itemData<span class="token punctuation">)</span> <span class="token keyword">in</span>
    
    <span class="token comment">// perhaps inform a view of new data</span>
    <span class="token comment">// or parse the data for user requested info, etc.</span>
    <span class="token function">dispatch_async</span><span class="token punctuation">(</span><span class="token function">dispatch_get_main_queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> 
        
        <span class="token comment">// self.items = itemData</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
<span class="token punctuation">}</span>

</code></pre></div><p>Different use cases will require different implementations. The main idea here is to show conformance from varying types where the protocol is the main point of the focus in the design. In this example perhaps the API data is conditionally saved to a Core Data entity.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token comment">// the default core data created classes + extension</span>
<span class="token keyword">class</span> <span class="token class-name">LocalItem</span><span class="token punctuation">:</span> <span class="token builtin">NSManagedObject</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

<span class="token keyword">extension</span> <span class="token builtin">LocalItem</span> <span class="token punctuation">{</span>
    
    <span class="token atrule">@NSManaged</span> <span class="token keyword">var</span> title<span class="token punctuation">:</span> <span class="token builtin">String</span>
    <span class="token atrule">@NSManaged</span> <span class="token keyword">var</span> itemDescription<span class="token punctuation">:</span> <span class="token builtin">String</span>
    <span class="token atrule">@NSManaged</span> <span class="token keyword">var</span> thumbnailURLStr<span class="token punctuation">:</span> <span class="token builtin">String</span>
    <span class="token atrule">@NSManaged</span> <span class="token keyword">var</span> createdAt<span class="token punctuation">:</span> <span class="token builtin">NSDate</span>
    <span class="token atrule">@NSManaged</span> <span class="token keyword">var</span> updatedAt<span class="token punctuation">:</span> <span class="token builtin">NSDate</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Here the Core Data backed class can also conform to the DisplayItem protocol.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">extension</span> <span class="token builtin">LocalItem</span><span class="token punctuation">:</span> <span class="token builtin">DisplayItem</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">func</span> <span class="token function">hasBeenUpdated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> updatedAt<span class="token punctuation">.</span>timeIntervalSince1970 <span class="token operator">&gt;</span>
            createdAt<span class="token punctuation">.</span>timeIntervalSince1970
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function">getFormattedTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">String</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> title<span class="token punctuation">.</span><span class="token function">stringByTrimmingCharactersInSet</span><span class="token punctuation">(</span>
            <span class="token punctuation">.</span><span class="token function">whitespaceAndNewlineCharacterSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function">getFormattedDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">String</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> itemDescription<span class="token punctuation">.</span><span class="token function">stringByTrimmingCharactersInSet</span><span class="token punctuation">(</span>
            <span class="token punctuation">.</span><span class="token function">whitespaceAndNewlineCharacterSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// In use, the core data results can be</span>
<span class="token comment">// conditionally casts as a protocol</span>
<span class="token keyword">class</span> <span class="token class-name">MyController</span><span class="token punctuation">:</span> <span class="token builtin">UIViewController</span> <span class="token punctuation">{</span>

    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token keyword">let</span> fr<span class="token punctuation">:</span> <span class="token builtin">NSFetchRequest</span> <span class="token operator">=</span> <span class="token function">NSFetchRequest</span><span class="token punctuation">(</span>
        entityName<span class="token punctuation">:</span> <span class="token string">&quot;Items&quot;</span><span class="token punctuation">)</span>
    
        <span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token function">NSManagedObjectContext</span><span class="token punctuation">(</span>
        concurrencyType<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token builtin">MainQueueConcurrencyType</span><span class="token punctuation">)</span>
        
        <span class="token keyword">do</span> <span class="token punctuation">{</span>
            
            <span class="token keyword">let</span> items<span class="token punctuation">:</span> <span class="token builtin">AnyObject</span> <span class="token operator">=</span> <span class="token keyword">try</span> context<span class="token punctuation">.</span><span class="token function">executeFetchRequest</span><span class="token punctuation">(</span>fr<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token keyword">let</span> displayItems <span class="token operator">=</span> items <span class="token keyword">as</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token builtin">DisplayItem</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
                
                <span class="token function">print</span><span class="token punctuation">(</span>displayItems<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token keyword">let</span> error <span class="token keyword">as</span> <span class="token builtin">NSError</span> <span class="token punctuation">{</span>
            <span class="token function">print</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>localizedDescription<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>For more information on this topic, see the WWDC 2015 talk <a href="https://developer.apple.com/videos/play/wwdc2015/408/" target="_blank" rel="noopener noreferrer">Protocol-Oriented Programming in Swift<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>There is also a great written guide on the same: <a href="https://www.raywenderlich.com/109156/introducing-protocol-oriented-programming-in-swift-2" target="_blank" rel="noopener noreferrer">Introducing Protocol-Oriented Programming in Swift 2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/swift/getting-started-with-protocol-oriented-programming.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/swift/concurrency.html" class="prev">
        Concurrency
      </a></span> <span class="next"><a href="/swift/functional-programming-in-swift.html">
        Functional Programming in Swift
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/3335.22499aaa.js" defer></script>
  </body>
</html>
