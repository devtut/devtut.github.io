<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Swift - Dependency Injection</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Dependency Injection with View Controllers, Dependency Injection Types">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Swift - Dependency Injection">
    <meta property="og:description" content="Dependency Injection with View Controllers, Dependency Injection Types">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/swift/dependency-injection.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Swift - Dependency Injection">
    <meta name="twitter:description" content="Dependency Injection with View Controllers, Dependency Injection Types">
    <meta name="twitter:url" content="/swift/dependency-injection.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3324.8a320599.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Swift</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/swift/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/swift/getting-started-with-swift-language.html" class="sidebar-link">Getting started with Swift Language</a></li><li><a href="/swift/variables-properties.html" class="sidebar-link">Variables &amp; Properties</a></li><li><a href="/swift/numbers.html" class="sidebar-link">Numbers</a></li><li><a href="/swift/strings-and-characters.html" class="sidebar-link">Strings and Characters</a></li><li><a href="/swift/booleans.html" class="sidebar-link">Booleans</a></li><li><a href="/swift/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/swift/tuples.html" class="sidebar-link">Tuples</a></li><li><a href="/swift/enums.html" class="sidebar-link">Enums</a></li><li><a href="/swift/structs.html" class="sidebar-link">Structs</a></li><li><a href="/swift/sets.html" class="sidebar-link">Sets</a></li><li><a href="/swift/dictionaries.html" class="sidebar-link">Dictionaries</a></li><li><a href="/swift/switch.html" class="sidebar-link">Switch</a></li><li><a href="/swift/optionals.html" class="sidebar-link">Optionals</a></li><li><a href="/swift/conditionals.html" class="sidebar-link">Conditionals</a></li><li><a href="/swift/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/swift/loops.html" class="sidebar-link">Loops</a></li><li><a href="/swift/protocols.html" class="sidebar-link">Protocols</a></li><li><a href="/swift/functions.html" class="sidebar-link">Functions</a></li><li><a href="/swift/extensions.html" class="sidebar-link">Extensions</a></li><li><a href="/swift/classes.html" class="sidebar-link">Classes</a></li><li><a href="/swift/type-casting.html" class="sidebar-link">Type Casting</a></li><li><a href="/swift/generics.html" class="sidebar-link">Generics</a></li><li><a href="/swift/optionset.html" class="sidebar-link">OptionSet</a></li><li><a href="/swift/reading-writing-json.html" class="sidebar-link">Reading &amp; Writing JSON</a></li><li><a href="/swift/advanced-operators.html" class="sidebar-link">Advanced Operators</a></li><li><a href="/swift/method-swizzling.html" class="sidebar-link">Method Swizzling</a></li><li><a href="/swift/reflection.html" class="sidebar-link">Reflection</a></li><li><a href="/swift/access-control.html" class="sidebar-link">Access Control</a></li><li><a href="/swift/closures.html" class="sidebar-link">Closures</a></li><li><a href="/swift/initializers.html" class="sidebar-link">Initializers</a></li><li><a href="/swift/associated-objects.html" class="sidebar-link">Associated Objects</a></li><li><a href="/swift/concurrency.html" class="sidebar-link">Concurrency</a></li><li><a href="/swift/getting-started-with-protocol-oriented-programming.html" class="sidebar-link">Getting Started with Protocol Oriented Programming</a></li><li><a href="/swift/functional-programming-in-swift.html" class="sidebar-link">Functional Programming in Swift</a></li><li><a href="/swift/function-as-first-class-citizens-in-swift.html" class="sidebar-link">Function as first class citizens in Swift</a></li><li><a href="/swift/blocks.html" class="sidebar-link">Blocks</a></li><li><a href="/swift/the-defer-statement.html" class="sidebar-link">The Defer Statement</a></li><li><a href="/swift/style-conventions.html" class="sidebar-link">Style Conventions</a></li><li><a href="/swift/nsregularexpression-in-swift.html" class="sidebar-link">NSRegularExpression in Swift</a></li><li><a href="/swift/rxswift.html" class="sidebar-link">RxSwift</a></li><li><a href="/swift/swift-package-manager.html" class="sidebar-link">Swift Package Manager</a></li><li><a href="/swift/working-with-c-and-objective-c.html" class="sidebar-link">Working with C and Objective-C</a></li><li><a href="/swift/documentation-markup.html" class="sidebar-link">Documentation markup</a></li><li><a href="/swift/typealias.html" class="sidebar-link">Typealias</a></li><li><a href="/swift/dependency-injection.html" aria-current="page" class="active sidebar-link">Dependency Injection</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/swift/dependency-injection.html#dependency-injection-with-view-controllers" class="sidebar-link">Dependency Injection with View Controllers</a></li><li class="sidebar-sub-header"><a href="/swift/dependency-injection.html#dependency-injection-types" class="sidebar-link">Dependency Injection Types</a></li></ul></li><li><a href="/swift/caching-on-disk-space.html" class="sidebar-link">Caching on disk space</a></li><li><a href="/swift/algorithms-with-swift.html" class="sidebar-link">Algorithms with Swift</a></li><li><a href="/swift/swift-advance-functions.html" class="sidebar-link">Swift Advance functions</a></li><li><a href="/swift/completion-handler.html" class="sidebar-link">Completion Handler</a></li><li><a href="/swift/swift-http-server-by-kitura.html" class="sidebar-link">Swift HTTP server by Kitura</a></li><li><a href="/swift/generate-uiimage-of-initials-from-string.html" class="sidebar-link">Generate UIImage of Initials from String</a></li><li><a href="/swift/design-patterns-creational.html" class="sidebar-link">Design Patterns - Creational</a></li><li><a href="/swift/design-patterns-structural.html" class="sidebar-link">Design Patterns - Structural</a></li><li><a href="/swift/unsafe-buffer-pointers.html" class="sidebar-link">(Unsafe) Buffer Pointers</a></li><li><a href="/swift/cryptographic-hashing.html" class="sidebar-link">Cryptographic Hashing</a></li><li><a href="/swift/aes-encryption.html" class="sidebar-link">AES encryption</a></li><li><a href="/swift/pbkdf2-key-derivation.html" class="sidebar-link">PBKDF2 Key Derivation</a></li><li><a href="/swift/logging-in-swift.html" class="sidebar-link">Logging in Swift</a></li><li><a href="/swift/memory-management.html" class="sidebar-link">Memory Management</a></li><li><a href="/swift/performance.html" class="sidebar-link">Performance</a></li><li><a href="/swift/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dependency-injection"><a href="#dependency-injection" class="header-anchor">#</a> Dependency Injection</h1> <h2 id="dependency-injection-with-view-controllers"><a href="#dependency-injection-with-view-controllers" class="header-anchor">#</a> Dependency Injection with View Controllers</h2> <h3 id="dependenct-injection-intro"><a href="#dependenct-injection-intro" class="header-anchor">#</a> Dependenct Injection Intro</h3> <p>An application is composed of many objects that collaborate with each other. Objects usually depend on other objects to perform some task. When an object is responsible for referencing its own dependencies it leads to a highly coupled, hard-to-test and hard-to-change code.</p> <p>Dependency injection is a software design pattern that implements inversion of control for resolving dependencies. An injection is passing of dependency to a dependent object that would use it. This allows a separation of client's dependencies from the client's behaviour, which allows the application to be loosely coupled.</p> <p><strong>Not to be confused with the above definition - a dependency injection simply means giving an object its instance variables.</strong></p> <p>It's that simple, but it provides a lot of benefits:</p> <ul><li>easier to test your code (using automated tests like unit and UI tests)</li> <li>when used in tandem with protocol-oriented programming it makes it easy to change the implementation of a certain class - easier to refactor</li> <li>it makes the code more modular and reusable</li></ul> <p>There are three most commonly used ways Dependency Injection (DI) can be implemented in an application:</p> <ol><li>Initializer injection</li> <li>Property injection</li> <li>Using third party DI frameworks (like Swinject, Cleanse, Dip or Typhoon)</li></ol> <p><a href="http://www.jamesshore.com/Blog/Dependency-Injection-Demystified.html" target="_blank" rel="noopener noreferrer">There is an interesting article<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> with links to more articles about Dependency Injection so check it out if you want to dig deeper into DI and Inversion of Control principle.</p> <p>Let's show how to use DI with View Controllers - an every day task for an average iOS developer.</p> <h3 id="example-without-di"><a href="#example-without-di" class="header-anchor">#</a> Example Without DI</h3> <p>We'll have two View Controllers: <strong>LoginViewController</strong> and <strong>TimelineViewController</strong>. LoginViewController is used to login and upon successful loign, it will switch to the TimelineViewController. Both view controllers are dependent on the <strong>FirebaseNetworkService</strong>.</p> <p><strong>LoginViewController</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">LoginViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span>

    <span class="token keyword">var</span> networkService <span class="token operator">=</span> <span class="token class-name">FirebaseNetworkService</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>TimelineViewController</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">TimelineViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span>

    <span class="token keyword">var</span> networkService <span class="token operator">=</span> <span class="token class-name">FirebaseNetworkService</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token attribute atrule">@IBAction</span> <span class="token keyword">func</span> <span class="token function-definition function">logoutButtonPressed</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> sender<span class="token punctuation">:</span> <span class="token class-name">UIButton</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        networkService<span class="token punctuation">.</span><span class="token function">logutCurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>FirebaseNetworkService</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">FirebaseNetworkService</span> <span class="token punctuation">{</span>

    <span class="token keyword">func</span> <span class="token function-definition function">loginUser</span><span class="token punctuation">(</span>username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> passwordHash<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Implementation not important for this example</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">logutCurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Implementation not important for this example</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>This example is very simple, but let's assume you have 10 or 15 different view controller and some of them are also dependent on the FirebaseNetworkService. At some moment you want to change Firebase as your backend service with your company's in-house backend service. To do that you'll have to go through every view controller and change FirebaseNetworkService with CompanyNetworkService. And if some of the methods in the CompanyNetworkService have changed, you'll have a lot of work to do.</p> <p>Unit and UI testing is not the scope of this example, but if you wanted to unit test view controllers with tightly coupled dependencies, you would have a really hard time doing so.</p> <p>Let's rewrite this example and inject Network Service to our view controllers.</p> <h3 id="example-with-dependancy-injection"><a href="#example-with-dependancy-injection" class="header-anchor">#</a> Example with Dependancy Injection</h3> <p>To make the best out of the Dependency Injection, let's define the functionality of the Network Service in a protocol. This way, view controllers dependent on a network service won't even have to know about the real implementation of it.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">protocol</span> <span class="token class-name">NetworkService</span> <span class="token punctuation">{</span>
    <span class="token keyword">func</span> <span class="token function-definition function">loginUser</span><span class="token punctuation">(</span>username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> passwordHash<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function-definition function">logutCurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Add an implementation of the NetworkService protocol:</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">FirebaseNetworkServiceImpl</span><span class="token punctuation">:</span> <span class="token class-name">NetworkService</span> <span class="token punctuation">{</span>
    <span class="token keyword">func</span> <span class="token function-definition function">loginUser</span><span class="token punctuation">(</span>username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> passwordHash<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Firebase implementation</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">logutCurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Firebase implementation</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Let's change LoginViewController and TimelineViewController to use new NetworkService protocol instead of FirebaseNetworkService.</p> <p><strong>LoginViewController</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">LoginViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span>

    <span class="token comment">// No need to initialize it here since an implementation</span>
    <span class="token comment">// of the NetworkService protocol will be injected</span>
    <span class="token keyword">var</span> networkService<span class="token punctuation">:</span> <span class="token class-name">NetworkService</span><span class="token operator">?</span>
    
    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>TimelineViewController</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">TimelineViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span>

    <span class="token keyword">var</span> networkService<span class="token punctuation">:</span> <span class="token class-name">NetworkService</span><span class="token operator">?</span>
    
    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token attribute atrule">@IBAction</span> <span class="token keyword">func</span> <span class="token function-definition function">logoutButtonPressed</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> sender<span class="token punctuation">:</span> <span class="token class-name">UIButton</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        networkService<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">logutCurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Now, the question is: How do we inject the correct NetworkService implementation in the LoginViewController and TimelineViewController?</p> <p>Since LoginViewController is the starting view controller and will show every time the application starts, we can inject all dependencies in the <strong>AppDelegate</strong>.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function-definition function">application</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> application<span class="token punctuation">:</span> <span class="token class-name">UIApplication</span><span class="token punctuation">,</span> didFinishLaunchingWithOptions launchOptions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">UIApplicationLaunchOptionsKey</span><span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Bool</span> <span class="token punctuation">{</span>
    <span class="token comment">// This logic will be different based on your project's structure or whether</span>
    <span class="token comment">// you have a navigation controller or tab bar controller for your starting view controller</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> loginVC <span class="token operator">=</span> window<span class="token operator">?</span><span class="token punctuation">.</span>rootViewController <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">LoginViewController</span> <span class="token punctuation">{</span>
        loginVC<span class="token punctuation">.</span>networkService <span class="token operator">=</span> <span class="token class-name">FirebaseNetworkServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

</code></pre></div><p>In the AppDelegate we are simply taking the reference to the first view controller (LoginViewController) and injecting the NetworkService implementation using the property injection method.</p> <p>Now, the next task is to inject the NetworkService implementation in the TimelineViewController. The easiest way is to do that when LoginViewController is transitioning to the TimlineViewController.</p> <p>We'll add the injection code in the prepareForSegue method in the LoginViewController (if you are using a different approach to navigate through view controllers, place the injection code there).</p> <p>Our LoginViewController class looks like this now:</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">LoginViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span>
    <span class="token comment">// No need to initialize it here since an implementation</span>
    <span class="token comment">// of the NetworkService protocol will be injected</span>
    <span class="token keyword">var</span> networkService<span class="token punctuation">:</span> <span class="token class-name">NetworkService</span><span class="token operator">?</span>
    
    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">prepare</span><span class="token punctuation">(</span><span class="token keyword">for</span> segue<span class="token punctuation">:</span> <span class="token class-name">UIStoryboardSegue</span><span class="token punctuation">,</span> sender<span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> segue<span class="token punctuation">.</span>identifier <span class="token operator">==</span> <span class="token string-literal"><span class="token string">&quot;TimelineViewController&quot;</span></span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token keyword">let</span> timelineVC <span class="token operator">=</span> segue<span class="token punctuation">.</span>destination <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">TimelineViewController</span> <span class="token punctuation">{</span>
                <span class="token comment">// Injecting the NetworkService implementation</span>
                timelineVC<span class="token punctuation">.</span>networkService <span class="token operator">=</span> networkService
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>We are done and it's that easy.</strong></p> <p>Now imagine we want to switch our NetworkService implementation from Firebase to our custom company's backend implementation.
All we would have to do is:</p> <p><strong>Add new NetworkService implementation class:</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">CompanyNetworkServiceImpl</span><span class="token punctuation">:</span> <span class="token class-name">NetworkService</span> <span class="token punctuation">{</span>
    <span class="token keyword">func</span> <span class="token function-definition function">loginUser</span><span class="token punctuation">(</span>username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> passwordHash<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Company API implementation</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">logutCurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Company API implementation</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Switch the FirebaseNetworkServiceImpl with the new implementation in the AppDelegate:</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function-definition function">application</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> application<span class="token punctuation">:</span> <span class="token class-name">UIApplication</span><span class="token punctuation">,</span> didFinishLaunchingWithOptions launchOptions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">UIApplicationLaunchOptionsKey</span><span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Bool</span> <span class="token punctuation">{</span>
        <span class="token comment">// This logic will be different based on your project's structure or whether</span>
        <span class="token comment">// you have a navigation controller or tab bar controller for your starting view controller</span>
        <span class="token keyword">if</span> <span class="token keyword">let</span> loginVC <span class="token operator">=</span> window<span class="token operator">?</span><span class="token punctuation">.</span>rootViewController <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">LoginViewController</span> <span class="token punctuation">{</span>
            loginVC<span class="token punctuation">.</span>networkService <span class="token operator">=</span> <span class="token class-name">CompanyNetworkServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>

</code></pre></div><p>That's it, we have switched the whole underlaying implementation of the NetworkService protocol without even touching LoginViewController or TimelineViewController.</p> <p>As this is a simple example, you might not see all the benefits right now, but if you try to use DI in your projects, you'll see the benefits and will always use Dependency Injection.</p> <h2 id="dependency-injection-types"><a href="#dependency-injection-types" class="header-anchor">#</a> Dependency Injection Types</h2> <p>This example will demonstrate how to use Dependency Injection (<strong>DI</strong>) design pattern in Swift using these methods:</p> <ol><li><strong>Initializer Injection</strong> (the proper term is Constructor Injection, but since Swift has initializers it's called initializer injection)</li> <li><strong>Property Injection</strong></li> <li><strong>Method Injection</strong></li></ol> <h3 id="example-setup-without-di"><a href="#example-setup-without-di" class="header-anchor">#</a> Example Setup without DI</h3> <div class="language- extra-class"><pre class="language-text"><code>
   protocol Engine {
        func startEngine()
        func stopEngine()
    }
    
    class TrainEngine: Engine {
        func startEngine() {
            print(&quot;Engine started&quot;)
        }
        
        func stopEngine() {
            print(&quot;Engine stopped&quot;)
        }
    }
    
    protocol TrainCar {
    var numberOfSeats: Int { get }
    func attachCar(attach: Bool)
}

class RestaurantCar: TrainCar {
    var numberOfSeats: Int {
        get {
            return 30
        }
    }
    func attachCar(attach: Bool) {
        print(&quot;Attach car&quot;)
    }
}

class PassengerCar: TrainCar {
    var numberOfSeats: Int {
        get {
            return 50
        }
    }
    func attachCar(attach: Bool) {
        print(&quot;Attach car&quot;)
    }
}
    
class Train {
    let engine: Engine?
    var mainCar: TrainCar?
}

</code></pre></div><h3 id="initializer-dependency-injection"><a href="#initializer-dependency-injection" class="header-anchor">#</a> Initializer Dependency Injection</h3> <p>As the name says, all dependencies are injected through the class initializer.
To inject dependencies through the initializer, we'll add the initializer to the <code>Train</code> class.</p> <p>Train class now looks like this:</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">Train</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> engine<span class="token punctuation">:</span> <span class="token class-name">Engine</span><span class="token operator">?</span>
    <span class="token keyword">var</span> mainCar<span class="token punctuation">:</span> <span class="token class-name">TrainCar</span><span class="token operator">?</span>
    
    <span class="token keyword">init</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token class-name">Engine</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>engine <span class="token operator">=</span> engine
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>When we want to create an instance of the Train class we'll use initializer to inject a specific Engine implementation:</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> train <span class="token operator">=</span> <span class="token class-name">Train</span><span class="token punctuation">(</span>engine<span class="token punctuation">:</span> <span class="token class-name">TrainEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p><strong>NOTE:</strong> The main advantage of the initializer injection versus the property injection is that we can set the variable as private variable or even make it a constant with the <code>let</code> keyword (as we did in our example). This way we can make sure that no one can access it or change it.</p> <h3 id="properties-dependency-injection"><a href="#properties-dependency-injection" class="header-anchor">#</a> Properties Dependency Injection</h3> <p>DI using properties is even simpler that using an initializer. Let's inject a PassengerCar dependency to the train object we already created using the properties DI:</p> <div class="language-swift extra-class"><pre class="language-swift"><code>train<span class="token punctuation">.</span>mainCar <span class="token operator">=</span> <span class="token class-name">PassengerCar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><p>That's it. Our train's <code>mainCar</code> is now a <code>PassengerCar</code> instance.</p> <h3 id="method-dependency-injection"><a href="#method-dependency-injection" class="header-anchor">#</a> Method Dependency Injection</h3> <p>This type of dependency injection is a little different that the previous two because it won't affect the whole object, but it will only inject a dependency to be used in the scope of one specific method. When a dependency is only used in a single method, it's usually not good to make the whole object dependent on it.
Let's add a new method to the Train class:</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function-definition function">reparkCar</span><span class="token punctuation">(</span>trainCar<span class="token punctuation">:</span> <span class="token class-name">TrainCar</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    trainCar<span class="token punctuation">.</span><span class="token function">attachCar</span><span class="token punctuation">(</span>attach<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    engine<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">startEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    engine<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">stopEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    trainCar<span class="token punctuation">.</span><span class="token function">attachCar</span><span class="token punctuation">(</span>attach<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Now, if we call the new Train's class method, we'll inject the <code>TrainCar</code> using the method dependency injection.</p> <div class="language-swift extra-class"><pre class="language-swift"><code>train<span class="token punctuation">.</span><span class="token function">reparkCar</span><span class="token punctuation">(</span>trainCar<span class="token punctuation">:</span> <span class="token class-name">RestaurantCar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/swift/dependency-injection.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/swift/typealias.html" class="prev">
        Typealias
      </a></span> <span class="next"><a href="/swift/caching-on-disk-space.html">
        Caching on disk space
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3324.8a320599.js" defer></script>
  </body>
</html>
