<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>iOS - Keychain</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Adding a Password to the Keychain, Keychain Access Control (TouchID with password fallback), Finding a Password in the Keychain, Updating a Password in the Keychain, Removing a Password from the Keychain, Keychain Add, Update, Remove and Find operations using one file.">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="iOS - Keychain">
    <meta property="og:description" content="Adding a Password to the Keychain, Keychain Access Control (TouchID with password fallback), Finding a Password in the Keychain, Updating a Password in the Keychain, Removing a Password from the Keychain, Keychain Add, Update, Remove and Find operations using one file.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/ios/keychain.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="iOS - Keychain">
    <meta name="twitter:description" content="Adding a Password to the Keychain, Keychain Access Control (TouchID with password fallback), Finding a Password in the Keychain, Updating a Password in the Keychain, Removing a Password from the Keychain, Keychain Add, Update, Remove and Find operations using one file.">
    <meta name="twitter:url" content="/ios/keychain.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/1397.a92376bb.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>iOS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ios/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/ios/getting-started-with-ios.html" class="sidebar-link">Getting started with iOS</a></li><li><a href="/ios/uilabel.html" class="sidebar-link">UILabel</a></li><li><a href="/ios/uilabel-text-underlining.html" class="sidebar-link">UILabel text underlining</a></li><li><a href="/ios/attributedtext-in-uilabel.html" class="sidebar-link">attributedText in UILabel</a></li><li><a href="/ios/uibutton.html" class="sidebar-link">UIButton</a></li><li><a href="/ios/uidatepicker.html" class="sidebar-link">UIDatePicker</a></li><li><a href="/ios/uilocalnotification.html" class="sidebar-link">UILocalNotification</a></li><li><a href="/ios/uiimage.html" class="sidebar-link">UIImage</a></li><li><a href="/ios/convert-nsattributedstring-to-uiimage.html" class="sidebar-link">Convert NSAttributedString to UIImage</a></li><li><a href="/ios/uiimagepickercontroller.html" class="sidebar-link">UIImagePickerController</a></li><li><a href="/ios/uiimageview.html" class="sidebar-link">UIImageView</a></li><li><a href="/ios/resizing-uiimage.html" class="sidebar-link">Resizing UIImage</a></li><li><a href="/ios/cut-a-uiimage-into-a-circle.html" class="sidebar-link">Cut a UIImage into a circle</a></li><li><a href="/ios/uitableview.html" class="sidebar-link">UITableView</a></li><li><a href="/ios/uitableviewcontroller.html" class="sidebar-link">UITableViewController</a></li><li><a href="/ios/uirefreshcontrol-tableview.html" class="sidebar-link">UIRefreshControl TableView</a></li><li><a href="/ios/uitableviewcell.html" class="sidebar-link">UITableViewCell</a></li><li><a href="/ios/custom-methods-of-selection-of-uitableviewcells.html" class="sidebar-link">Custom methods of selection of UITableViewCells</a></li><li><a href="/ios/custom-methods-of-selection-of-uitableviewcells.html" class="sidebar-link">Custom methods of selection of UITableViewCells</a></li><li><a href="/ios/uiview.html" class="sidebar-link">UIView</a></li><li><a href="/ios/snapshot-of-uiview.html" class="sidebar-link">Snapshot of UIView</a></li><li><a href="/ios/uialertcontroller.html" class="sidebar-link">UIAlertController</a></li><li><a href="/ios/uicolor.html" class="sidebar-link">UIColor</a></li><li><a href="/ios/uitextview.html" class="sidebar-link">UITextView</a></li><li><a href="/ios/uitextfield-delegate.html" class="sidebar-link">UITextField Delegate</a></li><li><a href="/ios/uinavigationcontroller.html" class="sidebar-link">UINavigationController</a></li><li><a href="/ios/uigesturerecognizer.html" class="sidebar-link">UIGestureRecognizer</a></li><li><a href="/ios/uibarbuttonitem.html" class="sidebar-link">UIBarButtonItem</a></li><li><a href="/ios/uiscrollview.html" class="sidebar-link">UIScrollView</a></li><li><a href="/ios/uistackview.html" class="sidebar-link">UIStackView</a></li><li><a href="/ios/dynamically-updating-a-uistackview.html" class="sidebar-link">Dynamically updating a UIStackView</a></li><li><a href="/ios/uiscrollview-with-stackview-child.html" class="sidebar-link">UIScrollView with StackView child</a></li><li><a href="/ios/uiscrollview-autolayout.html" class="sidebar-link">UIScrollView AutoLayout</a></li><li><a href="/ios/uitextfield.html" class="sidebar-link">UITextField</a></li><li><a href="/ios/custom-uitextfield.html" class="sidebar-link">Custom UITextField</a></li><li><a href="/ios/uiviewcontroller.html" class="sidebar-link">UIViewController</a></li><li><a href="/ios/uiswitch.html" class="sidebar-link">UISwitch</a></li><li><a href="/ios/uicollectionview.html" class="sidebar-link">UICollectionView</a></li><li><a href="/ios/uisearchcontroller.html" class="sidebar-link">UISearchController</a></li><li><a href="/ios/uitabbarcontroller.html" class="sidebar-link">UITabBarController</a></li><li><a href="/ios/uiwebview.html" class="sidebar-link">UIWebView</a></li><li><a href="/ios/uiactivityviewcontroller.html" class="sidebar-link">UIActivityViewController</a></li><li><a href="/ios/uicontrol-event-handling-with-blocks.html" class="sidebar-link">UIControl - Event Handling with Blocks</a></li><li><a href="/ios/uisplitviewcontroller.html" class="sidebar-link">UISplitViewController</a></li><li><a href="/ios/uislider.html" class="sidebar-link">UISlider</a></li><li><a href="/ios/uistoryboard.html" class="sidebar-link">UIStoryboard</a></li><li><a href="/ios/uipageviewcontroller.html" class="sidebar-link">UIPageViewController</a></li><li><a href="/ios/uisplitviewcontroller.html" class="sidebar-link">UISplitViewController</a></li><li><a href="/ios/uifont.html" class="sidebar-link">UIFont</a></li><li><a href="/ios/uidevice.html" class="sidebar-link">UIDevice</a></li><li><a href="/ios/make-selective-uiview-corners-rounded.html" class="sidebar-link">Make selective UIView corners rounded</a></li><li><a href="/ios/custom-uiviews-from-xib-files.html" class="sidebar-link">Custom UIViews from XIB files</a></li><li><a href="/ios/uibezierpath.html" class="sidebar-link">UIBezierPath</a></li><li><a href="/ios/uipickerview.html" class="sidebar-link">UIPickerView</a></li><li><a href="/ios/uifeedbackgenerator.html" class="sidebar-link">UIFeedbackGenerator</a></li><li><a href="/ios/uiappearance.html" class="sidebar-link">UIAppearance</a></li><li><a href="/ios/uikit-dynamics-with-uicollectionview.html" class="sidebar-link">UIKit Dynamics with UICollectionView</a></li><li><a href="/ios/uipheonix-easy-flexible-dynamic-highly-scalable-ui-framework.html" class="sidebar-link">UIPheonix - easy, flexible, dynamic &amp; highly scalable UI framework</a></li><li><a href="/ios/uikit-dynamics.html" class="sidebar-link">UIKit Dynamics</a></li><li><a href="/ios/ui-testing.html" class="sidebar-link">UI Testing</a></li><li><a href="/ios/change-status-bar-color.html" class="sidebar-link">Change Status Bar Color</a></li><li><a href="/ios/uisegmentedcontrol.html" class="sidebar-link">UISegmentedControl</a></li><li><a href="/ios/passing-data-between-view-controllers.html" class="sidebar-link">Passing Data between View Controllers</a></li><li><a href="/ios/managing-the-keyboard.html" class="sidebar-link">Managing the Keyboard</a></li><li><a href="/ios/checking-for-network-connectivity.html" class="sidebar-link">Checking for Network Connectivity</a></li><li><a href="/ios/accessibility.html" class="sidebar-link">Accessibility</a></li><li><a href="/ios/auto-layout.html" class="sidebar-link">Auto Layout</a></li><li><a href="/ios/mkmapview.html" class="sidebar-link">MKMapView</a></li><li><a href="/ios/nsarray.html" class="sidebar-link">NSArray</a></li><li><a href="/ios/nsattributedstring.html" class="sidebar-link">NSAttributedString</a></li><li><a href="/ios/convert-html-to-nsattributed-string-and-vice-verse.html" class="sidebar-link">Convert HTML to NSAttributed string and vice verse</a></li><li><a href="/ios/nstimer.html" class="sidebar-link">NSTimer</a></li><li><a href="/ios/nsdate.html" class="sidebar-link">NSDate</a></li><li><a href="/ios/nsnotificationcenter.html" class="sidebar-link">NSNotificationCenter</a></li><li><a href="/ios/nsurlsession.html" class="sidebar-link">NSURLSession</a></li><li><a href="/ios/nsuserdefaults.html" class="sidebar-link">NSUserDefaults</a></li><li><a href="/ios/nshttpcookiestorage.html" class="sidebar-link">NSHTTPCookieStorage</a></li><li><a href="/ios/nsurlconnection.html" class="sidebar-link">NSURLConnection</a></li><li><a href="/ios/nsurl.html" class="sidebar-link">NSURL</a></li><li><a href="/ios/nsdata.html" class="sidebar-link">NSData</a></li><li><a href="/ios/nsinvocation.html" class="sidebar-link">NSInvocation</a></li><li><a href="/ios/nsuseractivity.html" class="sidebar-link">NSUserActivity</a></li><li><a href="/ios/nspredicate.html" class="sidebar-link">NSPredicate</a></li><li><a href="/ios/nsbundle.html" class="sidebar-link">NSBundle</a></li><li><a href="/ios/caanimation.html" class="sidebar-link">CAAnimation</a></li><li><a href="/ios/concurrency.html" class="sidebar-link">Concurrency</a></li><li><a href="/ios/cagradientlayer.html" class="sidebar-link">CAGradientLayer</a></li><li><a href="/ios/safari-services.html" class="sidebar-link">Safari Services</a></li><li><a href="/ios/calayer.html" class="sidebar-link">CALayer</a></li><li><a href="/ios/ios-implementation-of-xmpp-with-robbie-hanson-framework.html" class="sidebar-link">iOS - Implementation of XMPP with Robbie Hanson framework</a></li><li><a href="/ios/swift-and-objective-c-interoperability.html" class="sidebar-link">Swift and Objective-C interoperability</a></li><li><a href="/ios/custom-fonts.html" class="sidebar-link">Custom fonts</a></li><li><a href="/ios/avspeechsynthesizer.html" class="sidebar-link">AVSpeechSynthesizer</a></li><li><a href="/ios/localization.html" class="sidebar-link">Localization</a></li><li><a href="/ios/alamofire.html" class="sidebar-link">Alamofire</a></li><li><a href="/ios/ibeacon.html" class="sidebar-link">iBeacon</a></li><li><a href="/ios/cllocation.html" class="sidebar-link">CLLocation</a></li><li><a href="/ios/checking-ios-version.html" class="sidebar-link">Checking iOS version</a></li><li><a href="/ios/universal-links.html" class="sidebar-link">Universal Links</a></li><li><a href="/ios/pdf-creation-in-ios.html" class="sidebar-link">PDF Creation in iOS</a></li><li><a href="/ios/in-app-purchase.html" class="sidebar-link">In-App Purchase</a></li><li><a href="/ios/cgcontext-reference.html" class="sidebar-link">CGContext Reference</a></li><li><a href="/ios/core-location.html" class="sidebar-link">Core Location</a></li><li><a href="/ios/facebooksdk.html" class="sidebar-link">FacebookSDK</a></li><li><a href="/ios/afnetworking.html" class="sidebar-link">AFNetworking</a></li><li><a href="/ios/ctcallcenter.html" class="sidebar-link">CTCallCenter</a></li><li><a href="/ios/push-notifications.html" class="sidebar-link">Push Notifications</a></li><li><a href="/ios/extension-for-rich-push-notification-ios-10.html" class="sidebar-link">Extension for rich Push Notification - iOS 10.</a></li><li><a href="/ios/rich-notifications.html" class="sidebar-link">Rich Notifications</a></li><li><a href="/ios/key-value-coding-key-value-observation.html" class="sidebar-link">Key Value Coding-Key Value Observation</a></li><li><a href="/ios/initialization-idioms.html" class="sidebar-link">Initialization idioms</a></li><li><a href="/ios/storyboard.html" class="sidebar-link">Storyboard</a></li><li><a href="/ios/background-modes-and-events.html" class="sidebar-link">Background Modes and Events</a></li><li><a href="/ios/fastlane.html" class="sidebar-link">Fastlane</a></li><li><a href="/ios/cashapelayer.html" class="sidebar-link">CAShapeLayer</a></li><li><a href="/ios/wkwebview.html" class="sidebar-link">WKWebView</a></li><li><a href="/ios/uuid-universally-unique-identifier.html" class="sidebar-link">UUID (Universally Unique Identifier)</a></li><li><a href="/ios/categories.html" class="sidebar-link">Categories</a></li><li><a href="/ios/handling-url-schemes.html" class="sidebar-link">Handling URL Schemes</a></li><li><a href="/ios/realm.html" class="sidebar-link">Realm</a></li><li><a href="/ios/arc-automatic-reference-counting.html" class="sidebar-link">ARC (Automatic Reference Counting)</a></li><li><a href="/ios/dynamic-type.html" class="sidebar-link">Dynamic Type</a></li><li><a href="/ios/swrevealviewcontroller.html" class="sidebar-link">SWRevealViewController</a></li><li><a href="/ios/dispatchgroup.html" class="sidebar-link">DispatchGroup</a></li><li><a href="/ios/gcd-grand-central-dispatch.html" class="sidebar-link">GCD (Grand Central Dispatch)</a></li><li><a href="/ios/size-classes-and-adaptivity.html" class="sidebar-link">Size Classes and Adaptivity</a></li><li><a href="/ios/iboutlets.html" class="sidebar-link">IBOutlets</a></li><li><a href="/ios/aws-sdk.html" class="sidebar-link">AWS SDK</a></li><li><a href="/ios/debugging-crashes.html" class="sidebar-link">Debugging Crashes</a></li><li><a href="/ios/cloudkit.html" class="sidebar-link">CloudKit</a></li><li><a href="/ios/gameplaykit.html" class="sidebar-link">GameplayKit</a></li><li><a href="/ios/xcode-build-archive-from-command-line.html" class="sidebar-link">Xcode Build &amp; Archive From Command Line</a></li><li><a href="/ios/xctest-framework-unit-testing.html" class="sidebar-link">XCTest framework - Unit Testing</a></li><li><a href="/ios/avplayer-and-avplayerviewcontroller.html" class="sidebar-link">AVPlayer and AVPlayerViewController</a></li><li><a href="/ios/deep-linking-in-ios.html" class="sidebar-link">Deep Linking in iOS</a></li><li><a href="/ios/core-graphics.html" class="sidebar-link">Core Graphics</a></li><li><a href="/ios/segues.html" class="sidebar-link">Segues</a></li><li><a href="/ios/eventkit.html" class="sidebar-link">EventKit</a></li><li><a href="/ios/sirikit.html" class="sidebar-link">SiriKit</a></li><li><a href="/ios/contacts-framework.html" class="sidebar-link">Contacts Framework</a></li><li><a href="/ios/ios-10-speech-recognition-api.html" class="sidebar-link">iOS 10 Speech Recognition API</a></li><li><a href="/ios/storekit.html" class="sidebar-link">StoreKit</a></li><li><a href="/ios/code-signing.html" class="sidebar-link">Code signing</a></li><li><a href="/ios/create-ipa-file-to-upload-on-appstore-with-applicationloader.html" class="sidebar-link">Create .ipa File to upload on appstore with Applicationloader</a></li><li><a href="/ios/size-classes-and-adaptivity.html" class="sidebar-link">Size Classes and Adaptivity</a></li><li><a href="/ios/mkdistanceformatter.html" class="sidebar-link">MKDistanceFormatter</a></li><li><a href="/ios/3d-touch.html" class="sidebar-link">3D Touch</a></li><li><a href="/ios/gamecenter-leaderboards.html" class="sidebar-link">GameCenter Leaderboards</a></li><li><a href="/ios/keychain.html" aria-current="page" class="active sidebar-link">Keychain</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ios/keychain.html#adding-a-password-to-the-keychain" class="sidebar-link">Adding a Password to the Keychain</a></li><li class="sidebar-sub-header"><a href="/ios/keychain.html#keychain-access-control-touchid-with-password-fallback" class="sidebar-link">Keychain Access Control (TouchID with password fallback)</a></li><li class="sidebar-sub-header"><a href="/ios/keychain.html#finding-a-password-in-the-keychain" class="sidebar-link">Finding a Password in the Keychain</a></li><li class="sidebar-sub-header"><a href="/ios/keychain.html#updating-a-password-in-the-keychain" class="sidebar-link">Updating a Password in the Keychain</a></li><li class="sidebar-sub-header"><a href="/ios/keychain.html#removing-a-password-from-the-keychain" class="sidebar-link">Removing a Password from the Keychain</a></li><li class="sidebar-sub-header"><a href="/ios/keychain.html#keychain-add-update-remove-and-find-operations-using-one-file" class="sidebar-link">Keychain Add, Update, Remove and Find operations using one file.</a></li></ul></li><li><a href="/ios/handle-multiple-environment-using-macro.html" class="sidebar-link">Handle Multiple Environment using Macro</a></li><li><a href="/ios/set-view-background.html" class="sidebar-link">Set View Background</a></li><li><a href="/ios/block.html" class="sidebar-link">Block</a></li><li><a href="/ios/content-hugging-content-compression-in-autolayout.html" class="sidebar-link">Content Hugging/Content Compression in Autolayout</a></li><li><a href="/ios/ios-google-places-api.html" class="sidebar-link">iOS Google Places API</a></li><li><a href="/ios/navigation-bar.html" class="sidebar-link">Navigation Bar</a></li><li><a href="/ios/app-wide-operations.html" class="sidebar-link">App wide operations</a></li><li><a href="/ios/coreimage-filters.html" class="sidebar-link">CoreImage Filters</a></li><li><a href="/ios/face-detection-using-coreimage-opencv.html" class="sidebar-link">Face Detection Using CoreImage/OpenCV</a></li><li><a href="/ios/mpmediapickerdelegate.html" class="sidebar-link">MPMediaPickerDelegate</a></li><li><a href="/ios/graph-coreplot.html" class="sidebar-link">Graph (Coreplot)</a></li><li><a href="/ios/fcm-messaging-in-swift.html" class="sidebar-link">FCM Messaging in Swift</a></li><li><a href="/ios/create-a-custom-framework-in-ios.html" class="sidebar-link">Create a Custom framework in iOS</a></li><li><a href="/ios/custom-keyboard.html" class="sidebar-link">Custom Keyboard</a></li><li><a href="/ios/airdrop.html" class="sidebar-link">AirDrop</a></li><li><a href="/ios/slcomposeviewcontroller.html" class="sidebar-link">SLComposeViewController</a></li><li><a href="/ios/airprint-tutorial-in-ios.html" class="sidebar-link">AirPrint tutorial in iOS</a></li><li><a href="/ios/carthage-ios-setup.html" class="sidebar-link">Carthage iOS Setup</a></li><li><a href="/ios/healthkit.html" class="sidebar-link">Healthkit</a></li><li><a href="/ios/core-spotlight-in-ios.html" class="sidebar-link">Core SpotLight in iOS</a></li><li><a href="/ios/core-motion.html" class="sidebar-link">Core Motion</a></li><li><a href="/ios/qr-code-scanner.html" class="sidebar-link">QR Code Scanner</a></li><li><a href="/ios/plist-ios.html" class="sidebar-link">plist iOS</a></li><li><a href="/ios/wcsessiondelegate.html" class="sidebar-link">WCSessionDelegate</a></li><li><a href="/ios/appdelegate.html" class="sidebar-link">AppDelegate</a></li><li><a href="/ios/app-submission-process.html" class="sidebar-link">App Submission Process</a></li><li><a href="/ios/filehandle.html" class="sidebar-link">FileHandle</a></li><li><a href="/ios/basic-text-file-i-o.html" class="sidebar-link">Basic text file I/O</a></li><li><a href="/ios/ios-tts.html" class="sidebar-link">iOS TTS</a></li><li><a href="/ios/mpvolumeview.html" class="sidebar-link">MPVolumeView</a></li><li><a href="/ios/objective-c-associated-objects.html" class="sidebar-link">Objective-C Associated Objects</a></li><li><a href="/ios/passing-data-between-view-controllers-with-messagebox-concept.html" class="sidebar-link">Passing Data between View Controllers (with MessageBox-Concept)</a></li><li><a href="/ios/mvvm.html" class="sidebar-link">MVVM</a></li><li><a href="/ios/cache-online-images.html" class="sidebar-link">Cache online images</a></li><li><a href="/ios/chain-blocks-in-a-queue-with-mkblockqueue.html" class="sidebar-link">Chain Blocks in a Queue (with MKBlockQueue)</a></li><li><a href="/ios/simulator.html" class="sidebar-link">Simulator</a></li><li><a href="/ios/background-modes.html" class="sidebar-link">Background Modes</a></li><li><a href="/ios/opengl.html" class="sidebar-link">OpenGL</a></li><li><a href="/ios/mvp-architecture.html" class="sidebar-link">MVP Architecture</a></li><li><a href="/ios/configure-beacons-with-corebluetooth.html" class="sidebar-link">Configure Beacons with CoreBluetooth</a></li><li><a href="/ios/core-data.html" class="sidebar-link">Core Data</a></li><li><a href="/ios/profile-with-instruments.html" class="sidebar-link">Profile with Instruments</a></li><li><a href="/ios/application-rating-review-request.html" class="sidebar-link">Application rating/review request</a></li><li><a href="/ios/mylayout.html" class="sidebar-link">MyLayout</a></li><li><a href="/ios/simulator-builds.html" class="sidebar-link">Simulator Builds</a></li><li><a href="/ios/simulating-location-using-gpx-files-ios.html" class="sidebar-link">Simulating Location Using GPX files iOS</a></li><li><a href="/ios/sqlcipher-integration.html" class="sidebar-link">SqlCipher integration</a></li><li><a href="/ios/security.html" class="sidebar-link">Security</a></li><li><a href="/ios/app-transport-security-ats.html" class="sidebar-link">App Transport Security (ATS)</a></li><li><a href="/ios/guideline-to-choose-best-ios-architecture-patterns.html" class="sidebar-link">Guideline to choose best iOS Architecture Patterns</a></li><li><a href="/ios/multicast-delegates.html" class="sidebar-link">Multicast Delegates</a></li><li><a href="/ios/using-image-aseets.html" class="sidebar-link">Using Image Aseets</a></li><li><a href="/ios/runtime-in-objective-c.html" class="sidebar-link">Runtime in Objective-C</a></li><li><a href="/ios/modelpresentationstyles.html" class="sidebar-link">ModelPresentationStyles</a></li><li><a href="/ios/cydiasubstrate-tweak.html" class="sidebar-link">CydiaSubstrate tweak</a></li><li><a href="/ios/create-a-video-from-images.html" class="sidebar-link">Create a video from images</a></li><li><a href="/ios/codable.html" class="sidebar-link">Codable</a></li><li><a href="/ios/load-images-async.html" class="sidebar-link">Load images async</a></li><li><a href="/ios/adding-a-swift-bridging-header.html" class="sidebar-link">ADDING A SWIFT BRIDGING HEADER</a></li><li><a href="/ios/creating-an-app-id.html" class="sidebar-link">Creating an App ID</a></li><li><a href="/ios/swift-changing-the-rootviewcontroller-in-appdelegate-to-present-main-or-login-onboarding-flow.html" class="sidebar-link">Swift: Changing the rootViewController in AppDelegate to present main or login/onboarding flow</a></li><li><a href="/ios/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="keychain"><a href="#keychain" class="header-anchor">#</a> Keychain</h1> <h2 id="adding-a-password-to-the-keychain"><a href="#adding-a-password-to-the-keychain" class="header-anchor">#</a> Adding a Password to the Keychain</h2> <p>Every Keychain Item is most often represented as a <code>CFDictionary</code>. You can, however, simply use <code>NSDictionary</code> in Objective-C and take advantage of bridging, or in Swift you may use <code>Dictionary</code> and explicitly cast to <code>CFDictionary</code>.</p> <p>You could construct a password with the following dictionary:</p> <h3 id="swift"><a href="#swift" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span> <span class="token punctuation">:</span> <span class="token class-name">AnyObject</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><p>First, you need a key/value pair that lets the Keychain know this is a password. Note that because our dict key is a <code>String</code> we must cast any <code>CFString</code> to a <code>String</code> explicitly in Swift 3. CFString may not be used as the key to a Swift Dictionary because it is not Hashable.</p> <h3 id="swift-2"><a href="#swift-2" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code>dict<span class="token punctuation">[</span><span class="token constant">kSecClass</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kSecClassGenericPassword</span>

</code></pre></div><p>Next, our password may have a series of attributes to describe it and help us find it later. <a href="https://developer.apple.com/reference/security/ksecclasskey" target="_blank" rel="noopener noreferrer">Here's a list of attributes for generic passwords<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="swift-3"><a href="#swift-3" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token comment">// The password will only be accessible when the device is unlocked</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrAccessible</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kSecAttrAccessibleWhenUnlocked</span>
<span class="token comment">// Label may help you find it later</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrLabel</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;com.me.myapp.myaccountpassword&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
<span class="token comment">// Username</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrAccount</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;My Name&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
<span class="token comment">// Service name</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrService</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;MyService&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>

</code></pre></div><p>Finally, we need our actual private data. Be sure not to keep this around in memory for too long. This must be <code>CFData</code>.</p> <h3 id="swift-4"><a href="#swift-4" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code>dict<span class="token punctuation">[</span><span class="token constant">kSecValueData</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;my_password!!&quot;</span></span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>using<span class="token punctuation">:</span> <span class="token punctuation">.</span>utf8<span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token class-name">CFData</span>

</code></pre></div><p>Finally, the Keychain Services add function wants to know how it should return the newly constructed keychain item. Since you shouldn't be holding on to the data very long in memory, here's how you could only return the attributes:</p> <h3 id="swift-5"><a href="#swift-5" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code>dict<span class="token punctuation">[</span><span class="token constant">kSecReturnAttributes</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kCFBooleanTrue</span>

</code></pre></div><p>Now we have constructed our item. Let's add it:</p> <h3 id="swift-6"><a href="#swift-6" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> result<span class="token punctuation">:</span> <span class="token class-name">AnyObject</span><span class="token operator">?</span>
<span class="token keyword">let</span> status <span class="token operator">=</span> <span class="token function">withUnsafeMutablePointer</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> <span class="token operator">&amp;</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">SecItemAdd</span><span class="token punctuation">(</span>dict <span class="token keyword">as</span> <span class="token class-name">CFDictionary</span><span class="token punctuation">,</span> <span class="token class-name">UnsafeMutablePointer</span><span class="token punctuation">(</span><span class="token short-argument">$0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> newAttributes <span class="token operator">=</span> result <span class="token keyword">as</span><span class="token operator">!</span> <span class="token class-name">Dictionary</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">AnyObject</span><span class="token operator">&gt;</span>

</code></pre></div><p>This places the new attributes dict inside <code>result</code>. <code>SecItemAdd</code> takes in the dictionary we constructed, as well as a pointer to where we would like our result. The function then returns an <code>OSStatus</code> indicating success or an error code. Result codes are described <a href="https://developer.apple.com/reference/security/1658642-keychain_services#1662444" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="keychain-access-control-touchid-with-password-fallback"><a href="#keychain-access-control-touchid-with-password-fallback" class="header-anchor">#</a> Keychain Access Control (TouchID with password fallback)</h2> <p>Keychain allows to save items with special SecAccessControl attribute which will allow to get item from Keychain only after user will be authenticated with Touch ID (or passcode if such fallback is allowed). App is only notified whether the authentication was successful or not, whole UI is managed by iOS.</p> <p>First, SecAccessControl object should be created:</p> <h3 id="swift-7"><a href="#swift-7" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> error<span class="token punctuation">:</span> <span class="token class-name">Unmanaged</span><span class="token operator">&lt;</span><span class="token class-name">CFError</span><span class="token operator">&gt;?</span>

<span class="token keyword">guard</span> <span class="token keyword">let</span> accessControl <span class="token operator">=</span> <span class="token class-name">SecAccessControlCreateWithFlags</span><span class="token punctuation">(</span><span class="token constant">kCFAllocatorDefault</span><span class="token punctuation">,</span> <span class="token constant">kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>userPresence<span class="token punctuation">,</span> <span class="token operator">&amp;</span>error<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">fatalError</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Something went wrong&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Next, add it to the dictionary with kSecAttrAccessControl key (which is mutually exclusive with kSecAttrAccessible key you've been using in other examples):</p> <h3 id="swift-8"><a href="#swift-8" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> dictionary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span> <span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

dictionary<span class="token punctuation">[</span><span class="token constant">kSecClass</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kSecClassGenericPassword</span>
dictionary<span class="token punctuation">[</span><span class="token constant">kSecAttrLabel</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;com.me.myapp.myaccountpassword&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
dictionary<span class="token punctuation">[</span><span class="token constant">kSecAttrAccount</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;My Name&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
dictionary<span class="token punctuation">[</span><span class="token constant">kSecValueData</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;new_password!!&quot;</span></span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>using<span class="token punctuation">:</span> <span class="token punctuation">.</span>utf8<span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token class-name">CFData</span>
dictionary<span class="token punctuation">[</span><span class="token constant">kSecAttrAccessControl</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> accessControl

</code></pre></div><p>And save it as you've done before:</p> <h3 id="swift-9"><a href="#swift-9" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> lastResultCode <span class="token operator">=</span> <span class="token class-name">SecItemAdd</span><span class="token punctuation">(</span>query <span class="token keyword">as</span> <span class="token class-name">CFDictionary</span><span class="token punctuation">,</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span>

</code></pre></div><p>To access stored data, just query Keychain for a key. Keychain Services will present authentication dialog to the user and return data or nil depending on whether suitable fingerprint was provided or passcode matched.</p> <p>Optionally, prompt string can be specified:</p> <h3 id="swift-10"><a href="#swift-10" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

query<span class="token punctuation">[</span><span class="token constant">kSecClass</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kSecClassGenericPassword</span>
query<span class="token punctuation">[</span><span class="token constant">kSecReturnData</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kCFBooleanTrue</span>
query<span class="token punctuation">[</span><span class="token constant">kSecAttrAccount</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;My Name&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
query<span class="token punctuation">[</span><span class="token constant">kSecAttrLabel</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;com.me.myapp.myaccountpassword&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
query<span class="token punctuation">[</span><span class="token constant">kSecUseOperationPrompt</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;Please put your fingers on that button&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>

<span class="token keyword">var</span> queryResult<span class="token punctuation">:</span> <span class="token class-name">AnyObject</span><span class="token operator">?</span>
<span class="token keyword">let</span> status <span class="token operator">=</span> <span class="token function">withUnsafeMutablePointer</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> <span class="token operator">&amp;</span>queryResult<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">SecItemCopyMatching</span><span class="token punctuation">(</span>query <span class="token keyword">as</span> <span class="token class-name">CFDictionary</span><span class="token punctuation">,</span> <span class="token class-name">UnsafeMutablePointer</span><span class="token punctuation">(</span><span class="token short-argument">$0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Pay attention that <code>status</code> will be <code>err</code> if user declined, canceled or failed authorization.</p> <h3 id="swift-11"><a href="#swift-11" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">if</span> status <span class="token operator">==</span> noErr <span class="token punctuation">{</span>
    <span class="token keyword">let</span> password <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> queryResult <span class="token keyword">as</span><span class="token operator">!</span> <span class="token class-name">Data</span><span class="token punctuation">,</span> encoding<span class="token punctuation">:</span> <span class="token punctuation">.</span>utf8<span class="token punctuation">)</span><span class="token operator">!</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Password: </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">password</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Authorization not passed&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="finding-a-password-in-the-keychain"><a href="#finding-a-password-in-the-keychain" class="header-anchor">#</a> Finding a Password in the Keychain</h2> <p>To construct a query, we need to represent it as a <code>CFDictionary</code>. You may also use <code>NSDictionary</code> in Objective-C or <code>Dictionary</code> in Swift and cast to <code>CFDictionary</code>.</p> <p>We need a class key:</p> <h3 id="swift-12"><a href="#swift-12" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span> <span class="token punctuation">:</span> <span class="token class-name">AnyObject</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecClass</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kSecClassGenericPassword</span>

</code></pre></div><p>Next, we can specify attributes to narrow down our search:</p> <h3 id="swift-13"><a href="#swift-13" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token comment">// Label</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrLabel</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;com.me.myapp.myaccountpassword&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
<span class="token comment">// Username</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrAccount</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;My Name&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
<span class="token comment">// Service name</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrService</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;MyService&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>

</code></pre></div><p>We can also specify special search modifier keys described <a href="https://developer.apple.com/reference/security/1658642-keychain_services/1663699-search_attribute_keys" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Finally, we need to say how we'd like our data returned. Below, we'll request that just the private password itself be returned as a <code>CFData</code> object:</p> <h3 id="swift-14"><a href="#swift-14" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code>dict<span class="token punctuation">[</span><span class="token constant">kSecReturnData</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kCFBooleanTrue</span>

</code></pre></div><p>Now, let's search:</p> <h3 id="swift-15"><a href="#swift-15" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> queryResult<span class="token punctuation">:</span> <span class="token class-name">AnyObject</span><span class="token operator">?</span>
<span class="token keyword">let</span> status <span class="token operator">=</span> <span class="token function">withUnsafeMutablePointer</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> <span class="token operator">&amp;</span>queryResult<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">SecItemCopyMatching</span><span class="token punctuation">(</span>dict <span class="token keyword">as</span> <span class="token class-name">CFDictionary</span><span class="token punctuation">,</span> <span class="token class-name">UnsafeMutablePointer</span><span class="token punctuation">(</span><span class="token short-argument">$0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// Don't keep this in memory for long!!</span>
<span class="token keyword">let</span> password <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> queryResult <span class="token keyword">as</span><span class="token operator">!</span> <span class="token class-name">Data</span><span class="token punctuation">,</span> encoding<span class="token punctuation">:</span> <span class="token punctuation">.</span>utf8<span class="token punctuation">)</span><span class="token operator">!</span>

</code></pre></div><p>Here, <code>SecItemCopyMatching</code> takes in a query dictionary and a pointer to where you'd like the result to go. It returns an <code>OSStatus</code> with a result codes. <a href="https://developer.apple.com/reference/security/1658642-keychain_services#1662444" target="_blank" rel="noopener noreferrer">Here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> are the possibilities.</p> <h2 id="updating-a-password-in-the-keychain"><a href="#updating-a-password-in-the-keychain" class="header-anchor">#</a> Updating a Password in the Keychain</h2> <p>As usual, we first need a <code>CFDictionary</code> to represent the item we want to update. This must contain all of the old values for the item, including the old private data. Then it takes a <code>CFDictionary</code> of any attributes or the data itself that you would like to change.</p> <p>So first, let's construct a class key and a list of attributes. These attributes can narrow our search but you must include any attributes and there old values if you will be changing them.</p> <h3 id="swift-16"><a href="#swift-16" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span> <span class="token punctuation">:</span> <span class="token class-name">AnyObject</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecClass</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kSecClassGenericPassword</span>
<span class="token comment">// Label</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrLabel</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;com.me.myapp.myaccountpassword&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
<span class="token comment">// Username</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrAccount</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;My Name&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>

</code></pre></div><p>Now we must add the old data:</p> <h3 id="swift-17"><a href="#swift-17" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code>dict<span class="token punctuation">[</span><span class="token constant">kSecValueData</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;my_password!!&quot;</span></span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>using<span class="token punctuation">:</span> <span class="token punctuation">.</span>utf8<span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token class-name">CFData</span>

</code></pre></div><p>Now let's create the same attributes but a different password:</p> <h3 id="swift-18"><a href="#swift-18" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> newDict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span> <span class="token punctuation">:</span> <span class="token class-name">AnyObject</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
newDict<span class="token punctuation">[</span><span class="token constant">kSecClass</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kSecClassGenericPassword</span>
<span class="token comment">// Label</span>
newDict<span class="token punctuation">[</span><span class="token constant">kSecAttrLabel</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;com.me.myapp.myaccountpassword&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
<span class="token comment">// Username</span>
newDict<span class="token punctuation">[</span><span class="token constant">kSecAttrAccount</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;My Name&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
<span class="token comment">// New password</span>
newDict<span class="token punctuation">[</span><span class="token constant">kSecValueData</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;new_password!!&quot;</span></span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>using<span class="token punctuation">:</span> <span class="token punctuation">.</span>utf8<span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">!</span> <span class="token class-name">CFData</span>

</code></pre></div><p>Now, we just pass it to Keychain Services:</p> <h3 id="swift-19"><a href="#swift-19" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> status <span class="token operator">=</span> <span class="token class-name">SecItemUpdate</span><span class="token punctuation">(</span>dict <span class="token keyword">as</span> <span class="token class-name">CFDictionary</span><span class="token punctuation">,</span> newDict <span class="token keyword">as</span> <span class="token class-name">CFDictionary</span><span class="token punctuation">)</span>

</code></pre></div><p><code>SecItemUpdate</code> returns a status code. Results are described <a href="https://developer.apple.com/reference/security/1658642-keychain_services#1662444" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="removing-a-password-from-the-keychain"><a href="#removing-a-password-from-the-keychain" class="header-anchor">#</a> Removing a Password from the Keychain</h2> <p>We need only one thing in order to delete an item from the Keychain: a <code>CFDictionary</code> with attributes describing the items to be deleted. Any items that match the query dictionary will be deleted permanently, so if you are only intending to delete a single item be sure to be specific with your query. As always, we can use an <code>NSDictionary</code> in Objective-C or in Swift we can use a <code>Dictionary</code> and then cast to <code>CFDictionary</code>.</p> <p>A query dictionary, in this context exclusively includes a class key to describe what the item is and attributes to describe information about the item. Inclusion of search restrictions such as <code>kSecMatchCaseInsensitive</code> is not allowed.</p> <h3 id="swift-20"><a href="#swift-20" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span> <span class="token punctuation">:</span> <span class="token class-name">AnyObject</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecClass</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">kSecClassGenericPassword</span>
<span class="token comment">// Label</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrLabel</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;com.me.myapp.myaccountpassword&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>
<span class="token comment">// Username</span>
dict<span class="token punctuation">[</span><span class="token constant">kSecAttrAccount</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;My Name&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">CFString</span>

</code></pre></div><p>And now we can simply remove it:</p> <h3 id="swift-21"><a href="#swift-21" class="header-anchor">#</a> Swift</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> status <span class="token operator">=</span> <span class="token class-name">SecItemDelete</span><span class="token punctuation">(</span>dict <span class="token keyword">as</span> <span class="token class-name">CFDictionary</span><span class="token punctuation">)</span>

</code></pre></div><p><code>SecItemDelete</code> returns an <code>OSStatus</code>. Result codes are described <a href="https://developer.apple.com/reference/security/1658642-keychain_services#1662444" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="keychain-add-update-remove-and-find-operations-using-one-file"><a href="#keychain-add-update-remove-and-find-operations-using-one-file" class="header-anchor">#</a> Keychain Add, Update, Remove and Find operations using one file.</h2> <p><strong>Keychain.h</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token other-directive property">#import</span> <span class="token operator">&lt;</span><span class="token class-name">Foundation</span><span class="token operator">/</span><span class="token class-name">Foundation</span><span class="token punctuation">.</span>h<span class="token operator">&gt;</span>
typedef <span class="token function">void</span> <span class="token punctuation">(</span><span class="token operator">^</span><span class="token class-name">KeychainOperationBlock</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">BOOL</span> successfulOperation<span class="token punctuation">,</span> <span class="token class-name">NSData</span> <span class="token operator">*</span>data<span class="token punctuation">,</span> <span class="token class-name">OSStatus</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token attribute atrule">@interface</span> <span class="token class-name">Keychain</span> <span class="token punctuation">:</span> <span class="token class-name">NSObject</span>

<span class="token operator">-</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> initWithService<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> service_ withGroup<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span><span class="token operator">*</span><span class="token punctuation">)</span>group_<span class="token punctuation">;</span>

<span class="token operator">-</span><span class="token punctuation">(</span>void<span class="token punctuation">)</span>insertKey<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>key withData<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSData</span> <span class="token operator">*</span><span class="token punctuation">)</span>data withCompletion<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">KeychainOperationBlock</span><span class="token punctuation">)</span>completionBlock<span class="token punctuation">;</span>
<span class="token operator">-</span><span class="token punctuation">(</span>void<span class="token punctuation">)</span>updateKey<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span><span class="token operator">*</span><span class="token punctuation">)</span>key withData<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSData</span><span class="token operator">*</span><span class="token punctuation">)</span> data withCompletion<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">KeychainOperationBlock</span><span class="token punctuation">)</span>completionBlock<span class="token punctuation">;</span>
<span class="token operator">-</span><span class="token punctuation">(</span>void<span class="token punctuation">)</span>removeDataForKey<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span><span class="token operator">*</span><span class="token punctuation">)</span>key withCompletionBlock<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">KeychainOperationBlock</span><span class="token punctuation">)</span>completionBlock<span class="token punctuation">;</span>
<span class="token operator">-</span><span class="token punctuation">(</span>void<span class="token punctuation">)</span>findDataForKey<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span><span class="token operator">*</span><span class="token punctuation">)</span>key withCompletionBlock<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">KeychainOperationBlock</span><span class="token punctuation">)</span>completionBlock<span class="token punctuation">;</span>

<span class="token attribute atrule">@end</span>

</code></pre></div><p>Keychain.m</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token other-directive property">#import</span> <span class="token string-literal"><span class="token string">&quot;Keychain.h&quot;</span></span>
<span class="token other-directive property">#import</span> <span class="token operator">&lt;</span><span class="token class-name">Security</span><span class="token operator">/</span><span class="token class-name">Security</span><span class="token punctuation">.</span>h<span class="token operator">&gt;</span>

<span class="token attribute atrule">@implementation</span> <span class="token class-name">Keychain</span>

<span class="token punctuation">{</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span> keychainService<span class="token punctuation">;</span>
    <span class="token class-name">NSString</span> <span class="token operator">*</span> keychainGroup<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> initWithService<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>service withGroup<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span><span class="token operator">*</span><span class="token punctuation">)</span>group
<span class="token punctuation">{</span>
    <span class="token keyword">self</span> <span class="token operator">=</span><span class="token punctuation">[</span><span class="token keyword">super</span> <span class="token keyword">init</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        keychainService <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithString<span class="token punctuation">:</span>service<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            keychainGroup <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">NSString</span> stringWithString<span class="token punctuation">:</span>group<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span>  <span class="token keyword">self</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span>void<span class="token punctuation">)</span>insertKey<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>key
        withData<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSData</span> <span class="token operator">*</span><span class="token punctuation">)</span>data
  withCompletion<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">KeychainOperationBlock</span><span class="token punctuation">)</span>completionBlock
<span class="token punctuation">{</span>
    <span class="token class-name">NSMutableDictionary</span> <span class="token operator">*</span> dict <span class="token operator">=</span><span class="token punctuation">[</span><span class="token keyword">self</span> prepareDict<span class="token punctuation">:</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span>data forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecValueData</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span>keychainService forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token constant">kSecAttrService</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token class-name">OSStatus</span> status <span class="token operator">=</span> <span class="token class-name">SecItemAdd</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__bridge <span class="token class-name">CFDictionaryRef</span><span class="token punctuation">)</span>dict<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>errSecSuccess <span class="token operator">!=</span> status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DLog</span><span class="token punctuation">(</span>@<span class="token string-literal"><span class="token string">&quot;Unable add item with key =%@ error:%d&quot;</span></span><span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">(</span>int<span class="token punctuation">)</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>completionBlock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">completionBlock</span><span class="token punctuation">(</span>errSecSuccess <span class="token operator">==</span> status<span class="token punctuation">,</span> <span class="token nil constant">nil</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> errSecDuplicateItem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token keyword">self</span> updateKey<span class="token punctuation">:</span>key withData<span class="token punctuation">:</span>data withCompletion<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token constant">BOOL</span> successfulOperation<span class="token punctuation">,</span> <span class="token class-name">NSData</span> <span class="token operator">*</span>updateData<span class="token punctuation">,</span> <span class="token class-name">OSStatus</span> updateStatus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>completionBlock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">completionBlock</span><span class="token punctuation">(</span>successfulOperation<span class="token punctuation">,</span> updateData<span class="token punctuation">,</span> updateStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">DLog</span><span class="token punctuation">(</span>@<span class="token string-literal"><span class="token string">&quot;Found duplication item -- updating key with data&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span>void<span class="token punctuation">)</span>findDataForKey<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>key
  withCompletionBlock<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">KeychainOperationBlock</span><span class="token punctuation">)</span>completionBlock
<span class="token punctuation">{</span>
    <span class="token class-name">NSMutableDictionary</span> <span class="token operator">*</span>dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span> prepareDict<span class="token punctuation">:</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecMatchLimitOne</span> forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecMatchLimit</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span>keychainService forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token constant">kSecAttrService</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token constant">kCFBooleanTrue</span> forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecReturnData</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">CFTypeRef</span> result <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token class-name">OSStatus</span> status <span class="token operator">=</span> <span class="token class-name">SecItemCopyMatching</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__bridge <span class="token class-name">CFDictionaryRef</span><span class="token punctuation">)</span>dict<span class="token punctuation">,</span><span class="token operator">&amp;</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span> status <span class="token operator">!=</span> errSecSuccess<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DLog</span><span class="token punctuation">(</span>@<span class="token string-literal"><span class="token string">&quot;Unable to fetch item for key %@ with error:%d&quot;</span></span><span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">(</span>int<span class="token punctuation">)</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>completionBlock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">completionBlock</span><span class="token punctuation">(</span>errSecSuccess <span class="token operator">==</span> status<span class="token punctuation">,</span> <span class="token nil constant">nil</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>completionBlock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">completionBlock</span><span class="token punctuation">(</span>errSecSuccess <span class="token operator">==</span> status<span class="token punctuation">,</span> <span class="token punctuation">(</span>__bridge <span class="token class-name">NSData</span> <span class="token operator">*</span><span class="token punctuation">)</span>result<span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span>void<span class="token punctuation">)</span>updateKey<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>key
        withData<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSData</span> <span class="token operator">*</span><span class="token punctuation">)</span>data
  withCompletion<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">KeychainOperationBlock</span><span class="token punctuation">)</span>completionBlock
<span class="token punctuation">{</span>
    <span class="token class-name">NSMutableDictionary</span> <span class="token operator">*</span> dictKey <span class="token operator">=</span><span class="token punctuation">[</span><span class="token keyword">self</span> prepareDict<span class="token punctuation">:</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token class-name">NSMutableDictionary</span> <span class="token operator">*</span> dictUpdate <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSMutableDictionary</span> alloc<span class="token punctuation">]</span> <span class="token keyword">init</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dictUpdate setObject<span class="token punctuation">:</span>data forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecValueData</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dictUpdate setObject<span class="token punctuation">:</span>keychainService forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token constant">kSecAttrService</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">OSStatus</span> status <span class="token operator">=</span> <span class="token class-name">SecItemUpdate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__bridge <span class="token class-name">CFDictionaryRef</span><span class="token punctuation">)</span>dictKey<span class="token punctuation">,</span> <span class="token punctuation">(</span>__bridge <span class="token class-name">CFDictionaryRef</span><span class="token punctuation">)</span>dictUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> status <span class="token operator">!=</span> errSecSuccess<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DLog</span><span class="token punctuation">(</span>@<span class="token string-literal"><span class="token string">&quot;Unable to remove item for key %@ with error:%d&quot;</span></span><span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">(</span>int<span class="token punctuation">)</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>completionBlock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">completionBlock</span><span class="token punctuation">(</span>errSecSuccess <span class="token operator">==</span> status<span class="token punctuation">,</span> <span class="token nil constant">nil</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span><span class="token punctuation">(</span>void<span class="token punctuation">)</span>removeDataForKey<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>key
    withCompletionBlock<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">KeychainOperationBlock</span><span class="token punctuation">)</span>completionBlock <span class="token punctuation">{</span>
    <span class="token class-name">NSMutableDictionary</span> <span class="token operator">*</span>dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span> prepareDict<span class="token punctuation">:</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">OSStatus</span> status <span class="token operator">=</span> <span class="token class-name">SecItemDelete</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__bridge <span class="token class-name">CFDictionaryRef</span><span class="token punctuation">)</span>dict<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> status <span class="token operator">!=</span> errSecSuccess<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DLog</span><span class="token punctuation">(</span>@<span class="token string-literal"><span class="token string">&quot;Unable to remove item for key %@ with error:%d&quot;</span></span><span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">(</span>int<span class="token punctuation">)</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>completionBlock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">completionBlock</span><span class="token punctuation">(</span>errSecSuccess <span class="token operator">==</span> status<span class="token punctuation">,</span> <span class="token nil constant">nil</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token other-directive property">#pragma</span> mark <span class="token class-name">Internal</span> methods

<span class="token operator">-</span><span class="token punctuation">(</span><span class="token class-name">NSMutableDictionary</span><span class="token operator">*</span><span class="token punctuation">)</span> prepareDict<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token class-name">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span> key <span class="token punctuation">{</span>
    
    <span class="token class-name">NSMutableDictionary</span> <span class="token operator">*</span>dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">NSMutableDictionary</span> alloc<span class="token punctuation">]</span> <span class="token keyword">init</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecClassGenericPassword</span> forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecClass</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token class-name">NSData</span> <span class="token operator">*</span>encodedKey <span class="token operator">=</span> <span class="token punctuation">[</span>key dataUsingEncoding<span class="token punctuation">:</span><span class="token class-name">NSUTF8StringEncoding</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span>encodedKey forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecAttrGeneric</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span>encodedKey forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecAttrAccount</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span>keychainService forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecAttrService</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecAttrAccessibleAlwaysThisDeviceOnly</span> forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecAttrAccessible</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token comment">//This is for sharing data across apps</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>keychainGroup <span class="token operator">!=</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span>dict setObject<span class="token punctuation">:</span>keychainGroup forKey<span class="token punctuation">:</span><span class="token punctuation">(</span>__bridge id<span class="token punctuation">)</span><span class="token constant">kSecAttrAccessGroup</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span>  dict<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token attribute atrule">@end</span>

</code></pre></div><h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li>kSecClassGenericPassword // A value key representing a non-internet password</li> <li>kSecClassInternetPassword // A value key representing an internet password</li> <li>kSecClassCertificate // A value key representing a certificate</li> <li>kSecClassCertificate // A value key representing a key</li> <li>kSecClassIdentity // A value key representing an identity, which is a certificate plus a key</li></ul> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>iOS stores private information such as passwords, encryption keys, certificates, and identities in a secure storage area called the Keychain. This storage area is managed completely by a co-processor called the Secure Enclave, which is embedded inside the application processor. Because the Keychain is sandboxed on iOS, keychain items may only be retrieved by the application that put them there in the first place.</p> <p>In some cases you must turn on Keychain Sharing in Xcode capabilities in order to avoid errors.</p> <p>In order to interact with the keychain, we use a c framework called Keychain Services. For more information, see <a href="https://developer.apple.com/library/content/documentation/Security/Conceptual/keychainServConcepts/01introduction/introduction.html#//apple_ref/doc/uid/TP30000897" target="_blank" rel="noopener noreferrer">Apple's Keychain Services Programming Guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Because Keychain Services is below the <code>Foundation</code> level, it is restricted to using <code>CoreFoundation</code> types. As a result, most objects are internally represented as <code>CFDictionary</code>s holding <code>CFString</code>s as their keys and a variety of <code>CoreFoundation</code> types as their values.</p> <p>While Keychain Services is included as a part of the <code>Security</code> framework, importing <code>Foundation</code> is usually a good option since it includes some helper functions in the backend.</p> <p>Additionally, if you don't want to deal with Keychain Services directly, Apple provides the <a href="https://developer.apple.com/library/content/samplecode/GenericKeychain/Introduction/Intro.html#//apple_ref/doc/uid/DTS40007797" target="_blank" rel="noopener noreferrer">Generic Keychain<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> Swift sample project that provides Swift types that use Keychain Services behind the scenes.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/ios/keychain.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/ios/gamecenter-leaderboards.html" class="prev">
        GameCenter Leaderboards
      </a></span> <span class="next"><a href="/ios/handle-multiple-environment-using-macro.html">
        Handle Multiple Environment using Macro
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/1397.a92376bb.js" defer></script>
  </body>
</html>
