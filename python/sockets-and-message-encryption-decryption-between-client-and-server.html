<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Python - Sockets And Message Encryption/Decryption Between Client and Server</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Server side Implementation, Client side Implementation">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Python - Sockets And Message Encryption/Decryption Between Client and Server">
    <meta property="og:description" content="Server side Implementation, Client side Implementation">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/python/sockets-and-message-encryption-decryption-between-client-and-server.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Python - Sockets And Message Encryption/Decryption Between Client and Server">
    <meta name="twitter:description" content="Server side Implementation, Client side Implementation">
    <meta name="twitter:url" content="/python/sockets-and-message-encryption-decryption-between-client-and-server.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2808.c0878789.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Python</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/python/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/python/getting-started-with-python-language.html" class="sidebar-link">Getting started with Python Language</a></li><li><a href="/python/python-data-types.html" class="sidebar-link">Python Data Types</a></li><li><a href="/python/indentation.html" class="sidebar-link">Indentation</a></li><li><a href="/python/comments-and-documentation.html" class="sidebar-link">Comments and Documentation</a></li><li><a href="/python/date-and-time.html" class="sidebar-link">Date and Time</a></li><li><a href="/python/enum.html" class="sidebar-link">Enum</a></li><li><a href="/python/set.html" class="sidebar-link">Set</a></li><li><a href="/python/simple-mathematical-operators.html" class="sidebar-link">Simple Mathematical Operators</a></li><li><a href="/python/bitwise-operators.html" class="sidebar-link">Bitwise Operators</a></li><li><a href="/python/boolean-operators.html" class="sidebar-link">Boolean Operators</a></li><li><a href="/python/operator-precedence.html" class="sidebar-link">Operator Precedence</a></li><li><a href="/python/variable-scope-and-binding.html" class="sidebar-link">Variable Scope and Binding</a></li><li><a href="/python/conditionals.html" class="sidebar-link">Conditionals</a></li><li><a href="/python/comparisons.html" class="sidebar-link">Comparisons</a></li><li><a href="/python/loops.html" class="sidebar-link">Loops</a></li><li><a href="/python/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/python/multidimensional-arrays.html" class="sidebar-link">Multidimensional arrays</a></li><li><a href="/python/dictionary.html" class="sidebar-link">Dictionary</a></li><li><a href="/python/list.html" class="sidebar-link">List</a></li><li><a href="/python/list-comprehensions.html" class="sidebar-link">List Comprehensions</a></li><li><a href="/python/list-slicing-selecting-parts-of-lists.html" class="sidebar-link">List slicing (selecting parts of lists)</a></li><li><a href="/python/groupby.html" class="sidebar-link">groupby()</a></li><li><a href="/python/linked-lists.html" class="sidebar-link">Linked lists</a></li><li><a href="/python/linked-list-node.html" class="sidebar-link">Linked List Node</a></li><li><a href="/python/filter.html" class="sidebar-link">Filter</a></li><li><a href="/python/heapq.html" class="sidebar-link">Heapq</a></li><li><a href="/python/tuple.html" class="sidebar-link">Tuple</a></li><li><a href="/python/basic-input-and-output.html" class="sidebar-link">Basic Input and Output</a></li><li><a href="/python/files-folders-i-o.html" class="sidebar-link">Files &amp; Folders I/O</a></li><li><a href="/python/os-path.html" class="sidebar-link">os.path</a></li><li><a href="/python/iterables-and-iterators.html" class="sidebar-link">Iterables and Iterators</a></li><li><a href="/python/functions.html" class="sidebar-link">Functions</a></li><li><a href="/python/defining-functions-with-list-arguments.html" class="sidebar-link">Defining functions with list arguments</a></li><li><a href="/python/functional-programming-in-python.html" class="sidebar-link">Functional Programming in Python</a></li><li><a href="/python/partial-functions.html" class="sidebar-link">Partial functions</a></li><li><a href="/python/decorators.html" class="sidebar-link">Decorators</a></li><li><a href="/python/classes.html" class="sidebar-link">Classes</a></li><li><a href="/python/metaclasses.html" class="sidebar-link">Metaclasses</a></li><li><a href="/python/string-formatting.html" class="sidebar-link">String Formatting</a></li><li><a href="/python/string-methods.html" class="sidebar-link">String Methods</a></li><li><a href="/python/using-loops-within-functions.html" class="sidebar-link">Using loops within functions</a></li><li><a href="/python/importing-modules.html" class="sidebar-link">Importing modules</a></li><li><a href="/python/difference-between-module-and-package.html" class="sidebar-link">Difference between Module and Package</a></li><li><a href="/python/math-module.html" class="sidebar-link">Math Module</a></li><li><a href="/python/complex-math.html" class="sidebar-link">Complex math</a></li><li><a href="/python/collections-module.html" class="sidebar-link">Collections module</a></li><li><a href="/python/operator-module.html" class="sidebar-link">Operator module</a></li><li><a href="/python/json-module.html" class="sidebar-link">JSON Module</a></li><li><a href="/python/sqlite3-module.html" class="sidebar-link">Sqlite3 Module</a></li><li><a href="/python/the-os-module.html" class="sidebar-link">The os Module</a></li><li><a href="/python/the-locale-module.html" class="sidebar-link">The locale Module</a></li><li><a href="/python/itertools-module.html" class="sidebar-link">Itertools Module</a></li><li><a href="/python/asyncio-module.html" class="sidebar-link">Asyncio Module</a></li><li><a href="/python/random-module.html" class="sidebar-link">Random module</a></li><li><a href="/python/functools-module.html" class="sidebar-link">Functools Module</a></li><li><a href="/python/the-dis-module.html" class="sidebar-link">The dis module</a></li><li><a href="/python/the-base64-module.html" class="sidebar-link">The base64 Module</a></li><li><a href="/python/queue-module.html" class="sidebar-link">Queue Module</a></li><li><a href="/python/deque-module.html" class="sidebar-link">Deque Module</a></li><li><a href="/python/webbrowser-module.html" class="sidebar-link">Webbrowser Module</a></li><li><a href="/python/tkinter.html" class="sidebar-link">tkinter</a></li><li><a href="/python/pyautogui-module.html" class="sidebar-link">pyautogui module</a></li><li><a href="/python/indexing-and-slicing.html" class="sidebar-link">Indexing and Slicing</a></li><li><a href="/python/plotting-with-matplotlib.html" class="sidebar-link">Plotting with Matplotlib</a></li><li><a href="/python/graph-tool.html" class="sidebar-link">graph-tool</a></li><li><a href="/python/generators.html" class="sidebar-link">Generators</a></li><li><a href="/python/reduce.html" class="sidebar-link">Reduce</a></li><li><a href="/python/map-function.html" class="sidebar-link">Map Function</a></li><li><a href="/python/exponentiation.html" class="sidebar-link">Exponentiation</a></li><li><a href="/python/searching.html" class="sidebar-link">Searching</a></li><li><a href="/python/sorting-minimum-and-maximum.html" class="sidebar-link">Sorting, Minimum and Maximum</a></li><li><a href="/python/counting.html" class="sidebar-link">Counting</a></li><li><a href="/python/the-print-function.html" class="sidebar-link">The Print Function</a></li><li><a href="/python/regular-expressions-regex.html" class="sidebar-link">Regular Expressions (Regex)</a></li><li><a href="/python/copying-data.html" class="sidebar-link">Copying data</a></li><li><a href="/python/context-managers-with-statement.html" class="sidebar-link">Context Managers (“with” Statement)</a></li><li><a href="/python/the-name-special-variable.html" class="sidebar-link">The _name_ special variable</a></li><li><a href="/python/checking-path-existence-and-permissions.html" class="sidebar-link">Checking Path Existence and Permissions</a></li><li><a href="/python/creating-python-packages.html" class="sidebar-link">Creating Python packages</a></li><li><a href="/python/usage-of-pip-module-pypi-package-manager.html" class="sidebar-link">Usage of &quot;pip&quot; module: PyPI Package Manager</a></li><li><a href="/python/pip-pypi-package-manager.html" class="sidebar-link">pip: PyPI Package Manager</a></li><li><a href="/python/parsing-command-line-arguments.html" class="sidebar-link">Parsing Command Line arguments</a></li><li><a href="/python/subprocess-library.html" class="sidebar-link">Subprocess Library</a></li><li><a href="/python/setup-py.html" class="sidebar-link">setup.py</a></li><li><a href="/python/recursion.html" class="sidebar-link">Recursion</a></li><li><a href="/python/type-hints.html" class="sidebar-link">Type Hints</a></li><li><a href="/python/exceptions.html" class="sidebar-link">Exceptions</a></li><li><a href="/python/raise-custom-errors-exceptions.html" class="sidebar-link">Raise Custom Errors / Exceptions</a></li><li><a href="/python/commonwealth-exceptions.html" class="sidebar-link">Commonwealth Exceptions</a></li><li><a href="/python/urllib.html" class="sidebar-link">urllib</a></li><li><a href="/python/web-scraping-with-python.html" class="sidebar-link">Web scraping with Python</a></li><li><a href="/python/html-parsing.html" class="sidebar-link">HTML Parsing</a></li><li><a href="/python/manipulating-xml.html" class="sidebar-link">Manipulating XML</a></li><li><a href="/python/python-requests-post.html" class="sidebar-link">Python Requests Post</a></li><li><a href="/python/distribution.html" class="sidebar-link">Distribution</a></li><li><a href="/python/property-objects.html" class="sidebar-link">Property Objects</a></li><li><a href="/python/overloading.html" class="sidebar-link">Overloading</a></li><li><a href="/python/polymorphism.html" class="sidebar-link">Polymorphism</a></li><li><a href="/python/method-overriding.html" class="sidebar-link">Method Overriding</a></li><li><a href="/python/user-defined-methods.html" class="sidebar-link">User-Defined Methods</a></li><li><a href="/python/string-representations-of-class-instances-str-and-repr-methods.html" class="sidebar-link">String representations of class instances: _str and repr_ methods</a></li><li><a href="/python/debugging.html" class="sidebar-link">Debugging</a></li><li><a href="/python/reading-and-writing-csv.html" class="sidebar-link">Reading and Writing CSV</a></li><li><a href="/python/writing-to-csv-from-string-or-list.html" class="sidebar-link">Writing to CSV from String or List</a></li><li><a href="/python/dynamic-code-execution-with-exec-and-eval.html" class="sidebar-link">Dynamic code execution with exec and eval</a></li><li><a href="/python/pyinstaller-distributing-python-code.html" class="sidebar-link">PyInstaller - Distributing Python Code</a></li><li><a href="/python/data-visualization-with-python.html" class="sidebar-link">Data Visualization with Python</a></li><li><a href="/python/the-interpreter-command-line-console.html" class="sidebar-link">The Interpreter (Command Line Console)</a></li><li><a href="/python/args-and-kwargs.html" class="sidebar-link">args and *kwargs</a></li><li><a href="/python/garbage-collection.html" class="sidebar-link">Garbage Collection</a></li><li><a href="/python/pickle-data-serialisation.html" class="sidebar-link">Pickle data serialisation</a></li><li><a href="/python/binary-data.html" class="sidebar-link">Binary Data</a></li><li><a href="/python/idioms.html" class="sidebar-link">Idioms</a></li><li><a href="/python/data-serialization.html" class="sidebar-link">Data Serialization</a></li><li><a href="/python/multiprocessing.html" class="sidebar-link">Multiprocessing</a></li><li><a href="/python/multithreading.html" class="sidebar-link">Multithreading</a></li><li><a href="/python/processes-and-threads.html" class="sidebar-link">Processes and Threads</a></li><li><a href="/python/python-concurrency.html" class="sidebar-link">Python concurrency</a></li><li><a href="/python/parallel-computation.html" class="sidebar-link">Parallel computation</a></li><li><a href="/python/sockets.html" class="sidebar-link">Sockets</a></li><li><a href="/python/websockets.html" class="sidebar-link">Websockets</a></li><li><a href="/python/sockets-and-message-encryption-decryption-between-client-and-server.html" aria-current="page" class="active sidebar-link">Sockets And Message Encryption/Decryption Between Client and Server</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/python/sockets-and-message-encryption-decryption-between-client-and-server.html#server-side-implementation" class="sidebar-link">Server side Implementation</a></li><li class="sidebar-sub-header"><a href="/python/sockets-and-message-encryption-decryption-between-client-and-server.html#client-side-implementation" class="sidebar-link">Client side Implementation</a></li></ul></li><li><a href="/python/python-networking.html" class="sidebar-link">Python Networking</a></li><li><a href="/python/python-http-server.html" class="sidebar-link">Python HTTP Server</a></li><li><a href="/python/flask.html" class="sidebar-link">Flask</a></li><li><a href="/python/introduction-to-rabbitmq-using-amqpstorm.html" class="sidebar-link">Introduction to RabbitMQ using AMQPStorm</a></li><li><a href="/python/descriptor.html" class="sidebar-link">Descriptor</a></li><li><a href="/python/tempfile-namedtemporaryfile.html" class="sidebar-link">tempfile NamedTemporaryFile</a></li><li><a href="/python/input-subset-and-output-external-data-files-using-pandas.html" class="sidebar-link">Input, Subset and Output External Data Files using Pandas</a></li><li><a href="/python/unzipping-files.html" class="sidebar-link">Unzipping Files</a></li><li><a href="/python/working-with-zip-archives.html" class="sidebar-link">Working with ZIP archives</a></li><li><a href="/python/getting-start-with-gzip.html" class="sidebar-link">getting start with GZip</a></li><li><a href="/python/stack.html" class="sidebar-link">Stack</a></li><li><a href="/python/working-around-the-global-interpreter-lock-gil.html" class="sidebar-link">Working around the Global Interpreter Lock (GIL)</a></li><li><a href="/python/deployment.html" class="sidebar-link">Deployment</a></li><li><a href="/python/logging.html" class="sidebar-link">Logging</a></li><li><a href="/python/web-server-gateway-interface-wsgi.html" class="sidebar-link">Web Server Gateway Interface (WSGI)</a></li><li><a href="/python/python-server-sent-events.html" class="sidebar-link">Python Server Sent Events</a></li><li><a href="/python/alternatives-to-switch-statement-from-other-languages.html" class="sidebar-link">Alternatives to switch statement from other languages</a></li><li><a href="/python/list-destructuring-aka-packing-and-unpacking.html" class="sidebar-link">List destructuring (aka packing and unpacking)</a></li><li><a href="/python/accessing-python-source-code-and-bytecode.html" class="sidebar-link">Accessing Python source code and bytecode</a></li><li><a href="/python/mixins.html" class="sidebar-link">Mixins</a></li><li><a href="/python/attribute-access.html" class="sidebar-link">Attribute Access</a></li><li><a href="/python/arcpy.html" class="sidebar-link">ArcPy</a></li><li><a href="/python/abstract-base-classes-abc.html" class="sidebar-link">Abstract Base Classes (abc)</a></li><li><a href="/python/plugin-and-extension-classes.html" class="sidebar-link">Plugin and Extension Classes</a></li><li><a href="/python/immutable-datatypes-int-float-str-tuple-and-frozensets.html" class="sidebar-link">Immutable datatypes(int, float, str, tuple and frozensets)</a></li><li><a href="/python/incompatibilities-moving-from-python-2-to-python-3.html" class="sidebar-link">Incompatibilities moving from Python 2 to Python 3</a></li><li><a href="/python/2to3-tool.html" class="sidebar-link">2to3 tool</a></li><li><a href="/python/non-official-python-implementations.html" class="sidebar-link">Non-official Python implementations</a></li><li><a href="/python/abstract-syntax-tree.html" class="sidebar-link">Abstract syntax tree</a></li><li><a href="/python/unicode-and-bytes.html" class="sidebar-link">Unicode and bytes</a></li><li><a href="/python/python-serial-communication-pyserial.html" class="sidebar-link">Python Serial Communication (pyserial)</a></li><li><a href="/python/neo4j-and-cypher-using-py2neo.html" class="sidebar-link">Neo4j and Cypher using Py2Neo</a></li><li><a href="/python/basic-curses-with-python.html" class="sidebar-link">Basic Curses with Python</a></li><li><a href="/python/templates-in-python.html" class="sidebar-link">Templates in python</a></li><li><a href="/python/pillow.html" class="sidebar-link">Pillow</a></li><li><a href="/python/the-pass-statement.html" class="sidebar-link">The pass statement</a></li><li><a href="/python/cli-subcommands-with-precise-help-output.html" class="sidebar-link">CLI subcommands with precise help output</a></li><li><a href="/python/database-access.html" class="sidebar-link">Database Access</a></li><li><a href="/python/connecting-python-to-sql-server.html" class="sidebar-link">Connecting Python to SQL Server</a></li><li><a href="/python/postgresql.html" class="sidebar-link">PostgreSQL</a></li><li><a href="/python/python-and-excel.html" class="sidebar-link">Python and Excel</a></li><li><a href="/python/turtle-graphics.html" class="sidebar-link">Turtle Graphics</a></li><li><a href="/python/python-persistence.html" class="sidebar-link">Python Persistence</a></li><li><a href="/python/design-patterns.html" class="sidebar-link">Design Patterns</a></li><li><a href="/python/hashlib.html" class="sidebar-link">hashlib</a></li><li><a href="/python/creating-a-windows-service-using-python.html" class="sidebar-link">Creating a Windows service using Python</a></li><li><a href="/python/mutable-vs-immutable-and-hashable-in-python.html" class="sidebar-link">Mutable vs Immutable (and Hashable) in Python</a></li><li><a href="/python/configparser.html" class="sidebar-link">configparser</a></li><li><a href="/python/optical-character-recognition.html" class="sidebar-link">Optical Character Recognition</a></li><li><a href="/python/virtual-environments.html" class="sidebar-link">Virtual environments</a></li><li><a href="/python/python-virtual-environment-virtualenv.html" class="sidebar-link">Python Virtual Environment - virtualenv</a></li><li><a href="/python/virtual-environment-with-virtualenvwrapper.html" class="sidebar-link">virtual environment with virtualenvwrapper</a></li><li><a href="/python/create-virtual-environment-with-virtualenvwrapper-in-windows.html" class="sidebar-link">Create virtual environment with virtualenvwrapper in windows</a></li><li><a href="/python/sys.html" class="sidebar-link">sys</a></li><li><a href="/python/chempy-python-package.html" class="sidebar-link">ChemPy - python package</a></li><li><a href="/python/pygame.html" class="sidebar-link">pygame</a></li><li><a href="/python/pyglet.html" class="sidebar-link">Pyglet</a></li><li><a href="/python/audio.html" class="sidebar-link">Audio</a></li><li><a href="/python/pyaudio.html" class="sidebar-link">pyaudio</a></li><li><a href="/python/shelve.html" class="sidebar-link">shelve</a></li><li><a href="/python/iot-programming-with-python-and-raspberry-pi.html" class="sidebar-link">IoT Programming with Python and Raspberry PI</a></li><li><a href="/python/kivy-cross-platform-python-framework-for-nui-development.html" class="sidebar-link">kivy - Cross-platform Python Framework for NUI Development</a></li><li><a href="/python/pandas-transform-preform-operations-on-groups-and-concatenate-the-results.html" class="sidebar-link">Pandas Transform: Preform operations on groups and concatenate the results</a></li><li><a href="/python/similarities-in-syntax-differences-in-meaning-python-vs-javascript.html" class="sidebar-link">Similarities in syntax, Differences in meaning: Python vs. JavaScript</a></li><li><a href="/python/call-python-from-c.html" class="sidebar-link">Call Python from C#</a></li><li><a href="/python/ctypes.html" class="sidebar-link">ctypes</a></li><li><a href="/python/writing-extensions.html" class="sidebar-link">Writing extensions</a></li><li><a href="/python/python-lex-yacc.html" class="sidebar-link">Python Lex-Yacc</a></li><li><a href="/python/unit-testing.html" class="sidebar-link">Unit Testing</a></li><li><a href="/python/py-test.html" class="sidebar-link">py.test</a></li><li><a href="/python/profiling.html" class="sidebar-link">Profiling</a></li><li><a href="/python/python-speed-of-program.html" class="sidebar-link">Python speed of program</a></li><li><a href="/python/performance-optimization.html" class="sidebar-link">Performance optimization</a></li><li><a href="/python/security-and-cryptography.html" class="sidebar-link">Security and Cryptography</a></li><li><a href="/python/secure-shell-connection-in-python.html" class="sidebar-link">Secure Shell Connection in Python</a></li><li><a href="/python/python-anti-patterns.html" class="sidebar-link">Python Anti-Patterns</a></li><li><a href="/python/common-pitfalls.html" class="sidebar-link">Common Pitfalls</a></li><li><a href="/python/hidden-features.html" class="sidebar-link">Hidden Features</a></li><li><a href="/python/date-formatting.html" class="sidebar-link">Date Formatting</a></li><li><a href="/python/ijson.html" class="sidebar-link">ijson</a></li><li><a href="/python/django.html" class="sidebar-link">Django</a></li><li><a href="/python/code-blocks-execution-frames-and-namespaces.html" class="sidebar-link">Code blocks, execution frames, and namespaces</a></li><li><a href="/python/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sockets-and-message-encryption-decryption-between-client-and-server"><a href="#sockets-and-message-encryption-decryption-between-client-and-server" class="header-anchor">#</a> Sockets And Message Encryption/Decryption Between Client and Server</h1> <p>Cryptography is used for security purposes. There are not so many examples of Encryption/Decryption in Python using IDEA encryption MODE CTR. <strong>Aim of this documentation :</strong></p> <p>Extend and implement of the RSA Digital Signature scheme in station-to-station communication. Using Hashing for integrity of message, that is SHA-1. Produce simple Key Transport protocol. Encrypt Key with IDEA encryption. Mode of Block Cipher is Counter Mode</p> <h2 id="server-side-implementation"><a href="#server-side-implementation" class="header-anchor">#</a> Server side Implementation</h2> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">import</span> socket
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time
<span class="token keyword">import</span> itertools
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> Crypto<span class="token punctuation">.</span>Cipher<span class="token punctuation">.</span>AES <span class="token keyword">as</span> AES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> CryptoPlus<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> IDEA

<span class="token comment">#server address and port number input from admin</span>
host<span class="token operator">=</span> <span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token string">&quot;Server Address - &gt; &quot;</span><span class="token punctuation">)</span>
port <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;Port - &gt; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#boolean for checking server and port</span>
check <span class="token operator">=</span> <span class="token boolean">False</span>
done <span class="token operator">=</span> <span class="token boolean">False</span>

<span class="token keyword">def</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>cycle<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'....'</span><span class="token punctuation">,</span><span class="token string">'.......'</span><span class="token punctuation">,</span><span class="token string">'..........'</span><span class="token punctuation">,</span><span class="token string">'............'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> done<span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\rCHECKING IP ADDRESS AND NOT USED PORT '</span><span class="token operator">+</span>c<span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\r -----SERVER STARTED. WAITING FOR CLIENT-----\n'</span><span class="token punctuation">)</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment">#setting up socket</span>
    server <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
    server<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>
    server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    check <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">except</span> BaseException<span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">&quot;-----Check Server Address or Port-----&quot;</span>
    check <span class="token operator">=</span> <span class="token boolean">False</span>

<span class="token keyword">if</span> check <span class="token keyword">is</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token comment"># server Quit</span>
    shutdown <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token comment"># printing &quot;Server Started Message&quot;</span>
thread_load <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>animate<span class="token punctuation">)</span>
thread_load<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
done <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token comment">#binding client and address</span>
client<span class="token punctuation">,</span>address <span class="token operator">=</span> server<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;CLIENT IS CONNECTED. CLIENT'S ADDRESS -&gt;&quot;</span><span class="token punctuation">,</span>address<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n-----WAITING FOR PUBLIC KEY &amp; PUBLIC KEY HASH-----\n&quot;</span><span class="token punctuation">)</span>

<span class="token comment">#client's message(Public Key)</span>
getpbk <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>

<span class="token comment">#conversion of string to KEY</span>
server_public_key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>getpbk<span class="token punctuation">)</span>

<span class="token comment">#hashing the public key in server side for validating the hash from client</span>
hash_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span>getpbk<span class="token punctuation">)</span>
hex_digest <span class="token operator">=</span> hash_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> getpbk <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span>getpbk<span class="token punctuation">)</span>
    client<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">&quot;YES&quot;</span><span class="token punctuation">)</span>
    gethash <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n-----HASH OF PUBLIC KEY----- \n&quot;</span><span class="token operator">+</span>gethash<span class="token punctuation">)</span>
<span class="token keyword">if</span> hex_digest <span class="token operator">==</span> gethash<span class="token punctuation">:</span>
    <span class="token comment"># creating session key</span>
    key_128 <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token comment">#encrypt CTR MODE session key</span>
    en <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key_128<span class="token punctuation">,</span>AES<span class="token punctuation">.</span>MODE_CTR<span class="token punctuation">,</span>counter <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span>key_128<span class="token punctuation">)</span>
    encrypto <span class="token operator">=</span> en<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>key_128<span class="token punctuation">)</span>
    <span class="token comment">#hashing sha1</span>
    en_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span>encrypto<span class="token punctuation">)</span>
    en_digest <span class="token operator">=</span> en_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n-----SESSION KEY-----\n&quot;</span><span class="token operator">+</span>en_digest<span class="token punctuation">)</span>

    <span class="token comment">#encrypting session key and public key</span>
    E <span class="token operator">=</span> server_public_key<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>encrypto<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n-----ENCRYPTED PUBLIC KEY AND SESSION KEY-----\n&quot;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n-----HANDSHAKE COMPLETE-----&quot;</span><span class="token punctuation">)</span>
    client<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token comment">#message from client</span>
        newmess <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
        <span class="token comment">#decoding the message from HEXADECIMAL to decrypt the ecrypted version of the message only</span>
        decoded <span class="token operator">=</span> newmess<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;hex&quot;</span><span class="token punctuation">)</span>
        <span class="token comment">#making en_digest(session_key) as the key</span>
        key <span class="token operator">=</span> en_digest<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\nENCRYPTED MESSAGE FROM CLIENT -&gt; &quot;</span><span class="token operator">+</span>newmess<span class="token punctuation">)</span>
        <span class="token comment">#decrypting message from the client</span>
        ideaDecrypt <span class="token operator">=</span> IDEA<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> IDEA<span class="token punctuation">.</span>MODE_CTR<span class="token punctuation">,</span> counter<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> key<span class="token punctuation">)</span>
        dMsg <span class="token operator">=</span> ideaDecrypt<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>decoded<span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n**New Message**  &quot;</span><span class="token operator">+</span>time<span class="token punctuation">.</span>ctime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">&quot; &gt; &quot;</span><span class="token operator">+</span>dMsg<span class="token operator">+</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>
        mess <span class="token operator">=</span> <span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token string">&quot;\nMessage To Client -&gt; &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> mess <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
            ideaEncrypt <span class="token operator">=</span> IDEA<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> IDEA<span class="token punctuation">.</span>MODE_CTR<span class="token punctuation">,</span> counter<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> key<span class="token punctuation">)</span>
            eMsg <span class="token operator">=</span> ideaEncrypt<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>mess<span class="token punctuation">)</span>
            eMsg <span class="token operator">=</span> eMsg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&quot;hex&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> eMsg <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;ENCRYPTED MESSAGE TO CLIENT-&gt; &quot;</span> <span class="token operator">+</span> eMsg<span class="token punctuation">)</span>
            client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>eMsg<span class="token punctuation">)</span>
    client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n-----PUBLIC KEY HASH DOESNOT MATCH-----\n&quot;</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="client-side-implementation"><a href="#client-side-implementation" class="header-anchor">#</a> Client side Implementation</h2> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">import</span> time
<span class="token keyword">import</span> socket
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> itertools
<span class="token keyword">import</span> sys
<span class="token keyword">from</span> Crypto <span class="token keyword">import</span> Random
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> CryptoPlus<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> IDEA

<span class="token comment">#animating loading</span>
done <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token keyword">def</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>cycle<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'....'</span><span class="token punctuation">,</span><span class="token string">'.......'</span><span class="token punctuation">,</span><span class="token string">'..........'</span><span class="token punctuation">,</span><span class="token string">'............'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> done<span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\rCONFIRMING CONNECTION TO SERVER '</span><span class="token operator">+</span>c<span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>

<span class="token comment">#public key and private key</span>
random_generator <span class="token operator">=</span> Random<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read
key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>generate<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span>random_generator<span class="token punctuation">)</span>
public <span class="token operator">=</span> key<span class="token punctuation">.</span>publickey<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>exportKey<span class="token punctuation">(</span><span class="token punctuation">)</span>
private <span class="token operator">=</span> key<span class="token punctuation">.</span>exportKey<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#hashing the public key</span>
hash_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span>public<span class="token punctuation">)</span>
hex_digest <span class="token operator">=</span> hash_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#Setting up socket</span>
server <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>

<span class="token comment">#host and port input user</span>
host <span class="token operator">=</span> <span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token string">&quot;Server Address To Be Connected -&gt; &quot;</span><span class="token punctuation">)</span>
port <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;Port of The Server -&gt; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#binding the address and port</span>
server<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># printing &quot;Server Started Message&quot;</span>
thread_load <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>animate<span class="token punctuation">)</span>
thread_load<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
done <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>name<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mess <span class="token operator">=</span> <span class="token builtin">raw_input</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">&quot; : &quot;</span><span class="token punctuation">)</span>
    key <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>
    <span class="token comment">#merging the message and the name</span>
    whole <span class="token operator">=</span> name<span class="token operator">+</span><span class="token string">&quot; : &quot;</span><span class="token operator">+</span>mess
    ideaEncrypt <span class="token operator">=</span> IDEA<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> IDEA<span class="token punctuation">.</span>MODE_CTR<span class="token punctuation">,</span> counter<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> key<span class="token punctuation">)</span>
    eMsg <span class="token operator">=</span> ideaEncrypt<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>whole<span class="token punctuation">)</span>
    <span class="token comment">#converting the encrypted message to HEXADECIMAL to readable</span>
    eMsg <span class="token operator">=</span> eMsg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&quot;hex&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> eMsg <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;ENCRYPTED MESSAGE TO SERVER-&gt; &quot;</span><span class="token operator">+</span>eMsg<span class="token punctuation">)</span>
    server<span class="token punctuation">.</span>send<span class="token punctuation">(</span>eMsg<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">recv</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    newmess <span class="token operator">=</span> server<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\nENCRYPTED MESSAGE FROM SERVER-&gt; &quot;</span> <span class="token operator">+</span> newmess<span class="token punctuation">)</span>
    key <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>
    decoded <span class="token operator">=</span> newmess<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;hex&quot;</span><span class="token punctuation">)</span>
    ideaDecrypt <span class="token operator">=</span> IDEA<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> IDEA<span class="token punctuation">.</span>MODE_CTR<span class="token punctuation">,</span> counter<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> key<span class="token punctuation">)</span>
    dMsg <span class="token operator">=</span> ideaDecrypt<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>decoded<span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n**New Message From Server**  &quot;</span> <span class="token operator">+</span> time<span class="token punctuation">.</span>ctime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; : &quot;</span> <span class="token operator">+</span> dMsg <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    server<span class="token punctuation">.</span>send<span class="token punctuation">(</span>public<span class="token punctuation">)</span>
    confirm <span class="token operator">=</span> server<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> confirm <span class="token operator">==</span> <span class="token string">&quot;YES&quot;</span><span class="token punctuation">:</span>
        server<span class="token punctuation">.</span>send<span class="token punctuation">(</span>hex_digest<span class="token punctuation">)</span>

    <span class="token comment">#connected msg</span>
    msg <span class="token operator">=</span> server<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    en <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    decrypt <span class="token operator">=</span> key<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>en<span class="token punctuation">)</span>
    <span class="token comment"># hashing sha1</span>
    en_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span>decrypt<span class="token punctuation">)</span>
    en_digest <span class="token operator">=</span> en_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n-----ENCRYPTED PUBLIC KEY AND SESSION KEY FROM SERVER-----&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n-----DECRYPTED SESSION KEY-----&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span>en_digest<span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;\n-----HANDSHAKE COMPLETE-----\n&quot;</span><span class="token punctuation">)</span>
    alais <span class="token operator">=</span> <span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token string">&quot;\nYour Name -&gt; &quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        thread_send <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>send<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&quot;------Sending Message------&quot;</span><span class="token punctuation">,</span>alais<span class="token punctuation">,</span>en_digest<span class="token punctuation">)</span><span class="token punctuation">)</span>
        thread_recv <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>recv<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&quot;------Recieving Message------&quot;</span><span class="token punctuation">,</span>en_digest<span class="token punctuation">)</span><span class="token punctuation">)</span>
        thread_send<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
        thread_recv<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

        thread_send<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
        thread_recv<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>
    server<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p><strong>Language Used:</strong> Python 2.7 (Download Link: <a href="https://www.python.org/downloads/" target="_blank" rel="noopener noreferrer">https://www.python.org/downloads/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> )</p> <p><strong>Library Used:</strong></p> <p>*<strong>PyCrypto</strong> (Download Link: <a href="https://pypi.python.org/pypi/pycrypto" target="_blank" rel="noopener noreferrer">https://pypi.python.org/pypi/pycrypto<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> )</p> <p>*<strong>PyCryptoPlus</strong> (Download Link: <a href="https://github.com/doegox/python-cryptoplus" target="_blank" rel="noopener noreferrer">https://github.com/doegox/python-cryptoplus<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> )</p> <p><strong>Library Installation:</strong></p> <p><strong>PyCrypto:</strong> Unzip the file. Go to the directory and open terminal for linux(alt+ctrl+t) and
CMD(shift+right click+select command prompt open here) for windows. After that write python setup.py install (Make Sure Python Environment is set properly in Windows OS)</p> <p><strong>PyCryptoPlus:</strong> Same as the last library.</p> <p><strong>Tasks Implementation:</strong>
The task is separated into two parts. One is handshake process and another one is communication process.
Socket Setup:</p> <li><p>As the creating public and private keys as well as hashing the public key, we need
to setup the socket now. For setting up the socket, we need to import another module with “import socket” and connect(for client) or bind(for server) the IP address and the port with the socket getting from the user.</p>
**----------Client Side----------**
<div class="language-py extra-class"><pre class="language-py"><code>  server <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
  host <span class="token operator">=</span> <span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token string">&quot;Server Address To Be Connected -&gt; &quot;</span><span class="token punctuation">)</span>
  port <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;Port of The Server -&gt; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  server<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p><strong>----------Server Side---------</strong></p> <div class="language-py extra-class"><pre class="language-py"><code>  <span class="token keyword">try</span><span class="token punctuation">:</span>
  <span class="token comment">#setting up socket</span>
  server <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>     
  server<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>
  server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  <span class="token keyword">except</span> BaseException<span class="token punctuation">:</span> <span class="token keyword">print</span> <span class="token string">&quot;-----Check Server Address or Port-----&quot;</span>

</code></pre></div><p><strong>“ socket.AF_INET,socket.SOCK_STREAM” will allow us to use accept() function and messaging fundamentals. Instead of it, we can use “ socket.AF_INET,socket.SOCK_DGRAM” also but that time we will have to use setblocking(value) .</strong></p></li><p></p> <p><strong>Handshake Process:</strong></p> <li>(CLIENT)The first task is to create public and private key. To create the private
and public key, we have to import some modules. They are : from Crypto import Random and from Crypto.PublicKey import RSA. To create the keys, we have to write few simple lines of codes:</li> <div class="language-py extra-class"><pre class="language-py"><code>random_generator <span class="token operator">=</span> Random<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read
        key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>generate<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span>random_generator<span class="token punctuation">)</span> 
        public <span class="token operator">=</span> key<span class="token punctuation">.</span>publickey<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>exportKey<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><p>random_generator is derived from “<strong>from Crypto import Random</strong>” module. Key is derived from “<strong>from Crypto.PublicKey import RSA</strong>” which will create a private key, size of 1024 by generating random characters. Public is exporting public key from previously generated private key.</p> <li>
(CLIENT)After creating the public and private key, we have to hash the public key to send over to the server using SHA-1 hash. To use the SHA-1 hash we need to import another module by writing “import hashlib” .To hash the public key we have write two lines of code:
<div class="language-py extra-class"><pre class="language-py"><code>  hash_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span>public<span class="token punctuation">)</span> 
  hex_digest <span class="token operator">=</span> hash_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div></li> <p>Here hash_object and hex_digest is our variable. After this, client will send hex_digest and public to the server and Server will verify them by comparing the hash got from client and new hash of the public key. If the new hash and the hash from the client matches, it will move to next procedure. As the public sent from the client is in form of string, it will not be able to be used as key in the server
side. To prevent this and converting string public key to rsa public key, we need to write <code>server_public_key = RSA.importKey(getpbk)</code> ,here getpbk is the public key from the client.</p> <li>
(SERVER)The next step is to create a session key. Here, I have used “os” module to create a random key “key = os.urandom(16)” which will give us a 16bit long key and after that I have encrypted that key in “AES.MODE_CTR” and hash it again with SHA-1:
<div class="language-py extra-class"><pre class="language-py"><code> <span class="token comment">#encrypt CTR MODE session key</span>
 en <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key_128<span class="token punctuation">,</span>AES<span class="token punctuation">.</span>MODE_CTR<span class="token punctuation">,</span>counter <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span>key_128<span class="token punctuation">)</span> encrypto <span class="token operator">=</span> en<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>key_128<span class="token punctuation">)</span>
 <span class="token comment">#hashing sha1</span>
 en_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span>encrypto<span class="token punctuation">)</span>
 en_digest <span class="token operator">=</span> en_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div></li> <p>So the en_digest will be our session key.</p> <li><p>(SERVER) For the final part of the handshake process is to encrypt the public key got from the client and the session key created in
server side.</p> <div class="language-py extra-class"><pre class="language-py"><code> <span class="token comment">#encrypting session key and public key</span>
 E <span class="token operator">=</span> server_public_key<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>encrypto<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>

</code></pre></div></li> <p>After encrypting, server will send the key to the client as string.</p> <li><p>(CLIENT) After getting the encrypted string of (public and session key) from the server, client will decrypt them using Private Key
which was created earlier along with the public key. As the encrypted
(public and session key) was in form of string, now we have to get it
back as a key by using eval() . If the decryption is done, the
handshake process is completed also as both sides confirms that they
are using same keys. To decrypt:</p> <div class="language-py extra-class"><pre class="language-py"><code> en <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
 decrypt <span class="token operator">=</span> key<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>en<span class="token punctuation">)</span>
 <span class="token comment"># hashing sha1</span>
 en_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span>decrypt<span class="token punctuation">)</span> en_digest <span class="token operator">=</span> en_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div></li> <p>I have used the SHA-1 here so that it will be readable in the output.</p> <p><strong>Communication Process:</strong></p> <p>For communication process, we have to use the session key from both side as the KEY for IDEA encryption MODE_CTR. Both side will encrypt and decrypt messages with IDEA.MODE_CTR using the session key.</p> <li><p>(Encryption) For IDEA encryption, we need key of 16bit in size and counter as must callable. Counter is mandatory in MODE_CTR. The session key that we encrypted and hashed is now size of 40 which will exceed the limit key of the IDEA encryption. Hence, we need to reduce the size of the session key. For reducing, we can use normal python built in function string[value:value]. Where the value can be any value according to the choice of the user. In our case, I have done “key[:16]”
where it will take from 0 to 16 values from the key. This conversion could be done in many ways like key[1:17] or key[16:]. Next part is to create new IDEA encryption function by writing IDEA.new() which will take 3 arguments for processing. The first argument will be KEY,second argument will be the mode of the IDEA encryption (in our case, IDEA.MODE_CTR) and the third argument will be the counter= which is a must callable function. The counter= will hold a size of of string which will be returned by the function. To define the counter= , we must have to use a reasonable values. In this case, I have used the size of the KEY by defining lambda. Instead of using lambda, we could use Counter.Util which generates random value for counter= . To use Counter.Util, we need to import counter module from crypto. Hence, the code will be:</p> <div class="language-py extra-class"><pre class="language-py"><code>  ideaEncrypt <span class="token operator">=</span> IDEA<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> IDEA<span class="token punctuation">.</span>MODE_CTR<span class="token punctuation">,</span> counter<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> key<span class="token punctuation">)</span>

</code></pre></div></li> <p>Once defining the “ideaEncrypt” as our IDEA encryption variable, we can use the built in encrypt function to encrypt any message.</p> <div class="language-py extra-class"><pre class="language-py"><code>eMsg <span class="token operator">=</span> ideaEncrypt<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>whole<span class="token punctuation">)</span>
<span class="token comment">#converting the encrypted message to HEXADECIMAL to readable eMsg =         </span>
eMsg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&quot;hex&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><p>In this code segment, whole is the message to be encrypted and eMsg is the encrypted message. After encrypting the message, I have converted it into HEXADECIMAL to make readable and upper() is the built in function to make the characters uppercase. After that, this encrypted message will be sent to the opposite station for decryption.</p> <ul><li><strong>(Decryption)</strong></li></ul> <p>To decrypt the encrypted messages, we will need to create another encryption variable by using the same arguments and same key but this time the variable will decrypt the encrypted messages. The code for this same as the last time. However, before decrypting the messages, we need to decode the message from hexadecimal because in our encryption part, we encoded the encrypted message in hexadecimal to make readable. Hence, the whole code will be:</p> <div class="language-py extra-class"><pre class="language-py"><code>decoded <span class="token operator">=</span> newmess<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;hex&quot;</span><span class="token punctuation">)</span>
ideaDecrypt <span class="token operator">=</span> IDEA<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> IDEA<span class="token punctuation">.</span>MODE_CTR<span class="token punctuation">,</span> counter<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> key<span class="token punctuation">)</span> 
dMsg <span class="token operator">=</span> ideaDecrypt<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>decoded<span class="token punctuation">)</span>

</code></pre></div><p>These processes will be done in both server and client side for encrypting and decrypting.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/python/sockets-and-message-encryption-decryption-between-client-and-server.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/python/websockets.html" class="prev">
        Websockets
      </a></span> <span class="next"><a href="/python/python-networking.html">
        Python Networking
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2808.c0878789.js" defer></script>
  </body>
</html>
