<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Node.js - Mongoose Library</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Connect to MongoDB Using Mongoose, Find Data in MongoDB Using Mongoose, Express.js Routes and $text Operator, Save Data to MongoDB using Mongoose and Express.js Routes, Find Data in MongoDB Using Mongoose and Express.js Routes, Indexes in models., Useful Mongoose functions, find data in mongodb using promises">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Node.js - Mongoose Library">
    <meta property="og:description" content="Connect to MongoDB Using Mongoose, Find Data in MongoDB Using Mongoose, Express.js Routes and $text Operator, Save Data to MongoDB using Mongoose and Express.js Routes, Find Data in MongoDB Using Mongoose and Express.js Routes, Indexes in models., Useful Mongoose functions, find data in mongodb using promises">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/nodejs/mongoose-library.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Node.js - Mongoose Library">
    <meta name="twitter:description" content="Connect to MongoDB Using Mongoose, Find Data in MongoDB Using Mongoose, Express.js Routes and $text Operator, Save Data to MongoDB using Mongoose and Express.js Routes, Find Data in MongoDB Using Mongoose and Express.js Routes, Indexes in models., Useful Mongoose functions, find data in mongodb using promises">
    <meta name="twitter:url" content="/nodejs/mongoose-library.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/2211.224410b0.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Node.js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nodejs/" class="sidebar-link">Disclaimer</a></li><li><a href="/nodejs/installing-node-js.html" class="sidebar-link">Installing Node.js</a></li><li><a href="/nodejs/getting-started-with-node-js.html" class="sidebar-link">Getting started with Node.js</a></li><li><a href="/nodejs/npm.html" class="sidebar-link">npm</a></li><li><a href="/nodejs/web-apps-with-express.html" class="sidebar-link">Web Apps With Express</a></li><li><a href="/nodejs/filesystem-i-o.html" class="sidebar-link">Filesystem I/O</a></li><li><a href="/nodejs/exporting-and-consuming-modules.html" class="sidebar-link">Exporting and Consuming Modules</a></li><li><a href="/nodejs/exporting-and-importing-module-in-node-js.html" class="sidebar-link">Exporting and Importing Module in node.js</a></li><li><a href="/nodejs/how-modules-are-loaded.html" class="sidebar-link">How modules are loaded</a></li><li><a href="/nodejs/cluster-module.html" class="sidebar-link">Cluster Module</a></li><li><a href="/nodejs/readline.html" class="sidebar-link">Readline</a></li><li><a href="/nodejs/package-json.html" class="sidebar-link">package.json</a></li><li><a href="/nodejs/event-emitters.html" class="sidebar-link">Event Emitters</a></li><li><a href="/nodejs/autoreload-on-changes.html" class="sidebar-link">Autoreload on changes</a></li><li><a href="/nodejs/environment.html" class="sidebar-link">Environment</a></li><li><a href="/nodejs/callback-to-promise.html" class="sidebar-link">Callback to Promise</a></li><li><a href="/nodejs/executing-files-or-commands-with-child-processes.html" class="sidebar-link">Executing files or commands with Child Processes</a></li><li><a href="/nodejs/exception-handling.html" class="sidebar-link">Exception handling</a></li><li><a href="/nodejs/keep-a-node-application-constantly-running.html" class="sidebar-link">Keep a node application constantly running</a></li><li><a href="/nodejs/uninstalling-node-js.html" class="sidebar-link">Uninstalling Node.js</a></li><li><a href="/nodejs/nvm-node-version-manager.html" class="sidebar-link">nvm - Node Version Manager</a></li><li><a href="/nodejs/http.html" class="sidebar-link">http</a></li><li><a href="/nodejs/using-streams.html" class="sidebar-link">Using Streams</a></li><li><a href="/nodejs/deploying-node-js-applications-in-production.html" class="sidebar-link">Deploying Node.js applications in production</a></li><li><a href="/nodejs/securing-node-js-applications.html" class="sidebar-link">Securing Node.js applications</a></li><li><a href="/nodejs/mongoose-library.html" class="active sidebar-link">Mongoose Library</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nodejs/mongoose-library.html#connect-to-mongodb-using-mongoose" class="sidebar-link">Connect to MongoDB Using Mongoose</a></li><li class="sidebar-sub-header"><a href="/nodejs/mongoose-library.html#find-data-in-mongodb-using-mongoose-express-js-routes-and-text-operator" class="sidebar-link">Find Data in MongoDB Using Mongoose, Express.js Routes and $text Operator</a></li><li class="sidebar-sub-header"><a href="/nodejs/mongoose-library.html#save-data-to-mongodb-using-mongoose-and-express-js-routes" class="sidebar-link">Save Data to MongoDB using Mongoose and Express.js Routes</a></li><li class="sidebar-sub-header"><a href="/nodejs/mongoose-library.html#find-data-in-mongodb-using-mongoose-and-express-js-routes" class="sidebar-link">Find Data in MongoDB Using Mongoose and Express.js Routes</a></li><li class="sidebar-sub-header"><a href="/nodejs/mongoose-library.html#indexes-in-models" class="sidebar-link">Indexes in models.</a></li><li class="sidebar-sub-header"><a href="/nodejs/mongoose-library.html#useful-mongoose-functions" class="sidebar-link">Useful Mongoose functions</a></li><li class="sidebar-sub-header"><a href="/nodejs/mongoose-library.html#find-data-in-mongodb-using-promises" class="sidebar-link">find data in mongodb using promises</a></li></ul></li><li><a href="/nodejs/async-js.html" class="sidebar-link">async.js</a></li><li><a href="/nodejs/file-upload.html" class="sidebar-link">File upload</a></li><li><a href="/nodejs/socket-io-communication.html" class="sidebar-link">Socket.io communication</a></li><li><a href="/nodejs/mongodb-integration.html" class="sidebar-link">Mongodb integration</a></li><li><a href="/nodejs/handling-post-request-in-node-js.html" class="sidebar-link">Handling POST request in Node.js</a></li><li><a href="/nodejs/simple-rest-based-crud-api.html" class="sidebar-link">Simple REST based CRUD API</a></li><li><a href="/nodejs/template-frameworks.html" class="sidebar-link">Template frameworks</a></li><li><a href="/nodejs/node-js-architecture-inner-workings.html" class="sidebar-link">Node.js Architecture &amp; Inner Workings</a></li><li><a href="/nodejs/debugging-node-js-application.html" class="sidebar-link">Debugging Node.js application</a></li><li><a href="/nodejs/node-server-without-framework.html" class="sidebar-link">Node server without framework</a></li><li><a href="/nodejs/node-js-with-es6.html" class="sidebar-link">Node.JS with ES6</a></li><li><a href="/nodejs/interacting-with-console.html" class="sidebar-link">Interacting with Console</a></li><li><a href="/nodejs/cassandra-integration.html" class="sidebar-link">Cassandra Integration</a></li><li><a href="/nodejs/creating-api-s-with-node-js.html" class="sidebar-link">Creating API's with Node.js</a></li><li><a href="/nodejs/graceful-shutdown.html" class="sidebar-link">Graceful Shutdown</a></li><li><a href="/nodejs/using-iisnode-to-host-node-js-web-apps-in-iis.html" class="sidebar-link">Using IISNode to host Node.js Web Apps in IIS</a></li><li><a href="/nodejs/cli.html" class="sidebar-link">CLI</a></li><li><a href="/nodejs/nodejs-frameworks.html" class="sidebar-link">NodeJS Frameworks</a></li><li><a href="/nodejs/grunt.html" class="sidebar-link">grunt</a></li><li><a href="/nodejs/using-websocket-s-with-node-js.html" class="sidebar-link">Using WebSocket's with Node.JS</a></li><li><a href="/nodejs/metalsmith.html" class="sidebar-link">metalsmith</a></li><li><a href="/nodejs/parsing-command-line-arguments.html" class="sidebar-link">Parsing command line arguments</a></li><li><a href="/nodejs/client-server-communication.html" class="sidebar-link">Client-server communication</a></li><li><a href="/nodejs/node-js-design-fundamental.html" class="sidebar-link">Node.js Design Fundamental</a></li><li><a href="/nodejs/connect-to-mongodb.html" class="sidebar-link">Connect to Mongodb</a></li><li><a href="/nodejs/performance-challenges.html" class="sidebar-link">Performance challenges</a></li><li><a href="/nodejs/send-web-notification.html" class="sidebar-link">Send Web Notification</a></li><li><a href="/nodejs/remote-debugging-in-node-js.html" class="sidebar-link">Remote Debugging in Node.JS</a></li><li><a href="/nodejs/database-mongodb-with-mongoose.html" class="sidebar-link">Database (MongoDB with Mongoose)</a></li><li><a href="/nodejs/good-coding-style.html" class="sidebar-link">Good coding style</a></li><li><a href="/nodejs/restful-api-design-best-practices.html" class="sidebar-link">Restful API Design: Best Practices</a></li><li><a href="/nodejs/deliver-html-or-any-other-sort-of-file.html" class="sidebar-link">Deliver HTML or any other sort of file</a></li><li><a href="/nodejs/tcp-sockets.html" class="sidebar-link">TCP Sockets</a></li><li><a href="/nodejs/hack.html" class="sidebar-link">Hack</a></li><li><a href="/nodejs/bluebird-promises.html" class="sidebar-link">Bluebird Promises</a></li><li><a href="/nodejs/async-await.html" class="sidebar-link">Async/Await</a></li><li><a href="/nodejs/koa-framework-v2.html" class="sidebar-link">Koa Framework v2</a></li><li><a href="/nodejs/unit-testing-frameworks.html" class="sidebar-link">Unit testing frameworks</a></li><li><a href="/nodejs/ecmascript-2015-es6-with-node-js.html" class="sidebar-link">ECMAScript 2015 (ES6) with Node.js</a></li><li><a href="/nodejs/routing-ajax-requests-with-express-js.html" class="sidebar-link">Routing ajax requests with Express.JS</a></li><li><a href="/nodejs/sending-a-file-stream-to-client.html" class="sidebar-link">Sending a file stream to client</a></li><li><a href="/nodejs/nodejs-with-redis.html" class="sidebar-link">NodeJS with Redis</a></li><li><a href="/nodejs/using-browserfiy-to-resolve-required-error-with-browsers.html" class="sidebar-link">Using Browserfiy to resolve 'required' error with browsers</a></li><li><a href="/nodejs/node-js-and-mongodb.html" class="sidebar-link">Node.JS and MongoDB.</a></li><li><a href="/nodejs/passport-integration.html" class="sidebar-link">Passport integration</a></li><li><a href="/nodejs/dependency-injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/nodejs/nodejs-beginner-guide.html" class="sidebar-link">NodeJS Beginner Guide</a></li><li><a href="/nodejs/use-cases-of-node-js.html" class="sidebar-link">Use Cases of Node.js</a></li><li><a href="/nodejs/sequelize-js.html" class="sidebar-link">Sequelize.js</a></li><li><a href="/nodejs/postgresql-integration.html" class="sidebar-link">PostgreSQL integration</a></li><li><a href="/nodejs/mysql-integration.html" class="sidebar-link">MySQL integration</a></li><li><a href="/nodejs/mysql-connection-pool.html" class="sidebar-link">Mysql Connection Pool</a></li><li><a href="/nodejs/mssql-intergration.html" class="sidebar-link">MSSQL Intergration</a></li><li><a href="/nodejs/node-js-with-oracle.html" class="sidebar-link">Node.js with Oracle</a></li><li><a href="/nodejs/synchronous-vs-asynchronous-programming-in-nodejs.html" class="sidebar-link">Synchronous vs Asynchronous programming in nodejs</a></li><li><a href="/nodejs/node-js-error-management.html" class="sidebar-link">Node.js Error Management</a></li><li><a href="/nodejs/node-js-v6-new-features-and-improvement.html" class="sidebar-link">Node.js v6 New Features and Improvement</a></li><li><a href="/nodejs/eventloop.html" class="sidebar-link">Eventloop</a></li><li><a href="/nodejs/nodejs-history.html" class="sidebar-link">Nodejs History</a></li><li><a href="/nodejs/passport-js.html" class="sidebar-link">passport.js</a></li><li><a href="/nodejs/asynchronous-programming.html" class="sidebar-link">Asynchronous programming</a></li><li><a href="/nodejs/node-js-code-for-stdin-and-stdout-without-using-any-library.html" class="sidebar-link">Node.js code for STDIN and STDOUT without using  any library</a></li><li><a href="/nodejs/mongodb-integration-for-node-js-express-js.html" class="sidebar-link">MongoDB Integration for Node.js/Express.js</a></li><li><a href="/nodejs/lodash.html" class="sidebar-link">Lodash</a></li><li><a href="/nodejs/csv-parser-in-node-js.html" class="sidebar-link">csv parser in node js</a></li><li><a href="/nodejs/loopback-rest-based-connector.html" class="sidebar-link">Loopback - REST Based connector</a></li><li><a href="/nodejs/running-node-js-as-a-service.html" class="sidebar-link">Running node.js as a service</a></li><li><a href="/nodejs/node-js-with-cors.html" class="sidebar-link">Node.js with CORS</a></li><li><a href="/nodejs/getting-started-with-nodes-profiling.html" class="sidebar-link">Getting started with Nodes profiling</a></li><li><a href="/nodejs/node-js-performance.html" class="sidebar-link">Node.js Performance</a></li><li><a href="/nodejs/yarn-package-manager.html" class="sidebar-link">Yarn Package Manager</a></li><li><a href="/nodejs/oauth-2-0.html" class="sidebar-link">OAuth 2.0</a></li><li><a href="/nodejs/node-js-localization.html" class="sidebar-link">Node JS Localization</a></li><li><a href="/nodejs/deploying-node-js-application-without-downtime.html" class="sidebar-link">Deploying Node.js application without downtime.</a></li><li><a href="/nodejs/node-js-express-js-with-angular-js-sample-code.html" class="sidebar-link">Node.js (express.js) with angular.js Sample code</a></li><li><a href="/nodejs/nodejs-routing.html" class="sidebar-link">NodeJs Routing</a></li><li><a href="/nodejs/creating-a-node-js-library-that-supports-both-promises-and-error-first-callbacks.html" class="sidebar-link">Creating a Node.js Library that Supports Both Promises and Error-First Callbacks</a></li><li><a href="/nodejs/project-structure.html" class="sidebar-link">Project Structure</a></li><li><a href="/nodejs/avoid-callback-hell.html" class="sidebar-link">Avoid callback hell</a></li><li><a href="/nodejs/arduino-communication-with-nodejs.html" class="sidebar-link">Arduino communication with nodeJs</a></li><li><a href="/nodejs/n-api.html" class="sidebar-link">N-API</a></li><li><a href="/nodejs/multithreading.html" class="sidebar-link">Multithreading</a></li><li><a href="/nodejs/windows-authentication-under-node-js.html" class="sidebar-link">Windows authentication under node.js</a></li><li><a href="/nodejs/require.html" class="sidebar-link">Require()</a></li><li><a href="/nodejs/route-controller-service-structure-for-expressjs.html" class="sidebar-link">Route-Controller-Service structure for ExpressJS</a></li><li><a href="/nodejs/push-notifications.html" class="sidebar-link">Push notifications</a></li><li><a href="/nodejs/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mongoose-library"><a href="#mongoose-library" class="header-anchor">#</a> Mongoose Library</h1> <h2 id="connect-to-mongodb-using-mongoose"><a href="#connect-to-mongodb-using-mongoose" class="header-anchor">#</a> Connect to MongoDB Using Mongoose</h2> <p>First, install Mongoose with:</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install mongoose

</code></pre></div><p>Then, add it to <code>server.js</code> as dependencies:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> Schema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>

</code></pre></div><p>Next, create the database schema and the name of the collection:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> schemaName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    request<span class="token operator">:</span> String<span class="token punctuation">,</span>
    time<span class="token operator">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    collection<span class="token operator">:</span> <span class="token string">'collectionName'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Create a model and connect to the database:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Model <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Model'</span><span class="token punctuation">,</span> schemaName<span class="token punctuation">)</span><span class="token punctuation">;</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://localhost:27017/dbName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Next, start MongoDB and run <code>server.js</code> using <code>node server.js</code></p> <p>To check if we have successfully connected to the database, we can use the events <code>open</code>, <code>error</code> from the <code>mongoose.connection</code> object.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> db <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>console<span class="token punctuation">,</span> <span class="token string">'connection error:'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// we're connected!</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="find-data-in-mongodb-using-mongoose-express-js-routes-and-text-operator"><a href="#find-data-in-mongodb-using-mongoose-express-js-routes-and-text-operator" class="header-anchor">#</a> Find Data in MongoDB Using Mongoose, Express.js Routes and $text Operator</h2> <h3 id="setup"><a href="#setup" class="header-anchor">#</a> Setup</h3> <p>First, install the necessary packages with:</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install express cors mongoose

</code></pre></div><h3 id="code"><a href="#code" class="header-anchor">#</a> Code</h3> <p>Then, add dependencies to <code>server.js</code>, create the database schema and the name of the collection, create an Express.js server, and connect to MongoDB:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We will use CORS to enable cross origin domain requests.</span>
<span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> Schema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> schemaName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    request<span class="token operator">:</span> String<span class="token punctuation">,</span>
    time<span class="token operator">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    collection<span class="token operator">:</span> <span class="token string">'collectionName'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> Model <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Model'</span><span class="token punctuation">,</span> schemaName<span class="token punctuation">)</span><span class="token punctuation">;</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://localhost:27017/dbName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">8080</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Node.js listening on port '</span> <span class="token operator">+</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Now add Express.js routes that we will use to query the data:</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/find/:query'</span><span class="token punctuation">,</span> <span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> query <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>query<span class="token punctuation">;</span>

    Model<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'request'</span><span class="token operator">:</span> query
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                error <span class="token operator">:</span> <span class="token string">'Error'</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>Assume that the following documents are in the collection in the model:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
        <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;578abe97522ad414b8eeb55a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;request&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;time&quot;</span> <span class="token operator">:</span> <span class="token number">1468710551</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
        <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;578abe9b522ad414b8eeb55b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;request&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;time&quot;</span> <span class="token operator">:</span> <span class="token number">1468710555</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
        <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;578abea0522ad414b8eeb55c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;request&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;time&quot;</span> <span class="token operator">:</span> <span class="token number">1468710560</span>
<span class="token punctuation">}</span>

</code></pre></div><p>And that the goal is to find and display all the documents containing only <code>&quot;JavaScript&quot;</code> word under the <code>&quot;request&quot;</code> key.</p> <p>To do this, first create a <strong>text index</strong> for <code>&quot;request&quot;</code> in the collection. For this, add the following code to <code>server.js</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>schemaName<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">{</span> request<span class="token operator">:</span> <span class="token string">'text'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>And replace:</p> <div class="language- extra-class"><pre class="language-text"><code>
   Model.find({
        'request': query
    }, function(err, result) {

</code></pre></div><p>With:</p> <div class="language-js extra-class"><pre class="language-js"><code>Model<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    $text<span class="token operator">:</span> <span class="token punctuation">{</span>
        $search<span class="token operator">:</span> query
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

</code></pre></div><p>Here, we are using <code>$text</code> and <code>$search</code> MongoDB operators for find all documents in collection <code>collectionName</code> which contains at least one word from the specified find query.</p> <h3 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h3> <p>To use this to find data, go to the following URL in a browser:</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>find<span class="token operator">/</span><span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>

</code></pre></div><p>Where <code>&lt;query&gt;</code> is the search query.</p> <p>Example:</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>find<span class="token operator">/</span>JavaScript

</code></pre></div><p>Output:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token punctuation">{</span>
    _id<span class="token operator">:</span> <span class="token string">&quot;578abe97522ad414b8eeb55a&quot;</span><span class="token punctuation">,</span>
    request<span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1468710551</span><span class="token punctuation">,</span>
    __v<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    _id<span class="token operator">:</span> <span class="token string">&quot;578abe9b522ad414b8eeb55b&quot;</span><span class="token punctuation">,</span>
    request<span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1468710555</span><span class="token punctuation">,</span>
    __v<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    _id<span class="token operator">:</span> <span class="token string">&quot;578abea0522ad414b8eeb55c&quot;</span><span class="token punctuation">,</span>
    request<span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1468710560</span><span class="token punctuation">,</span>
    __v<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>

</code></pre></div><h2 id="save-data-to-mongodb-using-mongoose-and-express-js-routes"><a href="#save-data-to-mongodb-using-mongoose-and-express-js-routes" class="header-anchor">#</a> Save Data to MongoDB using Mongoose and Express.js Routes</h2> <h3 id="setup-2"><a href="#setup-2" class="header-anchor">#</a> Setup</h3> <p>First, install the necessary packages with:</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install express cors mongoose

</code></pre></div><h3 id="code-2"><a href="#code-2" class="header-anchor">#</a> Code</h3> <p>Then, add dependencies to your <code>server.js</code> file, create the database schema and the name of the collection, create an Express.js server, and connect to MongoDB:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We will use CORS to enable cross origin domain requests.</span>
<span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> Schema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> schemaName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    request<span class="token operator">:</span> String<span class="token punctuation">,</span>
    time<span class="token operator">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    collection<span class="token operator">:</span> <span class="token string">'collectionName'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> Model <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Model'</span><span class="token punctuation">,</span> schemaName<span class="token punctuation">)</span><span class="token punctuation">;</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://localhost:27017/dbName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">8080</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Node.js listening on port '</span> <span class="token operator">+</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Now add Express.js routes that we will use to write the data:</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/save/:query'</span><span class="token punctuation">,</span> <span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> query <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>query<span class="token punctuation">;</span>

    <span class="token keyword">var</span> savedata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Model</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'request'</span><span class="token operator">:</span> query<span class="token punctuation">,</span>
        <span class="token string">'time'</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token comment">// Time of save the data in unix timestamp format</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>Here the <code>query</code> variable will be the <code>&lt;query&gt;</code> parameter from the incoming HTTP request, which will be saved to MongoDB:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> savedata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Model</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'request'</span><span class="token operator">:</span> query<span class="token punctuation">,</span>
    <span class="token comment">//...</span>

</code></pre></div><p>If an error occurs while trying to write to MongoDB, you will receive an error message on the console. If all is successful, you will see the saved data in JSON format on the page.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//...</span>

</code></pre></div><p>Now, you need to start MongoDB and run your <code>server.js</code> file using <code>node server.js</code>.</p> <h3 id="usage-2"><a href="#usage-2" class="header-anchor">#</a> Usage</h3> <p>To use this to save data, go to the following URL in your browser:</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>save<span class="token operator">/</span><span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>

</code></pre></div><p>Where <code>&lt;query&gt;</code> is the new request you wish to save.</p> <p>Example:</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>save<span class="token operator">/</span>JavaScript<span class="token operator">%</span><span class="token number">20</span>is<span class="token operator">%</span><span class="token number">20</span>Awesome

</code></pre></div><p>Output in JSON format:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    __v<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    request<span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1469411348</span><span class="token punctuation">,</span>
    _id<span class="token operator">:</span> <span class="token string">&quot;57957014b93bc8640f2c78c4&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="find-data-in-mongodb-using-mongoose-and-express-js-routes"><a href="#find-data-in-mongodb-using-mongoose-and-express-js-routes" class="header-anchor">#</a> Find Data in MongoDB Using Mongoose and Express.js Routes</h2> <h3 id="setup-3"><a href="#setup-3" class="header-anchor">#</a> Setup</h3> <p>First, install the necessary packages with:</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install express cors mongoose

</code></pre></div><h3 id="code-3"><a href="#code-3" class="header-anchor">#</a> Code</h3> <p>Then, add dependencies to <code>server.js</code>, create the database schema and the name of the collection, create an Express.js server, and connect to MongoDB:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We will use CORS to enable cross origin domain requests.</span>
<span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> Schema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> schemaName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    request<span class="token operator">:</span> String<span class="token punctuation">,</span>
    time<span class="token operator">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    collection<span class="token operator">:</span> <span class="token string">'collectionName'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> Model <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Model'</span><span class="token punctuation">,</span> schemaName<span class="token punctuation">)</span><span class="token punctuation">;</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://localhost:27017/dbName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">8080</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Node.js listening on port '</span> <span class="token operator">+</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Now add Express.js routes that we will use to query the data:</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/find/:query'</span><span class="token punctuation">,</span> <span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> query <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>query<span class="token punctuation">;</span>

    Model<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'request'</span><span class="token operator">:</span> query
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                error <span class="token operator">:</span> <span class="token string">'Error'</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>Assume that the following documents are in the collection in the model:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
        <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;578abe97522ad414b8eeb55a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;request&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;time&quot;</span> <span class="token operator">:</span> <span class="token number">1468710551</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
        <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;578abe9b522ad414b8eeb55b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;request&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;time&quot;</span> <span class="token operator">:</span> <span class="token number">1468710555</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
        <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;578abea0522ad414b8eeb55c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;request&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;time&quot;</span> <span class="token operator">:</span> <span class="token number">1468710560</span>
<span class="token punctuation">}</span>

</code></pre></div><p>And the goal is to find and display all the documents containing <code>&quot;JavaScript is Awesome&quot;</code> under the <code>&quot;request&quot;</code> key.</p> <p>For this, start MongoDB and run <code>server.js</code> with <code>node server.js</code>:</p> <h3 id="usage-3"><a href="#usage-3" class="header-anchor">#</a> Usage</h3> <p>To use this to find data, go to the following URL in a browser:</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>find<span class="token operator">/</span><span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>

</code></pre></div><p>Where <code>&lt;query&gt;</code> is the search query.</p> <p>Example:</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>find<span class="token operator">/</span>JavaScript<span class="token operator">%</span><span class="token number">20</span>is<span class="token operator">%</span><span class="token number">20</span>Awesome

</code></pre></div><p>Output:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token punctuation">{</span>
    _id<span class="token operator">:</span> <span class="token string">&quot;578abe97522ad414b8eeb55a&quot;</span><span class="token punctuation">,</span>
    request<span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1468710551</span><span class="token punctuation">,</span>
    __v<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    _id<span class="token operator">:</span> <span class="token string">&quot;578abe9b522ad414b8eeb55b&quot;</span><span class="token punctuation">,</span>
    request<span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1468710555</span><span class="token punctuation">,</span>
    __v<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    _id<span class="token operator">:</span> <span class="token string">&quot;578abea0522ad414b8eeb55c&quot;</span><span class="token punctuation">,</span>
    request<span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1468710560</span><span class="token punctuation">,</span>
    __v<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>

</code></pre></div><h2 id="indexes-in-models"><a href="#indexes-in-models" class="header-anchor">#</a> Indexes in models.</h2> <p>MongoDB supports secondary indexes. In Mongoose, we define these indexes within our schema. Defining indexes at schema level is necessary when we need to create compound indexes.</p> <p><strong>Mongoose Connection</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> strConnection <span class="token operator">=</span> <span class="token string">'mongodb://localhost:27017/dbName'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span>strConnection<span class="token punctuation">)</span>

</code></pre></div><p><strong>Creating a basic schema</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Schema <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>
<span class="token keyword">var</span> usersSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> String<span class="token punctuation">,</span>
        required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        unique<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    email<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> String<span class="token punctuation">,</span>
        required<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> String<span class="token punctuation">,</span>
        required<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    created<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> Date<span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token operator">:</span> Date<span class="token punctuation">.</span>now
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> usersModel <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">,</span> usersSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> usersModel<span class="token punctuation">;</span>

</code></pre></div><p>By default, mongoose adds two new fields into our model, even when those are not defined in the model. Those fields are:</p> <p><strong>_id</strong></p> <p>Mongoose assigns each of your schemas an _id field by default if one is not passed into the Schema constructor. The type assigned is an ObjectId to coincide with MongoDB's default behavior. If you don't want an _id added to your schema at all, you may disable it using this option.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> usersSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> String<span class="token punctuation">,</span>
        required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        unique<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        _id<span class="token operator">:</span> <span class="token boolean">false</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>__v or versionKey</strong></p> <p>The versionKey is a property set on each document when first created by Mongoose. This keys value contains the internal revision of the document. The name of this document property is configurable.</p> <p>You can easy disable this field in the model configuration:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> usersSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> String<span class="token punctuation">,</span>
        required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        unique<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    versionKey<span class="token operator">:</span> <span class="token boolean">false</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Compound indexes</strong></p> <p>We can create another indexes besides those Mongoose creates.</p> <div class="language-js extra-class"><pre class="language-js"><code>usersSchema<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">{</span>username<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
usersSchema<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">{</span>email<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>In these case our model have two more indexes, one for the field username and another for email field. But we can create compound indexes.</p> <div class="language-js extra-class"><pre class="language-js"><code>usersSchema<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">{</span>username<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> email<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Index performance impact</strong></p> <p>By default, mongoose always call the ensureIndex for each index sequentially and emit an 'index' event on the model when all the ensureIndex calls succeeded or when there was an error.</p> <p>In MongoDB ensureIndex is deprecated since 3.0.0 version, now is an alias for createIndex.</p> <p>Is recommended disable the behavior by setting the autoIndex option of your schema to false, or globally on the connection by setting the option config.autoIndex to false.</p> <div class="language-js extra-class"><pre class="language-js"><code>usersSchema<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'autoIndex'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="useful-mongoose-functions"><a href="#useful-mongoose-functions" class="header-anchor">#</a> Useful Mongoose functions</h2> <p>Mongoose contains some built in functions that build on the standard <code>find()</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code>doc<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'some.value'</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>docs</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//returns array docs</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

doc<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'some.value'</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>doc</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//returns document doc</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

doc<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_id<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>doc</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//returns document doc</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="find-data-in-mongodb-using-promises"><a href="#find-data-in-mongodb-using-promises" class="header-anchor">#</a> find data in mongodb using promises</h2> <h3 id="setup-4"><a href="#setup-4" class="header-anchor">#</a> Setup</h3> <p>First, install the necessary packages with:</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install express cors mongoose

</code></pre></div><h3 id="code-4"><a href="#code-4" class="header-anchor">#</a> Code</h3> <p>Then, add dependencies to <code>server.js</code>, create the database schema and the name of the collection, create an Express.js server, and connect to MongoDB:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We will use CORS to enable cross origin domain requests.</span>
<span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> Schema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> schemaName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    request<span class="token operator">:</span> String<span class="token punctuation">,</span>
    time<span class="token operator">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    collection<span class="token operator">:</span> <span class="token string">'collectionName'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> Model <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Model'</span><span class="token punctuation">,</span> schemaName<span class="token punctuation">)</span><span class="token punctuation">;</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://localhost:27017/dbName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">8080</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Node.js listening on port '</span> <span class="token operator">+</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>stack<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Something broke!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Sorry cant find that!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Now add Express.js routes that we will use to query the data:</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/find/:query'</span><span class="token punctuation">,</span> <span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> query <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>query<span class="token punctuation">;</span>

    Model<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'request'</span><span class="token operator">:</span> query
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//remember to add exec, queries have a .then attribute but aren't promises</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//pass to 404 handler</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span> <span class="token comment">//pass to error handler</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>Assume that the following documents are in the collection in the model:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
        <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;578abe97522ad414b8eeb55a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;request&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;time&quot;</span> <span class="token operator">:</span> <span class="token number">1468710551</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
        <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;578abe9b522ad414b8eeb55b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;request&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;time&quot;</span> <span class="token operator">:</span> <span class="token number">1468710555</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
        <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;578abea0522ad414b8eeb55c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;request&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;time&quot;</span> <span class="token operator">:</span> <span class="token number">1468710560</span>
<span class="token punctuation">}</span>

</code></pre></div><p>And the goal is to find and display all the documents containing <code>&quot;JavaScript is Awesome&quot;</code> under the <code>&quot;request&quot;</code> key.</p> <p>For this, start MongoDB and run <code>server.js</code> with <code>node server.js</code>:</p> <h3 id="usage-4"><a href="#usage-4" class="header-anchor">#</a> Usage</h3> <p>To use this to find data, go to the following URL in a browser:</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>find<span class="token operator">/</span><span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>

</code></pre></div><p>Where <code>&lt;query&gt;</code> is the search query.</p> <p>Example:</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>find<span class="token operator">/</span>JavaScript<span class="token operator">%</span><span class="token number">20</span>is<span class="token operator">%</span><span class="token number">20</span>Awesome

</code></pre></div><p>Output:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token punctuation">{</span>
    _id<span class="token operator">:</span> <span class="token string">&quot;578abe97522ad414b8eeb55a&quot;</span><span class="token punctuation">,</span>
    request<span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1468710551</span><span class="token punctuation">,</span>
    __v<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    _id<span class="token operator">:</span> <span class="token string">&quot;578abe9b522ad414b8eeb55b&quot;</span><span class="token punctuation">,</span>
    request<span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1468710555</span><span class="token punctuation">,</span>
    __v<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    _id<span class="token operator">:</span> <span class="token string">&quot;578abea0522ad414b8eeb55c&quot;</span><span class="token punctuation">,</span>
    request<span class="token operator">:</span> <span class="token string">&quot;JavaScript is Awesome&quot;</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1468710560</span><span class="token punctuation">,</span>
    __v<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/nodejs/mongoose-library.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/nodejs/securing-node-js-applications.html" class="prev">
        Securing Node.js applications
      </a></span> <span class="next"><a href="/nodejs/async-js.html">
        async.js
      </a>
      
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/2211.224410b0.js" defer></script>
  </body>
</html>
