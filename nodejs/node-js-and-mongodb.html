<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Node.js - Node.JS and MongoDB.</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Connecting To a Database, Creating New Collection, Inserting Documents, Reading, Updating, Deleting">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Node.js - Node.JS and MongoDB.">
    <meta property="og:description" content="Connecting To a Database, Creating New Collection, Inserting Documents, Reading, Updating, Deleting">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/nodejs/node-js-and-mongodb.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Node.js - Node.JS and MongoDB.">
    <meta name="twitter:description" content="Connecting To a Database, Creating New Collection, Inserting Documents, Reading, Updating, Deleting">
    <meta name="twitter:url" content="/nodejs/node-js-and-mongodb.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/2219.77f75793.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Node.js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nodejs/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/nodejs/installing-node-js.html" class="sidebar-link">Installing Node.js</a></li><li><a href="/nodejs/getting-started-with-node-js.html" class="sidebar-link">Getting started with Node.js</a></li><li><a href="/nodejs/npm.html" class="sidebar-link">npm</a></li><li><a href="/nodejs/web-apps-with-express.html" class="sidebar-link">Web Apps With Express</a></li><li><a href="/nodejs/filesystem-i-o.html" class="sidebar-link">Filesystem I/O</a></li><li><a href="/nodejs/exporting-and-consuming-modules.html" class="sidebar-link">Exporting and Consuming Modules</a></li><li><a href="/nodejs/exporting-and-importing-module-in-node-js.html" class="sidebar-link">Exporting and Importing Module in node.js</a></li><li><a href="/nodejs/how-modules-are-loaded.html" class="sidebar-link">How modules are loaded</a></li><li><a href="/nodejs/cluster-module.html" class="sidebar-link">Cluster Module</a></li><li><a href="/nodejs/readline.html" class="sidebar-link">Readline</a></li><li><a href="/nodejs/package-json.html" class="sidebar-link">package.json</a></li><li><a href="/nodejs/event-emitters.html" class="sidebar-link">Event Emitters</a></li><li><a href="/nodejs/autoreload-on-changes.html" class="sidebar-link">Autoreload on changes</a></li><li><a href="/nodejs/environment.html" class="sidebar-link">Environment</a></li><li><a href="/nodejs/callback-to-promise.html" class="sidebar-link">Callback to Promise</a></li><li><a href="/nodejs/executing-files-or-commands-with-child-processes.html" class="sidebar-link">Executing files or commands with Child Processes</a></li><li><a href="/nodejs/exception-handling.html" class="sidebar-link">Exception handling</a></li><li><a href="/nodejs/keep-a-node-application-constantly-running.html" class="sidebar-link">Keep a node application constantly running</a></li><li><a href="/nodejs/uninstalling-node-js.html" class="sidebar-link">Uninstalling Node.js</a></li><li><a href="/nodejs/nvm-node-version-manager.html" class="sidebar-link">nvm - Node Version Manager</a></li><li><a href="/nodejs/http.html" class="sidebar-link">http</a></li><li><a href="/nodejs/using-streams.html" class="sidebar-link">Using Streams</a></li><li><a href="/nodejs/deploying-node-js-applications-in-production.html" class="sidebar-link">Deploying Node.js applications in production</a></li><li><a href="/nodejs/securing-node-js-applications.html" class="sidebar-link">Securing Node.js applications</a></li><li><a href="/nodejs/mongoose-library.html" class="sidebar-link">Mongoose Library</a></li><li><a href="/nodejs/async-js.html" class="sidebar-link">async.js</a></li><li><a href="/nodejs/file-upload.html" class="sidebar-link">File upload</a></li><li><a href="/nodejs/socket-io-communication.html" class="sidebar-link">Socket.io communication</a></li><li><a href="/nodejs/mongodb-integration.html" class="sidebar-link">Mongodb integration</a></li><li><a href="/nodejs/handling-post-request-in-node-js.html" class="sidebar-link">Handling POST request in Node.js</a></li><li><a href="/nodejs/simple-rest-based-crud-api.html" class="sidebar-link">Simple REST based CRUD API</a></li><li><a href="/nodejs/template-frameworks.html" class="sidebar-link">Template frameworks</a></li><li><a href="/nodejs/node-js-architecture-inner-workings.html" class="sidebar-link">Node.js Architecture &amp; Inner Workings</a></li><li><a href="/nodejs/debugging-node-js-application.html" class="sidebar-link">Debugging Node.js application</a></li><li><a href="/nodejs/node-server-without-framework.html" class="sidebar-link">Node server without framework</a></li><li><a href="/nodejs/node-js-with-es6.html" class="sidebar-link">Node.JS with ES6</a></li><li><a href="/nodejs/interacting-with-console.html" class="sidebar-link">Interacting with Console</a></li><li><a href="/nodejs/cassandra-integration.html" class="sidebar-link">Cassandra Integration</a></li><li><a href="/nodejs/creating-api-s-with-node-js.html" class="sidebar-link">Creating API's with Node.js</a></li><li><a href="/nodejs/graceful-shutdown.html" class="sidebar-link">Graceful Shutdown</a></li><li><a href="/nodejs/using-iisnode-to-host-node-js-web-apps-in-iis.html" class="sidebar-link">Using IISNode to host Node.js Web Apps in IIS</a></li><li><a href="/nodejs/cli.html" class="sidebar-link">CLI</a></li><li><a href="/nodejs/nodejs-frameworks.html" class="sidebar-link">NodeJS Frameworks</a></li><li><a href="/nodejs/grunt.html" class="sidebar-link">grunt</a></li><li><a href="/nodejs/using-websocket-s-with-node-js.html" class="sidebar-link">Using WebSocket's with Node.JS</a></li><li><a href="/nodejs/metalsmith.html" class="sidebar-link">metalsmith</a></li><li><a href="/nodejs/parsing-command-line-arguments.html" class="sidebar-link">Parsing command line arguments</a></li><li><a href="/nodejs/client-server-communication.html" class="sidebar-link">Client-server communication</a></li><li><a href="/nodejs/node-js-design-fundamental.html" class="sidebar-link">Node.js Design Fundamental</a></li><li><a href="/nodejs/connect-to-mongodb.html" class="sidebar-link">Connect to Mongodb</a></li><li><a href="/nodejs/performance-challenges.html" class="sidebar-link">Performance challenges</a></li><li><a href="/nodejs/send-web-notification.html" class="sidebar-link">Send Web Notification</a></li><li><a href="/nodejs/remote-debugging-in-node-js.html" class="sidebar-link">Remote Debugging in Node.JS</a></li><li><a href="/nodejs/database-mongodb-with-mongoose.html" class="sidebar-link">Database (MongoDB with Mongoose)</a></li><li><a href="/nodejs/good-coding-style.html" class="sidebar-link">Good coding style</a></li><li><a href="/nodejs/restful-api-design-best-practices.html" class="sidebar-link">Restful API Design: Best Practices</a></li><li><a href="/nodejs/deliver-html-or-any-other-sort-of-file.html" class="sidebar-link">Deliver HTML or any other sort of file</a></li><li><a href="/nodejs/tcp-sockets.html" class="sidebar-link">TCP Sockets</a></li><li><a href="/nodejs/hack.html" class="sidebar-link">Hack</a></li><li><a href="/nodejs/bluebird-promises.html" class="sidebar-link">Bluebird Promises</a></li><li><a href="/nodejs/async-await.html" class="sidebar-link">Async/Await</a></li><li><a href="/nodejs/koa-framework-v2.html" class="sidebar-link">Koa Framework v2</a></li><li><a href="/nodejs/unit-testing-frameworks.html" class="sidebar-link">Unit testing frameworks</a></li><li><a href="/nodejs/ecmascript-2015-es6-with-node-js.html" class="sidebar-link">ECMAScript 2015 (ES6) with Node.js</a></li><li><a href="/nodejs/routing-ajax-requests-with-express-js.html" class="sidebar-link">Routing ajax requests with Express.JS</a></li><li><a href="/nodejs/sending-a-file-stream-to-client.html" class="sidebar-link">Sending a file stream to client</a></li><li><a href="/nodejs/nodejs-with-redis.html" class="sidebar-link">NodeJS with Redis</a></li><li><a href="/nodejs/using-browserfiy-to-resolve-required-error-with-browsers.html" class="sidebar-link">Using Browserfiy to resolve 'required' error with browsers</a></li><li><a href="/nodejs/node-js-and-mongodb.html" aria-current="page" class="active sidebar-link">Node.JS and MongoDB.</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nodejs/node-js-and-mongodb.html#connecting-to-a-database" class="sidebar-link">Connecting To a Database</a></li><li class="sidebar-sub-header"><a href="/nodejs/node-js-and-mongodb.html#creating-new-collection" class="sidebar-link">Creating New Collection</a></li><li class="sidebar-sub-header"><a href="/nodejs/node-js-and-mongodb.html#inserting-documents" class="sidebar-link">Inserting Documents</a></li><li class="sidebar-sub-header"><a href="/nodejs/node-js-and-mongodb.html#reading" class="sidebar-link">Reading</a></li><li class="sidebar-sub-header"><a href="/nodejs/node-js-and-mongodb.html#updating" class="sidebar-link">Updating</a></li><li class="sidebar-sub-header"><a href="/nodejs/node-js-and-mongodb.html#deleting" class="sidebar-link">Deleting</a></li></ul></li><li><a href="/nodejs/passport-integration.html" class="sidebar-link">Passport integration</a></li><li><a href="/nodejs/dependency-injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/nodejs/nodejs-beginner-guide.html" class="sidebar-link">NodeJS Beginner Guide</a></li><li><a href="/nodejs/use-cases-of-node-js.html" class="sidebar-link">Use Cases of Node.js</a></li><li><a href="/nodejs/sequelize-js.html" class="sidebar-link">Sequelize.js</a></li><li><a href="/nodejs/postgresql-integration.html" class="sidebar-link">PostgreSQL integration</a></li><li><a href="/nodejs/mysql-integration.html" class="sidebar-link">MySQL integration</a></li><li><a href="/nodejs/mysql-connection-pool.html" class="sidebar-link">Mysql Connection Pool</a></li><li><a href="/nodejs/mssql-intergration.html" class="sidebar-link">MSSQL Intergration</a></li><li><a href="/nodejs/node-js-with-oracle.html" class="sidebar-link">Node.js with Oracle</a></li><li><a href="/nodejs/synchronous-vs-asynchronous-programming-in-nodejs.html" class="sidebar-link">Synchronous vs Asynchronous programming in nodejs</a></li><li><a href="/nodejs/node-js-error-management.html" class="sidebar-link">Node.js Error Management</a></li><li><a href="/nodejs/node-js-v6-new-features-and-improvement.html" class="sidebar-link">Node.js v6 New Features and Improvement</a></li><li><a href="/nodejs/eventloop.html" class="sidebar-link">Eventloop</a></li><li><a href="/nodejs/nodejs-history.html" class="sidebar-link">Nodejs History</a></li><li><a href="/nodejs/passport-js.html" class="sidebar-link">passport.js</a></li><li><a href="/nodejs/asynchronous-programming.html" class="sidebar-link">Asynchronous programming</a></li><li><a href="/nodejs/node-js-code-for-stdin-and-stdout-without-using-any-library.html" class="sidebar-link">Node.js code for STDIN and STDOUT without using  any library</a></li><li><a href="/nodejs/mongodb-integration-for-node-js-express-js.html" class="sidebar-link">MongoDB Integration for Node.js/Express.js</a></li><li><a href="/nodejs/lodash.html" class="sidebar-link">Lodash</a></li><li><a href="/nodejs/csv-parser-in-node-js.html" class="sidebar-link">csv parser in node js</a></li><li><a href="/nodejs/loopback-rest-based-connector.html" class="sidebar-link">Loopback - REST Based connector</a></li><li><a href="/nodejs/running-node-js-as-a-service.html" class="sidebar-link">Running node.js as a service</a></li><li><a href="/nodejs/node-js-with-cors.html" class="sidebar-link">Node.js with CORS</a></li><li><a href="/nodejs/getting-started-with-nodes-profiling.html" class="sidebar-link">Getting started with Nodes profiling</a></li><li><a href="/nodejs/node-js-performance.html" class="sidebar-link">Node.js Performance</a></li><li><a href="/nodejs/yarn-package-manager.html" class="sidebar-link">Yarn Package Manager</a></li><li><a href="/nodejs/oauth-2-0.html" class="sidebar-link">OAuth 2.0</a></li><li><a href="/nodejs/node-js-localization.html" class="sidebar-link">Node JS Localization</a></li><li><a href="/nodejs/deploying-node-js-application-without-downtime.html" class="sidebar-link">Deploying Node.js application without downtime.</a></li><li><a href="/nodejs/node-js-express-js-with-angular-js-sample-code.html" class="sidebar-link">Node.js (express.js) with angular.js Sample code</a></li><li><a href="/nodejs/nodejs-routing.html" class="sidebar-link">NodeJs Routing</a></li><li><a href="/nodejs/creating-a-node-js-library-that-supports-both-promises-and-error-first-callbacks.html" class="sidebar-link">Creating a Node.js Library that Supports Both Promises and Error-First Callbacks</a></li><li><a href="/nodejs/project-structure.html" class="sidebar-link">Project Structure</a></li><li><a href="/nodejs/avoid-callback-hell.html" class="sidebar-link">Avoid callback hell</a></li><li><a href="/nodejs/arduino-communication-with-nodejs.html" class="sidebar-link">Arduino communication with nodeJs</a></li><li><a href="/nodejs/n-api.html" class="sidebar-link">N-API</a></li><li><a href="/nodejs/multithreading.html" class="sidebar-link">Multithreading</a></li><li><a href="/nodejs/windows-authentication-under-node-js.html" class="sidebar-link">Windows authentication under node.js</a></li><li><a href="/nodejs/require.html" class="sidebar-link">Require()</a></li><li><a href="/nodejs/route-controller-service-structure-for-expressjs.html" class="sidebar-link">Route-Controller-Service structure for ExpressJS</a></li><li><a href="/nodejs/push-notifications.html" class="sidebar-link">Push notifications</a></li><li><a href="/nodejs/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="node-js-and-mongodb"><a href="#node-js-and-mongodb" class="header-anchor">#</a> Node.JS and MongoDB.</h1> <h2 id="connecting-to-a-database"><a href="#connecting-to-a-database" class="header-anchor">#</a> Connecting To a Database</h2> <p>To connect to a mongo database from node application we require mongoose.</p> <p>Installing Mongoose
Go to the toot of your application and install mongoose by</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install mongoose

</code></pre></div><p>Next we connect to the database.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//connect to the test database running on default mongod port of localhost  </span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://localhost/test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token comment">//Connecting with custom credentials</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://USER:PASSWORD@HOST:PORT/DATABASE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">//Using Pool Size to define the number of connections opening</span>
<span class="token comment">//Also you can use a call back function for error handling</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://localhost:27017/consumers'</span><span class="token punctuation">,</span> 
                 <span class="token punctuation">{</span>server<span class="token operator">:</span> <span class="token punctuation">{</span> poolSize<span class="token operator">:</span> <span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                 <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error in this'</span><span class="token punctuation">)</span>
                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">// Do whatever to handle the error </span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Connected to the database'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

</code></pre></div><h2 id="creating-new-collection"><a href="#creating-new-collection" class="header-anchor">#</a> Creating New Collection</h2> <p>With Mongoose, everything is derived from a Schema. Lets create a schema.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
<span class="token keyword">var</span> Schema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>

<span class="token keyword">var</span> AutoSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name <span class="token operator">:</span> String<span class="token punctuation">,</span>
    countOf<span class="token operator">:</span> Number<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// defining the document structure </span>

<span class="token comment">// by default the collection created in the db would be the first parameter we use (or the plural of it)    </span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Auto'</span><span class="token punctuation">,</span> AutoSchema<span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// we can over write it and define the collection name by specifying that in the third parameters. </span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Auto'</span><span class="token punctuation">,</span> AutoSchema<span class="token punctuation">,</span> <span class="token string">'collectionName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 


<span class="token comment">// We can also define methods in the models. </span>
AutoSchema<span class="token punctuation">.</span>methods<span class="token punctuation">.</span><span class="token function-variable function">speak</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> greeting <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name
    <span class="token operator">?</span> <span class="token string">&quot;Hello this is  &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span> <span class="token string">&quot; and I have counts of &quot;</span><span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>countOf
    <span class="token operator">:</span> <span class="token string">&quot;I don't have a name&quot;</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Auto'</span><span class="token punctuation">,</span> AutoSchema<span class="token punctuation">,</span> <span class="token string">'collectionName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

</code></pre></div><p>Remember methods must be added to the schema before compiling it with mongoose.model() like done above ..</p> <h2 id="inserting-documents"><a href="#inserting-documents" class="header-anchor">#</a> Inserting Documents</h2> <p>For inserting a new document in the collection, we create a object of the schema.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Auto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'models/auto'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> autoObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Auto</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;NewName&quot;</span><span class="token punctuation">,</span> 
    countOf<span class="token operator">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>We save it like the following</p> <div class="language-js extra-class"><pre class="language-js"><code>autoObj<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> insertedAuto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    insertedAuto<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// output: Hello this is NewName and I have counts of 10</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>This will insert a new document in the collection</p> <h2 id="reading"><a href="#reading" class="header-anchor">#</a> Reading</h2> <p>Reading Data from the collection is very easy. Getting all data of the collection.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Auto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'models/auto'</span><span class="token punctuation">)</span>
Auto<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> autos</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// will return a json array of all the documents in the collection</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>autos<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>Reading data with a condition</p> <div class="language-js extra-class"><pre class="language-js"><code>Auto<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>countOf<span class="token operator">:</span> <span class="token punctuation">{</span>$gte<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> autos</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// will return a json array of all the documents in the collection whose count is greater than 5</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>autos<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>You can also specify the second parameter as object of what all fields you need</p> <div class="language-js extra-class"><pre class="language-js"><code>Auto<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> autos</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// will return a json array of name field of all the documents in the collection</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>autos<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>Finding one document in a collection.</p> <div class="language-js extra-class"><pre class="language-js"><code>Auto<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;newName&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> auto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">//will return the first object of the document whose name is &quot;newName&quot;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>auto<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>Finding one document in a collection by id .</p> <div class="language-js extra-class"><pre class="language-js"><code>Auto<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> auto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">//will return the first json object of the document whose id is 123</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>auto<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="updating"><a href="#updating" class="header-anchor">#</a> Updating</h2> <p>For updating collections and documents we can use any of these methods:</p> <h3 id="methods"><a href="#methods" class="header-anchor">#</a> Methods</h3> <ul><li>update()</li> <li>updateOne()</li> <li>updateMany()</li> <li>replaceOne()</li></ul> <h3 id="update"><a href="#update" class="header-anchor">#</a> Update()</h3> <p><strong>The update() method modifies one or many documents (update parameters)</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>lights<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>
   <span class="token punctuation">{</span> room<span class="token operator">:</span> <span class="token string">&quot;Bedroom&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token string">&quot;On&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

</code></pre></div><p>This operation searches the 'lights' collection for a document where <code>room</code> is <strong>Bedroom</strong> <strong>(1st parameter)</strong>. It then updates the matching documents <code>status</code> property to <strong>On</strong> <strong>(2nd parameter)</strong> and returns a  WriteResult object that looks like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span> <span class="token string">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>

</code></pre></div><h3 id="updateone"><a href="#updateone" class="header-anchor">#</a> UpdateOne</h3> <p><strong>The UpdateOne() method modifies ONE document (update parameters)</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>countries<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>
   <span class="token punctuation">{</span> country<span class="token operator">:</span> <span class="token string">&quot;Sweden&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span> capital<span class="token operator">:</span> <span class="token string">&quot;Stockholm&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

</code></pre></div><p>This operation searches the 'countries' collection for a document where <code>country</code> is <strong>Sweden</strong> <strong>(1st parameter)</strong>. It then updates the matching documents property <code>capital</code>  to <strong>Stockholm</strong> <strong>(2nd parameter)</strong> and returns a  WriteResult object that looks like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span> <span class="token string">&quot;acknowledged&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">&quot;matchedCount&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;modifiedCount&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>

</code></pre></div><h3 id="updatemany"><a href="#updatemany" class="header-anchor">#</a> UpdateMany</h3> <p><strong>The UpdateMany() method modifies multible documents (update parameters)</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>food<span class="token punctuation">.</span><span class="token function">updateMany</span><span class="token punctuation">(</span>
   <span class="token punctuation">{</span> sold<span class="token operator">:</span> <span class="token punctuation">{</span> $lt<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span> $set<span class="token operator">:</span> <span class="token punctuation">{</span> sold<span class="token operator">:</span> <span class="token number">55</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

</code></pre></div><p>This operation updates all documents <strong>(in a 'food' collection)</strong> where <code>sold</code> is <strong>lesser than 10</strong> *(1st parameter) by setting <code>sold</code> to <strong>55</strong>. It then returns a  WriteResult object that looks like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span> <span class="token string">&quot;acknowledged&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">&quot;matchedCount&quot;</span> <span class="token operator">:</span> a<span class="token punctuation">,</span> <span class="token string">&quot;modifiedCount&quot;</span> <span class="token operator">:</span> b <span class="token punctuation">}</span>

</code></pre></div><p>a = Number of matched documents<br>
b = Number of modified documents</p> <h3 id="replaceone"><a href="#replaceone" class="header-anchor">#</a> ReplaceOne</h3> <p><strong>Replaces the first matching document (replacement document)</strong></p> <p>This example collection called <strong>countries</strong> contains 3 documents:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;country&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Sweden&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;country&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Norway&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;country&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Spain&quot;</span> <span class="token punctuation">}</span>

</code></pre></div><p>The following operation replaces the document <code>{ country: &quot;Spain&quot; }</code> with document <code>{ country: &quot;Finland&quot; }</code></p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>countries<span class="token punctuation">.</span><span class="token function">replaceOne</span><span class="token punctuation">(</span>
   <span class="token punctuation">{</span> country<span class="token operator">:</span> <span class="token string">&quot;Spain&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span> country<span class="token operator">:</span> <span class="token string">&quot;Finland&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

</code></pre></div><p>And returns:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span> <span class="token string">&quot;acknowledged&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">&quot;matchedCount&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;modifiedCount&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>

</code></pre></div><p>The example collection <strong>countries</strong> now contains:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;country&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Sweden&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;country&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Norway&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;country&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Finland&quot;</span> <span class="token punctuation">}</span>

</code></pre></div><h2 id="deleting"><a href="#deleting" class="header-anchor">#</a> Deleting</h2> <p>Deleting documents from a collection in mongoose is done in the following manner.</p> <div class="language-js extra-class"><pre class="language-js"><code>Auto<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// this will specify the mongo default delete result.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>These are the basic CRUD operations for using mongo db with nodejs.</p> <p>Question: Are there other ways you can do what is done here ??</p> <p>Answer :  Yes, there are numerous way to do this.</p> <p>Question: Is using mongoose necessary ??</p> <p>Answer :  No. There are other packages available which can help you.</p> <p>Question: Where can I get full documentation of mongoose ??</p> <p>Answer: <a href="http://mongoosejs.com/docs/api.html" target="_blank" rel="noopener noreferrer">Click Here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/nodejs/node-js-and-mongodb.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/nodejs/using-browserfiy-to-resolve-required-error-with-browsers.html" class="prev">
        Using Browserfiy to resolve 'required' error with browsers
      </a></span> <span class="next"><a href="/nodejs/passport-integration.html">
        Passport integration
      </a>
      
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/2219.77f75793.js" defer></script>
  </body>
</html>
