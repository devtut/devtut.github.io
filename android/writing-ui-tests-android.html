<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Android - Writing UI tests - Android</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="MockWebServer example, IdlingResource">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Android - Writing UI tests - Android">
    <meta property="og:description" content="MockWebServer example, IdlingResource">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/android/writing-ui-tests-android.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Android - Writing UI tests - Android">
    <meta name="twitter:description" content="MockWebServer example, IdlingResource">
    <meta name="twitter:url" content="/android/writing-ui-tests-android.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/341.0a380304.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Android</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/android/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/android/getting-started-with-android.html" class="sidebar-link">Getting started with Android</a></li><li><a href="/android/android-studio.html" class="sidebar-link">Android Studio</a></li><li><a href="/android/instant-run-in-android-studio.html" class="sidebar-link">Instant Run in Android Studio</a></li><li><a href="/android/textview.html" class="sidebar-link">TextView</a></li><li><a href="/android/autocompletetextview.html" class="sidebar-link">AutoCompleteTextView</a></li><li><a href="/android/autosizing-textviews.html" class="sidebar-link">Autosizing TextViews</a></li><li><a href="/android/listview.html" class="sidebar-link">ListView</a></li><li><a href="/android/layouts.html" class="sidebar-link">Layouts</a></li><li><a href="/android/constraintlayout.html" class="sidebar-link">ConstraintLayout</a></li><li><a href="/android/textinputlayout.html" class="sidebar-link">TextInputLayout</a></li><li><a href="/android/coordinatorlayout-and-behaviors.html" class="sidebar-link">CoordinatorLayout and Behaviors</a></li><li><a href="/android/tablayout.html" class="sidebar-link">TabLayout</a></li><li><a href="/android/viewpager.html" class="sidebar-link">ViewPager</a></li><li><a href="/android/cardview.html" class="sidebar-link">CardView</a></li><li><a href="/android/navigationview.html" class="sidebar-link">NavigationView</a></li><li><a href="/android/recyclerview.html" class="sidebar-link">RecyclerView</a></li><li><a href="/android/recyclerview-decorations.html" class="sidebar-link">RecyclerView Decorations</a></li><li><a href="/android/recyclerview-onclicklisteners.html" class="sidebar-link">RecyclerView onClickListeners</a></li><li><a href="/android/recyclerview-and-layoutmanagers.html" class="sidebar-link">RecyclerView and LayoutManagers</a></li><li><a href="/android/pagination-in-recyclerview.html" class="sidebar-link">Pagination in RecyclerView</a></li><li><a href="/android/imageview.html" class="sidebar-link">ImageView</a></li><li><a href="/android/videoview.html" class="sidebar-link">VideoView</a></li><li><a href="/android/optimized-videoview.html" class="sidebar-link">Optimized VideoView</a></li><li><a href="/android/webview.html" class="sidebar-link">WebView</a></li><li><a href="/android/searchview.html" class="sidebar-link">SearchView</a></li><li><a href="/android/bottomnavigationview.html" class="sidebar-link">BottomNavigationView</a></li><li><a href="/android/canvas-drawing-using-surfaceview.html" class="sidebar-link">Canvas drawing using SurfaceView</a></li><li><a href="/android/creating-custom-views.html" class="sidebar-link">Creating Custom Views</a></li><li><a href="/android/getting-calculated-view-dimensions.html" class="sidebar-link">Getting Calculated View Dimensions</a></li><li><a href="/android/adding-a-fuseview-to-an-android-project.html" class="sidebar-link">Adding a FuseView to an Android Project</a></li><li><a href="/android/supporting-screens-with-different-resolutions-sizes.html" class="sidebar-link">Supporting Screens With Different Resolutions, Sizes</a></li><li><a href="/android/viewflipper.html" class="sidebar-link">ViewFlipper</a></li><li><a href="/android/design-patterns.html" class="sidebar-link">Design Patterns</a></li><li><a href="/android/activity.html" class="sidebar-link">Activity</a></li><li><a href="/android/activity-recognition.html" class="sidebar-link">Activity Recognition</a></li><li><a href="/android/split-screen-multi-screen-activities.html" class="sidebar-link">Split Screen / Multi-Screen Activities</a></li><li><a href="/android/material-design.html" class="sidebar-link">Material Design</a></li><li><a href="/android/resources.html" class="sidebar-link">Resources</a></li><li><a href="/android/data-binding-library.html" class="sidebar-link">Data Binding Library</a></li><li><a href="/android/context.html" class="sidebar-link">Context</a></li><li><a href="/android/sharedpreferences.html" class="sidebar-link">SharedPreferences</a></li><li><a href="/android/intent.html" class="sidebar-link">Intent</a></li><li><a href="/android/fragments.html" class="sidebar-link">Fragments</a></li><li><a href="/android/button.html" class="sidebar-link">Button</a></li><li><a href="/android/emulator.html" class="sidebar-link">Emulator</a></li><li><a href="/android/service.html" class="sidebar-link">Service</a></li><li><a href="/android/the-manifest-file.html" class="sidebar-link">The Manifest File</a></li><li><a href="/android/gradle-for-android.html" class="sidebar-link">Gradle for Android</a></li><li><a href="/android/fileio-with-android.html" class="sidebar-link">FileIO with Android</a></li><li><a href="/android/fileprovider.html" class="sidebar-link">FileProvider</a></li><li><a href="/android/storing-files-in-internal-external-storage.html" class="sidebar-link">Storing Files in Internal &amp; External Storage</a></li><li><a href="/android/zip-file-in-android.html" class="sidebar-link">Zip file in android</a></li><li><a href="/android/unzip-file-in-android.html" class="sidebar-link">Unzip File in Android</a></li><li><a href="/android/camera-and-gallery.html" class="sidebar-link">Camera and Gallery</a></li><li><a href="/android/camera-2-api.html" class="sidebar-link">Camera 2 API</a></li><li><a href="/android/fingerprint-api-in-android.html" class="sidebar-link">Fingerprint API in android</a></li><li><a href="/android/bluetooth-and-bluetooth-le-api.html" class="sidebar-link">Bluetooth and Bluetooth LE API</a></li><li><a href="/android/runtime-permissions-in-api-23.html" class="sidebar-link">Runtime Permissions in API-23 +</a></li><li><a href="/android/android-places-api.html" class="sidebar-link">Android Places API</a></li><li><a href="/android/android-ndk.html" class="sidebar-link">Android NDK</a></li><li><a href="/android/daynight-theme-appcompat-v23-2-api-14.html" class="sidebar-link">DayNight Theme (AppCompat v23.2 / API 14+)</a></li><li><a href="/android/glide.html" class="sidebar-link">Glide</a></li><li><a href="/android/dialog.html" class="sidebar-link">Dialog</a></li><li><a href="/android/enhancing-alert-dialogs.html" class="sidebar-link">Enhancing Alert Dialogs</a></li><li><a href="/android/animated-alertdialog-box.html" class="sidebar-link">Animated AlertDialog Box</a></li><li><a href="/android/greendao.html" class="sidebar-link">GreenDAO</a></li><li><a href="/android/tools-attributes.html" class="sidebar-link">Tools Attributes</a></li><li><a href="/android/formatting-strings.html" class="sidebar-link">Formatting Strings</a></li><li><a href="/android/spannablestring.html" class="sidebar-link">SpannableString</a></li><li><a href="/android/notifications.html" class="sidebar-link">Notifications</a></li><li><a href="/android/alarmmanager.html" class="sidebar-link">AlarmManager</a></li><li><a href="/android/handler.html" class="sidebar-link">Handler</a></li><li><a href="/android/broadcastreceiver.html" class="sidebar-link">BroadcastReceiver</a></li><li><a href="/android/ui-lifecycle.html" class="sidebar-link">UI Lifecycle</a></li><li><a href="/android/httpurlconnection.html" class="sidebar-link">HttpURLConnection</a></li><li><a href="/android/callback-url.html" class="sidebar-link">Callback URL</a></li><li><a href="/android/snackbar.html" class="sidebar-link">Snackbar</a></li><li><a href="/android/widgets.html" class="sidebar-link">Widgets</a></li><li><a href="/android/toast.html" class="sidebar-link">Toast</a></li><li><a href="/android/create-singleton-class-for-toast-message.html" class="sidebar-link">Create Singleton Class for Toast Message</a></li><li><a href="/android/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/android/animators.html" class="sidebar-link">Animators</a></li><li><a href="/android/location.html" class="sidebar-link">Location</a></li><li><a href="/android/theme-style-attribute.html" class="sidebar-link">Theme, Style, Attribute</a></li><li><a href="/android/mediaplayer.html" class="sidebar-link">MediaPlayer</a></li><li><a href="/android/android-sound-and-media.html" class="sidebar-link">Android Sound and Media</a></li><li><a href="/android/mediasession.html" class="sidebar-link">MediaSession</a></li><li><a href="/android/mediastore.html" class="sidebar-link">MediaStore</a></li><li><a href="/android/multidex-and-the-dex-method-limit.html" class="sidebar-link">Multidex and the Dex Method Limit</a></li><li><a href="/android/data-synchronization-with-sync-adapter.html" class="sidebar-link">Data Synchronization with Sync Adapter</a></li><li><a href="/android/porterduff-mode.html" class="sidebar-link">PorterDuff Mode</a></li><li><a href="/android/menu.html" class="sidebar-link">Menu</a></li><li><a href="/android/picasso.html" class="sidebar-link">Picasso</a></li><li><a href="/android/roboguice.html" class="sidebar-link">RoboGuice</a></li><li><a href="/android/acra.html" class="sidebar-link">ACRA</a></li><li><a href="/android/parcelable.html" class="sidebar-link">Parcelable</a></li><li><a href="/android/retrofit2.html" class="sidebar-link">Retrofit2</a></li><li><a href="/android/butterknife.html" class="sidebar-link">ButterKnife</a></li><li><a href="/android/volley.html" class="sidebar-link">Volley</a></li><li><a href="/android/date-and-time-pickers.html" class="sidebar-link">Date and Time Pickers</a></li><li><a href="/android/localized-date-time-in-android.html" class="sidebar-link">Localized Date/Time in Android</a></li><li><a href="/android/time-utils.html" class="sidebar-link">Time Utils</a></li><li><a href="/android/in-app-billing.html" class="sidebar-link">In-app Billing</a></li><li><a href="/android/floatingactionbutton.html" class="sidebar-link">FloatingActionButton</a></li><li><a href="/android/touch-events.html" class="sidebar-link">Touch Events</a></li><li><a href="/android/handling-touch-and-motion-events.html" class="sidebar-link">Handling touch and motion events</a></li><li><a href="/android/detect-shake-event-in-android.html" class="sidebar-link">Detect Shake Event in Android</a></li><li><a href="/android/hardware-button-events-intents-ptt-lwp-etc.html" class="sidebar-link">Hardware Button Events/Intents (PTT, LWP, etc.)</a></li><li><a href="/android/greenrobot-eventbus.html" class="sidebar-link">GreenRobot EventBus</a></li><li><a href="/android/otto-event-bus.html" class="sidebar-link">Otto Event Bus</a></li><li><a href="/android/vibration.html" class="sidebar-link">Vibration</a></li><li><a href="/android/contentprovider.html" class="sidebar-link">ContentProvider</a></li><li><a href="/android/dagger-2.html" class="sidebar-link">Dagger 2</a></li><li><a href="/android/realm.html" class="sidebar-link">Realm</a></li><li><a href="/android/android-versions.html" class="sidebar-link">Android Versions</a></li><li><a href="/android/wi-fi-connections.html" class="sidebar-link">Wi-Fi Connections</a></li><li><a href="/android/sensormanager.html" class="sidebar-link">SensorManager</a></li><li><a href="/android/progressbar.html" class="sidebar-link">ProgressBar</a></li><li><a href="/android/custom-fonts.html" class="sidebar-link">Custom Fonts</a></li><li><a href="/android/getting-system-font-names-and-using-the-fonts.html" class="sidebar-link">Getting system font names and using the fonts</a></li><li><a href="/android/text-to-speech-tts.html" class="sidebar-link">Text to Speech(TTS)</a></li><li><a href="/android/spinner.html" class="sidebar-link">Spinner</a></li><li><a href="/android/data-encryption-decryption.html" class="sidebar-link">Data Encryption/Decryption</a></li><li><a href="/android/okhttp.html" class="sidebar-link">OkHttp</a></li><li><a href="/android/handling-deep-links.html" class="sidebar-link">Handling Deep Links</a></li><li><a href="/android/crash-reporting-tools.html" class="sidebar-link">Crash Reporting Tools</a></li><li><a href="/android/check-internet-connectivity.html" class="sidebar-link">Check Internet Connectivity</a></li><li><a href="/android/creating-your-own-libraries-for-android-applications.html" class="sidebar-link">Creating your own libraries for Android applications</a></li><li><a href="/android/device-display-metrics.html" class="sidebar-link">Device Display Metrics</a></li><li><a href="/android/building-backwards-compatible-apps.html" class="sidebar-link">Building Backwards Compatible Apps</a></li><li><a href="/android/loader.html" class="sidebar-link">Loader</a></li><li><a href="/android/proguard-obfuscating-and-shrinking-your-code.html" class="sidebar-link">ProGuard - Obfuscating and Shrinking your code</a></li><li><a href="/android/typedef-annotations-intdef-stringdef.html" class="sidebar-link">Typedef Annotations: @IntDef, @StringDef</a></li><li><a href="/android/capturing-screenshots.html" class="sidebar-link">Capturing Screenshots</a></li><li><a href="/android/mvp-architecture.html" class="sidebar-link">MVP Architecture</a></li><li><a href="/android/orientation-changes.html" class="sidebar-link">Orientation Changes</a></li><li><a href="/android/xposed.html" class="sidebar-link">Xposed</a></li><li><a href="/android/packagemanager.html" class="sidebar-link">PackageManager</a></li><li><a href="/android/gesture-detection.html" class="sidebar-link">Gesture Detection</a></li><li><a href="/android/doze-mode.html" class="sidebar-link">Doze Mode</a></li><li><a href="/android/colors.html" class="sidebar-link">Colors</a></li><li><a href="/android/keyboard.html" class="sidebar-link">Keyboard</a></li><li><a href="/android/renderscript.html" class="sidebar-link">RenderScript</a></li><li><a href="/android/fresco.html" class="sidebar-link">Fresco</a></li><li><a href="/android/swipe-to-refresh.html" class="sidebar-link">Swipe to Refresh</a></li><li><a href="/android/creating-splash-screen.html" class="sidebar-link">Creating Splash screen</a></li><li><a href="/android/intentservice.html" class="sidebar-link">IntentService</a></li><li><a href="/android/implicit-intents.html" class="sidebar-link">Implicit Intents</a></li><li><a href="/android/publish-to-play-store.html" class="sidebar-link">Publish to Play Store</a></li><li><a href="/android/universal-image-loader.html" class="sidebar-link">Universal Image Loader</a></li><li><a href="/android/image-compression.html" class="sidebar-link">Image Compression</a></li><li><a href="/android/9-patch-images.html" class="sidebar-link">9-Patch Images</a></li><li><a href="/android/email-validation.html" class="sidebar-link">Email Validation</a></li><li><a href="/android/bottom-sheets.html" class="sidebar-link">Bottom Sheets</a></li><li><a href="/android/edittext.html" class="sidebar-link">EditText</a></li><li><a href="/android/speech-to-text-conversion.html" class="sidebar-link">Speech to Text Conversion</a></li><li><a href="/android/installing-apps-with-adb.html" class="sidebar-link">Installing apps with ADB</a></li><li><a href="/android/count-down-timer.html" class="sidebar-link">Count Down Timer</a></li><li><a href="/android/barcode-and-qr-code-reading.html" class="sidebar-link">Barcode and QR code reading</a></li><li><a href="/android/android-paypal-gateway-integration.html" class="sidebar-link">Android Paypal Gateway Integration</a></li><li><a href="/android/drawables.html" class="sidebar-link">Drawables</a></li><li><a href="/android/transitiondrawable.html" class="sidebar-link">TransitionDrawable</a></li><li><a href="/android/vector-drawables.html" class="sidebar-link">Vector Drawables</a></li><li><a href="/android/vectordrawable-and-animatedvectordrawable.html" class="sidebar-link">VectorDrawable and AnimatedVectorDrawable</a></li><li><a href="/android/port-mapping-using-cling-library-in-android.html" class="sidebar-link">Port Mapping using Cling library in Android</a></li><li><a href="/android/creating-overlay-always-on-top-windows.html" class="sidebar-link">Creating Overlay (always-on-top) Windows</a></li><li><a href="/android/exoplayer.html" class="sidebar-link">ExoPlayer</a></li><li><a href="/android/xmpp-register-login-and-chat-simple-example.html" class="sidebar-link">XMPP register login and chat simple example</a></li><li><a href="/android/android-authenticator.html" class="sidebar-link">Android Authenticator</a></li><li><a href="/android/audiomanager.html" class="sidebar-link">AudioManager</a></li><li><a href="/android/audiotrack.html" class="sidebar-link">AudioTrack</a></li><li><a href="/android/job-scheduling.html" class="sidebar-link">Job Scheduling</a></li><li><a href="/android/accounts-and-accountmanager.html" class="sidebar-link">Accounts and AccountManager</a></li><li><a href="/android/integrate-opencv-into-android-studio.html" class="sidebar-link">Integrate OpenCV into Android Studio</a></li><li><a href="/android/mvvm-architecture.html" class="sidebar-link">MVVM (Architecture)</a></li><li><a href="/android/ormlite-in-android.html" class="sidebar-link">ORMLite in android</a></li><li><a href="/android/retrofit2-with-rxjava.html" class="sidebar-link">Retrofit2 with RxJava</a></li><li><a href="/android/shortcutmanager.html" class="sidebar-link">ShortcutManager</a></li><li><a href="/android/lrucache.html" class="sidebar-link">LruCache</a></li><li><a href="/android/jenkins-ci-setup-for-android-projects.html" class="sidebar-link">Jenkins CI setup for Android Projects</a></li><li><a href="/android/fastlane.html" class="sidebar-link">fastlane</a></li><li><a href="/android/define-step-value-increment-for-custom-rangeseekbar.html" class="sidebar-link">Define step value (increment) for custom RangeSeekBar</a></li><li><a href="/android/getting-started-with-opengl-es-2-0.html" class="sidebar-link">Getting started with OpenGL ES 2.0+</a></li><li><a href="/android/check-data-connection.html" class="sidebar-link">Check Data Connection</a></li><li><a href="/android/java-on-android.html" class="sidebar-link">Java on Android</a></li><li><a href="/android/android-java-native-interface-jni.html" class="sidebar-link">Android Java Native Interface (JNI)</a></li><li><a href="/android/notification-channel-android-o.html" class="sidebar-link">Notification Channel Android O</a></li><li><a href="/android/robolectric.html" class="sidebar-link">Robolectric</a></li><li><a href="/android/moshi.html" class="sidebar-link">Moshi</a></li><li><a href="/android/strict-mode-policy-a-tool-to-catch-the-bug-in-the-compile-time.html" class="sidebar-link">Strict Mode Policy : A tool to catch the bug in the Compile Time.</a></li><li><a href="/android/internationalization-and-localization-i18n-and-l10n.html" class="sidebar-link">Internationalization and localization (I18N and L10N)</a></li><li><a href="/android/fast-way-to-setup-retrolambda-on-an-android-project.html" class="sidebar-link">Fast way to setup Retrolambda on an android project.</a></li><li><a href="/android/how-to-use-sparsearray.html" class="sidebar-link">How to use SparseArray</a></li><li><a href="/android/shared-element-transitions.html" class="sidebar-link">Shared Element Transitions</a></li><li><a href="/android/android-things.html" class="sidebar-link">Android Things</a></li><li><a href="/android/library-dagger-2-dependency-injection-in-applications.html" class="sidebar-link">Library Dagger 2: Dependency Injection in Applications</a></li><li><a href="/android/jcodec.html" class="sidebar-link">JCodec</a></li><li><a href="/android/formatting-phone-numbers-with-pattern.html" class="sidebar-link">Formatting phone numbers with pattern.</a></li><li><a href="/android/paint.html" class="sidebar-link">Paint</a></li><li><a href="/android/what-is-proguard-what-is-use-in-android.html" class="sidebar-link">What is ProGuard? What is use in Android?</a></li><li><a href="/android/create-android-custom-roms.html" class="sidebar-link">Create Android Custom ROMs</a></li><li><a href="/android/genymotion-for-android.html" class="sidebar-link">Genymotion for android</a></li><li><a href="/android/constraintset.html" class="sidebar-link">ConstraintSet</a></li><li><a href="/android/clevertap.html" class="sidebar-link">CleverTap</a></li><li><a href="/android/publish-a-library-to-maven-repositories.html" class="sidebar-link">Publish a library to Maven Repositories</a></li><li><a href="/android/adb-shell.html" class="sidebar-link">adb shell</a></li><li><a href="/android/ping-icmp.html" class="sidebar-link">Ping ICMP</a></li><li><a href="/android/aidl.html" class="sidebar-link">AIDL</a></li><li><a href="/android/android-game-development.html" class="sidebar-link">Android game development</a></li><li><a href="/android/android-programming-with-kotlin.html" class="sidebar-link">Android programming with Kotlin</a></li><li><a href="/android/android-x86-in-virtualbox.html" class="sidebar-link">Android-x86 in VirtualBox</a></li><li><a href="/android/leakcanary.html" class="sidebar-link">Leakcanary</a></li><li><a href="/android/okio.html" class="sidebar-link">Okio</a></li><li><a href="/android/bluetooth-low-energy.html" class="sidebar-link">Bluetooth Low Energy</a></li><li><a href="/android/looper.html" class="sidebar-link">Looper</a></li><li><a href="/android/annotation-processor.html" class="sidebar-link">Annotation Processor</a></li><li><a href="/android/syncadapter-with-periodically-do-sync-of-data.html" class="sidebar-link">SyncAdapter with periodically do sync of data</a></li><li><a href="/android/fastjson.html" class="sidebar-link">Fastjson</a></li><li><a href="/android/json-in-android-with-org-json.html" class="sidebar-link">JSON in Android with org.json</a></li><li><a href="/android/gson.html" class="sidebar-link">Gson</a></li><li><a href="/android/android-architecture-components.html" class="sidebar-link">Android Architecture Components</a></li><li><a href="/android/jackson.html" class="sidebar-link">Jackson</a></li><li><a href="/android/smartcard.html" class="sidebar-link">Smartcard</a></li><li><a href="/android/security.html" class="sidebar-link">Security</a></li><li><a href="/android/how-to-store-passwords-securely.html" class="sidebar-link">How to store passwords securely</a></li><li><a href="/android/secure-sharedpreferences.html" class="sidebar-link">Secure SharedPreferences</a></li><li><a href="/android/secure-sharedpreferences.html" class="sidebar-link">Secure SharedPreferences</a></li><li><a href="/android/sqlite.html" class="sidebar-link">SQLite</a></li><li><a href="/android/accessing-sqlite-databases-using-the-contentvalues-class.html" class="sidebar-link">Accessing SQLite databases using the ContentValues class</a></li><li><a href="/android/firebase.html" class="sidebar-link">Firebase</a></li><li><a href="/android/firebase-cloud-messaging.html" class="sidebar-link">Firebase Cloud Messaging</a></li><li><a href="/android/firebase-realtime-database.html" class="sidebar-link">Firebase Realtime DataBase</a></li><li><a href="/android/firebase-app-indexing.html" class="sidebar-link">Firebase App Indexing</a></li><li><a href="/android/firebase-crash-reporting.html" class="sidebar-link">Firebase Crash Reporting</a></li><li><a href="/android/twitter-apis.html" class="sidebar-link">Twitter APIs</a></li><li><a href="/android/youtube-api.html" class="sidebar-link">Youtube-API</a></li><li><a href="/android/integrate-google-sign-in.html" class="sidebar-link">Integrate Google Sign In</a></li><li><a href="/android/google-signin-integration-on-android.html" class="sidebar-link">Google signin integration on android</a></li><li><a href="/android/google-awareness-apis.html" class="sidebar-link">Google Awareness APIs</a></li><li><a href="/android/google-maps-api-v2-for-android.html" class="sidebar-link">Google Maps API v2 for Android</a></li><li><a href="/android/google-drive-api.html" class="sidebar-link">Google Drive API</a></li><li><a href="/android/displaying-google-ads.html" class="sidebar-link">Displaying Google Ads</a></li><li><a href="/android/admob.html" class="sidebar-link">AdMob</a></li><li><a href="/android/google-play-store.html" class="sidebar-link">Google Play Store</a></li><li><a href="/android/sign-your-android-app-for-release.html" class="sidebar-link">Sign your Android App for Release</a></li><li><a href="/android/tensorflow.html" class="sidebar-link">TensorFlow</a></li><li><a href="/android/android-vk-sdk.html" class="sidebar-link">Android Vk Sdk</a></li><li><a href="/android/project-sdk-versions.html" class="sidebar-link">Project SDK versions</a></li><li><a href="/android/facebook-sdk-for-android.html" class="sidebar-link">Facebook SDK for Android</a></li><li><a href="/android/thread.html" class="sidebar-link">Thread</a></li><li><a href="/android/asynctask.html" class="sidebar-link">AsyncTask</a></li><li><a href="/android/testing-ui-with-espresso.html" class="sidebar-link">Testing UI with Espresso</a></li><li><a href="/android/writing-ui-tests-android.html" aria-current="page" class="active sidebar-link">Writing UI tests - Android</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/android/writing-ui-tests-android.html#mockwebserver-example" class="sidebar-link">MockWebServer example</a></li><li class="sidebar-sub-header"><a href="/android/writing-ui-tests-android.html#idlingresource" class="sidebar-link">IdlingResource</a></li></ul></li><li><a href="/android/unit-testing-in-android-with-junit.html" class="sidebar-link">Unit testing in Android with JUnit</a></li><li><a href="/android/inter-app-ui-testing-with-uiautomator.html" class="sidebar-link">Inter-app UI testing with UIAutomator</a></li><li><a href="/android/lint-warnings.html" class="sidebar-link">Lint Warnings</a></li><li><a href="/android/performance-optimization.html" class="sidebar-link">Performance Optimization</a></li><li><a href="/android/android-kernel-optimization.html" class="sidebar-link">Android Kernel Optimization</a></li><li><a href="/android/memory-leaks.html" class="sidebar-link">Memory Leaks</a></li><li><a href="/android/enhancing-android-performance-using-icon-fonts.html" class="sidebar-link">Enhancing Android Performance Using Icon Fonts</a></li><li><a href="/android/bitmap-cache.html" class="sidebar-link">Bitmap Cache</a></li><li><a href="/android/loading-bitmaps-effectively.html" class="sidebar-link">Loading Bitmaps Effectively</a></li><li><a href="/android/exceptions.html" class="sidebar-link">Exceptions</a></li><li><a href="/android/logging-and-using-logcat.html" class="sidebar-link">Logging and using Logcat</a></li><li><a href="/android/adb-android-debug-bridge.html" class="sidebar-link">ADB (Android Debug Bridge)</a></li><li><a href="/android/localization-with-resources-in-android.html" class="sidebar-link">Localization with resources in Android</a></li><li><a href="/android/convert-vietnamese-string-to-english-string-android.html" class="sidebar-link">Convert vietnamese string to english string Android</a></li><li><a href="/android/publish-aar-file-to-apache-archiva-with-gradle.html" class="sidebar-link">Publish .aar file to Apache Archiva with Gradle</a></li><li><a href="/android/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="writing-ui-tests-android"><a href="#writing-ui-tests-android" class="header-anchor">#</a> Writing UI tests - Android</h1> <p>Focus of this document is to represent goals and ways how to write android UI and integration tests.
<a href="http://stackoverflow.com/documentation/android/3485/testing-ui-with-espresso#t=201703302242404424973" target="_blank" rel="noopener noreferrer">Espresso<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and UIAutomator are provided by Google so focus should be around these tools and their respective wrappers e.g. Appium, Spoon etc.</p> <h2 id="mockwebserver-example"><a href="#mockwebserver-example" class="header-anchor">#</a> MockWebServer example</h2> <p>In case your activities, fragments and UI require some background processing a good thing to use is a MockWebServer which runs localy on an android device which brings a closed and testable enviroment for your UI.</p> <p><a href="https://github.com/square/okhttp/tree/master/mockwebserver" target="_blank" rel="noopener noreferrer">https://github.com/square/okhttp/tree/master/mockwebserver<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>First step is including the gradle dependency:</p> <div class="language-java extra-class"><pre class="language-java"><code>testCompile <span class="token string">'com.squareup.okhttp3:mockwebserver:(insert latest version)'</span>

</code></pre></div><p>Now steps for running and using the mock server are:</p> <ul><li>create mock server object</li> <li>start it at specific address and port (usually localhost:portnumber)</li> <li>enqueue responses for specific requests</li> <li>start the test</li></ul> <p>This is nicely explained in the github page of the mockwebserver but in our case we want something nicer and reusable for all tests, and JUnit rules will come nicely into play here:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 *JUnit  rule that starts and stops a mock web server for test runner
*/</span>
 <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MockServerRule</span> <span class="token keyword">extends</span> <span class="token class-name">UiThreadTestRule</span> <span class="token punctuation">{</span>

 <span class="token keyword">private</span> <span class="token class-name">MockWebServer</span> mServer<span class="token punctuation">;</span>

 <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MOCK_WEBSERVER_PORT <span class="token operator">=</span> <span class="token number">8000</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Statement</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Statement</span> base<span class="token punctuation">,</span> <span class="token class-name">Description</span> description<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Statement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
                <span class="token function">startServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    base<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                    <span class="token function">stopServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Returns the started web server instance
     *
     * @return mock server
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">MockWebServer</span> <span class="token function">server</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> mServer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">startServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchAlgorithmException</span> <span class="token punctuation">{</span>
        mServer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MockWebServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">mServer</span><span class="token punctuation">(</span>MOCK_WEBSERVER_PORT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token string">&quot;mock server start issue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stopServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            mServer<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Timber</span><span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> &quot;mock server shutdown error”<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Now lets assume that we have the exact same activity like in previous example,
just in this case when we push the button app will fetch something from the network for example:
<a href="https://someapi.com/name" target="_blank" rel="noopener noreferrer">https://someapi.com/name<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>This would return some text string which would be concatenated in the snackbar text e.g.
NAME + text you typed in.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* Testing of the snackbar activity with networking.
**/</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">AndroidJUnit4</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@LargeTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SnackbarActivityTest</span><span class="token punctuation">{</span>
    <span class="token comment">//espresso rule which tells which activity to start</span>
    <span class="token annotation punctuation">@Rule</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">ActivityTestRule</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SnackbarActivity</span><span class="token punctuation">&gt;</span></span> mActivityRule <span class="token operator">=</span> 
        <span class="token keyword">new</span> <span class="token class-name">ActivityTestRule</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">SnackbarActivity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//start mock web server</span>
    <span class="token annotation punctuation">@Rule</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">MockServerRule</span> mMockServerRule <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MockServerRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">tearDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
       <span class="token comment">//same as previous example</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
       <span class="token comment">//same as previous example</span>

       <span class="token operator">*</span><span class="token operator">*</span><span class="token comment">//IMPORTANT:** point your application to your mockwebserver endpoint e.g.</span>
       <span class="token class-name">MyAppConfig</span><span class="token punctuation">.</span><span class="token function">setEndpointURL</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
    *Test methods should always start with &quot;testXYZ&quot; and it is a good idea to 
    *name them after the intent what you want to test
    **/</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSnackbarIsShown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//setup mockweb server</span>
        mMockServerRule<span class="token punctuation">.</span><span class="token function">server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setDispatcher</span><span class="token punctuation">(</span><span class="token function">getDispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        mActivityRule<span class="token punctuation">.</span><span class="token function">launchActivity</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//check is our text entry displayed and enter some text to it</span>
        <span class="token class-name">String</span> textToType<span class="token operator">=</span><span class="token string">&quot;new snackbar text&quot;</span><span class="token punctuation">;</span>
        <span class="token function">onView</span><span class="token punctuation">(</span><span class="token function">withId</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>textEntry<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token function">isDisplayed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//we check is our snackbar showing text from mock webserver plus the one we typed</span>
        <span class="token function">onView</span><span class="token punctuation">(</span><span class="token function">withId</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>textEntry<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token function">typeText</span><span class="token punctuation">(</span><span class="token string">&quot;JazzJackTheRabbit&quot;</span> <span class="token operator">+</span> textToType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//click the button to show the snackbar</span>
        <span class="token function">onView</span><span class="token punctuation">(</span><span class="token function">withId</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>shownSnackbarBtn<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//assert that a view with snackbar_id with text which we typed and is displayed</span>
        <span class="token function">onView</span><span class="token punctuation">(</span><span class="token function">allOf</span><span class="token punctuation">(</span><span class="token function">withId</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>support<span class="token punctuation">.</span>design<span class="token punctuation">.</span></span>R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>snackbar_text<span class="token punctuation">)</span><span class="token punctuation">,</span> 
        <span class="token function">withText</span><span class="token punctuation">(</span>textToType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token function">isDisplayed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
     <span class="token comment">/**
     *creates a mock web server dispatcher with prerecorded requests and responses
     **/</span>
    <span class="token keyword">private</span> <span class="token class-name">Dispatcher</span> <span class="token function">getDispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">Dispatcher</span> dispatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">MockResponse</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token class-name">RecordedRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;/name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MockResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setResponseCode</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">setBody</span><span class="token punctuation">(</span><span class="token string">&quot;JazzJackTheRabbit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;no mock set up for &quot;</span> <span class="token operator">+</span> request<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dispatcher<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre></div><p>I would suggest wrapping the dispatcher in some sort of a Builder so you can easily chain and add new responses for your screens.
e.g.</p> <div class="language- extra-class"><pre class="language-text"><code>
return newDispatcherBuilder()
            .withSerializedJSONBody(&quot;/authenticate&quot;, Mocks.getAuthenticationResponse())
            .withSerializedJSONBody(&quot;/getUserInfo&quot;, Mocks.getUserInfo())
            .withSerializedJSONBody(&quot;/checkNotBot&quot;, Mocks.checkNotBot());

</code></pre></div><h2 id="idlingresource"><a href="#idlingresource" class="header-anchor">#</a> IdlingResource</h2> <p>The power of idling resources lies in not having to wait for some app's processing (networking, calculations, animations, etc.) to finish with <code>sleep()</code>, which brings flakiness and/or prolongs the tests run. The official documentation can be found <a href="https://developer.android.com/reference/android/support/test/espresso/IdlingResource.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="implementation"><a href="#implementation" class="header-anchor">#</a> Implementation</h3> <p>There are three things that you need to do when implementing <code>IdlingResource</code> interface:</p> <ul><li><strong><code>getName()</code></strong> - Returns the name of your idling resource.</li> <li><strong><code>isIdleNow()</code></strong> - Checks whether your xyz object, operation, etc. is idle at the moment.</li> <li><strong><code>registerIdleTransitionCallback</code></strong> (<code>IdlingResource.ResourceCallback</code> callback) - Provides a callback which you should call when your object transitions to idle.</li></ul> <p>Now you should create your own logic and determine when your app is idle and when not, since this is dependant on the app. Below you will find a simple example, just to show how it works. There are other examples online, but specific app implementation brings to specific idling resource implementations.</p> <h3 id="notes"><a href="#notes" class="header-anchor">#</a> NOTES</h3> <ul><li>There have been some Google examples where they put <code>IdlingResources</code> in the code of the app. <strong>Do not do this.</strong> They presumably placed it there just to show how they work.</li> <li>Keeping your code clean and maintaining single principle of responsibility is up to you!</li></ul> <h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <p>Let us say that you have an activity which does weird stuff and takes a long time for the fragment to load and thus making your Espresso tests fail by not being able to find resources from your fragment (you should change how your activity is created and when to speed it up). But in any case to keep it simple, the following example shows how it should look like.</p> <p>Our example idling resource would get two objects:</p> <ul><li>The <strong>tag</strong> of the fragment which you need to find and waiting to get attached to the activity.</li> <li>A <strong>FragmentManager</strong> object which is used for finding the fragment.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * FragmentIdlingResource - idling resource which waits while Fragment has not been loaded.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FragmentIdlingResource</span> <span class="token keyword">implements</span> <span class="token class-name">IdlingResource</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">FragmentManager</span> mFragmentManager<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> mTag<span class="token punctuation">;</span>
    <span class="token comment">//resource callback you use when your activity transitions to idle</span>
    <span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token class-name">ResourceCallback</span> resourceCallback<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">FragmentIdlingResource</span><span class="token punctuation">(</span><span class="token class-name">FragmentManager</span> fragmentManager<span class="token punctuation">,</span> <span class="token class-name">String</span> tag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mFragmentManager <span class="token operator">=</span> fragmentManager<span class="token punctuation">;</span>
        mTag <span class="token operator">=</span> tag<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">FragmentIdlingResource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> mTag<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isIdleNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//simple check, if your fragment is added, then your app has became idle</span>
        <span class="token keyword">boolean</span> idle <span class="token operator">=</span> <span class="token punctuation">(</span>mFragmentManager<span class="token punctuation">.</span><span class="token function">findFragmentByTag</span><span class="token punctuation">(</span>mTag<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>idle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//IMPORTANT: make sure you call onTransitionToIdle</span>
            resourceCallback<span class="token punctuation">.</span><span class="token function">onTransitionToIdle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> idle<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerIdleTransitionCallback</span><span class="token punctuation">(</span><span class="token class-name">ResourceCallback</span> resourceCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>resourceCallback <span class="token operator">=</span> resourceCallback<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Now that you have your <code>IdlingResource</code> written, you need to use it somewhere right?</p> <h3 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h3> <p>Let us skip the entire test class setup and just look how a test case would look like:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSomeFragmentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mActivityTestRule<span class="token punctuation">.</span><span class="token function">launchActivity</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   
    <span class="token comment">//creating the idling resource</span>
    <span class="token class-name">IdlingResource</span> fragmentLoadedIdlingResource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FragmentIdlingResource</span><span class="token punctuation">(</span>mActivityTestRule<span class="token punctuation">.</span><span class="token function">getActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSupportFragmentManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">SomeFragmentText</span><span class="token punctuation">.</span>TAG<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//registering the idling resource so espresso waits for it</span>
    <span class="token class-name">Espresso</span><span class="token punctuation">.</span><span class="token function">registerIdlingResources</span><span class="token punctuation">(</span>idlingResource1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onView</span><span class="token punctuation">(</span><span class="token function">withId</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>txtHelloWorld<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token function">withText</span><span class="token punctuation">(</span>helloWorldText<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//lets cleanup after ourselves</span>
    <span class="token class-name">Espresso</span><span class="token punctuation">.</span><span class="token function">unregisterIdlingResources</span><span class="token punctuation">(</span>fragmentLoadedIdlingResource<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="combination-with-junit-rule"><a href="#combination-with-junit-rule" class="header-anchor">#</a> Combination with JUnit rule</h3> <p>This is not to hard; you can also apply the idling resource in form of a JUnit test rule. For example, let us say that you have some SDK that contains Volley in it and you want Espresso to wait for it. Instead of going through each test case or applying it in setup, you could create a JUnit rule and just write:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Rule</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">SDKIdlingRule</span> mSdkIdlingRule <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SDKIdlingRule</span><span class="token punctuation">(</span><span class="token class-name">SDKInstanceHolder</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Now since this is an example, don't take it for granted; all code here is imaginary and used only for demonstration purposes:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SDKIdlingRule</span> <span class="token keyword">implements</span> <span class="token class-name">TestRule</span> <span class="token punctuation">{</span>
    <span class="token comment">//idling resource you wrote to check is volley idle or not</span>
    <span class="token keyword">private</span> <span class="token class-name">VolleyIdlingResource</span> mVolleyIdlingResource<span class="token punctuation">;</span>
    <span class="token comment">//request queue that you need from volley to give it to idling resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RequestQueue</span> mRequestQueue<span class="token punctuation">;</span>

    <span class="token comment">//when using the rule extract the request queue from your SDK</span>
    <span class="token keyword">public</span> <span class="token class-name">SDKIdlingRule</span><span class="token punctuation">(</span><span class="token class-name">SDKClass</span> sdkClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mRequestQueue <span class="token operator">=</span> <span class="token function">getVolleyRequestQueue</span><span class="token punctuation">(</span>sdkClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">RequestQueue</span> <span class="token function">getVolleyRequestQueue</span><span class="token punctuation">(</span><span class="token class-name">SDKClass</span> sdkClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> sdkClass<span class="token punctuation">.</span><span class="token function">getVolleyRequestQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Statement</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Statement</span> base<span class="token punctuation">,</span> <span class="token class-name">Description</span> description<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Statement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
                <span class="token comment">//registering idling resource</span>
                mVolleyIdlingResource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VolleyIdlingResource</span><span class="token punctuation">(</span>mRequestQueue<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Espresso</span><span class="token punctuation">.</span><span class="token function">registerIdlingResources</span><span class="token punctuation">(</span>mVolleyIdlingResource<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    base<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>mVolleyIdlingResource <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment">//deregister the resource when test finishes</span>
                        <span class="token class-name">Espresso</span><span class="token punctuation">.</span><span class="token function">unregisterIdlingResources</span><span class="token punctuation">(</span>mVolleyIdlingResource<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li><strong>Idling resource</strong></li> <li>String    getName() - Returns the name of the idling resource(used for logging and idempotency of registration).</li> <li>boolean    isIdleNow() - Returns true if resource is currently idle.</li> <li>void    registerIdleTransitionCallback(IdlingResource.ResourceCallback callback) - Registers the given IdlingResource.ResourceCallback with the resource</li></ul> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <h3 id="junit-rules"><a href="#junit-rules" class="header-anchor">#</a> JUnit rules:</h3> <p>As you can see in MockWebServer example and ActivityTestRule they all fall under category of JUnit rules which you can create yourself which then should be executed for each test defining its behaviour @see:
<a href="https://github.com/junit-team/junit4/wiki/rules" target="_blank" rel="noopener noreferrer">https://github.com/junit-team/junit4/wiki/rules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="appium"><a href="#appium" class="header-anchor">#</a> Appium</h3> <h3 id="parameters"><a href="#parameters" class="header-anchor">#</a> Parameters</h3> <p>Since parameters have some issues placing them here until documentation bug is resolved:</p> <table><thead><tr><th>Parameter</th> <th>Details</th></tr></thead> <tbody><tr><td>Class activityClass</td> <td>which activity to start</td></tr> <tr><td>initialTouchMode</td> <td>should the activity be placed in touch mode on start: <a href="https://android-developers.blogspot.de/2008/12/touch-mode.html" target="_blank" rel="noopener noreferrer">https://android-developers.blogspot.de/2008/12/touch-mode.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>launchActivity</td> <td>true if the Activity should be launched once per Test method. It will be launched before the first Before method, and terminated after the last After method.</td></tr></tbody></table></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/android/writing-ui-tests-android.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/android/testing-ui-with-espresso.html" class="prev">
        Testing UI with Espresso
      </a></span> <span class="next"><a href="/android/unit-testing-in-android-with-junit.html">
        Unit testing in Android with JUnit
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/341.0a380304.js" defer></script>
  </body>
</html>
