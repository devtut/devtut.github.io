<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Android - Fingerprint API in android</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Adding the Fingerprint Scanner in Android application, How to use Android Fingerprint API to save user passwords">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Android - Fingerprint API in android">
    <meta property="og:description" content="Adding the Fingerprint Scanner in Android application, How to use Android Fingerprint API to save user passwords">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/android/fingerprint-api-in-android.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Android - Fingerprint API in android">
    <meta name="twitter:description" content="Adding the Fingerprint Scanner in Android application, How to use Android Fingerprint API to save user passwords">
    <meta name="twitter:url" content="/android/fingerprint-api-in-android.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/176.48a7481f.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Android</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/android/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/android/getting-started-with-android.html" class="sidebar-link">Getting started with Android</a></li><li><a href="/android/android-studio.html" class="sidebar-link">Android Studio</a></li><li><a href="/android/instant-run-in-android-studio.html" class="sidebar-link">Instant Run in Android Studio</a></li><li><a href="/android/textview.html" class="sidebar-link">TextView</a></li><li><a href="/android/autocompletetextview.html" class="sidebar-link">AutoCompleteTextView</a></li><li><a href="/android/autosizing-textviews.html" class="sidebar-link">Autosizing TextViews</a></li><li><a href="/android/listview.html" class="sidebar-link">ListView</a></li><li><a href="/android/layouts.html" class="sidebar-link">Layouts</a></li><li><a href="/android/constraintlayout.html" class="sidebar-link">ConstraintLayout</a></li><li><a href="/android/textinputlayout.html" class="sidebar-link">TextInputLayout</a></li><li><a href="/android/coordinatorlayout-and-behaviors.html" class="sidebar-link">CoordinatorLayout and Behaviors</a></li><li><a href="/android/tablayout.html" class="sidebar-link">TabLayout</a></li><li><a href="/android/viewpager.html" class="sidebar-link">ViewPager</a></li><li><a href="/android/cardview.html" class="sidebar-link">CardView</a></li><li><a href="/android/navigationview.html" class="sidebar-link">NavigationView</a></li><li><a href="/android/recyclerview.html" class="sidebar-link">RecyclerView</a></li><li><a href="/android/recyclerview-decorations.html" class="sidebar-link">RecyclerView Decorations</a></li><li><a href="/android/recyclerview-onclicklisteners.html" class="sidebar-link">RecyclerView onClickListeners</a></li><li><a href="/android/recyclerview-and-layoutmanagers.html" class="sidebar-link">RecyclerView and LayoutManagers</a></li><li><a href="/android/pagination-in-recyclerview.html" class="sidebar-link">Pagination in RecyclerView</a></li><li><a href="/android/imageview.html" class="sidebar-link">ImageView</a></li><li><a href="/android/videoview.html" class="sidebar-link">VideoView</a></li><li><a href="/android/optimized-videoview.html" class="sidebar-link">Optimized VideoView</a></li><li><a href="/android/webview.html" class="sidebar-link">WebView</a></li><li><a href="/android/searchview.html" class="sidebar-link">SearchView</a></li><li><a href="/android/bottomnavigationview.html" class="sidebar-link">BottomNavigationView</a></li><li><a href="/android/canvas-drawing-using-surfaceview.html" class="sidebar-link">Canvas drawing using SurfaceView</a></li><li><a href="/android/creating-custom-views.html" class="sidebar-link">Creating Custom Views</a></li><li><a href="/android/getting-calculated-view-dimensions.html" class="sidebar-link">Getting Calculated View Dimensions</a></li><li><a href="/android/adding-a-fuseview-to-an-android-project.html" class="sidebar-link">Adding a FuseView to an Android Project</a></li><li><a href="/android/supporting-screens-with-different-resolutions-sizes.html" class="sidebar-link">Supporting Screens With Different Resolutions, Sizes</a></li><li><a href="/android/viewflipper.html" class="sidebar-link">ViewFlipper</a></li><li><a href="/android/design-patterns.html" class="sidebar-link">Design Patterns</a></li><li><a href="/android/activity.html" class="sidebar-link">Activity</a></li><li><a href="/android/activity-recognition.html" class="sidebar-link">Activity Recognition</a></li><li><a href="/android/split-screen-multi-screen-activities.html" class="sidebar-link">Split Screen / Multi-Screen Activities</a></li><li><a href="/android/material-design.html" class="sidebar-link">Material Design</a></li><li><a href="/android/resources.html" class="sidebar-link">Resources</a></li><li><a href="/android/data-binding-library.html" class="sidebar-link">Data Binding Library</a></li><li><a href="/android/context.html" class="sidebar-link">Context</a></li><li><a href="/android/sharedpreferences.html" class="sidebar-link">SharedPreferences</a></li><li><a href="/android/intent.html" class="sidebar-link">Intent</a></li><li><a href="/android/fragments.html" class="sidebar-link">Fragments</a></li><li><a href="/android/button.html" class="sidebar-link">Button</a></li><li><a href="/android/emulator.html" class="sidebar-link">Emulator</a></li><li><a href="/android/service.html" class="sidebar-link">Service</a></li><li><a href="/android/the-manifest-file.html" class="sidebar-link">The Manifest File</a></li><li><a href="/android/gradle-for-android.html" class="sidebar-link">Gradle for Android</a></li><li><a href="/android/fileio-with-android.html" class="sidebar-link">FileIO with Android</a></li><li><a href="/android/fileprovider.html" class="sidebar-link">FileProvider</a></li><li><a href="/android/storing-files-in-internal-external-storage.html" class="sidebar-link">Storing Files in Internal &amp; External Storage</a></li><li><a href="/android/zip-file-in-android.html" class="sidebar-link">Zip file in android</a></li><li><a href="/android/unzip-file-in-android.html" class="sidebar-link">Unzip File in Android</a></li><li><a href="/android/camera-and-gallery.html" class="sidebar-link">Camera and Gallery</a></li><li><a href="/android/camera-2-api.html" class="sidebar-link">Camera 2 API</a></li><li><a href="/android/fingerprint-api-in-android.html" aria-current="page" class="active sidebar-link">Fingerprint API in android</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/android/fingerprint-api-in-android.html#adding-the-fingerprint-scanner-in-android-application" class="sidebar-link">Adding the Fingerprint Scanner in Android application</a></li><li class="sidebar-sub-header"><a href="/android/fingerprint-api-in-android.html#how-to-use-android-fingerprint-api-to-save-user-passwords" class="sidebar-link">How to use Android Fingerprint API to save user passwords</a></li></ul></li><li><a href="/android/bluetooth-and-bluetooth-le-api.html" class="sidebar-link">Bluetooth and Bluetooth LE API</a></li><li><a href="/android/runtime-permissions-in-api-23.html" class="sidebar-link">Runtime Permissions in API-23 +</a></li><li><a href="/android/android-places-api.html" class="sidebar-link">Android Places API</a></li><li><a href="/android/android-ndk.html" class="sidebar-link">Android NDK</a></li><li><a href="/android/daynight-theme-appcompat-v23-2-api-14.html" class="sidebar-link">DayNight Theme (AppCompat v23.2 / API 14+)</a></li><li><a href="/android/glide.html" class="sidebar-link">Glide</a></li><li><a href="/android/dialog.html" class="sidebar-link">Dialog</a></li><li><a href="/android/enhancing-alert-dialogs.html" class="sidebar-link">Enhancing Alert Dialogs</a></li><li><a href="/android/animated-alertdialog-box.html" class="sidebar-link">Animated AlertDialog Box</a></li><li><a href="/android/greendao.html" class="sidebar-link">GreenDAO</a></li><li><a href="/android/tools-attributes.html" class="sidebar-link">Tools Attributes</a></li><li><a href="/android/formatting-strings.html" class="sidebar-link">Formatting Strings</a></li><li><a href="/android/spannablestring.html" class="sidebar-link">SpannableString</a></li><li><a href="/android/notifications.html" class="sidebar-link">Notifications</a></li><li><a href="/android/alarmmanager.html" class="sidebar-link">AlarmManager</a></li><li><a href="/android/handler.html" class="sidebar-link">Handler</a></li><li><a href="/android/broadcastreceiver.html" class="sidebar-link">BroadcastReceiver</a></li><li><a href="/android/ui-lifecycle.html" class="sidebar-link">UI Lifecycle</a></li><li><a href="/android/httpurlconnection.html" class="sidebar-link">HttpURLConnection</a></li><li><a href="/android/callback-url.html" class="sidebar-link">Callback URL</a></li><li><a href="/android/snackbar.html" class="sidebar-link">Snackbar</a></li><li><a href="/android/widgets.html" class="sidebar-link">Widgets</a></li><li><a href="/android/toast.html" class="sidebar-link">Toast</a></li><li><a href="/android/create-singleton-class-for-toast-message.html" class="sidebar-link">Create Singleton Class for Toast Message</a></li><li><a href="/android/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/android/animators.html" class="sidebar-link">Animators</a></li><li><a href="/android/location.html" class="sidebar-link">Location</a></li><li><a href="/android/theme-style-attribute.html" class="sidebar-link">Theme, Style, Attribute</a></li><li><a href="/android/mediaplayer.html" class="sidebar-link">MediaPlayer</a></li><li><a href="/android/android-sound-and-media.html" class="sidebar-link">Android Sound and Media</a></li><li><a href="/android/mediasession.html" class="sidebar-link">MediaSession</a></li><li><a href="/android/mediastore.html" class="sidebar-link">MediaStore</a></li><li><a href="/android/multidex-and-the-dex-method-limit.html" class="sidebar-link">Multidex and the Dex Method Limit</a></li><li><a href="/android/data-synchronization-with-sync-adapter.html" class="sidebar-link">Data Synchronization with Sync Adapter</a></li><li><a href="/android/porterduff-mode.html" class="sidebar-link">PorterDuff Mode</a></li><li><a href="/android/menu.html" class="sidebar-link">Menu</a></li><li><a href="/android/picasso.html" class="sidebar-link">Picasso</a></li><li><a href="/android/roboguice.html" class="sidebar-link">RoboGuice</a></li><li><a href="/android/acra.html" class="sidebar-link">ACRA</a></li><li><a href="/android/parcelable.html" class="sidebar-link">Parcelable</a></li><li><a href="/android/retrofit2.html" class="sidebar-link">Retrofit2</a></li><li><a href="/android/butterknife.html" class="sidebar-link">ButterKnife</a></li><li><a href="/android/volley.html" class="sidebar-link">Volley</a></li><li><a href="/android/date-and-time-pickers.html" class="sidebar-link">Date and Time Pickers</a></li><li><a href="/android/localized-date-time-in-android.html" class="sidebar-link">Localized Date/Time in Android</a></li><li><a href="/android/time-utils.html" class="sidebar-link">Time Utils</a></li><li><a href="/android/in-app-billing.html" class="sidebar-link">In-app Billing</a></li><li><a href="/android/floatingactionbutton.html" class="sidebar-link">FloatingActionButton</a></li><li><a href="/android/touch-events.html" class="sidebar-link">Touch Events</a></li><li><a href="/android/handling-touch-and-motion-events.html" class="sidebar-link">Handling touch and motion events</a></li><li><a href="/android/detect-shake-event-in-android.html" class="sidebar-link">Detect Shake Event in Android</a></li><li><a href="/android/hardware-button-events-intents-ptt-lwp-etc.html" class="sidebar-link">Hardware Button Events/Intents (PTT, LWP, etc.)</a></li><li><a href="/android/greenrobot-eventbus.html" class="sidebar-link">GreenRobot EventBus</a></li><li><a href="/android/otto-event-bus.html" class="sidebar-link">Otto Event Bus</a></li><li><a href="/android/vibration.html" class="sidebar-link">Vibration</a></li><li><a href="/android/contentprovider.html" class="sidebar-link">ContentProvider</a></li><li><a href="/android/dagger-2.html" class="sidebar-link">Dagger 2</a></li><li><a href="/android/realm.html" class="sidebar-link">Realm</a></li><li><a href="/android/android-versions.html" class="sidebar-link">Android Versions</a></li><li><a href="/android/wi-fi-connections.html" class="sidebar-link">Wi-Fi Connections</a></li><li><a href="/android/sensormanager.html" class="sidebar-link">SensorManager</a></li><li><a href="/android/progressbar.html" class="sidebar-link">ProgressBar</a></li><li><a href="/android/custom-fonts.html" class="sidebar-link">Custom Fonts</a></li><li><a href="/android/getting-system-font-names-and-using-the-fonts.html" class="sidebar-link">Getting system font names and using the fonts</a></li><li><a href="/android/text-to-speech-tts.html" class="sidebar-link">Text to Speech(TTS)</a></li><li><a href="/android/spinner.html" class="sidebar-link">Spinner</a></li><li><a href="/android/data-encryption-decryption.html" class="sidebar-link">Data Encryption/Decryption</a></li><li><a href="/android/okhttp.html" class="sidebar-link">OkHttp</a></li><li><a href="/android/handling-deep-links.html" class="sidebar-link">Handling Deep Links</a></li><li><a href="/android/crash-reporting-tools.html" class="sidebar-link">Crash Reporting Tools</a></li><li><a href="/android/check-internet-connectivity.html" class="sidebar-link">Check Internet Connectivity</a></li><li><a href="/android/creating-your-own-libraries-for-android-applications.html" class="sidebar-link">Creating your own libraries for Android applications</a></li><li><a href="/android/device-display-metrics.html" class="sidebar-link">Device Display Metrics</a></li><li><a href="/android/building-backwards-compatible-apps.html" class="sidebar-link">Building Backwards Compatible Apps</a></li><li><a href="/android/loader.html" class="sidebar-link">Loader</a></li><li><a href="/android/proguard-obfuscating-and-shrinking-your-code.html" class="sidebar-link">ProGuard - Obfuscating and Shrinking your code</a></li><li><a href="/android/typedef-annotations-intdef-stringdef.html" class="sidebar-link">Typedef Annotations: @IntDef, @StringDef</a></li><li><a href="/android/capturing-screenshots.html" class="sidebar-link">Capturing Screenshots</a></li><li><a href="/android/mvp-architecture.html" class="sidebar-link">MVP Architecture</a></li><li><a href="/android/orientation-changes.html" class="sidebar-link">Orientation Changes</a></li><li><a href="/android/xposed.html" class="sidebar-link">Xposed</a></li><li><a href="/android/packagemanager.html" class="sidebar-link">PackageManager</a></li><li><a href="/android/gesture-detection.html" class="sidebar-link">Gesture Detection</a></li><li><a href="/android/doze-mode.html" class="sidebar-link">Doze Mode</a></li><li><a href="/android/colors.html" class="sidebar-link">Colors</a></li><li><a href="/android/keyboard.html" class="sidebar-link">Keyboard</a></li><li><a href="/android/renderscript.html" class="sidebar-link">RenderScript</a></li><li><a href="/android/fresco.html" class="sidebar-link">Fresco</a></li><li><a href="/android/swipe-to-refresh.html" class="sidebar-link">Swipe to Refresh</a></li><li><a href="/android/creating-splash-screen.html" class="sidebar-link">Creating Splash screen</a></li><li><a href="/android/intentservice.html" class="sidebar-link">IntentService</a></li><li><a href="/android/implicit-intents.html" class="sidebar-link">Implicit Intents</a></li><li><a href="/android/publish-to-play-store.html" class="sidebar-link">Publish to Play Store</a></li><li><a href="/android/universal-image-loader.html" class="sidebar-link">Universal Image Loader</a></li><li><a href="/android/image-compression.html" class="sidebar-link">Image Compression</a></li><li><a href="/android/9-patch-images.html" class="sidebar-link">9-Patch Images</a></li><li><a href="/android/email-validation.html" class="sidebar-link">Email Validation</a></li><li><a href="/android/bottom-sheets.html" class="sidebar-link">Bottom Sheets</a></li><li><a href="/android/edittext.html" class="sidebar-link">EditText</a></li><li><a href="/android/speech-to-text-conversion.html" class="sidebar-link">Speech to Text Conversion</a></li><li><a href="/android/installing-apps-with-adb.html" class="sidebar-link">Installing apps with ADB</a></li><li><a href="/android/count-down-timer.html" class="sidebar-link">Count Down Timer</a></li><li><a href="/android/barcode-and-qr-code-reading.html" class="sidebar-link">Barcode and QR code reading</a></li><li><a href="/android/android-paypal-gateway-integration.html" class="sidebar-link">Android Paypal Gateway Integration</a></li><li><a href="/android/drawables.html" class="sidebar-link">Drawables</a></li><li><a href="/android/transitiondrawable.html" class="sidebar-link">TransitionDrawable</a></li><li><a href="/android/vector-drawables.html" class="sidebar-link">Vector Drawables</a></li><li><a href="/android/vectordrawable-and-animatedvectordrawable.html" class="sidebar-link">VectorDrawable and AnimatedVectorDrawable</a></li><li><a href="/android/port-mapping-using-cling-library-in-android.html" class="sidebar-link">Port Mapping using Cling library in Android</a></li><li><a href="/android/creating-overlay-always-on-top-windows.html" class="sidebar-link">Creating Overlay (always-on-top) Windows</a></li><li><a href="/android/exoplayer.html" class="sidebar-link">ExoPlayer</a></li><li><a href="/android/xmpp-register-login-and-chat-simple-example.html" class="sidebar-link">XMPP register login and chat simple example</a></li><li><a href="/android/android-authenticator.html" class="sidebar-link">Android Authenticator</a></li><li><a href="/android/audiomanager.html" class="sidebar-link">AudioManager</a></li><li><a href="/android/audiotrack.html" class="sidebar-link">AudioTrack</a></li><li><a href="/android/job-scheduling.html" class="sidebar-link">Job Scheduling</a></li><li><a href="/android/accounts-and-accountmanager.html" class="sidebar-link">Accounts and AccountManager</a></li><li><a href="/android/integrate-opencv-into-android-studio.html" class="sidebar-link">Integrate OpenCV into Android Studio</a></li><li><a href="/android/mvvm-architecture.html" class="sidebar-link">MVVM (Architecture)</a></li><li><a href="/android/ormlite-in-android.html" class="sidebar-link">ORMLite in android</a></li><li><a href="/android/retrofit2-with-rxjava.html" class="sidebar-link">Retrofit2 with RxJava</a></li><li><a href="/android/shortcutmanager.html" class="sidebar-link">ShortcutManager</a></li><li><a href="/android/lrucache.html" class="sidebar-link">LruCache</a></li><li><a href="/android/jenkins-ci-setup-for-android-projects.html" class="sidebar-link">Jenkins CI setup for Android Projects</a></li><li><a href="/android/fastlane.html" class="sidebar-link">fastlane</a></li><li><a href="/android/define-step-value-increment-for-custom-rangeseekbar.html" class="sidebar-link">Define step value (increment) for custom RangeSeekBar</a></li><li><a href="/android/getting-started-with-opengl-es-2-0.html" class="sidebar-link">Getting started with OpenGL ES 2.0+</a></li><li><a href="/android/check-data-connection.html" class="sidebar-link">Check Data Connection</a></li><li><a href="/android/java-on-android.html" class="sidebar-link">Java on Android</a></li><li><a href="/android/android-java-native-interface-jni.html" class="sidebar-link">Android Java Native Interface (JNI)</a></li><li><a href="/android/notification-channel-android-o.html" class="sidebar-link">Notification Channel Android O</a></li><li><a href="/android/robolectric.html" class="sidebar-link">Robolectric</a></li><li><a href="/android/moshi.html" class="sidebar-link">Moshi</a></li><li><a href="/android/strict-mode-policy-a-tool-to-catch-the-bug-in-the-compile-time.html" class="sidebar-link">Strict Mode Policy : A tool to catch the bug in the Compile Time.</a></li><li><a href="/android/internationalization-and-localization-i18n-and-l10n.html" class="sidebar-link">Internationalization and localization (I18N and L10N)</a></li><li><a href="/android/fast-way-to-setup-retrolambda-on-an-android-project.html" class="sidebar-link">Fast way to setup Retrolambda on an android project.</a></li><li><a href="/android/how-to-use-sparsearray.html" class="sidebar-link">How to use SparseArray</a></li><li><a href="/android/shared-element-transitions.html" class="sidebar-link">Shared Element Transitions</a></li><li><a href="/android/android-things.html" class="sidebar-link">Android Things</a></li><li><a href="/android/library-dagger-2-dependency-injection-in-applications.html" class="sidebar-link">Library Dagger 2: Dependency Injection in Applications</a></li><li><a href="/android/jcodec.html" class="sidebar-link">JCodec</a></li><li><a href="/android/formatting-phone-numbers-with-pattern.html" class="sidebar-link">Formatting phone numbers with pattern.</a></li><li><a href="/android/paint.html" class="sidebar-link">Paint</a></li><li><a href="/android/what-is-proguard-what-is-use-in-android.html" class="sidebar-link">What is ProGuard? What is use in Android?</a></li><li><a href="/android/create-android-custom-roms.html" class="sidebar-link">Create Android Custom ROMs</a></li><li><a href="/android/genymotion-for-android.html" class="sidebar-link">Genymotion for android</a></li><li><a href="/android/constraintset.html" class="sidebar-link">ConstraintSet</a></li><li><a href="/android/clevertap.html" class="sidebar-link">CleverTap</a></li><li><a href="/android/publish-a-library-to-maven-repositories.html" class="sidebar-link">Publish a library to Maven Repositories</a></li><li><a href="/android/adb-shell.html" class="sidebar-link">adb shell</a></li><li><a href="/android/ping-icmp.html" class="sidebar-link">Ping ICMP</a></li><li><a href="/android/aidl.html" class="sidebar-link">AIDL</a></li><li><a href="/android/android-game-development.html" class="sidebar-link">Android game development</a></li><li><a href="/android/android-programming-with-kotlin.html" class="sidebar-link">Android programming with Kotlin</a></li><li><a href="/android/android-x86-in-virtualbox.html" class="sidebar-link">Android-x86 in VirtualBox</a></li><li><a href="/android/leakcanary.html" class="sidebar-link">Leakcanary</a></li><li><a href="/android/okio.html" class="sidebar-link">Okio</a></li><li><a href="/android/bluetooth-low-energy.html" class="sidebar-link">Bluetooth Low Energy</a></li><li><a href="/android/looper.html" class="sidebar-link">Looper</a></li><li><a href="/android/annotation-processor.html" class="sidebar-link">Annotation Processor</a></li><li><a href="/android/syncadapter-with-periodically-do-sync-of-data.html" class="sidebar-link">SyncAdapter with periodically do sync of data</a></li><li><a href="/android/fastjson.html" class="sidebar-link">Fastjson</a></li><li><a href="/android/json-in-android-with-org-json.html" class="sidebar-link">JSON in Android with org.json</a></li><li><a href="/android/gson.html" class="sidebar-link">Gson</a></li><li><a href="/android/android-architecture-components.html" class="sidebar-link">Android Architecture Components</a></li><li><a href="/android/jackson.html" class="sidebar-link">Jackson</a></li><li><a href="/android/smartcard.html" class="sidebar-link">Smartcard</a></li><li><a href="/android/security.html" class="sidebar-link">Security</a></li><li><a href="/android/how-to-store-passwords-securely.html" class="sidebar-link">How to store passwords securely</a></li><li><a href="/android/secure-sharedpreferences.html" class="sidebar-link">Secure SharedPreferences</a></li><li><a href="/android/secure-sharedpreferences.html" class="sidebar-link">Secure SharedPreferences</a></li><li><a href="/android/sqlite.html" class="sidebar-link">SQLite</a></li><li><a href="/android/accessing-sqlite-databases-using-the-contentvalues-class.html" class="sidebar-link">Accessing SQLite databases using the ContentValues class</a></li><li><a href="/android/firebase.html" class="sidebar-link">Firebase</a></li><li><a href="/android/firebase-cloud-messaging.html" class="sidebar-link">Firebase Cloud Messaging</a></li><li><a href="/android/firebase-realtime-database.html" class="sidebar-link">Firebase Realtime DataBase</a></li><li><a href="/android/firebase-app-indexing.html" class="sidebar-link">Firebase App Indexing</a></li><li><a href="/android/firebase-crash-reporting.html" class="sidebar-link">Firebase Crash Reporting</a></li><li><a href="/android/twitter-apis.html" class="sidebar-link">Twitter APIs</a></li><li><a href="/android/youtube-api.html" class="sidebar-link">Youtube-API</a></li><li><a href="/android/integrate-google-sign-in.html" class="sidebar-link">Integrate Google Sign In</a></li><li><a href="/android/google-signin-integration-on-android.html" class="sidebar-link">Google signin integration on android</a></li><li><a href="/android/google-awareness-apis.html" class="sidebar-link">Google Awareness APIs</a></li><li><a href="/android/google-maps-api-v2-for-android.html" class="sidebar-link">Google Maps API v2 for Android</a></li><li><a href="/android/google-drive-api.html" class="sidebar-link">Google Drive API</a></li><li><a href="/android/displaying-google-ads.html" class="sidebar-link">Displaying Google Ads</a></li><li><a href="/android/admob.html" class="sidebar-link">AdMob</a></li><li><a href="/android/google-play-store.html" class="sidebar-link">Google Play Store</a></li><li><a href="/android/sign-your-android-app-for-release.html" class="sidebar-link">Sign your Android App for Release</a></li><li><a href="/android/tensorflow.html" class="sidebar-link">TensorFlow</a></li><li><a href="/android/android-vk-sdk.html" class="sidebar-link">Android Vk Sdk</a></li><li><a href="/android/project-sdk-versions.html" class="sidebar-link">Project SDK versions</a></li><li><a href="/android/facebook-sdk-for-android.html" class="sidebar-link">Facebook SDK for Android</a></li><li><a href="/android/thread.html" class="sidebar-link">Thread</a></li><li><a href="/android/asynctask.html" class="sidebar-link">AsyncTask</a></li><li><a href="/android/testing-ui-with-espresso.html" class="sidebar-link">Testing UI with Espresso</a></li><li><a href="/android/writing-ui-tests-android.html" class="sidebar-link">Writing UI tests - Android</a></li><li><a href="/android/unit-testing-in-android-with-junit.html" class="sidebar-link">Unit testing in Android with JUnit</a></li><li><a href="/android/inter-app-ui-testing-with-uiautomator.html" class="sidebar-link">Inter-app UI testing with UIAutomator</a></li><li><a href="/android/lint-warnings.html" class="sidebar-link">Lint Warnings</a></li><li><a href="/android/performance-optimization.html" class="sidebar-link">Performance Optimization</a></li><li><a href="/android/android-kernel-optimization.html" class="sidebar-link">Android Kernel Optimization</a></li><li><a href="/android/memory-leaks.html" class="sidebar-link">Memory Leaks</a></li><li><a href="/android/enhancing-android-performance-using-icon-fonts.html" class="sidebar-link">Enhancing Android Performance Using Icon Fonts</a></li><li><a href="/android/bitmap-cache.html" class="sidebar-link">Bitmap Cache</a></li><li><a href="/android/loading-bitmaps-effectively.html" class="sidebar-link">Loading Bitmaps Effectively</a></li><li><a href="/android/exceptions.html" class="sidebar-link">Exceptions</a></li><li><a href="/android/logging-and-using-logcat.html" class="sidebar-link">Logging and using Logcat</a></li><li><a href="/android/adb-android-debug-bridge.html" class="sidebar-link">ADB (Android Debug Bridge)</a></li><li><a href="/android/localization-with-resources-in-android.html" class="sidebar-link">Localization with resources in Android</a></li><li><a href="/android/convert-vietnamese-string-to-english-string-android.html" class="sidebar-link">Convert vietnamese string to english string Android</a></li><li><a href="/android/publish-aar-file-to-apache-archiva-with-gradle.html" class="sidebar-link">Publish .aar file to Apache Archiva with Gradle</a></li><li><a href="/android/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="fingerprint-api-in-android"><a href="#fingerprint-api-in-android" class="header-anchor">#</a> Fingerprint API in android</h1> <h2 id="adding-the-fingerprint-scanner-in-android-application"><a href="#adding-the-fingerprint-scanner-in-android-application" class="header-anchor">#</a> Adding the Fingerprint Scanner in Android application</h2> <p>Android supports fingerprint api from Android 6.0 (Marshmallow) SDK 23</p> <blockquote></blockquote> <p>To use this feature in your app, first add the USE_FINGERPRINT
permission in your manifest.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token operator">&lt;</span><span class="token keyword">uses</span><span class="token operator">-</span>permission
        android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;android.permission.USE_FINGERPRINT&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

</code></pre></div><p>Here the procedure to follow</p> <blockquote></blockquote> <p>First you need to create a symmetric key in the Android Key Store
using KeyGenerator which can be only be used after the user has
authenticated with fingerprint and pass a KeyGenParameterSpec.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>KEY_ALGORITHM_EC<span class="token punctuation">,</span> <span class="token string">&quot;AndroidKeyStore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
keyPairGenerator<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">KeyGenParameterSpec<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span>KEY_NAME<span class="token punctuation">,</span>
                <span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>PURPOSE_SIGN<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setDigests</span><span class="token punctuation">(</span><span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>DIGEST_SHA256<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setAlgorithmParameterSpec</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ECGenParameterSpec</span><span class="token punctuation">(</span><span class="token string">&quot;secp256r1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setUserAuthenticationRequired</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><blockquote></blockquote> <p>By setting KeyGenParameterSpec.Builder.setUserAuthenticationRequired
to true, you can permit the use of the key only after the user
authenticate it including when authenticated with the user's
fingerprint.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">KeyStore</span> keyStore <span class="token operator">=</span> <span class="token class-name">KeyStore</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;AndroidKeyStore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
keyStore<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">PublicKey</span> publicKey <span class="token operator">=</span>
        keyStore<span class="token punctuation">.</span><span class="token function">getCertificate</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span>KEY_NAME<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">KeyStore</span> keyStore <span class="token operator">=</span> <span class="token class-name">KeyStore</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;AndroidKeyStore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
keyStore<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">PrivateKey</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">PrivateKey</span><span class="token punctuation">)</span> keyStore<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span>KEY_NAME<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><blockquote></blockquote> <p>Then start listening to a fingerprint on the fingerprint sensor by
calling FingerprintManager.authenticate with a Cipher initialized with
the symmetric key created. Or alternatively you can fall back to
server-side verified password as an authenticator.</p> <p>Create and initialise the <code>FingerprintManger</code> from <code>fingerprintManger.class</code></p> <p><code>getContext().getSystemService(FingerprintManager.class)</code></p> <p>To authenticate use <code>FingerprintManger</code> api and create subclass using</p> <p><code>FingerprintManager.AuthenticationCallback</code> and override the methods</p> <div class="language-java extra-class"><pre class="language-java"><code>onAuthenticationError
onAuthenticationHelp
onAuthenticationSucceeded
onAuthenticationFailed

</code></pre></div><p><strong>To Start</strong></p> <p>To startListening the fingerPrint event call authenticate method with crypto</p> <div class="language-java extra-class"><pre class="language-java"><code>fingerprintManager
              <span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span>cryptoObject<span class="token punctuation">,</span> mCancellationSignal<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Cancel</strong></p> <p>to stop listenting the scanner call</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span>CancellationSignal</span><span class="token punctuation">;</span>

</code></pre></div><blockquote></blockquote> <p>Once the fingerprint (or password) is verified, the
FingerprintManager.AuthenticationCallback#onAuthenticationSucceeded()
callback is called.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAuthenticationSucceeded</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               
            <span class="token punctuation">}</span>

</code></pre></div><h2 id="how-to-use-android-fingerprint-api-to-save-user-passwords"><a href="#how-to-use-android-fingerprint-api-to-save-user-passwords" class="header-anchor">#</a> How to use Android Fingerprint API to save user passwords</h2> <p>This example helper class interacts with the finger print manager and performs encryption and decryption of password. Please note that the method used for encryption in this example is AES. This is not the only way to encrypt and <a href="http://stackoverflow.com/documentation/android/3471/data-encryption-decryption/11997/aes-encrypt-data-using-password-in-a-secure-way#t=20170404140944107178" target="_blank" rel="noopener noreferrer">other examples<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> exist. In this example the data is encrypted and decrypted in the following manner:</p> <p>Encryption:</p> <ol><li>User gives helper the desired non-encrypted password.</li> <li>User is required to provide fingerprint.</li> <li>Once authenticated, the helper obtains a key from the <code>KeyStore</code> and encrypts the password using a <code>Cipher</code>.</li> <li>Password and IV salt (IV is recreated for every encryption and is not reused) are saved to shared preferences to be used later in the decryption process.</li></ol> <p>Decryption:</p> <ol><li>User requests to decrypt the password.</li> <li>User is required to provide fingerprint.</li> <li>The helper builds a <code>Cipher</code> using the IV and once user is authenticated, the KeyStore obtains a key from the <code>KeyStore</code> and deciphers the password.</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FingerPrintAuthHelper</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> FINGER_PRINT_HELPER <span class="token operator">=</span> <span class="token string">&quot;FingerPrintAuthHelper&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> ENCRYPTED_PASS_SHARED_PREF_KEY <span class="token operator">=</span> <span class="token string">&quot;ENCRYPTED_PASS_SHARED_PREF_KEY&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> LAST_USED_IV_SHARED_PREF_KEY <span class="token operator">=</span> <span class="token string">&quot;LAST_USED_IV_SHARED_PREF_KEY&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> MY_APP_ALIAS <span class="token operator">=</span> <span class="token string">&quot;MY_APP_ALIAS&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">KeyguardManager</span> keyguardManager<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">FingerprintManager</span> fingerprintManager<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Context</span> context<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">KeyStore</span> keyStore<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">KeyGenerator</span> keyGenerator<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> lastError<span class="token punctuation">;</span>


    <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Callback</span> <span class="token punctuation">{</span>
        <span class="token keyword">void</span> <span class="token function">onSuccess</span><span class="token punctuation">(</span><span class="token class-name">String</span> savedPass<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">onHelp</span><span class="token punctuation">(</span><span class="token keyword">int</span> helpCode<span class="token punctuation">,</span> <span class="token class-name">String</span> helpString<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">FingerPrintAuthHelper</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>context <span class="token operator">=</span> context<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> lastError<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@TargetApi</span><span class="token punctuation">(</span><span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Build</span><span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">&lt;</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">&quot;This Android version does not support fingerprint authentication&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        keyguardManager <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">KeyguardManager</span><span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getSystemService</span><span class="token punctuation">(</span>KEYGUARD_SERVICE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        fingerprintManager <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">FingerprintManager</span><span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getSystemService</span><span class="token punctuation">(</span>FINGERPRINT_SERVICE<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>keyguardManager<span class="token punctuation">.</span><span class="token function">isKeyguardSecure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">&quot;User hasn't enabled Lock Screen&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">&quot;User hasn't granted permission to use Fingerprint&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fingerprintManager<span class="token punctuation">.</span><span class="token function">hasEnrolledFingerprints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">&quot;User hasn't registered any fingerprints&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">initKeyStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Nullable</span>
    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span>api <span class="token operator">=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Cipher</span> <span class="token function">createCipher</span><span class="token punctuation">(</span><span class="token keyword">int</span> mode<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchPaddingException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">,</span> <span class="token class-name">UnrecoverableKeyException</span><span class="token punctuation">,</span> <span class="token class-name">KeyStoreException</span><span class="token punctuation">,</span> <span class="token class-name">InvalidKeyException</span><span class="token punctuation">,</span> <span class="token class-name">InvalidAlgorithmParameterException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>KEY_ALGORITHM_AES <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span>
                <span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>BLOCK_MODE_CBC <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span>
                <span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>ENCRYPTION_PADDING_PKCS7<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Key</span> key <span class="token operator">=</span> keyStore<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span>MY_APP_ALIAS<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span>ENCRYPT_MODE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> iv <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">getIV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">saveIv</span><span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> lastIv <span class="token operator">=</span> <span class="token function">getLastIv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">IvParameterSpec</span><span class="token punctuation">(</span>lastIv<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@NonNull</span>
    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span>api <span class="token operator">=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">KeyGenParameterSpec</span> <span class="token function">createKeyGenParameterSpec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">KeyGenParameterSpec<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span>MY_APP_ALIAS<span class="token punctuation">,</span> <span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>PURPOSE_ENCRYPT <span class="token operator">|</span> <span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>PURPOSE_DECRYPT<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setBlockModes</span><span class="token punctuation">(</span><span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>BLOCK_MODE_CBC<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setUserAuthenticationRequired</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setEncryptionPaddings</span><span class="token punctuation">(</span><span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>ENCRYPTION_PADDING_PKCS7<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span>api <span class="token operator">=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">initKeyStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            keyStore <span class="token operator">=</span> <span class="token class-name">KeyStore</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;AndroidKeyStore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            keyGenerator <span class="token operator">=</span> <span class="token class-name">KeyGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token class-name">KeyProperties</span><span class="token punctuation">.</span>KEY_ALGORITHM_AES<span class="token punctuation">,</span> <span class="token string">&quot;AndroidKeyStore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            keyStore<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getLastIv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">KeyGenParameterSpec</span> keyGeneratorSpec <span class="token operator">=</span> <span class="token function">createKeyGenParameterSpec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                keyGenerator<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>keyGeneratorSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
                keyGenerator<span class="token punctuation">.</span><span class="token function">generateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">&quot;Failed init of keyStore &amp; keyGenerator: &quot;</span> <span class="token operator">+</span> t<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span>api <span class="token operator">=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token class-name">CancellationSignal</span> cancellationSignal<span class="token punctuation">,</span> <span class="token class-name">FingerPrintAuthenticationListener</span> authListener<span class="token punctuation">,</span> <span class="token keyword">int</span> mode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token function">createCipher</span><span class="token punctuation">(</span>mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">FingerprintManager<span class="token punctuation">.</span>CryptoObject</span> crypto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FingerprintManager<span class="token punctuation">.</span>CryptoObject</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">;</span>
                fingerprintManager<span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span>crypto<span class="token punctuation">,</span> cancellationSignal<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> authListener<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                authListener<span class="token punctuation">.</span><span class="token function">getCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token string">&quot;User hasn't granted permission to use Fingerprint&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            authListener<span class="token punctuation">.</span><span class="token function">getCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token string">&quot;An error occurred: &quot;</span> <span class="token operator">+</span> t<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">getSavedEncryptedPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SharedPreferences</span> sharedPreferences <span class="token operator">=</span> <span class="token function">getSharedPreferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sharedPreferences <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> sharedPreferences<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>ENCRYPTED_PASS_SHARED_PREF_KEY<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">saveEncryptedPassword</span><span class="token punctuation">(</span><span class="token class-name">String</span> encryptedPassword<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SharedPreferences<span class="token punctuation">.</span>Editor</span> edit <span class="token operator">=</span> <span class="token function">getSharedPreferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">edit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        edit<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span>ENCRYPTED_PASS_SHARED_PREF_KEY<span class="token punctuation">,</span> encryptedPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
        edit<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getLastIv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SharedPreferences</span> sharedPreferences <span class="token operator">=</span> <span class="token function">getSharedPreferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sharedPreferences <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> ivString <span class="token operator">=</span> sharedPreferences<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>LAST_USED_IV_SHARED_PREF_KEY<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>ivString <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">decodeBytes</span><span class="token punctuation">(</span>ivString<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">saveIv</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> iv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SharedPreferences<span class="token punctuation">.</span>Editor</span> edit <span class="token operator">=</span> <span class="token function">getSharedPreferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">edit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> string <span class="token operator">=</span> <span class="token function">encodeBytes</span><span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        edit<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span>LAST_USED_IV_SHARED_PREF_KEY<span class="token punctuation">,</span> string<span class="token punctuation">)</span><span class="token punctuation">;</span>
        edit<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">SharedPreferences</span> <span class="token function">getSharedPreferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> context<span class="token punctuation">.</span><span class="token function">getSharedPreferences</span><span class="token punctuation">(</span>FINGER_PRINT_HELPER<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span>api <span class="token operator">=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">hasPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ActivityCompat</span><span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token class-name">Manifest</span><span class="token punctuation">.</span>permission<span class="token punctuation">.</span>USE_FINGERPRINT<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">PackageManager</span><span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span>api <span class="token operator">=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">savePassword</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">String</span> password<span class="token punctuation">,</span> <span class="token class-name">CancellationSignal</span> cancellationSignal<span class="token punctuation">,</span> <span class="token class-name">Callback</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">authenticate</span><span class="token punctuation">(</span>cancellationSignal<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">FingerPrintEncryptPasswordListener</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span>ENCRYPT_MODE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span>api <span class="token operator">=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token class-name">CancellationSignal</span> cancellationSignal<span class="token punctuation">,</span> <span class="token class-name">Callback</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">authenticate</span><span class="token punctuation">(</span>cancellationSignal<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">FingerPrintDecryptPasswordListener</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span>DECRYPT_MODE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span>api <span class="token operator">=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">encryptPassword</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span> cipher<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// Encrypt the text</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">&quot;Password is empty&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>cipher <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">&quot;Could not create cipher&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token class-name">ByteArrayOutputStream</span> outputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">CipherOutputStream</span> cipherOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CipherOutputStream</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">,</span> cipher<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> password<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">defaultCharset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cipherOutputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cipherOutputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cipherOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">saveEncryptedPassword</span><span class="token punctuation">(</span><span class="token function">encodeBytes</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">&quot;Encryption failed &quot;</span> <span class="token operator">+</span> t<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decodeBytes</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> len <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// &quot;111&quot; is not a valid hex encoding.</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> len<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;hexBinary needs to be even-length: &quot;</span><span class="token operator">+</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>len<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">+=</span><span class="token number">2</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> h <span class="token operator">=</span> <span class="token function">hexToBin</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i  <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token function">hexToBin</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span> h<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> l<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;contains illegal character for hexBinary: &quot;</span><span class="token operator">+</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>

            out<span class="token punctuation">[</span>i<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token punctuation">(</span>h<span class="token operator">*</span><span class="token number">16</span><span class="token operator">+</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> out<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">hexToBin</span><span class="token punctuation">(</span> <span class="token keyword">char</span> ch <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token string">'0'</span><span class="token operator">&lt;=</span>ch <span class="token operator">&amp;&amp;</span> ch<span class="token operator">&lt;=</span><span class="token string">'9'</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> ch<span class="token operator">-</span><span class="token string">'0'</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token string">'A'</span><span class="token operator">&lt;=</span>ch <span class="token operator">&amp;&amp;</span> ch<span class="token operator">&lt;=</span><span class="token string">'F'</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> ch<span class="token operator">-</span><span class="token string">'A'</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token string">'a'</span><span class="token operator">&lt;=</span>ch <span class="token operator">&amp;&amp;</span> ch<span class="token operator">&lt;=</span><span class="token string">'f'</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> ch<span class="token operator">-</span><span class="token string">'a'</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hexCode <span class="token operator">=</span> <span class="token string">&quot;0123456789ABCDEF&quot;</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">encodeBytes</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StringBuilder</span> r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>length<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">byte</span> b <span class="token operator">:</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            r<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>hexCode<span class="token punctuation">[</span><span class="token punctuation">(</span>b <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            r<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>hexCode<span class="token punctuation">[</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> r<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@NonNull</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">decipher</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span> cipher<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalBlockSizeException</span><span class="token punctuation">,</span> <span class="token class-name">BadPaddingException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> retVal <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> savedEncryptedPassword <span class="token operator">=</span> <span class="token function">getSavedEncryptedPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>savedEncryptedPassword <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decodedPassword <span class="token operator">=</span> <span class="token function">decodeBytes</span><span class="token punctuation">(</span>savedEncryptedPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">CipherInputStream</span> cipherInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CipherInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>decodedPassword<span class="token punctuation">)</span><span class="token punctuation">,</span> cipher<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Byte</span><span class="token punctuation">&gt;</span></span> values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> nextByte<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nextByte <span class="token operator">=</span> cipherInputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> nextByte<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            cipherInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>values<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> values<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">byteValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            retVal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> <span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">defaultCharset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> retVal<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">setError</span><span class="token punctuation">(</span><span class="token class-name">String</span> error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lastError <span class="token operator">=</span> error<span class="token punctuation">;</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span>FINGER_PRINT_HELPER<span class="token punctuation">,</span> lastError<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span><span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">protected</span> <span class="token keyword">class</span> <span class="token class-name">FingerPrintAuthenticationListener</span> <span class="token keyword">extends</span> <span class="token class-name">FingerprintManager<span class="token punctuation">.</span>AuthenticationCallback</span> <span class="token punctuation">{</span>

        <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">Callback</span> callback<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">FingerPrintAuthenticationListener</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">Callback</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>callback <span class="token operator">=</span> callback<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAuthenticationError</span><span class="token punctuation">(</span><span class="token keyword">int</span> errorCode<span class="token punctuation">,</span> <span class="token class-name">CharSequence</span> errString<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            callback<span class="token punctuation">.</span><span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token string">&quot;Authentication error [&quot;</span> <span class="token operator">+</span> errorCode <span class="token operator">+</span> <span class="token string">&quot;] &quot;</span> <span class="token operator">+</span> errString<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * Called when a recoverable error has been encountered during authentication. The help
         * string is provided to give the user guidance for what went wrong, such as
         * &quot;Sensor dirty, please clean it.&quot;
         * @param helpCode An integer identifying the error message
         * @param helpString A human-readable string that can be shown in UI
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAuthenticationHelp</span><span class="token punctuation">(</span><span class="token keyword">int</span> helpCode<span class="token punctuation">,</span> <span class="token class-name">CharSequence</span> helpString<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            callback<span class="token punctuation">.</span><span class="token function">onHelp</span><span class="token punctuation">(</span>helpCode<span class="token punctuation">,</span> helpString<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * Called when a fingerprint is recognized.
         * @param result An object containing authentication-related data
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAuthenticationSucceeded</span><span class="token punctuation">(</span><span class="token class-name">FingerprintManager<span class="token punctuation">.</span>AuthenticationResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * Called when a fingerprint is valid but not recognized.
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAuthenticationFailed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            callback<span class="token punctuation">.</span><span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token string">&quot;Authentication failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token annotation punctuation">@NonNull</span>
        <span class="token class-name">Callback</span> <span class="token function">getCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> callback<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span>api <span class="token operator">=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">FingerPrintEncryptPasswordListener</span> <span class="token keyword">extends</span> <span class="token class-name">FingerPrintAuthenticationListener</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">FingerPrintEncryptPasswordListener</span><span class="token punctuation">(</span><span class="token class-name">Callback</span> callback<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAuthenticationSucceeded</span><span class="token punctuation">(</span><span class="token class-name">FingerprintManager<span class="token punctuation">.</span>AuthenticationResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getCryptoObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCipher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">encryptPassword</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    callback<span class="token punctuation">.</span><span class="token function">onSuccess</span><span class="token punctuation">(</span><span class="token string">&quot;Encrypted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    callback<span class="token punctuation">.</span><span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token string">&quot;Encryption failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                callback<span class="token punctuation">.</span><span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token string">&quot;Encryption failed &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span><span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span>
    <span class="token keyword">protected</span> <span class="token keyword">class</span> <span class="token class-name">FingerPrintDecryptPasswordListener</span> <span class="token keyword">extends</span> <span class="token class-name">FingerPrintAuthenticationListener</span> <span class="token punctuation">{</span>

        <span class="token keyword">public</span> <span class="token class-name">FingerPrintDecryptPasswordListener</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">Callback</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAuthenticationSucceeded</span><span class="token punctuation">(</span><span class="token class-name">FingerprintManager<span class="token punctuation">.</span>AuthenticationResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getCryptoObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCipher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> savedPass <span class="token operator">=</span> <span class="token function">decipher</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>savedPass <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    callback<span class="token punctuation">.</span><span class="token function">onSuccess</span><span class="token punctuation">(</span>savedPass<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    callback<span class="token punctuation">.</span><span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token string">&quot;Failed deciphering&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                callback<span class="token punctuation">.</span><span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token string">&quot;Deciphering failed &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>This activity below is a very basic example of how to get a user saved password and interact with the helper.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token class-name">TextView</span> passwordTextView<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">FingerPrintAuthHelper</span> fingerPrintAuthHelper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        passwordTextView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        errorTextView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">View</span> savePasswordButton <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>set_password_button<span class="token punctuation">)</span><span class="token punctuation">;</span>
        savePasswordButton<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Build</span><span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">&gt;=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    fingerPrintAuthHelper<span class="token punctuation">.</span><span class="token function">savePassword</span><span class="token punctuation">(</span>passwordTextView<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">CancellationSignal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getAuthListener</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">View</span> getPasswordButton <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>get_password_button<span class="token punctuation">)</span><span class="token punctuation">;</span>
        getPasswordButton<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Build</span><span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">&gt;=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    fingerPrintAuthHelper<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CancellationSignal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getAuthListener</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Start the finger print helper. In case this fails show error to user</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">startFingerPrintAuthHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fingerPrintAuthHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FingerPrintAuthHelper</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fingerPrintAuthHelper<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            errorTextView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>fingerPrintAuthHelper<span class="token punctuation">.</span><span class="token function">getLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@NonNull</span>
    <span class="token keyword">private</span> <span class="token class-name">FingerPrintAuthHelper<span class="token punctuation">.</span>Callback</span> <span class="token function">getAuthListener</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token keyword">boolean</span> isGetPass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FingerPrintAuthHelper<span class="token punctuation">.</span>Callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onSuccess</span><span class="token punctuation">(</span><span class="token class-name">String</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>isGetPass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    errorTextView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&quot;Success!!! Pass = &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    errorTextView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&quot;Encrypted pass = &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onFailure</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                errorTextView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&quot;Failed - &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onHelp</span><span class="token punctuation">(</span><span class="token keyword">int</span> helpCode<span class="token punctuation">,</span> <span class="token class-name">String</span> helpString<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                errorTextView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&quot;Help needed - &quot;</span> <span class="token operator">+</span> helpString<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p><strong>see also</strong></p> <p><a href="https://github.com/googlesamples/android-FingerprintDialog" target="_blank" rel="noopener noreferrer"><strong>Github sample project</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://android-developers.blogspot.in/2015/10/new-in-android-samples-authenticating.html" target="_blank" rel="noopener noreferrer"><strong>Android developer blogspot</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://developer.android.com/about/versions/marshmallow/android-6.0.html#fingerprint-authentication" target="_blank" rel="noopener noreferrer"><strong>Android Developer site</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/android/fingerprint-api-in-android.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/android/camera-2-api.html" class="prev">
        Camera 2 API
      </a></span> <span class="next"><a href="/android/bluetooth-and-bluetooth-le-api.html">
        Bluetooth and Bluetooth LE API
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/176.48a7481f.js" defer></script>
  </body>
</html>
