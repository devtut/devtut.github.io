<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Android - Firebase Realtime DataBase</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Quick setup,  Firebase Realtime DataBase event handler, Designing and understanding how to retrieve realtime data from the Firebase Database, Denormalization: Flat Database Structure, Understanding firebase JSON database, Retrieving data from firebase, Listening for child updates, Retrieving data with pagination">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Android - Firebase Realtime DataBase">
    <meta property="og:description" content="Quick setup,  Firebase Realtime DataBase event handler, Designing and understanding how to retrieve realtime data from the Firebase Database, Denormalization: Flat Database Structure, Understanding firebase JSON database, Retrieving data from firebase, Listening for child updates, Retrieving data with pagination">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/android/firebase-realtime-database.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Android - Firebase Realtime DataBase">
    <meta name="twitter:description" content="Quick setup,  Firebase Realtime DataBase event handler, Designing and understanding how to retrieve realtime data from the Firebase Database, Denormalization: Flat Database Structure, Understanding firebase JSON database, Retrieving data from firebase, Listening for child updates, Retrieving data with pagination">
    <meta name="twitter:url" content="/android/firebase-realtime-database.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/180.eb90f997.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Android</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/android/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/android/getting-started-with-android.html" class="sidebar-link">Getting started with Android</a></li><li><a href="/android/android-studio.html" class="sidebar-link">Android Studio</a></li><li><a href="/android/instant-run-in-android-studio.html" class="sidebar-link">Instant Run in Android Studio</a></li><li><a href="/android/textview.html" class="sidebar-link">TextView</a></li><li><a href="/android/autocompletetextview.html" class="sidebar-link">AutoCompleteTextView</a></li><li><a href="/android/autosizing-textviews.html" class="sidebar-link">Autosizing TextViews</a></li><li><a href="/android/listview.html" class="sidebar-link">ListView</a></li><li><a href="/android/layouts.html" class="sidebar-link">Layouts</a></li><li><a href="/android/constraintlayout.html" class="sidebar-link">ConstraintLayout</a></li><li><a href="/android/textinputlayout.html" class="sidebar-link">TextInputLayout</a></li><li><a href="/android/coordinatorlayout-and-behaviors.html" class="sidebar-link">CoordinatorLayout and Behaviors</a></li><li><a href="/android/tablayout.html" class="sidebar-link">TabLayout</a></li><li><a href="/android/viewpager.html" class="sidebar-link">ViewPager</a></li><li><a href="/android/cardview.html" class="sidebar-link">CardView</a></li><li><a href="/android/navigationview.html" class="sidebar-link">NavigationView</a></li><li><a href="/android/recyclerview.html" class="sidebar-link">RecyclerView</a></li><li><a href="/android/recyclerview-decorations.html" class="sidebar-link">RecyclerView Decorations</a></li><li><a href="/android/recyclerview-onclicklisteners.html" class="sidebar-link">RecyclerView onClickListeners</a></li><li><a href="/android/recyclerview-and-layoutmanagers.html" class="sidebar-link">RecyclerView and LayoutManagers</a></li><li><a href="/android/pagination-in-recyclerview.html" class="sidebar-link">Pagination in RecyclerView</a></li><li><a href="/android/imageview.html" class="sidebar-link">ImageView</a></li><li><a href="/android/videoview.html" class="sidebar-link">VideoView</a></li><li><a href="/android/optimized-videoview.html" class="sidebar-link">Optimized VideoView</a></li><li><a href="/android/webview.html" class="sidebar-link">WebView</a></li><li><a href="/android/searchview.html" class="sidebar-link">SearchView</a></li><li><a href="/android/bottomnavigationview.html" class="sidebar-link">BottomNavigationView</a></li><li><a href="/android/canvas-drawing-using-surfaceview.html" class="sidebar-link">Canvas drawing using SurfaceView</a></li><li><a href="/android/creating-custom-views.html" class="sidebar-link">Creating Custom Views</a></li><li><a href="/android/getting-calculated-view-dimensions.html" class="sidebar-link">Getting Calculated View Dimensions</a></li><li><a href="/android/adding-a-fuseview-to-an-android-project.html" class="sidebar-link">Adding a FuseView to an Android Project</a></li><li><a href="/android/supporting-screens-with-different-resolutions-sizes.html" class="sidebar-link">Supporting Screens With Different Resolutions, Sizes</a></li><li><a href="/android/viewflipper.html" class="sidebar-link">ViewFlipper</a></li><li><a href="/android/design-patterns.html" class="sidebar-link">Design Patterns</a></li><li><a href="/android/activity.html" class="sidebar-link">Activity</a></li><li><a href="/android/activity-recognition.html" class="sidebar-link">Activity Recognition</a></li><li><a href="/android/split-screen-multi-screen-activities.html" class="sidebar-link">Split Screen / Multi-Screen Activities</a></li><li><a href="/android/material-design.html" class="sidebar-link">Material Design</a></li><li><a href="/android/resources.html" class="sidebar-link">Resources</a></li><li><a href="/android/data-binding-library.html" class="sidebar-link">Data Binding Library</a></li><li><a href="/android/context.html" class="sidebar-link">Context</a></li><li><a href="/android/sharedpreferences.html" class="sidebar-link">SharedPreferences</a></li><li><a href="/android/intent.html" class="sidebar-link">Intent</a></li><li><a href="/android/fragments.html" class="sidebar-link">Fragments</a></li><li><a href="/android/button.html" class="sidebar-link">Button</a></li><li><a href="/android/emulator.html" class="sidebar-link">Emulator</a></li><li><a href="/android/service.html" class="sidebar-link">Service</a></li><li><a href="/android/the-manifest-file.html" class="sidebar-link">The Manifest File</a></li><li><a href="/android/gradle-for-android.html" class="sidebar-link">Gradle for Android</a></li><li><a href="/android/fileio-with-android.html" class="sidebar-link">FileIO with Android</a></li><li><a href="/android/fileprovider.html" class="sidebar-link">FileProvider</a></li><li><a href="/android/storing-files-in-internal-external-storage.html" class="sidebar-link">Storing Files in Internal &amp; External Storage</a></li><li><a href="/android/zip-file-in-android.html" class="sidebar-link">Zip file in android</a></li><li><a href="/android/unzip-file-in-android.html" class="sidebar-link">Unzip File in Android</a></li><li><a href="/android/camera-and-gallery.html" class="sidebar-link">Camera and Gallery</a></li><li><a href="/android/camera-2-api.html" class="sidebar-link">Camera 2 API</a></li><li><a href="/android/fingerprint-api-in-android.html" class="sidebar-link">Fingerprint API in android</a></li><li><a href="/android/bluetooth-and-bluetooth-le-api.html" class="sidebar-link">Bluetooth and Bluetooth LE API</a></li><li><a href="/android/runtime-permissions-in-api-23.html" class="sidebar-link">Runtime Permissions in API-23 +</a></li><li><a href="/android/android-places-api.html" class="sidebar-link">Android Places API</a></li><li><a href="/android/android-ndk.html" class="sidebar-link">Android NDK</a></li><li><a href="/android/daynight-theme-appcompat-v23-2-api-14.html" class="sidebar-link">DayNight Theme (AppCompat v23.2 / API 14+)</a></li><li><a href="/android/glide.html" class="sidebar-link">Glide</a></li><li><a href="/android/dialog.html" class="sidebar-link">Dialog</a></li><li><a href="/android/enhancing-alert-dialogs.html" class="sidebar-link">Enhancing Alert Dialogs</a></li><li><a href="/android/animated-alertdialog-box.html" class="sidebar-link">Animated AlertDialog Box</a></li><li><a href="/android/greendao.html" class="sidebar-link">GreenDAO</a></li><li><a href="/android/tools-attributes.html" class="sidebar-link">Tools Attributes</a></li><li><a href="/android/formatting-strings.html" class="sidebar-link">Formatting Strings</a></li><li><a href="/android/spannablestring.html" class="sidebar-link">SpannableString</a></li><li><a href="/android/notifications.html" class="sidebar-link">Notifications</a></li><li><a href="/android/alarmmanager.html" class="sidebar-link">AlarmManager</a></li><li><a href="/android/handler.html" class="sidebar-link">Handler</a></li><li><a href="/android/broadcastreceiver.html" class="sidebar-link">BroadcastReceiver</a></li><li><a href="/android/ui-lifecycle.html" class="sidebar-link">UI Lifecycle</a></li><li><a href="/android/httpurlconnection.html" class="sidebar-link">HttpURLConnection</a></li><li><a href="/android/callback-url.html" class="sidebar-link">Callback URL</a></li><li><a href="/android/snackbar.html" class="sidebar-link">Snackbar</a></li><li><a href="/android/widgets.html" class="sidebar-link">Widgets</a></li><li><a href="/android/toast.html" class="sidebar-link">Toast</a></li><li><a href="/android/create-singleton-class-for-toast-message.html" class="sidebar-link">Create Singleton Class for Toast Message</a></li><li><a href="/android/interfaces.html" class="sidebar-link">Interfaces</a></li><li><a href="/android/animators.html" class="sidebar-link">Animators</a></li><li><a href="/android/location.html" class="sidebar-link">Location</a></li><li><a href="/android/theme-style-attribute.html" class="sidebar-link">Theme, Style, Attribute</a></li><li><a href="/android/mediaplayer.html" class="sidebar-link">MediaPlayer</a></li><li><a href="/android/android-sound-and-media.html" class="sidebar-link">Android Sound and Media</a></li><li><a href="/android/mediasession.html" class="sidebar-link">MediaSession</a></li><li><a href="/android/mediastore.html" class="sidebar-link">MediaStore</a></li><li><a href="/android/multidex-and-the-dex-method-limit.html" class="sidebar-link">Multidex and the Dex Method Limit</a></li><li><a href="/android/data-synchronization-with-sync-adapter.html" class="sidebar-link">Data Synchronization with Sync Adapter</a></li><li><a href="/android/porterduff-mode.html" class="sidebar-link">PorterDuff Mode</a></li><li><a href="/android/menu.html" class="sidebar-link">Menu</a></li><li><a href="/android/picasso.html" class="sidebar-link">Picasso</a></li><li><a href="/android/roboguice.html" class="sidebar-link">RoboGuice</a></li><li><a href="/android/acra.html" class="sidebar-link">ACRA</a></li><li><a href="/android/parcelable.html" class="sidebar-link">Parcelable</a></li><li><a href="/android/retrofit2.html" class="sidebar-link">Retrofit2</a></li><li><a href="/android/butterknife.html" class="sidebar-link">ButterKnife</a></li><li><a href="/android/volley.html" class="sidebar-link">Volley</a></li><li><a href="/android/date-and-time-pickers.html" class="sidebar-link">Date and Time Pickers</a></li><li><a href="/android/localized-date-time-in-android.html" class="sidebar-link">Localized Date/Time in Android</a></li><li><a href="/android/time-utils.html" class="sidebar-link">Time Utils</a></li><li><a href="/android/in-app-billing.html" class="sidebar-link">In-app Billing</a></li><li><a href="/android/floatingactionbutton.html" class="sidebar-link">FloatingActionButton</a></li><li><a href="/android/touch-events.html" class="sidebar-link">Touch Events</a></li><li><a href="/android/handling-touch-and-motion-events.html" class="sidebar-link">Handling touch and motion events</a></li><li><a href="/android/detect-shake-event-in-android.html" class="sidebar-link">Detect Shake Event in Android</a></li><li><a href="/android/hardware-button-events-intents-ptt-lwp-etc.html" class="sidebar-link">Hardware Button Events/Intents (PTT, LWP, etc.)</a></li><li><a href="/android/greenrobot-eventbus.html" class="sidebar-link">GreenRobot EventBus</a></li><li><a href="/android/otto-event-bus.html" class="sidebar-link">Otto Event Bus</a></li><li><a href="/android/vibration.html" class="sidebar-link">Vibration</a></li><li><a href="/android/contentprovider.html" class="sidebar-link">ContentProvider</a></li><li><a href="/android/dagger-2.html" class="sidebar-link">Dagger 2</a></li><li><a href="/android/realm.html" class="sidebar-link">Realm</a></li><li><a href="/android/android-versions.html" class="sidebar-link">Android Versions</a></li><li><a href="/android/wi-fi-connections.html" class="sidebar-link">Wi-Fi Connections</a></li><li><a href="/android/sensormanager.html" class="sidebar-link">SensorManager</a></li><li><a href="/android/progressbar.html" class="sidebar-link">ProgressBar</a></li><li><a href="/android/custom-fonts.html" class="sidebar-link">Custom Fonts</a></li><li><a href="/android/getting-system-font-names-and-using-the-fonts.html" class="sidebar-link">Getting system font names and using the fonts</a></li><li><a href="/android/text-to-speech-tts.html" class="sidebar-link">Text to Speech(TTS)</a></li><li><a href="/android/spinner.html" class="sidebar-link">Spinner</a></li><li><a href="/android/data-encryption-decryption.html" class="sidebar-link">Data Encryption/Decryption</a></li><li><a href="/android/okhttp.html" class="sidebar-link">OkHttp</a></li><li><a href="/android/handling-deep-links.html" class="sidebar-link">Handling Deep Links</a></li><li><a href="/android/crash-reporting-tools.html" class="sidebar-link">Crash Reporting Tools</a></li><li><a href="/android/check-internet-connectivity.html" class="sidebar-link">Check Internet Connectivity</a></li><li><a href="/android/creating-your-own-libraries-for-android-applications.html" class="sidebar-link">Creating your own libraries for Android applications</a></li><li><a href="/android/device-display-metrics.html" class="sidebar-link">Device Display Metrics</a></li><li><a href="/android/building-backwards-compatible-apps.html" class="sidebar-link">Building Backwards Compatible Apps</a></li><li><a href="/android/loader.html" class="sidebar-link">Loader</a></li><li><a href="/android/proguard-obfuscating-and-shrinking-your-code.html" class="sidebar-link">ProGuard - Obfuscating and Shrinking your code</a></li><li><a href="/android/typedef-annotations-intdef-stringdef.html" class="sidebar-link">Typedef Annotations: @IntDef, @StringDef</a></li><li><a href="/android/capturing-screenshots.html" class="sidebar-link">Capturing Screenshots</a></li><li><a href="/android/mvp-architecture.html" class="sidebar-link">MVP Architecture</a></li><li><a href="/android/orientation-changes.html" class="sidebar-link">Orientation Changes</a></li><li><a href="/android/xposed.html" class="sidebar-link">Xposed</a></li><li><a href="/android/packagemanager.html" class="sidebar-link">PackageManager</a></li><li><a href="/android/gesture-detection.html" class="sidebar-link">Gesture Detection</a></li><li><a href="/android/doze-mode.html" class="sidebar-link">Doze Mode</a></li><li><a href="/android/colors.html" class="sidebar-link">Colors</a></li><li><a href="/android/keyboard.html" class="sidebar-link">Keyboard</a></li><li><a href="/android/renderscript.html" class="sidebar-link">RenderScript</a></li><li><a href="/android/fresco.html" class="sidebar-link">Fresco</a></li><li><a href="/android/swipe-to-refresh.html" class="sidebar-link">Swipe to Refresh</a></li><li><a href="/android/creating-splash-screen.html" class="sidebar-link">Creating Splash screen</a></li><li><a href="/android/intentservice.html" class="sidebar-link">IntentService</a></li><li><a href="/android/implicit-intents.html" class="sidebar-link">Implicit Intents</a></li><li><a href="/android/publish-to-play-store.html" class="sidebar-link">Publish to Play Store</a></li><li><a href="/android/universal-image-loader.html" class="sidebar-link">Universal Image Loader</a></li><li><a href="/android/image-compression.html" class="sidebar-link">Image Compression</a></li><li><a href="/android/9-patch-images.html" class="sidebar-link">9-Patch Images</a></li><li><a href="/android/email-validation.html" class="sidebar-link">Email Validation</a></li><li><a href="/android/bottom-sheets.html" class="sidebar-link">Bottom Sheets</a></li><li><a href="/android/edittext.html" class="sidebar-link">EditText</a></li><li><a href="/android/speech-to-text-conversion.html" class="sidebar-link">Speech to Text Conversion</a></li><li><a href="/android/installing-apps-with-adb.html" class="sidebar-link">Installing apps with ADB</a></li><li><a href="/android/count-down-timer.html" class="sidebar-link">Count Down Timer</a></li><li><a href="/android/barcode-and-qr-code-reading.html" class="sidebar-link">Barcode and QR code reading</a></li><li><a href="/android/android-paypal-gateway-integration.html" class="sidebar-link">Android Paypal Gateway Integration</a></li><li><a href="/android/drawables.html" class="sidebar-link">Drawables</a></li><li><a href="/android/transitiondrawable.html" class="sidebar-link">TransitionDrawable</a></li><li><a href="/android/vector-drawables.html" class="sidebar-link">Vector Drawables</a></li><li><a href="/android/vectordrawable-and-animatedvectordrawable.html" class="sidebar-link">VectorDrawable and AnimatedVectorDrawable</a></li><li><a href="/android/port-mapping-using-cling-library-in-android.html" class="sidebar-link">Port Mapping using Cling library in Android</a></li><li><a href="/android/creating-overlay-always-on-top-windows.html" class="sidebar-link">Creating Overlay (always-on-top) Windows</a></li><li><a href="/android/exoplayer.html" class="sidebar-link">ExoPlayer</a></li><li><a href="/android/xmpp-register-login-and-chat-simple-example.html" class="sidebar-link">XMPP register login and chat simple example</a></li><li><a href="/android/android-authenticator.html" class="sidebar-link">Android Authenticator</a></li><li><a href="/android/audiomanager.html" class="sidebar-link">AudioManager</a></li><li><a href="/android/audiotrack.html" class="sidebar-link">AudioTrack</a></li><li><a href="/android/job-scheduling.html" class="sidebar-link">Job Scheduling</a></li><li><a href="/android/accounts-and-accountmanager.html" class="sidebar-link">Accounts and AccountManager</a></li><li><a href="/android/integrate-opencv-into-android-studio.html" class="sidebar-link">Integrate OpenCV into Android Studio</a></li><li><a href="/android/mvvm-architecture.html" class="sidebar-link">MVVM (Architecture)</a></li><li><a href="/android/ormlite-in-android.html" class="sidebar-link">ORMLite in android</a></li><li><a href="/android/retrofit2-with-rxjava.html" class="sidebar-link">Retrofit2 with RxJava</a></li><li><a href="/android/shortcutmanager.html" class="sidebar-link">ShortcutManager</a></li><li><a href="/android/lrucache.html" class="sidebar-link">LruCache</a></li><li><a href="/android/jenkins-ci-setup-for-android-projects.html" class="sidebar-link">Jenkins CI setup for Android Projects</a></li><li><a href="/android/fastlane.html" class="sidebar-link">fastlane</a></li><li><a href="/android/define-step-value-increment-for-custom-rangeseekbar.html" class="sidebar-link">Define step value (increment) for custom RangeSeekBar</a></li><li><a href="/android/getting-started-with-opengl-es-2-0.html" class="sidebar-link">Getting started with OpenGL ES 2.0+</a></li><li><a href="/android/check-data-connection.html" class="sidebar-link">Check Data Connection</a></li><li><a href="/android/java-on-android.html" class="sidebar-link">Java on Android</a></li><li><a href="/android/android-java-native-interface-jni.html" class="sidebar-link">Android Java Native Interface (JNI)</a></li><li><a href="/android/notification-channel-android-o.html" class="sidebar-link">Notification Channel Android O</a></li><li><a href="/android/robolectric.html" class="sidebar-link">Robolectric</a></li><li><a href="/android/moshi.html" class="sidebar-link">Moshi</a></li><li><a href="/android/strict-mode-policy-a-tool-to-catch-the-bug-in-the-compile-time.html" class="sidebar-link">Strict Mode Policy : A tool to catch the bug in the Compile Time.</a></li><li><a href="/android/internationalization-and-localization-i18n-and-l10n.html" class="sidebar-link">Internationalization and localization (I18N and L10N)</a></li><li><a href="/android/fast-way-to-setup-retrolambda-on-an-android-project.html" class="sidebar-link">Fast way to setup Retrolambda on an android project.</a></li><li><a href="/android/how-to-use-sparsearray.html" class="sidebar-link">How to use SparseArray</a></li><li><a href="/android/shared-element-transitions.html" class="sidebar-link">Shared Element Transitions</a></li><li><a href="/android/android-things.html" class="sidebar-link">Android Things</a></li><li><a href="/android/library-dagger-2-dependency-injection-in-applications.html" class="sidebar-link">Library Dagger 2: Dependency Injection in Applications</a></li><li><a href="/android/jcodec.html" class="sidebar-link">JCodec</a></li><li><a href="/android/formatting-phone-numbers-with-pattern.html" class="sidebar-link">Formatting phone numbers with pattern.</a></li><li><a href="/android/paint.html" class="sidebar-link">Paint</a></li><li><a href="/android/what-is-proguard-what-is-use-in-android.html" class="sidebar-link">What is ProGuard? What is use in Android?</a></li><li><a href="/android/create-android-custom-roms.html" class="sidebar-link">Create Android Custom ROMs</a></li><li><a href="/android/genymotion-for-android.html" class="sidebar-link">Genymotion for android</a></li><li><a href="/android/constraintset.html" class="sidebar-link">ConstraintSet</a></li><li><a href="/android/clevertap.html" class="sidebar-link">CleverTap</a></li><li><a href="/android/publish-a-library-to-maven-repositories.html" class="sidebar-link">Publish a library to Maven Repositories</a></li><li><a href="/android/adb-shell.html" class="sidebar-link">adb shell</a></li><li><a href="/android/ping-icmp.html" class="sidebar-link">Ping ICMP</a></li><li><a href="/android/aidl.html" class="sidebar-link">AIDL</a></li><li><a href="/android/android-game-development.html" class="sidebar-link">Android game development</a></li><li><a href="/android/android-programming-with-kotlin.html" class="sidebar-link">Android programming with Kotlin</a></li><li><a href="/android/android-x86-in-virtualbox.html" class="sidebar-link">Android-x86 in VirtualBox</a></li><li><a href="/android/leakcanary.html" class="sidebar-link">Leakcanary</a></li><li><a href="/android/okio.html" class="sidebar-link">Okio</a></li><li><a href="/android/bluetooth-low-energy.html" class="sidebar-link">Bluetooth Low Energy</a></li><li><a href="/android/looper.html" class="sidebar-link">Looper</a></li><li><a href="/android/annotation-processor.html" class="sidebar-link">Annotation Processor</a></li><li><a href="/android/syncadapter-with-periodically-do-sync-of-data.html" class="sidebar-link">SyncAdapter with periodically do sync of data</a></li><li><a href="/android/fastjson.html" class="sidebar-link">Fastjson</a></li><li><a href="/android/json-in-android-with-org-json.html" class="sidebar-link">JSON in Android with org.json</a></li><li><a href="/android/gson.html" class="sidebar-link">Gson</a></li><li><a href="/android/android-architecture-components.html" class="sidebar-link">Android Architecture Components</a></li><li><a href="/android/jackson.html" class="sidebar-link">Jackson</a></li><li><a href="/android/smartcard.html" class="sidebar-link">Smartcard</a></li><li><a href="/android/security.html" class="sidebar-link">Security</a></li><li><a href="/android/how-to-store-passwords-securely.html" class="sidebar-link">How to store passwords securely</a></li><li><a href="/android/secure-sharedpreferences.html" class="sidebar-link">Secure SharedPreferences</a></li><li><a href="/android/secure-sharedpreferences.html" class="sidebar-link">Secure SharedPreferences</a></li><li><a href="/android/sqlite.html" class="sidebar-link">SQLite</a></li><li><a href="/android/accessing-sqlite-databases-using-the-contentvalues-class.html" class="sidebar-link">Accessing SQLite databases using the ContentValues class</a></li><li><a href="/android/firebase.html" class="sidebar-link">Firebase</a></li><li><a href="/android/firebase-cloud-messaging.html" class="sidebar-link">Firebase Cloud Messaging</a></li><li><a href="/android/firebase-realtime-database.html" aria-current="page" class="active sidebar-link">Firebase Realtime DataBase</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/android/firebase-realtime-database.html#quick-setup" class="sidebar-link">Quick setup</a></li><li class="sidebar-sub-header"><a href="/android/firebase-realtime-database.html#firebase-realtime-database-event-handler" class="sidebar-link">Firebase Realtime DataBase event handler</a></li><li class="sidebar-sub-header"><a href="/android/firebase-realtime-database.html#designing-and-understanding-how-to-retrieve-realtime-data-from-the-firebase-database" class="sidebar-link">Designing and understanding how to retrieve realtime data from the Firebase Database</a></li><li class="sidebar-sub-header"><a href="/android/firebase-realtime-database.html#denormalization-flat-database-structure" class="sidebar-link">Denormalization: Flat Database Structure</a></li><li class="sidebar-sub-header"><a href="/android/firebase-realtime-database.html#understanding-firebase-json-database" class="sidebar-link">Understanding firebase JSON database</a></li><li class="sidebar-sub-header"><a href="/android/firebase-realtime-database.html#retrieving-data-from-firebase" class="sidebar-link">Retrieving data from firebase</a></li><li class="sidebar-sub-header"><a href="/android/firebase-realtime-database.html#listening-for-child-updates" class="sidebar-link">Listening for child updates</a></li><li class="sidebar-sub-header"><a href="/android/firebase-realtime-database.html#retrieving-data-with-pagination" class="sidebar-link">Retrieving data with pagination</a></li></ul></li><li><a href="/android/firebase-app-indexing.html" class="sidebar-link">Firebase App Indexing</a></li><li><a href="/android/firebase-crash-reporting.html" class="sidebar-link">Firebase Crash Reporting</a></li><li><a href="/android/twitter-apis.html" class="sidebar-link">Twitter APIs</a></li><li><a href="/android/youtube-api.html" class="sidebar-link">Youtube-API</a></li><li><a href="/android/integrate-google-sign-in.html" class="sidebar-link">Integrate Google Sign In</a></li><li><a href="/android/google-signin-integration-on-android.html" class="sidebar-link">Google signin integration on android</a></li><li><a href="/android/google-awareness-apis.html" class="sidebar-link">Google Awareness APIs</a></li><li><a href="/android/google-maps-api-v2-for-android.html" class="sidebar-link">Google Maps API v2 for Android</a></li><li><a href="/android/google-drive-api.html" class="sidebar-link">Google Drive API</a></li><li><a href="/android/displaying-google-ads.html" class="sidebar-link">Displaying Google Ads</a></li><li><a href="/android/admob.html" class="sidebar-link">AdMob</a></li><li><a href="/android/google-play-store.html" class="sidebar-link">Google Play Store</a></li><li><a href="/android/sign-your-android-app-for-release.html" class="sidebar-link">Sign your Android App for Release</a></li><li><a href="/android/tensorflow.html" class="sidebar-link">TensorFlow</a></li><li><a href="/android/android-vk-sdk.html" class="sidebar-link">Android Vk Sdk</a></li><li><a href="/android/project-sdk-versions.html" class="sidebar-link">Project SDK versions</a></li><li><a href="/android/facebook-sdk-for-android.html" class="sidebar-link">Facebook SDK for Android</a></li><li><a href="/android/thread.html" class="sidebar-link">Thread</a></li><li><a href="/android/asynctask.html" class="sidebar-link">AsyncTask</a></li><li><a href="/android/testing-ui-with-espresso.html" class="sidebar-link">Testing UI with Espresso</a></li><li><a href="/android/writing-ui-tests-android.html" class="sidebar-link">Writing UI tests - Android</a></li><li><a href="/android/unit-testing-in-android-with-junit.html" class="sidebar-link">Unit testing in Android with JUnit</a></li><li><a href="/android/inter-app-ui-testing-with-uiautomator.html" class="sidebar-link">Inter-app UI testing with UIAutomator</a></li><li><a href="/android/lint-warnings.html" class="sidebar-link">Lint Warnings</a></li><li><a href="/android/performance-optimization.html" class="sidebar-link">Performance Optimization</a></li><li><a href="/android/android-kernel-optimization.html" class="sidebar-link">Android Kernel Optimization</a></li><li><a href="/android/memory-leaks.html" class="sidebar-link">Memory Leaks</a></li><li><a href="/android/enhancing-android-performance-using-icon-fonts.html" class="sidebar-link">Enhancing Android Performance Using Icon Fonts</a></li><li><a href="/android/bitmap-cache.html" class="sidebar-link">Bitmap Cache</a></li><li><a href="/android/loading-bitmaps-effectively.html" class="sidebar-link">Loading Bitmaps Effectively</a></li><li><a href="/android/exceptions.html" class="sidebar-link">Exceptions</a></li><li><a href="/android/logging-and-using-logcat.html" class="sidebar-link">Logging and using Logcat</a></li><li><a href="/android/adb-android-debug-bridge.html" class="sidebar-link">ADB (Android Debug Bridge)</a></li><li><a href="/android/localization-with-resources-in-android.html" class="sidebar-link">Localization with resources in Android</a></li><li><a href="/android/convert-vietnamese-string-to-english-string-android.html" class="sidebar-link">Convert vietnamese string to english string Android</a></li><li><a href="/android/publish-aar-file-to-apache-archiva-with-gradle.html" class="sidebar-link">Publish .aar file to Apache Archiva with Gradle</a></li><li><a href="/android/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="firebase-realtime-database"><a href="#firebase-realtime-database" class="header-anchor">#</a> Firebase Realtime DataBase</h1> <h2 id="quick-setup"><a href="#quick-setup" class="header-anchor">#</a> Quick setup</h2> <li><p>Complete the [Installation and setup part](http://stackoverflow.com/documentation/android/3843/firebase/19049/add-firebase-to-your-android-project#t=201608180547233218048) to connect your app to Firebase.<br>
This will create the project in Firebase.</p></li> <li>
Add the dependency for Firebase Realtime Database to your module-level `build.gradle` file:
</li> <div class="language-java extra-class"><pre class="language-java"><code>compile <span class="token string">'com.google.firebase:firebase-database:10.2.1'</span>

</code></pre></div><ol><li>Configure <a href="http://stackoverflow.com/documentation/firebase/3352/database-rules#t=201608180548072123785" target="_blank" rel="noopener noreferrer">Firebase Database Rules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <p>Now you are ready to work with the Realtime Database in Android.</p> <p>For example you write a <code>Hello World</code> message to the database under the <code>message</code> key.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Write a message to the database</span>
<span class="token class-name">FirebaseDatabase</span> database <span class="token operator">=</span> <span class="token class-name">FirebaseDatabase</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">DatabaseReference</span> myRef <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

myRef<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, World!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="firebase-realtime-database-event-handler"><a href="#firebase-realtime-database-event-handler" class="header-anchor">#</a> Firebase Realtime DataBase event handler</h2> <p>First Initialize FirebaseDatabase:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">FirebaseDatabase</span> database <span class="token operator">=</span> <span class="token class-name">FirebaseDatabase</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Write to your database:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Write a message to the database</span>
<span class="token class-name">FirebaseDatabase</span> database <span class="token operator">=</span> <span class="token class-name">FirebaseDatabase</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">DatabaseReference</span> myRef <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

myRef<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, World!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Read from your database:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Read from the database</span>
myRef<span class="token punctuation">.</span><span class="token function">addValueEventListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValueEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDataChange</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// This method is called once with the initial value and again</span>
        <span class="token comment">// whenever data at this location is updated.</span>
        <span class="token class-name">String</span> value <span class="token operator">=</span> dataSnapshot<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;Value is: &quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCancelled</span><span class="token punctuation">(</span><span class="token class-name">DatabaseError</span> error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Failed to read value</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;Failed to read value.&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span><span class="token function">toException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Retrieve Data on Android events:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ChildEventListener</span> childEventListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChildEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildAdded</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> previousChildName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;onChildAdded:&quot;</span> <span class="token operator">+</span> dataSnapshot<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildChanged</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> previousChildName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;onChildChanged:&quot;</span> <span class="token operator">+</span> dataSnapshot<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildRemoved</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;onChildRemoved:&quot;</span> <span class="token operator">+</span> dataSnapshot<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildMoved</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> previousChildName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;onChildMoved:&quot;</span> <span class="token operator">+</span> dataSnapshot<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCancelled</span><span class="token punctuation">(</span><span class="token class-name">DatabaseError</span> databaseError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;postComments:onCancelled&quot;</span><span class="token punctuation">,</span> databaseError<span class="token punctuation">.</span><span class="token function">toException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>mContext<span class="token punctuation">,</span> <span class="token string">&quot;Failed to load comments.&quot;</span><span class="token punctuation">,</span>
                <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
ref<span class="token punctuation">.</span><span class="token function">addChildEventListener</span><span class="token punctuation">(</span>childEventListener<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="designing-and-understanding-how-to-retrieve-realtime-data-from-the-firebase-database"><a href="#designing-and-understanding-how-to-retrieve-realtime-data-from-the-firebase-database" class="header-anchor">#</a> Designing and understanding how to retrieve realtime data from the Firebase Database</h2> <p>This example assumes that you have already set up a Firebase Realtime Database. If you are a starter, then please inform yourself <a href="https://firebase.google.com/docs/android/setup" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on how to add Firebase to your Android project.</p> <p>First, add the dependency of the Firebase Database to the app level <strong>build.gradle</strong> file:</p> <div class="language-java extra-class"><pre class="language-java"><code>compile <span class="token string">'com.google.firebase:firebase-database:9.4.0'</span>

</code></pre></div><p>Now, let us create a chat app which stores data into the Firebase Database.</p> <h3 id="step-1-create-a-class-named-chat"><a href="#step-1-create-a-class-named-chat" class="header-anchor">#</a> Step 1: Create a class named Chat</h3> <p>Just create a class with some basic variables required for the chat:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Chat</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> message<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="step-2-create-some-json-data"><a href="#step-2-create-some-json-data" class="header-anchor">#</a> Step 2: Create some JSON data</h3> <p>For sending/retrieving data to/from the Firebase Database, you need to use JSON. Let us assume that some chats are already stored at the root level in the database. The data of these chats could look like as follows:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;message&quot;</span><span class="token operator">:</span><span class="token string">&quot;My first Message&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;message&quot;</span><span class="token operator">:</span><span class="token string">&quot;Second Message&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;message&quot;</span><span class="token operator">:</span><span class="token string">&quot;Third Message&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><h3 id="step-3-adding-the-listeners"><a href="#step-3-adding-the-listeners" class="header-anchor">#</a> Step 3: Adding the listeners</h3> <p>There are three types of listeners. In the following example we are going to use the <code>childEventListener</code>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">DatabaseReference</span> chatDb <span class="token operator">=</span> <span class="token class-name">FirebaseDatabase</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Referencing the root of the database.</span>
        <span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">&quot;chats&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Referencing the &quot;chats&quot; node under the root.</span>

chatDb<span class="token punctuation">.</span><span class="token function">addChildEventListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChildEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildAdded</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// This function is called for every child id chat in this case, so using the above</span>
        <span class="token comment">// example, this function is going to be called 3 times.</span>
        
        <span class="token comment">// Retrieving the Chat object from this function is simple.</span>
        <span class="token class-name">Chat</span> chat<span class="token punctuation">;</span> <span class="token comment">// Create a null chat object.</span>

        <span class="token comment">// Use the getValue function in the dataSnapshot and pass the object's class name to</span>
        <span class="token comment">// which you want to convert and get data. In this case it is Chat.class.</span>
        chat <span class="token operator">=</span> dataSnapshot<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token class-name">Chat</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Now you can use this chat object and add it into an ArrayList or something like</span>
        <span class="token comment">// that and show it in the recycler view.</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildChanged</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// This function is called when any of the node value is changed, dataSnapshot will</span>
        <span class="token comment">// get the data with the key of the child, so you can swap the new value with the</span>
        <span class="token comment">// old one in the ArrayList or something like that.</span>

        <span class="token comment">// To get the key, use the .getKey() function.</span>
        <span class="token comment">// To get the value, use code similar to the above one.</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildRemoved</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// This function is called when any of the child node is removed. dataSnapshot will</span>
        <span class="token comment">// get the data with the key of the child.</span>

        <span class="token comment">// To get the key, use the s String parameter .</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildMoved</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// This function is called when any of the child nodes is moved to a different position.</span>

        <span class="token comment">// To get the key, use the s String parameter.</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCancelled</span><span class="token punctuation">(</span><span class="token class-name">DatabaseError</span> databaseError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// If anything goes wrong, this function is going to be called.</span>

        <span class="token comment">// You can get the exception by using databaseError.toException();</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="step-4-add-data-to-the-database"><a href="#step-4-add-data-to-the-database" class="header-anchor">#</a> Step 4: Add data to the database</h3> <p>Just create a Chat class object and add the values as follows:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Chat</span> chat<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Chat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
chat<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">;</span>
chat<span class="token punctuation">.</span>message<span class="token operator">=</span><span class="token string">&quot;First message from android&quot;</span><span class="token punctuation">;</span>

</code></pre></div><p>Now get a reference to the chats node as done in the retrieving session:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">DatabaseReference</span> chatDb <span class="token operator">=</span> <span class="token class-name">FirebaseDatabase</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">&quot;chats&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Before you start adding data, keep in mind that you need one more deep reference since a chat node has several more nodes and adding a new chat means adding a new node containing the chat details. We can generate a new and unique name of the node using the <code>push()</code> function on the <code>DatabaseReference</code> object, which will return another <code>DatabaseReference</code>, which in turn points to a newly formed node to insert the chat data.</p> <h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// The parameter is the chat object that was newly created a few lines above.</span>
chatDb<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>chat<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>The <code>setValue()</code> function will make sure that all of the application's <code>onDataChanged</code> functions are getting called (including the same device), which happens to be the attached listener of the &quot;chats&quot; node.</p> <h2 id="denormalization-flat-database-structure"><a href="#denormalization-flat-database-structure" class="header-anchor">#</a> Denormalization: Flat Database Structure</h2> <p>Denormalization and a flat database structure is neccessary to efficiently download separate calls. With the following structure, it is also possible to maintain two-way relationships. The disadvantage of this approach is, that you always need to update the data in multiple places.</p> <p>For an example, imagine an app which allows the user to store messages to himself (memos).</p> <p>Desired flat database structure:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token operator">|</span><span class="token operator">--</span>database
  <span class="token operator">|</span><span class="token operator">--</span> memos
     <span class="token operator">|</span><span class="token operator">--</span> memokey1
       <span class="token operator">|</span><span class="token operator">--</span> title<span class="token operator">:</span> <span class="token string">&quot;Title&quot;</span>
       <span class="token operator">|</span><span class="token operator">--</span> content<span class="token operator">:</span> <span class="token string">&quot;Message&quot;</span>
     <span class="token operator">|</span><span class="token operator">--</span> memokey2
       <span class="token operator">|</span><span class="token operator">--</span> title<span class="token operator">:</span> <span class="token string">&quot;Important Title&quot;</span>
       <span class="token operator">|</span><span class="token operator">--</span> content<span class="token operator">:</span> <span class="token string">&quot;Important Message&quot;</span>
  <span class="token operator">|</span><span class="token operator">--</span> users
     <span class="token operator">|</span><span class="token operator">--</span> userKey1
       <span class="token operator">|</span><span class="token operator">--</span> name<span class="token operator">:</span> <span class="token string">&quot;John Doe&quot;</span>
       <span class="token operator">|</span><span class="token operator">--</span> memos
         <span class="token operator">|</span><span class="token operator">--</span> memokey1 <span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">//The values here don't matter, we only need the keys.</span>
         <span class="token operator">|</span><span class="token operator">--</span> memokey2 <span class="token operator">:</span> <span class="token boolean">true</span>
     <span class="token operator">|</span><span class="token operator">--</span> userKey2
       <span class="token operator">|</span><span class="token operator">--</span> name<span class="token operator">:</span> <span class="token string">&quot;Max Doe&quot;</span>

</code></pre></div><p><strong>The used memo class</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Memo</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">,</span> content<span class="token punctuation">;</span>
    <span class="token comment">//getters and setters ... </span>

    <span class="token comment">//toMap() is necessary for the push process</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">toMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Retrieving the memos of a user</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//We need to store the keys and the memos seperately</span>
<span class="token keyword">private</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> mKeys <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Memo</span><span class="token punctuation">&gt;</span></span> mMemos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//The user needs to be logged in to retrieve the uid</span>
<span class="token class-name">String</span> currentUserId <span class="token operator">=</span> <span class="token class-name">FirebaseAuth</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//This is the reference to the list of memos a user has </span>
<span class="token class-name">DatabaseReference</span> currentUserMemoReference <span class="token operator">=</span> <span class="token class-name">FirebaseDatabase</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span>currentUserId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">&quot;memos&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//This is a reference to the list of all memos</span>
<span class="token class-name">DatabaseReference</span> memoReference <span class="token operator">=</span> <span class="token class-name">FirebaseDatabase</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">&quot;memos&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//We start to listen to the users memos, </span>
<span class="token comment">//this will also retrieve the memos initially</span>
currentUserMemoReference<span class="token punctuation">.</span><span class="token function">addChildEventListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChildEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildAdded</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//Here we retrieve the key of the memo the user has.</span>
            <span class="token class-name">String</span> key <span class="token operator">=</span> dataSnapshot<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//for example memokey1</span>
            <span class="token comment">//For later manipulations of the lists, we need to store the key in a list</span>
            mKeys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//Now that we know which message belongs to the user, </span>
            <span class="token comment">//we request it from our memos:</span>
            memoReference<span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addValueEventListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValueEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDataChange</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                         <span class="token comment">//Here we retrieve our memo:</span>
                         <span class="token class-name">Memo</span> memo <span class="token operator">=</span> dataSnapshot<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token class-name">Memo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                         mMemos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>memo<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCancelled</span><span class="token punctuation">(</span><span class="token class-name">DatabaseError</span> databaseError<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                           
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildChanged</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildRemoved</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildMoved</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCancelled</span><span class="token punctuation">(</span><span class="token class-name">DatabaseError</span> databaseError<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre></div><p><strong>Creating a memo</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//The user needs to be logged in to retrieve the uid</span>
<span class="token class-name">String</span> currentUserUid <span class="token operator">=</span> <span class="token class-name">FirebaseAuth</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//This is the path to the list of memos a user has </span>
<span class="token class-name">String</span> userMemoPath <span class="token operator">=</span> <span class="token string">&quot;users/&quot;</span> <span class="token operator">+</span> currentUserUid <span class="token operator">+</span> <span class="token string">&quot;/memos/&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//This is the path to the list of all memos</span>
<span class="token class-name">String</span> memoPath <span class="token operator">=</span> <span class="token string">&quot;memos/&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//We need to retrieve an unused key from the memos reference</span>
<span class="token class-name">DatabaseReference</span> memoReference <span class="token operator">=</span> <span class="token class-name">FirebaseDatabase</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">&quot;memos&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> key <span class="token operator">=</span> memoReference<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Memo</span> newMemo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Memo</span><span class="token punctuation">(</span><span class="token string">&quot;Important numbers&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1337, 42, 3.14159265359&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> childUpdates <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//The second parameter **here** (the value) does not matter, it's just that the key exists</span>
childUpdates<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>userMemoPath <span class="token operator">+</span> key<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
childUpdates<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>memoPath <span class="token operator">+</span> key<span class="token punctuation">,</span> newMemo<span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">FirebaseDatabase</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">updateChildren</span><span class="token punctuation">(</span>childUpdates<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>After the push, or database looks like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token operator">|</span><span class="token operator">--</span>database
  <span class="token operator">|</span><span class="token operator">--</span> memos
     <span class="token operator">|</span><span class="token operator">--</span> memokey1
       <span class="token operator">|</span><span class="token operator">--</span> title<span class="token operator">:</span> <span class="token string">&quot;Title&quot;</span>
       <span class="token operator">|</span><span class="token operator">--</span> content<span class="token operator">:</span> <span class="token string">&quot;Message&quot;</span>
     <span class="token operator">|</span><span class="token operator">--</span> memokey2
       <span class="token operator">|</span><span class="token operator">--</span> title<span class="token operator">:</span> <span class="token string">&quot;Important Title&quot;</span>
       <span class="token operator">|</span><span class="token operator">--</span> content<span class="token operator">:</span> <span class="token string">&quot;Important Message&quot;</span>
     <span class="token operator">|</span><span class="token operator">--</span> generatedMemokey3 
       <span class="token operator">|</span><span class="token operator">--</span> title<span class="token operator">:</span> <span class="token string">&quot;Important numbers&quot;</span>
       <span class="token operator">|</span><span class="token operator">--</span> content<span class="token operator">:</span> <span class="token string">&quot;1337, 42, 3.14159265359&quot;</span>
  <span class="token operator">|</span><span class="token operator">--</span> users
     <span class="token operator">|</span><span class="token operator">--</span> userKey1
       <span class="token operator">|</span><span class="token operator">--</span> name<span class="token operator">:</span> <span class="token string">&quot;John Doe&quot;</span>
       <span class="token operator">|</span><span class="token operator">--</span> memos
         <span class="token operator">|</span><span class="token operator">--</span> memokey1 <span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">//The values here don't matter, we only need the keys.</span>
         <span class="token operator">|</span><span class="token operator">--</span> memokey2 <span class="token operator">:</span> <span class="token boolean">true</span>
         <span class="token operator">|</span><span class="token operator">--</span> generatedMemokey3 <span class="token operator">:</span> <span class="token boolean">true</span>
     <span class="token operator">|</span><span class="token operator">--</span> userKey2
       <span class="token operator">|</span><span class="token operator">--</span> name<span class="token operator">:</span> <span class="token string">&quot;Max Doe&quot;</span>

</code></pre></div><h2 id="understanding-firebase-json-database"><a href="#understanding-firebase-json-database" class="header-anchor">#</a> Understanding firebase JSON database</h2> <p>Before we get our hands dirty with code, I feel it is necessary to understand how data is stored in firebase. Unlike relational databases, firebase stores data in JSON format. Think of each row in a relational database as a JSON object (which is basically unordered key-value pair). So the column name becomes key and the value stored in that column for one particular row is the value. This way the entire row is represented as a JSON object and a list of these represent an entire database table. The immediate benefit that I see for this is schema modification becomes much more cheaper operation compared to old RDBMS. It is easier to add a couple of more attributes to a JSON than altering a table structure.</p> <p>here is a sample JSON to show how data is stored in firebase:</p> <div class="language- extra-class"><pre class="language-text"><code>
  {
    &quot;user_base&quot; : {
      &quot;342343&quot; : {
        &quot;email&quot; : &quot;kaushal.xxxxx@gmail.com&quot;,
        &quot;authToken&quot; : &quot;some string&quot;,
        &quot;name&quot; : &quot;Kaushal&quot;,
        &quot;phone&quot; : &quot;+919916xxxxxx&quot;,
        &quot;serviceProviderId&quot; : &quot;firebase&quot;,
        &quot;signInServiceType&quot; : &quot;google&quot;,
      },
      &quot;354895&quot; : {
        &quot;email&quot; : &quot;xxxxx.devil@gmail.com&quot;,
        &quot;authToken&quot; : &quot;some string&quot;,
        &quot;name&quot; : &quot;devil&quot;,
        &quot;phone&quot; : &quot;+919685xxxxxx&quot;,
        &quot;serviceProviderId&quot; : &quot;firebase&quot;,
        &quot;signInServiceType&quot; : &quot;github&quot;
      },
      &quot;371298&quot; : {
        &quot;email&quot; : &quot;bruce.wayne@wayneinc.com&quot;,
        &quot;authToken&quot; : &quot;I am batman&quot;,
        &quot;name&quot; : &quot;Bruce Wayne&quot;,
        &quot;phone&quot; : &quot;+14085xxxxxx&quot;,
        &quot;serviceProviderId&quot; : &quot;firebase&quot;,
        &quot;signInServiceType&quot; : &quot;shield&quot;
      }
    },
    &quot;user_prefs&quot;: {
      &quot;key1&quot;:{
        &quot;data&quot;: &quot;for key one&quot;
      },
      &quot;key2&quot;:{
        &quot;data&quot;: &quot;for key two&quot;
      },
      &quot;key3&quot;:{
        &quot;data&quot;: &quot;for key three&quot;
      }
    },
    //other structures
  }

</code></pre></div><p>This clearly shows how data that we used to store in relational databases can be stored in JSON format. Next let's see how to read this data in android devices.</p> <h2 id="retrieving-data-from-firebase"><a href="#retrieving-data-from-firebase" class="header-anchor">#</a> Retrieving data from firebase</h2> <p>I am gonna assume you already know about adding gradle dependencies firebase in android studio. If you don't just follow the guide from <a href="https://firebase.google.com/" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Add your app in firebase console, gradle sync android studio after adding dependencies. All dependencies are not needed just firebase database and firebase auth.</p> <p>Now that we know how data is stored and how to add gradle dependencies let's see how to use the imported firebase android SDK to retrieve data.</p> <p>create a firebase database reference</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">DatabaseReference</span> userDBRef <span class="token operator">=</span> <span class="token class-name">FirebaseDatabase</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// above statement point to base tree</span>
userDBRef <span class="token operator">=</span> <span class="token class-name">DatabaseReference</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">&quot;user_base&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// points to user_base table JSON (see previous section)</span>

</code></pre></div><p>from here you can chain multiple child() method calls to point to the data you are interested in. For example if data is stored as depicted in previous section and you want to point to Bruce Wayne user you can use:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">DatabaseReference</span> bruceWayneRef <span class="token operator">=</span> userDBRef<span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">&quot;371298&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 371298 is key of bruce wayne user in JSON structure (previous section)</span>

</code></pre></div><p>Or simply pass the whole reference to the JSON object:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">DatabaseReference</span> bruceWayneRef <span class="token operator">=</span> <span class="token class-name">DatabaseReference</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">&quot;user_base/371298&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// deeply nested data can also be referenced this way, just put the fully</span>
<span class="token comment">// qualified path in pattern shown in above code &quot;blah/blah1/blah1-2/blah1-2-3...&quot;</span>

</code></pre></div><p>Now that we have the reference of the data we want to fetch, we can use listeners to fetch data in android apps. Unlike the traditional calls where you fire REST API calls using retrofit or volley, here a simple callback listener is required to get the data. Firebase sdk calls the callback methods and you are done.</p> <p>There are basically two types of listeners you can attach, one is <a href="https://firebase.google.com/docs/reference/android/com/google/firebase/database/ValueEventListener" target="_blank" rel="noopener noreferrer">ValueEventListener<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and the other one is <a href="https://firebase.google.com/docs/reference/android/com/google/firebase/database/ChildEventListener" target="_blank" rel="noopener noreferrer">ChildEventListener<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (described in next section). For any change in data under the node we have references and added listeners to, value event listeners return the entire JSON structure and child event listener returns specific child where the change has happened. Both of these are useful in their own way. To fetch the data from firebase we can add one or more listeners to a firebase database reference (list userDBRef we created earlier).</p> <p>Here is some sample code (code explanation after code):</p> <div class="language-java extra-class"><pre class="language-java"><code>userDBRef<span class="token punctuation">.</span><span class="token function">addValueEventListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValueEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDataChange</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> bruceWayne <span class="token operator">=</span> dataSnapshot<span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">&quot;371298&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Do something with the retrieved data or Bruce Wayne</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCancelled</span><span class="token punctuation">(</span><span class="token class-name">DatabaseError</span> databaseError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;UserListActivity&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Error occured&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Do something about the error</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Did you notice the Class type passed. <a href="https://www.firebase.com/docs/java-api/javadoc/com/firebase/client/DataSnapshot.html" target="_blank" rel="noopener noreferrer">DataSnapshot<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> can convert JSON data into our defined POJOs, simple pass the right class type.</p> <p>If your use case does not require the entire data (in our case user_base table) every time some little change occurs or say you want to <strong><strong>fetch the data only once</strong></strong>, you can use <strong><strong>addListenerForSingleValueEvent()</strong></strong> method of Database reference. This fires the callback only once.</p> <div class="language-java extra-class"><pre class="language-java"><code>userDBRef<span class="token punctuation">.</span><span class="token function">addListenerForSingleValueEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValueEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDataChange</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Do something</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCancelled</span><span class="token punctuation">(</span><span class="token class-name">DatabaseError</span> databaseError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Do something about the error</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Above samples will give you the value of the JSON node. To get the key simply call:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> myKey <span class="token operator">=</span> dataSnapshot<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="listening-for-child-updates"><a href="#listening-for-child-updates" class="header-anchor">#</a> Listening for child updates</h2> <p>Take a use case, like a chat app or a collaborative grocery list app (that basically requires a list of objects to be synced across users). If you use firebase database and add a value event listener to the chat parent node or grocery list parent node, you will end with entire chat structure from the beginning of time (i meant beginning of your chat) every time a chat node is added (i.e. anyone says hi). That we don't want to do, what we are interested in is only the new node or only the old node that got deleted or modified, the unchanged ones should not be returned.</p> <p>In this case we can use <a href="https://firebase.google.com/docs/reference/android/com/google/firebase/database/ChildEventListener" target="_blank" rel="noopener noreferrer">ChildEvenListener<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Without any further adieu, here is code sample (see prev sections for sample JSON data):</p> <div class="language-java extra-class"><pre class="language-java"><code>userDBRef<span class="token punctuation">.</span><span class="token function">addChildEventListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChildEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildAdded</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildChanged</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildRemoved</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChildMoved</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">,</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//If not dealing with ordered data forget about this</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCancelled</span><span class="token punctuation">(</span><span class="token class-name">DatabaseError</span> databaseError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Method names are self explanatory. As you can see whenever a new user is added or some property of existing user is modified or user is deleted or removed appropriate callback method of child event listener is called with relevant data. So if you are keeping UI refreshed for say chat app, get the JSON from onChildAdded() parse into POJO and fit it in your UI. Just remember to remove your listener when user leaves the screen.</p> <p>onChildChanged() gives the entire child value with changed properties (new ones).</p> <p>onChiledRemoved() returns the removed child node.</p> <h2 id="retrieving-data-with-pagination"><a href="#retrieving-data-with-pagination" class="header-anchor">#</a> Retrieving data with pagination</h2> <p>When you have a huge JSON database, adding a value event listener doesn't make sense. It will return the huge JSON and parsing it would be time consuming. In such cases we can use pagination and fetch part of data and display or process it. Kind of like lazy loading or like fetching old chats when user clicks on show older chat. In this case <a href="https://firebase.google.com/docs/reference/android/com/google/firebase/database/Query" target="_blank" rel="noopener noreferrer">Query<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> can used.</p> <p>Let's take the our old example in previous sections. The user base contains 3 users, if it grows to say 3 hundred thousand user and you want to fetch the user list in batches of 50:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// class level</span>
<span class="token keyword">final</span> <span class="token keyword">int</span> limit <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">// event level</span>
<span class="token class-name">Query</span> userListQuery <span class="token operator">=</span> userDBRef<span class="token punctuation">.</span><span class="token function">orderByChild</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limitToFirst</span><span class="token punctuation">(</span>limit<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">startAt</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span>
userListQuery<span class="token punctuation">.</span><span class="token function">addValueEventListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValueEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDataChange</span><span class="token punctuation">(</span><span class="token class-name">DataSnapshot</span> dataSnapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Do something</span>
        start <span class="token operator">+=</span> <span class="token punctuation">(</span>limit<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCancelled</span><span class="token punctuation">(</span><span class="token class-name">DatabaseError</span> databaseError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Do something about the error</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Here value or child events can be added and listened to. Call query again to fetch next 50. <strong>Make sure to add the orderByChild() method</strong>, this will not work without that. Firebase needs to know the order by which you are paginating.</p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <h3 id="other-related-topics"><a href="#other-related-topics" class="header-anchor">#</a> Other related topics:</h3> <ul><li><a href="http://stackoverflow.com/documentation/android/3843/firebase#t=201608180555120758354" target="_blank" rel="noopener noreferrer">Firebase<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/android/firebase-realtime-database.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/android/firebase-cloud-messaging.html" class="prev">
        Firebase Cloud Messaging
      </a></span> <span class="next"><a href="/android/firebase-app-indexing.html">
        Firebase App Indexing
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/180.eb90f997.js" defer></script>
  </body>
</html>
