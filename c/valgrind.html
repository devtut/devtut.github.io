<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C - Valgrind</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Bytes lost -- Forgetting to free, Most common errors encountered while using Valgrind, Running Valgrind, Adding flags">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="C - Valgrind">
    <meta property="og:description" content="Bytes lost -- Forgetting to free, Most common errors encountered while using Valgrind, Running Valgrind, Adding flags">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/c/valgrind.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="C - Valgrind">
    <meta name="twitter:description" content="Bytes lost -- Forgetting to free, Most common errors encountered while using Valgrind, Running Valgrind, Adding flags">
    <meta name="twitter:url" content="/c/valgrind.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/604.48209815.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>C</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/c/" class="sidebar-link">Disclaimer</a></li><li><a href="/c/getting-started-with-c-language.html" class="sidebar-link">Getting started with C Language</a></li><li><a href="/c/comments.html" class="sidebar-link">Comments</a></li><li><a href="/c/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/c/operators.html" class="sidebar-link">Operators</a></li><li><a href="/c/boolean.html" class="sidebar-link">Boolean</a></li><li><a href="/c/strings.html" class="sidebar-link">Strings</a></li><li><a href="/c/literals-for-numbers-characters-and-strings.html" class="sidebar-link">Literals for numbers, characters and strings</a></li><li><a href="/c/compound-literals.html" class="sidebar-link">Compound Literals</a></li><li><a href="/c/bit-fields.html" class="sidebar-link">Bit-fields</a></li><li><a href="/c/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/c/linked-lists.html" class="sidebar-link">Linked lists</a></li><li><a href="/c/enumerations.html" class="sidebar-link">Enumerations</a></li><li><a href="/c/structs.html" class="sidebar-link">Structs</a></li><li><a href="/c/standard-math.html" class="sidebar-link">Standard Math</a></li><li><a href="/c/iteration-statements-loops-for-while-do-while.html" class="sidebar-link">Iteration Statements/Loops: for, while, do-while</a></li><li><a href="/c/selection-statements.html" class="sidebar-link">Selection Statements</a></li><li><a href="/c/initialization.html" class="sidebar-link">Initialization</a></li><li><a href="/c/declaration-vs-definition.html" class="sidebar-link">Declaration vs Definition</a></li><li><a href="/c/files-and-i-o-streams.html" class="sidebar-link">Files and I/O streams</a></li><li><a href="/c/formatted-input-output.html" class="sidebar-link">Formatted Input/Output</a></li><li><a href="/c/pointers.html" class="sidebar-link">Pointers</a></li><li><a href="/c/sequence-points.html" class="sidebar-link">Sequence points</a></li><li><a href="/c/function-pointers.html" class="sidebar-link">Function Pointers</a></li><li><a href="/c/function-parameters.html" class="sidebar-link">Function Parameters</a></li><li><a href="/c/pass-2d-arrays-to-functions.html" class="sidebar-link">Pass 2D-arrays to functions</a></li><li><a href="/c/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/c/undefined-behavior.html" class="sidebar-link">Undefined behavior</a></li><li><a href="/c/random-number-generation.html" class="sidebar-link">Random Number Generation</a></li><li><a href="/c/preprocessor-and-macros.html" class="sidebar-link">Preprocessor and Macros</a></li><li><a href="/c/signal-handling.html" class="sidebar-link">Signal handling</a></li><li><a href="/c/variable-arguments.html" class="sidebar-link">Variable arguments</a></li><li><a href="/c/assertion.html" class="sidebar-link">Assertion</a></li><li><a href="/c/generic-selection.html" class="sidebar-link">Generic selection</a></li><li><a href="/c/x-macros.html" class="sidebar-link">X-macros</a></li><li><a href="/c/aliasing-and-effective-type.html" class="sidebar-link">Aliasing and effective type</a></li><li><a href="/c/compilation.html" class="sidebar-link">Compilation</a></li><li><a href="/c/identifier-scope.html" class="sidebar-link">Identifier Scope</a></li><li><a href="/c/common-pitfalls.html" class="sidebar-link">Common pitfalls</a></li><li><a href="/c/implicit-and-explicit-conversions.html" class="sidebar-link">Implicit and Explicit Conversions</a></li><li><a href="/c/type-qualifiers.html" class="sidebar-link">Type Qualifiers</a></li><li><a href="/c/valgrind.html" class="active sidebar-link">Valgrind</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/c/valgrind.html#bytes-lost-forgetting-to-free" class="sidebar-link">Bytes lost -- Forgetting to free</a></li><li class="sidebar-sub-header"><a href="/c/valgrind.html#most-common-errors-encountered-while-using-valgrind" class="sidebar-link">Most common errors encountered while using Valgrind</a></li><li class="sidebar-sub-header"><a href="/c/valgrind.html#running-valgrind" class="sidebar-link">Running Valgrind</a></li><li class="sidebar-sub-header"><a href="/c/valgrind.html#adding-flags" class="sidebar-link">Adding flags</a></li></ul></li><li><a href="/c/typedef.html" class="sidebar-link">Typedef</a></li><li><a href="/c/storage-classes.html" class="sidebar-link">Storage Classes</a></li><li><a href="/c/declarations.html" class="sidebar-link">Declarations</a></li><li><a href="/c/inline-assembly.html" class="sidebar-link">Inline assembly</a></li><li><a href="/c/threads-native.html" class="sidebar-link">Threads (native)</a></li><li><a href="/c/structure-padding-and-packing.html" class="sidebar-link">Structure Padding and Packing</a></li><li><a href="/c/memory-management.html" class="sidebar-link">Memory management</a></li><li><a href="/c/implementation-defined-behaviour.html" class="sidebar-link">Implementation-defined behaviour</a></li><li><a href="/c/atomics.html" class="sidebar-link">Atomics</a></li><li><a href="/c/jump-statements.html" class="sidebar-link">Jump Statements</a></li><li><a href="/c/create-and-include-header-files.html" class="sidebar-link">Create and include header files</a></li><li><a href="/c/testing-frameworks.html" class="sidebar-link">Testing frameworks</a></li><li><a href="/c/ctype-h-character-classification-conversion.html" class="sidebar-link">— character classification &amp; conversion</a></li><li><a href="/c/side-effects.html" class="sidebar-link">Side Effects</a></li><li><a href="/c/multi-character-character-sequence.html" class="sidebar-link">Multi-Character Character Sequence</a></li><li><a href="/c/constraints.html" class="sidebar-link">Constraints</a></li><li><a href="/c/inlining.html" class="sidebar-link">Inlining</a></li><li><a href="/c/unions.html" class="sidebar-link">Unions</a></li><li><a href="/c/threads-native.html" class="sidebar-link">Threads (native)</a></li><li><a href="/c/multithreading.html" class="sidebar-link">Multithreading</a></li><li><a href="/c/interprocess-communication-ipc.html" class="sidebar-link">Interprocess Communication (IPC)</a></li><li><a href="/c/testing-frameworks.html" class="sidebar-link">Testing frameworks</a></li><li><a href="/c/valgrind.html" class="active sidebar-link">Valgrind</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/c/valgrind.html#bytes-lost-forgetting-to-free" class="sidebar-link">Bytes lost -- Forgetting to free</a></li><li class="sidebar-sub-header"><a href="/c/valgrind.html#most-common-errors-encountered-while-using-valgrind" class="sidebar-link">Most common errors encountered while using Valgrind</a></li><li class="sidebar-sub-header"><a href="/c/valgrind.html#running-valgrind" class="sidebar-link">Running Valgrind</a></li><li class="sidebar-sub-header"><a href="/c/valgrind.html#adding-flags" class="sidebar-link">Adding flags</a></li></ul></li><li><a href="/c/common-c-programming-idioms-and-developer-practices.html" class="sidebar-link">Common C programming idioms and developer practices</a></li><li><a href="/c/common-pitfalls.html" class="sidebar-link">Common pitfalls</a></li><li><a href="/c/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="valgrind"><a href="#valgrind" class="header-anchor">#</a> Valgrind</h1> <h2 id="bytes-lost-forgetting-to-free"><a href="#bytes-lost-forgetting-to-free" class="header-anchor">#</a> Bytes lost -- Forgetting to free</h2> <p>Here is a program that calls malloc but not free:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">;</span>

    s <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// the culprint </span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>With no extra arguments, valgrind will not look for this error.</p> <p>But if we turn on <code>--leak-check=yes</code> or <code>--tool=memcheck</code>, it will complain and display the lines responsible for those memory leaks if the program was compiled in debug mode:</p> <div class="language-c extra-class"><pre class="language-c"><code>$ valgrind <span class="token operator">-</span>q <span class="token operator">--</span>leak<span class="token operator">-</span>check<span class="token operator">=</span>yes <span class="token punctuation">.</span><span class="token operator">/</span>missing_free
<span class="token operator">==</span><span class="token number">4776</span><span class="token operator">==</span> <span class="token number">26</span> bytes in <span class="token number">1</span> blocks are definitely lost in loss record <span class="token number">1</span> of <span class="token number">1</span>
<span class="token operator">==</span><span class="token number">4776</span><span class="token operator">==</span>    at <span class="token number">0x4024F20</span><span class="token operator">:</span> <span class="token function">malloc</span> <span class="token punctuation">(</span>vg_replace_malloc<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">236</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">4776</span><span class="token operator">==</span>    by <span class="token number">0x80483F8</span><span class="token operator">:</span> <span class="token function">main</span> <span class="token punctuation">(</span>missing_free<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">4776</span><span class="token operator">==</span> 

</code></pre></div><p>If the program is not compiled in debug mode (for example with the <code>-g</code> flag in GCC) it will still show us where the leak happened in terms of the relevant function, but not the lines.</p> <p>This lets us go back and look at what block was allocated in that line and try to trace forward to see why it wasn't freed.</p> <h2 id="most-common-errors-encountered-while-using-valgrind"><a href="#most-common-errors-encountered-while-using-valgrind" class="header-anchor">#</a> Most common errors encountered while using Valgrind</h2> <p>Valgrind provides you with the <strong>lines at which the error occurred</strong> at the end of each line in the format <code>(file.c:line_no)</code>. Errors in valgrind are summarised in the following way:</p> <div class="language-c extra-class"><pre class="language-c"><code>ERROR SUMMARY<span class="token operator">:</span> <span class="token number">1</span> errors from <span class="token number">1</span> <span class="token function">contexts</span> <span class="token punctuation">(</span>suppressed<span class="token operator">:</span> <span class="token number">0</span> from <span class="token number">0</span><span class="token punctuation">)</span>

</code></pre></div><p>The most common errors include:</p> <ol><li><strong>Illegal read/write errors</strong></li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">==</span><span class="token number">8451</span><span class="token operator">==</span> Invalid read of size <span class="token number">2</span>
<span class="token operator">==</span><span class="token number">8451</span><span class="token operator">==</span>    at <span class="token number">0x4E7381D</span><span class="token operator">:</span> <span class="token function">getenv</span> <span class="token punctuation">(</span>getenv<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">84</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8451</span><span class="token operator">==</span>    by <span class="token number">0x4EB1559</span><span class="token operator">:</span> <span class="token function">__libc_message</span> <span class="token punctuation">(</span>libc_fatal<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">80</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8451</span><span class="token operator">==</span>    by <span class="token number">0x4F5256B</span><span class="token operator">:</span> <span class="token function">__fortify_fail</span> <span class="token punctuation">(</span>fortify_fail<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">37</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8451</span><span class="token operator">==</span>    by <span class="token number">0x4F5250F</span><span class="token operator">:</span> <span class="token function">__stack_chk_fail</span> <span class="token punctuation">(</span>stack_chk_fail<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8451</span><span class="token operator">==</span>    by <span class="token number">0x40059C</span><span class="token operator">:</span> <span class="token function">main</span> <span class="token punctuation">(</span>valg<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8451</span><span class="token operator">==</span>  Address <span class="token number">0x700000007</span> is not stack<span class="token string">'d, malloc'</span>d <span class="token function">or</span> <span class="token punctuation">(</span>recently<span class="token punctuation">)</span> free'd

</code></pre></div><p>This happens when the code starts to access memory which does not belong to the program. The size of the memory accessed also gives you an indication of what variable was used.</p> <ol><li><strong>Use of Uninitialized Variables</strong></li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">==</span><span class="token number">8795</span><span class="token operator">==</span> <span class="token number">1</span> errors in context <span class="token number">5</span> of <span class="token number">8</span><span class="token operator">:</span>
<span class="token operator">==</span><span class="token number">8795</span><span class="token operator">==</span> Conditional jump or move depends on uninitialised <span class="token function">value</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8795</span><span class="token operator">==</span>    at <span class="token number">0x4E881AF</span><span class="token operator">:</span> <span class="token function">vfprintf</span> <span class="token punctuation">(</span>vfprintf<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">1631</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8795</span><span class="token operator">==</span>    by <span class="token number">0x4E8F898</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span>printf<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8795</span><span class="token operator">==</span>    by <span class="token number">0x400548</span><span class="token operator">:</span> <span class="token function">main</span> <span class="token punctuation">(</span>valg<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span>

</code></pre></div><p>According to the error, at line 7 of the <code>main</code> of <code>valg.c</code>, the call to <code>printf()</code> passed an uninitialized variable to <code>printf</code>.</p> <ol><li><strong>Illegal freeing of Memory</strong></li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">==</span><span class="token number">8954</span><span class="token operator">==</span> Invalid <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> delete <span class="token operator">/</span> delete<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token function">realloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8954</span><span class="token operator">==</span>    at <span class="token number">0x4C2EDEB</span><span class="token operator">:</span> <span class="token function">free</span> <span class="token punctuation">(</span>in <span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>valgrind<span class="token operator">/</span>vgpreload_memcheck<span class="token operator">-</span>amd64<span class="token operator">-</span>linux<span class="token punctuation">.</span>so<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8954</span><span class="token operator">==</span>    by <span class="token number">0x4005A8</span><span class="token operator">:</span> <span class="token function">main</span> <span class="token punctuation">(</span>valg<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8954</span><span class="token operator">==</span>  Address <span class="token number">0x5203040</span> is <span class="token number">0</span> bytes inside a block of size <span class="token number">240</span> free'd
<span class="token operator">==</span><span class="token number">8954</span><span class="token operator">==</span>    at <span class="token number">0x4C2EDEB</span><span class="token operator">:</span> <span class="token function">free</span> <span class="token punctuation">(</span>in <span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>valgrind<span class="token operator">/</span>vgpreload_memcheck<span class="token operator">-</span>amd64<span class="token operator">-</span>linux<span class="token punctuation">.</span>so<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8954</span><span class="token operator">==</span>    by <span class="token number">0x40059C</span><span class="token operator">:</span> <span class="token function">main</span> <span class="token punctuation">(</span>valg<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8954</span><span class="token operator">==</span>  Block was alloc'd at
<span class="token operator">==</span><span class="token number">8954</span><span class="token operator">==</span>    at <span class="token number">0x4C2DB8F</span><span class="token operator">:</span> <span class="token function">malloc</span> <span class="token punctuation">(</span>in <span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>valgrind<span class="token operator">/</span>vgpreload_memcheck<span class="token operator">-</span>amd64<span class="token operator">-</span>linux<span class="token punctuation">.</span>so<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token number">8954</span><span class="token operator">==</span>    by <span class="token number">0x40058C</span><span class="token operator">:</span> <span class="token function">main</span> <span class="token punctuation">(</span>valg<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span>

</code></pre></div><p>According to valgrind, the code freed the memory illegally (a second time) at <strong>line 10</strong> of <code>valg.c</code>, whereas it was already freed at <strong>line 9</strong>, and the block itself was allocated memory at <strong>line 7</strong>.</p> <h2 id="running-valgrind"><a href="#running-valgrind" class="header-anchor">#</a> Running Valgrind</h2> <div class="language-c extra-class"><pre class="language-c"><code>valgrind <span class="token punctuation">.</span><span class="token operator">/</span>my<span class="token operator">-</span>program arg1 arg2 <span class="token operator">&lt;</span> test<span class="token operator">-</span>input

</code></pre></div><p>This will run your program and produce a report of any allocations and de-allocations it did. It will also warn you about common errors like using uninitialized memory, dereferencing pointers to strange places, writing off the end of blocks allocated using malloc, or failing to free blocks.</p> <h2 id="adding-flags"><a href="#adding-flags" class="header-anchor">#</a> Adding flags</h2> <p>You can also turn on more tests, such as:</p> <div class="language-c extra-class"><pre class="language-c"><code>valgrind <span class="token operator">-</span>q <span class="token operator">--</span>tool<span class="token operator">=</span>memcheck <span class="token operator">--</span>leak<span class="token operator">-</span>check<span class="token operator">=</span>yes <span class="token punctuation">.</span><span class="token operator">/</span>my<span class="token operator">-</span>program arg1 arg2 <span class="token operator">&lt;</span> test<span class="token operator">-</span>input

</code></pre></div><p>See valgrind --help for more information about the (many) options, or look at the documentation at <a href="http://valgrind.org/" target="_blank" rel="noopener noreferrer">http://valgrind.org/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for detailed information about what the output means.</p> <h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li>valgrind <strong>program-name</strong> <strong>optional-arguments</strong> &lt; <strong>test input</strong></li></ul> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>Valgrind is a debugging tool that can be used to diagnose errors regarding memory management in C programs. Valgrind can be used to detect errors like invalid pointer usage, including writing or reading past the allocated space, or making an invalid call to <code>free()</code>. It can also be used for improving applications through functions that conduct memory profiling.</p> <p>For more info see <a href="http://valgrind.org" target="_blank" rel="noopener noreferrer">http://valgrind.org<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/c/valgrind.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/c/type-qualifiers.html" class="prev">
        Type Qualifiers
      </a></span> <span class="next"><a href="/c/typedef.html">
        Typedef
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/604.48209815.js" defer></script>
  </body>
</html>
