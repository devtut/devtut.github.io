<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C - Assertion</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Simple Assertion, Static Assertion, Assert Error Messages, Assertion of Unreachable Code, Precondition and Postcondition">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="C - Assertion">
    <meta property="og:description" content="Simple Assertion, Static Assertion, Assert Error Messages, Assertion of Unreachable Code, Precondition and Postcondition">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/c/assertion.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="C - Assertion">
    <meta name="twitter:description" content="Simple Assertion, Static Assertion, Assert Error Messages, Assertion of Unreachable Code, Precondition and Postcondition">
    <meta name="twitter:url" content="/c/assertion.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/547.aaeb5d9b.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>C</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/c/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/c/getting-started-with-c-language.html" class="sidebar-link">Getting started with C Language</a></li><li><a href="/c/comments.html" class="sidebar-link">Comments</a></li><li><a href="/c/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/c/operators.html" class="sidebar-link">Operators</a></li><li><a href="/c/boolean.html" class="sidebar-link">Boolean</a></li><li><a href="/c/strings.html" class="sidebar-link">Strings</a></li><li><a href="/c/literals-for-numbers-characters-and-strings.html" class="sidebar-link">Literals for numbers, characters and strings</a></li><li><a href="/c/compound-literals.html" class="sidebar-link">Compound Literals</a></li><li><a href="/c/bit-fields.html" class="sidebar-link">Bit-fields</a></li><li><a href="/c/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/c/linked-lists.html" class="sidebar-link">Linked lists</a></li><li><a href="/c/enumerations.html" class="sidebar-link">Enumerations</a></li><li><a href="/c/structs.html" class="sidebar-link">Structs</a></li><li><a href="/c/standard-math.html" class="sidebar-link">Standard Math</a></li><li><a href="/c/iteration-statements-loops-for-while-do-while.html" class="sidebar-link">Iteration Statements/Loops: for, while, do-while</a></li><li><a href="/c/selection-statements.html" class="sidebar-link">Selection Statements</a></li><li><a href="/c/initialization.html" class="sidebar-link">Initialization</a></li><li><a href="/c/declaration-vs-definition.html" class="sidebar-link">Declaration vs Definition</a></li><li><a href="/c/files-and-i-o-streams.html" class="sidebar-link">Files and I/O streams</a></li><li><a href="/c/formatted-input-output.html" class="sidebar-link">Formatted Input/Output</a></li><li><a href="/c/pointers.html" class="sidebar-link">Pointers</a></li><li><a href="/c/sequence-points.html" class="sidebar-link">Sequence points</a></li><li><a href="/c/function-pointers.html" class="sidebar-link">Function Pointers</a></li><li><a href="/c/function-parameters.html" class="sidebar-link">Function Parameters</a></li><li><a href="/c/pass-2d-arrays-to-functions.html" class="sidebar-link">Pass 2D-arrays to functions</a></li><li><a href="/c/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/c/undefined-behavior.html" class="sidebar-link">Undefined behavior</a></li><li><a href="/c/random-number-generation.html" class="sidebar-link">Random Number Generation</a></li><li><a href="/c/preprocessor-and-macros.html" class="sidebar-link">Preprocessor and Macros</a></li><li><a href="/c/signal-handling.html" class="sidebar-link">Signal handling</a></li><li><a href="/c/variable-arguments.html" class="sidebar-link">Variable arguments</a></li><li><a href="/c/assertion.html" aria-current="page" class="active sidebar-link">Assertion</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/c/assertion.html#simple-assertion" class="sidebar-link">Simple Assertion</a></li><li class="sidebar-sub-header"><a href="/c/assertion.html#static-assertion" class="sidebar-link">Static Assertion</a></li><li class="sidebar-sub-header"><a href="/c/assertion.html#assert-error-messages" class="sidebar-link">Assert Error Messages</a></li><li class="sidebar-sub-header"><a href="/c/assertion.html#assertion-of-unreachable-code" class="sidebar-link">Assertion of Unreachable Code</a></li><li class="sidebar-sub-header"><a href="/c/assertion.html#precondition-and-postcondition" class="sidebar-link">Precondition and Postcondition</a></li></ul></li><li><a href="/c/generic-selection.html" class="sidebar-link">Generic selection</a></li><li><a href="/c/x-macros.html" class="sidebar-link">X-macros</a></li><li><a href="/c/aliasing-and-effective-type.html" class="sidebar-link">Aliasing and effective type</a></li><li><a href="/c/compilation.html" class="sidebar-link">Compilation</a></li><li><a href="/c/identifier-scope.html" class="sidebar-link">Identifier Scope</a></li><li><a href="/c/common-pitfalls.html" class="sidebar-link">Common pitfalls</a></li><li><a href="/c/implicit-and-explicit-conversions.html" class="sidebar-link">Implicit and Explicit Conversions</a></li><li><a href="/c/type-qualifiers.html" class="sidebar-link">Type Qualifiers</a></li><li><a href="/c/valgrind.html" class="sidebar-link">Valgrind</a></li><li><a href="/c/typedef.html" class="sidebar-link">Typedef</a></li><li><a href="/c/storage-classes.html" class="sidebar-link">Storage Classes</a></li><li><a href="/c/declarations.html" class="sidebar-link">Declarations</a></li><li><a href="/c/inline-assembly.html" class="sidebar-link">Inline assembly</a></li><li><a href="/c/threads-native.html" class="sidebar-link">Threads (native)</a></li><li><a href="/c/structure-padding-and-packing.html" class="sidebar-link">Structure Padding and Packing</a></li><li><a href="/c/memory-management.html" class="sidebar-link">Memory management</a></li><li><a href="/c/implementation-defined-behaviour.html" class="sidebar-link">Implementation-defined behaviour</a></li><li><a href="/c/atomics.html" class="sidebar-link">Atomics</a></li><li><a href="/c/jump-statements.html" class="sidebar-link">Jump Statements</a></li><li><a href="/c/create-and-include-header-files.html" class="sidebar-link">Create and include header files</a></li><li><a href="/c/testing-frameworks.html" class="sidebar-link">Testing frameworks</a></li><li><a href="/c/ctype-h-character-classification-conversion.html" class="sidebar-link">— character classification &amp; conversion</a></li><li><a href="/c/side-effects.html" class="sidebar-link">Side Effects</a></li><li><a href="/c/multi-character-character-sequence.html" class="sidebar-link">Multi-Character Character Sequence</a></li><li><a href="/c/constraints.html" class="sidebar-link">Constraints</a></li><li><a href="/c/inlining.html" class="sidebar-link">Inlining</a></li><li><a href="/c/unions.html" class="sidebar-link">Unions</a></li><li><a href="/c/threads-native.html" class="sidebar-link">Threads (native)</a></li><li><a href="/c/multithreading.html" class="sidebar-link">Multithreading</a></li><li><a href="/c/interprocess-communication-ipc.html" class="sidebar-link">Interprocess Communication (IPC)</a></li><li><a href="/c/testing-frameworks.html" class="sidebar-link">Testing frameworks</a></li><li><a href="/c/valgrind.html" class="sidebar-link">Valgrind</a></li><li><a href="/c/common-c-programming-idioms-and-developer-practices.html" class="sidebar-link">Common C programming idioms and developer practices</a></li><li><a href="/c/common-pitfalls.html" class="sidebar-link">Common pitfalls</a></li><li><a href="/c/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="assertion"><a href="#assertion" class="header-anchor">#</a> Assertion</h1> <p>An <strong><strong>assertion</strong></strong> is a predicate that the presented condition must be true at the moment the assertion is encountered by the software. Most common are <strong><strong>simple assertions</strong></strong>, which are validated at execution time. However, <strong><strong>static assertions</strong></strong> are checked at compile time.</p> <h2 id="simple-assertion"><a href="#simple-assertion" class="header-anchor">#</a> Simple Assertion</h2> <p>An assertion is a statement used to assert that a fact must be true when that line of code is reached. Assertions are useful for ensuring that expected conditions are met.  When the condition passed to an assertion is true, there is no action.  The behavior on false conditions depends on compiler flags.  When assertions are enabled, a false input causes an immediate program halt.  When they are disabled, no action is taken.  It is common practice to enable assertions in internal and debug builds, and disable them in release builds, though assertions are often enabled in release. (Whether termination is better or worse than errors depends on the program.) Assertions should be used only to catch internal programming errors, which usually means being passed bad parameters.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token comment">/* Uncomment to disable `assert()` */</span>
<span class="token comment">/* #define NDEBUG */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;assert.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>x <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;x = %d\n&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>   
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Possible output with <code>NDEBUG</code> undefined:</p> <div class="language-c extra-class"><pre class="language-c"><code>a<span class="token punctuation">.</span>out<span class="token operator">:</span> main<span class="token punctuation">.</span>c<span class="token operator">:</span><span class="token number">9</span><span class="token operator">:</span> main<span class="token operator">:</span> Assertion `x <span class="token operator">&gt;=</span> <span class="token number">0</span>' failed<span class="token punctuation">.</span>

</code></pre></div><p>Possible output with <code>NDEBUG</code> defined:</p> <div class="language-c extra-class"><pre class="language-c"><code>x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>

</code></pre></div><p>It's good practice to define <code>NDEBUG</code> globally, so that you can easily compile your code with all assertions either on or off. An easy way to do this is define <code>NDEBUG</code> as an option to the compiler, or define it in a shared configuration header (e.g. <code>config.h</code>).</p> <h2 id="static-assertion"><a href="#static-assertion" class="header-anchor">#</a> Static Assertion</h2> <p>Static assertions are used to check if a condition is true when the code is compiled. If it isn't, the compiler is required to issue an error message and stop the compiling process.</p> <p>A static assertion is one that is checked at compile time, not run time. The condition must be a constant expression, and if false will result in a compiler error. The first argument, the condition that is checked, must be a constant expression, and the second a string literal.</p> <p>Unlike assert, <code>_Static_assert</code> is a keyword. A convenience macro <code>static_assert</code> is defined in <code>&lt;assert.h&gt;</code>.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;assert.h&gt;</span></span>

<span class="token keyword">enum</span> <span class="token punctuation">{</span>N <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">_Static_assert</span><span class="token punctuation">(</span>N <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;N does not equal 5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">static_assert</span><span class="token punctuation">(</span>N <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;N is not greater than 10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/* compiler error */</span>

</code></pre></div><p>Prior to C11, there was no direct support for static assertions. However, in C99, static assertions could be emulated with macros that would trigger a compilation failure if the compile time condition was false. Unlike <code>_Static_assert</code>, the second parameter needs to be a proper token name so that a variable name can be created with it. If the assertion fails, the variable name is seen in the compiler error, since that variable was used in a syntactically incorrect array declaration.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">STATIC_MSG</span><span class="token expression"><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> l<span class="token punctuation">)</span> <span class="token function">STATIC_MSG2</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> l<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">STATIC_MSG2</span><span class="token expression"><span class="token punctuation">(</span>msg<span class="token punctuation">,</span>l<span class="token punctuation">)</span> on_line_</span><span class="token punctuation">##</span><span class="token expression">l</span><span class="token punctuation">##</span><span class="token expression">__</span><span class="token punctuation">##</span><span class="token expression">msg</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">STATIC_ASSERT</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">,</span> msg<span class="token punctuation">)</span> <span class="token keyword">extern</span> <span class="token keyword">char</span> <span class="token function">STATIC_MSG</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token constant">__LINE__</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">?</span><span class="token number">1</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span></span>
 
<span class="token keyword">enum</span> <span class="token punctuation">{</span> N <span class="token operator">=</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">STATIC_ASSERT</span><span class="token punctuation">(</span>N <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">,</span> N_must_equal_5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">STATIC_ASSERT</span><span class="token punctuation">(</span>N <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">,</span> N_must_be_greater_than_5<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* compile error */</span>

</code></pre></div><p>Before C99, you could not declare variables at arbitrary locations in a block, so you would have to be extremely cautious about using this macro, ensuring that it only appears where a variable declaration would be valid.</p> <h2 id="assert-error-messages"><a href="#assert-error-messages" class="header-anchor">#</a> Assert Error Messages</h2> <p>A trick exists that can display an error message along with an assertion. Normally, you would write code like this</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>p<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* more code */</span>
<span class="token punctuation">}</span>

</code></pre></div><p>If the assertion failed, an error message would resemble</p> <blockquote></blockquote> <p>Assertion failed: p != NULL, file main.c, line 5</p> <p>However, you can use logical AND (<code>&amp;&amp;</code>) to give an error message as well</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>p<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;function f: p cannot be NULL&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* more code */</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Now, if the assertion fails, an error message will read something like this</p> <blockquote></blockquote> <p>Assertion failed: p != NULL &amp;&amp; &quot;function f: p cannot be NULL&quot;, file main.c, line 5</p> <p>The reason as to why this works is that a string literal always evaluates to non-zero (true). Adding <code>&amp;&amp; 1</code> to a Boolean expression has no effect. Thus, adding <code>&amp;&amp; &quot;error message&quot;</code> has no effect either, except that the compiler will display the entire expression that failed.</p> <h2 id="assertion-of-unreachable-code"><a href="#assertion-of-unreachable-code" class="header-anchor">#</a> Assertion of Unreachable Code</h2> <p>During development, when certain code paths must be prevented from the reach of control flow, you may use <code>assert(0)</code> to indicate that such a condition is erroneous:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">switch</span> <span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> COLOR_RED<span class="token operator">:</span>
    <span class="token keyword">case</span> COLOR_GREEN<span class="token operator">:</span>
    <span class="token keyword">case</span> COLOR_BLUE<span class="token operator">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>

    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token function">assert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Whenever the argument of the <code>assert()</code> macro evaluates false, the macro will write diagnostic information to the standard error stream and then abort the program.  This information includes the file and line number of the <code>assert()</code> statement and can be very helpful in debugging.  Asserts can be disabled by defining the macro <code>NDEBUG</code>.</p> <p>Another way to terminate a program when an error occurs are with the standard library functions <code>exit</code>, <code>quick_exit</code> or <code>abort</code>. <code>exit</code> and <code>quick_exit</code> take an argument that can be passed back to your environment. <code>abort()</code> (and thus <code>assert</code>) can be a really severe termination of your program, and certain cleanups that would otherwise be performed at the end of the execution, may not be performed.</p> <p>The primary advantage of <code>assert()</code> is that it automatically prints debugging information.  Calling <code>abort()</code> has the advantage that it cannot be disabled like an assert, but it may not cause any debugging information to be displayed.  In some situations, using both constructs together may be beneficial:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>color <span class="token operator">==</span> COLOR_RED <span class="token operator">||</span> color <span class="token operator">==</span> COLOR_GREEN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>color <span class="token operator">==</span> COLOR_BLUE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
   <span class="token function">assert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>When asserts are <strong>enabled</strong>, the <code>assert()</code> call will print debug information and terminate the program.  Execution never reaches the <code>abort()</code> call.  When asserts are <strong>disabled</strong>, the <code>assert()</code> call does nothing and <code>abort()</code> is called.  This ensures that the program <strong>always</strong> terminates for this error condition; enabling and disabling asserts only effects whether or not debug output is printed.</p> <p>You should never leave such an <code>assert</code> in production code, because the debug information is not helpful for end users and because <code>abort</code> is generally a much too severe termination that inhibit cleanup handlers that are installed for <code>exit</code> or <code>quick_exit</code> to run.</p> <h2 id="precondition-and-postcondition"><a href="#precondition-and-postcondition" class="header-anchor">#</a> Precondition and Postcondition</h2> <p>One use case for assertion is precondition and postcondition.
This can be very useful to maintain <a href="https://en.wikipedia.org/wiki/Invariant_(computer_science)" target="_blank" rel="noopener noreferrer">invariant<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://en.wikipedia.org/wiki/Design_by_contract" target="_blank" rel="noopener noreferrer">design by contract<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
For a example a length is always zero or positive so this function must return a zero or positive value.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token comment">/* Uncomment to disable `assert()` */</span>
<span class="token comment">/* #define NDEBUG */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;assert.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">length2</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">/* Precondition: */</span>
    <span class="token comment">/* NULL is an invalid vector */</span>
    <span class="token function">assert</span> <span class="token punctuation">(</span>a <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* Number of dimensions can not be negative.*/</span> 
    <span class="token function">assert</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/* Calculation */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        result <span class="token operator">=</span> result <span class="token operator">+</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* Postcondition: */</span>
    <span class="token comment">/* Resulting length can not be negative. */</span>
    <span class="token function">assert</span> <span class="token punctuation">(</span>result <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">COUNT</span> <span class="token expression"><span class="token number">3</span></span></span>

<span class="token keyword">int</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> a<span class="token punctuation">[</span>COUNT<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>b <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> r<span class="token punctuation">;</span>
    r <span class="token operator">=</span> <span class="token function">length2</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> COUNT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">&quot;r = %i\n&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
    r <span class="token operator">=</span> <span class="token function">length2</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> COUNT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">&quot;r = %i\n&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li>assert(expression)</li> <li>static_assert(expression, message)</li> <li>_Static_assert(expression, message)</li></ul> <h4 id="parameters"><a href="#parameters" class="header-anchor">#</a> Parameters</h4> <table><thead><tr><th>Parameter</th> <th>Details</th></tr></thead> <tbody><tr><td>expression</td> <td>expression of scalar type.</td></tr> <tr><td>message</td> <td>string literal to be included in the diagnostic message.</td></tr></tbody></table> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>Both <code>assert</code> and <code>static_assert</code> are macros defined in <code>assert.h</code>.</p> <p>The definition of <code>assert</code> depends on the macro <code>NDEBUG</code> which is not defined by the standard library. If <code>NDEBUG</code> is defined, <code>assert</code> is a no-op:</p> <p>Opinion varies about whether <code>NDEBUG</code> should always be used for production compilations.</p> <ul><li>The pro-camp argues that <code>assert</code> calls <code>abort</code> and assertion messages are not helpful for end users, so the result is not helpful to user. If you have fatal conditions to check in production code you should use ordinary <code>if/else</code> conditions and <code>exit</code> or <code>quick_exit</code> to end the program. In contrast to <code>abort</code>, these allow the program to do some cleanup (via functions registered with <code>atexit</code> or <code>at_quick_exit</code>).</li> <li>The con-camp argues that <code>assert</code> calls should never fire in production code, but if they do, the condition that is checked means there is something dramatically wrong and the program will misbehave worse if execution continues.  Therefore, it is better to have the assertions active in production code because if they fire, hell has already broken loose.</li> <li>Another option is to use a home-brew system of assertions which always perform the check but handle errors differently between development (where <code>abort</code> is appropriate) and production (where an 'unexpected internal error - please contact Technical Support' may be more appropriate).</li></ul> <p><code>static_assert</code> expands to <code>_Static_assert</code> which is a keyword. The condition is checked at compile time, thus <code>condition</code> must be a constant expression.  There is no need for this to be handled differently between development and production.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/c/assertion.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/c/variable-arguments.html" class="prev">
        Variable arguments
      </a></span> <span class="next"><a href="/c/generic-selection.html">
        Generic selection
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/547.aaeb5d9b.js" defer></script>
  </body>
</html>
