<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C - Compilation</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="File Types, The Linker, The Compiler, The Preprocessor, The Translation Phases">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="C - Compilation">
    <meta property="og:description" content="File Types, The Linker, The Compiler, The Preprocessor, The Translation Phases">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/c/compilation.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="C - Compilation">
    <meta name="twitter:description" content="File Types, The Linker, The Compiler, The Preprocessor, The Translation Phases">
    <meta name="twitter:url" content="/c/compilation.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/553.74057b71.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>C</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/c/" class="sidebar-link">Disclaimer</a></li><li><a href="/c/getting-started-with-c-language.html" class="sidebar-link">Getting started with C Language</a></li><li><a href="/c/comments.html" class="sidebar-link">Comments</a></li><li><a href="/c/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/c/operators.html" class="sidebar-link">Operators</a></li><li><a href="/c/boolean.html" class="sidebar-link">Boolean</a></li><li><a href="/c/strings.html" class="sidebar-link">Strings</a></li><li><a href="/c/literals-for-numbers-characters-and-strings.html" class="sidebar-link">Literals for numbers, characters and strings</a></li><li><a href="/c/compound-literals.html" class="sidebar-link">Compound Literals</a></li><li><a href="/c/bit-fields.html" class="sidebar-link">Bit-fields</a></li><li><a href="/c/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/c/linked-lists.html" class="sidebar-link">Linked lists</a></li><li><a href="/c/enumerations.html" class="sidebar-link">Enumerations</a></li><li><a href="/c/structs.html" class="sidebar-link">Structs</a></li><li><a href="/c/standard-math.html" class="sidebar-link">Standard Math</a></li><li><a href="/c/iteration-statements-loops-for-while-do-while.html" class="sidebar-link">Iteration Statements/Loops: for, while, do-while</a></li><li><a href="/c/selection-statements.html" class="sidebar-link">Selection Statements</a></li><li><a href="/c/initialization.html" class="sidebar-link">Initialization</a></li><li><a href="/c/declaration-vs-definition.html" class="sidebar-link">Declaration vs Definition</a></li><li><a href="/c/files-and-i-o-streams.html" class="sidebar-link">Files and I/O streams</a></li><li><a href="/c/formatted-input-output.html" class="sidebar-link">Formatted Input/Output</a></li><li><a href="/c/pointers.html" class="sidebar-link">Pointers</a></li><li><a href="/c/sequence-points.html" class="sidebar-link">Sequence points</a></li><li><a href="/c/function-pointers.html" class="sidebar-link">Function Pointers</a></li><li><a href="/c/function-parameters.html" class="sidebar-link">Function Parameters</a></li><li><a href="/c/pass-2d-arrays-to-functions.html" class="sidebar-link">Pass 2D-arrays to functions</a></li><li><a href="/c/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/c/undefined-behavior.html" class="sidebar-link">Undefined behavior</a></li><li><a href="/c/random-number-generation.html" class="sidebar-link">Random Number Generation</a></li><li><a href="/c/preprocessor-and-macros.html" class="sidebar-link">Preprocessor and Macros</a></li><li><a href="/c/signal-handling.html" class="sidebar-link">Signal handling</a></li><li><a href="/c/variable-arguments.html" class="sidebar-link">Variable arguments</a></li><li><a href="/c/assertion.html" class="sidebar-link">Assertion</a></li><li><a href="/c/generic-selection.html" class="sidebar-link">Generic selection</a></li><li><a href="/c/x-macros.html" class="sidebar-link">X-macros</a></li><li><a href="/c/aliasing-and-effective-type.html" class="sidebar-link">Aliasing and effective type</a></li><li><a href="/c/compilation.html" class="active sidebar-link">Compilation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/c/compilation.html#file-types" class="sidebar-link">File Types</a></li><li class="sidebar-sub-header"><a href="/c/compilation.html#the-linker" class="sidebar-link">The Linker</a></li><li class="sidebar-sub-header"><a href="/c/compilation.html#the-compiler" class="sidebar-link">The Compiler</a></li><li class="sidebar-sub-header"><a href="/c/compilation.html#the-preprocessor" class="sidebar-link">The Preprocessor</a></li><li class="sidebar-sub-header"><a href="/c/compilation.html#the-translation-phases" class="sidebar-link">The Translation Phases</a></li></ul></li><li><a href="/c/identifier-scope.html" class="sidebar-link">Identifier Scope</a></li><li><a href="/c/common-pitfalls.html" class="sidebar-link">Common pitfalls</a></li><li><a href="/c/implicit-and-explicit-conversions.html" class="sidebar-link">Implicit and Explicit Conversions</a></li><li><a href="/c/type-qualifiers.html" class="sidebar-link">Type Qualifiers</a></li><li><a href="/c/valgrind.html" class="sidebar-link">Valgrind</a></li><li><a href="/c/typedef.html" class="sidebar-link">Typedef</a></li><li><a href="/c/storage-classes.html" class="sidebar-link">Storage Classes</a></li><li><a href="/c/declarations.html" class="sidebar-link">Declarations</a></li><li><a href="/c/inline-assembly.html" class="sidebar-link">Inline assembly</a></li><li><a href="/c/threads-native.html" class="sidebar-link">Threads (native)</a></li><li><a href="/c/structure-padding-and-packing.html" class="sidebar-link">Structure Padding and Packing</a></li><li><a href="/c/memory-management.html" class="sidebar-link">Memory management</a></li><li><a href="/c/implementation-defined-behaviour.html" class="sidebar-link">Implementation-defined behaviour</a></li><li><a href="/c/atomics.html" class="sidebar-link">Atomics</a></li><li><a href="/c/jump-statements.html" class="sidebar-link">Jump Statements</a></li><li><a href="/c/create-and-include-header-files.html" class="sidebar-link">Create and include header files</a></li><li><a href="/c/testing-frameworks.html" class="sidebar-link">Testing frameworks</a></li><li><a href="/c/ctype-h-character-classification-conversion.html" class="sidebar-link">— character classification &amp; conversion</a></li><li><a href="/c/side-effects.html" class="sidebar-link">Side Effects</a></li><li><a href="/c/multi-character-character-sequence.html" class="sidebar-link">Multi-Character Character Sequence</a></li><li><a href="/c/constraints.html" class="sidebar-link">Constraints</a></li><li><a href="/c/inlining.html" class="sidebar-link">Inlining</a></li><li><a href="/c/unions.html" class="sidebar-link">Unions</a></li><li><a href="/c/threads-native.html" class="sidebar-link">Threads (native)</a></li><li><a href="/c/multithreading.html" class="sidebar-link">Multithreading</a></li><li><a href="/c/interprocess-communication-ipc.html" class="sidebar-link">Interprocess Communication (IPC)</a></li><li><a href="/c/testing-frameworks.html" class="sidebar-link">Testing frameworks</a></li><li><a href="/c/valgrind.html" class="sidebar-link">Valgrind</a></li><li><a href="/c/common-c-programming-idioms-and-developer-practices.html" class="sidebar-link">Common C programming idioms and developer practices</a></li><li><a href="/c/common-pitfalls.html" class="sidebar-link">Common pitfalls</a></li><li><a href="/c/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="compilation"><a href="#compilation" class="header-anchor">#</a> Compilation</h1> <p>The C language is traditionally a compiled language (as opposed to interpreted). The C Standard defines <strong><strong>translation phases</strong></strong>, and the product of applying them is a program image (or compiled program). In <a href="/questions/tagged/c11">c11</a>, the phases are listed in §5.1.1.2.</p> <h2 id="file-types"><a href="#file-types" class="header-anchor">#</a> File Types</h2> <p>Compiling C programs requires you to work with five kinds of files:</p> <li><p>**Source files**: These files contain function definitions, and have names which end in `.c` by convention. Note: `.cc` and `.cpp` are C++ files; **not** C files.<br>
e.g., `foo.c`</p></li> <li><p>**Header files**: These files contain function prototypes and various pre-processor statements (see below). They are used to allow source code files to access externally-defined functions. Header files end in `.h` by convention.<br>
e.g., `foo.h`</p></li> <li><p>**Object files**: These files are produced as the output of the compiler. They consist of function definitions in binary form, but they are not executable by themselves. Object files end in `.o` by convention, although on some operating systems (e.g. Windows, MS-DOS), they often end in `.obj`.<br>
e.g., `foo.o` `foo.obj`</p></li> <li><p>**Binary executables**: These are produced as the output of a program called a &quot;linker&quot;. The linker links together a number of object files to produce a binary file which can be directly executed. Binary executables have no special suffix on Unix operating systems, although they generally end in `.exe` on Windows.<br>
e.g., `foo` `foo.exe`</p></li> <li>
**Libraries**: A library is a compiled binary but is not in itself an an executable (i.e., there is no `main()` function in a library).  A library contains functions that may be used by more than one program.   A library should ship with header files which contain prototypes for all functions in the library; these header files should be referenced (e.g; `#include <library.h>`) in any source file that uses the library.  The linker then needs to be referred to the library so the program can successfully compiled.  There are two types of libraries: static and dynamic.
<ul><li>**Static library**: A static library (`.a` files for POSIX systems and `.lib` files for Windows — not to be confused with [DLL import library files](https://msdn.microsoft.com/en-us/library/windows/desktop/ms682592(v=vs.85).aspx), which also use the `.lib` extension) is statically built into the program .   Static libraries have the advantage that the program knows exactly which version of a library is used. On the other hand, the sizes of executables are bigger as all used library functions are included.<br>
e.g., `libfoo.a` `foo.lib`</li> <li>**Dynamic library**: A dynamic library (`.so` files for most POSIX systems, `.dylib` for OSX and `.dll` files for Windows) is dynamically linked at runtime by the program.  These are also sometimes referred to as shared libraries because one library image can be shared by many programs. Dynamic libraries have the advantage of taking up less disk space if more than one application is using the library. Also, they allow library updates (bug fixes) without having to rebuild executables.<br>
e.g., `foo.so` `foo.dylib` `foo.dll`</li></ul></library.h></li> <h2 id="the-linker"><a href="#the-linker" class="header-anchor">#</a> The Linker</h2> <p>The job of the linker is to link together a bunch of object files (<code>.o</code> files) into a binary executable. The process of <strong>linking</strong> mainly involves <strong>resolving symbolic addresses to numerical addresses</strong>. The result of the link process is normally an executable program.</p> <p>During the link process, the linker will pick up all the object modules specified on the command line, add some system-specific <strong>startup code</strong> in front and try to resolve all <strong>external</strong> references in the object module with <strong>external definitions</strong> in other object files (object files can be specified directly on the command line or may implicitly be added through libraries). It will then assign <strong>load addresses</strong> for the object files, that is, it specifies where the code and data will end up in the address space of the finished program. Once it's got the load addresses, it can replace all the symbolic addresses in the object code with &quot;real&quot;, numerical addresses in the target's address space. The program is ready to be executed now.</p> <p>This includes both the object files that the compiler created from your source code files as well as object files that have been pre-compiled for you and collected into library files. These files have names which end in <code>.a</code> or <code>.so</code>, and you normally don't need to know about them, as the linker knows where most of them are located and will link them in automatically as needed.</p> <h3 id="implicit-invocation-of-the-linker"><a href="#implicit-invocation-of-the-linker" class="header-anchor">#</a> Implicit invocation of the linker</h3> <p>Like the pre-processor, the linker is a separate program, often called <code>ld</code> (but Linux uses <code>collect2</code>, for example). Also like the pre-processor, the linker is invoked automatically for you when you use the compiler. Thus, the normal way of using the linker is as follows:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">%</span> gcc foo<span class="token punctuation">.</span>o bar<span class="token punctuation">.</span>o baz<span class="token punctuation">.</span>o <span class="token operator">-</span>o myprog

</code></pre></div><p>This line tells the compiler to link together three object files (<code>foo.o</code>, <code>bar.o</code>, and <code>baz.o</code>) into a binary executable file named <code>myprog</code>. Now you have a file called <code>myprog</code> that you can run and which will hopefully do something cool and/or useful.</p> <h3 id="explicit-invocation-of-the-linker"><a href="#explicit-invocation-of-the-linker" class="header-anchor">#</a> Explicit invocation of the linker</h3> <p>It is possible to invoke the linker directly, but this is seldom advisable, and is typically very platform-specific.  That is, options that work on Linux won't necessarily work on Solaris, AIX, macOS, Windows, and similarly for any other platform.  If you work with GCC, you can use <code>gcc -v</code> to see what is executed on your behalf.</p> <h3 id="options-for-the-linker"><a href="#options-for-the-linker" class="header-anchor">#</a> Options for the linker</h3> <p>The linker also takes some arguments to modify it's behavior. The following command would tell gcc to link <code>foo.o</code> and <code>bar.o</code>, but also include the <code>ncurses</code> library.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">%</span> gcc foo<span class="token punctuation">.</span>o bar<span class="token punctuation">.</span>o <span class="token operator">-</span>o foo <span class="token operator">-</span>lncurses

</code></pre></div><p>This is actually (more or less) equivalent to</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">%</span> gcc foo<span class="token punctuation">.</span>o bar<span class="token punctuation">.</span>o <span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>libncurses<span class="token punctuation">.</span>so <span class="token operator">-</span>o foo

</code></pre></div><p>(although <code>libncurses.so</code> could be <code>libncurses.a</code>, which is just an archive created with <code>ar</code>).  Note that you should list the libraries (either by pathname or via <code>-lname</code> options) after the object files.  With static libraries, the order that they are specified matters; often, with shared libraries, the order doesn't matter.</p> <p>Note that on many systems, if you are using mathematical functions (from <code>&lt;math.h&gt;</code>), you need to specify <code>-lm</code> to load the mathematics library — but Mac OS X and macOS Sierra do not require this.  There are other libraries that are separate libraries on Linux and other Unix systems, but not on macOS — POSIX threads, and POSIX realtime, and networking libraries are examples.  Consequently, the linking process varies between platforms.</p> <h3 id="other-compilation-options"><a href="#other-compilation-options" class="header-anchor">#</a> Other compilation options</h3> <p>This is all you need to know to begin compiling your own C programs. Generally, we also recommend that you use the <code>-Wall</code> command-line option:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">%</span> gcc <span class="token operator">-</span>Wall <span class="token operator">-</span>c foo<span class="token punctuation">.</span>cc

</code></pre></div><p>The <code>-Wall</code> option causes the compiler to warn you about legal but dubious code constructs, and will help you catch a lot of bugs very early.</p> <p>If you want the compiler to throw more warnings at you (including variables that are declared but not used, forgetting to return a value etc.), you can use this set of options, as <code>-Wall</code>, despite the name, doesn't turn <strong>all of the possible warnings</strong> on:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">%</span> gcc <span class="token operator">-</span>Wall <span class="token operator">-</span>Wextra <span class="token operator">-</span>Wfloat<span class="token operator">-</span>equal <span class="token operator">-</span>Wundef <span class="token operator">-</span>Wcast<span class="token operator">-</span>align <span class="token operator">-</span>Wwrite<span class="token operator">-</span>strings <span class="token operator">-</span>Wlogical<span class="token operator">-</span>op \
<span class="token operator">&gt;</span>     <span class="token operator">-</span>Wmissing<span class="token operator">-</span>declarations <span class="token operator">-</span>Wredundant<span class="token operator">-</span>decls <span class="token operator">-</span>Wshadow …

</code></pre></div><p>Note that <code>clang</code> has an option <a href="http://clang.llvm.org/docs/UsersManual.html#enabling-all-diagnostics" target="_blank" rel="noopener noreferrer"><code>-Weverything</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which really does turn on all warnings in <code>clang</code>.</p> <h2 id="the-compiler"><a href="#the-compiler" class="header-anchor">#</a> The Compiler</h2> <p>After the C pre-processor has included all the header files and expanded all macros, the compiler can compile the program. It does this by turning the C source code into an object code file, which is a file ending in <code>.o</code> which contains the binary version of the source code. Object code is not directly executable, though. In order to make an executable, you also have to add code for all of the library functions that were <code>#include</code>d into the file (this is not the same as including the declarations, which is what <code>#include</code> does). This is the job of <a href="http://stackoverflow.com/documentation/c/1337/compilation/4360/the-linker#t=201609061240486686348" target="_blank" rel="noopener noreferrer">the linker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>In general, the exact sequence how to invoke a C compiler depends much on the system that you are using. Here we are using the GCC compiler, though it should be noted that many more compilers exist:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">%</span> gcc <span class="token operator">-</span>Wall <span class="token operator">-</span>c foo<span class="token punctuation">.</span>c

</code></pre></div><p><code>%</code> is the OS' command prompt. This tells the compiler to run the pre-processor on the file <code>foo.c</code> and then compile it into the object code file <code>foo.o</code>. The <code>-c</code> option means to compile the source code file into an object file but not to invoke the linker. This option <code>-c</code> is available on POSIX systems, such as Linux or macOS; other systems may use different syntax.</p> <p>If your entire program is in one source code file, you can instead do this:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">%</span> gcc <span class="token operator">-</span>Wall foo<span class="token punctuation">.</span>c <span class="token operator">-</span>o foo

</code></pre></div><p>This tells the compiler to run the pre-processor on <code>foo.c</code>, compile it and then link it to create an executable called <code>foo</code>. The <code>-o</code> option states that the next word on the line is the name of the binary executable file (program). If you don't specify the <code>-o</code>, (if you just type <code>gcc foo.c</code>), the executable will be named <code>a.out</code> for historical reasons.</p> <p>In general the compiler takes four steps when converting a <code>.c</code> file into an executable:</p> <ol><li><strong>pre-processing</strong> - textually expands <code>#include</code> directives and <code>#define</code> macros in your <code>.c</code> file</li> <li><strong>compilation</strong> - converts the program into assembly (you can stop the compiler at this step by adding the <code>-S</code> option)</li> <li><strong>assembly</strong> - converts the assembly into machine code</li> <li><strong>linkage</strong> - links the object code to external libraries to create an executable</li></ol> <p>Note also that the name of the compiler we are using is GCC, which stands for both &quot;GNU C compiler&quot; and &quot;GNU compiler collection&quot;, depending on context. Other C compilers exist. For Unix-like operating systems, many of them have the name <code>cc</code>, for &quot;C compiler&quot;, which is often a symbolic link to some other compiler. On Linux systems, <code>cc</code> is often an alias for GCC. On macOS or OS-X, it points to clang.</p> <p>The POSIX standards currently mandates <a href="http://pubs.opengroup.org/onlinepubs/9699919799/utilities/c99.html" target="_blank" rel="noopener noreferrer"><code>c99</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as the name of a C compiler — it supports the C99 standard by default. Earlier versions of POSIX mandated <a href="http://pubs.opengroup.org/onlinepubs/7990989775/xcu/c89.html" target="_blank" rel="noopener noreferrer"><code>c89</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as the compiler. POSIX also mandates that this compiler understands the options <code>-c</code> and <code>-o</code> that we used above.</p> <p><strong>Note:</strong> The <code>-Wall</code> option present in both <code>gcc</code> examples tells the compiler to print warnings about questionable constructions, which is strongly recommended. It is a also good idea to add other <a href="https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html" target="_blank" rel="noopener noreferrer">warning options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, e.g. <code>-Wextra</code>.</p> <h2 id="the-preprocessor"><a href="#the-preprocessor" class="header-anchor">#</a> The Preprocessor</h2> <p>Before the C compiler starts compiling a source code file, the file is processed in a preprocessing phase. This phase can be done by a separate program or be completely integrated in one executable. In any case, it is invoked automatically by the compiler before compilation proper begins. The preprocessing phase converts your source code into another source code or translation unit by applying textual replacements. You can think of it as a &quot;modified&quot; or &quot;expanded&quot; source code. That expanded source may exist as a real file in the file system, or it may only be stored in memory for a short time before being processed further.</p> <p>Preprocessor commands start with the pound sign (&quot;#&quot;). There are several preprocessor commands; two of the most important are:</p> <li>
**Defines**:
`#define` is mainly used to define constants. For instance,
<div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">define</span> BIGNUM 1000000</span>
<span class="token keyword">int</span> a <span class="token operator">=</span> BIGNUM<span class="token punctuation">;</span> 

</code></pre></div><p>becomes</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1000000</span><span class="token punctuation">;</span>

</code></pre></div><p><code>#define</code> is used in this way so as to avoid having to explicitly write out some constant value in many different places in a source code file. This is important in case you need to change the constant value later on; it's much less bug-prone to change it once, in the <code>#define</code>, than to have to change it in multiple places scattered all over the code.
Because <code>#define</code> just does advanced search and replace, you can also declare macros. For instance:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">define</span> ISTRUE(stm) do{stm = stm ? 1 : 0;}while(0)</span>
<span class="token comment">// in the function:</span>
a <span class="token operator">=</span> x<span class="token punctuation">;</span>
<span class="token function">ISTRUE</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>becomes:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">// in the function:</span>
a <span class="token operator">=</span> x<span class="token punctuation">;</span>
<span class="token keyword">do</span> <span class="token punctuation">{</span>
    a <span class="token operator">=</span> a <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>At first approximation, this effect is roughly the same as with inline functions, but the preprocessor doesn't provide type checking for <code>#define</code> macros. This is well known to be error-prone and their use necessitates great caution.
Also note here, that the preprocessor would also replace comments with a blanks as explained below.
</p></li> <li><strong>Includes</strong>:
<code>#include</code> is used to access function definitions defined outside of a source code file. For instance:<p></p> <div class="language-c extra-class"><pre class="language-c"><code> <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span> </span>

</code></pre></div><p>causes the preprocessor to paste the contents of <code>&lt;stdio.h&gt;</code> into the source code file at the location of the <code>#include</code> statement before it gets compiled. <code>#include</code> is almost always used to include header files, which are files which mainly contain function declarations and <code>#define</code> statements. In this case, we use <code>#include</code> in order to be able to use functions such as <code>printf</code> and <code>scanf</code>, whose declarations are located in the file <code>stdio.h</code>. C compilers do not allow you to use a function unless it has previously been declared or defined in that file; <code>#include</code> statements are thus the way to re-use previously-written code in your C programs.
</p></li> <li><strong>Logic operations</strong>:<p></p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">if</span> defined A || defined B</span>
variable <span class="token operator">=</span> another_variable <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
variable <span class="token operator">=</span> another_variable <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

</code></pre></div><p>will be changed to:</p> <div class="language-c extra-class"><pre class="language-c"><code>variable <span class="token operator">=</span> another_variable <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

</code></pre></div><p>if A or B were defined somewhere in the project before. If this is not the case, of course the preprocessor will do this:</p> <div class="language-c extra-class"><pre class="language-c"><code>variable <span class="token operator">=</span> another_variable <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>

</code></pre></div><p>This is often used for code, that runs on different systems or compiles on different compilers. Since there are global defines, that are compiler/system specific you can test on those defines and always let the compiler just use the code he will compile for sure.
</p></li> <li><strong>Comments</strong>
The Preprocessor replaces all comments in the source file by single spaces. Comments are indicated by <code>//</code> up to the end of the line, or a combination of opening <code>/*</code> and closing <code>*/</code> comment brackets.
</li><p></p> <h2 id="the-translation-phases"><a href="#the-translation-phases" class="header-anchor">#</a> The Translation Phases</h2> <p>As of the C 2011 Standard, listed in <strong>§5.1.1.2 Translation Phases</strong>, the translation of source code to program image (e.g., the executable) are listed to occur in 8 ordered steps.</p> <ol><li>The source file input is mapped to the source character set (if necessary). Trigraphs are replaced in this step.</li> <li>Continuation lines (lines that end with <code>\</code>) are spliced with the next line.</li> <li>The source code is parsed into whitespace and preprocessing tokens.</li> <li>The preprocessor is applied, which executes directives, expands macros, and applies pragmas. Each source file pulled in by <code>#include</code> undergoes translation phases 1 through 4 (recursively if necessary). All preprocessor related directives are then deleted.</li> <li>Source character set values in character constants and string literals are mapped to the execution character set.</li> <li>String literals adjacent to each other are concatenated.</li> <li>The source code is parsed into tokens, which comprise the translation unit.</li> <li>External references are resolved, and the program image is formed.</li></ol> <p>An implementation of a C compiler may combine several steps together, but the resulting image must still behave as if the above steps had occurred separately in the order listed above.</p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <table><thead><tr><th>Filename extension</th> <th>Description</th></tr></thead> <tbody><tr><td><code>.c</code></td> <td>Source file. Usually contains definitions and code.</td></tr> <tr><td><code>.h</code></td> <td>Header file. Usually contains declarations.</td></tr> <tr><td><code>.o</code></td> <td>Object file. Compiled code in machine language.</td></tr> <tr><td><code>.obj</code></td> <td>Alternative extension for object files.</td></tr> <tr><td><code>.a</code></td> <td>Library file. Package of object files.</td></tr> <tr><td><code>.dll</code></td> <td>Dynamic-Link Library on Windows.</td></tr> <tr><td><code>.so</code></td> <td>Shared object (library) on many Unix-like systems.</td></tr> <tr><td><code>.dylib</code></td> <td>Dynamic-Link Library on OSX (Unix variant).</td></tr> <tr><td><code>.exe</code>, <code>.com</code></td> <td>Windows executable file. Formed by linking object files and library files. In Unix-like systems, there is no special file name extension for executable file.</td></tr></tbody></table> <table><thead><tr><th>POSIX c99 compiler flags</th> <th>Description</th></tr></thead> <tbody><tr><td><code>-o filename</code></td> <td>Output file name eg. (<code>bin/program.exe</code>, <code>program</code>)</td></tr> <tr><td><code>-I directory</code></td> <td>search for headers in <code>direrctory</code>.</td></tr> <tr><td><code>-D name</code></td> <td>define macro <code>name</code></td></tr> <tr><td><code>-L directory</code></td> <td>search for libraries in <code>directory</code>.</td></tr> <tr><td><code>-l name</code></td> <td>link library <code>libname</code>.</td></tr></tbody></table> <p>Compilers on POSIX platforms (Linux, mainframes, Mac) usually accept these options, even if they are not called <code>c99</code>.</p> <ul><li>See also <a href="http://pubs.opengroup.org/onlinepubs/9699919799/utilities/c99.html" target="_blank" rel="noopener noreferrer">c99 - compile standard C programs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <table><thead><tr><th>GCC (GNU Compiler Collection) Flags</th> <th>Description</th></tr></thead> <tbody><tr><td><code>-Wall</code></td> <td>Enables all warning messages that are commonly accepted to be useful.</td></tr> <tr><td><code>-Wextra</code></td> <td>Enables more warning messages, can be too noisy.</td></tr> <tr><td><code>-pedantic</code></td> <td>Force warnings where code violates the chosen standard.</td></tr> <tr><td><code>-Wconversion</code></td> <td>Enable warnings on implicit conversion, use with care.</td></tr> <tr><td><code>-c</code></td> <td>Compiles source files without linking.</td></tr> <tr><td><code>-v</code></td> <td>Prints compilation info.</td></tr></tbody></table> <ul><li><code>gcc</code> accepts the POSIX flags plus a lot of others.</li> <li>Many other compilers on POSIX platforms (<code>clang</code>, vendor specific compilers) also use the flags that are listed above.</li> <li>See also <a href="https://gcc.gnu.org/onlinedocs/gcc/index.html#toc_Invoking-GCC" target="_blank" rel="noopener noreferrer">Invoking GCC<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for many more options.</li></ul> <table><thead><tr><th>TCC (Tiny C Compiler) Flags</th> <th>Description</th></tr></thead> <tbody><tr><td><code>-Wimplicit-function-declaration</code></td> <td>Warn about implicit function declaration.</td></tr> <tr><td><code>-Wunsupported</code></td> <td>Warn about unsupported GCC features that are ignored by TCC.</td></tr> <tr><td><code>-Wwrite-strings</code></td> <td>Make string constants be of type const char * instead of char *.</td></tr> <tr><td><code>-Werror</code></td> <td>Abort compilation if warnings are issued.</td></tr> <tr><td><code>-Wall</code></td> <td>Activate all warnings, except <code>-Werror</code>, <code>-Wunusupported</code> and <code>-Wwrite strings</code>.</td></tr></tbody></table></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/c/compilation.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/c/aliasing-and-effective-type.html" class="prev">
        Aliasing and effective type
      </a></span> <span class="next"><a href="/c/identifier-scope.html">
        Identifier Scope
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/553.74057b71.js" defer></script>
  </body>
</html>
