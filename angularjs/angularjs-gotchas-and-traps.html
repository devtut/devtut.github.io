<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>AngularJS - AngularJS gotchas and traps</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Things to do when using html5Mode, Two-way data binding stops working, 7 Deadly Sins of AngularJS">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="AngularJS - AngularJS gotchas and traps">
    <meta property="og:description" content="Things to do when using html5Mode, Two-way data binding stops working, 7 Deadly Sins of AngularJS">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/angularjs/angularjs-gotchas-and-traps.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="AngularJS - AngularJS gotchas and traps">
    <meta name="twitter:description" content="Things to do when using html5Mode, Two-way data binding stops working, 7 Deadly Sins of AngularJS">
    <meta name="twitter:url" content="/angularjs/angularjs-gotchas-and-traps.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/423.46aa3728.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>AngularJS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/angularjs/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/angularjs/getting-started-with-angularjs.html" class="sidebar-link">Getting started with AngularJS</a></li><li><a href="/angularjs/modules.html" class="sidebar-link">Modules</a></li><li><a href="/angularjs/components.html" class="sidebar-link">Components</a></li><li><a href="/angularjs/built-in-directives.html" class="sidebar-link">Built-in directives</a></li><li><a href="/angularjs/use-of-in-built-directives.html" class="sidebar-link">Use of in-built directives</a></li><li><a href="/angularjs/custom-directives.html" class="sidebar-link">Custom Directives</a></li><li><a href="/angularjs/how-data-binding-works.html" class="sidebar-link">How data binding works</a></li><li><a href="/angularjs/angular-project-directory-structure.html" class="sidebar-link">Angular Project - Directory Structure</a></li><li><a href="/angularjs/filters.html" class="sidebar-link">Filters</a></li><li><a href="/angularjs/custom-filters.html" class="sidebar-link">Custom filters</a></li><li><a href="/angularjs/constants.html" class="sidebar-link">Constants</a></li><li><a href="/angularjs/custom-filters-with-es6.html" class="sidebar-link">Custom filters with ES6</a></li><li><a href="/angularjs/directives-using-ngmodelcontroller.html" class="sidebar-link">Directives using ngModelController</a></li><li><a href="/angularjs/controllers.html" class="sidebar-link">Controllers</a></li><li><a href="/angularjs/controllers-with-es6.html" class="sidebar-link">Controllers with ES6</a></li><li><a href="/angularjs/the-self-or-this-variable-in-a-controller.html" class="sidebar-link">The Self Or This Variable In A Controller</a></li><li><a href="/angularjs/services.html" class="sidebar-link">Services</a></li><li><a href="/angularjs/distinguishing-service-vs-factory.html" class="sidebar-link">Distinguishing Service vs Factory</a></li><li><a href="/angularjs/angular-promises-with-q-service.html" class="sidebar-link">Angular promises with $q service</a></li><li><a href="/angularjs/dependency-injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/angularjs/events.html" class="sidebar-link">Events</a></li><li><a href="/angularjs/sharing-data.html" class="sidebar-link">Sharing Data</a></li><li><a href="/angularjs/form-validation.html" class="sidebar-link">Form Validation</a></li><li><a href="/angularjs/routing-using-ngroute.html" class="sidebar-link">Routing using ngRoute</a></li><li><a href="/angularjs/ng-class-directive.html" class="sidebar-link">ng-class directive</a></li><li><a href="/angularjs/ng-repeat.html" class="sidebar-link">ng-repeat</a></li><li><a href="/angularjs/ng-style.html" class="sidebar-link">ng-style</a></li><li><a href="/angularjs/ng-view.html" class="sidebar-link">ng-view</a></li><li><a href="/angularjs/angularjs-bindings-options-etc.html" class="sidebar-link">AngularJS bindings options (=, @, &amp; etc.)</a></li><li><a href="/angularjs/providers.html" class="sidebar-link">Providers</a></li><li><a href="/angularjs/decorators.html" class="sidebar-link">Decorators</a></li><li><a href="/angularjs/print.html" class="sidebar-link">Print</a></li><li><a href="/angularjs/ui-router.html" class="sidebar-link">ui-router</a></li><li><a href="/angularjs/built-in-helper-functions.html" class="sidebar-link">Built-in helper Functions</a></li><li><a href="/angularjs/digest-loop-walkthrough.html" class="sidebar-link">digest loop walkthrough</a></li><li><a href="/angularjs/angular-scopes.html" class="sidebar-link">Angular $scopes</a></li><li><a href="/angularjs/using-angularjs-with-typescript.html" class="sidebar-link">Using AngularJS with TypeScript</a></li><li><a href="/angularjs/http-request.html" class="sidebar-link">$http request</a></li><li><a href="/angularjs/prepare-for-production-grunt.html" class="sidebar-link">Prepare for Production - Grunt</a></li><li><a href="/angularjs/grunt-tasks.html" class="sidebar-link">Grunt tasks</a></li><li><a href="/angularjs/lazy-loading.html" class="sidebar-link">Lazy loading</a></li><li><a href="/angularjs/http-interceptor.html" class="sidebar-link">HTTP Interceptor</a></li><li><a href="/angularjs/session-storage.html" class="sidebar-link">Session storage</a></li><li><a href="/angularjs/angular-mvc.html" class="sidebar-link">Angular MVC</a></li><li><a href="/angularjs/signalr-with-angularjs.html" class="sidebar-link">SignalR with AngularJs</a></li><li><a href="/angularjs/migration-to-angular-2.html" class="sidebar-link">Migration to Angular 2+</a></li><li><a href="/angularjs/angularjs-with-data-filter-pagination-etc.html" class="sidebar-link">angularjs with data filter, pagination etc</a></li><li><a href="/angularjs/profiling-and-performance.html" class="sidebar-link">Profiling and Performance</a></li><li><a href="/angularjs/performance-profiling.html" class="sidebar-link">Performance Profiling</a></li><li><a href="/angularjs/debugging.html" class="sidebar-link">Debugging</a></li><li><a href="/angularjs/unit-tests.html" class="sidebar-link">Unit tests</a></li><li><a href="/angularjs/angularjs-gotchas-and-traps.html" aria-current="page" class="active sidebar-link">AngularJS gotchas and traps</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/angularjs/angularjs-gotchas-and-traps.html#things-to-do-when-using-html5mode" class="sidebar-link">Things to do when using html5Mode</a></li><li class="sidebar-sub-header"><a href="/angularjs/angularjs-gotchas-and-traps.html#two-way-data-binding-stops-working" class="sidebar-link">Two-way data binding stops working</a></li><li class="sidebar-sub-header"><a href="/angularjs/angularjs-gotchas-and-traps.html#_7-deadly-sins-of-angularjs" class="sidebar-link">7 Deadly Sins of AngularJS</a></li></ul></li><li><a href="/angularjs/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="angularjs-gotchas-and-traps"><a href="#angularjs-gotchas-and-traps" class="header-anchor">#</a> AngularJS gotchas and traps</h1> <h2 id="things-to-do-when-using-html5mode"><a href="#things-to-do-when-using-html5mode" class="header-anchor">#</a> Things to do when using html5Mode</h2> <p>When using <code>html5Mode([mode])</code> it is necessary that:</p> <li>
You specify the base URL for the application with a `<base href="">` in the head of your `index.html`.
</li> <li>
It is important that the `base` tag comes before any tags with url requests. Otherwise, this might result in this error - `&quot;Resource interpreted as stylesheet but transferred with MIME type text/html&quot;`. For example:
<div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Job Seeker<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>base href<span class="token operator">=</span><span class="token string">&quot;/&quot;</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;stylesheet&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;bower_components/bootstrap/dist/css/bootstrap.css&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;stylesheet&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;/styles/main.css&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>

</code></pre></div></li> <li>
If you do no want to specify a `base` tag, configure `$locationProvider` to not require a `base` tag by passing a definition object with `requireBase:false` to `$locationProvider.html5Mode()` like this:
<div class="language-js extra-class"><pre class="language-js"><code>$locationProvider<span class="token punctuation">.</span><span class="token function">html5Mode</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    requireBase<span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div></li> <li>
In order to support direct loading of HTML5 URLs, you need to enabler server-side URL rewriting. From [AngularJS / Developer Guide / Using $location](https://docs.angularjs.org/guide/$location#server-side)
<blockquote>
Using this mode requires URL rewriting on server side, basically you have to rewrite all your links to entry point of your application (e.g. `index.html`). Requiring a `<base>` tag is also important for this case, as it allows Angular to differentiate between the part of the url that is the application base and the path that should be handled by the application.
</blockquote>
An excellent resource for request rewriting examples for various HTTP server implementations can be found in the [ui-router FAQ - How to: Configure your server to work with html5Mode](https://github.com/angular-ui/ui-router/wiki/Frequently-Asked-Questions#how-to-configure-your-server-to-work-with-html5mode). For example, Apache
<div class="language-js extra-class"><pre class="language-js"><code> RewriteEngine on

 # Don't rewrite files or directories
 RewriteCond <span class="token operator">%</span><span class="token punctuation">{</span><span class="token constant">REQUEST_FILENAME</span><span class="token punctuation">}</span> <span class="token operator">-</span>f <span class="token punctuation">[</span><span class="token constant">OR</span><span class="token punctuation">]</span>
 RewriteCond <span class="token operator">%</span><span class="token punctuation">{</span><span class="token constant">REQUEST_FILENAME</span><span class="token punctuation">}</span> <span class="token operator">-</span>d
 RewriteRule <span class="token operator">^</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token constant">L</span><span class="token punctuation">]</span>

 # Rewrite everything <span class="token keyword">else</span> to index<span class="token punctuation">.</span>html to allow html5 state links
 RewriteRule <span class="token operator">^</span> index<span class="token punctuation">.</span>html <span class="token punctuation">[</span><span class="token constant">L</span><span class="token punctuation">]</span>

</code></pre></div><p>nginx</p> <div class="language-js extra-class"><pre class="language-js"><code> server <span class="token punctuation">{</span>
     server_name my<span class="token operator">-</span>app<span class="token punctuation">;</span>

     root <span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>app<span class="token punctuation">;</span>

     location <span class="token operator">/</span> <span class="token punctuation">{</span>
         try_files $uri $uri<span class="token operator">/</span> <span class="token operator">/</span>index<span class="token punctuation">.</span>html<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>

</code></pre></div><p>Express</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/js'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/dist'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/../dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/css'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/css'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/partials'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/partials'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// Just send the index.html for other files to support HTML5Mode</span>
     res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> root<span class="token operator">:</span> __dirname <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3006</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//the port you want to use</span>

</code></pre></div></li> <h2 id="two-way-data-binding-stops-working"><a href="#two-way-data-binding-stops-working" class="header-anchor">#</a> Two-way data binding stops working</h2> <p>One should have in mind that:</p> <ol><li>Angular's data binding relies on JavaScript’s prototypal inheritance, thus it's subject to <a href="https://en.wikipedia.org/wiki/Variable_shadowing" target="_blank" rel="noopener noreferrer">variable shadowing<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>A child scope normally prototypically inherits from its parent scope. <sub><sup>One exception to this rule is a directive which has an isolated scope as it doesn't prototypically inherit.</sup></sub></li> <li>There are some directives which create a new child scope: <code>ng-repeat</code>, <code>ng-switch</code>, <code>ng-view</code>, <code>ng-if</code>, <code>ng-controller</code>, <code>ng-include</code>, etc.</li></ol> <p>This means that when you try to two-way bind some data to a primitive which is inside of a child scope (or vice-versa), things may not work as expected. <a href="https://jsfiddle.net/4bpbhmtL/" target="_blank" rel="noopener noreferrer">Here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>'s an example of how easily is to <strong>&quot;break&quot;</strong> AngularJS.</p> <p>This issue can easily be avoided following these steps:</p> <ol><li>Have a &quot;.&quot; inside your HTML template whenever you bind some data</li> <li>Use <code>controllerAs</code> syntax as it promotes the use of binding to a &quot;dotted&quot; object</li> <li>$parent can be used to access parent <code>scope</code> variables rather than child scope. like inside <code>ng-if</code> we can use <code>ng-model=&quot;$parent.foo&quot;</code>..</li></ol> <p>An alternative for the above is to bind <code>ngModel</code> to a getter/setter function that will update the cached version of the model when called with arguments, or return it when called without arguments.
In order to use a getter/setter function, you need to add <code>ng-model-options=&quot;{ getterSetter: true }&quot;</code> to the element with the <code>ngModal</code> attribute, and to call the getter function if you want to display its value in expression (<a href="https://jsfiddle.net/4bpbhmtL/5/" target="_blank" rel="noopener noreferrer">Working example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</p> <h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <p>View:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>div ng<span class="token operator">-</span>app<span class="token operator">=</span><span class="token string">&quot;myApp&quot;</span> ng<span class="token operator">-</span>controller<span class="token operator">=</span><span class="token string">&quot;MainCtrl&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> ng<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;foo&quot;</span> ng<span class="token operator">-</span>model<span class="token operator">-</span>options<span class="token operator">=</span><span class="token string">&quot;{ getterSetter: true }&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div ng<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;truthyValue&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token constant">I</span><span class="token string">'m a child scope (inside ng-if), but i'</span>m synced <span class="token keyword">with</span> changes from the outside scope <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> ng<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;foo&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>$scope<span class="token punctuation">.</span>foo<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">{</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

</code></pre></div><p>Controller:</p> <div class="language-js extra-class"><pre class="language-js"><code>angular<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">'myApp'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">'MainCtrl'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'$scope'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$scope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    $scope<span class="token punctuation">.</span>truthyValue <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      
    <span class="token keyword">var</span> _foo <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span> <span class="token comment">// this will be used to cache/represent the value of the 'foo' model </span>
      
    $scope<span class="token punctuation">.</span><span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// the function return the the internal '_foo' varibale when called with zero arguments,</span>
        <span class="token comment">// and update the internal `_foo` when called with an argument</span>
        <span class="token keyword">return</span> arguments<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token punctuation">(</span>_foo <span class="token operator">=</span> val<span class="token punctuation">)</span> <span class="token operator">:</span> _foo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>Best Practice</strong>: It's best to keep getters fast because Angular is likely to call them more frequently than other parts of your code (<a href="https://docs.angularjs.org/api/ng/directive/ngModel" target="_blank" rel="noopener noreferrer">reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</p> <h2 id="_7-deadly-sins-of-angularjs"><a href="#_7-deadly-sins-of-angularjs" class="header-anchor">#</a> 7 Deadly Sins of AngularJS</h2> <p>Below is the list of some mistakes that developers often make during the use of AngularJS functionalities, some learned lessons and solutions to them.</p> <p><strong>1. Manipulating DOM through the controller</strong></p> <p>It's legal, but must be avoided. Controllers are the places where you define your dependencies, bind your data to the view and make further business logic. You can technically manipulate the DOM in a controller, but whenever you need same or similar manipulation in another part of your app, another controller will be needed. So the best practice of this approach is creating a directive that includes all manipulations and use the directive throughout your app. Hence, the controller leaves the view intact and does it's job.
In a directive, linking function is the best place to manipulate the DOM. It has full access to the scope and element, so using a directive, you can also take the advantage of reusability.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function-variable function">link</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$scope<span class="token punctuation">,</span> element<span class="token punctuation">,</span> attrs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//The best place to manipulate DOM</span>
<span class="token punctuation">}</span>

</code></pre></div><p>You can access DOM elements in linking function through several ways, such as the <code>element</code> parameter, <code>angular.element()</code> method, or pure Javascript.</p> <p><strong>2. Data binding in transclusion</strong></p> <p>AngularJS is famous with its two-way data binding. However you may encounter sometimes that your data is only one-way bound inside directives. Stop there, AngularJS is not wrong but probably you. Directives are a little dangerous places since child scopes and isolated scopes are involved. Assume you have the following directive with one transclusion</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>my<span class="token operator">-</span>dir<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>my<span class="token operator">-</span>transclusion<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>transclusion<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>dir<span class="token operator">&gt;</span>

</code></pre></div><p>And inside my-transclusion, you have some elements which are bound to the data in the outer scope.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>my<span class="token operator">-</span>dir<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>my<span class="token operator">-</span>transclusion<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input ng<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;name&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>transclusion<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>dir<span class="token operator">&gt;</span>

</code></pre></div><p>The above code will not work correctly. Here, transclusion creates a child scope and you can get the name variable, right, but whatever change you make to this variable will stay there. So, you can truly acces this variable as <strong>$parent.name</strong>. However, this use might not be the best practice. A better approach would be wrapping the variables inside an object. For example, in the controller you can create:</p> <div class="language-js extra-class"><pre class="language-js"><code>$scope<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'someName'</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Then in the transclusion, you can access this variable via 'data' object and see that two-way binding works perfectly!</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>input ng<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;data.name&quot;</span><span class="token operator">&gt;</span>

</code></pre></div><p>Not only in transclusions, but throughout the app, it's a good idea to use the dotted notation.</p> <p><strong>3. Multiple directives together</strong></p> <p>It is actually legal to use two directives together within the same element, as long as you obey by the rule: two isolated scopes cannot exist on the same element. Generally speaking, when creating a new custom directive, you allocate an isolated scope for easy parameter passing. Assuming that the directives myDirA and myDirB have isoleted scopes and myDirC has not, following element will be valid:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>input my<span class="token operator">-</span>dir<span class="token operator">-</span>a my<span class="token operator">-</span>dirc<span class="token operator">&gt;</span>

</code></pre></div><p>whereas the following element will cause console error:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>input my<span class="token operator">-</span>dir<span class="token operator">-</span>a my<span class="token operator">-</span>dir<span class="token operator">-</span>b<span class="token operator">&gt;</span>

</code></pre></div><p>Therefore, directives must be used wisely, taking the scopes into consideration.</p> <p><strong>4. Misuse of $emit</strong></p> <p>$emit, $broadcast and $on, these work in a sender-receiver principle. In others words, they are a means of communication between controllers. For example, the following line emits the 'someEvent' from controller A, to be catched by the concerned controller B.</p> <div class="language-js extra-class"><pre class="language-js"><code>$scope<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'someEvent'</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>And the following line catches the 'someEvent'</p> <div class="language-js extra-class"><pre class="language-js"><code>$scope<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'someEvent'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>So far everything seems perfect. But remember that, if the controller B is not invoked yet, the event will not be caught, which means both emitter and receiver controllers have to be invoked to get this working. So again, if you are not sure that you definitely have to use $emit, building a service seems a better way.</p> <p><strong>5. Misuse of $scope.$watch</strong></p> <p>$scope.$watch is used for watching a variable change. Whenever a variable has changed, this method is invoked. However, one common mistake done is changing the variable inside $scope.$watch. This will cause inconsistency and infinite $digest loop at some point.</p> <div class="language-js extra-class"><pre class="language-js"><code>$scope<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">'myCtrl.myVariable'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>myVariable<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>So in the above function, make sure you have no operations on myVariable and newVal.</p> <p><strong>6. Binding methods to views</strong></p> <p>This is one of the deadlisest sins. AngularJS has two-way binding, and whenever something changes, the views are updated many many times. So, if you bind a method to an attribute of a view, that method might potentially be called a hundred times, which also drives you crazy during debugging. However, there are only some attributes that are built for method binding, such as ng-click, ng-blur, ng-on-change, etc, that expect methods as paremeter.
For instance, assume you have the following view in your markup:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>input ng<span class="token operator">-</span>disabled<span class="token operator">=</span><span class="token string">&quot;myCtrl.isDisabled()&quot;</span> ng<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;myCtrl.name&quot;</span><span class="token operator">&gt;</span>

</code></pre></div><p>Here you check the disabled status of the view via the method isDisabled. In the controller myCtrl, you have:</p> <div class="language-js extra-class"><pre class="language-js"><code>vm<span class="token punctuation">.</span><span class="token function-variable function">isDisabled</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>someCondition<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>In theory, it may seem correct but technically this will cause an overload, since the method will run countless times. In order to resolve this, you should bind a variable. In your controller, the following variable must exist:</p> <div class="language-js extra-class"><pre class="language-js"><code>vm<span class="token punctuation">.</span>isDisabled

</code></pre></div><p>You can initiate this variable again in the activation of the controller</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span>someCondition<span class="token punctuation">)</span>
    vm<span class="token punctuation">.</span>isDisabled <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token keyword">else</span>
    vm<span class="token punctuation">.</span>isDisabled <span class="token operator">=</span> <span class="token boolean">false</span>

</code></pre></div><p>If the condition is not stable, you may bind this to another event. Then you should bind this variable to the view:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>input ng<span class="token operator">-</span>disabled<span class="token operator">=</span><span class="token string">&quot;myCtrl.isDisabled&quot;</span> ng<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;myCtrl.name&quot;</span><span class="token operator">&gt;</span>

</code></pre></div><p>Now, all the attributes of the view have what they expect and the methods will run only whenever needed.</p> <p><strong>7. Not using Angular's functionalities</strong></p> <p>AngularJS provides great convenience with some of its functionalities, not only simplifying your code but also making it more efficient. Some of these features are listed below:</p> <div class="language- extra-class"><pre><code>1. **angular.forEach** for the loops (Caution, you can't &quot;break;&quot; it, you can only prevent getting into the body, so consider performance here.)
1. **angular.element** for DOM selectors
    1. **angular.copy**: Use this when you should not modify the main object
1. **Form validations** are already awesome. Use dirty, pristine, touched, valid, required and so on.
1. Besides Chrome debugger, use **remote debugging** for mobile development too.
1. And make sure you use **Batarang**. It's a free Chrome extension where you can easily inspect scopes
</code></pre></div><p>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/angularjs/angularjs-gotchas-and-traps.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/angularjs/unit-tests.html" class="prev">
        Unit tests
      </a></span> <span class="next"><a href="/angularjs/contributors.html">
        The Contributors
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/423.46aa3728.js" defer></script>
  </body>
</html>
