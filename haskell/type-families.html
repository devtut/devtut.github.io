<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Haskell - Type Families</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Datatype Families, Type Synonym Families, Injectivity">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Haskell - Type Families">
    <meta property="og:description" content="Datatype Families, Type Synonym Families, Injectivity">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/haskell/type-families.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Haskell - Type Families">
    <meta name="twitter:description" content="Datatype Families, Type Synonym Families, Injectivity">
    <meta name="twitter:url" content="/haskell/type-families.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/1236.abde09c0.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Haskell</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/haskell/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/haskell/getting-started-with-haskell-language.html" class="sidebar-link">Getting started with Haskell Language</a></li><li><a href="/haskell/overloaded-literals.html" class="sidebar-link">Overloaded Literals</a></li><li><a href="/haskell/foldable.html" class="sidebar-link">Foldable</a></li><li><a href="/haskell/traversable.html" class="sidebar-link">Traversable</a></li><li><a href="/haskell/lens.html" class="sidebar-link">Lens</a></li><li><a href="/haskell/quickcheck.html" class="sidebar-link">QuickCheck</a></li><li><a href="/haskell/common-ghc-language-extensions.html" class="sidebar-link">Common GHC Language Extensions</a></li><li><a href="/haskell/free-monads.html" class="sidebar-link">Free Monads</a></li><li><a href="/haskell/type-classes.html" class="sidebar-link">Type Classes</a></li><li><a href="/haskell/io.html" class="sidebar-link">IO</a></li><li><a href="/haskell/record-syntax.html" class="sidebar-link">Record Syntax</a></li><li><a href="/haskell/partial-application.html" class="sidebar-link">Partial Application</a></li><li><a href="/haskell/monoid.html" class="sidebar-link">Monoid</a></li><li><a href="/haskell/category-theory.html" class="sidebar-link">Category Theory</a></li><li><a href="/haskell/lists.html" class="sidebar-link">Lists</a></li><li><a href="/haskell/sorting-algorithms.html" class="sidebar-link">Sorting Algorithms</a></li><li><a href="/haskell/type-families.html" aria-current="page" class="active sidebar-link">Type Families</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/haskell/type-families.html#datatype-families" class="sidebar-link">Datatype Families</a></li><li class="sidebar-sub-header"><a href="/haskell/type-families.html#type-synonym-families" class="sidebar-link">Type Synonym Families</a></li><li class="sidebar-sub-header"><a href="/haskell/type-families.html#injectivity" class="sidebar-link">Injectivity</a></li></ul></li><li><a href="/haskell/monads.html" class="sidebar-link">Monads</a></li><li><a href="/haskell/stack.html" class="sidebar-link">Stack</a></li><li><a href="/haskell/generalized-algebraic-data-types.html" class="sidebar-link">Generalized Algebraic Data Types</a></li><li><a href="/haskell/recursion-schemes.html" class="sidebar-link">Recursion Schemes</a></li><li><a href="/haskell/data-text.html" class="sidebar-link">Data.Text</a></li><li><a href="/haskell/using-ghci.html" class="sidebar-link">Using GHCi</a></li><li><a href="/haskell/strictness.html" class="sidebar-link">Strictness</a></li><li><a href="/haskell/syntax-in-functions.html" class="sidebar-link">Syntax in Functions</a></li><li><a href="/haskell/functor.html" class="sidebar-link">Functor</a></li><li><a href="/haskell/testing-with-tasty.html" class="sidebar-link">Testing with Tasty</a></li><li><a href="/haskell/creating-custom-data-types.html" class="sidebar-link">Creating Custom Data Types</a></li><li><a href="/haskell/reactive-banana.html" class="sidebar-link">Reactive-banana</a></li><li><a href="/haskell/optimization.html" class="sidebar-link">Optimization</a></li><li><a href="/haskell/concurrency.html" class="sidebar-link">Concurrency</a></li><li><a href="/haskell/function-composition.html" class="sidebar-link">Function composition</a></li><li><a href="/haskell/databases.html" class="sidebar-link">Databases</a></li><li><a href="/haskell/data-aeson-json-in-haskell.html" class="sidebar-link">Data.Aeson - JSON in Haskell</a></li><li><a href="/haskell/higher-order-functions.html" class="sidebar-link">Higher-order functions</a></li><li><a href="/haskell/containers-data-map.html" class="sidebar-link">Containers - Data.Map</a></li><li><a href="/haskell/fixity-declarations.html" class="sidebar-link">Fixity declarations</a></li><li><a href="/haskell/web-development.html" class="sidebar-link">Web Development</a></li><li><a href="/haskell/vectors.html" class="sidebar-link">Vectors</a></li><li><a href="/haskell/cabal.html" class="sidebar-link">Cabal</a></li><li><a href="/haskell/type-algebra.html" class="sidebar-link">Type algebra</a></li><li><a href="/haskell/arrows.html" class="sidebar-link">Arrows</a></li><li><a href="/haskell/typed-holes.html" class="sidebar-link">Typed holes</a></li><li><a href="/haskell/rewrite-rules-ghc.html" class="sidebar-link">Rewrite rules (GHC)</a></li><li><a href="/haskell/date-and-time.html" class="sidebar-link">Date and Time</a></li><li><a href="/haskell/list-comprehensions.html" class="sidebar-link">List Comprehensions</a></li><li><a href="/haskell/streaming-io.html" class="sidebar-link">Streaming IO</a></li><li><a href="/haskell/google-protocol-buffers.html" class="sidebar-link">Google Protocol Buffers</a></li><li><a href="/haskell/template-haskell-quasiquotes.html" class="sidebar-link">Template Haskell &amp; QuasiQuotes</a></li><li><a href="/haskell/phantom-types.html" class="sidebar-link">Phantom types</a></li><li><a href="/haskell/modules.html" class="sidebar-link">Modules</a></li><li><a href="/haskell/tuples-pairs-triples.html" class="sidebar-link">Tuples (Pairs, Triples, ...)</a></li><li><a href="/haskell/graphics-with-gloss.html" class="sidebar-link">Graphics with Gloss</a></li><li><a href="/haskell/state-monad.html" class="sidebar-link">State Monad</a></li><li><a href="/haskell/pipes.html" class="sidebar-link">Pipes</a></li><li><a href="/haskell/infix-operators.html" class="sidebar-link">Infix operators</a></li><li><a href="/haskell/parallelism.html" class="sidebar-link">Parallelism</a></li><li><a href="/haskell/parsing-html-with-taggy-lens-and-lens.html" class="sidebar-link">Parsing HTML with taggy-lens and lens</a></li><li><a href="/haskell/foreign-function-interface.html" class="sidebar-link">Foreign Function Interface</a></li><li><a href="/haskell/gtk3.html" class="sidebar-link">Gtk3</a></li><li><a href="/haskell/monad-transformers.html" class="sidebar-link">Monad Transformers</a></li><li><a href="/haskell/bifunctor.html" class="sidebar-link">Bifunctor</a></li><li><a href="/haskell/proxies.html" class="sidebar-link">Proxies</a></li><li><a href="/haskell/applicative-functor.html" class="sidebar-link">Applicative Functor</a></li><li><a href="/haskell/common-monads-as-free-monads.html" class="sidebar-link">Common monads as free monads</a></li><li><a href="/haskell/common-functors-as-the-base-of-cofree-comonads.html" class="sidebar-link">Common functors as the base of cofree comonads</a></li><li><a href="/haskell/arithmetic.html" class="sidebar-link">Arithmetic</a></li><li><a href="/haskell/role.html" class="sidebar-link">Role</a></li><li><a href="/haskell/arbitrary-rank-polymorphism-with-rankntypes.html" class="sidebar-link">Arbitrary-rank polymorphism with RankNTypes</a></li><li><a href="/haskell/ghcjs.html" class="sidebar-link">GHCJS</a></li><li><a href="/haskell/xml.html" class="sidebar-link">XML</a></li><li><a href="/haskell/reader-readert.html" class="sidebar-link">Reader / ReaderT</a></li><li><a href="/haskell/function-call-syntax.html" class="sidebar-link">Function call syntax</a></li><li><a href="/haskell/logging.html" class="sidebar-link">Logging</a></li><li><a href="/haskell/attoparsec.html" class="sidebar-link">Attoparsec</a></li><li><a href="/haskell/zipwithm.html" class="sidebar-link">zipWithM</a></li><li><a href="/haskell/profunctor.html" class="sidebar-link">Profunctor</a></li><li><a href="/haskell/type-application.html" class="sidebar-link">Type Application</a></li><li><a href="/haskell/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="type-families"><a href="#type-families" class="header-anchor">#</a> Type Families</h1> <h2 id="datatype-families"><a href="#datatype-families" class="header-anchor">#</a> Datatype Families</h2> <p>Data families can be used to build datatypes that have different implementations based on their type arguments.</p> <h3 id="standalone-data-families"><a href="#standalone-data-families" class="header-anchor">#</a> Standalone data families</h3> <div class="language-hs extra-class"><pre class="language-hs"><code><span class="token comment">{-# LANGUAGE TypeFamilies #-}</span>
<span class="token keyword">data</span> <span class="token hvariable">family</span> <span class="token constant">List</span> <span class="token hvariable">a</span>
<span class="token keyword">data</span> <span class="token keyword">instance</span> <span class="token constant">List</span> <span class="token constant">Char</span> <span class="token operator">=</span> <span class="token constant">Nil</span> <span class="token operator">|</span> <span class="token constant">Cons</span> <span class="token constant">Char</span> <span class="token punctuation">(</span><span class="token constant">List</span> <span class="token constant">Char</span><span class="token punctuation">)</span>
<span class="token keyword">data</span> <span class="token keyword">instance</span> <span class="token constant">List</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token constant">UnitList</span> <span class="token constant">Int</span>

</code></pre></div><p>In the above declaration, <code>Nil :: List Char</code>, and <code>UnitList :: Int -&gt; List ()</code></p> <h3 id="associated-data-families"><a href="#associated-data-families" class="header-anchor">#</a> Associated data families</h3> <p>Data families can also be associated with typeclasses. This is often useful for types with “helper objects”, which are required for generic typeclass methods but need to contain different information depending on the concrete instance. For instance, indexing locations in a list just requires a single number, whereas in a tree you need a number to indicate the path at each node:</p> <div class="language-hs extra-class"><pre class="language-hs"><code><span class="token keyword">class</span> <span class="token constant">Container</span> <span class="token hvariable">f</span> <span class="token keyword">where</span>
  <span class="token keyword">data</span> <span class="token constant">Location</span> <span class="token hvariable">f</span>
  <span class="token hvariable">get</span> <span class="token operator">::</span> <span class="token constant">Location</span> <span class="token hvariable">f</span> <span class="token operator">-&gt;</span> <span class="token hvariable">f</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">Maybe</span> <span class="token hvariable">a</span>

<span class="token keyword">instance</span> <span class="token constant">Container</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">where</span>
  <span class="token keyword">data</span> <span class="token constant">Location</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">ListLoc</span> <span class="token constant">Int</span>
  <span class="token hvariable">get</span> <span class="token punctuation">(</span><span class="token constant">ListLoc</span> <span class="token hvariable">i</span><span class="token punctuation">)</span> <span class="token hvariable">xs</span>
    <span class="token operator">|</span> <span class="token hvariable">i</span> <span class="token operator">&lt;</span> <span class="token builtin">length</span> <span class="token hvariable">xs</span>  <span class="token operator">=</span> <span class="token constant">Just</span> <span class="token operator">$</span> <span class="token hvariable">xs</span><span class="token operator">!!</span><span class="token hvariable">i</span>
    <span class="token operator">|</span> <span class="token builtin">otherwise</span>      <span class="token operator">=</span> <span class="token constant">Nothing</span>

<span class="token keyword">instance</span> <span class="token constant">Container</span> <span class="token constant">Tree</span> <span class="token keyword">where</span>
  <span class="token keyword">data</span> <span class="token constant">Location</span> <span class="token constant">Tree</span> <span class="token operator">=</span> <span class="token constant">ThisNode</span> <span class="token operator">|</span> <span class="token constant">NodePath</span> <span class="token constant">Int</span> <span class="token punctuation">(</span><span class="token constant">Location</span> <span class="token constant">Tree</span><span class="token punctuation">)</span>
  <span class="token hvariable">get</span> <span class="token constant">ThisNode</span> <span class="token punctuation">(</span><span class="token constant">Node</span> <span class="token hvariable">x</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token constant">Just</span> <span class="token hvariable">x</span>
  <span class="token hvariable">get</span> <span class="token punctuation">(</span><span class="token constant">NodePath</span> <span class="token hvariable">i</span> <span class="token hvariable">path</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token constant">Node</span> <span class="token hvariable">_</span> <span class="token hvariable">sfo</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">get</span> <span class="token hvariable">path</span> <span class="token operator">=&lt;&lt;</span> <span class="token hvariable">get</span> <span class="token hvariable">i</span> <span class="token hvariable">sfo</span>

</code></pre></div><h2 id="type-synonym-families"><a href="#type-synonym-families" class="header-anchor">#</a> Type Synonym Families</h2> <p>Type synonym families are just type-level functions: they associate parameter types with result types. These come in three different varieties.</p> <h3 id="closed-type-synonym-families"><a href="#closed-type-synonym-families" class="header-anchor">#</a> Closed type-synonym families</h3> <p>These work much like ordinary value-level Haskell functions: you specify some clauses, mapping certain types to others:</p> <div class="language-hs extra-class"><pre class="language-hs"><code><span class="token comment">{-# LANGUAGE TypeFamilies #-}</span>
<span class="token keyword">type</span> <span class="token hvariable">family</span> <span class="token constant">Vanquisher</span> <span class="token hvariable">a</span> <span class="token keyword">where</span>
    <span class="token constant">Vanquisher</span> <span class="token constant">Rock</span> <span class="token operator">=</span> <span class="token constant">Paper</span>
    <span class="token constant">Vanquisher</span> <span class="token constant">Paper</span> <span class="token operator">=</span> <span class="token constant">Scissors</span>
    <span class="token constant">Vanquisher</span> <span class="token constant">Scissors</span> <span class="token operator">=</span> <span class="token constant">Rock</span>

<span class="token keyword">data</span> <span class="token constant">Rock</span><span class="token operator">=</span><span class="token constant">Rock</span><span class="token punctuation">;</span> <span class="token keyword">data</span> <span class="token constant">Paper</span><span class="token operator">=</span><span class="token constant">Paper</span><span class="token punctuation">;</span> <span class="token keyword">data</span> <span class="token constant">Scissors</span><span class="token operator">=</span><span class="token constant">Scissors</span>

</code></pre></div><h3 id="open-type-synonym-families"><a href="#open-type-synonym-families" class="header-anchor">#</a> Open type-synonym families</h3> <p>These work more like typeclass instances: anybody can add more clauses in other modules.</p> <div class="language-hs extra-class"><pre class="language-hs"><code><span class="token keyword">type</span> <span class="token hvariable">family</span> <span class="token constant">DoubledSize</span> <span class="token hvariable">w</span>

<span class="token keyword">type</span> <span class="token keyword">instance</span> <span class="token constant">DoubledSize</span> <span class="token constant">Word16</span> <span class="token operator">=</span> <span class="token constant">Word32</span>
<span class="token keyword">type</span> <span class="token keyword">instance</span> <span class="token constant">DoubledSize</span> <span class="token constant">Word32</span> <span class="token operator">=</span> <span class="token constant">Word64</span>
<span class="token comment">-- Other instances might appear in other modules, but two instances cannot overlap</span>
<span class="token comment">-- in a way that would produce different results.</span>

</code></pre></div><h3 id="class-associated-type-synonyms"><a href="#class-associated-type-synonyms" class="header-anchor">#</a> Class-associated type synonyms</h3> <p>An open type family can also be combined with an actual class. This is usually done when, like with <a href="http://stackoverflow.com/documentation/haskell/2955/type-families/10038/datatype-families" target="_blank" rel="noopener noreferrer">associated data families<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, some class method needs additional helper objects, and these helper objects <strong>can</strong> be different for different instances but may possibly also shared. A good example is <a href="http://hackage.haskell.org/package/vector-space-0.10.2/docs/Data-VectorSpace.html#t:VectorSpace" target="_blank" rel="noopener noreferrer"><code>VectorSpace</code> class<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language-hs extra-class"><pre class="language-hs"><code><span class="token keyword">class</span> <span class="token constant">VectorSpace</span> <span class="token hvariable">v</span> <span class="token keyword">where</span>
  <span class="token keyword">type</span> <span class="token constant">Scalar</span> <span class="token hvariable">v</span> <span class="token operator">::</span> <span class="token operator">*</span>
  <span class="token punctuation">(</span><span class="token operator">*^</span><span class="token punctuation">)</span> <span class="token operator">::</span> <span class="token constant">Scalar</span> <span class="token hvariable">v</span> <span class="token operator">-&gt;</span> <span class="token hvariable">v</span> <span class="token operator">-&gt;</span> <span class="token hvariable">v</span>

<span class="token keyword">instance</span> <span class="token constant">VectorSpace</span> <span class="token constant">Double</span> <span class="token keyword">where</span>
  <span class="token keyword">type</span> <span class="token constant">Scalar</span> <span class="token constant">Double</span> <span class="token operator">=</span> <span class="token constant">Double</span>
  μ <span class="token operator">*^</span> <span class="token hvariable">n</span> <span class="token operator">=</span> μ <span class="token operator">*</span> <span class="token hvariable">n</span>

<span class="token keyword">instance</span> <span class="token constant">VectorSpace</span> <span class="token punctuation">(</span><span class="token constant">Double</span><span class="token punctuation">,</span><span class="token constant">Double</span><span class="token punctuation">)</span> <span class="token keyword">where</span>
  <span class="token keyword">type</span> <span class="token constant">Scalar</span> <span class="token punctuation">(</span><span class="token constant">Double</span><span class="token punctuation">,</span><span class="token constant">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token constant">Double</span>
  μ <span class="token operator">*^</span> <span class="token punctuation">(</span><span class="token hvariable">n</span><span class="token punctuation">,</span><span class="token hvariable">m</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>μ<span class="token operator">*</span><span class="token hvariable">n</span><span class="token punctuation">,</span> μ<span class="token operator">*</span><span class="token hvariable">m</span><span class="token punctuation">)</span>
  
<span class="token keyword">instance</span> <span class="token constant">VectorSpace</span> <span class="token punctuation">(</span><span class="token constant">Complex</span> <span class="token constant">Double</span><span class="token punctuation">)</span> <span class="token keyword">where</span>
  <span class="token keyword">type</span> <span class="token constant">Scalar</span> <span class="token punctuation">(</span><span class="token constant">Complex</span> <span class="token constant">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token constant">Complex</span> <span class="token constant">Double</span>
  μ <span class="token operator">*^</span> <span class="token hvariable">n</span> <span class="token operator">=</span> μ<span class="token operator">*</span><span class="token hvariable">n</span>

</code></pre></div><p>Note how in the first two instances, the implementation of <code>Scalar</code> is the same. This would not be possible with an associated data family: data families are <a href="https://en.wikipedia.org/wiki/Injective_function" target="_blank" rel="noopener noreferrer">injective<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, type-synonym families aren't.</p> <p>While non-injectivity opens up some possibilities like the above, it also makes type inference more difficult. For instance, the following will not typecheck:</p> <div class="language-hs extra-class"><pre class="language-hs"><code><span class="token keyword">class</span> <span class="token constant">Foo</span> <span class="token hvariable">a</span> <span class="token keyword">where</span>
  <span class="token keyword">type</span> <span class="token constant">Bar</span> <span class="token hvariable">a</span> <span class="token operator">::</span> <span class="token operator">*</span>
  <span class="token hvariable">bar</span> <span class="token operator">::</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token constant">Bar</span> <span class="token hvariable">a</span>
<span class="token keyword">instance</span> <span class="token constant">Foo</span> <span class="token constant">Int</span> <span class="token keyword">where</span>
  <span class="token keyword">type</span> <span class="token constant">Bar</span> <span class="token constant">Int</span> <span class="token operator">=</span> <span class="token constant">String</span>
  <span class="token hvariable">bar</span> <span class="token operator">=</span> <span class="token builtin">show</span>
<span class="token keyword">instance</span> <span class="token constant">Foo</span> <span class="token constant">Double</span> <span class="token keyword">where</span>
  <span class="token keyword">type</span> <span class="token constant">Bar</span> <span class="token constant">Double</span> <span class="token operator">=</span> <span class="token constant">Bool</span>
  <span class="token hvariable">bar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token builtin">putStrLn</span> <span class="token punctuation">(</span><span class="token hvariable">bar</span> <span class="token number">1</span><span class="token punctuation">)</span>

</code></pre></div><p>In this case, the compiler can't know what instance to use, because the argument to <code>bar</code> is itself just a polymorphic <code>Num</code> literal. And the type function <code>Bar</code> can't be resolved in “inverse direction”, precisely because it's not injective<sup>†</sup> and hence not invertible (there could be more than one type with <code>Bar a = String</code>).</p> <p><sup>†</sup><sub>With only these two instances, it <strong>is</strong> actually injective, but the compiler can't know somebody won't add more instances later on and thereby break the behaviour.</sub></p> <h2 id="injectivity"><a href="#injectivity" class="header-anchor">#</a> Injectivity</h2> <p>Type Families are not necessarily injective. Therefore, we cannot infer the parameter from an application. For example, in <code>servant</code>, given a type <code>Server a</code> we cannot infer the type <code>a</code>. To solve this problem, we can use <code>Proxy</code>. For example, in <code>servant</code>, the <code>serve</code> function has type <code>... Proxy a -&gt; Server a -&gt; ...</code>. We can infer <code>a</code> from <code>Proxy a</code> because <code>Proxy</code> is defined by <code>data</code> which is injective.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/haskell/type-families.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/haskell/sorting-algorithms.html" class="prev">
        Sorting Algorithms
      </a></span> <span class="next"><a href="/haskell/monads.html">
        Monads
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/1236.abde09c0.js" defer></script>
  </body>
</html>
