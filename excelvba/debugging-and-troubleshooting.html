<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Excel VBA - Debugging and Troubleshooting</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Immediate Window, Debug.Print, Use Timer to Find Bottlenecks in Performance, Debugger Locals Window, Stop, Adding a Breakpoint to your code">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Excel VBA - Debugging and Troubleshooting">
    <meta property="og:description" content="Immediate Window, Debug.Print, Use Timer to Find Bottlenecks in Performance, Debugger Locals Window, Stop, Adding a Breakpoint to your code">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/excelvba/debugging-and-troubleshooting.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Excel VBA - Debugging and Troubleshooting">
    <meta name="twitter:description" content="Immediate Window, Debug.Print, Use Timer to Find Bottlenecks in Performance, Debugger Locals Window, Stop, Adding a Breakpoint to your code">
    <meta name="twitter:url" content="/excelvba/debugging-and-troubleshooting.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/1079.f0af53b2.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Excel VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/excelvba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/excelvba/getting-started-with-excel-vba.html" class="sidebar-link">Getting started with excel-vba</a></li><li><a href="/excelvba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/excelvba/conditional-statements.html" class="sidebar-link">Conditional statements</a></li><li><a href="/excelvba/ranges-and-cells.html" class="sidebar-link">Ranges and Cells</a></li><li><a href="/excelvba/named-ranges.html" class="sidebar-link">Named Ranges</a></li><li><a href="/excelvba/merged-cells-ranges.html" class="sidebar-link">Merged Cells / Ranges</a></li><li><a href="/excelvba/locating-duplicate-values-in-a-range.html" class="sidebar-link">Locating duplicate values in a range</a></li><li><a href="/excelvba/user-defined-functions-udfs.html" class="sidebar-link">User Defined Functions (UDFs)</a></li><li><a href="/excelvba/conditional-formatting-using-vba.html" class="sidebar-link">Conditional formatting using VBA</a></li><li><a href="/excelvba/workbooks.html" class="sidebar-link">Workbooks</a></li><li><a href="/excelvba/working-with-excel-tables-in-vba.html" class="sidebar-link">Working with Excel Tables in VBA</a></li><li><a href="/excelvba/loop-through-all-sheets-in-active-workbook.html" class="sidebar-link">Loop through all Sheets in Active Workbook</a></li><li><a href="/excelvba/use-worksheet-object-and-not-sheet-object.html" class="sidebar-link">Use Worksheet object and not Sheet object</a></li><li><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html" class="sidebar-link">Methods for Finding the Last Used Row or Column in a Worksheet</a></li><li><a href="/excelvba/creating-a-drop-down-menu-in-the-active-worksheet-with-a-combo-box.html" class="sidebar-link">Creating a drop-down menu in the Active Worksheet with a Combo Box</a></li><li><a href="/excelvba/file-system-object.html" class="sidebar-link">File System Object</a></li><li><a href="/excelvba/pivot-tables.html" class="sidebar-link">Pivot Tables</a></li><li><a href="/excelvba/binding.html" class="sidebar-link">Binding</a></li><li><a href="/excelvba/autofilter-uses-and-best-practices.html" class="sidebar-link">autofilter ; Uses and best practices</a></li><li><a href="/excelvba/application-object.html" class="sidebar-link">Application object</a></li><li><a href="/excelvba/charts-and-charting.html" class="sidebar-link">Charts and Charting</a></li><li><a href="/excelvba/customdocumentproperties-in-practice.html" class="sidebar-link">CustomDocumentProperties in practice</a></li><li><a href="/excelvba/powerpoint-integration-through-vba.html" class="sidebar-link">PowerPoint Integration Through VBA</a></li><li><a href="/excelvba/how-to-record-a-macro.html" class="sidebar-link">How to record a Macro</a></li><li><a href="/excelvba/sql-in-excel-vba-best-practices.html" class="sidebar-link">SQL in Excel VBA - Best Practices</a></li><li><a href="/excelvba/excel-vba-optimization.html" class="sidebar-link">Excel-VBA Optimization</a></li><li><a href="/excelvba/vba-security.html" class="sidebar-link">VBA Security</a></li><li><a href="/excelvba/debugging-and-troubleshooting.html" aria-current="page" class="active sidebar-link">Debugging and Troubleshooting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excelvba/debugging-and-troubleshooting.html#immediate-window" class="sidebar-link">Immediate Window</a></li><li class="sidebar-sub-header"><a href="/excelvba/debugging-and-troubleshooting.html#debug-print" class="sidebar-link">Debug.Print</a></li><li class="sidebar-sub-header"><a href="/excelvba/debugging-and-troubleshooting.html#use-timer-to-find-bottlenecks-in-performance" class="sidebar-link">Use Timer to Find Bottlenecks in Performance</a></li><li class="sidebar-sub-header"><a href="/excelvba/debugging-and-troubleshooting.html#debugger-locals-window" class="sidebar-link">Debugger Locals Window</a></li><li class="sidebar-sub-header"><a href="/excelvba/debugging-and-troubleshooting.html#stop" class="sidebar-link">Stop</a></li><li class="sidebar-sub-header"><a href="/excelvba/debugging-and-troubleshooting.html#adding-a-breakpoint-to-your-code" class="sidebar-link">Adding a Breakpoint to your code</a></li></ul></li><li><a href="/excelvba/vba-best-practices.html" class="sidebar-link">VBA Best Practices</a></li><li><a href="/excelvba/excel-vba-tips-and-tricks.html" class="sidebar-link">Excel VBA Tips and Tricks</a></li><li><a href="/excelvba/common-mistakes.html" class="sidebar-link">Common Mistakes</a></li><li><a href="/excelvba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="debugging-and-troubleshooting"><a href="#debugging-and-troubleshooting" class="header-anchor">#</a> Debugging and Troubleshooting</h1> <h2 id="immediate-window"><a href="#immediate-window" class="header-anchor">#</a> Immediate Window</h2> <p>If you would like to test a line of macro code without needing to run an entire sub, you can type commands directly into the Immediate Window and hit <code>ENTER</code> to run the line.</p> <p>For testing the output of a line, you can precede it with a question mark <code>?</code> to print directly to the Immediate Window.  Alternatively, you can also use the <code>print</code> command to have the output printed.</p> <p>While in the Visual Basic Editor, press <code>CTRL + G</code> to open the Immediate Window. To rename your currently selected sheet to &quot;ExampleSheet&quot;, type the following in the Immediate Window and hit <code>ENTER</code></p> <div class="language- extra-class"><pre class="language-text"><code>
  ActiveSheet.Name = &quot;ExampleSheet&quot;

</code></pre></div><p>To print the currently selected sheet's name directly in the Immediate Window</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token punctuation">?</span> ActiveSheet<span class="token punctuation">.</span>Name
ExampleSheet

</code></pre></div><p>This method can be very useful to test the functionality of built in or user defined functions before implementing them in code.  The example below demonstrates how the Immediate Window can be used to test the output of a function or series of functions to confirm an expected.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token comment">'In this example, the Immediate Window was used to confirm that a series of Left and Right </span>
<span class="token comment">'string methods would return the desired string</span>

<span class="token comment">'expected output: &quot;value&quot;</span>
print Left<span class="token punctuation">(</span>Right<span class="token punctuation">(</span><span class="token string">&quot;1111value1111&quot;</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">' &lt;---- written code here, ENTER pressed</span>
value                                  <span class="token comment">' &lt;---- output</span>

</code></pre></div><p>The Immediate Window can also be used to set or reset Application, Workbook, or other needed properties.  This can be useful if you have <code>Application.EnableEvents = False</code> in a subroutine that unexpectedly throws an error, causing it to close without resetting the value to <code>True</code> (which can cause frustrating and unexpected functionality.  In that case, the commands can be typed directly into the Immediate Window and run:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token punctuation">?</span> Application<span class="token punctuation">.</span>EnableEvents       <span class="token comment">' &lt;---- Testing the current state of &quot;EnableEvents&quot;</span>
<span class="token boolean">False</span>                            <span class="token comment">' &lt;---- Output</span>
Application<span class="token punctuation">.</span>EnableEvents <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment">' &lt;---- Resetting the property value to True</span>
<span class="token punctuation">?</span> Application<span class="token punctuation">.</span>EnableEvents       <span class="token comment">' &lt;---- Testing the current state of &quot;EnableEvents&quot;</span>
<span class="token boolean">True</span>                             <span class="token comment">' &lt;---- Output</span>

</code></pre></div><p>For more advanced debugging techniques, a colon <code>:</code> can be used as a line separator. This can be used for multi-line expressions such as looping in the example below.</p> <div class="language-vb extra-class"><pre class="language-vb"><code>x <span class="token operator">=</span> Split<span class="token punctuation">(</span><span class="token string">&quot;a,b,c&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">For</span> i <span class="token operator">=</span> LBound<span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">to</span> UBound<span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Debug<span class="token punctuation">.</span>Print x<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">Next</span> i <span class="token comment">'&lt;----Input this and press enter</span>
a <span class="token comment">'&lt;----Output</span>
b <span class="token comment">'&lt;----Output</span>
c <span class="token comment">'&lt;----Output</span>

</code></pre></div><h2 id="debug-print"><a href="#debug-print" class="header-anchor">#</a> Debug.Print</h2> <p>To print a listing of the Error Code descriptions to the Immediate Window, pass it to the <code>Debug.Print</code> function:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> ListErrCodes<span class="token punctuation">(</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print <span class="token string">&quot;List Error Code Descriptions&quot;</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> <span class="token number">65535</span>
        e <span class="token operator">=</span> <span class="token keyword">Error</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token keyword">If</span> e <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;Application-defined or object-defined error&quot;</span> <span class="token keyword">Then</span> Debug<span class="token punctuation">.</span>Print i <span class="token operator">&amp;</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">&amp;</span> e
    <span class="token keyword">Next</span> i
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>You can show the Immediate Window by:</p> <ul><li>Selecting <strong>V</strong>iew | <strong>I</strong>mmediate Window from the menu bar</li> <li>Using the keyboard shortcut <strong>Ctrl-G</strong></li></ul> <h2 id="use-timer-to-find-bottlenecks-in-performance"><a href="#use-timer-to-find-bottlenecks-in-performance" class="header-anchor">#</a> Use Timer to Find Bottlenecks in Performance</h2> <p>The first step in optimizing for speed is finding the slowest sections of code. The <code>Timer</code> VBA function returns the number of seconds elapsed since midnight with a precision of 1/256th of a second (3.90625 milliseconds) on Windows based PCs. The VBA functions <code>Now</code> and <code>Time</code> are only accurate to a second.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> start <span class="token keyword">As</span> <span class="token keyword">Double</span>       <span class="token comment">' Timer returns Single, but converting to Double to avoid </span>
start <span class="token operator">=</span> Timer             <span class="token comment">' scientific notation like 3.90625E-03 in the Immediate window</span>
<span class="token comment">' ... part of the code</span>
Debug<span class="token punctuation">.</span>Print Timer <span class="token operator">-</span> start; <span class="token string">&quot;seconds in part 1&quot;</span> 

start <span class="token operator">=</span> Timer
<span class="token comment">' ... another part of the code</span>
Debug<span class="token punctuation">.</span>Print Timer <span class="token operator">-</span> start; <span class="token string">&quot;seconds in part 2&quot;</span>

</code></pre></div><h2 id="debugger-locals-window"><a href="#debugger-locals-window" class="header-anchor">#</a> Debugger Locals Window</h2> <p>The Locals window provides easy access to the current value of variables and objects within the scope of the function or subroutine you are running. It is an essential tool to debugging your code and stepping through changes in order to find issues. It also allows you to explore properties you might not have known existed.</p> <p>Take the following example,</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Explicit
<span class="token keyword">Sub</span> LocalsWindowExample<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> findMeInLocals <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">Dim</span> findMEInLocals2 <span class="token keyword">As</span> Range
    
    findMeInLocals <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">Set</span> findMEInLocals2 <span class="token operator">=</span> ActiveWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>In the VBA Editor, click View  --&gt; Locals Window</p> <p><a href="http://i.stack.imgur.com/rT6Wf.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/rT6Wf.png" alt="Where locals menu is at on the window"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Then by stepping through the code using F8 after clicking inside the subroutine, we have stopped before getting to assigning findMeinLocals. Below you can see the value is 0 --- and this is what would be used if you never assigned it a value. The range object is 'Nothing'.</p> <p><a href="http://i.stack.imgur.com/B8vZt.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/B8vZt.png" alt="At this step the variables are nothing..."><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://i.stack.imgur.com/8smT0.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/8smT0.png" alt="Showing the variables are nothing."><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>If we stop right before the subroutine ends, we can see the final values of the variables.</p> <p><a href="http://i.stack.imgur.com/VE12u.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/VE12u.png" alt="Set a debug point... if you want"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>We can see findMeInLocals with a value of 1 and type of Integer, and FindMeInLocals2 with a type of Range/Range. If we click the + sign we can expand the object and see its properties, such as count or column.</p> <p><a href="http://i.stack.imgur.com/m7Rdu.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/m7Rdu.png" alt="enter image description here"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="stop"><a href="#stop" class="header-anchor">#</a> Stop</h2> <p>The Stop command will pause the execution when called. From there, the process can be resumed or be executed step by step.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> Test<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> TestVar <span class="token keyword">as</span> <span class="token keyword">String</span>
    TestVar <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span>
    <span class="token keyword">Stop</span>                    <span class="token comment">'Sub will be executed to this point and then wait for the user</span>
    MsgBox TestVar
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="adding-a-breakpoint-to-your-code"><a href="#adding-a-breakpoint-to-your-code" class="header-anchor">#</a> Adding a Breakpoint to your code</h2> <p>You can easily add a breakpoint to your code by clicking on the grey column to the left of the line of your VBA code where you want execution to stop. A red dot appears in the column and the breakpoint code is also highlighted in red.</p> <p>You can add multiple breakpoints throughout your code and resuming execution is achieved by pressing the &quot;play&quot; icon in your menu bar.  Not all code can be a breakpoint as variable definition lines, the first or last line of a procedure and comment lines cannot be selected as a breakpoint.</p> <p><a href="http://i.stack.imgur.com/AJUpD.jpg" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/AJUpD.jpg" alt="enter image description here"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li>Debug.Print(string)</li> <li>Stop() / Stop</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/excelvba/debugging-and-troubleshooting.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/excelvba/vba-security.html" class="prev">
        VBA Security
      </a></span> <span class="next"><a href="/excelvba/vba-best-practices.html">
        VBA Best Practices
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/1079.f0af53b2.js" defer></script>
  </body>
</html>
