<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Excel VBA - Methods for Finding the Last Used Row or Column in a Worksheet</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Find the Last Non-Empty Cell in a Column, Find the Last Non-Empty Row in Worksheet, Find the Last Non-Empty Column in Worksheet, Find the Last Non-Empty Cell in a Row, Find Last Row Using Named Range, Get the row of the last cell in a range, Last cell in Range.CurrentRegion, Find the Last Non-Empty Cell in Worksheet - Performance (Array)">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Excel VBA - Methods for Finding the Last Used Row or Column in a Worksheet">
    <meta property="og:description" content="Find the Last Non-Empty Cell in a Column, Find the Last Non-Empty Row in Worksheet, Find the Last Non-Empty Column in Worksheet, Find the Last Non-Empty Cell in a Row, Find Last Row Using Named Range, Get the row of the last cell in a range, Last cell in Range.CurrentRegion, Find the Last Non-Empty Cell in Worksheet - Performance (Array)">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Excel VBA - Methods for Finding the Last Used Row or Column in a Worksheet">
    <meta name="twitter:description" content="Find the Last Non-Empty Cell in a Column, Find the Last Non-Empty Row in Worksheet, Find the Last Non-Empty Column in Worksheet, Find the Last Non-Empty Cell in a Row, Find Last Row Using Named Range, Get the row of the last cell in a range, Last cell in Range.CurrentRegion, Find the Last Non-Empty Cell in Worksheet - Performance (Array)">
    <meta name="twitter:url" content="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/1088.182e9464.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Excel VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/excelvba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/excelvba/getting-started-with-excel-vba.html" class="sidebar-link">Getting started with excel-vba</a></li><li><a href="/excelvba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/excelvba/conditional-statements.html" class="sidebar-link">Conditional statements</a></li><li><a href="/excelvba/ranges-and-cells.html" class="sidebar-link">Ranges and Cells</a></li><li><a href="/excelvba/named-ranges.html" class="sidebar-link">Named Ranges</a></li><li><a href="/excelvba/merged-cells-ranges.html" class="sidebar-link">Merged Cells / Ranges</a></li><li><a href="/excelvba/locating-duplicate-values-in-a-range.html" class="sidebar-link">Locating duplicate values in a range</a></li><li><a href="/excelvba/user-defined-functions-udfs.html" class="sidebar-link">User Defined Functions (UDFs)</a></li><li><a href="/excelvba/conditional-formatting-using-vba.html" class="sidebar-link">Conditional formatting using VBA</a></li><li><a href="/excelvba/workbooks.html" class="sidebar-link">Workbooks</a></li><li><a href="/excelvba/working-with-excel-tables-in-vba.html" class="sidebar-link">Working with Excel Tables in VBA</a></li><li><a href="/excelvba/loop-through-all-sheets-in-active-workbook.html" class="sidebar-link">Loop through all Sheets in Active Workbook</a></li><li><a href="/excelvba/use-worksheet-object-and-not-sheet-object.html" class="sidebar-link">Use Worksheet object and not Sheet object</a></li><li><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html" aria-current="page" class="active sidebar-link">Methods for Finding the Last Used Row or Column in a Worksheet</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html#find-the-last-non-empty-cell-in-a-column" class="sidebar-link">Find the Last Non-Empty Cell in a Column</a></li><li class="sidebar-sub-header"><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html#find-the-last-non-empty-row-in-worksheet" class="sidebar-link">Find the Last Non-Empty Row in Worksheet</a></li><li class="sidebar-sub-header"><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html#find-the-last-non-empty-column-in-worksheet" class="sidebar-link">Find the Last Non-Empty Column in Worksheet</a></li><li class="sidebar-sub-header"><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html#find-the-last-non-empty-cell-in-a-row" class="sidebar-link">Find the Last Non-Empty Cell in a Row</a></li><li class="sidebar-sub-header"><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html#find-last-row-using-named-range" class="sidebar-link">Find Last Row Using Named Range</a></li><li class="sidebar-sub-header"><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html#get-the-row-of-the-last-cell-in-a-range" class="sidebar-link">Get the row of the last cell in a range</a></li><li class="sidebar-sub-header"><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html#last-cell-in-range-currentregion" class="sidebar-link">Last cell in Range.CurrentRegion</a></li><li class="sidebar-sub-header"><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html#find-the-last-non-empty-cell-in-worksheet-performance-array" class="sidebar-link">Find the Last Non-Empty Cell in Worksheet - Performance (Array)</a></li></ul></li><li><a href="/excelvba/creating-a-drop-down-menu-in-the-active-worksheet-with-a-combo-box.html" class="sidebar-link">Creating a drop-down menu in the Active Worksheet with a Combo Box</a></li><li><a href="/excelvba/file-system-object.html" class="sidebar-link">File System Object</a></li><li><a href="/excelvba/pivot-tables.html" class="sidebar-link">Pivot Tables</a></li><li><a href="/excelvba/binding.html" class="sidebar-link">Binding</a></li><li><a href="/excelvba/autofilter-uses-and-best-practices.html" class="sidebar-link">autofilter ; Uses and best practices</a></li><li><a href="/excelvba/application-object.html" class="sidebar-link">Application object</a></li><li><a href="/excelvba/charts-and-charting.html" class="sidebar-link">Charts and Charting</a></li><li><a href="/excelvba/customdocumentproperties-in-practice.html" class="sidebar-link">CustomDocumentProperties in practice</a></li><li><a href="/excelvba/powerpoint-integration-through-vba.html" class="sidebar-link">PowerPoint Integration Through VBA</a></li><li><a href="/excelvba/how-to-record-a-macro.html" class="sidebar-link">How to record a Macro</a></li><li><a href="/excelvba/sql-in-excel-vba-best-practices.html" class="sidebar-link">SQL in Excel VBA - Best Practices</a></li><li><a href="/excelvba/excel-vba-optimization.html" class="sidebar-link">Excel-VBA Optimization</a></li><li><a href="/excelvba/vba-security.html" class="sidebar-link">VBA Security</a></li><li><a href="/excelvba/debugging-and-troubleshooting.html" class="sidebar-link">Debugging and Troubleshooting</a></li><li><a href="/excelvba/vba-best-practices.html" class="sidebar-link">VBA Best Practices</a></li><li><a href="/excelvba/excel-vba-tips-and-tricks.html" class="sidebar-link">Excel VBA Tips and Tricks</a></li><li><a href="/excelvba/common-mistakes.html" class="sidebar-link">Common Mistakes</a></li><li><a href="/excelvba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="methods-for-finding-the-last-used-row-or-column-in-a-worksheet"><a href="#methods-for-finding-the-last-used-row-or-column-in-a-worksheet" class="header-anchor">#</a> Methods for Finding the Last Used Row or Column in a Worksheet</h1> <h2 id="find-the-last-non-empty-cell-in-a-column"><a href="#find-the-last-non-empty-cell-in-a-column" class="header-anchor">#</a> Find the Last Non-Empty Cell in a Column</h2> <p>In this example, we will look at a method for returning the last non-empty row in a column for a data set.</p> <p>This method will work regardless of empty regions within the data set.</p> <p>However <strong><strong>caution</strong> should be used if <strong>merged cells</strong> are involved</strong>, as the <code>End</code> method will be &quot;stopped&quot; against a merged region, returning the first cell of the merged region.</p> <p>In addition non-empty cells in <strong><strong>hidden rows</strong></strong> will not be taken into account.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> FindingLastRow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> wS <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> LastRow <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Set</span> wS <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Worksheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span>
    
    <span class="token comment">'Here we look in Column A</span>
    LastRow <span class="token operator">=</span> wS<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>wS<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
    Debug<span class="token punctuation">.</span>Print LastRow
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>To address the limitations indicated above, the line:
<br><code>LastRow = wS.Cells(wS.Rows.Count, &quot;A&quot;).End(xlUp).Row</code></p> <p>may be replaced with:</p> <li><p>for last used row of `&quot;Sheet1&quot;`:
<br>`LastRow = wS.UsedRange.Row - 1 + wS.UsedRange.Rows.Count`.</p></li> <li>
for last non-empty cell of Column `&quot;A&quot;` in `&quot;Sheet1&quot;`:
<div class="language-vb extra-class"><pre class="language-vb"><code> <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
 <span class="token keyword">For</span> i <span class="token operator">=</span> LastRow <span class="token keyword">To</span> <span class="token number">1</span> <span class="token keyword">Step</span> <span class="token operator">-</span><span class="token number">1</span>
     <span class="token keyword">If</span> <span class="token keyword">Not</span> <span class="token punctuation">(</span>IsEmpty<span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">Then</span> <span class="token keyword">Exit</span> <span class="token keyword">For</span>
 <span class="token keyword">Next</span> i
 LastRow <span class="token operator">=</span> i

</code></pre></div></li> <h2 id="find-the-last-non-empty-row-in-worksheet"><a href="#find-the-last-non-empty-row-in-worksheet" class="header-anchor">#</a> Find the Last Non-Empty Row in Worksheet</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Get_Last_Used_Row_Index<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> wS <span class="token keyword">As</span> Worksheet
    
    <span class="token keyword">Set</span> wS <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print LastRow_1<span class="token punctuation">(</span>wS<span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print LastRow_0<span class="token punctuation">(</span>wS<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>You can choose between 2 options,
regarding if you want to know if there is no data in the worksheet :</p> <ul><li>NO : Use LastRow_1 : You can use it directly within <code>wS.Cells(LastRow_1(wS),...)</code></li> <li>YES : Use LastRow_0 : You need to test if the result you get from the function is 0 or not before using it</li></ul> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Function</span> LastRow_1<span class="token punctuation">(</span>wS <span class="token keyword">As</span> Worksheet<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Double</span>
    <span class="token keyword">With</span> wS
        <span class="token keyword">If</span> Application<span class="token punctuation">.</span>WorksheetFunction<span class="token punctuation">.</span>CountA<span class="token punctuation">(</span><span class="token punctuation">.</span>Cells<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
            LastRow_1 <span class="token operator">=</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Find<span class="token punctuation">(</span>What<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span> <span class="token operator">_</span>
                                After<span class="token punctuation">:</span><span class="token operator">=</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">_</span>
                                Lookat<span class="token punctuation">:</span><span class="token operator">=</span>xlPart<span class="token punctuation">,</span> <span class="token operator">_</span>
                                LookIn<span class="token punctuation">:</span><span class="token operator">=</span>xlFormulas<span class="token punctuation">,</span> <span class="token operator">_</span>
                                SearchOrder<span class="token punctuation">:</span><span class="token operator">=</span>xlByRows<span class="token punctuation">,</span> <span class="token operator">_</span>
                                SearchDirection<span class="token punctuation">:</span><span class="token operator">=</span>xlPrevious<span class="token punctuation">,</span> <span class="token operator">_</span>
                                MatchCase<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Row
        <span class="token keyword">Else</span>
            LastRow_1 <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

<span class="token keyword">Public</span> <span class="token keyword">Function</span> LastRow_0<span class="token punctuation">(</span>wS <span class="token keyword">As</span> Worksheet<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Double</span>
    <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
    LastRow_0 <span class="token operator">=</span> wS<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Find<span class="token punctuation">(</span>What<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span> <span class="token operator">_</span>
                            After<span class="token punctuation">:</span><span class="token operator">=</span>ws<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">_</span>
                            Lookat<span class="token punctuation">:</span><span class="token operator">=</span>xlPart<span class="token punctuation">,</span> <span class="token operator">_</span>
                            LookIn<span class="token punctuation">:</span><span class="token operator">=</span>xlFormulas<span class="token punctuation">,</span> <span class="token operator">_</span>
                            SearchOrder<span class="token punctuation">:</span><span class="token operator">=</span>xlByRows<span class="token punctuation">,</span> <span class="token operator">_</span>
                            SearchDirection<span class="token punctuation">:</span><span class="token operator">=</span>xlPrevious<span class="token punctuation">,</span> <span class="token operator">_</span>
                            MatchCase<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Row
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><h2 id="find-the-last-non-empty-column-in-worksheet"><a href="#find-the-last-non-empty-column-in-worksheet" class="header-anchor">#</a> Find the Last Non-Empty Column in Worksheet</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Get_Last_Used_Row_Index<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> wS <span class="token keyword">As</span> Worksheet
    
    <span class="token keyword">Set</span> wS <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print LastCol_1<span class="token punctuation">(</span>wS<span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print LastCol_0<span class="token punctuation">(</span>wS<span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>You can choose between 2 options,
regarding if you want to know if there is no data in the worksheet :</p> <ul><li>NO : Use LastCol_1 : You can use it directly within <code>wS.Cells(...,LastCol_1(wS))</code></li> <li>YES : Use LastCol_0 : You need to test if the result you get from the function is 0 or not before using it</li></ul> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Function</span> LastCol_1<span class="token punctuation">(</span>wS <span class="token keyword">As</span> Worksheet<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Double</span>
    <span class="token keyword">With</span> wS
        <span class="token keyword">If</span> Application<span class="token punctuation">.</span>WorksheetFunction<span class="token punctuation">.</span>CountA<span class="token punctuation">(</span><span class="token punctuation">.</span>Cells<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
            LastCol_1 <span class="token operator">=</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Find<span class="token punctuation">(</span>What<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span> <span class="token operator">_</span>
                                After<span class="token punctuation">:</span><span class="token operator">=</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">_</span>
                                Lookat<span class="token punctuation">:</span><span class="token operator">=</span>xlPart<span class="token punctuation">,</span> <span class="token operator">_</span>
                                LookIn<span class="token punctuation">:</span><span class="token operator">=</span>xlFormulas<span class="token punctuation">,</span> <span class="token operator">_</span>
                                SearchOrder<span class="token punctuation">:</span><span class="token operator">=</span>xlByColumns<span class="token punctuation">,</span> <span class="token operator">_</span>
                                SearchDirection<span class="token punctuation">:</span><span class="token operator">=</span>xlPrevious<span class="token punctuation">,</span> <span class="token operator">_</span>
                                MatchCase<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Column
        <span class="token keyword">Else</span>
            LastCol_1 <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><p>The Err object's properties are automatically reset to zero upon function exit.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Function</span> LastCol_0<span class="token punctuation">(</span>wS <span class="token keyword">As</span> Worksheet<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Double</span>
    <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
    LastCol_0 <span class="token operator">=</span> wS<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Find<span class="token punctuation">(</span>What<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span> <span class="token operator">_</span>
                            After<span class="token punctuation">:</span><span class="token operator">=</span>ws<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">_</span>
                            Lookat<span class="token punctuation">:</span><span class="token operator">=</span>xlPart<span class="token punctuation">,</span> <span class="token operator">_</span>
                            LookIn<span class="token punctuation">:</span><span class="token operator">=</span>xlFormulas<span class="token punctuation">,</span> <span class="token operator">_</span>
                            SearchOrder<span class="token punctuation">:</span><span class="token operator">=</span>xlByColumns<span class="token punctuation">,</span> <span class="token operator">_</span>
                            SearchDirection<span class="token punctuation">:</span><span class="token operator">=</span>xlPrevious<span class="token punctuation">,</span> <span class="token operator">_</span>
                            MatchCase<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Column
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><h2 id="find-the-last-non-empty-cell-in-a-row"><a href="#find-the-last-non-empty-cell-in-a-row" class="header-anchor">#</a> Find the Last Non-Empty Cell in a Row</h2> <p>In this example, we will look at a method for returning the last non-empty column in a row.</p> <p>This method will work regardless of empty regions within the data set.</p> <p>However <strong><strong>caution</strong> should be used if <strong>merged cells</strong> are involved</strong>, as the <code>End</code> method will be &quot;stopped&quot; against a merged region, returning the first cell of the merged region.</p> <p>In addition non-empty cells in <strong><strong>hidden columns</strong></strong> will not be taken into account.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> FindingLastCol<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> wS <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> LastCol <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Set</span> wS <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Worksheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span>
    
    <span class="token comment">'Here we look in Row 1</span>
    LastCol <span class="token operator">=</span> wS<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> wS<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlToLeft<span class="token punctuation">)</span><span class="token punctuation">.</span>Column
    Debug<span class="token punctuation">.</span>Print LastCol
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="find-last-row-using-named-range"><a href="#find-last-row-using-named-range" class="header-anchor">#</a> Find Last Row Using Named Range</h2> <p>In case you have a Named Range in your Sheet, and you want to dynamically get the last row of that Dynamic Named Range.
Also covers cases where the Named Range doesn't start from the first Row.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> FindingLastRow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token keyword">Dim</span> sht <span class="token keyword">As</span> Worksheet
<span class="token keyword">Dim</span> LastRow <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Dim</span> FirstRow <span class="token keyword">As</span> <span class="token keyword">Long</span>

<span class="token keyword">Set</span> sht <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Worksheets<span class="token punctuation">(</span><span class="token string">&quot;form&quot;</span><span class="token punctuation">)</span>

<span class="token comment">'Using Named Range &quot;MyNameRange&quot;</span>
FirstRow <span class="token operator">=</span> sht<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;MyNameRange&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Row

<span class="token comment">' in case &quot;MyNameRange&quot; doesn't start at Row 1</span>
LastRow <span class="token operator">=</span> sht<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;MyNameRange&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count <span class="token operator">+</span> FirstRow <span class="token operator">-</span> <span class="token number">1</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>Update:
<br>A potential loophole was pointed out by @Jeeped for a a named range with non-contiguous rows as it generates unexpected result. To addresses that issue, the code is revised as below.
<br>Asumptions: targes sheet = <code>form</code>, named range = <code>MyNameRange</code></p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> FindingLastRow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> rw <span class="token keyword">As</span> Range<span class="token punctuation">,</span> rwMax <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> rw <span class="token keyword">In</span> Sheets<span class="token punctuation">(</span><span class="token string">&quot;form&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;MyNameRange&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Rows
        <span class="token keyword">If</span> rw<span class="token punctuation">.</span>Row <span class="token operator">&gt;</span> rwMax <span class="token keyword">Then</span> rwMax <span class="token operator">=</span> rw<span class="token punctuation">.</span>Row
    <span class="token keyword">Next</span>
    MsgBox <span class="token string">&quot;Last row of 'MyNameRange' under Sheets 'form': &quot;</span> <span class="token operator">&amp;</span> rwMax
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="get-the-row-of-the-last-cell-in-a-range"><a href="#get-the-row-of-the-last-cell-in-a-range" class="header-anchor">#</a> Get the row of the last cell in a range</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token comment">'if only one area (not multiple areas):</span>
<span class="token keyword">With</span> Range<span class="token punctuation">(</span><span class="token string">&quot;A3:D20&quot;</span><span class="token punctuation">)</span>
    Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>CountLarge<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
    Debug<span class="token punctuation">.</span>Print <span class="token punctuation">.</span>Item<span class="token punctuation">(</span><span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>CountLarge<span class="token punctuation">)</span><span class="token punctuation">.</span>Row <span class="token comment">'using .item is also possible</span>
<span class="token keyword">End</span> <span class="token keyword">With</span> <span class="token comment">'Debug prints: 20</span>

<span class="token comment">'with multiple areas (also works if only one area):</span>
<span class="token keyword">Dim</span> rngArea <span class="token keyword">As</span> Range<span class="token punctuation">,</span> LastRow <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">With</span> Range<span class="token punctuation">(</span><span class="token string">&quot;A3:D20, E5:I50, H20:R35&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> rngArea <span class="token keyword">In</span> <span class="token punctuation">.</span>Areas
        <span class="token keyword">If</span> rngArea<span class="token punctuation">(</span>rngArea<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>CountLarge<span class="token punctuation">)</span><span class="token punctuation">.</span>Row <span class="token operator">&gt;</span> LastRow <span class="token keyword">Then</span> 
            LastRow <span class="token operator">=</span> rngArea<span class="token punctuation">(</span>rngArea<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>CountLarge<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span>
    Debug<span class="token punctuation">.</span>Print LastRow <span class="token comment">'Debug prints: 50</span>
<span class="token keyword">End</span> <span class="token keyword">With</span>

</code></pre></div><h2 id="last-cell-in-range-currentregion"><a href="#last-cell-in-range-currentregion" class="header-anchor">#</a> Last cell in Range.CurrentRegion</h2> <p><a href="https://msdn.microsoft.com/en-us/library/office/ff196678.aspx" target="_blank" rel="noopener noreferrer"><code>Range.CurrentRegion</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is a rectangular range area surrounded by empty cells. Blank cells with formulas such as <code>=&quot;&quot;</code> or <code>'</code> are not considered blank (even by the <a href="https://support.microsoft.com/en-us/kb/823838" target="_blank" rel="noopener noreferrer"><code>ISBLANK</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> Excel function).</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> rng <span class="token keyword">As</span> Range<span class="token punctuation">,</span> lastCell <span class="token keyword">As</span> Range
<span class="token keyword">Set</span> rng <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;C3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>CurrentRegion       <span class="token comment">' or Set rng = Sheet1.UsedRange.CurrentRegion</span>
<span class="token keyword">Set</span> lastCell <span class="token operator">=</span> rng<span class="token punctuation">(</span>rng<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> rng<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span>Count<span class="token punctuation">)</span>

</code></pre></div><h2 id="find-the-last-non-empty-cell-in-worksheet-performance-array"><a href="#find-the-last-non-empty-cell-in-worksheet-performance-array" class="header-anchor">#</a> Find the Last Non-Empty Cell in Worksheet - Performance (Array)</h2> <ul><li>The first function, using an array, is <strong>much faster</strong></li> <li>If called without the optional parameter, will default to <code>.ThisWorkbook.ActiveSheet</code></li> <li>If the range is empty will returns <code>Cell( 1, 1 )</code> as default, instead of <code>Nothing</code></li></ul> <p>Speed:</p> <blockquote></blockquote> <p>`GetMaxCell (Array): Duration: 0.0000790063 seconds`<br>
`GetMaxCell (Find ): Duration: 0.0002903480 seconds`</p>
.Measured with [MicroTimer](https://msdn.microsoft.com/en-us/library/office/ff700515(v=office.14).aspx#Anchor_5)
<div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Function</span> GetLastCell<span class="token punctuation">(</span><span class="token keyword">Optional</span> <span class="token keyword">ByVal</span> ws <span class="token keyword">As</span> Worksheet <span class="token operator">=</span> <span class="token boolean">Nothing</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Range
    <span class="token keyword">Dim</span> uRng <span class="token keyword">As</span> Range<span class="token punctuation">,</span> uArr <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">,</span> r <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> c <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> ubR <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> ubC <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> lRow <span class="token keyword">As</span> <span class="token keyword">Long</span>

    <span class="token keyword">If</span> ws <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span> <span class="token keyword">Set</span> ws <span class="token operator">=</span> Application<span class="token punctuation">.</span>ThisWorkbook<span class="token punctuation">.</span>ActiveSheet
    <span class="token keyword">Set</span> uRng <span class="token operator">=</span> ws<span class="token punctuation">.</span>UsedRange
    uArr <span class="token operator">=</span> uRng
    <span class="token keyword">If</span> IsEmpty<span class="token punctuation">(</span>uArr<span class="token punctuation">)</span> <span class="token keyword">Then</span>
        <span class="token keyword">Set</span> GetLastCell <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token keyword">Exit</span> <span class="token keyword">Function</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">If</span> <span class="token keyword">Not</span> IsArray<span class="token punctuation">(</span>uArr<span class="token punctuation">)</span> <span class="token keyword">Then</span>
        <span class="token keyword">Set</span> GetLastCell <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>uRng<span class="token punctuation">.</span>Row<span class="token punctuation">,</span> uRng<span class="token punctuation">.</span>Column<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">Exit</span> <span class="token keyword">Function</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    ubR <span class="token operator">=</span> UBound<span class="token punctuation">(</span>uArr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  ubC <span class="token operator">=</span> UBound<span class="token punctuation">(</span>uArr<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">For</span> r <span class="token operator">=</span> ubR <span class="token keyword">To</span> <span class="token number">1</span> <span class="token keyword">Step</span> <span class="token operator">-</span><span class="token number">1</span>    <span class="token comment">'----------------------------------------------- last row</span>
        <span class="token keyword">For</span> c <span class="token operator">=</span> ubC <span class="token keyword">To</span> <span class="token number">1</span> <span class="token keyword">Step</span> <span class="token operator">-</span><span class="token number">1</span>
            <span class="token keyword">If</span> <span class="token keyword">Not</span> IsError<span class="token punctuation">(</span>uArr<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
                <span class="token keyword">If</span> Len<span class="token punctuation">(</span>Trim<span class="token operator">$</span><span class="token punctuation">(</span>uArr<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                    lRow <span class="token operator">=</span> r<span class="token punctuation">:</span>   <span class="token keyword">Exit</span> <span class="token keyword">For</span>
                <span class="token keyword">End</span> <span class="token keyword">If</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">Next</span>
        <span class="token keyword">If</span> lRow <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span> <span class="token keyword">Exit</span> <span class="token keyword">For</span>
    <span class="token keyword">Next</span>
    <span class="token keyword">If</span> lRow <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span> lRow <span class="token operator">=</span> ubR
    <span class="token keyword">For</span> c <span class="token operator">=</span> ubC <span class="token keyword">To</span> <span class="token number">1</span> <span class="token keyword">Step</span> <span class="token operator">-</span><span class="token number">1</span>    <span class="token comment">'----------------------------------------------- last col</span>
        <span class="token keyword">For</span> r <span class="token operator">=</span> lRow <span class="token keyword">To</span> <span class="token number">1</span> <span class="token keyword">Step</span> <span class="token operator">-</span><span class="token number">1</span>
            <span class="token keyword">If</span> <span class="token keyword">Not</span> IsError<span class="token punctuation">(</span>uArr<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
                <span class="token keyword">If</span> Len<span class="token punctuation">(</span>Trim<span class="token operator">$</span><span class="token punctuation">(</span>uArr<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                    <span class="token keyword">Set</span> GetLastCell <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>lRow <span class="token operator">+</span> uRng<span class="token punctuation">.</span>Row <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> c <span class="token operator">+</span> uRng<span class="token punctuation">.</span>Column <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token keyword">Exit</span> <span class="token keyword">Function</span>
                <span class="token keyword">End</span> <span class="token keyword">If</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">Next</span>
    <span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><div class="language-vb extra-class"><pre class="language-vb"><code><span class="token comment">'Returns last cell (max row &amp; max col) using Find</span>

<span class="token keyword">Public</span> <span class="token keyword">Function</span> GetMaxCell2<span class="token punctuation">(</span><span class="token keyword">Optional</span> <span class="token keyword">ByRef</span> rng <span class="token keyword">As</span> Range <span class="token operator">=</span> <span class="token boolean">Nothing</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Range <span class="token comment">'Using Find</span>

    <span class="token keyword">Const</span> NONEMPTY <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;*&quot;</span>

    <span class="token keyword">Dim</span> lRow <span class="token keyword">As</span> Range<span class="token punctuation">,</span> lCol <span class="token keyword">As</span> Range

    <span class="token keyword">If</span> rng <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span> <span class="token keyword">Set</span> rng <span class="token operator">=</span> Application<span class="token punctuation">.</span>ThisWorkbook<span class="token punctuation">.</span>ActiveSheet<span class="token punctuation">.</span>UsedRange

    <span class="token keyword">If</span> WorksheetFunction<span class="token punctuation">.</span>CountA<span class="token punctuation">(</span>rng<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
        <span class="token keyword">Set</span> GetMaxCell2 <span class="token operator">=</span> rng<span class="token punctuation">.</span>Parent<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">Else</span>
        <span class="token keyword">With</span> rng
            <span class="token keyword">Set</span> lRow <span class="token operator">=</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Find<span class="token punctuation">(</span>What<span class="token punctuation">:</span><span class="token operator">=</span>NONEMPTY<span class="token punctuation">,</span> LookIn<span class="token punctuation">:</span><span class="token operator">=</span>xlFormulas<span class="token punctuation">,</span> <span class="token operator">_</span>
                                        After<span class="token punctuation">:</span><span class="token operator">=</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">_</span>
                                        SearchDirection<span class="token punctuation">:</span><span class="token operator">=</span>xlPrevious<span class="token punctuation">,</span> <span class="token operator">_</span>
                                        SearchOrder<span class="token punctuation">:</span><span class="token operator">=</span>xlByRows<span class="token punctuation">)</span>
            <span class="token keyword">If</span> <span class="token keyword">Not</span> lRow <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span>
                <span class="token keyword">Set</span> lCol <span class="token operator">=</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Find<span class="token punctuation">(</span>What<span class="token punctuation">:</span><span class="token operator">=</span>NONEMPTY<span class="token punctuation">,</span> LookIn<span class="token punctuation">:</span><span class="token operator">=</span>xlFormulas<span class="token punctuation">,</span> <span class="token operator">_</span>
                                            After<span class="token punctuation">:</span><span class="token operator">=</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">_</span>
                                            SearchDirection<span class="token punctuation">:</span><span class="token operator">=</span>xlPrevious<span class="token punctuation">,</span> <span class="token operator">_</span>
                                            SearchOrder<span class="token punctuation">:</span><span class="token operator">=</span>xlByColumns<span class="token punctuation">)</span>

                <span class="token keyword">Set</span> GetMaxCell2 <span class="token operator">=</span> <span class="token punctuation">.</span>Parent<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>lRow<span class="token punctuation">.</span>Row<span class="token punctuation">,</span> lCol<span class="token punctuation">.</span>Column<span class="token punctuation">)</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">End</span> <span class="token keyword">With</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><p>.</p> <p><a href="https://msdn.microsoft.com/en-us/library/office/ff700515(v=office.14).aspx#Anchor_5" target="_blank" rel="noopener noreferrer">MicroTimer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> getFrequency <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;QueryPerformanceFrequency&quot;</span> <span class="token punctuation">(</span>cyFrequency <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> getTickCount <span class="token keyword">Lib</span> <span class="token string">&quot;Kernel32&quot;</span> <span class="token keyword">Alias</span> <span class="token string">&quot;QueryPerformanceCounter&quot;</span> <span class="token punctuation">(</span>cyTickCount <span class="token keyword">As</span> <span class="token keyword">Currency</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>

<span class="token keyword">Function</span> MicroTimer<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Double</span>
    <span class="token keyword">Dim</span> cyTicks1 <span class="token keyword">As</span> <span class="token keyword">Currency</span>
    <span class="token keyword">Static</span> cyFrequency <span class="token keyword">As</span> <span class="token keyword">Currency</span>

    MicroTimer <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">If</span> cyFrequency <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span> getFrequency cyFrequency        <span class="token comment">'Get frequency</span>
    getTickCount cyTicks1                                   <span class="token comment">'Get ticks</span>
    <span class="token keyword">If</span> cyFrequency <span class="token keyword">Then</span> MicroTimer <span class="token operator">=</span> cyTicks1 <span class="token operator">/</span> cyFrequency <span class="token comment">'Returns Seconds</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>You can find a good explanation on why other methods are discouraged/inaccurate here :
<a href="http://stackoverflow.com/a/11169920/4628637" target="_blank" rel="noopener noreferrer">http://stackoverflow.com/a/11169920/4628637<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/excelvba/use-worksheet-object-and-not-sheet-object.html" class="prev">
        Use Worksheet object and not Sheet object
      </a></span> <span class="next"><a href="/excelvba/creating-a-drop-down-menu-in-the-active-worksheet-with-a-combo-box.html">
        Creating a drop-down menu in the Active Worksheet with a Combo Box
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/1088.182e9464.js" defer></script>
  </body>
</html>
