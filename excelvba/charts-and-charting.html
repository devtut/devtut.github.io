<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Excel VBA - Charts and Charting</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Creating a Chart with Ranges and a Fixed Name, Creating an empty Chart, Create a Chart by Modifying the SERIES formula, Arranging Charts into a Grid">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Excel VBA - Charts and Charting">
    <meta property="og:description" content="Creating a Chart with Ranges and a Fixed Name, Creating an empty Chart, Create a Chart by Modifying the SERIES formula, Arranging Charts into a Grid">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/excelvba/charts-and-charting.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Excel VBA - Charts and Charting">
    <meta name="twitter:description" content="Creating a Chart with Ranges and a Fixed Name, Creating an empty Chart, Create a Chart by Modifying the SERIES formula, Arranging Charts into a Grid">
    <meta name="twitter:url" content="/excelvba/charts-and-charting.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/1070.bfba43e3.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Excel VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/excelvba/" class="sidebar-link">Disclaimer</a></li><li><a href="/excelvba/getting-started-with-excel-vba.html" class="sidebar-link">Getting started with excel-vba</a></li><li><a href="/excelvba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/excelvba/conditional-statements.html" class="sidebar-link">Conditional statements</a></li><li><a href="/excelvba/ranges-and-cells.html" class="sidebar-link">Ranges and Cells</a></li><li><a href="/excelvba/named-ranges.html" class="sidebar-link">Named Ranges</a></li><li><a href="/excelvba/merged-cells-ranges.html" class="sidebar-link">Merged Cells / Ranges</a></li><li><a href="/excelvba/locating-duplicate-values-in-a-range.html" class="sidebar-link">Locating duplicate values in a range</a></li><li><a href="/excelvba/user-defined-functions-udfs.html" class="sidebar-link">User Defined Functions (UDFs)</a></li><li><a href="/excelvba/conditional-formatting-using-vba.html" class="sidebar-link">Conditional formatting using VBA</a></li><li><a href="/excelvba/workbooks.html" class="sidebar-link">Workbooks</a></li><li><a href="/excelvba/working-with-excel-tables-in-vba.html" class="sidebar-link">Working with Excel Tables in VBA</a></li><li><a href="/excelvba/loop-through-all-sheets-in-active-workbook.html" class="sidebar-link">Loop through all Sheets in Active Workbook</a></li><li><a href="/excelvba/use-worksheet-object-and-not-sheet-object.html" class="sidebar-link">Use Worksheet object and not Sheet object</a></li><li><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html" class="sidebar-link">Methods for Finding the Last Used Row or Column in a Worksheet</a></li><li><a href="/excelvba/creating-a-drop-down-menu-in-the-active-worksheet-with-a-combo-box.html" class="sidebar-link">Creating a drop-down menu in the Active Worksheet with a Combo Box</a></li><li><a href="/excelvba/file-system-object.html" class="sidebar-link">File System Object</a></li><li><a href="/excelvba/pivot-tables.html" class="sidebar-link">Pivot Tables</a></li><li><a href="/excelvba/binding.html" class="sidebar-link">Binding</a></li><li><a href="/excelvba/autofilter-uses-and-best-practices.html" class="sidebar-link">autofilter ; Uses and best practices</a></li><li><a href="/excelvba/application-object.html" class="sidebar-link">Application object</a></li><li><a href="/excelvba/charts-and-charting.html" class="active sidebar-link">Charts and Charting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excelvba/charts-and-charting.html#creating-a-chart-with-ranges-and-a-fixed-name" class="sidebar-link">Creating a Chart with Ranges and a Fixed Name</a></li><li class="sidebar-sub-header"><a href="/excelvba/charts-and-charting.html#creating-an-empty-chart" class="sidebar-link">Creating an empty Chart</a></li><li class="sidebar-sub-header"><a href="/excelvba/charts-and-charting.html#create-a-chart-by-modifying-the-series-formula" class="sidebar-link">Create a Chart by Modifying the SERIES formula</a></li><li class="sidebar-sub-header"><a href="/excelvba/charts-and-charting.html#arranging-charts-into-a-grid" class="sidebar-link">Arranging Charts into a Grid</a></li></ul></li><li><a href="/excelvba/customdocumentproperties-in-practice.html" class="sidebar-link">CustomDocumentProperties in practice</a></li><li><a href="/excelvba/powerpoint-integration-through-vba.html" class="sidebar-link">PowerPoint Integration Through VBA</a></li><li><a href="/excelvba/how-to-record-a-macro.html" class="sidebar-link">How to record a Macro</a></li><li><a href="/excelvba/sql-in-excel-vba-best-practices.html" class="sidebar-link">SQL in Excel VBA - Best Practices</a></li><li><a href="/excelvba/excel-vba-optimization.html" class="sidebar-link">Excel-VBA Optimization</a></li><li><a href="/excelvba/vba-security.html" class="sidebar-link">VBA Security</a></li><li><a href="/excelvba/debugging-and-troubleshooting.html" class="sidebar-link">Debugging and Troubleshooting</a></li><li><a href="/excelvba/vba-best-practices.html" class="sidebar-link">VBA Best Practices</a></li><li><a href="/excelvba/excel-vba-tips-and-tricks.html" class="sidebar-link">Excel VBA Tips and Tricks</a></li><li><a href="/excelvba/common-mistakes.html" class="sidebar-link">Common Mistakes</a></li><li><a href="/excelvba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="charts-and-charting"><a href="#charts-and-charting" class="header-anchor">#</a> Charts and Charting</h1> <h2 id="creating-a-chart-with-ranges-and-a-fixed-name"><a href="#creating-a-chart-with-ranges-and-a-fixed-name" class="header-anchor">#</a> Creating a Chart with Ranges and a Fixed Name</h2> <p>Charts can be created by working directly with the <code>Series</code> object that defines the chart data.  In order to get to the <code>Series</code> without an exisitng chart, you create a <code>ChartObject</code> on a given <code>Worksheet</code> and then get the <code>Chart</code> object from it.  The upside of working with the <code>Series</code> object is that you can set the <code>Values</code> and <code>XValues</code> by referring to <code>Range</code> objects.  These data properties will properly define the <code>Series</code> with references to those ranges.  The downside to this approach is that the same conversion is not handled when setting the <code>Name</code>; it is a fixed value.  It will not adjust with the underlying data in the original <code>Range</code>.  Checking the <code>SERIES</code> formula and it is obvious that the name is fixed.  This must be handled by creating the <code>SERIES</code> formula directly.</p> <p><strong>Code used to create chart</strong></p> <p>Note that this code contains extra variable declarations for the <code>Chart</code> and <code>Worksheet</code>. These can be omitted if they're not used.  They can be useful however if you are modifying the style or any other chart properties.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> CreateChartWithRangesAndFixedName<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> xData <span class="token keyword">As</span> Range
    <span class="token keyword">Dim</span> yData <span class="token keyword">As</span> Range
    <span class="token keyword">Dim</span> serName <span class="token keyword">As</span> Range
    
    <span class="token comment">'set the ranges to get the data and y value label</span>
    <span class="token keyword">Set</span> xData <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;B3:B12&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> yData <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;C3:C12&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> serName <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;C2&quot;</span><span class="token punctuation">)</span>
    
    <span class="token comment">'get reference to ActiveSheet</span>
    <span class="token keyword">Dim</span> sht <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Set</span> sht <span class="token operator">=</span> ActiveSheet
    
    <span class="token comment">'create a new ChartObject at position (48, 195) with width 400 and height 300</span>
    <span class="token keyword">Dim</span> chtObj <span class="token keyword">As</span> ChartObject
    <span class="token keyword">Set</span> chtObj <span class="token operator">=</span> sht<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
    
    <span class="token comment">'get reference to chart object</span>
    <span class="token keyword">Dim</span> cht <span class="token keyword">As</span> Chart
    <span class="token keyword">Set</span> cht <span class="token operator">=</span> chtObj<span class="token punctuation">.</span>Chart
    
    <span class="token comment">'create the new series</span>
    <span class="token keyword">Dim</span> ser <span class="token keyword">As</span> Series
    <span class="token keyword">Set</span> ser <span class="token operator">=</span> cht<span class="token punctuation">.</span>SeriesCollection<span class="token punctuation">.</span>NewSeries
    
    ser<span class="token punctuation">.</span>Values <span class="token operator">=</span> yData
    ser<span class="token punctuation">.</span>XValues <span class="token operator">=</span> xData
    ser<span class="token punctuation">.</span>Name <span class="token operator">=</span> serName
    
    ser<span class="token punctuation">.</span>ChartType <span class="token operator">=</span> xlXYScatterLines

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p><strong>Original data/ranges and resulting <code>Chart</code> after code runs</strong></p> <p>Note that the <code>SERIES</code> formula includes a <code>&quot;B&quot;</code> for the series name instead of a reference to the <code>Range</code> that created it.</p> <p><a href="http://i.stack.imgur.com/w8BQR.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/w8BQR.png" alt="data and resulting chart"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="creating-an-empty-chart"><a href="#creating-an-empty-chart" class="header-anchor">#</a> Creating an empty Chart</h2> <p>The starting point for the vast majority of charting code is to create an empty <code>Chart</code>.  Note that this <code>Chart</code> is subject to the default chart template that is active and may not actually be empty (if the template has been modified).</p> <p>The key to the <code>ChartObject</code> is determining its location.  The syntax for the call is <code>ChartObjects.Add(Left, Top, Width, Height)</code>.  Once the <code>ChartObject</code> is created, you can use its <code>Chart</code> object to actually modify the chart.  The <code>ChartObject</code> behaves more like a <code>Shape</code> to position the chart on the sheet.</p> <p><strong>Code to create an empty chart</strong></p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> CreateEmptyChart<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment">'get reference to ActiveSheet</span>
    <span class="token keyword">Dim</span> sht <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Set</span> sht <span class="token operator">=</span> ActiveSheet
    
    <span class="token comment">'create a new ChartObject at position (0, 0) with width 400 and height 300</span>
    <span class="token keyword">Dim</span> chtObj <span class="token keyword">As</span> ChartObject
    <span class="token keyword">Set</span> chtObj <span class="token operator">=</span> sht<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
    
    <span class="token comment">'get refernce to chart object</span>
    <span class="token keyword">Dim</span> cht <span class="token keyword">As</span> Chart
    <span class="token keyword">Set</span> cht <span class="token operator">=</span> chtObj<span class="token punctuation">.</span>Chart
    
    <span class="token comment">'additional code to modify the empty chart</span>
    <span class="token comment">'...</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p><strong>Resulting Chart</strong></p> <p><a href="http://i.stack.imgur.com/4o2XW.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/4o2XW.png" alt="empty chart example"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="create-a-chart-by-modifying-the-series-formula"><a href="#create-a-chart-by-modifying-the-series-formula" class="header-anchor">#</a> Create a Chart by Modifying the SERIES formula</h2> <p>For complete control over a new <code>Chart</code> and <code>Series</code> object (especially for a dynamic <code>Series</code> name), you must resort to modifying the <code>SERIES</code> formula directly.  The process to set up the <code>Range</code> objects is straightforward and the main hurdle is simply the string building for the <code>SERIES</code> formula.</p> <p>The <code>SERIES</code> formula takes the following syntax:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token operator">=</span>SERIES<span class="token punctuation">(</span>Name<span class="token punctuation">,</span>XValues<span class="token punctuation">,</span>Values<span class="token punctuation">,</span>Order<span class="token punctuation">)</span>

</code></pre></div><p>These contents can be supplied as references or as array values for the data items.  <code>Order</code> represents the series position within the chart.  Note that the references to the data will not work unless they are fully qualified with the sheet name.  For an example of a working formula, click any existing series and check the formula bar.</p> <p><strong>Code to create a chart and set up data using the <code>SERIES</code> formula</strong></p> <p>Note that the string building to create the <code>SERIES</code> formula uses <code>.Address(,,,True)</code>.  This ensures that the <strong>external</strong> Range reference is used so that a fully qualified address with the sheet name is included.  You <strong>will get an error if the sheet name is excluded</strong>.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> CreateChartUsingSeriesFormula<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> xData <span class="token keyword">As</span> Range
    <span class="token keyword">Dim</span> yData <span class="token keyword">As</span> Range
    <span class="token keyword">Dim</span> serName <span class="token keyword">As</span> Range
    
    <span class="token comment">'set the ranges to get the data and y value label</span>
    <span class="token keyword">Set</span> xData <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;B3:B12&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> yData <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;C3:C12&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> serName <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;C2&quot;</span><span class="token punctuation">)</span>
    
    <span class="token comment">'get reference to ActiveSheet</span>
    <span class="token keyword">Dim</span> sht <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Set</span> sht <span class="token operator">=</span> ActiveSheet
    
    <span class="token comment">'create a new ChartObject at position (48, 195) with width 400 and height 300</span>
    <span class="token keyword">Dim</span> chtObj <span class="token keyword">As</span> ChartObject
    <span class="token keyword">Set</span> chtObj <span class="token operator">=</span> sht<span class="token punctuation">.</span>ChartObjects<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
    
    <span class="token comment">'get refernce to chart object</span>
    <span class="token keyword">Dim</span> cht <span class="token keyword">As</span> Chart
    <span class="token keyword">Set</span> cht <span class="token operator">=</span> chtObj<span class="token punctuation">.</span>Chart
    
    <span class="token comment">'create the new series</span>
    <span class="token keyword">Dim</span> ser <span class="token keyword">As</span> Series
    <span class="token keyword">Set</span> ser <span class="token operator">=</span> cht<span class="token punctuation">.</span>SeriesCollection<span class="token punctuation">.</span>NewSeries
    
    <span class="token comment">'set the SERIES formula</span>
    <span class="token comment">'=SERIES(name, xData, yData, plotOrder)</span>
    
    <span class="token keyword">Dim</span> formulaValue <span class="token keyword">As</span> <span class="token keyword">String</span>
    formulaValue <span class="token operator">=</span> <span class="token string">&quot;=SERIES(&quot;</span> <span class="token operator">&amp;</span> <span class="token operator">_</span>
        serName<span class="token punctuation">.</span>Address<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">&amp;</span> <span class="token operator">_</span>
        xData<span class="token punctuation">.</span>Address<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">&amp;</span> <span class="token operator">_</span>
        yData<span class="token punctuation">.</span>Address<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">&quot;,1)&quot;</span>
    
    ser<span class="token punctuation">.</span>Formula <span class="token operator">=</span> formulaValue
    ser<span class="token punctuation">.</span>ChartType <span class="token operator">=</span> xlXYScatterLines

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p><strong>Original data and resulting chart</strong></p> <p>Note that for this chart, the series name is properly set with a range to the desired cell.  This means that updates will propagate to the <code>Chart</code>.</p> <p><a href="http://i.stack.imgur.com/nIJsH.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/nIJsH.png" alt="data and chart from SERIES formula"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="arranging-charts-into-a-grid"><a href="#arranging-charts-into-a-grid" class="header-anchor">#</a> Arranging Charts into a Grid</h2> <p>A common chore with charts in Excel is standardizing the size and layout of multiple charts on a single sheet.  If done manually, you can hold down <kbd>ALT</kbd> while resizing or moving the chart to &quot;stick&quot; to cell boundaries.  This works for a couple charts, but a VBA approach is much simpler.</p> <p><strong>Code to create a grid</strong></p> <p>This code will create a grid of charts starting at a given (Top, Left) position, with a defined number of columns, and a defined common chart size.  The charts will be placed in the order they were created and wrap around the edge to form a new row.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> CreateGridOfCharts<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> int_cols <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    int_cols <span class="token operator">=</span> <span class="token number">3</span>
    
    <span class="token keyword">Dim</span> cht_width <span class="token keyword">As</span> <span class="token keyword">Double</span>
    cht_width <span class="token operator">=</span> <span class="token number">250</span>
        
    <span class="token keyword">Dim</span> cht_height <span class="token keyword">As</span> <span class="token keyword">Double</span>
    cht_height <span class="token operator">=</span> <span class="token number">200</span>
    
    <span class="token keyword">Dim</span> offset_vertical <span class="token keyword">As</span> <span class="token keyword">Double</span>
    offset_vertical <span class="token operator">=</span> <span class="token number">195</span>
    
    <span class="token keyword">Dim</span> offset_horz <span class="token keyword">As</span> <span class="token keyword">Double</span>
    offset_horz <span class="token operator">=</span> <span class="token number">40</span>

    <span class="token keyword">Dim</span> sht <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Set</span> sht <span class="token operator">=</span> ActiveSheet

    <span class="token keyword">Dim</span> count <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    count <span class="token operator">=</span> <span class="token number">0</span>
    
    <span class="token comment">'iterate through ChartObjects on current sheet</span>
    <span class="token keyword">Dim</span> cht_obj <span class="token keyword">As</span> ChartObject
    <span class="token keyword">For</span> <span class="token keyword">Each</span> cht_obj <span class="token keyword">In</span> sht<span class="token punctuation">.</span>ChartObjects
        
        <span class="token comment">'use integer division and Mod to get position in grid</span>
        cht_obj<span class="token punctuation">.</span>Top <span class="token operator">=</span> <span class="token punctuation">(</span>count <span class="token operator">\</span> int_cols<span class="token punctuation">)</span> <span class="token operator">*</span> cht_height <span class="token operator">+</span> offset_vertical
        cht_obj<span class="token punctuation">.</span>Left <span class="token operator">=</span> <span class="token punctuation">(</span>count <span class="token keyword">Mod</span> int_cols<span class="token punctuation">)</span> <span class="token operator">*</span> cht_width <span class="token operator">+</span> offset_horz
        cht_obj<span class="token punctuation">.</span>Width <span class="token operator">=</span> cht_width
        cht_obj<span class="token punctuation">.</span>Height <span class="token operator">=</span> cht_height

        count <span class="token operator">=</span> count <span class="token operator">+</span> <span class="token number">1</span>

    <span class="token keyword">Next</span> cht_obj
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p><strong>Result with several charts</strong></p> <p>These pictures show the original random layout of charts and the resulting grid from running the code above.</p> <p><strong>Before</strong></p> <p><a href="http://i.stack.imgur.com/aJeuu.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/aJeuu.png" alt="before image of several charts"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><strong>After</strong></p> <p><a href="http://i.stack.imgur.com/naXcW.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/naXcW.png" alt="grid of charts"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/excelvba/charts-and-charting.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/excelvba/application-object.html" class="prev">
        Application object
      </a></span> <span class="next"><a href="/excelvba/customdocumentproperties-in-practice.html">
        CustomDocumentProperties in practice
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/1070.bfba43e3.js" defer></script>
  </body>
</html>
