<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Excel VBA - autofilter ; Uses and best practices</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Smartfilter!">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Excel VBA - autofilter ; Uses and best practices">
    <meta property="og:description" content="Smartfilter!">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/excelvba/autofilter-uses-and-best-practices.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Excel VBA - autofilter ; Uses and best practices">
    <meta name="twitter:description" content="Smartfilter!">
    <meta name="twitter:url" content="/excelvba/autofilter-uses-and-best-practices.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/1070.2cc17f6c.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Excel VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/excelvba/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/excelvba/getting-started-with-excel-vba.html" class="sidebar-link">Getting started with excel-vba</a></li><li><a href="/excelvba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/excelvba/conditional-statements.html" class="sidebar-link">Conditional statements</a></li><li><a href="/excelvba/ranges-and-cells.html" class="sidebar-link">Ranges and Cells</a></li><li><a href="/excelvba/named-ranges.html" class="sidebar-link">Named Ranges</a></li><li><a href="/excelvba/merged-cells-ranges.html" class="sidebar-link">Merged Cells / Ranges</a></li><li><a href="/excelvba/locating-duplicate-values-in-a-range.html" class="sidebar-link">Locating duplicate values in a range</a></li><li><a href="/excelvba/user-defined-functions-udfs.html" class="sidebar-link">User Defined Functions (UDFs)</a></li><li><a href="/excelvba/conditional-formatting-using-vba.html" class="sidebar-link">Conditional formatting using VBA</a></li><li><a href="/excelvba/workbooks.html" class="sidebar-link">Workbooks</a></li><li><a href="/excelvba/working-with-excel-tables-in-vba.html" class="sidebar-link">Working with Excel Tables in VBA</a></li><li><a href="/excelvba/loop-through-all-sheets-in-active-workbook.html" class="sidebar-link">Loop through all Sheets in Active Workbook</a></li><li><a href="/excelvba/use-worksheet-object-and-not-sheet-object.html" class="sidebar-link">Use Worksheet object and not Sheet object</a></li><li><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html" class="sidebar-link">Methods for Finding the Last Used Row or Column in a Worksheet</a></li><li><a href="/excelvba/creating-a-drop-down-menu-in-the-active-worksheet-with-a-combo-box.html" class="sidebar-link">Creating a drop-down menu in the Active Worksheet with a Combo Box</a></li><li><a href="/excelvba/file-system-object.html" class="sidebar-link">File System Object</a></li><li><a href="/excelvba/pivot-tables.html" class="sidebar-link">Pivot Tables</a></li><li><a href="/excelvba/binding.html" class="sidebar-link">Binding</a></li><li><a href="/excelvba/autofilter-uses-and-best-practices.html" aria-current="page" class="active sidebar-link">autofilter ; Uses and best practices</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excelvba/autofilter-uses-and-best-practices.html#smartfilter" class="sidebar-link">Smartfilter!</a></li></ul></li><li><a href="/excelvba/application-object.html" class="sidebar-link">Application object</a></li><li><a href="/excelvba/charts-and-charting.html" class="sidebar-link">Charts and Charting</a></li><li><a href="/excelvba/customdocumentproperties-in-practice.html" class="sidebar-link">CustomDocumentProperties in practice</a></li><li><a href="/excelvba/powerpoint-integration-through-vba.html" class="sidebar-link">PowerPoint Integration Through VBA</a></li><li><a href="/excelvba/how-to-record-a-macro.html" class="sidebar-link">How to record a Macro</a></li><li><a href="/excelvba/sql-in-excel-vba-best-practices.html" class="sidebar-link">SQL in Excel VBA - Best Practices</a></li><li><a href="/excelvba/excel-vba-optimization.html" class="sidebar-link">Excel-VBA Optimization</a></li><li><a href="/excelvba/vba-security.html" class="sidebar-link">VBA Security</a></li><li><a href="/excelvba/debugging-and-troubleshooting.html" class="sidebar-link">Debugging and Troubleshooting</a></li><li><a href="/excelvba/vba-best-practices.html" class="sidebar-link">VBA Best Practices</a></li><li><a href="/excelvba/excel-vba-tips-and-tricks.html" class="sidebar-link">Excel VBA Tips and Tricks</a></li><li><a href="/excelvba/common-mistakes.html" class="sidebar-link">Common Mistakes</a></li><li><a href="/excelvba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="autofilter-uses-and-best-practices"><a href="#autofilter-uses-and-best-practices" class="header-anchor">#</a> autofilter ; Uses and best practices</h1> <p><strong><strong>Autofilter</strong></strong> ultimate goal is to provide in the quickest way possible data mining from hundreds or thousands of rows data in order to get the attention in the items we want to focus on. It can receive parameters such as &quot;text/values/colors&quot; and they can be stacked among columns. You may connect up to 2 criteria per column based in logical connectors and sets of rules. Remark: Autofilter works by filtering rows, there is no Autofilter to filter columns (at least not natively).</p> <h2 id="smartfilter"><a href="#smartfilter" class="header-anchor">#</a> Smartfilter!</h2> <p><strong><strong>Problem situation</strong></strong> <br>Warehouse administrator has a sheet (&quot;Record&quot;) where every logistics movement performed by the facility is stored, he may filter as needed, although, this is very time consuming and he would like to improve the process in order to calculate inquiries faster, for example: How many &quot;pulp&quot; do we have now (in all racks)? How many pulp do we have now (in rack #5)? Filters are a great tool but, they are somewhat limited to answer these kind of question in matter of seconds.
<a href="https://i.stack.imgur.com/cob3v.png" target="_blank" rel="noopener noreferrer"><img src="https://i.stack.imgur.com/cob3v.png" alt="Record Sheet"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong><strong>Macro solution:</strong></strong> <br>The coder knows that <strong><strong>autofilters are the best, fast and most reliable solution</strong></strong> in these kind of scenarios since <strong><strong>the data exists already in the worksheet</strong></strong> and the <strong><strong>input for them can be obtained easily</strong></strong> -in this case, by user input-.
<br>The approach used is to create a sheet called &quot;SmartFilter&quot; where administrator can
easily filter multiple data as needed and calculation will be performed instantly as well.
<br>He uses 2 modules and the <code>Worksheet_Change</code> event for this matter</p> <p><br>Code For SmartFilter Worksheet:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_Change<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
<span class="token keyword">Dim</span> ItemInRange <span class="token keyword">As</span> Range
<span class="token keyword">Const</span> CellsFilters <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;C2,E2,G2&quot;</span>
    <span class="token keyword">Call</span> ExcelBusy
    <span class="token keyword">For</span> <span class="token keyword">Each</span> ItemInRange <span class="token keyword">In</span> Target
    <span class="token keyword">If</span> <span class="token keyword">Not</span> Intersect<span class="token punctuation">(</span>ItemInRange<span class="token punctuation">,</span> Range<span class="token punctuation">(</span>CellsFilters<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span> <span class="token keyword">Call</span> Inventory_Filter
    <span class="token keyword">Next</span> ItemInRange
    <span class="token keyword">Call</span> ExcelNormal
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>Code for module 1, called &quot;General_Functions&quot;</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> ExcelNormal<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">With</span> Excel<span class="token punctuation">.</span>Application
        <span class="token punctuation">.</span>EnableEvents <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Cursor <span class="token operator">=</span> xlDefault
        <span class="token punctuation">.</span>ScreenUpdating <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>StatusBar <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token punctuation">.</span>CopyObjectsWithCells <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> ExcelBusy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">With</span> Excel<span class="token punctuation">.</span>Application
        <span class="token punctuation">.</span>EnableEvents <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token punctuation">.</span>Cursor <span class="token operator">=</span> xlWait
        <span class="token punctuation">.</span>ScreenUpdating <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token punctuation">.</span>StatusBar <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token punctuation">.</span>CopyObjectsWithCells <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Sub</span> Select_Sheet<span class="token punctuation">(</span>NameSheet <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">Optional</span> VerifyExistanceOnly <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span>
    <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">GoTo</span> Err01Select_Sheet
    Sheets<span class="token punctuation">(</span>NameSheet<span class="token punctuation">)</span><span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token keyword">If</span> VerifyExistanceOnly <span class="token operator">=</span> <span class="token boolean">False</span> <span class="token keyword">Then</span> <span class="token comment">' 1. If VerifyExistanceOnly = False</span>
    Sheets<span class="token punctuation">(</span>NameSheet<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
    Sheets<span class="token punctuation">(</span>NameSheet<span class="token punctuation">)</span><span class="token punctuation">.</span>AutoFilterMode <span class="token operator">=</span> <span class="token boolean">False</span>
    Sheets<span class="token punctuation">(</span>NameSheet<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>EntireRow<span class="token punctuation">.</span>Hidden <span class="token operator">=</span> <span class="token boolean">False</span>
    Sheets<span class="token punctuation">(</span>NameSheet<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>EntireColumn<span class="token punctuation">.</span>Hidden <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span> <span class="token comment">' 1. If VerifyExistanceOnly = False</span>
    <span class="token keyword">If</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">Then</span> <span class="token comment">'99. If error</span>
Err01Select_Sheet<span class="token punctuation">:</span>
    MsgBox <span class="token string">&quot;Err01Select_Sheet: Sheet &quot;</span> <span class="token operator">&amp;</span> NameSheet <span class="token operator">&amp;</span> <span class="token string">&quot; doesn't exist!&quot;</span><span class="token punctuation">,</span> vbCritical<span class="token punctuation">:</span> <span class="token keyword">Call</span> ExcelNormal<span class="token punctuation">:</span> <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">GoTo</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token keyword">End</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span> <span class="token comment">'99. If error</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Function</span> General_Functions_Find_Title<span class="token punctuation">(</span>InSheet <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> TitleToFind <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">Optional</span> InRange <span class="token keyword">As</span> Range<span class="token punctuation">,</span> <span class="token keyword">Optional</span> IsNeededToExist <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">,</span> <span class="token keyword">Optional</span> IsWhole <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Range
<span class="token keyword">Dim</span> DummyRange <span class="token keyword">As</span> Range
    <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">GoTo</span> Err01General_Functions_Find_Title
    <span class="token keyword">If</span> InRange <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span> <span class="token comment">' 1. If InRange Is Nothing</span>
    <span class="token keyword">Set</span> DummyRange <span class="token operator">=</span> IIf<span class="token punctuation">(</span>IsWhole <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> Sheets<span class="token punctuation">(</span>InSheet<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Find<span class="token punctuation">(</span>TitleToFind<span class="token punctuation">,</span> LookAt<span class="token punctuation">:</span><span class="token operator">=</span>xlWhole<span class="token punctuation">)</span><span class="token punctuation">,</span> Sheets<span class="token punctuation">(</span>InSheet<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>Find<span class="token punctuation">(</span>TitleToFind<span class="token punctuation">,</span> LookAt<span class="token punctuation">:</span><span class="token operator">=</span>xlPart<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">Else</span> <span class="token comment">' 1. If InRange Is Nothing</span>
    <span class="token keyword">Set</span> DummyRange <span class="token operator">=</span> IIf<span class="token punctuation">(</span>IsWhole <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> Sheets<span class="token punctuation">(</span>InSheet<span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span>InRange<span class="token punctuation">.</span>Address<span class="token punctuation">)</span><span class="token punctuation">.</span>Find<span class="token punctuation">(</span>TitleToFind<span class="token punctuation">,</span> LookAt<span class="token punctuation">:</span><span class="token operator">=</span>xlWhole<span class="token punctuation">)</span><span class="token punctuation">,</span> Sheets<span class="token punctuation">(</span>InSheet<span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span>InRange<span class="token punctuation">.</span>Address<span class="token punctuation">)</span><span class="token punctuation">.</span>Find<span class="token punctuation">(</span>TitleToFind<span class="token punctuation">,</span> LookAt<span class="token punctuation">:</span><span class="token operator">=</span>xlPart<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span> <span class="token comment">' 1. If InRange Is Nothing</span>
    <span class="token keyword">Set</span> General_Functions_Find_Title <span class="token operator">=</span> DummyRange
    <span class="token keyword">If</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">Or</span> DummyRange <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span> <span class="token comment">'99. If error</span>
Err01General_Functions_Find_Title<span class="token punctuation">:</span>
    <span class="token keyword">If</span> IsNeededToExist <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token keyword">Then</span> MsgBox <span class="token string">&quot;Err01General_Functions_Find_Title: Ttile '&quot;</span> <span class="token operator">&amp;</span> TitleToFind <span class="token operator">&amp;</span> <span class="token string">&quot;' was not found in sheet '&quot;</span> <span class="token operator">&amp;</span> InSheet <span class="token operator">&amp;</span> <span class="token string">&quot;'&quot;</span><span class="token punctuation">,</span> vbCritical<span class="token punctuation">:</span> <span class="token keyword">Call</span> ExcelNormal<span class="token punctuation">:</span> <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">GoTo</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token keyword">End</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span> <span class="token comment">'99. If error</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

</code></pre></div><p>Code for module 2, called &quot;Inventory_Handling&quot;</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Const</span> TitleDesc <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;DESCRIPTION&quot;</span>
<span class="token keyword">Const</span> TitleLocation <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;LOCATION&quot;</span>
<span class="token keyword">Const</span> TitleActn <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;ACTION&quot;</span>
<span class="token keyword">Const</span> TitleQty <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;QUANTITY&quot;</span>
<span class="token keyword">Const</span> SheetRecords <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;Record&quot;</span>
<span class="token keyword">Const</span> SheetSmartFilter <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;SmartFilter&quot;</span>
<span class="token keyword">Const</span> RowFilter <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">Const</span> ColDataToPaste <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">Const</span> RowDataToPaste <span class="token keyword">As</span> <span class="token keyword">Long</span> <span class="token operator">=</span> <span class="token number">7</span>
<span class="token keyword">Const</span> RangeInResult <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;K1&quot;</span>
<span class="token keyword">Const</span> RangeOutResult <span class="token keyword">As</span> <span class="token keyword">String</span> <span class="token operator">=</span> <span class="token string">&quot;K2&quot;</span>
<span class="token keyword">Sub</span> Inventory_Filter<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">Dim</span> ColDesc <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">:</span> ColDesc <span class="token operator">=</span> General_Functions_Find_Title<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">,</span> TitleDesc<span class="token punctuation">,</span> IsNeededToExist<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> IsWhole<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Column
<span class="token keyword">Dim</span> ColLocation <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">:</span> ColLocation <span class="token operator">=</span> General_Functions_Find_Title<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">,</span> TitleLocation<span class="token punctuation">,</span> IsNeededToExist<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> IsWhole<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Column
<span class="token keyword">Dim</span> ColActn <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">:</span> ColActn <span class="token operator">=</span> General_Functions_Find_Title<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">,</span> TitleActn<span class="token punctuation">,</span> IsNeededToExist<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> IsWhole<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Column
<span class="token keyword">Dim</span> ColQty <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">:</span> ColQty <span class="token operator">=</span> General_Functions_Find_Title<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">,</span> TitleQty<span class="token punctuation">,</span> IsNeededToExist<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> IsWhole<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Column
<span class="token keyword">Dim</span> CounterQty <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Dim</span> TotalQty <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Dim</span> TotalIn <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Dim</span> TotalOut <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">Dim</span> RangeFiltered <span class="token keyword">As</span> Range
    <span class="token keyword">Call</span> Select_Sheet<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">)</span>
    <span class="token keyword">If</span> Cells<span class="token punctuation">(</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> ColDataToPaste<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row <span class="token operator">&gt;</span> RowDataToPaste <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">Then</span> Rows<span class="token punctuation">(</span>RowDataToPaste <span class="token operator">&amp;</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">&amp;</span> Cells<span class="token punctuation">(</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row<span class="token punctuation">)</span><span class="token punctuation">.</span>Delete
    Sheets<span class="token punctuation">(</span>SheetRecords<span class="token punctuation">)</span><span class="token punctuation">.</span>AutoFilterMode <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">If</span> Cells<span class="token punctuation">(</span>RowFilter<span class="token punctuation">,</span> ColDesc<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Or</span> Cells<span class="token punctuation">(</span>RowFilter<span class="token punctuation">,</span> ColLocation<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Or</span> Cells<span class="token punctuation">(</span>RowFilter<span class="token punctuation">,</span> ColActn<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span> <span class="token comment">' 1. If Cells(RowFilter, ColDesc).Value &lt;&gt; &quot;&quot; Or Cells(RowFilter, ColLocation).Value &lt;&gt; &quot;&quot; Or Cells(RowFilter, ColActn).Value &lt;&gt; &quot;&quot;</span>
    <span class="token keyword">With</span> Sheets<span class="token punctuation">(</span>SheetRecords<span class="token punctuation">)</span><span class="token punctuation">.</span>UsedRange
    <span class="token keyword">If</span> Sheets<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>RowFilter<span class="token punctuation">,</span> ColDesc<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span> <span class="token punctuation">.</span>AutoFilter Field<span class="token punctuation">:</span><span class="token operator">=</span>General_Functions_Find_Title<span class="token punctuation">(</span>SheetRecords<span class="token punctuation">,</span> TitleDesc<span class="token punctuation">,</span> IsNeededToExist<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> IsWhole<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Column<span class="token punctuation">,</span> Criteria1<span class="token punctuation">:</span><span class="token operator">=</span>Sheets<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>RowFilter<span class="token punctuation">,</span> ColDesc<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
    <span class="token keyword">If</span> Sheets<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>RowFilter<span class="token punctuation">,</span> ColLocation<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span> <span class="token punctuation">.</span>AutoFilter Field<span class="token punctuation">:</span><span class="token operator">=</span>General_Functions_Find_Title<span class="token punctuation">(</span>SheetRecords<span class="token punctuation">,</span> TitleLocation<span class="token punctuation">,</span> IsNeededToExist<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> IsWhole<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Column<span class="token punctuation">,</span> Criteria1<span class="token punctuation">:</span><span class="token operator">=</span>Sheets<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>RowFilter<span class="token punctuation">,</span> ColLocation<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
    <span class="token keyword">If</span> Sheets<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>RowFilter<span class="token punctuation">,</span> ColActn<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span> <span class="token punctuation">.</span>AutoFilter Field<span class="token punctuation">:</span><span class="token operator">=</span>General_Functions_Find_Title<span class="token punctuation">(</span>SheetRecords<span class="token punctuation">,</span> TitleActn<span class="token punctuation">,</span> IsNeededToExist<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> IsWhole<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Column<span class="token punctuation">,</span> Criteria1<span class="token punctuation">:</span><span class="token operator">=</span>Sheets<span class="token punctuation">(</span>SheetSmartFilter<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>RowFilter<span class="token punctuation">,</span> ColActn<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
    <span class="token comment">'If we don't use a filter we would need to use a cycle For/to or For/Each Cell in range</span>
    <span class="token comment">'to determine whether or not the row meets the criteria that we are looking and then</span>
    <span class="token comment">'save it on an array, collection, dictionary, etc</span>
    <span class="token comment">'IG: For CounterRow = 2 To TotalRows</span>
    <span class="token comment">'If Sheets(SheetSmartFilter).Cells(RowFilter, ColDesc).Value &lt;&gt; &quot;&quot; and Sheets(SheetRecords).cells(CounterRow,ColDescInRecords).Value= Sheets(SheetSmartFilter).Cells(RowFilter, ColDesc).Value then</span>
    <span class="token comment">'Redim Preserve MyUnecessaryArray(UnecessaryNumber) ''Save to array: (UnecessaryNumber)=MyUnecessaryArray. Or in a dictionary, etc. At the end, we would transpose this values into the sheet, at the end</span>
    <span class="token comment">'both are the same, but, just try to see the time invested on each logic.</span>
    <span class="token keyword">If</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlDown<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span> <span class="token keyword">Set</span> RangeFiltered <span class="token operator">=</span> <span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token string">&quot;2:&quot;</span> <span class="token operator">&amp;</span> Sheets<span class="token punctuation">(</span>SheetRecords<span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row<span class="token punctuation">)</span><span class="token punctuation">.</span>SpecialCells<span class="token punctuation">(</span>xlCellTypeVisible<span class="token punctuation">)</span>
    <span class="token comment">'If it is not &lt;&gt;&quot;&quot; means that there was not filtered data!</span>
    <span class="token keyword">If</span> RangeFiltered <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span> MsgBox <span class="token string">&quot;Err01Inventory_Filter: No data was found with the given criteria!&quot;</span><span class="token punctuation">,</span> vbCritical<span class="token punctuation">:</span> <span class="token keyword">Call</span> ExcelNormal<span class="token punctuation">:</span> <span class="token keyword">End</span>
    RangeFiltered<span class="token punctuation">.</span>Copy Destination<span class="token punctuation">:</span><span class="token operator">=</span>Cells<span class="token punctuation">(</span>RowDataToPaste<span class="token punctuation">,</span> ColDataToPaste<span class="token punctuation">)</span>
    TotalQty <span class="token operator">=</span> Cells<span class="token punctuation">(</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> ColQty<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
    <span class="token keyword">For</span> CounterQty <span class="token operator">=</span> RowDataToPaste <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">To</span> TotalQty
    <span class="token keyword">If</span> Cells<span class="token punctuation">(</span>CounterQty<span class="token punctuation">,</span> ColActn<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">&quot;In&quot;</span> <span class="token keyword">Then</span> <span class="token comment">' 2. If Cells(CounterQty, ColActn).Value = &quot;In&quot;</span>
    TotalIn <span class="token operator">=</span> Cells<span class="token punctuation">(</span>CounterQty<span class="token punctuation">,</span> ColQty<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">+</span> TotalIn
    <span class="token keyword">ElseIf</span> Cells<span class="token punctuation">(</span>CounterQty<span class="token punctuation">,</span> ColActn<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">&quot;Out&quot;</span> <span class="token keyword">Then</span> <span class="token comment">' 2. If Cells(CounterQty, ColActn).Value = &quot;In&quot;</span>
    TotalOut <span class="token operator">=</span> Cells<span class="token punctuation">(</span>CounterQty<span class="token punctuation">,</span> ColQty<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">+</span> TotalOut
    <span class="token keyword">End</span> <span class="token keyword">If</span> <span class="token comment">' 2. If Cells(CounterQty, ColActn).Value = &quot;In&quot;</span>
    <span class="token keyword">Next</span> CounterQty
    Range<span class="token punctuation">(</span>RangeInResult<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> TotalIn
    Range<span class="token punctuation">(</span>RangeOutResult<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>TotalOut<span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">With</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span> <span class="token comment">' 1. If Cells(RowFilter, ColDesc).Value &lt;&gt; &quot;&quot; Or Cells(RowFilter, ColLocation).Value &lt;&gt; &quot;&quot; Or Cells(RowFilter, ColActn).Value &lt;&gt; &quot;&quot;</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p><br><strong><strong>Testing and results:</strong></strong></p> <p><a href="https://i.stack.imgur.com/v9jnz.gif" target="_blank" rel="noopener noreferrer"><img src="https://i.stack.imgur.com/v9jnz.gif" alt="Smartfilter Testing"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <br>As we saw in the previous image, this task has been achieved easily. By using <strong><strong>autofilters</strong></strong> a solution was provided that just <strong><strong>takes seconds to compute, is easy to explain to the user</strong></strong> -since s/he is familiar with this command- and <strong><strong>took a few lines to the coder.</strong></strong></p> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>'To use Autofilter within VBA we need to call with at least the following parameters:</p> <p>Sheet(&quot;MySheet&quot;).Range(&quot;MyRange&quot;).Autofilter Field=(ColumnNumberWithin&quot;MyRange&quot;ToBeFilteredInNumericValue) Criteria1:= &quot;WhatIWantToFilter&quot;</p> <p>'There are plenty of examples either on the web or here <a href="http://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba" target="_blank" rel="noopener noreferrer">at stackoverflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/excelvba/autofilter-uses-and-best-practices.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/excelvba/binding.html" class="prev">
        Binding
      </a></span> <span class="next"><a href="/excelvba/application-object.html">
        Application object
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/1070.2cc17f6c.js" defer></script>
  </body>
</html>
