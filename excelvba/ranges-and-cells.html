<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Excel VBA - Ranges and Cells</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Ways to refer to a single cell, Creating a Range, Offset Property, Saving a reference to a cell in a variable, How to Transpose Ranges (Horizontal to Vertical & vice versa)">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Excel VBA - Ranges and Cells">
    <meta property="og:description" content="Ways to refer to a single cell, Creating a Range, Offset Property, Saving a reference to a cell in a variable, How to Transpose Ranges (Horizontal to Vertical & vice versa)">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/excelvba/ranges-and-cells.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Excel VBA - Ranges and Cells">
    <meta name="twitter:description" content="Ways to refer to a single cell, Creating a Range, Offset Property, Saving a reference to a cell in a variable, How to Transpose Ranges (Horizontal to Vertical & vice versa)">
    <meta name="twitter:url" content="/excelvba/ranges-and-cells.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/1090.f7efa129.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Excel VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/excelvba/" class="sidebar-link">Disclaimer</a></li><li><a href="/excelvba/getting-started-with-excel-vba.html" class="sidebar-link">Getting started with excel-vba</a></li><li><a href="/excelvba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/excelvba/conditional-statements.html" class="sidebar-link">Conditional statements</a></li><li><a href="/excelvba/ranges-and-cells.html" class="active sidebar-link">Ranges and Cells</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excelvba/ranges-and-cells.html#ways-to-refer-to-a-single-cell" class="sidebar-link">Ways to refer to a single cell</a></li><li class="sidebar-sub-header"><a href="/excelvba/ranges-and-cells.html#creating-a-range" class="sidebar-link">Creating a Range</a></li><li class="sidebar-sub-header"><a href="/excelvba/ranges-and-cells.html#offset-property" class="sidebar-link">Offset Property</a></li><li class="sidebar-sub-header"><a href="/excelvba/ranges-and-cells.html#saving-a-reference-to-a-cell-in-a-variable" class="sidebar-link">Saving a reference to a cell in a variable</a></li><li class="sidebar-sub-header"><a href="/excelvba/ranges-and-cells.html#how-to-transpose-ranges-horizontal-to-vertical-vice-versa" class="sidebar-link">How to Transpose Ranges (Horizontal to Vertical &amp; vice versa)</a></li></ul></li><li><a href="/excelvba/named-ranges.html" class="sidebar-link">Named Ranges</a></li><li><a href="/excelvba/merged-cells-ranges.html" class="sidebar-link">Merged Cells / Ranges</a></li><li><a href="/excelvba/locating-duplicate-values-in-a-range.html" class="sidebar-link">Locating duplicate values in a range</a></li><li><a href="/excelvba/user-defined-functions-udfs.html" class="sidebar-link">User Defined Functions (UDFs)</a></li><li><a href="/excelvba/conditional-formatting-using-vba.html" class="sidebar-link">Conditional formatting using VBA</a></li><li><a href="/excelvba/workbooks.html" class="sidebar-link">Workbooks</a></li><li><a href="/excelvba/working-with-excel-tables-in-vba.html" class="sidebar-link">Working with Excel Tables in VBA</a></li><li><a href="/excelvba/loop-through-all-sheets-in-active-workbook.html" class="sidebar-link">Loop through all Sheets in Active Workbook</a></li><li><a href="/excelvba/use-worksheet-object-and-not-sheet-object.html" class="sidebar-link">Use Worksheet object and not Sheet object</a></li><li><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html" class="sidebar-link">Methods for Finding the Last Used Row or Column in a Worksheet</a></li><li><a href="/excelvba/creating-a-drop-down-menu-in-the-active-worksheet-with-a-combo-box.html" class="sidebar-link">Creating a drop-down menu in the Active Worksheet with a Combo Box</a></li><li><a href="/excelvba/file-system-object.html" class="sidebar-link">File System Object</a></li><li><a href="/excelvba/pivot-tables.html" class="sidebar-link">Pivot Tables</a></li><li><a href="/excelvba/binding.html" class="sidebar-link">Binding</a></li><li><a href="/excelvba/autofilter-uses-and-best-practices.html" class="sidebar-link">autofilter ; Uses and best practices</a></li><li><a href="/excelvba/application-object.html" class="sidebar-link">Application object</a></li><li><a href="/excelvba/charts-and-charting.html" class="sidebar-link">Charts and Charting</a></li><li><a href="/excelvba/customdocumentproperties-in-practice.html" class="sidebar-link">CustomDocumentProperties in practice</a></li><li><a href="/excelvba/powerpoint-integration-through-vba.html" class="sidebar-link">PowerPoint Integration Through VBA</a></li><li><a href="/excelvba/how-to-record-a-macro.html" class="sidebar-link">How to record a Macro</a></li><li><a href="/excelvba/sql-in-excel-vba-best-practices.html" class="sidebar-link">SQL in Excel VBA - Best Practices</a></li><li><a href="/excelvba/excel-vba-optimization.html" class="sidebar-link">Excel-VBA Optimization</a></li><li><a href="/excelvba/vba-security.html" class="sidebar-link">VBA Security</a></li><li><a href="/excelvba/debugging-and-troubleshooting.html" class="sidebar-link">Debugging and Troubleshooting</a></li><li><a href="/excelvba/vba-best-practices.html" class="sidebar-link">VBA Best Practices</a></li><li><a href="/excelvba/excel-vba-tips-and-tricks.html" class="sidebar-link">Excel VBA Tips and Tricks</a></li><li><a href="/excelvba/common-mistakes.html" class="sidebar-link">Common Mistakes</a></li><li><a href="/excelvba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ranges-and-cells"><a href="#ranges-and-cells" class="header-anchor">#</a> Ranges and Cells</h1> <h2 id="ways-to-refer-to-a-single-cell"><a href="#ways-to-refer-to-a-single-cell" class="header-anchor">#</a> Ways to refer to a single cell</h2> <p>The simplest way to refer to a single cell on the current Excel worksheet is simply to enclose the A1 form of its reference in square brackets:</p> <div class="language-vb extra-class"><pre class="language-vb"><code>[a3] <span class="token operator">=</span> <span class="token string">&quot;Hello!&quot;</span>

</code></pre></div><p>Note that square brackets are just convenient <a href="https://en.wikipedia.org/wiki/Syntactic_sugar" target="_blank" rel="noopener noreferrer">syntactic sugar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for the <code>Evaluate</code> method of the <code>Application</code> object, so technically, this is identical to the following code:</p> <div class="language-vb extra-class"><pre class="language-vb"><code>Application<span class="token punctuation">.</span>Evaluate<span class="token punctuation">(</span><span class="token string">&quot;a3&quot;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;Hello!&quot;</span>

</code></pre></div><p>You could also call the <code>Cells</code> method which takes a row and a column and returns a cell reference.</p> <div class="language-vb extra-class"><pre class="language-vb"><code>Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Formula <span class="token operator">=</span> <span class="token string">&quot;=A1+A2&quot;</span>

</code></pre></div><p>Remember that whenever you pass a row and a column to Excel from VBA, the row is always first, followed by the column, which is confusing because it is the opposite of the common <code>A1</code> notation where the column appears first.</p> <p>In both of these examples, we did not specify a worksheet, so Excel will use the active sheet (the sheet that is in front in the user interface). You can specify the active sheet explicitly:</p> <div class="language-vb extra-class"><pre class="language-vb"><code>ActiveSheet<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Formula <span class="token operator">=</span> <span class="token string">&quot;=SUM(A1:A2)&quot;</span>

</code></pre></div><p>Or you can provide the name of a particular sheet:</p> <div class="language-vb extra-class"><pre class="language-vb"><code>Sheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Formula <span class="token operator">=</span> <span class="token string">&quot;=SUM(A1:A2)&quot;</span>

</code></pre></div><p>There are a wide variety of methods that can be used to get from one range to another. For example, the <code>Rows</code> method can be used to get to the individual rows of any range, and the <code>Cells</code> method can be used to get to individual cells of a row or column, so the following code refers to cell C1:</p> <div class="language-vb extra-class"><pre class="language-vb"><code>ActiveSheet<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Formula <span class="token operator">=</span> <span class="token string">&quot;hi!&quot;</span>

</code></pre></div><h2 id="creating-a-range"><a href="#creating-a-range" class="header-anchor">#</a> Creating a Range</h2> <p>A <a href="https://msdn.microsoft.com/en-us/library/office/ff838238.aspx" target="_blank" rel="noopener noreferrer">Range<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> cannot be created or populated the same way a string would:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> RangeTest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> s <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> r <span class="token keyword">As</span> Range <span class="token comment">'Specific Type of Object, with members like Address, WrapText, AutoFill, etc.</span>
    
    <span class="token comment">' This is how we fill a String:</span>
    s <span class="token operator">=</span> <span class="token string">&quot;Hello World!&quot;</span>

    <span class="token comment">' But we cannot do this for a Range:</span>
    r <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span> <span class="token comment">'//Run. Err.:  91 Object variable or With block variable not set//</span>

    <span class="token comment">' We have to use the Object approach, using keyword Set:</span>
    <span class="token keyword">Set</span> r <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>It is considered best practice to <a href="http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/11274/always-define-and-set-references-to-all-workbooks-and-sheets#t=201607261348479429911" target="_blank" rel="noopener noreferrer">qualify your references<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, so from now on we will use the same approach here.<br>
More about <a href="https://msdn.microsoft.com/en-us/library/office/gg251791.aspx" target="_blank" rel="noopener noreferrer">Creating Object Variables (e.g. Range) on MSDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> . More about <a href="https://msdn.microsoft.com/en-us/library/office/gg251642.aspx" target="_blank" rel="noopener noreferrer">Set Statement on MSDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>There are different ways to create the same Range:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> SetRangeVariable<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> ws <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Dim</span> r <span class="token keyword">As</span> Range

    <span class="token keyword">Set</span> ws <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Worksheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">' The first Worksheet in Workbook with this code in it</span>
    
    <span class="token comment">' These are all equivalent:</span>
    <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span> <span class="token operator">&amp;</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">' The cell in row number 2, column number 1</span>
    <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>[A2] <span class="token comment">'Shorthand notation of Range.</span>
    <span class="token keyword">Set</span> r <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token string">&quot;NamedRangeInA2&quot;</span><span class="token punctuation">)</span> <span class="token comment">'If the cell A2 is named NamedRangeInA2. Note, that this is Sheet independent.</span>
    <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">' The cell that is 1 row and 0 columns away from A1</span>
    <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">' Similar to Offset. You can &quot;go outside&quot; the original Range.</span>

    <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1:A5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">'Second cell in bigger Range.</span>
    <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1:A5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Item<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">'Second cell in bigger Range.</span>
    <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1:A5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">'Second cell in bigger Range.</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>Note in the example that Cells(2, 1) is equivalent to Range(&quot;A2&quot;). This is because Cells returns a Range object.<br>
Some sources: <a href="http://www.cpearson.com/Excel/cells.htm" target="_blank" rel="noopener noreferrer">Chip Pearson-Cells Within Ranges<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>; <a href="https://msdn.microsoft.com/en-us/library/office/ff838238.aspx" target="_blank" rel="noopener noreferrer">MSDN-Range Object<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>; <a href="http://spreadsheetpage.com/index.php/tip/referring_to_ranges_in_your_vba_code/" target="_blank" rel="noopener noreferrer">John Walkenback-Referring To Ranges In Your VBA Code<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Also note that in any instance where a number is used in the declaration of the range, and the number itself is outside of quotation marks, such as Range(&quot;A&quot; &amp; 2), you can swap that number for a variable that contains an integer/long. For example:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> RangeIteration<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> wb <span class="token keyword">As</span> Workbook<span class="token punctuation">,</span> ws <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Dim</span> r <span class="token keyword">As</span> Range

    <span class="token keyword">Set</span> wb <span class="token operator">=</span> ThisWorkbook
    <span class="token keyword">Set</span> ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>Worksheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">10</span>
        <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span> <span class="token operator">&amp;</span> i<span class="token punctuation">)</span>
        <span class="token comment">' When i = 1, the result will be Range(&quot;A1&quot;)</span>
        <span class="token comment">' When i = 2, the result will be Range(&quot;A2&quot;)</span>
        <span class="token comment">' etc.</span>
        <span class="token comment">' Proof:</span>
        Debug<span class="token punctuation">.</span>Print r<span class="token punctuation">.</span>Address
    <span class="token keyword">Next</span> i
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>If you are using double loops, Cells is better:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> RangeIteration2<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> wb <span class="token keyword">As</span> Workbook<span class="token punctuation">,</span> ws <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Dim</span> r <span class="token keyword">As</span> Range

    <span class="token keyword">Set</span> wb <span class="token operator">=</span> ThisWorkbook
    <span class="token keyword">Set</span> ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>Worksheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">10</span>
        <span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">10</span>
            <span class="token keyword">Set</span> r <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
            <span class="token comment">' When i = 1 and j = 1, the result will be Range(&quot;A1&quot;)</span>
            <span class="token comment">' When i = 2 and j = 1, the result will be Range(&quot;A2&quot;)</span>
            <span class="token comment">' When i = 1 and j = 2, the result will be Range(&quot;B1&quot;)</span>
            <span class="token comment">' etc.</span>
            <span class="token comment">' Proof:</span>
            Debug<span class="token punctuation">.</span>Print r<span class="token punctuation">.</span>Address
        <span class="token keyword">Next</span> j
    <span class="token keyword">Next</span> i
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h2 id="offset-property"><a href="#offset-property" class="header-anchor">#</a> Offset Property</h2> <ul><li><strong>Offset(Rows, Columns)</strong> - The operator used to statically reference another point from the current cell. Often used in loops. It should be understood that positive numbers in the rows section moves right, wheres as negatives move left. With the columns section positives move down and negatives move up.</li></ul> <p>i.e</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> this<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
    ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">&quot;New Value&quot;</span>
    ActiveCell<span class="token punctuation">.</span>Offset<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> ActiveCell<span class="token punctuation">.</span>Value
    ActiveCell<span class="token punctuation">.</span>Value <span class="token operator">=</span> vbNullString
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>This code selects B2, puts a new string there, then moves that string back to A1 afterwards clearing out B2.</p> <h2 id="saving-a-reference-to-a-cell-in-a-variable"><a href="#saving-a-reference-to-a-cell-in-a-variable" class="header-anchor">#</a> Saving a reference to a cell in a variable</h2> <p>To save a reference to a cell in a variable, you must use the <code>Set</code> syntax, for example:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Dim</span> R <span class="token keyword">as</span> Range
<span class="token keyword">Set</span> R <span class="token operator">=</span> ActiveSheet<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

</code></pre></div><p><strong>later...</strong></p> <div class="language-vb extra-class"><pre class="language-vb"><code>R<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Color <span class="token operator">=</span> RGB<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

</code></pre></div><p>Why is the <code>Set</code> keyword required? <code>Set</code> tells Visual Basic that the value on the right hand side of the <code>=</code> is meant to be an object.</p> <h2 id="how-to-transpose-ranges-horizontal-to-vertical-vice-versa"><a href="#how-to-transpose-ranges-horizontal-to-vertical-vice-versa" class="header-anchor">#</a> How to Transpose Ranges (Horizontal to Vertical &amp; vice versa)</h2> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Sub</span> TransposeRangeValues<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> TmpArray<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">,</span> FromRange <span class="token keyword">as</span> Range<span class="token punctuation">,</span> ToRange <span class="token keyword">as</span> Range

    <span class="token keyword">set</span> FromRange <span class="token operator">=</span> Sheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;a1:a12&quot;</span><span class="token punctuation">)</span>         <span class="token comment">'Worksheets(1).Range(&quot;a1:p1&quot;)</span>
    <span class="token keyword">set</span> ToRange <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;a1&quot;</span><span class="token punctuation">)</span>  <span class="token comment">'ThisWorkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;a1&quot;)</span>

    TmpArray <span class="token operator">=</span> Application<span class="token punctuation">.</span>Transpose<span class="token punctuation">(</span>FromRange<span class="token punctuation">.</span>Value<span class="token punctuation">)</span>
    FromRange<span class="token punctuation">.</span>Clear
    ToRange<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span>FromRange<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span>Count<span class="token punctuation">,</span>FromRange<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">.</span>Value2 <span class="token operator">=</span> TmpArray
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>Note: Copy/PasteSpecial also has a Paste Transpose option which updates the transposed cells' formulas as well.</p> <h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ul><li><strong>Set</strong> - The operator used to set a reference to an object, such as a Range</li> <li><strong>For Each</strong> - The operator used to loop through every item in a collection</li></ul> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>Note that the variable names <code>r</code>, <code>cell</code> and others can be named however you like but should be named appropriately so the code is easier to understand for you and others.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/excelvba/ranges-and-cells.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/excelvba/conditional-statements.html" class="prev">
        Conditional statements
      </a></span> <span class="next"><a href="/excelvba/named-ranges.html">
        Named Ranges
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/1090.f7efa129.js" defer></script>
  </body>
</html>
