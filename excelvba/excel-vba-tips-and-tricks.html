<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Excel VBA - Excel VBA Tips and Tricks</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Using xlVeryHidden Sheets, Using Strings with Delimiters in Place of Dynamic Arrays, Worksheet .Name, .Index or .CodeName, Double Click Event for Excel Shapes, Open File Dialog - Multiple Files">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Excel VBA - Excel VBA Tips and Tricks">
    <meta property="og:description" content="Using xlVeryHidden Sheets, Using Strings with Delimiters in Place of Dynamic Arrays, Worksheet .Name, .Index or .CodeName, Double Click Event for Excel Shapes, Open File Dialog - Multiple Files">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/excelvba/excel-vba-tips-and-tricks.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Excel VBA - Excel VBA Tips and Tricks">
    <meta name="twitter:description" content="Using xlVeryHidden Sheets, Using Strings with Delimiters in Place of Dynamic Arrays, Worksheet .Name, .Index or .CodeName, Double Click Event for Excel Shapes, Open File Dialog - Multiple Files">
    <meta name="twitter:url" content="/excelvba/excel-vba-tips-and-tricks.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/1079.77501b68.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Excel VBA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/excelvba/" class="sidebar-link">Disclaimer</a></li><li><a href="/excelvba/getting-started-with-excel-vba.html" class="sidebar-link">Getting started with excel-vba</a></li><li><a href="/excelvba/arrays.html" class="sidebar-link">Arrays</a></li><li><a href="/excelvba/conditional-statements.html" class="sidebar-link">Conditional statements</a></li><li><a href="/excelvba/ranges-and-cells.html" class="sidebar-link">Ranges and Cells</a></li><li><a href="/excelvba/named-ranges.html" class="sidebar-link">Named Ranges</a></li><li><a href="/excelvba/merged-cells-ranges.html" class="sidebar-link">Merged Cells / Ranges</a></li><li><a href="/excelvba/locating-duplicate-values-in-a-range.html" class="sidebar-link">Locating duplicate values in a range</a></li><li><a href="/excelvba/user-defined-functions-udfs.html" class="sidebar-link">User Defined Functions (UDFs)</a></li><li><a href="/excelvba/conditional-formatting-using-vba.html" class="sidebar-link">Conditional formatting using VBA</a></li><li><a href="/excelvba/workbooks.html" class="sidebar-link">Workbooks</a></li><li><a href="/excelvba/working-with-excel-tables-in-vba.html" class="sidebar-link">Working with Excel Tables in VBA</a></li><li><a href="/excelvba/loop-through-all-sheets-in-active-workbook.html" class="sidebar-link">Loop through all Sheets in Active Workbook</a></li><li><a href="/excelvba/use-worksheet-object-and-not-sheet-object.html" class="sidebar-link">Use Worksheet object and not Sheet object</a></li><li><a href="/excelvba/methods-for-finding-the-last-used-row-or-column-in-a-worksheet.html" class="sidebar-link">Methods for Finding the Last Used Row or Column in a Worksheet</a></li><li><a href="/excelvba/creating-a-drop-down-menu-in-the-active-worksheet-with-a-combo-box.html" class="sidebar-link">Creating a drop-down menu in the Active Worksheet with a Combo Box</a></li><li><a href="/excelvba/file-system-object.html" class="sidebar-link">File System Object</a></li><li><a href="/excelvba/pivot-tables.html" class="sidebar-link">Pivot Tables</a></li><li><a href="/excelvba/binding.html" class="sidebar-link">Binding</a></li><li><a href="/excelvba/autofilter-uses-and-best-practices.html" class="sidebar-link">autofilter ; Uses and best practices</a></li><li><a href="/excelvba/application-object.html" class="sidebar-link">Application object</a></li><li><a href="/excelvba/charts-and-charting.html" class="sidebar-link">Charts and Charting</a></li><li><a href="/excelvba/customdocumentproperties-in-practice.html" class="sidebar-link">CustomDocumentProperties in practice</a></li><li><a href="/excelvba/powerpoint-integration-through-vba.html" class="sidebar-link">PowerPoint Integration Through VBA</a></li><li><a href="/excelvba/how-to-record-a-macro.html" class="sidebar-link">How to record a Macro</a></li><li><a href="/excelvba/sql-in-excel-vba-best-practices.html" class="sidebar-link">SQL in Excel VBA - Best Practices</a></li><li><a href="/excelvba/excel-vba-optimization.html" class="sidebar-link">Excel-VBA Optimization</a></li><li><a href="/excelvba/vba-security.html" class="sidebar-link">VBA Security</a></li><li><a href="/excelvba/debugging-and-troubleshooting.html" class="sidebar-link">Debugging and Troubleshooting</a></li><li><a href="/excelvba/vba-best-practices.html" class="sidebar-link">VBA Best Practices</a></li><li><a href="/excelvba/excel-vba-tips-and-tricks.html" class="active sidebar-link">Excel VBA Tips and Tricks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/excelvba/excel-vba-tips-and-tricks.html#using-xlveryhidden-sheets" class="sidebar-link">Using xlVeryHidden Sheets</a></li><li class="sidebar-sub-header"><a href="/excelvba/excel-vba-tips-and-tricks.html#using-strings-with-delimiters-in-place-of-dynamic-arrays" class="sidebar-link">Using Strings with Delimiters in Place of Dynamic Arrays</a></li><li class="sidebar-sub-header"><a href="/excelvba/excel-vba-tips-and-tricks.html#worksheet-name-index-or-codename" class="sidebar-link">Worksheet .Name, .Index or .CodeName</a></li><li class="sidebar-sub-header"><a href="/excelvba/excel-vba-tips-and-tricks.html#double-click-event-for-excel-shapes" class="sidebar-link">Double Click Event for Excel Shapes</a></li><li class="sidebar-sub-header"><a href="/excelvba/excel-vba-tips-and-tricks.html#open-file-dialog-multiple-files" class="sidebar-link">Open File Dialog - Multiple Files</a></li></ul></li><li><a href="/excelvba/common-mistakes.html" class="sidebar-link">Common Mistakes</a></li><li><a href="/excelvba/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="excel-vba-tips-and-tricks"><a href="#excel-vba-tips-and-tricks" class="header-anchor">#</a> Excel VBA Tips and Tricks</h1> <h2 id="using-xlveryhidden-sheets"><a href="#using-xlveryhidden-sheets" class="header-anchor">#</a> Using xlVeryHidden Sheets</h2> <p>Worksheets in excel have three options for the <code>Visible</code> property. These options are represented by constants in the <code>xlSheetVisibility</code> enumeration and are as follows:</p> <ol><li><code>xlVisible</code> or <code>xlSheetVisible</code> value: <code>-1</code> (the default for new sheets)</li> <li><code>xlHidden</code> or <code>xlSheetHidden</code> value: <code>0</code></li> <li><code>xlVeryHidden</code> <code>xlSheetVeryHidden</code> value: <code>2</code></li></ol> <p>Visible sheets represent the default visibility for sheets.  They are visible in the sheet tab bar and can be freely selected and viewed.  Hidden sheets are hidden from the sheet tab bar and are thus not selectable.  However, hidden sheets can be unhidden from the excel window by right clicking on the sheet tabs and selecting &quot;Unhide&quot;</p> <p>Very Hidden sheets, on the other hand, are <strong>only</strong> accessible through the Visual Basic Editor.  This makes them an incredibly useful tool for storing data across instances of excel as well as storing data that should be hidden from end users.  The sheets can be accessed by named reference within VBA code, allowing easy use of the stored data.</p> <p>To manually change a worksheet's .Visible property to xlSheetVeryHidden, open the VBE's Properties window (<kbd>F4</kbd>), select the worksheet you want to change and use the drop-down in the thirteenth row to make your selection.</p> <p><a href="http://i.stack.imgur.com/fCX7s.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/fCX7s.png" alt="worksheet_properties_window_visible"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>To change a worksheet's .Visible property to xlSheetVeryHidden¹ in code, similarly access the .Visible property and assign a new value.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">with</span> Sheet3
    <span class="token punctuation">.</span>Visible <span class="token operator">=</span> xlSheetVeryHidden
<span class="token keyword">end</span> <span class="token keyword">with</span>

</code></pre></div><p>¹ <sub>Both <strong>xlVeryHidden</strong> and <strong>xlSheetVeryHidden</strong> return a numerical value of <strong>2</strong> (they are interchangeable).</sub></p> <h2 id="using-strings-with-delimiters-in-place-of-dynamic-arrays"><a href="#using-strings-with-delimiters-in-place-of-dynamic-arrays" class="header-anchor">#</a> Using Strings with Delimiters in Place of Dynamic Arrays</h2> <p>Using Dynamic Arrays in VBA can be quite clunky and time intensive over very large data sets.  When storing simple data types in a dynamic array (Strings, Numbers, Booleans etc.), one can avoid the <code>ReDim Preserve</code> statements required of dynamic arrays in VBA by using the <code>Split()</code> function with some clever string procedures.  For example, we will look at a loop that adds a series of values from a range to a string based on some conditions, then uses that string to populate the values of a ListBox.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> UserForm_Initialize<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">Dim</span> Count <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> DataString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> Delimiter <span class="token keyword">As</span> <span class="token keyword">String</span>

<span class="token keyword">For</span> Count <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> ActiveSheet<span class="token punctuation">.</span>UsedRows<span class="token punctuation">.</span>Count
    <span class="token keyword">If</span> ActiveSheet<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span> <span class="token operator">&amp;</span> Count<span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;Your Condition&quot;</span> <span class="token keyword">Then</span>
        RowString <span class="token operator">=</span> RowString <span class="token operator">&amp;</span> Delimiter <span class="token operator">&amp;</span> ActiveSheet<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span> <span class="token operator">&amp;</span> Count<span class="token punctuation">)</span><span class="token punctuation">.</span>Value
        Delimiter <span class="token operator">=</span> <span class="token string">&quot;&gt;&lt;&quot;</span> <span class="token comment">'By setting the delimiter here in the loop, you prevent an extra occurance of the delimiter within the string</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">Next</span> Count

ListBox1<span class="token punctuation">.</span>List <span class="token operator">=</span> Split<span class="token punctuation">(</span>DataString<span class="token punctuation">,</span> Delimiter<span class="token punctuation">)</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>The <code>Delimiter</code> string itself can be set to any value, but it is prudent to choose a value which will not naturally occur within the set.  Say, for example, you were processing a column of dates.  In that case, using <code>.</code>, <code>-</code>, or <code>/</code> would be unwise as delimiters, as the dates could be formatted to use any one of these, generating more data points than you anticipated.</p> <p><strong>Note:</strong> There are limitations to using this method (namely the maximum length of strings), so it should be used with caution in cases of very large datasets.  This is not necessarily the fastest or most effective method for creating dynamic arrays in VBA, but it is a viable alternative.</p> <h2 id="worksheet-name-index-or-codename"><a href="#worksheet-name-index-or-codename" class="header-anchor">#</a> Worksheet .Name, .Index or .CodeName</h2> <p>We know that 'best practise' dictates that a range object should have its parent worksheet explicitly referenced. A worksheet can be referred to by its .Name property, numerical .Index property or its .CodeName property but a user can reorder the worksheet queue by simply dragging a name tab or rename the worksheet with a double-click on the same tab and some typing in an unprotected workbook.</p> <p>Consider a standard three worksheet. You have renamed the three worksheets Monday, Tuesday and Wednesday in that order and coded VBA sub procedures that reference these. Now consider that one user comes along and decides that Monday belongs at the end of the worksheet queue then another comes along and decides that the worksheet names look better in French. You now have a workbook with a worksheet name tab queue that looks something like the following.</p> <p><a href="http://i.stack.imgur.com/YRXYF.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/YRXYF.png" alt="worksheet_tab_queue"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>If you had used either of the following worksheet reference methods, your code would now be broken.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token comment">'reference worksheet by .Name</span>
<span class="token keyword">with</span> worksheets<span class="token punctuation">(</span><span class="token string">&quot;Monday&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">'operation code here; for example:</span>
    <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">end</span> <span class="token keyword">with</span>

<span class="token comment">'reference worksheet by ordinal .Index</span>
<span class="token keyword">with</span> worksheets<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">'operation code here; for example:</span>
    <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">end</span> <span class="token keyword">with</span>

</code></pre></div><p>Both the original order and the original worksheet name have been compromised. However, if you had used the worksheet's .CodeName property, your sub procedure would still be operational</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">with</span> Sheet1
    <span class="token comment">'operation code here; for example:</span>
    <span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">,</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">end</span> <span class="token keyword">with</span>

</code></pre></div><p>The following image shows the VBA Project window ([Ctrl]+R) which lists the worksheets by .CodeName then by .Name (in brackets). The order they are displayed does not change; the ordinal .Index is taken by the order they are displayed in the name tab queue in the worksheet window.</p> <p><a href="http://i.stack.imgur.com/94gJ6.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/94gJ6.png" alt="worksheet_project_window"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>While it is uncommon to rename a .CodeName, it is not impossible. Simply open the VBE's Properties window ([F4]).</p> <p><a href="http://i.stack.imgur.com/jmror.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/jmror.png" alt="worksheet_properties_window"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>The worksheet .CodeName is in the first row. The worksheet's .Name is in the tenth. Both are editable.</p> <h2 id="double-click-event-for-excel-shapes"><a href="#double-click-event-for-excel-shapes" class="header-anchor">#</a> Double Click Event for Excel Shapes</h2> <p>By default, Shapes in Excel do not have a specific way to handle single vs. double clicks, containing only the &quot;OnAction&quot; property to allow you to handle clicks.  However, there may be instances where your code requires you to act differently (or exclusively) on a double click.  The following subroutine can be added into your VBA project and, when set as the <code>OnAction</code> routine for your shape, allow you to act on double clicks.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Const</span> DOUBLECLICK_WAIT <span class="token keyword">as</span> <span class="token keyword">Double</span> <span class="token operator">=</span> <span class="token number">0.25</span> <span class="token comment">'Modify to adjust click delay</span>
<span class="token keyword">Public</span> LastClickObj <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> LastClickTime <span class="token keyword">As</span> <span class="token keyword">Date</span>

<span class="token keyword">Sub</span> ShapeDoubleClick<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">If</span> LastClickObj <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span>
        LastClickObj <span class="token operator">=</span> Application<span class="token punctuation">.</span>Caller
        LastClickTime <span class="token operator">=</span> <span class="token keyword">CDbl</span><span class="token punctuation">(</span>Timer<span class="token punctuation">)</span>
    <span class="token keyword">Else</span>
        <span class="token keyword">If</span> <span class="token keyword">CDbl</span><span class="token punctuation">(</span>Timer<span class="token punctuation">)</span> <span class="token operator">-</span> LastClickTime <span class="token operator">&gt;</span> DOUBLECLICK_WAIT <span class="token keyword">Then</span>
            LastClickObj <span class="token operator">=</span> Application<span class="token punctuation">.</span>Caller
            LastClickTime <span class="token operator">=</span> <span class="token keyword">CDbl</span><span class="token punctuation">(</span>Timer<span class="token punctuation">)</span>
        <span class="token keyword">Else</span>
            <span class="token keyword">If</span> LastClickObj <span class="token operator">=</span> Application<span class="token punctuation">.</span>Caller <span class="token keyword">Then</span>
                <span class="token comment">'Your desired Double Click code here</span>
                LastClickObj <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
            <span class="token keyword">Else</span>
                LastClickObj <span class="token operator">=</span> Application<span class="token punctuation">.</span>Caller
                LastClickTime <span class="token operator">=</span> <span class="token keyword">CDbl</span><span class="token punctuation">(</span>Timer<span class="token punctuation">)</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><p>This routine will cause the shape to functionally ignore the first click, only running your desired code on the second click within the specified time span.</p> <h2 id="open-file-dialog-multiple-files"><a href="#open-file-dialog-multiple-files" class="header-anchor">#</a> Open File Dialog - Multiple Files</h2> <p>This subroutine is a quick example on how to allow a user to select multiple files and then do something with those file paths, such as get the file names and send it to the console via debug.print.</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Option</span> Explicit

<span class="token keyword">Sub</span> OpenMultipleFiles<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> fd <span class="token keyword">As</span> FileDialog
    <span class="token keyword">Dim</span> fileChosen <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">Dim</span> basename <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> fso <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    <span class="token keyword">Set</span> fso <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Scripting.FileSystemObject&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> fd <span class="token operator">=</span> Application<span class="token punctuation">.</span>FileDialog<span class="token punctuation">(</span>msoFileDialogFilePicker<span class="token punctuation">)</span>
    basename <span class="token operator">=</span> fso<span class="token punctuation">.</span>getBaseName<span class="token punctuation">(</span>ActiveWorkbook<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    fd<span class="token punctuation">.</span>InitialFileName <span class="token operator">=</span> ActiveWorkbook<span class="token punctuation">.</span>Path <span class="token comment">' Set Default Location to the Active Workbook Path</span>
    fd<span class="token punctuation">.</span>InitialView <span class="token operator">=</span> msoFileDialogViewList
    fd<span class="token punctuation">.</span>AllowMultiSelect <span class="token operator">=</span> <span class="token boolean">True</span>
    
    fileChosen <span class="token operator">=</span> fd<span class="token punctuation">.</span>Show
    <span class="token keyword">If</span> fileChosen <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">Then</span>
        <span class="token comment">'open each of the files chosen</span>
        <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> fd<span class="token punctuation">.</span>SelectedItems<span class="token punctuation">.</span>Count
            Debug<span class="token punctuation">.</span>Print <span class="token punctuation">(</span>fd<span class="token punctuation">.</span>SelectedItems<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">Dim</span> fileName <span class="token keyword">As</span> <span class="token keyword">String</span>
            <span class="token comment">' do something with the files.</span>
            fileName <span class="token operator">=</span> fso<span class="token punctuation">.</span>getFileName<span class="token punctuation">(</span>fd<span class="token punctuation">.</span>SelectedItems<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            Debug<span class="token punctuation">.</span>Print <span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>
        <span class="token keyword">Next</span> i
    <span class="token keyword">End</span> <span class="token keyword">If</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code></pre></div><h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>This topic consists of a wide variety of useful tips and tricks discovered by SO users through their experience in coding.  These are often examples of ways to circumvent common frustrations or ways of using Excel in a more &quot;clever&quot; way.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/excelvba/excel-vba-tips-and-tricks.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/excelvba/vba-best-practices.html" class="prev">
        VBA Best Practices
      </a></span> <span class="next"><a href="/excelvba/common-mistakes.html">
        Common Mistakes
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/1079.77501b68.js" defer></script>
  </body>
</html>
