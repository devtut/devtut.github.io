<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MATLAB - Ordinary Differential Equations (ODE) Solvers</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Example for odeset">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="MATLAB - Ordinary Differential Equations (ODE) Solvers">
    <meta property="og:description" content="Example for odeset">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/matlab/ordinary-differential-equations-ode-solvers.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="MATLAB - Ordinary Differential Equations (ODE) Solvers">
    <meta name="twitter:description" content="Example for odeset">
    <meta name="twitter:url" content="/matlab/ordinary-differential-equations-ode-solvers.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/1933.34105057.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MATLAB</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/matlab/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/matlab/getting-started-with-matlab-language.html" class="sidebar-link">Getting started with MATLAB Language</a></li><li><a href="/matlab/initializing-matrices-or-arrays.html" class="sidebar-link">Initializing Matrices or arrays</a></li><li><a href="/matlab/conditions.html" class="sidebar-link">Conditions</a></li><li><a href="/matlab/functions.html" class="sidebar-link">Functions</a></li><li><a href="/matlab/set-operations.html" class="sidebar-link">Set operations</a></li><li><a href="/matlab/documenting-functions.html" class="sidebar-link">Documenting functions</a></li><li><a href="/matlab/using-functions-with-logical-output.html" class="sidebar-link">Using functions with logical output</a></li><li><a href="/matlab/for-loops.html" class="sidebar-link">For loops</a></li><li><a href="/matlab/object-oriented-programming.html" class="sidebar-link">Object-Oriented Programming</a></li><li><a href="/matlab/vectorization.html" class="sidebar-link">Vectorization</a></li><li><a href="/matlab/matrix-decompositions.html" class="sidebar-link">Matrix decompositions</a></li><li><a href="/matlab/graphics-2d-line-plots.html" class="sidebar-link">Graphics: 2D Line Plots</a></li><li><a href="/matlab/graphics-2d-and-3d-transformations.html" class="sidebar-link">Graphics: 2D and 3D Transformations</a></li><li><a href="/matlab/controlling-subplot-coloring-in-matlab.html" class="sidebar-link">Controlling Subplot coloring in Matlab</a></li><li><a href="/matlab/image-processing.html" class="sidebar-link">Image processing</a></li><li><a href="/matlab/drawing.html" class="sidebar-link">Drawing</a></li><li><a href="/matlab/financial-applications.html" class="sidebar-link">Financial Applications</a></li><li><a href="/matlab/fourier-transforms-and-inverse-fourier-transforms.html" class="sidebar-link">Fourier Transforms and Inverse Fourier Transforms</a></li><li><a href="/matlab/ordinary-differential-equations-ode-solvers.html" aria-current="page" class="active sidebar-link">Ordinary Differential Equations (ODE) Solvers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/matlab/ordinary-differential-equations-ode-solvers.html#example-for-odeset" class="sidebar-link">Example for odeset</a></li></ul></li><li><a href="/matlab/interpolation-with-matlab.html" class="sidebar-link">Interpolation with MATLAB</a></li><li><a href="/matlab/integration.html" class="sidebar-link">Integration</a></li><li><a href="/matlab/reading-large-files.html" class="sidebar-link">Reading large files</a></li><li><a href="/matlab/usage-of-accumarray-function.html" class="sidebar-link">Usage of accumarray() Function</a></li><li><a href="/matlab/introduction-to-mex-api.html" class="sidebar-link">Introduction to MEX API</a></li><li><a href="/matlab/debugging.html" class="sidebar-link">Debugging</a></li><li><a href="/matlab/performance-and-benchmarking.html" class="sidebar-link">Performance and Benchmarking</a></li><li><a href="/matlab/multithreading.html" class="sidebar-link">Multithreading</a></li><li><a href="/matlab/using-serial-ports.html" class="sidebar-link">Using serial ports</a></li><li><a href="/matlab/undocumented-features.html" class="sidebar-link">Undocumented Features</a></li><li><a href="/matlab/matlab-best-practices.html" class="sidebar-link">MATLAB Best Practices</a></li><li><a href="/matlab/matlab-user-interfaces.html" class="sidebar-link">MATLAB User Interfaces</a></li><li><a href="/matlab/useful-tricks.html" class="sidebar-link">Useful tricks</a></li><li><a href="/matlab/common-mistakes-and-errors.html" class="sidebar-link">Common mistakes and errors</a></li><li><a href="/matlab/programming-utilities.html" class="sidebar-link">Programming Utilities</a></li><li><a href="/matlab/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ordinary-differential-equations-ode-solvers"><a href="#ordinary-differential-equations-ode-solvers" class="header-anchor">#</a> Ordinary Differential Equations (ODE) Solvers</h1> <h2 id="example-for-odeset"><a href="#example-for-odeset" class="header-anchor">#</a> Example for odeset</h2> <p>First we initialize our initial value problem we want to solve.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>odefun <span class="token operator">=</span> <span class="token operator">@</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token function">cos</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
tspan <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">16</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
y0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>

</code></pre></div><p>We then use the ode45 function without any specified options to solve this problem. To compare it later we plot the trajectory.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code><span class="token punctuation">[</span>t<span class="token punctuation">,</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ode45</span><span class="token punctuation">(</span>odefun<span class="token punctuation">,</span> tspan<span class="token punctuation">,</span> y0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'-o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>We now set a narrow relative and a narrow absolut limit of tolerance for our problem.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>options <span class="token operator">=</span> <span class="token function">odeset</span><span class="token punctuation">(</span><span class="token string">'RelTol'</span><span class="token punctuation">,</span><span class="token number">1e-2</span><span class="token punctuation">,</span><span class="token string">'AbsTol'</span><span class="token punctuation">,</span><span class="token number">1e-2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>t<span class="token punctuation">,</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ode45</span><span class="token punctuation">(</span>odefun<span class="token punctuation">,</span> tspan<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'-o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>We set tight relative and narrow absolut limit of tolerance.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>options <span class="token operator">=</span> <span class="token function">odeset</span><span class="token punctuation">(</span><span class="token string">'RelTol'</span><span class="token punctuation">,</span><span class="token number">1e-7</span><span class="token punctuation">,</span><span class="token string">'AbsTol'</span><span class="token punctuation">,</span><span class="token number">1e-2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>t<span class="token punctuation">,</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ode45</span><span class="token punctuation">(</span>odefun<span class="token punctuation">,</span> tspan<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'-o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>We set narrow relative and tight absolut limit of tolerance. As in the previous examples with narrow limits of tolerance one sees the trajectory being completly different from the first plot without any specific options.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>options <span class="token operator">=</span> <span class="token function">odeset</span><span class="token punctuation">(</span><span class="token string">'RelTol'</span><span class="token punctuation">,</span><span class="token number">1e-2</span><span class="token punctuation">,</span><span class="token string">'AbsTol'</span><span class="token punctuation">,</span><span class="token number">1e-7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>t<span class="token punctuation">,</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ode45</span><span class="token punctuation">(</span>odefun<span class="token punctuation">,</span> tspan<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'-o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>We set tight relative and tight absolut limit of tolerance. Comparing the result with the other plot will underline the errors made calculating with narrow tolerance limits.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>options <span class="token operator">=</span> <span class="token function">odeset</span><span class="token punctuation">(</span><span class="token string">'RelTol'</span><span class="token punctuation">,</span><span class="token number">1e-7</span><span class="token punctuation">,</span><span class="token string">'AbsTol'</span><span class="token punctuation">,</span><span class="token number">1e-7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>t<span class="token punctuation">,</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ode45</span><span class="token punctuation">(</span>odefun<span class="token punctuation">,</span> tspan<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'-o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>The following should demonstrate the trade-off between precision and run-time.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>tic<span class="token punctuation">;</span>
options <span class="token operator">=</span> <span class="token function">odeset</span><span class="token punctuation">(</span><span class="token string">'RelTol'</span><span class="token punctuation">,</span><span class="token number">1e-7</span><span class="token punctuation">,</span><span class="token string">'AbsTol'</span><span class="token punctuation">,</span><span class="token number">1e-7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>t<span class="token punctuation">,</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ode45</span><span class="token punctuation">(</span>odefun<span class="token punctuation">,</span> tspan<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
time1 <span class="token operator">=</span> toc<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'-o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>For comparison we tighten the limit of tolerance for absolute and relative error. We now can see that without large gain in precision it will take considerably longer to solve our initial value problem.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>tic<span class="token punctuation">;</span>
options <span class="token operator">=</span> <span class="token function">odeset</span><span class="token punctuation">(</span><span class="token string">'RelTol'</span><span class="token punctuation">,</span><span class="token number">1e-13</span><span class="token punctuation">,</span><span class="token string">'AbsTol'</span><span class="token punctuation">,</span><span class="token number">1e-13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>t<span class="token punctuation">,</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ode45</span><span class="token punctuation">(</span>odefun<span class="token punctuation">,</span> tspan<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
time2 <span class="token operator">=</span> toc<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'-o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/matlab/ordinary-differential-equations-ode-solvers.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/matlab/fourier-transforms-and-inverse-fourier-transforms.html" class="prev">
        Fourier Transforms and Inverse Fourier Transforms
      </a></span> <span class="next"><a href="/matlab/interpolation-with-matlab.html">
        Interpolation with MATLAB
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/1933.34105057.js" defer></script>
  </body>
</html>
