<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MATLAB - Matrix decompositions</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Cholesky decomposition, QR decomposition, LU decomposition, Schur decomposition, Singular value decomposition">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="MATLAB - Matrix decompositions">
    <meta property="og:description" content="Cholesky decomposition, QR decomposition, LU decomposition, Schur decomposition, Singular value decomposition">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/matlab/matrix-decompositions.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="MATLAB - Matrix decompositions">
    <meta name="twitter:description" content="Cholesky decomposition, QR decomposition, LU decomposition, Schur decomposition, Singular value decomposition">
    <meta name="twitter:url" content="/matlab/matrix-decompositions.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    <link rel="preload" href="/assets/css/0.styles.8b877eb8.css" as="style"><link rel="preload" href="/assets/js/app.ced448ab.js" as="script"><link rel="preload" href="/assets/js/3.f1d73125.js" as="script"><link rel="preload" href="/assets/js/1928.fdf21659.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8b877eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MATLAB</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/matlab/" class="sidebar-link">Disclaimer</a></li><li><a href="/matlab/getting-started-with-matlab-language.html" class="sidebar-link">Getting started with MATLAB Language</a></li><li><a href="/matlab/initializing-matrices-or-arrays.html" class="sidebar-link">Initializing Matrices or arrays</a></li><li><a href="/matlab/conditions.html" class="sidebar-link">Conditions</a></li><li><a href="/matlab/functions.html" class="sidebar-link">Functions</a></li><li><a href="/matlab/set-operations.html" class="sidebar-link">Set operations</a></li><li><a href="/matlab/documenting-functions.html" class="sidebar-link">Documenting functions</a></li><li><a href="/matlab/using-functions-with-logical-output.html" class="sidebar-link">Using functions with logical output</a></li><li><a href="/matlab/for-loops.html" class="sidebar-link">For loops</a></li><li><a href="/matlab/object-oriented-programming.html" class="sidebar-link">Object-Oriented Programming</a></li><li><a href="/matlab/vectorization.html" class="sidebar-link">Vectorization</a></li><li><a href="/matlab/matrix-decompositions.html" class="active sidebar-link">Matrix decompositions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/matlab/matrix-decompositions.html#cholesky-decomposition" class="sidebar-link">Cholesky decomposition</a></li><li class="sidebar-sub-header"><a href="/matlab/matrix-decompositions.html#qr-decomposition" class="sidebar-link">QR decomposition</a></li><li class="sidebar-sub-header"><a href="/matlab/matrix-decompositions.html#lu-decomposition" class="sidebar-link">LU decomposition</a></li><li class="sidebar-sub-header"><a href="/matlab/matrix-decompositions.html#schur-decomposition" class="sidebar-link">Schur decomposition</a></li><li class="sidebar-sub-header"><a href="/matlab/matrix-decompositions.html#singular-value-decomposition" class="sidebar-link">Singular value decomposition</a></li></ul></li><li><a href="/matlab/graphics-2d-line-plots.html" class="sidebar-link">Graphics: 2D Line Plots</a></li><li><a href="/matlab/graphics-2d-and-3d-transformations.html" class="sidebar-link">Graphics: 2D and 3D Transformations</a></li><li><a href="/matlab/controlling-subplot-coloring-in-matlab.html" class="sidebar-link">Controlling Subplot coloring in Matlab</a></li><li><a href="/matlab/image-processing.html" class="sidebar-link">Image processing</a></li><li><a href="/matlab/drawing.html" class="sidebar-link">Drawing</a></li><li><a href="/matlab/financial-applications.html" class="sidebar-link">Financial Applications</a></li><li><a href="/matlab/fourier-transforms-and-inverse-fourier-transforms.html" class="sidebar-link">Fourier Transforms and Inverse Fourier Transforms</a></li><li><a href="/matlab/ordinary-differential-equations-ode-solvers.html" class="sidebar-link">Ordinary Differential Equations (ODE) Solvers</a></li><li><a href="/matlab/interpolation-with-matlab.html" class="sidebar-link">Interpolation with MATLAB</a></li><li><a href="/matlab/integration.html" class="sidebar-link">Integration</a></li><li><a href="/matlab/reading-large-files.html" class="sidebar-link">Reading large files</a></li><li><a href="/matlab/usage-of-accumarray-function.html" class="sidebar-link">Usage of accumarray() Function</a></li><li><a href="/matlab/introduction-to-mex-api.html" class="sidebar-link">Introduction to MEX API</a></li><li><a href="/matlab/debugging.html" class="sidebar-link">Debugging</a></li><li><a href="/matlab/performance-and-benchmarking.html" class="sidebar-link">Performance and Benchmarking</a></li><li><a href="/matlab/multithreading.html" class="sidebar-link">Multithreading</a></li><li><a href="/matlab/using-serial-ports.html" class="sidebar-link">Using serial ports</a></li><li><a href="/matlab/undocumented-features.html" class="sidebar-link">Undocumented Features</a></li><li><a href="/matlab/matlab-best-practices.html" class="sidebar-link">MATLAB Best Practices</a></li><li><a href="/matlab/matlab-user-interfaces.html" class="sidebar-link">MATLAB User Interfaces</a></li><li><a href="/matlab/useful-tricks.html" class="sidebar-link">Useful tricks</a></li><li><a href="/matlab/common-mistakes-and-errors.html" class="sidebar-link">Common mistakes and errors</a></li><li><a href="/matlab/programming-utilities.html" class="sidebar-link">Programming Utilities</a></li><li><a href="/matlab/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="matrix-decompositions"><a href="#matrix-decompositions" class="header-anchor">#</a> Matrix decompositions</h1> <h2 id="cholesky-decomposition"><a href="#cholesky-decomposition" class="header-anchor">#</a> Cholesky decomposition</h2> <p>The Cholesky decomposition is a method to decompose an hermitean, positiv definite matrix into an upper triangular matrix and its transpose. It can be used to solve linear equations systems and and is around twice as fast as LU-decomposition.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>A <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span> <span class="token number">12</span> <span class="token operator">-</span><span class="token number">16</span>
    <span class="token number">12</span> <span class="token number">37</span> <span class="token operator">-</span><span class="token number">43</span>
    <span class="token operator">-</span><span class="token number">16</span> <span class="token operator">-</span><span class="token number">43</span> <span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
R <span class="token operator">=</span> <span class="token function">chol</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>This returns the upper triangular matrix. The lower one is obtained by transposition.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>L <span class="token operator">=</span> R<span class="token operator">'</span><span class="token punctuation">;</span>

</code></pre></div><p>We finally can check whether the decomposition was correct.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>b <span class="token operator">=</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> L<span class="token operator">*</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="qr-decomposition"><a href="#qr-decomposition" class="header-anchor">#</a> QR decomposition</h2> <p>This method will decompose a matrix into an upper triangular and an orthogonal matrix.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>A <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span> <span class="token number">12</span> <span class="token operator">-</span><span class="token number">16</span>
    <span class="token number">12</span> <span class="token number">37</span> <span class="token operator">-</span><span class="token number">43</span>
    <span class="token operator">-</span><span class="token number">16</span> <span class="token operator">-</span><span class="token number">43</span> <span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
R <span class="token operator">=</span> <span class="token function">qr</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>This will return the upper triangular matrix while the following will return both matrices.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code><span class="token punctuation">[</span>Q<span class="token punctuation">,</span>R<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">qr</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>The following plot will display the runtime of <code>qr</code> dependent of the square root of elements of the matrix.
<a href="http://i.stack.imgur.com/yXM8a.jpg" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/yXM8a.jpg" alt="qr-runtime"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="lu-decomposition"><a href="#lu-decomposition" class="header-anchor">#</a> LU decomposition</h2> <p>Hereby a matrix will be decomposed into an upper trangular and an lower triangular matrix. Often it will be used to increase the performance and stability (if it's done with permutation) of Gauß elimination.</p> <p>However, quite often does this method not or badly work as it is not stable. For example</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>A <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span> <span class="token number">1</span> <span class="token number">6</span>
    <span class="token number">3</span> <span class="token number">5</span> <span class="token number">7</span>
    <span class="token number">4</span> <span class="token number">9</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>L<span class="token punctuation">,</span>U<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">lu</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>It is sufficient to add an permutation matrix such that PA=LU:</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code><span class="token punctuation">[</span>L<span class="token punctuation">,</span>U<span class="token punctuation">,</span>P<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">lu</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>In the following we will now plot the runtime of `lu' dependent of the square root of elements of the matrix.
<a href="http://i.stack.imgur.com/cnhNK.jpg" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/cnhNK.jpg" alt="lu-runtime"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="schur-decomposition"><a href="#schur-decomposition" class="header-anchor">#</a> Schur decomposition</h2> <p>If A is a complex and quadratic matrix there exists a unitary Q such that Q*AQ = T = D + N with D being the diagonal matrix consisting of the eigenvalues and N being strictly upper tridiagonal.</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code>A <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span> <span class="token number">6</span> <span class="token number">1</span>
    <span class="token number">23</span> <span class="token number">13</span> <span class="token number">1</span>
    <span class="token number">0</span> <span class="token number">3</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
T <span class="token operator">=</span> <span class="token function">schur</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>We also display the runtime of <code>schur</code> dependent on the square root of matrix elements:
<a href="http://i.stack.imgur.com/1wnKd.jpg" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/1wnKd.jpg" alt="schur-runtime"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="singular-value-decomposition"><a href="#singular-value-decomposition" class="header-anchor">#</a> Singular value decomposition</h2> <p>Given an m times n matrix A with n larger than m. The singular value decomposition</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code><span class="token punctuation">[</span>U<span class="token punctuation">,</span>S<span class="token punctuation">,</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">svd</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>computes the matrices U,S,V.</p> <p>The matrix U consists of the left singular eigenvectors which are the eigenvectors of <code>A*A.'</code> while V consists of the right singular eigenvalues which are the eigenvectors of <code>A.'*A</code>. The matrix <code>S</code> has the square roots of the eigenvalues of <code>A*A.'</code> and <code>A.'*A</code> on its diagonal.</p> <p>If m is larger than n one can use</p> <div class="language-matlab extra-class"><pre class="language-matlab"><code><span class="token punctuation">[</span>U<span class="token punctuation">,</span>S<span class="token punctuation">,</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">svd</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token string">'econ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>to perform economy sized singular value decomposition.</p> <h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <ol><li>R = chol(A);</li> <li>[L,U] = lu(A);</li> <li>R = qr(A);</li> <li>T = schur(A);</li> <li>[U,S,V] = svd(A);</li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/matlab/matrix-decompositions.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/matlab/vectorization.html" class="prev">
        Vectorization
      </a></span> <span class="next"><a href="/matlab/graphics-2d-line-plots.html">
        Graphics: 2D Line Plots
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ced448ab.js" defer></script><script src="/assets/js/3.f1d73125.js" defer></script><script src="/assets/js/1928.fdf21659.js" defer></script>
  </body>
</html>
