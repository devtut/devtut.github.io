<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ruby on Rails - ActiveRecord Validations</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Validating length of an attribute, Validating presence of an attribute, Custom validations, Validates format of an attribute, Validating numericality of an attribute, Grouping validation, Validates inclusion of an attribute, Validate uniqueness of an attribute, Skipping Validations, Conditional validation, Confirmation of attribute, Using :on option ">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Ruby on Rails - ActiveRecord Validations">
    <meta property="og:description" content="Validating length of an attribute, Validating presence of an attribute, Custom validations, Validates format of an attribute, Validating numericality of an attribute, Grouping validation, Validates inclusion of an attribute, Validate uniqueness of an attribute, Skipping Validations, Conditional validation, Confirmation of attribute, Using :on option ">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/rubyonrails/activerecord-validations.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Ruby on Rails - ActiveRecord Validations">
    <meta name="twitter:description" content="Validating length of an attribute, Validating presence of an attribute, Custom validations, Validates format of an attribute, Validating numericality of an attribute, Grouping validation, Validates inclusion of an attribute, Validate uniqueness of an attribute, Skipping Validations, Conditional validation, Confirmation of attribute, Using :on option ">
    <meta name="twitter:url" content="/rubyonrails/activerecord-validations.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3134.cc1ac597.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Ruby on Rails</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rubyonrails/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/rubyonrails/getting-started-with-ruby-on-rails.html" class="sidebar-link">Getting started with Ruby on Rails</a></li><li><a href="/rubyonrails/routing.html" class="sidebar-link">Routing</a></li><li><a href="/rubyonrails/activerecord.html" class="sidebar-link">ActiveRecord</a></li><li><a href="/rubyonrails/views.html" class="sidebar-link">Views</a></li><li><a href="/rubyonrails/activerecord-migrations.html" class="sidebar-link">ActiveRecord Migrations</a></li><li><a href="/rubyonrails/rails-best-practices.html" class="sidebar-link">Rails Best Practices</a></li><li><a href="/rubyonrails/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/rubyonrails/actioncable.html" class="sidebar-link">ActionCable</a></li><li><a href="/rubyonrails/activemodel.html" class="sidebar-link">ActiveModel</a></li><li><a href="/rubyonrails/user-authentication-in-rails.html" class="sidebar-link">User Authentication in Rails</a></li><li><a href="/rubyonrails/activerecord-associations.html" class="sidebar-link">ActiveRecord Associations</a></li><li><a href="/rubyonrails/activerecord-validations.html" aria-current="page" class="active sidebar-link">ActiveRecord Validations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#validating-length-of-an-attribute" class="sidebar-link">Validating length of an attribute</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#validating-presence-of-an-attribute" class="sidebar-link">Validating presence of an attribute</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#custom-validations" class="sidebar-link">Custom validations</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#validates-format-of-an-attribute" class="sidebar-link">Validates format of an attribute</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#validating-numericality-of-an-attribute" class="sidebar-link">Validating numericality of an attribute</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#grouping-validation" class="sidebar-link">Grouping validation</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#validates-inclusion-of-an-attribute" class="sidebar-link">Validates inclusion of an attribute</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#validate-uniqueness-of-an-attribute" class="sidebar-link">Validate uniqueness of an attribute</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#skipping-validations" class="sidebar-link">Skipping Validations</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#conditional-validation" class="sidebar-link">Conditional validation</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#confirmation-of-attribute" class="sidebar-link">Confirmation of attribute</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/activerecord-validations.html#using-on-option" class="sidebar-link">Using :on option</a></li></ul></li><li><a href="/rubyonrails/activerecord-query-interface.html" class="sidebar-link">ActiveRecord Query Interface</a></li><li><a href="/rubyonrails/actionmailer.html" class="sidebar-link">ActionMailer</a></li><li><a href="/rubyonrails/rails-generate-commands.html" class="sidebar-link">Rails generate commands</a></li><li><a href="/rubyonrails/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/rubyonrails/i18n-internationalization.html" class="sidebar-link">I18n - Internationalization</a></li><li><a href="/rubyonrails/using-googlemaps-with-rails.html" class="sidebar-link">Using GoogleMaps with Rails</a></li><li><a href="/rubyonrails/file-uploads.html" class="sidebar-link">File Uploads</a></li><li><a href="/rubyonrails/caching.html" class="sidebar-link">Caching</a></li><li><a href="/rubyonrails/actioncontroller.html" class="sidebar-link">ActionController</a></li><li><a href="/rubyonrails/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/rubyonrails/safe-constantize.html" class="sidebar-link">Safe Constantize</a></li><li><a href="/rubyonrails/rails-5.html" class="sidebar-link">Rails 5</a></li><li><a href="/rubyonrails/authorization-with-cancan.html" class="sidebar-link">Authorization with CanCan</a></li><li><a href="/rubyonrails/mongoid.html" class="sidebar-link">Mongoid</a></li><li><a href="/rubyonrails/gems.html" class="sidebar-link">Gems</a></li><li><a href="/rubyonrails/change-default-timezone.html" class="sidebar-link">Change default timezone</a></li><li><a href="/rubyonrails/asset-pipeline.html" class="sidebar-link">Asset Pipeline</a></li><li><a href="/rubyonrails/upgrading-rails.html" class="sidebar-link">Upgrading Rails</a></li><li><a href="/rubyonrails/activerecord-locking.html" class="sidebar-link">ActiveRecord Locking</a></li><li><a href="/rubyonrails/debugging.html" class="sidebar-link">Debugging</a></li><li><a href="/rubyonrails/configure-angular-with-rails.html" class="sidebar-link">Configure Angular with Rails</a></li><li><a href="/rubyonrails/rails-logger.html" class="sidebar-link">Rails logger</a></li><li><a href="/rubyonrails/prawn-pdf.html" class="sidebar-link">Prawn PDF</a></li><li><a href="/rubyonrails/rails-api.html" class="sidebar-link">Rails API</a></li><li><a href="/rubyonrails/deploying-a-rails-app-on-heroku.html" class="sidebar-link">Deploying a Rails app on Heroku</a></li><li><a href="/rubyonrails/activesupport.html" class="sidebar-link">ActiveSupport</a></li><li><a href="/rubyonrails/form-helpers.html" class="sidebar-link">Form Helpers</a></li><li><a href="/rubyonrails/activerecord-transactions.html" class="sidebar-link">ActiveRecord Transactions</a></li><li><a href="/rubyonrails/rspec-and-ruby-on-rails.html" class="sidebar-link">RSpec and Ruby on Rails</a></li><li><a href="/rubyonrails/decorator-pattern.html" class="sidebar-link">Decorator pattern</a></li><li><a href="/rubyonrails/elasticsearch.html" class="sidebar-link">Elasticsearch</a></li><li><a href="/rubyonrails/react-with-rails-using-react-rails-gem.html" class="sidebar-link">React with Rails using react-rails gem</a></li><li><a href="/rubyonrails/rails-cookbook-advanced-rails-recipes-learnings-and-coding-techniques.html" class="sidebar-link">Rails Cookbook - Advanced rails recipes/learnings and coding techniques</a></li><li><a href="/rubyonrails/multipurpose-activerecord-columns.html" class="sidebar-link">Multipurpose ActiveRecord columns</a></li><li><a href="/rubyonrails/class-organization.html" class="sidebar-link">Class Organization</a></li><li><a href="/rubyonrails/shallow-routing.html" class="sidebar-link">Shallow Routing</a></li><li><a href="/rubyonrails/model-states-aasm.html" class="sidebar-link">Model states: AASM</a></li><li><a href="/rubyonrails/rails-5-api-authetication.html" class="sidebar-link">Rails 5 API Authetication</a></li><li><a href="/rubyonrails/testing-rails-applications.html" class="sidebar-link">Testing Rails Applications</a></li><li><a href="/rubyonrails/active-jobs.html" class="sidebar-link">Active Jobs</a></li><li><a href="/rubyonrails/rails-frameworks-over-the-years.html" class="sidebar-link">Rails frameworks over the years</a></li><li><a href="/rubyonrails/nested-form-in-ruby-on-rails.html" class="sidebar-link">Nested form in Ruby on Rails</a></li><li><a href="/rubyonrails/factory-girl.html" class="sidebar-link">Factory Girl</a></li><li><a href="/rubyonrails/import-whole-csv-files-from-specific-folder.html" class="sidebar-link">Import whole CSV files from specific folder</a></li><li><a href="/rubyonrails/tools-for-ruby-on-rails-code-optimization-and-cleanup.html" class="sidebar-link">Tools for Ruby on Rails code optimization and cleanup</a></li><li><a href="/rubyonrails/activejob.html" class="sidebar-link">ActiveJob</a></li><li><a href="/rubyonrails/active-model-serializers.html" class="sidebar-link">Active Model Serializers</a></li><li><a href="/rubyonrails/rails-engine-modular-rails.html" class="sidebar-link">Rails Engine -  Modular Rails</a></li><li><a href="/rubyonrails/single-table-inheritance.html" class="sidebar-link">Single Table Inheritance</a></li><li><a href="/rubyonrails/activerecord-transactions.html" class="sidebar-link">ActiveRecord Transactions</a></li><li><a href="/rubyonrails/turbolinks.html" class="sidebar-link">Turbolinks</a></li><li><a href="/rubyonrails/friendly-id.html" class="sidebar-link">Friendly ID</a></li><li><a href="/rubyonrails/securely-storing-authentication-keys.html" class="sidebar-link">Securely storing authentication keys</a></li><li><a href="/rubyonrails/authenticate-api-using-devise.html" class="sidebar-link">Authenticate Api using Devise</a></li><li><a href="/rubyonrails/integrating-react-js-with-rails-using-hyperloop.html" class="sidebar-link">Integrating React.js with Rails Using Hyperloop</a></li><li><a href="/rubyonrails/change-a-default-rails-application-enviornment.html" class="sidebar-link">Change a default Rails application enviornment</a></li><li><a href="/rubyonrails/rails-engines.html" class="sidebar-link">Rails -Engines</a></li><li><a href="/rubyonrails/adding-an-amazon-rds-to-your-rails-application.html" class="sidebar-link">Adding an Amazon RDS to your rails application</a></li><li><a href="/rubyonrails/payment-feature-in-rails.html" class="sidebar-link">Payment feature in rails</a></li><li><a href="/rubyonrails/rails-on-docker.html" class="sidebar-link">Rails on docker</a></li><li><a href="/rubyonrails/reserved-words.html" class="sidebar-link">Reserved Words</a></li><li><a href="/rubyonrails/add-admin-panel.html" class="sidebar-link">Add Admin Panel</a></li><li><a href="/rubyonrails/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="activerecord-validations"><a href="#activerecord-validations" class="header-anchor">#</a> ActiveRecord Validations</h1> <h2 id="validating-length-of-an-attribute"><a href="#validating-length-of-an-attribute" class="header-anchor">#</a> Validating length of an attribute</h2> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token punctuation">{</span> minimum<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
  validates <span class="token symbol">:bio</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token punctuation">{</span> maximum<span class="token punctuation">:</span> <span class="token number">500</span> <span class="token punctuation">}</span>
  validates <span class="token symbol">:password</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token number">6.</span><span class="token number">.20</span> <span class="token punctuation">}</span>
  validates <span class="token symbol">:registration_number</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token punctuation">{</span> is<span class="token punctuation">:</span> <span class="token number">6</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>

</code></pre></div><p>The possible length constraint options are:</p> <ul><li><code>:minimum</code> - The attribute cannot have less than the specified length.</li> <li><code>:maximum</code> - The attribute cannot have more than the specified length.</li> <li><code>:in</code> (or <code>:within</code>) - The attribute length must be included in a given interval. The value for this option must be a range.</li> <li><code>:is</code> - The attribute length must be equal to the given value.</li></ul> <h2 id="validating-presence-of-an-attribute"><a href="#validating-presence-of-an-attribute" class="header-anchor">#</a> Validating presence of an attribute</h2> <p>This helper validates that the specified attributes are not empty.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token keyword">end</span>

<span class="token constant">Person</span><span class="token punctuation">.</span>create<span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>valid<span class="token operator">?</span> <span class="token comment"># =&gt; true</span>
<span class="token constant">Person</span><span class="token punctuation">.</span>create<span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token keyword">nil</span><span class="token punctuation">)</span><span class="token punctuation">.</span>valid<span class="token operator">?</span> <span class="token comment"># =&gt; false</span>

</code></pre></div><p>You can use the <code>absence</code> helper to validate that the specified attributes are absent. It uses the <code>present?</code> method to check for nil or empty values.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> <span class="token symbol">:login</span><span class="token punctuation">,</span> <span class="token symbol">:email</span><span class="token punctuation">,</span> absence<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token keyword">end</span>

</code></pre></div><p><strong>Note:</strong>
In case the attribute is a <code>boolean</code> one, you cannot make use of the usual presence validation (the attribute would not be valid for a <code>false</code> value). You can get this done by using an inclusion validation:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>validates <span class="token symbol">:attribute</span><span class="token punctuation">,</span> inclusion<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span>

</code></pre></div><h2 id="custom-validations"><a href="#custom-validations" class="header-anchor">#</a> Custom validations</h2> <p>You can add your own validations adding new classes inheriting from <code>ActiveModel::Validator</code> or from <code>ActiveModel::EachValidator</code>. Both methods are similar but they work in a slightly different ways:</p> <h3 id="activemodel-validator-and-validates-with"><a href="#activemodel-validator-and-validates-with" class="header-anchor">#</a> <code>ActiveModel::Validator</code> and <code>validates_with</code></h3> <p>Implement the <code>validate</code> method which takes a record as an argument and performs the validation on it. Then use <code>validates_with</code> with the class on the model.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># app/validators/starts_with_a_validator.rb</span>
<span class="token keyword">class</span> <span class="token class-name">StartsWithAValidator</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveModel</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Validator</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">validate</span></span><span class="token punctuation">(</span>record<span class="token punctuation">)</span>
    <span class="token keyword">unless</span> record<span class="token punctuation">.</span>name<span class="token punctuation">.</span>starts_with<span class="token operator">?</span> <span class="token string">'A'</span>
      record<span class="token punctuation">.</span>errors<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token string">'Need a name starting with A please!'</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
 
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates_with <span class="token constant">StartsWithAValidator</span>
<span class="token keyword">end</span>

</code></pre></div><h3 id="activemodel-eachvalidator-and-validate"><a href="#activemodel-eachvalidator-and-validate" class="header-anchor">#</a> <code>ActiveModel::EachValidator</code> and <code>validate</code></h3> <p>If you prefer to use your new validator using the common <code>validate</code> method on a single param, create a class inheriting from <code>ActiveModel::EachValidator</code> and implement the <code>validate_each</code> method which takes three arguments: <code>record</code>, <code>attribute</code>, and <code>value</code>:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">EmailValidator</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveModel</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">EachValidator</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">validate_each</span></span><span class="token punctuation">(</span>record<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
    <span class="token keyword">unless</span> value <span class="token operator">=</span><span class="token operator">~</span> <span class="token regex">/\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z/i</span>
      record<span class="token punctuation">.</span>errors<span class="token punctuation">[</span>attribute<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token punctuation">(</span>options<span class="token punctuation">[</span><span class="token symbol">:message</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">'is not an email'</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
 
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:email</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> email<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token keyword">end</span>

</code></pre></div><p>More information on the <a href="http://guides.rubyonrails.org/active_record_validations.html#performing-custom-validations" target="_blank" rel="noopener noreferrer">Rails guides<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="validates-format-of-an-attribute"><a href="#validates-format-of-an-attribute" class="header-anchor">#</a> Validates format of an attribute</h2> <p>Validate that an attribute's value matches a regular expression using <code>format</code> and the <code>with</code> option.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> format<span class="token punctuation">:</span> <span class="token punctuation">{</span> with<span class="token punctuation">:</span> <span class="token regex">/\A\w{6,10}\z/</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>

</code></pre></div><p>You can also define a constant and set its value to a regular expression and pass it to the <code>with:</code> option. This might be more convenient for really complex regular expressions</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token constant">PHONE_REGEX</span> <span class="token operator">=</span> <span class="token regex">/\A\(\d{3}\)\d{3}-\d{4}\z/</span>
validates <span class="token symbol">:phone</span><span class="token punctuation">,</span> format<span class="token punctuation">:</span> <span class="token punctuation">{</span> with<span class="token punctuation">:</span> <span class="token constant">PHONE_REGEX</span> <span class="token punctuation">}</span>

</code></pre></div><p>The default error message is <code>is invalid</code>. This can be changed with the <code>:message</code> option.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>validates <span class="token symbol">:bio</span><span class="token punctuation">,</span> format<span class="token punctuation">:</span> <span class="token punctuation">{</span> with<span class="token punctuation">:</span> <span class="token regex">/\A\D+\z/</span><span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token string">&quot;Numbers are not allowed&quot;</span> <span class="token punctuation">}</span>

</code></pre></div><p>The reverse also replies, and you can specify that a value should <strong>not</strong> match a regular expression with the <code>without:</code> option</p> <h2 id="validating-numericality-of-an-attribute"><a href="#validating-numericality-of-an-attribute" class="header-anchor">#</a> Validating numericality of an attribute</h2> <p>This validation restricts the insertion of only numeric values.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Player</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:points</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token boolean">true</span>
  validates <span class="token symbol">:games_played</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token punctuation">{</span> only_integer<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>

</code></pre></div><p>Besides <code>:only_integer</code>, this helper also accepts the following options to add constraints to acceptable values:</p> <ul><li><code>:greater_than</code> - Specifies the value must be greater than the supplied value. The default error message for this option is &quot;must be greater than %{count}&quot;.</li> <li><code>:greater_than_or_equal_to</code> - Specifies the value must be greater than or equal to the supplied value. The default error message for this option is &quot;must be greater than or equal to %{count}&quot;.</li> <li><code>:equal_to</code> - Specifies the value must be equal to the supplied value. The default error message for this option is &quot;must be equal to %{count}&quot;.</li> <li><code>:less_than</code> - Specifies the value must be less than the supplied value. The default error message for this option is &quot;must be less than %{count}&quot;.</li> <li><code>:less_than_or_equal_to</code> - Specifies the value must be less than or equal to the supplied value. The default error message for this option is &quot;must be less than or equal to %{count}&quot;.</li> <li><code>:other_than</code> - Specifies the value must be other than the supplied value. The default error message for this option is &quot;must be other than %{count}&quot;.</li> <li><code>:odd</code> - Specifies the value must be an odd number if set to true. The default error message for this option is &quot;must be odd&quot;.</li> <li><code>:even</code> - Specifies the value must be an even number if set to true. The default error message for this option is &quot;must be even&quot;.</li></ul> <blockquote></blockquote> <p>By default, numericality doesn't allow nil values. You can use allow_nil: true option to permit it.</p> <h2 id="grouping-validation"><a href="#grouping-validation" class="header-anchor">#</a> Grouping validation</h2> <p>Sometimes it is useful to have multiple validations use one condition. It can be easily achieved using with_options.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  with_options <span class="token keyword">if</span><span class="token punctuation">:</span> <span class="token symbol">:is_admin?</span> <span class="token keyword">do</span> <span class="token operator">|</span>admin<span class="token operator">|</span>
    admin<span class="token punctuation">.</span>validates <span class="token symbol">:password</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token punctuation">{</span> minimum<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span>
    admin<span class="token punctuation">.</span>validates <span class="token symbol">:email</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

</code></pre></div><p>All validations inside of the with_options block will have automatically passed the condition if: :is_admin?</p> <h2 id="validates-inclusion-of-an-attribute"><a href="#validates-inclusion-of-an-attribute" class="header-anchor">#</a> Validates inclusion of an attribute</h2> <p>You can check if a value is included in an array using the <code>inclusion:</code> helper. The <code>:in</code> option and its alias, <code>:within</code> show the set of acceptable values.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Country</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:continent</span><span class="token punctuation">,</span> inclusion<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token string">%w(Africa Antartica Asia Australia
                                            Europe North America South America)</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>

</code></pre></div><p>To check if a value is not included in an array, use the <code>exclusion:</code> helper</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> exclusion<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token string">%w(admin administrator owner)</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>

</code></pre></div><h2 id="validate-uniqueness-of-an-attribute"><a href="#validate-uniqueness-of-an-attribute" class="header-anchor">#</a> Validate uniqueness of an attribute</h2> <p>This helper validates that the attribute's value is unique right before the object gets saved.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:email</span><span class="token punctuation">,</span> uniqueness<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token keyword">end</span>

</code></pre></div><p>There is a <code>:scope</code> option that you can use to specify one or more attributes that are used to limit the uniqueness check:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Holiday</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> uniqueness<span class="token punctuation">:</span> <span class="token punctuation">{</span> scope<span class="token punctuation">:</span> <span class="token symbol">:year</span><span class="token punctuation">,</span>
    message<span class="token punctuation">:</span> <span class="token string">&quot;should happen once per year&quot;</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>

</code></pre></div><p>There is also a <code>:case_sensitive</code> option that you can use to define whether the uniqueness constraint will be case sensitive or not. This option defaults to <code>true</code>.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> uniqueness<span class="token punctuation">:</span> <span class="token punctuation">{</span> case_sensitive<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>

</code></pre></div><h2 id="skipping-validations"><a href="#skipping-validations" class="header-anchor">#</a> Skipping Validations</h2> <p>Use following methods if you want to skip the validations. These methods will save the object to the database even if it is invalid.</p> <ul><li>decrement!</li> <li>decrement_counter</li> <li>increment!</li> <li>increment_counter</li> <li>toggle!</li> <li>touch</li> <li>update_all</li> <li>update_attribute</li> <li>update_column</li> <li>update_columns</li> <li>update_counters</li></ul> <p>You can also skip validation while saving by passing <code>validate</code> as an argument to <code>save</code></p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token constant">User</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span>validate<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="conditional-validation"><a href="#conditional-validation" class="header-anchor">#</a> Conditional validation</h2> <p>Sometimes you may need to validate record only under certain conditions.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">if</span><span class="token punctuation">:</span> <span class="token symbol">:admin?</span> 

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">admin</span></span><span class="token operator">?</span>
    conditional here that returns boolean value
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

</code></pre></div><p>If you conditional is really small, you can use a Proc:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:first_name</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">if</span><span class="token punctuation">:</span> <span class="token builtin">Proc</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>user<span class="token operator">|</span> user<span class="token punctuation">.</span>last_name<span class="token punctuation">.</span>blank<span class="token operator">?</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>

</code></pre></div><p>For negative conditional you can use <code>unless</code>:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:first_name</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">unless</span><span class="token punctuation">:</span> <span class="token builtin">Proc</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token operator">|</span>user<span class="token operator">|</span> user<span class="token punctuation">.</span>last_name<span class="token punctuation">.</span>present<span class="token operator">?</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>

</code></pre></div><p>You can also pass a string, which will be executed via <code>instance_eval</code>:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:first_name</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">if</span><span class="token punctuation">:</span> <span class="token string">'last_name.blank?'</span>
<span class="token keyword">end</span>

</code></pre></div><h2 id="confirmation-of-attribute"><a href="#confirmation-of-attribute" class="header-anchor">#</a> Confirmation of attribute</h2> <p>You should use this when you have two text fields that should receive exactly the same content. For example, you may want to confirm an email address or a password. This validation creates a <strong><strong>virtual</strong></strong> attribute whose name is the name of the field that has to be confirmed with <code>_confirmation</code> appended.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:email</span><span class="token punctuation">,</span> confirmation<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token keyword">end</span>

</code></pre></div><p><strong>Note</strong> This check is performed only if <code>email_confirmation</code> is not nil.</p> <p>To require confirmation, make sure to add a presence check for the confirmation attribute.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:email</span><span class="token punctuation">,</span>      confirmation<span class="token punctuation">:</span> <span class="token boolean">true</span>
  validates <span class="token symbol">:email_confirmation</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token keyword">end</span>

</code></pre></div><p><a href="http://guides.rubyonrails.org/active_record_validations.html" target="_blank" rel="noopener noreferrer">Source<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="using-on-option"><a href="#using-on-option" class="header-anchor">#</a> Using :on option</h2> <p>The <code>:on</code> option lets you specify when the validation should happen.
The default behavior for all the built-in validation helpers is to be run on save (both when you're creating a new record and when you're updating it).</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  <span class="token comment"># it will be possible to update email with a duplicated value</span>
  validates <span class="token symbol">:email</span><span class="token punctuation">,</span> uniqueness<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> on<span class="token punctuation">:</span> <span class="token symbol">:create</span>
 
  <span class="token comment"># it will be possible to create the record with a non-numerical age</span>
  validates <span class="token symbol">:age</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> on<span class="token punctuation">:</span> <span class="token symbol">:update</span>
 
  <span class="token comment"># the default (validates on both create and update)</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token keyword">end</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/rubyonrails/activerecord-validations.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/rubyonrails/activerecord-associations.html" class="prev">
        ActiveRecord Associations
      </a></span> <span class="next"><a href="/rubyonrails/activerecord-query-interface.html">
        ActiveRecord Query Interface
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3134.cc1ac597.js" defer></script>
  </body>
</html>
