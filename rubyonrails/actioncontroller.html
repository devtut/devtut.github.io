<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ruby on Rails - ActionController</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Basic REST Controller, Output JSON instead of HTML, Controllers (Basic), Parameters, Filtering parameters (Basic), Redirecting, Using Views, Display error pages for exceptions, Filters, Generating a controller, Rescuing ActiveRecord::RecordNotFound with redirect_to, 404 when record not found">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="Ruby on Rails - ActionController">
    <meta property="og:description" content="Basic REST Controller, Output JSON instead of HTML, Controllers (Basic), Parameters, Filtering parameters (Basic), Redirecting, Using Views, Display error pages for exceptions, Filters, Generating a controller, Rescuing ActiveRecord::RecordNotFound with redirect_to, 404 when record not found">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/rubyonrails/actioncontroller.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="Ruby on Rails - ActionController">
    <meta name="twitter:description" content="Basic REST Controller, Output JSON instead of HTML, Controllers (Basic), Parameters, Filtering parameters (Basic), Redirecting, Using Views, Display error pages for exceptions, Filters, Generating a controller, Rescuing ActiveRecord::RecordNotFound with redirect_to, 404 when record not found">
    <meta name="twitter:url" content="/rubyonrails/actioncontroller.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3123.b3512a8b.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Ruby on Rails</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rubyonrails/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/rubyonrails/getting-started-with-ruby-on-rails.html" class="sidebar-link">Getting started with Ruby on Rails</a></li><li><a href="/rubyonrails/routing.html" class="sidebar-link">Routing</a></li><li><a href="/rubyonrails/activerecord.html" class="sidebar-link">ActiveRecord</a></li><li><a href="/rubyonrails/views.html" class="sidebar-link">Views</a></li><li><a href="/rubyonrails/activerecord-migrations.html" class="sidebar-link">ActiveRecord Migrations</a></li><li><a href="/rubyonrails/rails-best-practices.html" class="sidebar-link">Rails Best Practices</a></li><li><a href="/rubyonrails/naming-conventions.html" class="sidebar-link">Naming Conventions</a></li><li><a href="/rubyonrails/actioncable.html" class="sidebar-link">ActionCable</a></li><li><a href="/rubyonrails/activemodel.html" class="sidebar-link">ActiveModel</a></li><li><a href="/rubyonrails/user-authentication-in-rails.html" class="sidebar-link">User Authentication in Rails</a></li><li><a href="/rubyonrails/activerecord-associations.html" class="sidebar-link">ActiveRecord Associations</a></li><li><a href="/rubyonrails/activerecord-validations.html" class="sidebar-link">ActiveRecord Validations</a></li><li><a href="/rubyonrails/activerecord-query-interface.html" class="sidebar-link">ActiveRecord Query Interface</a></li><li><a href="/rubyonrails/actionmailer.html" class="sidebar-link">ActionMailer</a></li><li><a href="/rubyonrails/rails-generate-commands.html" class="sidebar-link">Rails generate commands</a></li><li><a href="/rubyonrails/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/rubyonrails/i18n-internationalization.html" class="sidebar-link">I18n - Internationalization</a></li><li><a href="/rubyonrails/using-googlemaps-with-rails.html" class="sidebar-link">Using GoogleMaps with Rails</a></li><li><a href="/rubyonrails/file-uploads.html" class="sidebar-link">File Uploads</a></li><li><a href="/rubyonrails/caching.html" class="sidebar-link">Caching</a></li><li><a href="/rubyonrails/actioncontroller.html" aria-current="page" class="active sidebar-link">ActionController</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#basic-rest-controller" class="sidebar-link">Basic REST Controller</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#output-json-instead-of-html" class="sidebar-link">Output JSON instead of HTML</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#controllers-basic" class="sidebar-link">Controllers (Basic)</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#parameters" class="sidebar-link">Parameters</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#filtering-parameters-basic" class="sidebar-link">Filtering parameters (Basic)</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#redirecting" class="sidebar-link">Redirecting</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#using-views" class="sidebar-link">Using Views</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#display-error-pages-for-exceptions" class="sidebar-link">Display error pages for exceptions</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#filters" class="sidebar-link">Filters</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#generating-a-controller" class="sidebar-link">Generating a controller</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#rescuing-activerecord-recordnotfound-with-redirect-to" class="sidebar-link">Rescuing ActiveRecord::RecordNotFound with redirect_to</a></li><li class="sidebar-sub-header"><a href="/rubyonrails/actioncontroller.html#_404-when-record-not-found" class="sidebar-link">404 when record not found</a></li></ul></li><li><a href="/rubyonrails/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/rubyonrails/safe-constantize.html" class="sidebar-link">Safe Constantize</a></li><li><a href="/rubyonrails/rails-5.html" class="sidebar-link">Rails 5</a></li><li><a href="/rubyonrails/authorization-with-cancan.html" class="sidebar-link">Authorization with CanCan</a></li><li><a href="/rubyonrails/mongoid.html" class="sidebar-link">Mongoid</a></li><li><a href="/rubyonrails/gems.html" class="sidebar-link">Gems</a></li><li><a href="/rubyonrails/change-default-timezone.html" class="sidebar-link">Change default timezone</a></li><li><a href="/rubyonrails/asset-pipeline.html" class="sidebar-link">Asset Pipeline</a></li><li><a href="/rubyonrails/upgrading-rails.html" class="sidebar-link">Upgrading Rails</a></li><li><a href="/rubyonrails/activerecord-locking.html" class="sidebar-link">ActiveRecord Locking</a></li><li><a href="/rubyonrails/debugging.html" class="sidebar-link">Debugging</a></li><li><a href="/rubyonrails/configure-angular-with-rails.html" class="sidebar-link">Configure Angular with Rails</a></li><li><a href="/rubyonrails/rails-logger.html" class="sidebar-link">Rails logger</a></li><li><a href="/rubyonrails/prawn-pdf.html" class="sidebar-link">Prawn PDF</a></li><li><a href="/rubyonrails/rails-api.html" class="sidebar-link">Rails API</a></li><li><a href="/rubyonrails/deploying-a-rails-app-on-heroku.html" class="sidebar-link">Deploying a Rails app on Heroku</a></li><li><a href="/rubyonrails/activesupport.html" class="sidebar-link">ActiveSupport</a></li><li><a href="/rubyonrails/form-helpers.html" class="sidebar-link">Form Helpers</a></li><li><a href="/rubyonrails/activerecord-transactions.html" class="sidebar-link">ActiveRecord Transactions</a></li><li><a href="/rubyonrails/rspec-and-ruby-on-rails.html" class="sidebar-link">RSpec and Ruby on Rails</a></li><li><a href="/rubyonrails/decorator-pattern.html" class="sidebar-link">Decorator pattern</a></li><li><a href="/rubyonrails/elasticsearch.html" class="sidebar-link">Elasticsearch</a></li><li><a href="/rubyonrails/react-with-rails-using-react-rails-gem.html" class="sidebar-link">React with Rails using react-rails gem</a></li><li><a href="/rubyonrails/rails-cookbook-advanced-rails-recipes-learnings-and-coding-techniques.html" class="sidebar-link">Rails Cookbook - Advanced rails recipes/learnings and coding techniques</a></li><li><a href="/rubyonrails/multipurpose-activerecord-columns.html" class="sidebar-link">Multipurpose ActiveRecord columns</a></li><li><a href="/rubyonrails/class-organization.html" class="sidebar-link">Class Organization</a></li><li><a href="/rubyonrails/shallow-routing.html" class="sidebar-link">Shallow Routing</a></li><li><a href="/rubyonrails/model-states-aasm.html" class="sidebar-link">Model states: AASM</a></li><li><a href="/rubyonrails/rails-5-api-authetication.html" class="sidebar-link">Rails 5 API Authetication</a></li><li><a href="/rubyonrails/testing-rails-applications.html" class="sidebar-link">Testing Rails Applications</a></li><li><a href="/rubyonrails/active-jobs.html" class="sidebar-link">Active Jobs</a></li><li><a href="/rubyonrails/rails-frameworks-over-the-years.html" class="sidebar-link">Rails frameworks over the years</a></li><li><a href="/rubyonrails/nested-form-in-ruby-on-rails.html" class="sidebar-link">Nested form in Ruby on Rails</a></li><li><a href="/rubyonrails/factory-girl.html" class="sidebar-link">Factory Girl</a></li><li><a href="/rubyonrails/import-whole-csv-files-from-specific-folder.html" class="sidebar-link">Import whole CSV files from specific folder</a></li><li><a href="/rubyonrails/tools-for-ruby-on-rails-code-optimization-and-cleanup.html" class="sidebar-link">Tools for Ruby on Rails code optimization and cleanup</a></li><li><a href="/rubyonrails/activejob.html" class="sidebar-link">ActiveJob</a></li><li><a href="/rubyonrails/active-model-serializers.html" class="sidebar-link">Active Model Serializers</a></li><li><a href="/rubyonrails/rails-engine-modular-rails.html" class="sidebar-link">Rails Engine -  Modular Rails</a></li><li><a href="/rubyonrails/single-table-inheritance.html" class="sidebar-link">Single Table Inheritance</a></li><li><a href="/rubyonrails/activerecord-transactions.html" class="sidebar-link">ActiveRecord Transactions</a></li><li><a href="/rubyonrails/turbolinks.html" class="sidebar-link">Turbolinks</a></li><li><a href="/rubyonrails/friendly-id.html" class="sidebar-link">Friendly ID</a></li><li><a href="/rubyonrails/securely-storing-authentication-keys.html" class="sidebar-link">Securely storing authentication keys</a></li><li><a href="/rubyonrails/authenticate-api-using-devise.html" class="sidebar-link">Authenticate Api using Devise</a></li><li><a href="/rubyonrails/integrating-react-js-with-rails-using-hyperloop.html" class="sidebar-link">Integrating React.js with Rails Using Hyperloop</a></li><li><a href="/rubyonrails/change-a-default-rails-application-enviornment.html" class="sidebar-link">Change a default Rails application enviornment</a></li><li><a href="/rubyonrails/rails-engines.html" class="sidebar-link">Rails -Engines</a></li><li><a href="/rubyonrails/adding-an-amazon-rds-to-your-rails-application.html" class="sidebar-link">Adding an Amazon RDS to your rails application</a></li><li><a href="/rubyonrails/payment-feature-in-rails.html" class="sidebar-link">Payment feature in rails</a></li><li><a href="/rubyonrails/rails-on-docker.html" class="sidebar-link">Rails on docker</a></li><li><a href="/rubyonrails/reserved-words.html" class="sidebar-link">Reserved Words</a></li><li><a href="/rubyonrails/add-admin-panel.html" class="sidebar-link">Add Admin Panel</a></li><li><a href="/rubyonrails/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="actioncontroller"><a href="#actioncontroller" class="header-anchor">#</a> ActionController</h1> <p>Action Controller is the C in MVC. After the router has determined which controller to use for a request, the controller is responsible for making sense of the request and producing the output.</p> <p>The controller will receive the request, fetch or save data from a model and use a view to create output. A controller can be thought of as a middleman between models and views. It makes the model data available to the view so it can display to the user, and it saves or updates user data to the model.</p> <h2 id="basic-rest-controller"><a href="#basic-rest-controller" class="header-anchor">#</a> Basic REST Controller</h2> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">PostsController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  before_action <span class="token symbol">:set_post</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:show</span><span class="token punctuation">,</span> <span class="token symbol">:edit</span><span class="token punctuation">,</span> <span class="token symbol">:update</span><span class="token punctuation">,</span> <span class="token symbol">:destroy</span><span class="token punctuation">]</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">index</span></span>
    <span class="token variable">@posts</span> <span class="token operator">=</span> <span class="token constant">Post</span><span class="token punctuation">.</span>all
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">show</span></span>
    
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">new</span></span>
    <span class="token variable">@post</span> <span class="token operator">=</span> <span class="token constant">Post</span><span class="token punctuation">.</span><span class="token keyword">new</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">edit</span></span>

  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">create</span></span>
    <span class="token variable">@post</span> <span class="token operator">=</span> <span class="token constant">Post</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>post_params<span class="token punctuation">)</span>

    respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
      <span class="token keyword">if</span> <span class="token variable">@post</span><span class="token punctuation">.</span>save
        format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> redirect_to <span class="token variable">@post</span><span class="token punctuation">,</span> notice<span class="token punctuation">:</span> <span class="token string">'Post was successfully created.'</span> <span class="token punctuation">}</span>
        format<span class="token punctuation">.</span>json <span class="token punctuation">{</span> render <span class="token symbol">:show</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token symbol">:created</span><span class="token punctuation">,</span> location<span class="token punctuation">:</span> <span class="token variable">@post</span> <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
        format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> render <span class="token symbol">:new</span> <span class="token punctuation">}</span>
        format<span class="token punctuation">.</span>json <span class="token punctuation">{</span> render json<span class="token punctuation">:</span> <span class="token variable">@post</span><span class="token punctuation">.</span>errors<span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token symbol">:unprocessable_entity</span> <span class="token punctuation">}</span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">update</span></span>
    respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
      <span class="token keyword">if</span> <span class="token variable">@post</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span>post_params<span class="token punctuation">)</span>
        format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> redirect_to <span class="token variable">@post</span><span class="token punctuation">.</span>company<span class="token punctuation">,</span> notice<span class="token punctuation">:</span> <span class="token string">'Post was successfully updated.'</span> <span class="token punctuation">}</span>
        format<span class="token punctuation">.</span>json <span class="token punctuation">{</span> render <span class="token symbol">:show</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token symbol">:ok</span><span class="token punctuation">,</span> location<span class="token punctuation">:</span> <span class="token variable">@post</span> <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
        format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> render <span class="token symbol">:edit</span> <span class="token punctuation">}</span>
        format<span class="token punctuation">.</span>json <span class="token punctuation">{</span> render json<span class="token punctuation">:</span> <span class="token variable">@post</span><span class="token punctuation">.</span>errors<span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token symbol">:unprocessable_entity</span> <span class="token punctuation">}</span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">destroy</span></span>
    <span class="token variable">@post</span><span class="token punctuation">.</span>destroy
    respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
      format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> redirect_to posts_url<span class="token punctuation">,</span> notice<span class="token punctuation">:</span> <span class="token string">'Post was successfully destroyed.'</span> <span class="token punctuation">}</span>
      format<span class="token punctuation">.</span>json <span class="token punctuation">{</span> head <span class="token symbol">:no_content</span> <span class="token punctuation">}</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token keyword">private</span>
    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">set_post</span></span>
      <span class="token variable">@post</span> <span class="token operator">=</span> <span class="token constant">Post</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">post_params</span></span>
      params<span class="token punctuation">.</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token symbol">:post</span><span class="token punctuation">)</span><span class="token punctuation">.</span>permit<span class="token punctuation">(</span><span class="token symbol">:title</span><span class="token punctuation">,</span> <span class="token symbol">:body</span><span class="token punctuation">,</span> <span class="token symbol">:author</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

</code></pre></div><h2 id="output-json-instead-of-html"><a href="#output-json-instead-of-html" class="header-anchor">#</a> Output JSON instead of HTML</h2> <p>In addition you will need the route:</p> <p>This will respond in two different ways to requests on <code>/users</code>:</p> <ul><li>If you visit <code>/users</code> or <code>/users.html</code>, it will show an html page with the content <code>Hello World</code></li> <li>If you visit <code>/users.json</code>, it will display a JSON object containing:</li></ul> <p>You can <strong>omit</strong> <code>format.html { render inline: &quot;Hello World&quot; }</code> if you want to make sure that your route will answer only to JSON requests.</p> <h2 id="controllers-basic"><a href="#controllers-basic" class="header-anchor">#</a> Controllers (Basic)</h2> <p>This is a basic controller, with the addition of the following route (in routes.rb):</p> <p>Will display the <code>Hello World</code> message in a webpage when you access the URL <code>/users</code></p> <h2 id="parameters"><a href="#parameters" class="header-anchor">#</a> Parameters</h2> <p>Controllers have access to HTTP parameters (you might know them as <code>?name=foo</code> in URLs, but Ruby on Rails handle different formats too!) and output different responses based on them. There isn't a way to distinguish between GET and POST parameters, but you shouldn't do that in any case.</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">UsersController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">index</span></span>
    respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
      format<span class="token punctuation">.</span>html <span class="token keyword">do</span>
        <span class="token keyword">if</span> params<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;john&quot;</span>
          render html<span class="token punctuation">:</span> <span class="token string">&quot;Hello John&quot;</span>
        <span class="token keyword">else</span>
          render html<span class="token punctuation">:</span> <span class="token string">&quot;Hello someone&quot;</span>
        <span class="token keyword">end</span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span> 
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

</code></pre></div><p>As usual our route:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>resources <span class="token symbol">:users</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">]</span>

</code></pre></div><p>Access the URL <code>/users?name=john</code> and the output will be <code>Hello John</code>, access <code>/users?name=whatever</code> and the output will be <code>Hello someone</code></p> <h2 id="filtering-parameters-basic"><a href="#filtering-parameters-basic" class="header-anchor">#</a> Filtering parameters (Basic)</h2> <p>You can allow (or reject) some params so that only what you want will <strong>pass through</strong> and you won't have bad surprises like user setting options not meant to be changed.</p> <p>Visiting <code>/users?name=john&amp;sentence=developer</code> will display <code>Hello john developer</code>, however visiting <code>/users?name=smith&amp;sentence=spy</code> will display <code>Hello smith</code> only, because <code>:sentence</code> is only allowed when you access as <code>john</code></p> <h2 id="redirecting"><a href="#redirecting" class="header-anchor">#</a> Redirecting</h2> <p>Assuming the route:</p> <p>You can redirect to a different URL using:</p> <p>You can go back to the previous page the user visited using:</p> <p>Note that in <strong>Rails 5</strong> the syntax for redirecting back is different:</p> <p>Which will try to redirect to the previous page and in case not possible (the browser is blocking the HTTP_REFERRER header), it will redirect to <code>:fallback_location</code></p> <h2 id="using-views"><a href="#using-views" class="header-anchor">#</a> Using Views</h2> <p>Assuming the route:</p> <p>And the controller:</p> <p>The view <code>app/users/index.html.erb</code> will be rendered. If the view is:</p> <p>The output will be a webpage with the text: &quot;Hello <strong>World</strong>&quot;</p> <p>If you want to render a different view, you can use:</p> <p>And the file <code>app/views/pages/home.html.erb</code> will be used instead.</p> <p>You can pass variables to views using controller instance variables:</p> <p>And in the file <code>app/views/users/index.html.erb</code> you can use <code>@name</code>:</p> <p>And the output will be: &quot;Hello <strong>john</strong>&quot;</p> <p>An important note around the render syntax, you can omit the <code>render</code> syntax entirely, Rails assumes that if you omit it. So:</p> <p>Can be written instead as:</p> <p>Rails is smart enough to figure out that it must render the file <code>app/views/users/index.html.erb</code>.</p> <h2 id="display-error-pages-for-exceptions"><a href="#display-error-pages-for-exceptions" class="header-anchor">#</a> Display error pages for exceptions</h2> <p>If you want to display to your users meaningful errors instead of simple &quot;sorry, something went wrong&quot;, Rails has a nice utility for the purpose.</p> <p>Open the file <code>app/controllers/application_controller.rb</code> and you should find something like this:</p> <p>We can now add a <code>rescue_from</code> to recover from specific errors:</p> <p>It's recommended not to rescue from <code>Exception</code> or <code>StandardError</code> otherwise Rails won't be able to display helpful pages in case of errors.</p> <h2 id="filters"><a href="#filters" class="header-anchor">#</a> Filters</h2> <p>Filters are methods that are run &quot;before&quot;, &quot;after&quot; or &quot;around&quot; a controller action. They are inherited, so if you set any in your <code>ApplicationController</code> they will be run for every request your application receives.</p> <p><strong>Before Filter</strong></p> <p>Before filters are executed before the controller action and can halt the request (and/or redirect). A common use is to verify if a user is logged in:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">ApplicationController</span> <span class="token operator">&lt;</span> <span class="token constant">ActionController</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span>
  before_action <span class="token symbol">:authenticate_user!</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">authenticate_user</span></span><span class="token operator">!</span>
    redirect_to some_path <span class="token keyword">unless</span> user_signed_in<span class="token operator">?</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

</code></pre></div><p>Before filters are run on requests before the request gets to the controller’s action. It can return a response itself and completely bypass the action.</p> <p>Other common uses of before filters is validating a user’s authentication before granting them access to the action designated to handle their request. I’ve also seen them used to load a resource from the database, check permissions on a resource, or manage redirects under other circumstances.</p> <p><strong>After Filter</strong></p> <p>After filters are similar to &quot;before&quot; ones, but as they get executed after the action run they have access the response object that's about to be sent. So in short after filters are run after the action completes. It can modify the response. Most of the time if something is done in an after filter, it can be done in the action itself, but if there is some logic to be run after running any of a set of actions, then an after filter is a good place to do it.</p> <p>Generally, I’ve seen after and around filters used for logging.</p> <p><strong>Around Filter</strong></p> <p>Around filters may have logic before and after the action being run. It simply yields to the action in whatever place is necessary. Note that it doesn’t need to yield to the action and may run without doing so like a before filter.</p> <p>Around filters are responsible for running their associated actions by yielding, similar to how Rack middlewares work.</p> <p>Around callbacks wrap the execution of actions. You can write an around callback in two different styles. In the first, the callback is a single chunk of code. That code is called before the action is executed. If the callback code invokes yield, the action is executed. When the action completes, the callback code continues executing. Thus, the code before the yield is like a before action callback and the code after the yield is the after action callback. If the callback code never invokes yield. the action is not run-this is the same as having a before action callback return false.</p> <p>Here's an example of the around filter:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>around_filter <span class="token symbol">:catch_exceptions</span>
 
<span class="token keyword">private</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">catch_exceptions</span></span>
    <span class="token keyword">begin</span>
      <span class="token keyword">yield</span>
    <span class="token keyword">rescue</span> <span class="token builtin">Exception</span> <span class="token operator">=</span><span class="token operator">&gt;</span> e 
      logger<span class="token punctuation">.</span>debug <span class="token string">&quot;Caught exception! <span class="token interpolation"><span class="token delimiter tag">#{</span>e<span class="token punctuation">.</span>message<span class="token delimiter tag">}</span></span>&quot;</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

</code></pre></div><p>This will catch exception of any action and put the message in your log. You can use around filters for exception handling, setup and teardown, and a myriad of other cases.</p> <p><strong>Only and Except</strong></p> <p>All filters can be applied to specific actions, using <code>:only</code> and <code>:except</code>:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">ProductsController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  before_action <span class="token symbol">:set_product</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:show</span><span class="token punctuation">,</span> <span class="token symbol">:edit</span><span class="token punctuation">,</span> <span class="token symbol">:update</span><span class="token punctuation">]</span>

  <span class="token comment"># ... controller actions</span>

  <span class="token comment"># Define your filters as controller private methods</span>
  <span class="token keyword">private</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">set_product</span></span>
    <span class="token variable">@product</span> <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

</code></pre></div><p><strong>Skipping Filter</strong></p> <p>All filters (inherited ones too) can also be skipped for some specific actions:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">ApplicationController</span> <span class="token operator">&lt;</span> <span class="token constant">ActionController</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span>
  before_action <span class="token symbol">:authenticate_user!</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">authenticate_user</span></span><span class="token operator">!</span>
    redirect_to some_path <span class="token keyword">unless</span> user_signed_in<span class="token operator">?</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">class</span> <span class="token class-name">HomeController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  skip_before_action <span class="token symbol">:authenticate_user!</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">]</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">index</span></span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

</code></pre></div><p>As they're inherited, filters can also be defined in a <code>namespace</code> &quot;parent&quot; controller. Say for example that you have an <code>admin</code> namespace, and you of course want only admin users to be able to access it. You could do something like this:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># config/routes.rb</span>
namespace <span class="token symbol">:admin</span> <span class="token keyword">do</span>
  resources <span class="token symbol">:products</span>
<span class="token keyword">end</span>

<span class="token comment"># app/controllers/admin_controller.rb</span>
<span class="token keyword">class</span> <span class="token class-name">AdminController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  before_action <span class="token symbol">:authenticate_admin_user!</span>

  <span class="token keyword">private</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">authenticate_admin_user</span></span><span class="token operator">!</span>
    redirect_to root_path <span class="token keyword">unless</span> current_user<span class="token punctuation">.</span>admin<span class="token operator">?</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment"># app/controllers/admin/products_controller.rb</span>
<span class="token keyword">class</span> <span class="token class-name">Admin</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">ProductsController</span> <span class="token operator">&lt;</span> <span class="token constant">AdminController</span>
  <span class="token comment"># This controller will inherit :authenticate_admin_user! filter</span>
<span class="token keyword">end</span>

</code></pre></div><p>Beware that in <strong>Rails 4.x</strong> you could use <code>before_filter</code> along with <code>before_action</code>, but <code>before_filter</code> is currently deprecated in <strong>Rails 5.0.0</strong> and will be removed in <strong>5.1</strong>.</p> <h2 id="generating-a-controller"><a href="#generating-a-controller" class="header-anchor">#</a> Generating a controller</h2> <p>Rails provides a lot of generators, for controllers too of course.</p> <p>You can generate a new controller by running this command in your app folder</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>rails generate controller <span class="token constant">NAME</span> <span class="token punctuation">[</span>action action<span class="token punctuation">]</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span>

</code></pre></div><p><strong>Note: You can also use <code>rails g</code> alias to invoke <code>rails generate</code></strong></p> <p>For example, to generate a controller for a <code>Product</code> model, with <code>#index</code> and <code>#show</code> actions you would run</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>rails generate controller products index show

</code></pre></div><p>This will create the controller in <code>app/controllers/products_controller.rb</code>, with both the actions you specified</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">ProductsController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">index</span></span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">show</span></span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

</code></pre></div><p>It will also create a <code>products</code> folder inside <code>app/views/</code>, containing the two templates for your controller's actions (i.e. <code>index.html.erb</code> and <code>show.html.erb</code>, <strong>note that the extension may vary according to your template engine, so if you're using <code>slim</code>, for example, generator will create <code>index.html.slim</code> and <code>show.html.slim</code></strong> )</p> <p>Furthermore, if you specified any actions they will also be added to your <code>routes</code> file</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># config/routes.rb</span>
get <span class="token string">'products/show'</span>
get <span class="token string">'products/index'</span>

</code></pre></div><p>Rails creates a helper file for you, in <code>app/helpers/products_helper.rb</code>, and also the assets files in <code>app/assets/javascripts/products.js</code> and <code>app/assets/stylesheets/products.css</code>. As for views, the generator changes this behaviour according to what's specified in your <code>Gemfile</code>: i.e., if you're using <code>Coffeescript</code> and <code>Sass</code> in your application, the controller generator will instead generator <code>products.coffee</code> and <code>products.sass</code>.</p> <p>At last, but not least, Rails also generates test files for your controller, your helper and your views.</p> <p>If you don't want any of these to be created for you can tell Rails to skip them, just prepend any option with</p> <p><code>--no-</code> or <code>--skip</code>, like this:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>rails generate controller products index show <span class="token operator">--</span>no<span class="token operator">-</span>assets <span class="token operator">--</span>no<span class="token operator">-</span>helper

</code></pre></div><p>And the generator will skip both <code>assets</code> and <code>helper</code></p> <p>If you need to create a controller for a specific <strong><code>namespace</code></strong> add it in front of <code>NAME</code>:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>rails generate controller admin<span class="token operator">/</span>products

</code></pre></div><p>This will create your controller inside <code>app/controllers/admin/products_controller.rb</code></p> <p>Rails can also generate a complete RESTful controller for you:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>rails generate scaffold_controller <span class="token constant">MODEL_NAME</span> <span class="token comment"># available from Rails 4</span>
rails generate scaffold_controller <span class="token constant">Product</span>

</code></pre></div><h2 id="rescuing-activerecord-recordnotfound-with-redirect-to"><a href="#rescuing-activerecord-recordnotfound-with-redirect-to" class="header-anchor">#</a> Rescuing ActiveRecord::RecordNotFound with redirect_to</h2> <p>You can rescue a RecordNotFound exception with a redirect instead of showing an error page:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">ApplicationController</span> <span class="token operator">&lt;</span> <span class="token constant">ActionController</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span>

  <span class="token comment"># your other stuff</span>

  rescue_from <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">RecordNotFound</span> <span class="token keyword">do</span> <span class="token operator">|</span>exception<span class="token operator">|</span>
    redirect_to root_path<span class="token punctuation">,</span> <span class="token number">404</span><span class="token punctuation">,</span> alert<span class="token punctuation">:</span> <span class="token constant">I18n</span><span class="token punctuation">.</span>t<span class="token punctuation">(</span><span class="token string">&quot;errors.record_not_found&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

</code></pre></div><h2 id="_404-when-record-not-found"><a href="#_404-when-record-not-found" class="header-anchor">#</a> 404 when record not found</h2> <p>Rescue from record not found error instead of showing an exception or white page:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">ApplicationController</span> <span class="token operator">&lt;</span> <span class="token constant">ActionController</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span>
  
  <span class="token comment"># ... your other stuff here </span>

  rescue_from <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">RecordNotFound</span> <span class="token keyword">do</span> <span class="token operator">|</span>exception<span class="token operator">|</span>
    redirect_to root_path<span class="token punctuation">,</span> <span class="token number">404</span><span class="token punctuation">,</span> alert<span class="token punctuation">:</span> <span class="token string">'Record not found'</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/rubyonrails/actioncontroller.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/rubyonrails/caching.html" class="prev">
        Caching
      </a></span> <span class="next"><a href="/rubyonrails/configuration.html">
        Configuration
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3123.b3512a8b.js" defer></script>
  </body>
</html>
