<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>.NET Framework - VB Forms</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Hello World in VB.NET Forms, For Beginners, Forms Timer">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content=".NET Framework - VB Forms">
    <meta property="og:description" content="Hello World in VB.NET Forms, For Beginners, Forms Timer">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/dotnet/vb-forms.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content=".NET Framework - VB Forms">
    <meta name="twitter:description" content="Hello World in VB.NET Forms, For Beginners, Forms Timer">
    <meta name="twitter:url" content="/dotnet/vb-forms.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/1038.9b3f296a.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>.NET Framework</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dotnet/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/dotnet/getting-started-with-net-framework.html" class="sidebar-link">Getting started with .NET Framework</a></li><li><a href="/dotnet/strings.html" class="sidebar-link">Strings</a></li><li><a href="/dotnet/datetime-parsing.html" class="sidebar-link">DateTime parsing</a></li><li><a href="/dotnet/dictionaries.html" class="sidebar-link">Dictionaries</a></li><li><a href="/dotnet/collections.html" class="sidebar-link">Collections</a></li><li><a href="/dotnet/readonlycollections.html" class="sidebar-link">ReadOnlyCollections</a></li><li><a href="/dotnet/stack-and-heap.html" class="sidebar-link">Stack and Heap</a></li><li><a href="/dotnet/linq.html" class="sidebar-link">LINQ</a></li><li><a href="/dotnet/foreach.html" class="sidebar-link">ForEach</a></li><li><a href="/dotnet/reflection.html" class="sidebar-link">Reflection</a></li><li><a href="/dotnet/expression-trees.html" class="sidebar-link">Expression Trees</a></li><li><a href="/dotnet/custom-types.html" class="sidebar-link">Custom Types</a></li><li><a href="/dotnet/code-contracts.html" class="sidebar-link">Code Contracts</a></li><li><a href="/dotnet/settings.html" class="sidebar-link">Settings</a></li><li><a href="/dotnet/regular-expressions-system-text-regularexpressions.html" class="sidebar-link">Regular Expressions (System.Text.RegularExpressions)</a></li><li><a href="/dotnet/file-input-output.html" class="sidebar-link">File Input/Output</a></li><li><a href="/dotnet/system-io.html" class="sidebar-link">System.IO</a></li><li><a href="/dotnet/system-io-file-class.html" class="sidebar-link">System.IO.File class</a></li><li><a href="/dotnet/reading-and-writing-zip-files.html" class="sidebar-link">Reading and writing Zip files</a></li><li><a href="/dotnet/managed-extensibility-framework.html" class="sidebar-link">Managed Extensibility Framework</a></li><li><a href="/dotnet/speechrecognitionengine-class-to-recognize-speech.html" class="sidebar-link">SpeechRecognitionEngine class to recognize speech</a></li><li><a href="/dotnet/system-runtime-caching-memorycache-objectcache.html" class="sidebar-link">System.Runtime.Caching.MemoryCache (ObjectCache)</a></li><li><a href="/dotnet/system-reflection-emit-namespace.html" class="sidebar-link">System.Reflection.Emit namespace</a></li><li><a href="/dotnet/net-core.html" class="sidebar-link">.NET Core</a></li><li><a href="/dotnet/ado-net.html" class="sidebar-link">ADO.NET</a></li><li><a href="/dotnet/dependency-injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/dotnet/platform-invoke.html" class="sidebar-link">Platform Invoke</a></li><li><a href="/dotnet/nuget-packaging-system.html" class="sidebar-link">NuGet packaging system</a></li><li><a href="/dotnet/globalization-in-asp-net-mvc-using-smart-internationalization-for-asp-net.html" class="sidebar-link">Globalization in ASP.NET MVC using Smart internationalization for ASP.NET</a></li><li><a href="/dotnet/system-net-mail.html" class="sidebar-link">System.Net.Mail</a></li><li><a href="/dotnet/using-progress-t-and-iprogress-t.html" class="sidebar-link">Using Progress</a></li><li><a href="/dotnet/json-serialization.html" class="sidebar-link">JSON Serialization</a></li><li><a href="/dotnet/json-in-net-with-newtonsoft-json.html" class="sidebar-link">JSON in .NET with Newtonsoft.Json</a></li><li><a href="/dotnet/xmlserializer.html" class="sidebar-link">XmlSerializer</a></li><li><a href="/dotnet/vb-forms.html" aria-current="page" class="active sidebar-link">VB Forms</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dotnet/vb-forms.html#hello-world-in-vb-net-forms" class="sidebar-link">Hello World in VB.NET Forms</a></li><li class="sidebar-sub-header"><a href="/dotnet/vb-forms.html#for-beginners" class="sidebar-link">For Beginners</a></li><li class="sidebar-sub-header"><a href="/dotnet/vb-forms.html#forms-timer" class="sidebar-link">Forms Timer</a></li></ul></li><li><a href="/dotnet/jit-compiler.html" class="sidebar-link">JIT compiler</a></li><li><a href="/dotnet/clr.html" class="sidebar-link">CLR</a></li><li><a href="/dotnet/tpl-dataflow.html" class="sidebar-link">TPL Dataflow</a></li><li><a href="/dotnet/threading.html" class="sidebar-link">Threading</a></li><li><a href="/dotnet/process-and-thread-affinity-setting.html" class="sidebar-link">Process and Thread affinity setting</a></li><li><a href="/dotnet/parallel-processing-using-net-framework.html" class="sidebar-link">Parallel processing using .Net framework</a></li><li><a href="/dotnet/task-parallel-library-tpl.html" class="sidebar-link">Task Parallel Library (TPL)</a></li><li><a href="/dotnet/task-parallel-library-tpl-api-overviews.html" class="sidebar-link">Task Parallel Library (TPL) API Overviews</a></li><li><a href="/dotnet/synchronization-contexts.html" class="sidebar-link">Synchronization Contexts</a></li><li><a href="/dotnet/memory-management.html" class="sidebar-link">Memory management</a></li><li><a href="/dotnet/garbage-collection.html" class="sidebar-link">Garbage Collection</a></li><li><a href="/dotnet/exceptions.html" class="sidebar-link">Exceptions</a></li><li><a href="/dotnet/system-diagnostics.html" class="sidebar-link">System.Diagnostics</a></li><li><a href="/dotnet/encryption-cryptography.html" class="sidebar-link">Encryption / Cryptography</a></li><li><a href="/dotnet/work-with-sha1-in-c.html" class="sidebar-link">Work with SHA1 in C#</a></li><li><a href="/dotnet/unit-testing.html" class="sidebar-link">Unit testing</a></li><li><a href="/dotnet/write-to-and-read-from-stderr-stream.html" class="sidebar-link">Write to and read from StdErr stream</a></li><li><a href="/dotnet/upload-file-and-post-data-to-webserver.html" class="sidebar-link">Upload file and POST data to webserver</a></li><li><a href="/dotnet/networking.html" class="sidebar-link">Networking</a></li><li><a href="/dotnet/http-servers.html" class="sidebar-link">HTTP servers</a></li><li><a href="/dotnet/http-clients.html" class="sidebar-link">HTTP clients</a></li><li><a href="/dotnet/serial-ports.html" class="sidebar-link">Serial Ports</a></li><li><a href="/dotnet/acronym-glossary.html" class="sidebar-link">Acronym Glossary</a></li><li><a href="/dotnet/work-with-sha1-in-c.html" class="sidebar-link">Work with SHA1 in C#</a></li><li><a href="/dotnet/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vb-forms"><a href="#vb-forms" class="header-anchor">#</a> VB Forms</h1> <h2 id="hello-world-in-vb-net-forms"><a href="#hello-world-in-vb-net-forms" class="header-anchor">#</a> Hello World in VB.NET Forms</h2> <p>To show a message box when the form has been shown:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code>Public Class Form1
    Private <span class="token return-type class-name">Sub</span> <span class="token function">Form1_Shown</span><span class="token punctuation">(</span>sender <span class="token class-name">As</span> Object<span class="token punctuation">,</span> e <span class="token class-name">As</span> EventArgs<span class="token punctuation">)</span> Handles <span class="token return-type class-name">MyBase<span class="token punctuation">.</span>Shown</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, World!&quot;</span><span class="token punctuation">)</span>
    End Sub
End Class
To show a message box before the form has <span class="token class-name">been</span> shown<span class="token punctuation">:</span>

Public Class Form1
    Private <span class="token return-type class-name">Sub</span> <span class="token function">Form1_Load</span><span class="token punctuation">(</span>sender <span class="token class-name">As</span> Object<span class="token punctuation">,</span> e <span class="token class-name">As</span> EventArgs<span class="token punctuation">)</span> Handles <span class="token return-type class-name">MyBase<span class="token punctuation">.</span>Load</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, World!&quot;</span><span class="token punctuation">)</span>
    End Sub
End Class

</code></pre></div><p>Load() will be called first, and only once, when the form first loads. Show() will be called every time the user launches the form. Activate() will be called every time the user makes the form active.</p> <p>Load() will execute before Show() is called, but be warned: calling msgBox() in show can cause that msgBox() to execute before Load() is finished. <strong>It is generally a bad idea to depend on event ordering between Load(), Show(), and similar.</strong></p> <h2 id="for-beginners"><a href="#for-beginners" class="header-anchor">#</a> For Beginners</h2> <p>Some things all beginners should know / do that will help them have a good start with VB .Net:</p> <p>Set the following Options:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code>'can be permanently <span class="token keyword">set</span>
' Tools <span class="token operator">/</span> Options <span class="token operator">/</span> Projects <span class="token keyword">and</span> Soluntions <span class="token operator">/</span> VB Defaults
Option Strict On
Option Explicit On
Option Infer Off

Public Class Form1

End Class

</code></pre></div><p><a href="https://msdn.microsoft.com/en-us/library/te2585xw.aspx?f=255&amp;MSPPError=-2147217396" target="_blank" rel="noopener noreferrer">Use &amp;, not + for string concatenation.<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://msdn.microsoft.com/en-us/library/system.string(v=vs.110).aspx" target="_blank" rel="noopener noreferrer">Strings<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> should be studied in some detail as they are widely used.</p> <p>Spend some time understanding <a href="https://msdn.microsoft.com/en-us/library/t63sy5hs.aspx" target="_blank" rel="noopener noreferrer">Value and Reference Types<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Never use <a href="https://msdn.microsoft.com/en-us/library/system.windows.forms.application.doevents%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396" target="_blank" rel="noopener noreferrer">Application.DoEvents<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.  Pay attention to the 'Caution'.  When you reach a point where this seems like something you must use, ask.</p> <p>The <a href="https://social.msdn.microsoft.com/Search/en-US?query=vb%20.net&amp;emptyWatermark=true&amp;searchButtonTooltip=Search%20MSDN&amp;ac=2" target="_blank" rel="noopener noreferrer">documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is your friend.</p> <h2 id="forms-timer"><a href="#forms-timer" class="header-anchor">#</a> Forms Timer</h2> <p>The <a href="https://msdn.microsoft.com/en-us/library/system.windows.forms.timer(v=vs.110).aspx" target="_blank" rel="noopener noreferrer">Windows.Forms.Timer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> component can be used to provide the user information that is <strong>not</strong> time critical.  Create a form with one button, one label, and a Timer component.</p> <p>For example it could be used to show the user the time of day periodically.</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code>'can be permanently <span class="token keyword">set</span>
' Tools <span class="token operator">/</span> Options <span class="token operator">/</span> Projects <span class="token keyword">and</span> Soluntions <span class="token operator">/</span> VB Defaults
Option Strict On
Option Explicit On
Option Infer Off

Public Class Form1

    Private <span class="token return-type class-name">Sub</span> <span class="token function">Button1_Click</span><span class="token punctuation">(</span>sender <span class="token class-name">As</span> Object<span class="token punctuation">,</span> e <span class="token class-name">As</span> EventArgs<span class="token punctuation">)</span> Handles Button1<span class="token punctuation">.</span>Click
        Button1<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> False
        Timer1<span class="token punctuation">.</span>Interval <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span> 'one minute intervals
        'start <span class="token return-type class-name">timer</span>
        Timer1<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        Label1<span class="token punctuation">.</span>Text <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span>ToLongTimeString
    End Sub

    Private <span class="token return-type class-name">Sub</span> <span class="token function">Timer1_Tick</span><span class="token punctuation">(</span>sender <span class="token class-name">As</span> Object<span class="token punctuation">,</span> e <span class="token class-name">As</span> EventArgs<span class="token punctuation">)</span> Handles Timer1<span class="token punctuation">.</span>Tick
        Label1<span class="token punctuation">.</span>Text <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span>ToLongTimeString
    End Sub
End Class

</code></pre></div><p>But this timer is not suited for timing.  An example would be using it for a countdown.  In this example we will simulate a countdown to three minutes.  This may very well be one of the most boringly important examples here.</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code>'can be permanently <span class="token keyword">set</span>
' Tools <span class="token operator">/</span> Options <span class="token operator">/</span> Projects <span class="token keyword">and</span> Soluntions <span class="token operator">/</span> VB Defaults
Option Strict On
Option Explicit On
Option Infer Off

Public Class Form1

    Private <span class="token return-type class-name">Sub</span> <span class="token function">Button1_Click</span><span class="token punctuation">(</span>sender <span class="token class-name">As</span> Object<span class="token punctuation">,</span> e <span class="token class-name">As</span> EventArgs<span class="token punctuation">)</span> Handles Button1<span class="token punctuation">.</span>Click
        Button1<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token class-name">False</span>
        ctSecs <span class="token operator">=</span> <span class="token number">0</span> 'clear count
        Timer1<span class="token punctuation">.</span>Interval <span class="token operator">=</span> <span class="token number">1000</span> '<span class="token class-name">one</span> second <span class="token keyword">in</span> ms<span class="token punctuation">.</span>
        'start <span class="token return-type class-name">timers</span>
        stpw<span class="token punctuation">.</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        stpw<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        Timer1<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    End Sub

    Dim stpw As New Stopwatch
    Dim ctSecs As Integer

    Private <span class="token return-type class-name">Sub</span> <span class="token function">Timer1_Tick</span><span class="token punctuation">(</span>sender <span class="token class-name">As</span> Object<span class="token punctuation">,</span> e <span class="token class-name">As</span> EventArgs<span class="token punctuation">)</span> Handles Timer1<span class="token punctuation">.</span>Tick
        ctSecs <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token class-name">If</span> ctSecs <span class="token operator">=</span> <span class="token number">180</span> Then 'about <span class="token number">2.5</span> seconds off <span class="token keyword">on</span> my PC<span class="token operator">!</span>
            'stop <span class="token return-type class-name">timing</span>
            stpw<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            Timer1<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            'show actual elapsed time
            'Is it near <span class="token number">180</span><span class="token punctuation">?</span>
            Label1<span class="token punctuation">.</span>Text <span class="token operator">=</span> stpw<span class="token punctuation">.</span>Elapsed<span class="token punctuation">.</span>TotalSeconds<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;n1&quot;</span><span class="token punctuation">)</span>
        End If
    End Sub
End Class

</code></pre></div><p>After button1 is clicked, about three minutes pass and label1 shows the results.  Does label1 show 180?  Probably not.  On my machine it showed 182.5!</p> <p>The reason for the discrepancy is in the documentation, &quot;The Windows Forms Timer component is single-threaded, and is limited to an accuracy of 55 milliseconds.&quot;  This is why it shouldn't be used for timing.</p> <p>By using the timer and stopwatch a little differently we can obtain better results.</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code>'can be permanently <span class="token keyword">set</span>
' Tools <span class="token operator">/</span> Options <span class="token operator">/</span> Projects <span class="token keyword">and</span> Soluntions <span class="token operator">/</span> VB Defaults
Option Strict On
Option Explicit On
Option Infer Off

Public Class Form1

    Private <span class="token return-type class-name">Sub</span> <span class="token function">Button1_Click</span><span class="token punctuation">(</span>sender <span class="token class-name">As</span> Object<span class="token punctuation">,</span> e <span class="token class-name">As</span> EventArgs<span class="token punctuation">)</span> Handles Button1<span class="token punctuation">.</span>Click
        Button1<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> False
        Timer1<span class="token punctuation">.</span>Interval <span class="token operator">=</span> <span class="token number">100</span> 'one tenth of <span class="token class-name">a</span> second <span class="token keyword">in</span> ms<span class="token punctuation">.</span>
        'start <span class="token return-type class-name">timers</span>
        stpw<span class="token punctuation">.</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        stpw<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        Timer1<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    End Sub

    Dim stpw As New Stopwatch
    Dim threeMinutes <span class="token class-name">As</span> TimeSpan <span class="token operator">=</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromMinutes</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

    Private <span class="token return-type class-name">Sub</span> <span class="token function">Timer1_Tick</span><span class="token punctuation">(</span>sender <span class="token class-name">As</span> Object<span class="token punctuation">,</span> e <span class="token class-name">As</span> EventArgs<span class="token punctuation">)</span> Handles Timer1<span class="token punctuation">.</span>Tick
        If stpw<span class="token punctuation">.</span>Elapsed <span class="token operator">&gt;=</span> threeMinutes Then '<span class="token number">0.1</span> off <span class="token keyword">on</span> my PC<span class="token operator">!</span>
            'stop <span class="token return-type class-name">timing</span>
            stpw<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            Timer1<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            'show actual elapsed time
            'how close<span class="token punctuation">?</span>
            Label1<span class="token punctuation">.</span>Text <span class="token operator">=</span> stpw<span class="token punctuation">.</span>Elapsed<span class="token punctuation">.</span>TotalSeconds<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;n1&quot;</span><span class="token punctuation">)</span>
        End If
    End Sub
End Class

</code></pre></div><p>There are other timers that can be used as needed.  This <a href="https://social.msdn.microsoft.com/Search/en-US?query=vb%20.net%20windows%20timers&amp;emptyWatermark=true&amp;searchButtonTooltip=Search%20MSDN&amp;ac=5#refinementChanges=117&amp;pageNumber=1&amp;showMore=false" target="_blank" rel="noopener noreferrer">search<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> should help in that regard.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/dotnet/vb-forms.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/dotnet/xmlserializer.html" class="prev">
        XmlSerializer
      </a></span> <span class="next"><a href="/dotnet/jit-compiler.html">
        JIT compiler
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/1038.9b3f296a.js" defer></script>
  </body>
</html>
