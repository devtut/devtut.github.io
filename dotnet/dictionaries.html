<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>.NET Framework - Dictionaries</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Initializing a Dictionary with a Collection Initializer, Adding to a Dictionary, Getting a value from a dictionary, Make a Dictionary<string, T> with Case-Insensivitve keys., Enumerating a Dictionary, ConcurrentDictionary<TKey, TValue> (from .NET 4.0), IEnumerable to Dictionary (≥ .NET 3.5), Removing from a Dictionary, ContainsKey(TKey), Dictionary to List, ConcurrentDictionary augmented with Lazy'1 reduces duplicated computation">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content=".NET Framework - Dictionaries">
    <meta property="og:description" content="Initializing a Dictionary with a Collection Initializer, Adding to a Dictionary, Getting a value from a dictionary, Make a Dictionary<string, T> with Case-Insensivitve keys., Enumerating a Dictionary, ConcurrentDictionary<TKey, TValue> (from .NET 4.0), IEnumerable to Dictionary (≥ .NET 3.5), Removing from a Dictionary, ContainsKey(TKey), Dictionary to List, ConcurrentDictionary augmented with Lazy'1 reduces duplicated computation">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/dotnet/dictionaries.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content=".NET Framework - Dictionaries">
    <meta name="twitter:description" content="Initializing a Dictionary with a Collection Initializer, Adding to a Dictionary, Getting a value from a dictionary, Make a Dictionary<string, T> with Case-Insensivitve keys., Enumerating a Dictionary, ConcurrentDictionary<TKey, TValue> (from .NET 4.0), IEnumerable to Dictionary (≥ .NET 3.5), Removing from a Dictionary, ContainsKey(TKey), Dictionary to List, ConcurrentDictionary augmented with Lazy'1 reduces duplicated computation">
    <meta name="twitter:url" content="/dotnet/dictionaries.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/992.8f94275d.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>.NET Framework</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dotnet/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/dotnet/getting-started-with-net-framework.html" class="sidebar-link">Getting started with .NET Framework</a></li><li><a href="/dotnet/strings.html" class="sidebar-link">Strings</a></li><li><a href="/dotnet/datetime-parsing.html" class="sidebar-link">DateTime parsing</a></li><li><a href="/dotnet/dictionaries.html" aria-current="page" class="active sidebar-link">Dictionaries</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#initializing-a-dictionary-with-a-collection-initializer" class="sidebar-link">Initializing a Dictionary with a Collection Initializer</a></li><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#adding-to-a-dictionary" class="sidebar-link">Adding to a Dictionary</a></li><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#getting-a-value-from-a-dictionary" class="sidebar-link">Getting a value from a dictionary</a></li><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#make-a-dictionary-string-t-with-case-insensivitve-keys" class="sidebar-link">Make a Dictionary with Case-Insensivitve keys.</a></li><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#enumerating-a-dictionary" class="sidebar-link">Enumerating a Dictionary</a></li><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#concurrentdictionary-tkey-tvalue-from-net-4-0" class="sidebar-link">ConcurrentDictionary (from .NET 4.0)</a></li><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#ienumerable-to-dictionary-≥-net-3-5" class="sidebar-link">IEnumerable to Dictionary (≥ .NET 3.5)</a></li><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#removing-from-a-dictionary" class="sidebar-link">Removing from a Dictionary</a></li><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#containskey-tkey" class="sidebar-link">ContainsKey(TKey)</a></li><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#dictionary-to-list" class="sidebar-link">Dictionary to List</a></li><li class="sidebar-sub-header"><a href="/dotnet/dictionaries.html#concurrentdictionary-augmented-with-lazy-1-reduces-duplicated-computation" class="sidebar-link">ConcurrentDictionary augmented with Lazy'1 reduces duplicated computation</a></li></ul></li><li><a href="/dotnet/collections.html" class="sidebar-link">Collections</a></li><li><a href="/dotnet/readonlycollections.html" class="sidebar-link">ReadOnlyCollections</a></li><li><a href="/dotnet/stack-and-heap.html" class="sidebar-link">Stack and Heap</a></li><li><a href="/dotnet/linq.html" class="sidebar-link">LINQ</a></li><li><a href="/dotnet/foreach.html" class="sidebar-link">ForEach</a></li><li><a href="/dotnet/reflection.html" class="sidebar-link">Reflection</a></li><li><a href="/dotnet/expression-trees.html" class="sidebar-link">Expression Trees</a></li><li><a href="/dotnet/custom-types.html" class="sidebar-link">Custom Types</a></li><li><a href="/dotnet/code-contracts.html" class="sidebar-link">Code Contracts</a></li><li><a href="/dotnet/settings.html" class="sidebar-link">Settings</a></li><li><a href="/dotnet/regular-expressions-system-text-regularexpressions.html" class="sidebar-link">Regular Expressions (System.Text.RegularExpressions)</a></li><li><a href="/dotnet/file-input-output.html" class="sidebar-link">File Input/Output</a></li><li><a href="/dotnet/system-io.html" class="sidebar-link">System.IO</a></li><li><a href="/dotnet/system-io-file-class.html" class="sidebar-link">System.IO.File class</a></li><li><a href="/dotnet/reading-and-writing-zip-files.html" class="sidebar-link">Reading and writing Zip files</a></li><li><a href="/dotnet/managed-extensibility-framework.html" class="sidebar-link">Managed Extensibility Framework</a></li><li><a href="/dotnet/speechrecognitionengine-class-to-recognize-speech.html" class="sidebar-link">SpeechRecognitionEngine class to recognize speech</a></li><li><a href="/dotnet/system-runtime-caching-memorycache-objectcache.html" class="sidebar-link">System.Runtime.Caching.MemoryCache (ObjectCache)</a></li><li><a href="/dotnet/system-reflection-emit-namespace.html" class="sidebar-link">System.Reflection.Emit namespace</a></li><li><a href="/dotnet/net-core.html" class="sidebar-link">.NET Core</a></li><li><a href="/dotnet/ado-net.html" class="sidebar-link">ADO.NET</a></li><li><a href="/dotnet/dependency-injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/dotnet/platform-invoke.html" class="sidebar-link">Platform Invoke</a></li><li><a href="/dotnet/nuget-packaging-system.html" class="sidebar-link">NuGet packaging system</a></li><li><a href="/dotnet/globalization-in-asp-net-mvc-using-smart-internationalization-for-asp-net.html" class="sidebar-link">Globalization in ASP.NET MVC using Smart internationalization for ASP.NET</a></li><li><a href="/dotnet/system-net-mail.html" class="sidebar-link">System.Net.Mail</a></li><li><a href="/dotnet/using-progress-t-and-iprogress-t.html" class="sidebar-link">Using Progress</a></li><li><a href="/dotnet/json-serialization.html" class="sidebar-link">JSON Serialization</a></li><li><a href="/dotnet/json-in-net-with-newtonsoft-json.html" class="sidebar-link">JSON in .NET with Newtonsoft.Json</a></li><li><a href="/dotnet/xmlserializer.html" class="sidebar-link">XmlSerializer</a></li><li><a href="/dotnet/vb-forms.html" class="sidebar-link">VB Forms</a></li><li><a href="/dotnet/jit-compiler.html" class="sidebar-link">JIT compiler</a></li><li><a href="/dotnet/clr.html" class="sidebar-link">CLR</a></li><li><a href="/dotnet/tpl-dataflow.html" class="sidebar-link">TPL Dataflow</a></li><li><a href="/dotnet/threading.html" class="sidebar-link">Threading</a></li><li><a href="/dotnet/process-and-thread-affinity-setting.html" class="sidebar-link">Process and Thread affinity setting</a></li><li><a href="/dotnet/parallel-processing-using-net-framework.html" class="sidebar-link">Parallel processing using .Net framework</a></li><li><a href="/dotnet/task-parallel-library-tpl.html" class="sidebar-link">Task Parallel Library (TPL)</a></li><li><a href="/dotnet/task-parallel-library-tpl-api-overviews.html" class="sidebar-link">Task Parallel Library (TPL) API Overviews</a></li><li><a href="/dotnet/synchronization-contexts.html" class="sidebar-link">Synchronization Contexts</a></li><li><a href="/dotnet/memory-management.html" class="sidebar-link">Memory management</a></li><li><a href="/dotnet/garbage-collection.html" class="sidebar-link">Garbage Collection</a></li><li><a href="/dotnet/exceptions.html" class="sidebar-link">Exceptions</a></li><li><a href="/dotnet/system-diagnostics.html" class="sidebar-link">System.Diagnostics</a></li><li><a href="/dotnet/encryption-cryptography.html" class="sidebar-link">Encryption / Cryptography</a></li><li><a href="/dotnet/work-with-sha1-in-c.html" class="sidebar-link">Work with SHA1 in C#</a></li><li><a href="/dotnet/unit-testing.html" class="sidebar-link">Unit testing</a></li><li><a href="/dotnet/write-to-and-read-from-stderr-stream.html" class="sidebar-link">Write to and read from StdErr stream</a></li><li><a href="/dotnet/upload-file-and-post-data-to-webserver.html" class="sidebar-link">Upload file and POST data to webserver</a></li><li><a href="/dotnet/networking.html" class="sidebar-link">Networking</a></li><li><a href="/dotnet/http-servers.html" class="sidebar-link">HTTP servers</a></li><li><a href="/dotnet/http-clients.html" class="sidebar-link">HTTP clients</a></li><li><a href="/dotnet/serial-ports.html" class="sidebar-link">Serial Ports</a></li><li><a href="/dotnet/acronym-glossary.html" class="sidebar-link">Acronym Glossary</a></li><li><a href="/dotnet/work-with-sha1-in-c.html" class="sidebar-link">Work with SHA1 in C#</a></li><li><a href="/dotnet/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dictionaries"><a href="#dictionaries" class="header-anchor">#</a> Dictionaries</h1> <h2 id="initializing-a-dictionary-with-a-collection-initializer"><a href="#initializing-a-dictionary-with-a-collection-initializer" class="header-anchor">#</a> Initializing a Dictionary with a Collection Initializer</h2> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token comment">// Translates to `dict.Add(1, &quot;First&quot;)` etc.</span>
<span class="token class-name"><span class="token keyword">var</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;First&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;Second&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;Third&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Translates to `dict[1] = &quot;First&quot;` etc.</span>
<span class="token comment">// Works in C# 6.0.</span>
<span class="token class-name"><span class="token keyword">var</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;First&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Second&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Third&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="adding-to-a-dictionary"><a href="#adding-to-a-dictionary" class="header-anchor">#</a> Adding to a Dictionary</h2> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dict<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;First&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dict<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;Second&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// To safely add items (check to ensure item does not already exist - would throw)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dict<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   dict<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;Third&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Alternatively they can be added/set via the an indexer.  (An indexer internally looks like a property, having a get and set, but takes a parameter of any type which is specified between the brackets) :</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dict<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;First&quot;</span><span class="token punctuation">;</span>
dict<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Second&quot;</span><span class="token punctuation">;</span>
dict<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Third&quot;</span><span class="token punctuation">;</span>

</code></pre></div><p>Unlike the <code>Add</code> method which throws an exception, if a key is already contained in the dictionary, the indexer just replaces the existing value.</p> <p>For thread-safe dictionary use <code>ConcurrentDictionary&lt;TKey, TValue&gt;</code>:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">var</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ConcurrentDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dict<span class="token punctuation">.</span><span class="token function">AddOrUpdate</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;First&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>oldKey<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;First&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="getting-a-value-from-a-dictionary"><a href="#getting-a-value-from-a-dictionary" class="header-anchor">#</a> Getting a value from a dictionary</h2> <p>Given this setup code:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">var</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;First&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;Second&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;Third&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>You may want to read the value for the entry with key 1. If key doesn't exist getting a value will throw <code>KeyNotFoundException</code>, so you may want to first check for that with <code>ContainsKey</code>:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>dict<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>This has one disadvantage: you will search through your dictionary twice (once to check for existence and one to read the value). For a large dictionary this can impact performance. Fortunately both operations can be performed together:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="make-a-dictionary-string-t-with-case-insensivitve-keys"><a href="#make-a-dictionary-string-t-with-case-insensivitve-keys" class="header-anchor">#</a> Make a Dictionary&lt;string, T&gt; with Case-Insensivitve keys.</h2> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">var</span></span> MyDict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span>T<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>StringComparison<span class="token punctuation">.</span>InvariantCultureIgnoreCase<span class="token punctuation">)</span>

</code></pre></div><h2 id="enumerating-a-dictionary"><a href="#enumerating-a-dictionary" class="header-anchor">#</a> Enumerating a Dictionary</h2> <p>You can enumerate through a Dictionary in one of 3 ways:</p> <p><strong>Using KeyValue pairs</strong></p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name">KeyValuePair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> kvp <span class="token keyword">in</span> dict<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
   Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Key : &quot;</span> <span class="token operator">+</span> kvp<span class="token punctuation">.</span>Key<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, Value : &quot;</span> <span class="token operator">+</span> kvp<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Using Keys</strong></p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> key <span class="token keyword">in</span> dict<span class="token punctuation">.</span>Keys<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Key : &quot;</span> <span class="token operator">+</span> key<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, Value : &quot;</span> <span class="token operator">+</span> dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Using Values</strong></p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> s <span class="token keyword">in</span> dict<span class="token punctuation">.</span>Values<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Value : &quot;</span> <span class="token operator">+</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="concurrentdictionary-tkey-tvalue-from-net-4-0"><a href="#concurrentdictionary-tkey-tvalue-from-net-4-0" class="header-anchor">#</a> ConcurrentDictionary&lt;TKey, TValue&gt; (from .NET 4.0)</h2> <blockquote></blockquote> <p>Represents a thread-safe collection of key/value pairs that can be
accessed by multiple threads concurrently.</p> <h3 id="creating-an-instance"><a href="#creating-an-instance" class="header-anchor">#</a> Creating an instance</h3> <p>Creating an instance works pretty much the same way as with <code>Dictionary&lt;TKey, TValue&gt;</code>, e.g.:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">var</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ConcurrentDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="adding-or-updating"><a href="#adding-or-updating" class="header-anchor">#</a> Adding or Updating</h3> <p>You might be surprised, that there is no <code>Add</code> method, but instead there is <code>AddOrUpdate</code> with 2 overloads:</p> <p>(1) <code>AddOrUpdate(TKey key, TValue, Func&lt;TKey, TValue, TValue&gt; addValue)</code> - <strong>Adds a key/value pair if the key does not already exist, or updates a key/value pair by using the specified function if the key already exists.</strong></p> <p>(2) <code>AddOrUpdate(TKey key, Func&lt;TKey, TValue&gt; addValue, Func&lt;TKey, TValue, TValue&gt; updateValueFactory)</code> - <strong>Uses the specified functions to add a key/value pair to the if the key does not already exist, or to update a key/value pair if the key already exists.</strong></p> <p>Adding or updating a value, no matter what was the value if it was already present for given key (1):</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">string</span></span> addedValue <span class="token operator">=</span> dict<span class="token punctuation">.</span><span class="token function">AddOrUpdate</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;First&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>updateKey<span class="token punctuation">,</span> valueOld<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;First&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Adding or updating a value, but now altering the value in update, based on the previous value (1):</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">string</span></span> addedValue2 <span class="token operator">=</span> dict<span class="token punctuation">.</span><span class="token function">AddOrUpdate</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;First&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>updateKey<span class="token punctuation">,</span> valueOld<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">valueOld</span><span class="token punctuation">}</span></span><span class="token string"> Updated&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Using the overload (2) we can also add new value using a factory:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">string</span></span> addedValue3 <span class="token operator">=</span> dict<span class="token punctuation">.</span><span class="token function">AddOrUpdate</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> key <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">?</span> <span class="token string">&quot;First&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Not First&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>updateKey<span class="token punctuation">,</span> valueOld<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">valueOld</span><span class="token punctuation">}</span></span><span class="token string"> Updated&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="getting-value"><a href="#getting-value" class="header-anchor">#</a> Getting value</h3> <p>Getting a value is the same as with the <code>Dictionary&lt;TKey,TValue&gt;</code>:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">bool</span></span> success <span class="token operator">=</span> dict<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="getting-or-adding-a-value"><a href="#getting-or-adding-a-value" class="header-anchor">#</a> Getting or Adding a value</h3> <p>There are two mehod overloads, that will <strong>get or add</strong> a value in a thread-safe manner.</p> <p>Get value with key 2, or add value &quot;Second&quot; if the key is not present:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">string</span></span> theValue <span class="token operator">=</span> dict<span class="token punctuation">.</span><span class="token function">GetOrAdd</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;Second&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Using a factory for adding a value, if value is not present:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">string</span></span> theValue2 <span class="token operator">=</span> dict<span class="token punctuation">.</span><span class="token function">GetOrAdd</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> key <span class="token operator">==</span> <span class="token number">2</span> <span class="token punctuation">?</span> <span class="token string">&quot;Second&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Not Second.&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="ienumerable-to-dictionary-≥-net-3-5"><a href="#ienumerable-to-dictionary-≥-net-3-5" class="header-anchor">#</a> IEnumerable to Dictionary (≥ .NET 3.5)</h2> <p>Create a <a href="https://msdn.microsoft.com/en-us/library/xfhwa508(v=vs.100).aspx" target="_blank" rel="noopener noreferrer">Dictionary&lt;TKey, TValue&gt;<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> from an <a href="https://msdn.microsoft.com/en-us/library/9eekhta0(v=vs.100).aspx" target="_blank" rel="noopener noreferrer">IEnumerable<T><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></T></a>:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>

</code></pre></div><hr> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Fruits</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><hr> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">var</span></span> fruits <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">{</span> 
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Fruits</span> <span class="token punctuation">{</span> Id <span class="token operator">=</span> <span class="token number">8</span> <span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;Apple&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Fruits</span> <span class="token punctuation">{</span> Id <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;Banana&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Fruits</span> <span class="token punctuation">{</span> Id <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;Mango&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">// Dictionary&lt;int, string&gt;                  key      value</span>
<span class="token class-name"><span class="token keyword">var</span></span> dictionary <span class="token operator">=</span> fruits<span class="token punctuation">.</span><span class="token function">ToDictionary</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="removing-from-a-dictionary"><a href="#removing-from-a-dictionary" class="header-anchor">#</a> Removing from a Dictionary</h2> <p>Given this setup code:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">var</span></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;First&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;Second&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;Third&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>Use the <code>Remove</code> method to remove a key and its associated value.</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">bool</span></span> wasRemoved <span class="token operator">=</span> dict<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Executing this code removes the key <code>2</code> and it's value from the dictionary. <code>Remove</code> returns a boolean value indicating whether the specified key was found and removed from the dictionary. If the key does not exist in the dictionary, nothing is removed from the dictionary, and false is returned (no exception is thrown).</p> <p>It's <strong>incorrect</strong> to try and remove a key by setting the value for the key to <code>null</code>.</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code>dict<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// WRONG WAY TO REMOVE!</span>

</code></pre></div><p>This will not remove the key. It will just replace the previous value with a value of <code>null</code>.</p> <p>To remove all keys and values from a dictionary, use the <code>Clear</code> method.</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code>dict<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>After executing <code>Clear</code> the dictionary's <code>Count</code> will be 0, but the internal capacity remains unchanged.</p> <h2 id="containskey-tkey"><a href="#containskey-tkey" class="header-anchor">#</a> ContainsKey(TKey)</h2> <p>To check if a <code>Dictionary</code> has an specifique key, you can call the method <a href="https://msdn.microsoft.com/library/htszx2dy(v=vs.110).aspx" target="_blank" rel="noopener noreferrer"><code>ContainsKey(TKey)</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and provide the key of <code>TKey</code> type. The method returns a <code>bool</code> value when the key exists on the dictionary. For sample:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name"><span class="token keyword">var</span></span> dictionary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> Customer<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token punctuation">{</span><span class="token string">&quot;F1&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;Felipe&quot;</span><span class="token punctuation">,</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span><span class="token string">&quot;C2&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;Carl&quot;</span><span class="token punctuation">,</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span><span class="token string">&quot;J7&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span><span class="token string">&quot;M5&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;Mary&quot;</span><span class="token punctuation">,</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>And check if a <code>C2</code> exists on the Dictionary:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>dictionary<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span><span class="token string">&quot;C2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
   <span class="token comment">// exists</span>
<span class="token punctuation">}</span>

</code></pre></div><p>The ContainsKey method is available on the generic version <a href="https://msdn.microsoft.com/library/htszx2dy(v=vs.110).aspx" target="_blank" rel="noopener noreferrer"><code>Dictionary&lt;TKey, TValue&gt;</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="dictionary-to-list"><a href="#dictionary-to-list" class="header-anchor">#</a> Dictionary to List</h2> <p>Creating a list of KeyValuePair:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> dictionary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span>KeyValuePair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>KeyValuePair<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span>dictionary<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Creating a list of keys:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> dictionary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span>dictionary<span class="token punctuation">.</span>Keys<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Creating a list of values:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> dictionary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span>dictionary<span class="token punctuation">.</span>Values<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="concurrentdictionary-augmented-with-lazy-1-reduces-duplicated-computation"><a href="#concurrentdictionary-augmented-with-lazy-1-reduces-duplicated-computation" class="header-anchor">#</a> ConcurrentDictionary augmented with Lazy'1 reduces duplicated computation</h2> <h3 id="problem"><a href="#problem" class="header-anchor">#</a> Problem</h3> <p>ConcurrentDictionary shines when it comes to instantly returning of existing keys from cache, mostly lock free, and contending on a granular level.
But what if the object creation is really expensive, outweighing the cost of context switching, and some cache misses occur?</p> <p>If the same key is requested from multiple threads, one of the objects resulting from colliding operations will be eventually added to the collection, and the others will be thrown away, wasting the CPU resource to create the object and memory resource to store the object temporarily. Other resources could be wasted as well. This is really bad.</p> <h3 id="solution"><a href="#solution" class="header-anchor">#</a> Solution</h3> <p>We can combine <code>ConcurrentDictionary&lt;TKey, TValue&gt;</code> with <code>Lazy&lt;TValue&gt;</code>. The idea is that ConcurrentDictionary GetOrAdd method can only return the value which was actually added to the collection. The loosing Lazy objects could be wasted in this case too, but that's not much problem, as the Lazy object itself is relatively unexpensive. The Value property of the losing Lazy is never requested, because we are smart to only request the Value property of the one actually added to the collection - the one returned from the GetOrAdd method:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ConcurrentDictionaryExtensions</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">TValue</span> <span class="token generic-method"><span class="token function">GetOrCreateLazy</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TKey<span class="token punctuation">,</span> TValue<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
        <span class="token keyword">this</span> <span class="token class-name">ConcurrentDictionary<span class="token punctuation">&lt;</span>TKey<span class="token punctuation">,</span> Lazy<span class="token punctuation">&lt;</span>TValue<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> d<span class="token punctuation">,</span>
        <span class="token class-name">TKey</span> key<span class="token punctuation">,</span>
        <span class="token class-name">Func<span class="token punctuation">&lt;</span>TKey<span class="token punctuation">,</span> TValue<span class="token punctuation">&gt;</span></span> factory<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
            d<span class="token punctuation">.</span><span class="token function">GetOrAdd</span><span class="token punctuation">(</span>
                key<span class="token punctuation">,</span>
                key1 <span class="token operator">=&gt;</span>
                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Lazy<span class="token punctuation">&lt;</span>TValue<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">factory</span><span class="token punctuation">(</span>key1<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    LazyThreadSafetyMode<span class="token punctuation">.</span>ExecutionAndPublication<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Caching of XmlSerializer objects can be particularly expensive, and there is a lot of contention at the application startup too. And there is more to this: if those are custom serializers, there will be a memory leak too for the rest of the process lifecycle. The only benefit of the ConcurrentDictionary in this case is that for the rest of the process lifecycle there will be no locks, but application startup and memory usage would be inacceptable. This is a job for our ConcurrentDictionary, augmented with Lazy:</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token keyword">private</span> <span class="token class-name">ConcurrentDictionary<span class="token punctuation">&lt;</span>Type<span class="token punctuation">,</span> Lazy<span class="token punctuation">&lt;</span>XmlSerializer<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> _serializers <span class="token operator">=</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ConcurrentDictionary<span class="token punctuation">&lt;</span>Type<span class="token punctuation">,</span> Lazy<span class="token punctuation">&lt;</span>XmlSerializer<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token return-type class-name">XmlSerializer</span> <span class="token function">GetSerialier</span><span class="token punctuation">(</span><span class="token class-name">Type</span> t<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> _serializers<span class="token punctuation">.</span><span class="token function">GetOrCreateLazy</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> BuildSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token return-type class-name">XmlSerializer</span> <span class="token function">BuildSerializer</span><span class="token punctuation">(</span><span class="token class-name">Type</span> t<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">NotImplementedException</span><span class="token punctuation">(</span><span class="token string">&quot;and this is a homework&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/dotnet/dictionaries.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/dotnet/datetime-parsing.html" class="prev">
        DateTime parsing
      </a></span> <span class="next"><a href="/dotnet/collections.html">
        Collections
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/992.8f94275d.js" defer></script>
  </body>
</html>
