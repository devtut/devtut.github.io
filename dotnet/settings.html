<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>.NET Framework - Settings</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="AppSettings from ConfigurationSettings in .NET 1.x, Reading AppSettings from ConfigurationManager in .NET 2.0 and later, Introduction to strongly-typed application and user settings support from Visual Studio, Reading strongly-typed settings from custom section of configuration file">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content=".NET Framework - Settings">
    <meta property="og:description" content="AppSettings from ConfigurationSettings in .NET 1.x, Reading AppSettings from ConfigurationManager in .NET 2.0 and later, Introduction to strongly-typed application and user settings support from Visual Studio, Reading strongly-typed settings from custom section of configuration file">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/dotnet/settings.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content=".NET Framework - Settings">
    <meta name="twitter:description" content="AppSettings from ConfigurationSettings in .NET 1.x, Reading AppSettings from ConfigurationManager in .NET 2.0 and later, Introduction to strongly-typed application and user settings support from Visual Studio, Reading strongly-typed settings from custom section of configuration file">
    <meta name="twitter:url" content="/dotnet/settings.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/1020.e1dec65f.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>.NET Framework</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dotnet/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/dotnet/getting-started-with-net-framework.html" class="sidebar-link">Getting started with .NET Framework</a></li><li><a href="/dotnet/strings.html" class="sidebar-link">Strings</a></li><li><a href="/dotnet/datetime-parsing.html" class="sidebar-link">DateTime parsing</a></li><li><a href="/dotnet/dictionaries.html" class="sidebar-link">Dictionaries</a></li><li><a href="/dotnet/collections.html" class="sidebar-link">Collections</a></li><li><a href="/dotnet/readonlycollections.html" class="sidebar-link">ReadOnlyCollections</a></li><li><a href="/dotnet/stack-and-heap.html" class="sidebar-link">Stack and Heap</a></li><li><a href="/dotnet/linq.html" class="sidebar-link">LINQ</a></li><li><a href="/dotnet/foreach.html" class="sidebar-link">ForEach</a></li><li><a href="/dotnet/reflection.html" class="sidebar-link">Reflection</a></li><li><a href="/dotnet/expression-trees.html" class="sidebar-link">Expression Trees</a></li><li><a href="/dotnet/custom-types.html" class="sidebar-link">Custom Types</a></li><li><a href="/dotnet/code-contracts.html" class="sidebar-link">Code Contracts</a></li><li><a href="/dotnet/settings.html" aria-current="page" class="active sidebar-link">Settings</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dotnet/settings.html#appsettings-from-configurationsettings-in-net-1-x" class="sidebar-link">AppSettings from ConfigurationSettings in .NET 1.x</a></li><li class="sidebar-sub-header"><a href="/dotnet/settings.html#reading-appsettings-from-configurationmanager-in-net-2-0-and-later" class="sidebar-link">Reading AppSettings from ConfigurationManager in .NET 2.0 and later</a></li><li class="sidebar-sub-header"><a href="/dotnet/settings.html#introduction-to-strongly-typed-application-and-user-settings-support-from-visual-studio" class="sidebar-link">Introduction to strongly-typed application and user settings support from Visual Studio</a></li><li class="sidebar-sub-header"><a href="/dotnet/settings.html#reading-strongly-typed-settings-from-custom-section-of-configuration-file" class="sidebar-link">Reading strongly-typed settings from custom section of configuration file</a></li></ul></li><li><a href="/dotnet/regular-expressions-system-text-regularexpressions.html" class="sidebar-link">Regular Expressions (System.Text.RegularExpressions)</a></li><li><a href="/dotnet/file-input-output.html" class="sidebar-link">File Input/Output</a></li><li><a href="/dotnet/system-io.html" class="sidebar-link">System.IO</a></li><li><a href="/dotnet/system-io-file-class.html" class="sidebar-link">System.IO.File class</a></li><li><a href="/dotnet/reading-and-writing-zip-files.html" class="sidebar-link">Reading and writing Zip files</a></li><li><a href="/dotnet/managed-extensibility-framework.html" class="sidebar-link">Managed Extensibility Framework</a></li><li><a href="/dotnet/speechrecognitionengine-class-to-recognize-speech.html" class="sidebar-link">SpeechRecognitionEngine class to recognize speech</a></li><li><a href="/dotnet/system-runtime-caching-memorycache-objectcache.html" class="sidebar-link">System.Runtime.Caching.MemoryCache (ObjectCache)</a></li><li><a href="/dotnet/system-reflection-emit-namespace.html" class="sidebar-link">System.Reflection.Emit namespace</a></li><li><a href="/dotnet/net-core.html" class="sidebar-link">.NET Core</a></li><li><a href="/dotnet/ado-net.html" class="sidebar-link">ADO.NET</a></li><li><a href="/dotnet/dependency-injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/dotnet/platform-invoke.html" class="sidebar-link">Platform Invoke</a></li><li><a href="/dotnet/nuget-packaging-system.html" class="sidebar-link">NuGet packaging system</a></li><li><a href="/dotnet/globalization-in-asp-net-mvc-using-smart-internationalization-for-asp-net.html" class="sidebar-link">Globalization in ASP.NET MVC using Smart internationalization for ASP.NET</a></li><li><a href="/dotnet/system-net-mail.html" class="sidebar-link">System.Net.Mail</a></li><li><a href="/dotnet/using-progress-t-and-iprogress-t.html" class="sidebar-link">Using Progress</a></li><li><a href="/dotnet/json-serialization.html" class="sidebar-link">JSON Serialization</a></li><li><a href="/dotnet/json-in-net-with-newtonsoft-json.html" class="sidebar-link">JSON in .NET with Newtonsoft.Json</a></li><li><a href="/dotnet/xmlserializer.html" class="sidebar-link">XmlSerializer</a></li><li><a href="/dotnet/vb-forms.html" class="sidebar-link">VB Forms</a></li><li><a href="/dotnet/jit-compiler.html" class="sidebar-link">JIT compiler</a></li><li><a href="/dotnet/clr.html" class="sidebar-link">CLR</a></li><li><a href="/dotnet/tpl-dataflow.html" class="sidebar-link">TPL Dataflow</a></li><li><a href="/dotnet/threading.html" class="sidebar-link">Threading</a></li><li><a href="/dotnet/process-and-thread-affinity-setting.html" class="sidebar-link">Process and Thread affinity setting</a></li><li><a href="/dotnet/parallel-processing-using-net-framework.html" class="sidebar-link">Parallel processing using .Net framework</a></li><li><a href="/dotnet/task-parallel-library-tpl.html" class="sidebar-link">Task Parallel Library (TPL)</a></li><li><a href="/dotnet/task-parallel-library-tpl-api-overviews.html" class="sidebar-link">Task Parallel Library (TPL) API Overviews</a></li><li><a href="/dotnet/synchronization-contexts.html" class="sidebar-link">Synchronization Contexts</a></li><li><a href="/dotnet/memory-management.html" class="sidebar-link">Memory management</a></li><li><a href="/dotnet/garbage-collection.html" class="sidebar-link">Garbage Collection</a></li><li><a href="/dotnet/exceptions.html" class="sidebar-link">Exceptions</a></li><li><a href="/dotnet/system-diagnostics.html" class="sidebar-link">System.Diagnostics</a></li><li><a href="/dotnet/encryption-cryptography.html" class="sidebar-link">Encryption / Cryptography</a></li><li><a href="/dotnet/work-with-sha1-in-c.html" class="sidebar-link">Work with SHA1 in C#</a></li><li><a href="/dotnet/unit-testing.html" class="sidebar-link">Unit testing</a></li><li><a href="/dotnet/write-to-and-read-from-stderr-stream.html" class="sidebar-link">Write to and read from StdErr stream</a></li><li><a href="/dotnet/upload-file-and-post-data-to-webserver.html" class="sidebar-link">Upload file and POST data to webserver</a></li><li><a href="/dotnet/networking.html" class="sidebar-link">Networking</a></li><li><a href="/dotnet/http-servers.html" class="sidebar-link">HTTP servers</a></li><li><a href="/dotnet/http-clients.html" class="sidebar-link">HTTP clients</a></li><li><a href="/dotnet/serial-ports.html" class="sidebar-link">Serial Ports</a></li><li><a href="/dotnet/acronym-glossary.html" class="sidebar-link">Acronym Glossary</a></li><li><a href="/dotnet/work-with-sha1-in-c.html" class="sidebar-link">Work with SHA1 in C#</a></li><li><a href="/dotnet/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="settings"><a href="#settings" class="header-anchor">#</a> Settings</h1> <h2 id="appsettings-from-configurationsettings-in-net-1-x"><a href="#appsettings-from-configurationsettings-in-net-1-x" class="header-anchor">#</a> AppSettings from ConfigurationSettings in .NET 1.x</h2> <h3 id="deprecated-usage"><a href="#deprecated-usage" class="header-anchor">#</a> Deprecated usage</h3> <p>The <a href="https://msdn.microsoft.com/en-us/library/system.configuration.configurationsettings.aspx" target="_blank" rel="noopener noreferrer">ConfigurationSettings<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> class was the original way to retrieve settings for an assembly in .NET 1.0 and 1.1. It has been superseded by the <a href="https://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx" target="_blank" rel="noopener noreferrer">ConfigurationManager<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> class and the <a href="https://msdn.microsoft.com/en-us/library/system.web.configuration.webconfigurationmanager.aspx" target="_blank" rel="noopener noreferrer">WebConfigurationManager<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> class.</p> <p>If you have two keys with the same name in the <code>appSettings</code> section of the configuration file, the last one is used.</p> <p><strong>app.config</strong></p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token operator">&lt;</span><span class="token punctuation">?</span><span class="token class-name">xml</span> version<span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>appSettings<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token keyword">add</span> key<span class="token operator">=</span><span class="token string">&quot;keyName&quot;</span> <span class="token keyword">value</span><span class="token operator">=</span><span class="token string">&quot;anything, as a string&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token keyword">add</span> key<span class="token operator">=</span><span class="token string">&quot;keyNames&quot;</span> <span class="token keyword">value</span><span class="token operator">=</span><span class="token string">&quot;123&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token keyword">add</span> key<span class="token operator">=</span><span class="token string">&quot;keyNames&quot;</span> <span class="token keyword">value</span><span class="token operator">=</span><span class="token string">&quot;234&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>appSettings<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>

</code></pre></div><p><strong>Program.cs</strong></p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Diagnostics</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">ConsoleApplication1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">string</span></span> keyValue <span class="token operator">=</span> ConfigurationSettings<span class="token punctuation">.</span>AppSettings<span class="token punctuation">[</span><span class="token string">&quot;keyName&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            Debug<span class="token punctuation">.</span><span class="token function">Assert</span><span class="token punctuation">(</span><span class="token string">&quot;anything, as a string&quot;</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>keyValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">string</span></span> twoKeys <span class="token operator">=</span> ConfigurationSettings<span class="token punctuation">.</span>AppSettings<span class="token punctuation">[</span><span class="token string">&quot;keyNames&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            Debug<span class="token punctuation">.</span><span class="token function">Assert</span><span class="token punctuation">(</span><span class="token string">&quot;234&quot;</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>twoKeys<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="reading-appsettings-from-configurationmanager-in-net-2-0-and-later"><a href="#reading-appsettings-from-configurationmanager-in-net-2-0-and-later" class="header-anchor">#</a> Reading AppSettings from ConfigurationManager in .NET 2.0 and later</h2> <p>The <a href="https://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx" target="_blank" rel="noopener noreferrer">ConfigurationManager<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> class supports the <code>AppSettings</code> property, which allows you to continue reading settings from the <code>appSettings</code> section of a configuration file the same way as .NET 1.x supported.</p> <p><strong>app.config</strong></p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token operator">&lt;</span><span class="token punctuation">?</span><span class="token class-name">xml</span> version<span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>appSettings<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token keyword">add</span> key<span class="token operator">=</span><span class="token string">&quot;keyName&quot;</span> <span class="token keyword">value</span><span class="token operator">=</span><span class="token string">&quot;anything, as a string&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token keyword">add</span> key<span class="token operator">=</span><span class="token string">&quot;keyNames&quot;</span> <span class="token keyword">value</span><span class="token operator">=</span><span class="token string">&quot;123&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token keyword">add</span> key<span class="token operator">=</span><span class="token string">&quot;keyNames&quot;</span> <span class="token keyword">value</span><span class="token operator">=</span><span class="token string">&quot;234&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>appSettings<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>

</code></pre></div><p><strong>Program.cs</strong></p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Diagnostics</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">ConsoleApplication1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">string</span></span> keyValue <span class="token operator">=</span> ConfigurationManager<span class="token punctuation">.</span>AppSettings<span class="token punctuation">[</span><span class="token string">&quot;keyName&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            Debug<span class="token punctuation">.</span><span class="token function">Assert</span><span class="token punctuation">(</span><span class="token string">&quot;anything, as a string&quot;</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>keyValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">var</span></span> twoKeys <span class="token operator">=</span> ConfigurationManager<span class="token punctuation">.</span>AppSettings<span class="token punctuation">[</span><span class="token string">&quot;keyNames&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            Debug<span class="token punctuation">.</span><span class="token function">Assert</span><span class="token punctuation">(</span><span class="token string">&quot;234&quot;</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>twoKeys<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="introduction-to-strongly-typed-application-and-user-settings-support-from-visual-studio"><a href="#introduction-to-strongly-typed-application-and-user-settings-support-from-visual-studio" class="header-anchor">#</a> Introduction to strongly-typed application and user settings support from Visual Studio</h2> <p>Visual Studio helps manage user and application settings. Using this approach has these benefits over using the <code>appSettings</code> section of the configuration file.</p> <li>
Settings can be made strongly typed. Any type which can be serialized can be used for a settings value.
</li> <li>
Application settings can be easily separated from user settings. Application settings are stored in a single configuration file: `web.config` for Web sites and Web applications, and app.config, renamed as **assembly**.exe.config, where **assembly** is the name of the executable. User settings (not used by Web projects) are stored in a `user.config` file in the user's Application Data folder (which varies with the operating system version).
</li> <li>
Application settings from class libraries can be combined into a single configuration file without risk of name collisions, since each class library can have its own custom settings section.
</li> <p>In most project types, the <a href="https://msdn.microsoft.com/en-us/library/z2f953x9.aspx" target="_blank" rel="noopener noreferrer">Project Properties Designer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> has a <a href="https://msdn.microsoft.com/en-us/library/a65txexh.aspx" target="_blank" rel="noopener noreferrer">Settings<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> tab which is the starting point for creating custom application and user settings. Initially, the Settings tab will be blank, with a single link to create a default settings file. Clicking the link results in these changes:</p> <li>
If a configuration file (`app.config` or `web.config`) does not exist for the project, one will be created.
</li> <li>
The Settings tab will be replaced with a grid control which enables you to create, edit, and delete individual settings entries.
</li> <li>
In Solution Explorer, a `Settings.settings` item is added under the Properties special folder. Opening this item will open the Settings tab.
</li> <li>
A new file with a new partial class is added under the `Properties` folder in the project folder. This new file is named `Settings.Designer.__` (.cs, .vb, etc.), and the class is named `Settings`. The class is code-generated, so it should not be edited, but the class is a partial class, so you can extend the class by putting additional members in a separate file. Furthermore, the class is implemented using the Singleton Pattern, exposing the singleton instance with the property named `Default`.
</li> <p>As you add each new entry to the Settings tab, Visual Studio does these two things:</p> <li>
Saves the setting in the configuration file, in a custom configuration section designed to be managed by the Settings class.
</li> <li>
Creates a new member in the Settings class to read, write, and present the setting in the specific type selected from the Settings tab.
</li> <h2 id="reading-strongly-typed-settings-from-custom-section-of-configuration-file"><a href="#reading-strongly-typed-settings-from-custom-section-of-configuration-file" class="header-anchor">#</a> Reading strongly-typed settings from custom section of configuration file</h2> <p>Starting from a new Settings class and custom configuration section:</p> <p><a href="http://i.stack.imgur.com/ccuKH.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/ccuKH.png" alt="Settings tab of the Project Properties Designer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Add an application setting named ExampleTimeout, using the time System.Timespan, and set the value to 1 minute:</p> <p><a href="http://i.stack.imgur.com/bVMK4.png" target="_blank" rel="noopener noreferrer"><img src="http://i.stack.imgur.com/bVMK4.png" alt="Settings tab while adding ExampleTimeout application setting"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Save the Project Properties, which saves the Settings tab entries, as well as re-generates the custom Settings class and updates the project configuration file.</p> <p>Use the setting from code (C#):</p> <p><strong>Program.cs</strong></p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Diagnostics</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">ConsoleApplication1<span class="token punctuation">.</span>Properties</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">ConsoleApplication1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name">TimeSpan</span> exampleTimeout <span class="token operator">=</span> Settings<span class="token punctuation">.</span>Default<span class="token punctuation">.</span>ExampleTimeout<span class="token punctuation">;</span>
            Debug<span class="token punctuation">.</span><span class="token function">Assert</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromMinutes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>exampleTimeout<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="under-the-covers"><a href="#under-the-covers" class="header-anchor">#</a> Under the covers</h3> <p>Look in the project configuration file to see how the application setting entry has been created:</p> <p><strong>app.config</strong> (Visual Studio updates this automatically)</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token operator">&lt;</span><span class="token punctuation">?</span><span class="token class-name">xml</span> version<span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>configSections<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token class-name">sectionGroup</span> name<span class="token operator">=</span><span class="token string">&quot;applicationSettings&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;</span> <span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token class-name">section</span> name<span class="token operator">=</span><span class="token string">&quot;ConsoleApplication1.Properties.Settings&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;</span> requirePermission<span class="token operator">=</span><span class="token string">&quot;false&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>sectionGroup<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>configSections<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>appSettings <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>applicationSettings<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>ConsoleApplication1<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>Settings<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token class-name">setting</span> name<span class="token operator">=</span><span class="token string">&quot;ExampleTimeout&quot;</span> serializeAs<span class="token operator">=</span><span class="token string">&quot;String&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">value</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>setting<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ConsoleApplication1<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>Settings<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>applicationSettings<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>

</code></pre></div><p>Notice that the <code>appSettings</code> section is not used. The <code>applicationSettings</code> section contains a custom namespace-qualified section that has a <code>setting</code> element for each entry. The type of the value is not stored in the configuration file; it is only known by the <code>Settings</code> class.</p> <p>Look in the <code>Settings</code> class to see how it uses the <code>ConfigurationManager</code> class to read this custom section.</p> <p><strong>Settings.designer.cs</strong> (for C# projects)</p> <div class="language-dotnet extra-class"><pre class="language-dotnet"><code><span class="token range operator">..</span><span class="token punctuation">.</span>
    <span class="token punctuation">[</span><span class="token keyword">global</span><span class="token punctuation">::</span>System<span class="token punctuation">.</span>Configuration<span class="token punctuation">.</span><span class="token function">ApplicationScopedSettingAttribute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token keyword">global</span><span class="token punctuation">::</span>System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span><span class="token function">DebuggerNonUserCodeAttribute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token keyword">global</span><span class="token punctuation">::</span>System<span class="token punctuation">.</span>Configuration<span class="token punctuation">.</span><span class="token function">DefaultSettingValueAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;00:01:00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">global</span><span class="token punctuation">::</span><span class="token return-type class-name">System<span class="token punctuation">.</span>TimeSpan</span> ExampleTimeout <span class="token punctuation">{</span>
        <span class="token keyword">get</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">global</span><span class="token punctuation">::</span>System<span class="token punctuation">.</span>TimeSpan<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span><span class="token string">&quot;ExampleTimeout&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token range operator">..</span><span class="token punctuation">.</span>

</code></pre></div><p>Notice that a <code>DefaultSettingValueAttribute</code> was created to stored the value entered in the Settings tab of the Project Properties Designer. If the entry is missing from the configuration file, this default value is used instead.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/dotnet/settings.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/dotnet/code-contracts.html" class="prev">
        Code Contracts
      </a></span> <span class="next"><a href="/dotnet/regular-expressions-system-text-regularexpressions.html">
        Regular Expressions (System.Text.RegularExpressions)
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/1020.e1dec65f.js" defer></script>
  </body>
</html>
