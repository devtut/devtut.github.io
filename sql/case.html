<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SQL - CASE</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="description" content="Use CASE to COUNT the number of rows in a column match a condition., Searched CASE in SELECT (Matches a boolean expression), CASE in a clause ORDER BY, Shorthand CASE in SELECT, Using CASE in UPDATE, CASE use for NULL values ​​ordered last, CASE in ORDER BY clause to sort records by lowest value of 2 columns">
    <meta property="og:site_name" content="DevTut">
    <meta property="og:title" content="SQL - CASE">
    <meta property="og:description" content="Use CASE to COUNT the number of rows in a column match a condition., Searched CASE in SELECT (Matches a boolean expression), CASE in a clause ORDER BY, Shorthand CASE in SELECT, Using CASE in UPDATE, CASE use for NULL values ​​ordered last, CASE in ORDER BY clause to sort records by lowest value of 2 columns">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/sql/case.html">
    <meta property="og:image" content="/logo.png">
    <meta name="twitter:title" content="SQL - CASE">
    <meta name="twitter:description" content="Use CASE to COUNT the number of rows in a column match a condition., Searched CASE in SELECT (Matches a boolean expression), CASE in a clause ORDER BY, Shorthand CASE in SELECT, Using CASE in UPDATE, CASE use for NULL values ​​ordered last, CASE in ORDER BY clause to sort records by lowest value of 2 columns">
    <meta name="twitter:url" content="/sql/case.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/logo.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="google-site-verification" content="76_rKXgwMVIjd-axJC_1zPV9OS4mEjvtgjYOWVkAdnQ">
    
    <link rel="preload" href="/assets/css/0.styles.60619e34.css" as="style"><link rel="preload" href="/assets/js/app.1779e102.js" as="script"><link rel="preload" href="/assets/js/3.2cfa8016.js" as="script"><link rel="preload" href="/assets/js/3245.c442fb19.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.60619e34.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DevTut</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/devtut/generate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>SQL</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/" aria-current="page" class="sidebar-link">Disclaimer</a></li><li><a href="/sql/getting-started-with-sql.html" class="sidebar-link">Getting started with SQL</a></li><li><a href="/sql/identifier.html" class="sidebar-link">Identifier</a></li><li><a href="/sql/data-types.html" class="sidebar-link">Data Types</a></li><li><a href="/sql/null.html" class="sidebar-link">NULL</a></li><li><a href="/sql/example-databases-and-tables.html" class="sidebar-link">Example Databases and Tables</a></li><li><a href="/sql/select.html" class="sidebar-link">SELECT</a></li><li><a href="/sql/group-by.html" class="sidebar-link">GROUP BY</a></li><li><a href="/sql/order-by.html" class="sidebar-link">ORDER BY</a></li><li><a href="/sql/and-or-operators.html" class="sidebar-link">AND &amp; OR Operators</a></li><li><a href="/sql/case.html" aria-current="page" class="active sidebar-link">CASE</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sql/case.html#use-case-to-count-the-number-of-rows-in-a-column-match-a-condition" class="sidebar-link">Use CASE to COUNT the number of rows in a column match a condition.</a></li><li class="sidebar-sub-header"><a href="/sql/case.html#searched-case-in-select-matches-a-boolean-expression" class="sidebar-link">Searched CASE in SELECT (Matches a boolean expression)</a></li><li class="sidebar-sub-header"><a href="/sql/case.html#case-in-a-clause-order-by" class="sidebar-link">CASE in a clause ORDER BY</a></li><li class="sidebar-sub-header"><a href="/sql/case.html#shorthand-case-in-select" class="sidebar-link">Shorthand CASE in SELECT</a></li><li class="sidebar-sub-header"><a href="/sql/case.html#using-case-in-update" class="sidebar-link">Using CASE in UPDATE</a></li><li class="sidebar-sub-header"><a href="/sql/case.html#case-use-for-null-values-​​ordered-last" class="sidebar-link">CASE use for NULL values ​​ordered last</a></li><li class="sidebar-sub-header"><a href="/sql/case.html#case-in-order-by-clause-to-sort-records-by-lowest-value-of-2-columns" class="sidebar-link">CASE in ORDER BY clause to sort records by lowest value of 2 columns</a></li></ul></li><li><a href="/sql/like-operator.html" class="sidebar-link">LIKE operator</a></li><li><a href="/sql/in-clause.html" class="sidebar-link">IN clause</a></li><li><a href="/sql/filter-results-using-where-and-having.html" class="sidebar-link">Filter results using WHERE and HAVING</a></li><li><a href="/sql/skip-take-pagination.html" class="sidebar-link">SKIP TAKE (Pagination)</a></li><li><a href="/sql/except.html" class="sidebar-link">EXCEPT</a></li><li><a href="/sql/explain-and-describe.html" class="sidebar-link">EXPLAIN and DESCRIBE</a></li><li><a href="/sql/exists-clause.html" class="sidebar-link">EXISTS CLAUSE</a></li><li><a href="/sql/join.html" class="sidebar-link">JOIN</a></li><li><a href="/sql/update.html" class="sidebar-link">UPDATE</a></li><li><a href="/sql/create-database.html" class="sidebar-link">CREATE Database</a></li><li><a href="/sql/create-table.html" class="sidebar-link">CREATE TABLE</a></li><li><a href="/sql/create-function.html" class="sidebar-link">CREATE FUNCTION</a></li><li><a href="/sql/try-catch.html" class="sidebar-link">TRY/CATCH</a></li><li><a href="/sql/union-union-all.html" class="sidebar-link">UNION / UNION ALL</a></li><li><a href="/sql/alter-table.html" class="sidebar-link">ALTER TABLE</a></li><li><a href="/sql/insert.html" class="sidebar-link">INSERT</a></li><li><a href="/sql/merge.html" class="sidebar-link">MERGE</a></li><li><a href="/sql/cross-apply-outer-apply.html" class="sidebar-link">cross apply, outer apply</a></li><li><a href="/sql/delete.html" class="sidebar-link">DELETE</a></li><li><a href="/sql/truncate.html" class="sidebar-link">TRUNCATE</a></li><li><a href="/sql/drop-table.html" class="sidebar-link">DROP Table</a></li><li><a href="/sql/drop-or-delete-database.html" class="sidebar-link">DROP or DELETE Database</a></li><li><a href="/sql/cascading-delete.html" class="sidebar-link">Cascading Delete</a></li><li><a href="/sql/grant-and-revoke.html" class="sidebar-link">GRANT and REVOKE</a></li><li><a href="/sql/xml.html" class="sidebar-link">XML</a></li><li><a href="/sql/primary-keys.html" class="sidebar-link">Primary Keys</a></li><li><a href="/sql/indexes.html" class="sidebar-link">Indexes</a></li><li><a href="/sql/row-number.html" class="sidebar-link">Row number</a></li><li><a href="/sql/sql-group-by-vs-distinct.html" class="sidebar-link">SQL Group By vs Distinct</a></li><li><a href="/sql/finding-duplicates-on-a-column-subset-with-detail.html" class="sidebar-link">Finding Duplicates on a Column Subset with Detail</a></li><li><a href="/sql/string-functions.html" class="sidebar-link">String Functions</a></li><li><a href="/sql/functions-aggregate.html" class="sidebar-link">Functions (Aggregate)</a></li><li><a href="/sql/functions-scalar-single-row.html" class="sidebar-link">Functions (Scalar/Single Row)</a></li><li><a href="/sql/functions-analytic.html" class="sidebar-link">Functions (Analytic)</a></li><li><a href="/sql/window-functions.html" class="sidebar-link">Window Functions</a></li><li><a href="/sql/common-table-expressions.html" class="sidebar-link">Common Table Expressions</a></li><li><a href="/sql/views.html" class="sidebar-link">Views</a></li><li><a href="/sql/materialized-views.html" class="sidebar-link">Materialized Views</a></li><li><a href="/sql/comments.html" class="sidebar-link">Comments</a></li><li><a href="/sql/foreign-keys.html" class="sidebar-link">Foreign Keys</a></li><li><a href="/sql/sequence.html" class="sidebar-link">Sequence</a></li><li><a href="/sql/subqueries.html" class="sidebar-link">Subqueries</a></li><li><a href="/sql/execution-blocks.html" class="sidebar-link">Execution blocks</a></li><li><a href="/sql/stored-procedures.html" class="sidebar-link">Stored Procedures</a></li><li><a href="/sql/triggers.html" class="sidebar-link">Triggers</a></li><li><a href="/sql/transactions.html" class="sidebar-link">Transactions</a></li><li><a href="/sql/table-design.html" class="sidebar-link">Table Design</a></li><li><a href="/sql/synonyms.html" class="sidebar-link">Synonyms</a></li><li><a href="/sql/information-schema.html" class="sidebar-link">Information Schema</a></li><li><a href="/sql/order-of-execution.html" class="sidebar-link">Order of Execution</a></li><li><a href="/sql/clean-code-in-sql.html" class="sidebar-link">Clean Code in SQL</a></li><li><a href="/sql/relational-algebra.html" class="sidebar-link">Relational Algebra</a></li><li><a href="/sql/sql-injection.html" class="sidebar-link">SQL Injection</a></li><li><a href="/sql/sql-cursor.html" class="sidebar-link">SQL CURSOR</a></li><li><a href="/sql/contributors.html" class="sidebar-link">The Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="case"><a href="#case" class="header-anchor">#</a> CASE</h1> <p>The CASE expression is used to implement if-then logic.</p> <h2 id="use-case-to-count-the-number-of-rows-in-a-column-match-a-condition"><a href="#use-case-to-count-the-number-of-rows-in-a-column-match-a-condition" class="header-anchor">#</a> Use CASE to COUNT the number of rows in a column match a condition.</h2> <p><strong>Use Case</strong></p> <p><code>CASE</code> can be used in conjunction with <code>SUM</code> to return a count of only those items matching a pre-defined condition. (This is similar to <code>COUNTIF</code> in Excel.)</p> <p>The trick is to return binary results indicating matches, so the &quot;1&quot;s returned for matching entries can be summed for a count of the total number of matches.</p> <p>Given this table <code>ItemSales</code>, let's say you want to learn the total number of items that have been categorized as &quot;Expensive&quot;:</p> <table><thead><tr><th>Id</th> <th>ItemId</th> <th>Price</th> <th>PriceRating</th></tr></thead> <tbody><tr><td>1</td> <td>100</td> <td>34.5</td> <td>EXPENSIVE</td></tr> <tr><td>2</td> <td>145</td> <td>2.3</td> <td>CHEAP</td></tr> <tr><td>3</td> <td>100</td> <td>34.5</td> <td>EXPENSIVE</td></tr> <tr><td>4</td> <td>100</td> <td>34.5</td> <td>EXPENSIVE</td></tr> <tr><td>5</td> <td>145</td> <td>10</td> <td>AFFORDABLE</td></tr></tbody></table> <p><strong>Query</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
    <span class="token function">COUNT</span><span class="token punctuation">(</span>Id<span class="token punctuation">)</span> <span class="token keyword">AS</span> ItemsCount<span class="token punctuation">,</span>
    <span class="token function">SUM</span> <span class="token punctuation">(</span> <span class="token keyword">CASE</span> 
            <span class="token keyword">WHEN</span> PriceRating <span class="token operator">=</span> <span class="token string">'Expensive'</span> <span class="token keyword">THEN</span> <span class="token number">1</span>
            <span class="token keyword">ELSE</span> <span class="token number">0</span>
          <span class="token keyword">END</span>
        <span class="token punctuation">)</span> <span class="token keyword">AS</span> ExpensiveItemsCount
<span class="token keyword">FROM</span> ItemSales 

</code></pre></div><p><strong>Results:</strong></p> <table><thead><tr><th>ItemsCount</th> <th>ExpensiveItemsCount</th></tr></thead> <tbody><tr><td>5</td> <td>3</td></tr></tbody></table> <p>Alternative:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
    <span class="token function">COUNT</span><span class="token punctuation">(</span>Id<span class="token punctuation">)</span> <span class="token keyword">as</span> ItemsCount<span class="token punctuation">,</span>
    <span class="token function">SUM</span> <span class="token punctuation">(</span>
        <span class="token keyword">CASE</span> PriceRating 
            <span class="token keyword">WHEN</span> <span class="token string">'Expensive'</span> <span class="token keyword">THEN</span> <span class="token number">1</span>
            <span class="token keyword">ELSE</span> <span class="token number">0</span>
        <span class="token keyword">END</span>
       <span class="token punctuation">)</span> <span class="token keyword">AS</span> ExpensiveItemsCount
<span class="token keyword">FROM</span> ItemSales 

</code></pre></div><h2 id="searched-case-in-select-matches-a-boolean-expression"><a href="#searched-case-in-select-matches-a-boolean-expression" class="header-anchor">#</a> Searched CASE in SELECT (Matches a boolean expression)</h2> <p>The <strong>searched</strong> CASE returns results when a <strong>boolean</strong> expression is TRUE.</p> <p>(This differs from the simple case, which can only check for equivalency with an input.)</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Id<span class="token punctuation">,</span> ItemId<span class="token punctuation">,</span> Price<span class="token punctuation">,</span>
  <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> Price <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token keyword">THEN</span> <span class="token string">'CHEAP'</span>
       <span class="token keyword">WHEN</span> Price <span class="token operator">&lt;</span> <span class="token number">20</span> <span class="token keyword">THEN</span> <span class="token string">'AFFORDABLE'</span>
       <span class="token keyword">ELSE</span> <span class="token string">'EXPENSIVE'</span>
  <span class="token keyword">END</span> <span class="token keyword">AS</span> PriceRating
<span class="token keyword">FROM</span> ItemSales

</code></pre></div><table><thead><tr><th>Id</th> <th>ItemId</th> <th>Price</th> <th>PriceRating</th></tr></thead> <tbody><tr><td>1</td> <td>100</td> <td>34.5</td> <td>EXPENSIVE</td></tr> <tr><td>2</td> <td>145</td> <td>2.3</td> <td>CHEAP</td></tr> <tr><td>3</td> <td>100</td> <td>34.5</td> <td>EXPENSIVE</td></tr> <tr><td>4</td> <td>100</td> <td>34.5</td> <td>EXPENSIVE</td></tr> <tr><td>5</td> <td>145</td> <td>10</td> <td>AFFORDABLE</td></tr></tbody></table> <h2 id="case-in-a-clause-order-by"><a href="#case-in-a-clause-order-by" class="header-anchor">#</a> CASE in a clause ORDER BY</h2> <p>We can use 1,2,3.. to determine the type of order:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> DEPT
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
<span class="token keyword">CASE</span> DEPARTMENT
      <span class="token keyword">WHEN</span> <span class="token string">'MARKETING'</span> <span class="token keyword">THEN</span>  <span class="token number">1</span>
      <span class="token keyword">WHEN</span> <span class="token string">'SALES'</span> <span class="token keyword">THEN</span> <span class="token number">2</span>
      <span class="token keyword">WHEN</span> <span class="token string">'RESEARCH'</span> <span class="token keyword">THEN</span> <span class="token number">3</span>
      <span class="token keyword">WHEN</span> <span class="token string">'INNOVATION'</span> <span class="token keyword">THEN</span> <span class="token number">4</span>
      <span class="token keyword">ELSE</span>        <span class="token number">5</span>
      <span class="token keyword">END</span><span class="token punctuation">,</span>
      CITY

</code></pre></div><table><thead><tr><th>ID</th> <th>REGION</th> <th>CITY</th> <th>DEPARTMENT</th> <th>EMPLOYEES_NUMBER</th></tr></thead> <tbody><tr><td>12</td> <td>New England</td> <td>Boston</td> <td>MARKETING</td> <td>9</td></tr> <tr><td>15</td> <td>West</td> <td>San Francisco</td> <td>MARKETING</td> <td>12</td></tr> <tr><td>9</td> <td>Midwest</td> <td>Chicago</td> <td>SALES</td> <td>8</td></tr> <tr><td>14</td> <td>Mid-Atlantic</td> <td>New York</td> <td>SALES</td> <td>12</td></tr> <tr><td>5</td> <td>West</td> <td>Los Angeles</td> <td>RESEARCH</td> <td>11</td></tr> <tr><td>10</td> <td>Mid-Atlantic</td> <td>Philadelphia</td> <td>RESEARCH</td> <td>13</td></tr> <tr><td>4</td> <td>Midwest</td> <td>Chicago</td> <td>INNOVATION</td> <td>11</td></tr> <tr><td>2</td> <td>Midwest</td> <td>Detroit</td> <td>HUMAN RESOURCES</td> <td>9</td></tr></tbody></table> <h2 id="shorthand-case-in-select"><a href="#shorthand-case-in-select" class="header-anchor">#</a> Shorthand CASE in SELECT</h2> <p><code>CASE</code>'s shorthand variant evaluates an expression (usually a column) against a series of values. This variant is a bit shorter, and saves repeating the evaluated expression over and over again. The <code>ELSE</code> clause can still be used, though:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Id<span class="token punctuation">,</span> ItemId<span class="token punctuation">,</span> Price<span class="token punctuation">,</span>
  <span class="token keyword">CASE</span> Price <span class="token keyword">WHEN</span> <span class="token number">5</span>  <span class="token keyword">THEN</span> <span class="token string">'CHEAP'</span>
             <span class="token keyword">WHEN</span> <span class="token number">15</span> <span class="token keyword">THEN</span> <span class="token string">'AFFORDABLE'</span>
             <span class="token keyword">ELSE</span>         <span class="token string">'EXPENSIVE'</span>
  <span class="token keyword">END</span> <span class="token keyword">as</span> PriceRating
<span class="token keyword">FROM</span> ItemSales

</code></pre></div><p>A word of caution. It's important to realize that when using the short variant the entire statement is evaluated at each <code>WHEN</code>. Therefore the following statement:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
    <span class="token keyword">CASE</span> ABS<span class="token punctuation">(</span>CHECKSUM<span class="token punctuation">(</span>NEWID<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span>
        <span class="token keyword">WHEN</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'Dr'</span>
        <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'Master'</span>
        <span class="token keyword">WHEN</span> <span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token string">'Mr'</span>
        <span class="token keyword">WHEN</span> <span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token string">'Mrs'</span>
    <span class="token keyword">END</span>

</code></pre></div><p>may produce a <code>NULL</code> result. That is because at each <code>WHEN</code> <code>NEWID()</code> is being called again with a new result. Equivalent to:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
    <span class="token keyword">CASE</span> 
        <span class="token keyword">WHEN</span> ABS<span class="token punctuation">(</span>CHECKSUM<span class="token punctuation">(</span>NEWID<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'Dr'</span>
        <span class="token keyword">WHEN</span> ABS<span class="token punctuation">(</span>CHECKSUM<span class="token punctuation">(</span>NEWID<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'Master'</span>
        <span class="token keyword">WHEN</span> ABS<span class="token punctuation">(</span>CHECKSUM<span class="token punctuation">(</span>NEWID<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token string">'Mr'</span>
        <span class="token keyword">WHEN</span> ABS<span class="token punctuation">(</span>CHECKSUM<span class="token punctuation">(</span>NEWID<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token string">'Mrs'</span>
    <span class="token keyword">END</span>

</code></pre></div><p>Therefore it can miss all the <code>WHEN</code> cases and result as <code>NULL</code>.</p> <h2 id="using-case-in-update"><a href="#using-case-in-update" class="header-anchor">#</a> Using CASE in UPDATE</h2> <p>sample on price increases:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> ItemPrice
<span class="token keyword">SET</span> Price <span class="token operator">=</span> Price <span class="token operator">*</span>
  <span class="token keyword">CASE</span> ItemId
    <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token number">1.05</span>
    <span class="token keyword">WHEN</span> <span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token number">1.10</span>
    <span class="token keyword">WHEN</span> <span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token number">1.15</span>
    <span class="token keyword">ELSE</span> <span class="token number">1.00</span>
  <span class="token keyword">END</span>

</code></pre></div><h2 id="case-use-for-null-values-​​ordered-last"><a href="#case-use-for-null-values-​​ordered-last" class="header-anchor">#</a> CASE use for NULL values ​​ordered last</h2> <p>in this way '0' representing the known values ​​are ranked first, '1' representing the NULL values ​​are sorted by the last:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ID
      <span class="token punctuation">,</span>REGION
      <span class="token punctuation">,</span>CITY
      <span class="token punctuation">,</span>DEPARTMENT
      <span class="token punctuation">,</span>EMPLOYEES_NUMBER
  <span class="token keyword">FROM</span> DEPT
  <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 
  <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> REGION <span class="token operator">IS</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> <span class="token number">1</span> 
  <span class="token keyword">ELSE</span> <span class="token number">0</span>
  <span class="token keyword">END</span><span class="token punctuation">,</span> 
  REGION

</code></pre></div><table><thead><tr><th>ID</th> <th>REGION</th> <th>CITY</th> <th>DEPARTMENT</th> <th>EMPLOYEES_NUMBER</th></tr></thead> <tbody><tr><td>10</td> <td>Mid-Atlantic</td> <td>Philadelphia</td> <td>RESEARCH</td> <td>13</td></tr> <tr><td>14</td> <td>Mid-Atlantic</td> <td>New York</td> <td>SALES</td> <td>12</td></tr> <tr><td>9</td> <td>Midwest</td> <td>Chicago</td> <td>SALES</td> <td>8</td></tr> <tr><td>12</td> <td>New England</td> <td>Boston</td> <td>MARKETING</td> <td>9</td></tr> <tr><td>5</td> <td>West</td> <td>Los Angeles</td> <td>RESEARCH</td> <td>11</td></tr> <tr><td>15</td> <td>NULL</td> <td>San Francisco</td> <td>MARKETING</td> <td>12</td></tr> <tr><td>4</td> <td>NULL</td> <td>Chicago</td> <td>INNOVATION</td> <td>11</td></tr> <tr><td>2</td> <td>NULL</td> <td>Detroit</td> <td>HUMAN RESOURCES</td> <td>9</td></tr></tbody></table> <h2 id="case-in-order-by-clause-to-sort-records-by-lowest-value-of-2-columns"><a href="#case-in-order-by-clause-to-sort-records-by-lowest-value-of-2-columns" class="header-anchor">#</a> CASE in ORDER BY clause to sort records by lowest value of 2 columns</h2> <p>Imagine that you need sort records by lowest value of either one of two columns.
Some databases could use a non-aggregated <code>MIN()</code> or <code>LEAST()</code> function for this (<code>... ORDER BY MIN(Date1, Date2)</code>), but in standard SQL, you have to use a <code>CASE</code> expression.</p> <p>The <code>CASE</code> expression in the query below looks at the <code>Date1</code> and <code>Date2</code> columns, checks which column has the lower value, and sorts the records depending on this value.</p> <h3 id="sample-data"><a href="#sample-data" class="header-anchor">#</a> Sample data</h3> <table><thead><tr><th>Id</th> <th>Date1</th> <th>Date2</th></tr></thead> <tbody><tr><td>1</td> <td>2017-01-01</td> <td>2017-01-31</td></tr> <tr><td>2</td> <td>2017-01-31</td> <td>2017-01-03</td></tr> <tr><td>3</td> <td>2017-01-31</td> <td>2017-01-02</td></tr> <tr><td>4</td> <td>2017-01-06</td> <td>2017-01-31</td></tr> <tr><td>5</td> <td>2017-01-31</td> <td>2017-01-05</td></tr> <tr><td>6</td> <td>2017-01-04</td> <td>2017-01-31</td></tr></tbody></table> <h3 id="query"><a href="#query" class="header-anchor">#</a> Query</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Id<span class="token punctuation">,</span> Date1<span class="token punctuation">,</span> Date2
<span class="token keyword">FROM</span> YourTable
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token keyword">CASE</span> 
           <span class="token keyword">WHEN</span> <span class="token keyword">COALESCE</span><span class="token punctuation">(</span>Date1<span class="token punctuation">,</span> <span class="token string">'1753-01-01'</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token keyword">COALESCE</span><span class="token punctuation">(</span>Date2<span class="token punctuation">,</span> <span class="token string">'1753-01-01'</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> Date1 
           <span class="token keyword">ELSE</span> Date2 
         <span class="token keyword">END</span>

</code></pre></div><h3 id="results"><a href="#results" class="header-anchor">#</a> Results</h3> <table><thead><tr><th>Id</th> <th>Date1</th> <th>Date2</th></tr></thead> <tbody><tr><td>1</td> <td><strong>2017-01-01</strong></td> <td>2017-01-31</td></tr> <tr><td>3</td> <td>2017-01-31</td> <td><strong>2017-01-02</strong></td></tr> <tr><td>2</td> <td>2017-01-31</td> <td><strong>2017-01-03</strong></td></tr> <tr><td>6</td> <td><strong>2017-01-04</strong></td> <td>2017-01-31</td></tr> <tr><td>5</td> <td>2017-01-31</td> <td><strong>2017-01-05</strong></td></tr> <tr><td>4</td> <td><strong>2017-01-06</strong></td> <td>2017-01-31</td></tr></tbody></table> <h3 id="explanation"><a href="#explanation" class="header-anchor">#</a> Explanation</h3> <p>As you see row with <code>Id = 1</code> is first, that because <code>Date1</code> have lowest record from entire table <code>2017-01-01</code>, row where <code>Id = 3</code> is second that because <code>Date2</code> equals to <code>2017-01-02</code> that is second lowest value from table and so on.</p> <p>So we have sorted records from <code>2017-01-01</code> to <code>2017-01-06</code> ascending and no care on which one column <code>Date1</code> or <code>Date2</code> are those values.</p> <h4 id="syntax"><a href="#syntax" class="header-anchor">#</a> Syntax</h4> <li>CASE input_expression<br>
 WHEN compare1 THEN result1<br>
[WHEN compare2 THEN result2]...<br>
[ELSE resultX]<br>
END</li> <li>CASE<br>
 WHEN condition1 THEN result1<br>
[WHEN condition2 THEN result2]...<br>
[ELSE resultX]<br>
END</li> <h4 id="remarks"><a href="#remarks" class="header-anchor">#</a> Remarks</h4> <p>The <strong>simple CASE expression</strong> returns the first result whose <code>compareX</code> value is equal to the <code>input_expression</code>.</p> <p>The <strong>searched CASE expression</strong> returns the first result whose <code>conditionX</code> is true.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/devtut/generate/edit/master/docs/sql/case.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/sql/and-or-operators.html" class="prev">
        AND &amp; OR Operators
      </a></span> <span class="next"><a href="/sql/like-operator.html">
        LIKE operator
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1779e102.js" defer></script><script src="/assets/js/3.2cfa8016.js" defer></script><script src="/assets/js/3245.c442fb19.js" defer></script>
  </body>
</html>
